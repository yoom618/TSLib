Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7222440242767334
Epoch: 1, Steps: 8 | Train Loss: 2.285 Vali Loss: 1.737 Vali Acc: 0.444 Test Loss: 1.737 Test Acc: 0.444
Validation loss decreased (inf --> -0.443733).  Saving model ...
Epoch: 2 cost time: 1.3248088359832764
Epoch: 2, Steps: 8 | Train Loss: 1.238 Vali Loss: 0.747 Vali Acc: 0.797 Test Loss: 0.747 Test Acc: 0.797
Validation loss decreased (-0.443733 --> -0.796868).  Saving model ...
Epoch: 3 cost time: 1.2128300666809082
Epoch: 3, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.796868 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 1.2668452262878418
Epoch: 4, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2193307876586914
Epoch: 5, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0653080940246582
Epoch: 6, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4042677879333496
Epoch: 7, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.648 Vali Acc: 0.853 Test Loss: 0.648 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 8 cost time: 1.362253189086914
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.718 Vali Acc: 0.834 Test Loss: 0.718 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2005729675292969
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.744 Vali Acc: 0.841 Test Loss: 0.744 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4902772903442383
Epoch: 10, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.830 Vali Acc: 0.844 Test Loss: 0.830 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3532710075378418
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.989 Vali Acc: 0.831 Test Loss: 0.989 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1075587272644043
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.973 Vali Acc: 0.828 Test Loss: 0.973 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.388634204864502
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.872 Vali Acc: 0.847 Test Loss: 0.872 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3759372234344482
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.856 Test Loss: 0.861 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856241).  Saving model ...
Epoch: 15 cost time: 1.2460532188415527
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.922 Vali Acc: 0.844 Test Loss: 0.922 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4409065246582031
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.085 Vali Acc: 0.809 Test Loss: 1.085 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.245739221572876
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.992 Vali Acc: 0.831 Test Loss: 0.992 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9401721954345703
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.822 Test Loss: 0.990 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5347044467926025
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.998 Vali Acc: 0.825 Test Loss: 0.998 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2614223957061768
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.819 Test Loss: 1.008 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8802475929260254
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.825 Test Loss: 1.024 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1717679500579834
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.822 Test Loss: 1.030 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3306446075439453
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.822 Test Loss: 1.033 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1772303581237793
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.822 Test Loss: 1.035 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 638344
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5956766605377197
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 1.808 Vali Acc: 0.409 Test Loss: 1.808 Test Acc: 0.409
Validation loss decreased (inf --> -0.409357).  Saving model ...
Epoch: 2 cost time: 0.8209865093231201
Epoch: 2, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.050 Vali Acc: 0.781 Test Loss: 1.050 Test Acc: 0.781
Validation loss decreased (-0.409357 --> -0.781239).  Saving model ...
Epoch: 3 cost time: 1.0803983211517334
Epoch: 3, Steps: 8 | Train Loss: 0.872 Vali Loss: 0.622 Vali Acc: 0.825 Test Loss: 0.622 Test Acc: 0.825
Validation loss decreased (-0.781239 --> -0.824994).  Saving model ...
Epoch: 4 cost time: 1.0942015647888184
Epoch: 4, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
Validation loss decreased (-0.824994 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 0.9393751621246338
Epoch: 5, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2278029918670654
Epoch: 6, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.233966588973999
Epoch: 7, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9348969459533691
Epoch: 8, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 1.0498979091644287
Epoch: 9, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.629 Vali Acc: 0.834 Test Loss: 0.629 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2293896675109863
Epoch: 10, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.660 Vali Acc: 0.834 Test Loss: 0.660 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2518339157104492
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.652 Vali Acc: 0.834 Test Loss: 0.652 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9211709499359131
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.707 Vali Acc: 0.838 Test Loss: 0.707 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8789503574371338
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.766 Vali Acc: 0.838 Test Loss: 0.766 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1386959552764893
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.742 Vali Acc: 0.838 Test Loss: 0.742 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8447420597076416
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.732 Vali Acc: 0.841 Test Loss: 0.732 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.932105541229248
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.733 Vali Acc: 0.834 Test Loss: 0.733 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.031886100769043
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.834 Test Loss: 0.746 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3033921718597412
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.754 Vali Acc: 0.838 Test Loss: 0.754 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 519560
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8516783714294434
Epoch: 1, Steps: 8 | Train Loss: 2.294 Vali Loss: 1.993 Vali Acc: 0.244 Test Loss: 1.993 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 1.1978857517242432
Epoch: 2, Steps: 8 | Train Loss: 1.751 Vali Loss: 1.333 Vali Acc: 0.669 Test Loss: 1.333 Test Acc: 0.669
Validation loss decreased (-0.243730 --> -0.668737).  Saving model ...
Epoch: 3 cost time: 0.8827366828918457
Epoch: 3, Steps: 8 | Train Loss: 1.049 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
Validation loss decreased (-0.668737 --> -0.774992).  Saving model ...
Epoch: 4 cost time: 1.1513640880584717
Epoch: 4, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.611 Vali Acc: 0.806 Test Loss: 0.611 Test Acc: 0.806
Validation loss decreased (-0.774992 --> -0.806244).  Saving model ...
Epoch: 5 cost time: 1.245011806488037
Epoch: 5, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818745).  Saving model ...
Epoch: 6 cost time: 1.135040283203125
Epoch: 6, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2965502738952637
Epoch: 7, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.818745 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.2993156909942627
Epoch: 8, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2176313400268555
Epoch: 9, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.132537841796875
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 1.261610507965088
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2283575534820557
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0378305912017822
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4401171207427979
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4046225547790527
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.614 Vali Acc: 0.831 Test Loss: 0.614 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2888381481170654
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.831 Test Loss: 0.636 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3358097076416016
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.653 Vali Acc: 0.834 Test Loss: 0.653 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3443348407745361
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.834 Test Loss: 0.657 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0250487327575684
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843743).  Saving model ...
Epoch: 20 cost time: 0.9804933071136475
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.673 Vali Acc: 0.834 Test Loss: 0.673 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9783627986907959
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.834 Test Loss: 0.683 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.948232889175415
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.834 Test Loss: 0.689 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9620411396026611
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.834 Test Loss: 0.697 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9993791580200195
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.834 Test Loss: 0.703 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0909712314605713
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.148346185684204
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.838 Test Loss: 0.711 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9675683975219727
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.838 Test Loss: 0.708 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.075110673904419
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.834 Test Loss: 0.704 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9928052425384521
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.841 Test Loss: 0.704 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 480648
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9553544521331787
Epoch: 1, Steps: 8 | Train Loss: 2.181 Vali Loss: 1.931 Vali Acc: 0.291 Test Loss: 1.931 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 0.7760119438171387
Epoch: 2, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.404 Vali Acc: 0.656 Test Loss: 1.404 Test Acc: 0.656
Validation loss decreased (-0.290606 --> -0.656236).  Saving model ...
Epoch: 3 cost time: 0.7106354236602783
Epoch: 3, Steps: 8 | Train Loss: 1.285 Vali Loss: 0.913 Vali Acc: 0.784 Test Loss: 0.913 Test Acc: 0.784
Validation loss decreased (-0.656236 --> -0.784366).  Saving model ...
Epoch: 4 cost time: 0.7014517784118652
Epoch: 4, Steps: 8 | Train Loss: 0.778 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
Validation loss decreased (-0.784366 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 0.6345005035400391
Epoch: 5, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.6559655666351318
Epoch: 6, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.471 Vali Acc: 0.834 Test Loss: 0.471 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6865546703338623
Epoch: 7, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.493 Vali Acc: 0.825 Test Loss: 0.493 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6628808975219727
Epoch: 8, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7590997219085693
Epoch: 9, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6477468013763428
Epoch: 10, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6905548572540283
Epoch: 11, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6707689762115479
Epoch: 12, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7183749675750732
Epoch: 13, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7364816665649414
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6705360412597656
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 460168
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1015403270721436
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.009 Vali Acc: 0.194 Test Loss: 2.009 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.6545305252075195
Epoch: 2, Steps: 8 | Train Loss: 1.803 Vali Loss: 1.508 Vali Acc: 0.550 Test Loss: 1.508 Test Acc: 0.550
Validation loss decreased (-0.193730 --> -0.549985).  Saving model ...
Epoch: 3 cost time: 0.6785564422607422
Epoch: 3, Steps: 8 | Train Loss: 1.277 Vali Loss: 1.016 Vali Acc: 0.762 Test Loss: 1.016 Test Acc: 0.762
Validation loss decreased (-0.549985 --> -0.762490).  Saving model ...
Epoch: 4 cost time: 0.6165907382965088
Epoch: 4, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.762490 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 0.5868144035339355
Epoch: 5, Steps: 8 | Train Loss: 0.607 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
Validation loss decreased (-0.799993 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 0.6809530258178711
Epoch: 6, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
Validation loss decreased (-0.815619 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.7220757007598877
Epoch: 7, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.6157569885253906
Epoch: 8, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.482 Vali Acc: 0.828 Test Loss: 0.482 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6836445331573486
Epoch: 9, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.475 Vali Acc: 0.847 Test Loss: 0.475 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6601788997650146
Epoch: 10, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7020955085754395
Epoch: 11, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.712303638458252
Epoch: 12, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6564490795135498
Epoch: 13, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7157342433929443
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7075984477996826
Epoch: 15, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6896753311157227
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7139053344726562
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 443784
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9411506652832031
Epoch: 1, Steps: 8 | Train Loss: 2.180 Vali Loss: 2.027 Vali Acc: 0.147 Test Loss: 2.027 Test Acc: 0.147
Validation loss decreased (inf --> -0.146855).  Saving model ...
Epoch: 2 cost time: 0.6603734493255615
Epoch: 2, Steps: 8 | Train Loss: 1.978 Vali Loss: 1.642 Vali Acc: 0.497 Test Loss: 1.642 Test Acc: 0.497
Validation loss decreased (-0.146855 --> -0.496859).  Saving model ...
Epoch: 3 cost time: 0.6316139698028564
Epoch: 3, Steps: 8 | Train Loss: 1.494 Vali Loss: 1.212 Vali Acc: 0.744 Test Loss: 1.212 Test Acc: 0.744
Validation loss decreased (-0.496859 --> -0.743738).  Saving model ...
Epoch: 4 cost time: 0.630814790725708
Epoch: 4, Steps: 8 | Train Loss: 1.094 Vali Loss: 0.890 Vali Acc: 0.778 Test Loss: 0.890 Test Acc: 0.778
Validation loss decreased (-0.743738 --> -0.778116).  Saving model ...
Epoch: 5 cost time: 0.607327938079834
Epoch: 5, Steps: 8 | Train Loss: 0.754 Vali Loss: 0.699 Vali Acc: 0.797 Test Loss: 0.699 Test Acc: 0.797
Validation loss decreased (-0.778116 --> -0.796868).  Saving model ...
Epoch: 6 cost time: 0.5675547122955322
Epoch: 6, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.796868 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 0.6607277393341064
Epoch: 7, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.516 Vali Acc: 0.828 Test Loss: 0.516 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.6788103580474854
Epoch: 8, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.6354670524597168
Epoch: 9, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7632851600646973
Epoch: 10, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.6938142776489258
Epoch: 11, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.473 Vali Acc: 0.834 Test Loss: 0.473 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6218225955963135
Epoch: 12, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6556947231292725
Epoch: 13, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 0.6707053184509277
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.6611776351928711
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6848745346069336
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.631232500076294
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 0.7337653636932373
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7617418766021729
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 20 cost time: 0.6933531761169434
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9597885608673096
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7570085525512695
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8516829013824463
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8048121929168701
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 25 cost time: 0.7879576683044434
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.497 Vali Acc: 0.866 Test Loss: 0.497 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 26 cost time: 0.8439269065856934
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7816503047943115
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8928861618041992
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8811094760894775
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8238656520843506
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9587984085083008
Epoch: 31, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8765888214111328
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.511 Vali Acc: 0.863 Test Loss: 0.511 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7939815521240234
Epoch: 33, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7859487533569336
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.508 Vali Acc: 0.866 Test Loss: 0.508 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.838148832321167
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.869 Test Loss: 0.498 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 36 cost time: 0.8255264759063721
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.499 Vali Acc: 0.869 Test Loss: 0.499 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7946372032165527
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.508 Vali Acc: 0.866 Test Loss: 0.508 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8479020595550537
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8420524597167969
Epoch: 39, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.866 Test Loss: 0.514 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9010775089263916
Epoch: 40, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.869 Test Loss: 0.515 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7611162662506104
Epoch: 41, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.516 Vali Acc: 0.866 Test Loss: 0.516 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.822655200958252
Epoch: 42, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8191409111022949
Epoch: 43, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 44 cost time: 0.7901630401611328
Epoch: 44, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 45 cost time: 0.7611024379730225
Epoch: 45, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.869 Test Loss: 0.537 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.795290470123291
Epoch: 46, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.869 Test Loss: 0.542 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7992324829101562
Epoch: 47, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7856235504150391
Epoch: 48, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.866 Test Loss: 0.514 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7529599666595459
Epoch: 49, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.869 Test Loss: 0.518 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8727898597717285
Epoch: 50, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.866 Test Loss: 0.530 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8515374660491943
Epoch: 51, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.866 Test Loss: 0.530 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.8269414901733398
Epoch: 52, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.869 Test Loss: 0.518 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6843264102935791
Epoch: 53, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.869 Test Loss: 0.527 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7730491161346436
Epoch: 54, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.869 Test Loss: 0.536 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 433416
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0345168113708496
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 1.979 Vali Acc: 0.266 Test Loss: 1.979 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 0.6775305271148682
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.643 Vali Acc: 0.522 Test Loss: 1.643 Test Acc: 0.522
Validation loss decreased (-0.265605 --> -0.521859).  Saving model ...
Epoch: 3 cost time: 0.6439683437347412
Epoch: 3, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.257 Vali Acc: 0.697 Test Loss: 1.257 Test Acc: 0.697
Validation loss decreased (-0.521859 --> -0.696862).  Saving model ...
Epoch: 4 cost time: 0.6797277927398682
Epoch: 4, Steps: 8 | Train Loss: 1.153 Vali Loss: 0.936 Vali Acc: 0.778 Test Loss: 0.936 Test Acc: 0.778
Validation loss decreased (-0.696862 --> -0.778116).  Saving model ...
Epoch: 5 cost time: 0.6390213966369629
Epoch: 5, Steps: 8 | Train Loss: 0.878 Vali Loss: 0.743 Vali Acc: 0.803 Test Loss: 0.743 Test Acc: 0.803
Validation loss decreased (-0.778116 --> -0.803118).  Saving model ...
Epoch: 6 cost time: 0.6732528209686279
Epoch: 6, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 0.621659517288208
Epoch: 7, Steps: 8 | Train Loss: 0.518 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.6949634552001953
Epoch: 8, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.7089817523956299
Epoch: 9, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.480 Vali Acc: 0.834 Test Loss: 0.480 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6230874061584473
Epoch: 10, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.608830451965332
Epoch: 11, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 0.6432254314422607
Epoch: 12, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.435 Vali Acc: 0.866 Test Loss: 0.435 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865621).  Saving model ...
Epoch: 13 cost time: 0.6326496601104736
Epoch: 13, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6471688747406006
Epoch: 14, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7010600566864014
Epoch: 15, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6348001956939697
Epoch: 16, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6385869979858398
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.438 Vali Acc: 0.853 Test Loss: 0.438 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7087616920471191
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6948540210723877
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.452 Vali Acc: 0.853 Test Loss: 0.452 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6541292667388916
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6000015735626221
Epoch: 21, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6453216075897217
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 429320
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.827105760574341
Epoch: 1, Steps: 8 | Train Loss: 1.950 Vali Loss: 1.533 Vali Acc: 0.503 Test Loss: 1.533 Test Acc: 0.503
Validation loss decreased (inf --> -0.503110).  Saving model ...
Epoch: 2 cost time: 1.4225904941558838
Epoch: 2, Steps: 8 | Train Loss: 1.143 Vali Loss: 0.697 Vali Acc: 0.812 Test Loss: 0.697 Test Acc: 0.812
Validation loss decreased (-0.503110 --> -0.812493).  Saving model ...
Epoch: 3 cost time: 1.1377196311950684
Epoch: 3, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821870).  Saving model ...
Epoch: 4 cost time: 1.1824443340301514
Epoch: 4, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.821870 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.169630765914917
Epoch: 5, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2468554973602295
Epoch: 6, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.149641752243042
Epoch: 7, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.754 Vali Acc: 0.816 Test Loss: 0.754 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1601428985595703
Epoch: 8, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.746 Vali Acc: 0.812 Test Loss: 0.746 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1110215187072754
Epoch: 9, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.879 Vali Acc: 0.812 Test Loss: 0.879 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1839547157287598
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.786 Vali Acc: 0.822 Test Loss: 0.786 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1514670848846436
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.838 Vali Acc: 0.841 Test Loss: 0.838 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1604747772216797
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.926 Vali Acc: 0.831 Test Loss: 0.926 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1701908111572266
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.822 Test Loss: 1.011 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.122255563735962
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.819 Test Loss: 1.055 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 539656
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5806636810302734
Epoch: 1, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.744 Vali Acc: 0.431 Test Loss: 1.744 Test Acc: 0.431
Validation loss decreased (inf --> -0.431233).  Saving model ...
Epoch: 2 cost time: 1.4712450504302979
Epoch: 2, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.027 Vali Acc: 0.738 Test Loss: 1.027 Test Acc: 0.738
Validation loss decreased (-0.431233 --> -0.737490).  Saving model ...
Epoch: 3 cost time: 1.0893781185150146
Epoch: 3, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
Validation loss decreased (-0.737490 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 1.0492031574249268
Epoch: 4, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.558 Vali Acc: 0.794 Test Loss: 0.558 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2909314632415771
Epoch: 5, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
Validation loss decreased (-0.806244 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 1.0727035999298096
Epoch: 6, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0343270301818848
Epoch: 7, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3434791564941406
Epoch: 8, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8921191692352295
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.693 Vali Acc: 0.806 Test Loss: 0.693 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9604120254516602
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9085254669189453
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.720 Vali Acc: 0.834 Test Loss: 0.720 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834368).  Saving model ...
Epoch: 12 cost time: 0.9538733959197998
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.709 Vali Acc: 0.816 Test Loss: 0.709 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2137231826782227
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.737 Vali Acc: 0.819 Test Loss: 0.737 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8205773830413818
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.752 Vali Acc: 0.828 Test Loss: 0.752 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.03578782081604
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.800 Vali Acc: 0.834 Test Loss: 0.800 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.010077714920044
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.798 Vali Acc: 0.838 Test Loss: 0.798 Test Acc: 0.838
Validation loss decreased (-0.834368 --> -0.837492).  Saving model ...
Epoch: 17 cost time: 0.899899959564209
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.828 Test Loss: 0.774 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.280458927154541
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.779 Vali Acc: 0.828 Test Loss: 0.779 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8797903060913086
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.824 Vali Acc: 0.831 Test Loss: 0.824 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9310381412506104
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.838 Test Loss: 0.850 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8966128826141357
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.838 Test Loss: 0.863 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8472938537597656
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.834 Test Loss: 0.855 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.875159740447998
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.854 Vali Acc: 0.834 Test Loss: 0.854 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8267440795898438
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.854 Vali Acc: 0.825 Test Loss: 0.854 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7306497097015381
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.834 Test Loss: 0.854 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9179728031158447
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.828 Test Loss: 0.860 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 420872
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.372816324234009
Epoch: 1, Steps: 8 | Train Loss: 2.221 Vali Loss: 1.897 Vali Acc: 0.328 Test Loss: 1.897 Test Acc: 0.328
Validation loss decreased (inf --> -0.328106).  Saving model ...
Epoch: 2 cost time: 0.8103530406951904
Epoch: 2, Steps: 8 | Train Loss: 1.674 Vali Loss: 1.274 Vali Acc: 0.700 Test Loss: 1.274 Test Acc: 0.700
Validation loss decreased (-0.328106 --> -0.699987).  Saving model ...
Epoch: 3 cost time: 1.165452003479004
Epoch: 3, Steps: 8 | Train Loss: 1.045 Vali Loss: 0.788 Vali Acc: 0.797 Test Loss: 0.788 Test Acc: 0.797
Validation loss decreased (-0.699987 --> -0.796867).  Saving model ...
Epoch: 4 cost time: 0.6994199752807617
Epoch: 4, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
Validation loss decreased (-0.796867 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 1.0192046165466309
Epoch: 5, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 0.7734167575836182
Epoch: 6, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.7609529495239258
Epoch: 7, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2043566703796387
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0742182731628418
Epoch: 9, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3119425773620605
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0588374137878418
Epoch: 11, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.583 Vali Acc: 0.831 Test Loss: 0.583 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0030791759490967
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.649 Vali Acc: 0.819 Test Loss: 0.649 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1589760780334473
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.644 Vali Acc: 0.834 Test Loss: 0.644 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9414656162261963
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.838 Test Loss: 0.628 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8103621006011963
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0092589855194092
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.725 Vali Acc: 0.834 Test Loss: 0.725 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 381960
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1316919326782227
Epoch: 1, Steps: 8 | Train Loss: 2.028 Vali Loss: 1.786 Vali Acc: 0.463 Test Loss: 1.786 Test Acc: 0.463
Validation loss decreased (inf --> -0.462482).  Saving model ...
Epoch: 2 cost time: 0.6588523387908936
Epoch: 2, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.271 Vali Acc: 0.728 Test Loss: 1.271 Test Acc: 0.728
Validation loss decreased (-0.462482 --> -0.728112).  Saving model ...
Epoch: 3 cost time: 0.6437249183654785
Epoch: 3, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.838 Vali Acc: 0.794 Test Loss: 0.838 Test Acc: 0.794
Validation loss decreased (-0.728112 --> -0.793742).  Saving model ...
Epoch: 4 cost time: 0.6323225498199463
Epoch: 4, Steps: 8 | Train Loss: 0.715 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.793742 --> -0.809369).  Saving model ...
Epoch: 5 cost time: 0.6268532276153564
Epoch: 5, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 0.6569457054138184
Epoch: 6, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
Validation loss decreased (-0.821870 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.6523184776306152
Epoch: 7, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7387127876281738
Epoch: 8, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6999897956848145
Epoch: 9, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6936688423156738
Epoch: 10, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6758687496185303
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6950571537017822
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8150985240936279
Epoch: 13, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.721611738204956
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.729419469833374
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.589 Vali Acc: 0.831 Test Loss: 0.589 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8777756690979004
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.600 Vali Acc: 0.834 Test Loss: 0.600 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 361480
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.143120050430298
Epoch: 1, Steps: 8 | Train Loss: 2.257 Vali Loss: 2.118 Vali Acc: 0.131 Test Loss: 2.118 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.8337652683258057
Epoch: 2, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.625 Vali Acc: 0.516 Test Loss: 1.625 Test Acc: 0.516
Validation loss decreased (-0.131229 --> -0.515609).  Saving model ...
Epoch: 3 cost time: 0.8401470184326172
Epoch: 3, Steps: 8 | Train Loss: 1.394 Vali Loss: 1.123 Vali Acc: 0.728 Test Loss: 1.123 Test Acc: 0.728
Validation loss decreased (-0.515609 --> -0.728114).  Saving model ...
Epoch: 4 cost time: 0.8451316356658936
Epoch: 4, Steps: 8 | Train Loss: 0.957 Vali Loss: 0.786 Vali Acc: 0.781 Test Loss: 0.786 Test Acc: 0.781
Validation loss decreased (-0.728114 --> -0.781242).  Saving model ...
Epoch: 5 cost time: 0.7410678863525391
Epoch: 5, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799994).  Saving model ...
Epoch: 6 cost time: 0.8076009750366211
Epoch: 6, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
Validation loss decreased (-0.799994 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 0.7696936130523682
Epoch: 7, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 8 cost time: 0.8266110420227051
Epoch: 8, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
Validation loss decreased (-0.821870 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.8070724010467529
Epoch: 9, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.8437237739562988
Epoch: 10, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9035885334014893
Epoch: 11, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.7096233367919922
Epoch: 12, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6921279430389404
Epoch: 13, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.813481330871582
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.832634449005127
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8416733741760254
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.570 Vali Acc: 0.838 Test Loss: 0.570 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7925052642822266
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8435792922973633
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8643569946289062
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8060739040374756
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8034472465515137
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8016510009765625
Epoch: 22, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 23 cost time: 0.8785851001739502
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.573 Vali Acc: 0.847 Test Loss: 0.573 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6873679161071777
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8439502716064453
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8561689853668213
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7786130905151367
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.597 Vali Acc: 0.847 Test Loss: 0.597 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7979974746704102
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.786139965057373
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.853 Test Loss: 0.591 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8867719173431396
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7338874340057373
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6606512069702148
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.847 Test Loss: 0.618 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 345096
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0914413928985596
Epoch: 1, Steps: 8 | Train Loss: 2.233 Vali Loss: 2.019 Vali Acc: 0.266 Test Loss: 2.019 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 0.8545413017272949
Epoch: 2, Steps: 8 | Train Loss: 1.949 Vali Loss: 1.665 Vali Acc: 0.475 Test Loss: 1.665 Test Acc: 0.475
Validation loss decreased (-0.265605 --> -0.474983).  Saving model ...
Epoch: 3 cost time: 0.8647592067718506
Epoch: 3, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.256 Vali Acc: 0.734 Test Loss: 1.256 Test Acc: 0.734
Validation loss decreased (-0.474983 --> -0.734362).  Saving model ...
Epoch: 4 cost time: 0.8020999431610107
Epoch: 4, Steps: 8 | Train Loss: 1.122 Vali Loss: 0.943 Vali Acc: 0.769 Test Loss: 0.943 Test Acc: 0.769
Validation loss decreased (-0.734362 --> -0.768741).  Saving model ...
Epoch: 5 cost time: 0.847506046295166
Epoch: 5, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.738 Vali Acc: 0.797 Test Loss: 0.738 Test Acc: 0.797
Validation loss decreased (-0.768741 --> -0.796868).  Saving model ...
Epoch: 6 cost time: 0.8551132678985596
Epoch: 6, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 7 cost time: 0.8143270015716553
Epoch: 7, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8757364749908447
Epoch: 8, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818745).  Saving model ...
Epoch: 9 cost time: 0.8284740447998047
Epoch: 9, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 10 cost time: 0.7829041481018066
Epoch: 10, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
Validation loss decreased (-0.821870 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.8151261806488037
Epoch: 11, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 0.7817442417144775
Epoch: 12, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.487 Vali Acc: 0.828 Test Loss: 0.487 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.817704439163208
Epoch: 13, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8308677673339844
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7941935062408447
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8137731552124023
Epoch: 16, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.7777175903320312
Epoch: 17, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 0.7958214282989502
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7295143604278564
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 20 cost time: 0.7002754211425781
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 0.7711279392242432
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7769675254821777
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 23 cost time: 0.8082766532897949
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.491 Vali Acc: 0.866 Test Loss: 0.491 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 24 cost time: 0.8465774059295654
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.487 Vali Acc: 0.863 Test Loss: 0.487 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6769552230834961
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7982292175292969
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8527553081512451
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8227765560150146
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7726585865020752
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6925292015075684
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7618179321289062
Epoch: 31, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.6767065525054932
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5996208190917969
Epoch: 33, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.485 Vali Acc: 0.872 Test Loss: 0.485 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6189627647399902
Epoch: 34, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.869 Test Loss: 0.486 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6235952377319336
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.491 Vali Acc: 0.869 Test Loss: 0.491 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.685244083404541
Epoch: 36, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.490 Vali Acc: 0.869 Test Loss: 0.490 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6473426818847656
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.500 Vali Acc: 0.866 Test Loss: 0.500 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7076692581176758
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6713206768035889
Epoch: 39, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.500 Vali Acc: 0.863 Test Loss: 0.500 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7166979312896729
Epoch: 40, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.507 Vali Acc: 0.866 Test Loss: 0.507 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6116049289703369
Epoch: 41, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 334728
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3344805240631104
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.993 Vali Acc: 0.206 Test Loss: 1.993 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 0.6963968276977539
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.649 Vali Acc: 0.453 Test Loss: 1.649 Test Acc: 0.453
Validation loss decreased (-0.206230 --> -0.453109).  Saving model ...
Epoch: 3 cost time: 0.8466248512268066
Epoch: 3, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.255 Vali Acc: 0.713 Test Loss: 1.255 Test Acc: 0.713
Validation loss decreased (-0.453109 --> -0.712487).  Saving model ...
Epoch: 4 cost time: 0.6574819087982178
Epoch: 4, Steps: 8 | Train Loss: 1.183 Vali Loss: 0.939 Vali Acc: 0.759 Test Loss: 0.939 Test Acc: 0.759
Validation loss decreased (-0.712487 --> -0.759366).  Saving model ...
Epoch: 5 cost time: 0.6310591697692871
Epoch: 5, Steps: 8 | Train Loss: 0.881 Vali Loss: 0.755 Vali Acc: 0.772 Test Loss: 0.755 Test Acc: 0.772
Validation loss decreased (-0.759366 --> -0.771867).  Saving model ...
Epoch: 6 cost time: 0.7208161354064941
Epoch: 6, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.640 Vali Acc: 0.794 Test Loss: 0.640 Test Acc: 0.794
Validation loss decreased (-0.771867 --> -0.793744).  Saving model ...
Epoch: 7 cost time: 0.8283240795135498
Epoch: 7, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
Validation loss decreased (-0.793744 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 0.7403590679168701
Epoch: 8, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821870).  Saving model ...
Epoch: 9 cost time: 0.8366734981536865
Epoch: 9, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.498 Vali Acc: 0.825 Test Loss: 0.498 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 0.7714555263519287
Epoch: 10, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.7909996509552002
Epoch: 11, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.9484498500823975
Epoch: 12, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.6910676956176758
Epoch: 13, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8037288188934326
Epoch: 14, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.451 Vali Acc: 0.853 Test Loss: 0.451 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.8343827724456787
Epoch: 15, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.437 Vali Acc: 0.859 Test Loss: 0.437 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859371).  Saving model ...
Epoch: 16 cost time: 0.8910689353942871
Epoch: 16, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7537596225738525
Epoch: 17, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.459 Vali Acc: 0.863 Test Loss: 0.459 Test Acc: 0.863
Validation loss decreased (-0.859371 --> -0.862495).  Saving model ...
Epoch: 18 cost time: 0.856471061706543
Epoch: 18, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9135210514068604
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7971832752227783
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9555091857910156
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862496).  Saving model ...
Epoch: 22 cost time: 0.8705496788024902
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8168795108795166
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7630891799926758
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8682000637054443
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8754827976226807
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.816260576248169
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.465 Vali Acc: 0.869 Test Loss: 0.465 Test Acc: 0.869
Validation loss decreased (-0.862496 --> -0.868745).  Saving model ...
Epoch: 28 cost time: 0.8119850158691406
Epoch: 28, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.460 Vali Acc: 0.869 Test Loss: 0.460 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 29 cost time: 0.7958035469055176
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.463 Vali Acc: 0.869 Test Loss: 0.463 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6668181419372559
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.461 Vali Acc: 0.869 Test Loss: 0.461 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8259873390197754
Epoch: 31, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.474 Vali Acc: 0.869 Test Loss: 0.474 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7582314014434814
Epoch: 32, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.499 Vali Acc: 0.869 Test Loss: 0.499 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7798418998718262
Epoch: 33, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874995).  Saving model ...
Epoch: 34 cost time: 0.7388954162597656
Epoch: 34, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8315575122833252
Epoch: 35, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.510 Vali Acc: 0.866 Test Loss: 0.510 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8885688781738281
Epoch: 36, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8370342254638672
Epoch: 37, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.500 Vali Acc: 0.866 Test Loss: 0.500 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8219330310821533
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8668549060821533
Epoch: 39, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 0.8560976982116699
Epoch: 40, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8850102424621582
Epoch: 41, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.866 Test Loss: 0.488 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0122945308685303
Epoch: 42, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.866 Test Loss: 0.492 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7171885967254639
Epoch: 43, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.494 Vali Acc: 0.863 Test Loss: 0.494 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.717200756072998
Epoch: 44, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.841559886932373
Epoch: 45, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.501 Vali Acc: 0.859 Test Loss: 0.501 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8314065933227539
Epoch: 46, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7834813594818115
Epoch: 47, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9127914905548096
Epoch: 48, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.866 Test Loss: 0.507 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8871614933013916
Epoch: 49, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.869 Test Loss: 0.501 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 330632
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9941465854644775
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 1.658 Vali Acc: 0.469 Test Loss: 1.658 Test Acc: 0.469
Validation loss decreased (inf --> -0.468733).  Saving model ...
Epoch: 2 cost time: 1.3889150619506836
Epoch: 2, Steps: 8 | Train Loss: 1.189 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
Validation loss decreased (-0.468733 --> -0.799993).  Saving model ...
Epoch: 3 cost time: 1.5430898666381836
Epoch: 3, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
Validation loss decreased (-0.799993 --> -0.834370).  Saving model ...
Epoch: 4 cost time: 1.4292681217193604
Epoch: 4, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.563 Vali Acc: 0.812 Test Loss: 0.563 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1724629402160645
Epoch: 5, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.547 Vali Acc: 0.863 Test Loss: 0.547 Test Acc: 0.863
Validation loss decreased (-0.834370 --> -0.862495).  Saving model ...
Epoch: 6 cost time: 1.4376702308654785
Epoch: 6, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.732 Vali Acc: 0.828 Test Loss: 0.732 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.345632553100586
Epoch: 7, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.098257064819336
Epoch: 8, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.703 Vali Acc: 0.856 Test Loss: 0.703 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5717227458953857
Epoch: 9, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.789 Vali Acc: 0.834 Test Loss: 0.789 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3487670421600342
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.835 Vali Acc: 0.838 Test Loss: 0.835 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.222348928451538
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.885 Vali Acc: 0.844 Test Loss: 0.885 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0429174900054932
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.917 Vali Acc: 0.838 Test Loss: 0.917 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.110198974609375
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.825 Test Loss: 0.940 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0360682010650635
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.961 Vali Acc: 0.819 Test Loss: 0.961 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1086771488189697
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.822 Test Loss: 0.973 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 490312
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.474449396133423
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 1.889 Vali Acc: 0.312 Test Loss: 1.889 Test Acc: 0.312
Validation loss decreased (inf --> -0.312481).  Saving model ...
Epoch: 2 cost time: 1.3818883895874023
Epoch: 2, Steps: 8 | Train Loss: 1.510 Vali Loss: 1.151 Vali Acc: 0.722 Test Loss: 1.151 Test Acc: 0.722
Validation loss decreased (-0.312481 --> -0.721863).  Saving model ...
Epoch: 3 cost time: 1.2344987392425537
Epoch: 3, Steps: 8 | Train Loss: 0.853 Vali Loss: 0.656 Vali Acc: 0.797 Test Loss: 0.656 Test Acc: 0.797
Validation loss decreased (-0.721863 --> -0.796868).  Saving model ...
Epoch: 4 cost time: 1.4085922241210938
Epoch: 4, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
Validation loss decreased (-0.796868 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 1.0098907947540283
Epoch: 5, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.824995 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.4051501750946045
Epoch: 6, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0251929759979248
Epoch: 7, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3519110679626465
Epoch: 8, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0377395153045654
Epoch: 9, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.998643159866333
Epoch: 10, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.642 Vali Acc: 0.825 Test Loss: 0.642 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.441624402999878
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0973191261291504
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.724 Vali Acc: 0.825 Test Loss: 0.724 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4730808734893799
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.724 Vali Acc: 0.841 Test Loss: 0.724 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1624042987823486
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.751 Vali Acc: 0.831 Test Loss: 0.751 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3406786918640137
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.783 Vali Acc: 0.812 Test Loss: 0.783 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 371528
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.346848964691162
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 1.886 Vali Acc: 0.275 Test Loss: 1.886 Test Acc: 0.275
Validation loss decreased (inf --> -0.274981).  Saving model ...
Epoch: 2 cost time: 1.1088261604309082
Epoch: 2, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.287 Vali Acc: 0.678 Test Loss: 1.287 Test Acc: 0.678
Validation loss decreased (-0.274981 --> -0.678112).  Saving model ...
Epoch: 3 cost time: 0.9242184162139893
Epoch: 3, Steps: 8 | Train Loss: 1.050 Vali Loss: 0.809 Vali Acc: 0.806 Test Loss: 0.809 Test Acc: 0.806
Validation loss decreased (-0.678112 --> -0.806242).  Saving model ...
Epoch: 4 cost time: 0.9349250793457031
Epoch: 4, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
Validation loss decreased (-0.806242 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.7217330932617188
Epoch: 5, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 0.6147398948669434
Epoch: 6, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
Validation loss decreased (-0.831245 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 0.658153772354126
Epoch: 7, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6809470653533936
Epoch: 8, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7883541584014893
Epoch: 9, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8019545078277588
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7245895862579346
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7922015190124512
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.641 Vali Acc: 0.834 Test Loss: 0.641 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7680935859680176
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.642 Vali Acc: 0.838 Test Loss: 0.642 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7368016242980957
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7278280258178711
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.663 Vali Acc: 0.834 Test Loss: 0.663 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7812891006469727
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.683 Vali Acc: 0.838 Test Loss: 0.683 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 332616
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.423543691635132
Epoch: 1, Steps: 8 | Train Loss: 2.127 Vali Loss: 1.944 Vali Acc: 0.241 Test Loss: 1.944 Test Acc: 0.241
Validation loss decreased (inf --> -0.240606).  Saving model ...
Epoch: 2 cost time: 0.7483298778533936
Epoch: 2, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.388 Vali Acc: 0.688 Test Loss: 1.388 Test Acc: 0.688
Validation loss decreased (-0.240606 --> -0.687486).  Saving model ...
Epoch: 3 cost time: 0.8022627830505371
Epoch: 3, Steps: 8 | Train Loss: 1.191 Vali Loss: 0.907 Vali Acc: 0.769 Test Loss: 0.907 Test Acc: 0.769
Validation loss decreased (-0.687486 --> -0.768741).  Saving model ...
Epoch: 4 cost time: 0.6936261653900146
Epoch: 4, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.681 Vali Acc: 0.787 Test Loss: 0.681 Test Acc: 0.787
Validation loss decreased (-0.768741 --> -0.787493).  Saving model ...
Epoch: 5 cost time: 0.7034580707550049
Epoch: 5, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
Validation loss decreased (-0.787493 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 0.6397304534912109
Epoch: 6, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.824995 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.6188058853149414
Epoch: 7, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.7413163185119629
Epoch: 8, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7457621097564697
Epoch: 9, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.8088717460632324
Epoch: 10, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.501 Vali Acc: 0.859 Test Loss: 0.501 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 0.8158895969390869
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7877473831176758
Epoch: 12, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7871730327606201
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7925457954406738
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.593 Vali Acc: 0.834 Test Loss: 0.593 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7934794425964355
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.601 Vali Acc: 0.838 Test Loss: 0.601 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7600879669189453
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8013460636138916
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7144696712493896
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7114424705505371
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.781355619430542
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.628 Vali Acc: 0.838 Test Loss: 0.628 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 312136
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2550859451293945
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 1.898 Vali Acc: 0.259 Test Loss: 1.898 Test Acc: 0.259
Validation loss decreased (inf --> -0.259356).  Saving model ...
Epoch: 2 cost time: 0.686704158782959
Epoch: 2, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.471 Vali Acc: 0.697 Test Loss: 1.471 Test Acc: 0.697
Validation loss decreased (-0.259356 --> -0.696860).  Saving model ...
Epoch: 3 cost time: 0.7086281776428223
Epoch: 3, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.036 Vali Acc: 0.778 Test Loss: 1.036 Test Acc: 0.778
Validation loss decreased (-0.696860 --> -0.778115).  Saving model ...
Epoch: 4 cost time: 0.7273366451263428
Epoch: 4, Steps: 8 | Train Loss: 0.874 Vali Loss: 0.719 Vali Acc: 0.828 Test Loss: 0.719 Test Acc: 0.828
Validation loss decreased (-0.778115 --> -0.828118).  Saving model ...
Epoch: 5 cost time: 0.7374577522277832
Epoch: 5, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7288939952850342
Epoch: 6, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6488301753997803
Epoch: 7, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
Validation loss decreased (-0.828118 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.6421020030975342
Epoch: 8, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.7388994693756104
Epoch: 9, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7087092399597168
Epoch: 10, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.757404088973999
Epoch: 11, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.7020134925842285
Epoch: 12, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7228553295135498
Epoch: 13, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.709181547164917
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6856911182403564
Epoch: 15, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8441128730773926
Epoch: 16, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.70755934715271
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.828866720199585
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.533 Vali Acc: 0.853 Test Loss: 0.533 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.741743803024292
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8391439914703369
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6634953022003174
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.853 Test Loss: 0.559 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7834446430206299
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6941347122192383
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8420028686523438
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7463500499725342
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7967259883880615
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 27 cost time: 0.7130331993103027
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 28 cost time: 0.80470871925354
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7798073291778564
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8562607765197754
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6572093963623047
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.584 Vali Acc: 0.859 Test Loss: 0.584 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 32 cost time: 0.7654154300689697
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.580 Vali Acc: 0.863 Test Loss: 0.580 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 33 cost time: 0.855034589767456
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.859 Test Loss: 0.590 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7780354022979736
Epoch: 34, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6573421955108643
Epoch: 35, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8702642917633057
Epoch: 36, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.696054220199585
Epoch: 37, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.859 Test Loss: 0.599 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.802119255065918
Epoch: 38, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.863 Test Loss: 0.591 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.76064133644104
Epoch: 39, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.863 Test Loss: 0.590 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8081798553466797
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.859 Test Loss: 0.601 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7117879390716553
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.866 Test Loss: 0.597 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865619).  Saving model ...
Epoch: 42 cost time: 0.7453253269195557
Epoch: 42, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.866 Test Loss: 0.598 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7189846038818359
Epoch: 43, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.866 Test Loss: 0.598 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7390081882476807
Epoch: 44, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.863 Test Loss: 0.602 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7923159599304199
Epoch: 45, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.866 Test Loss: 0.593 Test Acc: 0.866
Validation loss decreased (-0.865619 --> -0.865619).  Saving model ...
Epoch: 46 cost time: 0.748384952545166
Epoch: 46, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.866 Test Loss: 0.598 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7322554588317871
Epoch: 47, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.866 Test Loss: 0.604 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7963736057281494
Epoch: 48, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.866 Test Loss: 0.597 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7242128849029541
Epoch: 49, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.869 Test Loss: 0.593 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 50 cost time: 0.7444579601287842
Epoch: 50, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.869 Test Loss: 0.599 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6860780715942383
Epoch: 51, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.869 Test Loss: 0.606 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7021565437316895
Epoch: 52, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.866 Test Loss: 0.615 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.6910645961761475
Epoch: 53, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.869 Test Loss: 0.614 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.6686110496520996
Epoch: 54, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.866 Test Loss: 0.615 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.7295916080474854
Epoch: 55, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.866 Test Loss: 0.617 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.7103919982910156
Epoch: 56, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.866 Test Loss: 0.615 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.8444230556488037
Epoch: 57, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.869 Test Loss: 0.611 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.7962074279785156
Epoch: 58, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.869 Test Loss: 0.617 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.7068548202514648
Epoch: 59, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.869 Test Loss: 0.622 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 295752
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3578386306762695
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.027 Vali Acc: 0.178 Test Loss: 2.027 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.7878847122192383
Epoch: 2, Steps: 8 | Train Loss: 1.911 Vali Loss: 1.666 Vali Acc: 0.494 Test Loss: 1.666 Test Acc: 0.494
Validation loss decreased (-0.178105 --> -0.493733).  Saving model ...
Epoch: 3 cost time: 0.6485590934753418
Epoch: 3, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.236 Vali Acc: 0.722 Test Loss: 1.236 Test Acc: 0.722
Validation loss decreased (-0.493733 --> -0.721863).  Saving model ...
Epoch: 4 cost time: 0.6588799953460693
Epoch: 4, Steps: 8 | Train Loss: 1.121 Vali Loss: 0.907 Vali Acc: 0.772 Test Loss: 0.907 Test Acc: 0.772
Validation loss decreased (-0.721863 --> -0.771866).  Saving model ...
Epoch: 5 cost time: 0.6610920429229736
Epoch: 5, Steps: 8 | Train Loss: 0.845 Vali Loss: 0.706 Vali Acc: 0.797 Test Loss: 0.706 Test Acc: 0.797
Validation loss decreased (-0.771866 --> -0.796868).  Saving model ...
Epoch: 6 cost time: 0.844658374786377
Epoch: 6, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
Validation loss decreased (-0.796868 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 0.7165415287017822
Epoch: 7, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.7626101970672607
Epoch: 8, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.8091142177581787
Epoch: 9, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.6580634117126465
Epoch: 10, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.6740403175354004
Epoch: 11, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.6676006317138672
Epoch: 12, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.447 Vali Acc: 0.847 Test Loss: 0.447 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7341036796569824
Epoch: 13, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7215096950531006
Epoch: 14, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7483808994293213
Epoch: 15, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.452 Vali Acc: 0.863 Test Loss: 0.452 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 0.6568193435668945
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8270432949066162
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.451 Vali Acc: 0.853 Test Loss: 0.451 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7392876148223877
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7238671779632568
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7026958465576172
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6185464859008789
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6604225635528564
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.665435791015625
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7568161487579346
Epoch: 24, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6877374649047852
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.461 Vali Acc: 0.863 Test Loss: 0.461 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 285384
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1419026851654053
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.097 Vali Acc: 0.175 Test Loss: 2.097 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 0.6463820934295654
Epoch: 2, Steps: 8 | Train Loss: 1.925 Vali Loss: 1.769 Vali Acc: 0.356 Test Loss: 1.769 Test Acc: 0.356
Validation loss decreased (-0.174979 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 0.7121133804321289
Epoch: 3, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.370 Vali Acc: 0.647 Test Loss: 1.370 Test Acc: 0.647
Validation loss decreased (-0.356232 --> -0.646861).  Saving model ...
Epoch: 4 cost time: 0.731619119644165
Epoch: 4, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.040 Vali Acc: 0.716 Test Loss: 1.040 Test Acc: 0.716
Validation loss decreased (-0.646861 --> -0.715615).  Saving model ...
Epoch: 5 cost time: 0.6671161651611328
Epoch: 5, Steps: 8 | Train Loss: 0.920 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
Validation loss decreased (-0.715615 --> -0.771867).  Saving model ...
Epoch: 6 cost time: 0.6787543296813965
Epoch: 6, Steps: 8 | Train Loss: 0.729 Vali Loss: 0.676 Vali Acc: 0.794 Test Loss: 0.676 Test Acc: 0.794
Validation loss decreased (-0.771867 --> -0.793743).  Saving model ...
Epoch: 7 cost time: 0.7091889381408691
Epoch: 7, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.585 Vali Acc: 0.806 Test Loss: 0.585 Test Acc: 0.806
Validation loss decreased (-0.793743 --> -0.806244).  Saving model ...
Epoch: 8 cost time: 0.6724798679351807
Epoch: 8, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815620).  Saving model ...
Epoch: 9 cost time: 0.6504049301147461
Epoch: 9, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
Validation loss decreased (-0.815620 --> -0.815620).  Saving model ...
Epoch: 10 cost time: 0.7057516574859619
Epoch: 10, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
Validation loss decreased (-0.815620 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.7368068695068359
Epoch: 11, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.766258716583252
Epoch: 12, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.7904708385467529
Epoch: 13, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.7740044593811035
Epoch: 14, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.7641575336456299
Epoch: 15, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.450 Vali Acc: 0.834 Test Loss: 0.450 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7005689144134521
Epoch: 16, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837496).  Saving model ...
Epoch: 17 cost time: 0.7818424701690674
Epoch: 17, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
Validation loss decreased (-0.837496 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 0.7696483135223389
Epoch: 18, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.439 Vali Acc: 0.841 Test Loss: 0.439 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840621).  Saving model ...
Epoch: 19 cost time: 0.7058370113372803
Epoch: 19, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6897356510162354
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.441 Vali Acc: 0.847 Test Loss: 0.441 Test Acc: 0.847
Validation loss decreased (-0.840621 --> -0.846871).  Saving model ...
Epoch: 21 cost time: 0.7557079792022705
Epoch: 21, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.439 Vali Acc: 0.853 Test Loss: 0.439 Test Acc: 0.853
Validation loss decreased (-0.846871 --> -0.853121).  Saving model ...
Epoch: 22 cost time: 0.6956822872161865
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
Validation loss decreased (-0.853121 --> -0.862496).  Saving model ...
Epoch: 23 cost time: 0.8090901374816895
Epoch: 23, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7581882476806641
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.441 Vali Acc: 0.853 Test Loss: 0.441 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7136750221252441
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.443 Vali Acc: 0.853 Test Loss: 0.443 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.774531364440918
Epoch: 26, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.442 Vali Acc: 0.859 Test Loss: 0.442 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7565908432006836
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.440 Vali Acc: 0.859 Test Loss: 0.440 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.780517578125
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.446 Vali Acc: 0.863 Test Loss: 0.446 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7873320579528809
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7478199005126953
Epoch: 30, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7606508731842041
Epoch: 31, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7098245620727539
Epoch: 32, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm128_nh16_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 281288
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3919014930725098
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.828 Vali Acc: 0.403 Test Loss: 1.828 Test Acc: 0.403
Validation loss decreased (inf --> -0.403107).  Saving model ...
Epoch: 2 cost time: 1.1134765148162842
Epoch: 2, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.068 Vali Acc: 0.753 Test Loss: 1.068 Test Acc: 0.753
Validation loss decreased (-0.403107 --> -0.753114).  Saving model ...
Epoch: 3 cost time: 1.0732982158660889
Epoch: 3, Steps: 8 | Train Loss: 0.896 Vali Loss: 0.623 Vali Acc: 0.809 Test Loss: 0.623 Test Acc: 0.809
Validation loss decreased (-0.753114 --> -0.809369).  Saving model ...
Epoch: 4 cost time: 1.2931785583496094
Epoch: 4, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.809369 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.4562175273895264
Epoch: 5, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.497 Vali Acc: 0.834 Test Loss: 0.497 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5762083530426025
Epoch: 6, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 1.3486452102661133
Epoch: 7, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4938387870788574
Epoch: 8, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5543086528778076
Epoch: 9, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.580 Vali Acc: 0.859 Test Loss: 0.580 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859369).  Saving model ...
Epoch: 10 cost time: 1.5071918964385986
Epoch: 10, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.630 Vali Acc: 0.834 Test Loss: 0.630 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.606999158859253
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.700 Vali Acc: 0.838 Test Loss: 0.700 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2531661987304688
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.732 Vali Acc: 0.825 Test Loss: 0.732 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.677647590637207
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.696 Vali Acc: 0.834 Test Loss: 0.696 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5046634674072266
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.496669054031372
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.742 Vali Acc: 0.831 Test Loss: 0.742 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.361145257949829
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.752 Vali Acc: 0.831 Test Loss: 0.752 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4773640632629395
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.760 Vali Acc: 0.834 Test Loss: 0.760 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.506134271621704
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.776 Vali Acc: 0.831 Test Loss: 0.776 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5423710346221924
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.831 Test Loss: 0.782 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 270408
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3052661418914795
Epoch: 1, Steps: 8 | Train Loss: 2.103 Vali Loss: 1.835 Vali Acc: 0.369 Test Loss: 1.835 Test Acc: 0.369
Validation loss decreased (inf --> -0.368732).  Saving model ...
Epoch: 2 cost time: 0.8077352046966553
Epoch: 2, Steps: 8 | Train Loss: 1.730 Vali Loss: 1.387 Vali Acc: 0.644 Test Loss: 1.387 Test Acc: 0.644
Validation loss decreased (-0.368732 --> -0.643736).  Saving model ...
Epoch: 3 cost time: 0.8066132068634033
Epoch: 3, Steps: 8 | Train Loss: 1.244 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
Validation loss decreased (-0.643736 --> -0.728115).  Saving model ...
Epoch: 4 cost time: 0.7880170345306396
Epoch: 4, Steps: 8 | Train Loss: 0.853 Vali Loss: 0.687 Vali Acc: 0.784 Test Loss: 0.687 Test Acc: 0.784
Validation loss decreased (-0.728115 --> -0.784368).  Saving model ...
Epoch: 5 cost time: 0.7776913642883301
Epoch: 5, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
Validation loss decreased (-0.784368 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.8342278003692627
Epoch: 6, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7879364490509033
Epoch: 7, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.8618972301483154
Epoch: 8, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6947481632232666
Epoch: 9, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.6533350944519043
Epoch: 10, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7623870372772217
Epoch: 11, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8027715682983398
Epoch: 12, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.592 Vali Acc: 0.828 Test Loss: 0.592 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8208551406860352
Epoch: 13, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8307459354400635
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.607 Vali Acc: 0.834 Test Loss: 0.607 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7876832485198975
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.649 Vali Acc: 0.838 Test Loss: 0.649 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7088029384613037
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6755173206329346
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8500494956970215
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.656 Vali Acc: 0.847 Test Loss: 0.656 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846868).  Saving model ...
Epoch: 19 cost time: 0.8193247318267822
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.8147869110107422
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.683 Vali Acc: 0.847 Test Loss: 0.683 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.780695915222168
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6387717723846436
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.679 Vali Acc: 0.853 Test Loss: 0.679 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853118).  Saving model ...
Epoch: 23 cost time: 0.8507792949676514
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7965977191925049
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.827139139175415
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.693 Vali Acc: 0.847 Test Loss: 0.693 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8223505020141602
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5802268981933594
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7479140758514404
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.847 Test Loss: 0.712 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7763137817382812
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7716217041015625
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7986056804656982
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8172369003295898
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 211016
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4702723026275635
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 1.890 Vali Acc: 0.319 Test Loss: 1.890 Test Acc: 0.319
Validation loss decreased (inf --> -0.318731).  Saving model ...
Epoch: 2 cost time: 0.7255041599273682
Epoch: 2, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.550 Vali Acc: 0.544 Test Loss: 1.550 Test Acc: 0.544
Validation loss decreased (-0.318731 --> -0.543734).  Saving model ...
Epoch: 3 cost time: 0.8096706867218018
Epoch: 3, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.155 Vali Acc: 0.728 Test Loss: 1.155 Test Acc: 0.728
Validation loss decreased (-0.543734 --> -0.728113).  Saving model ...
Epoch: 4 cost time: 0.9633033275604248
Epoch: 4, Steps: 8 | Train Loss: 1.074 Vali Loss: 0.850 Vali Acc: 0.784 Test Loss: 0.850 Test Acc: 0.784
Validation loss decreased (-0.728113 --> -0.784366).  Saving model ...
Epoch: 5 cost time: 0.909447431564331
Epoch: 5, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.654 Vali Acc: 0.812 Test Loss: 0.654 Test Acc: 0.812
Validation loss decreased (-0.784366 --> -0.812493).  Saving model ...
Epoch: 6 cost time: 0.8586006164550781
Epoch: 6, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824995).  Saving model ...
Epoch: 7 cost time: 0.7416322231292725
Epoch: 7, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.8669934272766113
Epoch: 8, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.828120 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.8484225273132324
Epoch: 9, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9056077003479004
Epoch: 10, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.72226881980896
Epoch: 11, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8855555057525635
Epoch: 12, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.484 Vali Acc: 0.866 Test Loss: 0.484 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 13 cost time: 0.9008736610412598
Epoch: 13, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8145780563354492
Epoch: 14, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8320281505584717
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7478761672973633
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.534 Vali Acc: 0.853 Test Loss: 0.534 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8575682640075684
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8710465431213379
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7340846061706543
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7161920070648193
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8378729820251465
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6829383373260498
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.584 Vali Acc: 0.847 Test Loss: 0.584 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 191560
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3911526203155518
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 2.061 Vali Acc: 0.175 Test Loss: 2.061 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 0.7804317474365234
Epoch: 2, Steps: 8 | Train Loss: 1.949 Vali Loss: 1.737 Vali Acc: 0.338 Test Loss: 1.737 Test Acc: 0.338
Validation loss decreased (-0.174979 --> -0.337483).  Saving model ...
Epoch: 3 cost time: 0.8006932735443115
Epoch: 3, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.370 Vali Acc: 0.647 Test Loss: 1.370 Test Acc: 0.647
Validation loss decreased (-0.337483 --> -0.646861).  Saving model ...
Epoch: 4 cost time: 0.8394262790679932
Epoch: 4, Steps: 8 | Train Loss: 1.265 Vali Loss: 1.046 Vali Acc: 0.738 Test Loss: 1.046 Test Acc: 0.738
Validation loss decreased (-0.646861 --> -0.737490).  Saving model ...
Epoch: 5 cost time: 0.7698867321014404
Epoch: 5, Steps: 8 | Train Loss: 0.885 Vali Loss: 0.818 Vali Acc: 0.787 Test Loss: 0.818 Test Acc: 0.787
Validation loss decreased (-0.737490 --> -0.787492).  Saving model ...
Epoch: 6 cost time: 0.6683857440948486
Epoch: 6, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
Validation loss decreased (-0.787492 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 0.8283751010894775
Epoch: 7, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 0.8274679183959961
Epoch: 8, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.6831874847412109
Epoch: 9, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 0.7194421291351318
Epoch: 10, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.8507914543151855
Epoch: 11, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8051776885986328
Epoch: 12, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8043696880340576
Epoch: 13, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8485395908355713
Epoch: 14, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.8543601036071777
Epoch: 15, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7443125247955322
Epoch: 16, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7695262432098389
Epoch: 17, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 0.854273796081543
Epoch: 18, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.565 Vali Acc: 0.834 Test Loss: 0.565 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7739083766937256
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8533809185028076
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8551657199859619
Epoch: 21, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7124824523925781
Epoch: 22, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8263721466064453
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7741611003875732
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7569582462310791
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.602 Vali Acc: 0.834 Test Loss: 0.602 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8124978542327881
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.838 Test Loss: 0.604 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8122050762176514
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.608 Vali Acc: 0.834 Test Loss: 0.608 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 181320
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2377407550811768
Epoch: 1, Steps: 8 | Train Loss: 2.295 Vali Loss: 2.096 Vali Acc: 0.200 Test Loss: 2.096 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 0.8260340690612793
Epoch: 2, Steps: 8 | Train Loss: 2.085 Vali Loss: 1.821 Vali Acc: 0.388 Test Loss: 1.821 Test Acc: 0.388
Validation loss decreased (-0.199979 --> -0.387482).  Saving model ...
Epoch: 3 cost time: 0.7539596557617188
Epoch: 3, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.487 Vali Acc: 0.588 Test Loss: 1.487 Test Acc: 0.588
Validation loss decreased (-0.387482 --> -0.587485).  Saving model ...
Epoch: 4 cost time: 0.9075689315795898
Epoch: 4, Steps: 8 | Train Loss: 1.409 Vali Loss: 1.176 Vali Acc: 0.703 Test Loss: 1.176 Test Acc: 0.703
Validation loss decreased (-0.587485 --> -0.703113).  Saving model ...
Epoch: 5 cost time: 0.8337371349334717
Epoch: 5, Steps: 8 | Train Loss: 1.072 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.703113 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.8178653717041016
Epoch: 6, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
Validation loss decreased (-0.774991 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 0.7665796279907227
Epoch: 7, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 0.8690533638000488
Epoch: 8, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.7456521987915039
Epoch: 9, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 0.8112127780914307
Epoch: 10, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.7150478363037109
Epoch: 11, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8351047039031982
Epoch: 12, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.483 Vali Acc: 0.834 Test Loss: 0.483 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8177375793457031
Epoch: 13, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7364857196807861
Epoch: 14, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.8839526176452637
Epoch: 15, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8283953666687012
Epoch: 16, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7974343299865723
Epoch: 17, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.699979305267334
Epoch: 18, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.6514253616333008
Epoch: 19, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6714892387390137
Epoch: 20, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 0.6715235710144043
Epoch: 21, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 22 cost time: 0.7015535831451416
Epoch: 22, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6662499904632568
Epoch: 23, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 24 cost time: 0.749971866607666
Epoch: 24, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7230663299560547
Epoch: 25, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.500 Vali Acc: 0.863 Test Loss: 0.500 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 26 cost time: 0.7227654457092285
Epoch: 26, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.502 Vali Acc: 0.859 Test Loss: 0.502 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7288336753845215
Epoch: 27, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.81205153465271
Epoch: 28, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8904640674591064
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7642645835876465
Epoch: 30, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8441817760467529
Epoch: 31, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8475680351257324
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7769269943237305
Epoch: 33, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8493185043334961
Epoch: 34, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.508 Vali Acc: 0.859 Test Loss: 0.508 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7430033683776855
Epoch: 35, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 173128
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.500396490097046
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.098 Vali Acc: 0.181 Test Loss: 2.098 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 0.809457540512085
Epoch: 2, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.858 Vali Acc: 0.325 Test Loss: 1.858 Test Acc: 0.325
Validation loss decreased (-0.181229 --> -0.324981).  Saving model ...
Epoch: 3 cost time: 0.8172481060028076
Epoch: 3, Steps: 8 | Train Loss: 1.697 Vali Loss: 1.560 Vali Acc: 0.500 Test Loss: 1.560 Test Acc: 0.500
Validation loss decreased (-0.324981 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 0.8337864875793457
Epoch: 4, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.263 Vali Acc: 0.688 Test Loss: 1.263 Test Acc: 0.688
Validation loss decreased (-0.499984 --> -0.687487).  Saving model ...
Epoch: 5 cost time: 0.7849838733673096
Epoch: 5, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
Validation loss decreased (-0.687487 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.9318656921386719
Epoch: 6, Steps: 8 | Train Loss: 0.932 Vali Loss: 0.838 Vali Acc: 0.781 Test Loss: 0.838 Test Acc: 0.781
Validation loss decreased (-0.749990 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.7348439693450928
Epoch: 7, Steps: 8 | Train Loss: 0.776 Vali Loss: 0.724 Vali Acc: 0.784 Test Loss: 0.724 Test Acc: 0.784
Validation loss decreased (-0.781242 --> -0.784368).  Saving model ...
Epoch: 8 cost time: 0.7754490375518799
Epoch: 8, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
Validation loss decreased (-0.784368 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 0.772150993347168
Epoch: 9, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
Validation loss decreased (-0.799994 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.7141804695129395
Epoch: 10, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.545 Vali Acc: 0.834 Test Loss: 0.545 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.8502297401428223
Epoch: 11, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 0.7572076320648193
Epoch: 12, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8601305484771729
Epoch: 13, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 0.8091151714324951
Epoch: 14, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7088367938995361
Epoch: 15, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7052128314971924
Epoch: 16, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6640956401824951
Epoch: 17, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.6838130950927734
Epoch: 18, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.6415319442749023
Epoch: 19, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.742140531539917
Epoch: 20, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 21 cost time: 0.6528806686401367
Epoch: 21, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 22 cost time: 0.7310340404510498
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.684222936630249
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6592831611633301
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7839376926422119
Epoch: 25, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8525662422180176
Epoch: 26, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.468 Vali Acc: 0.869 Test Loss: 0.468 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8045599460601807
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7019124031066895
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6407554149627686
Epoch: 29, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8550236225128174
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7523837089538574
Epoch: 31, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.460 Vali Acc: 0.869 Test Loss: 0.460 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7678887844085693
Epoch: 32, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 167944
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4095165729522705
Epoch: 1, Steps: 8 | Train Loss: 2.303 Vali Loss: 2.218 Vali Acc: 0.084 Test Loss: 2.218 Test Acc: 0.084
Validation loss decreased (inf --> -0.084353).  Saving model ...
Epoch: 2 cost time: 0.653942346572876
Epoch: 2, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.994 Vali Acc: 0.184 Test Loss: 1.994 Test Acc: 0.184
Validation loss decreased (-0.084353 --> -0.184355).  Saving model ...
Epoch: 3 cost time: 0.6319451332092285
Epoch: 3, Steps: 8 | Train Loss: 1.906 Vali Loss: 1.713 Vali Acc: 0.378 Test Loss: 1.713 Test Acc: 0.378
Validation loss decreased (-0.184355 --> -0.378108).  Saving model ...
Epoch: 4 cost time: 0.7961680889129639
Epoch: 4, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.423 Vali Acc: 0.625 Test Loss: 1.423 Test Acc: 0.625
Validation loss decreased (-0.378108 --> -0.624986).  Saving model ...
Epoch: 5 cost time: 0.7239108085632324
Epoch: 5, Steps: 8 | Train Loss: 1.363 Vali Loss: 1.170 Vali Acc: 0.738 Test Loss: 1.170 Test Acc: 0.738
Validation loss decreased (-0.624986 --> -0.737488).  Saving model ...
Epoch: 6 cost time: 0.7290375232696533
Epoch: 6, Steps: 8 | Train Loss: 1.140 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
Validation loss decreased (-0.737488 --> -0.768740).  Saving model ...
Epoch: 7 cost time: 0.6464364528656006
Epoch: 7, Steps: 8 | Train Loss: 0.931 Vali Loss: 0.822 Vali Acc: 0.787 Test Loss: 0.822 Test Acc: 0.787
Validation loss decreased (-0.768740 --> -0.787492).  Saving model ...
Epoch: 8 cost time: 0.7787718772888184
Epoch: 8, Steps: 8 | Train Loss: 0.774 Vali Loss: 0.714 Vali Acc: 0.809 Test Loss: 0.714 Test Acc: 0.809
Validation loss decreased (-0.787492 --> -0.809368).  Saving model ...
Epoch: 9 cost time: 0.7590014934539795
Epoch: 9, Steps: 8 | Train Loss: 0.646 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8253967761993408
Epoch: 10, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.601 Vali Acc: 0.806 Test Loss: 0.601 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6884095668792725
Epoch: 11, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.6101737022399902
Epoch: 12, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.7224898338317871
Epoch: 13, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 14 cost time: 0.7242014408111572
Epoch: 14, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.7776706218719482
Epoch: 15, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.6771230697631836
Epoch: 16, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.78360915184021
Epoch: 17, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.7115647792816162
Epoch: 18, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 19 cost time: 0.661989688873291
Epoch: 19, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7613544464111328
Epoch: 20, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6237504482269287
Epoch: 21, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8360836505889893
Epoch: 22, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.78017258644104
Epoch: 23, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7928385734558105
Epoch: 24, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7325966358184814
Epoch: 25, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6780176162719727
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7296137809753418
Epoch: 27, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6976537704467773
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.437 Vali Acc: 0.853 Test Loss: 0.437 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 165896
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.46574330329895
Epoch: 1, Steps: 8 | Train Loss: 2.115 Vali Loss: 1.774 Vali Acc: 0.456 Test Loss: 1.774 Test Acc: 0.456
Validation loss decreased (inf --> -0.456232).  Saving model ...
Epoch: 2 cost time: 1.535811185836792
Epoch: 2, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.036 Vali Acc: 0.809 Test Loss: 1.036 Test Acc: 0.809
Validation loss decreased (-0.456232 --> -0.809365).  Saving model ...
Epoch: 3 cost time: 1.18619966506958
Epoch: 3, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.639 Vali Acc: 0.812 Test Loss: 0.639 Test Acc: 0.812
Validation loss decreased (-0.809365 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 1.1907188892364502
Epoch: 4, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.812494 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.354588508605957
Epoch: 5, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0552449226379395
Epoch: 6, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3274502754211426
Epoch: 7, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1847751140594482
Epoch: 8, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 1.1843528747558594
Epoch: 9, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.445514440536499
Epoch: 10, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.152022361755371
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0672316551208496
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.834 Vali Acc: 0.822 Test Loss: 0.834 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.316890001296997
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.758 Vali Acc: 0.828 Test Loss: 0.758 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.980832576751709
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.728 Vali Acc: 0.841 Test Loss: 0.728 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3081636428833008
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.759 Vali Acc: 0.834 Test Loss: 0.759 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2830276489257812
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.791 Vali Acc: 0.822 Test Loss: 0.791 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.149305820465088
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.801 Vali Acc: 0.822 Test Loss: 0.801 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.355518102645874
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 220872
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.211815118789673
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 1.945 Vali Acc: 0.350 Test Loss: 1.945 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 0.7137458324432373
Epoch: 2, Steps: 8 | Train Loss: 1.780 Vali Loss: 1.518 Vali Acc: 0.550 Test Loss: 1.518 Test Acc: 0.550
Validation loss decreased (-0.349981 --> -0.549985).  Saving model ...
Epoch: 3 cost time: 0.6763021945953369
Epoch: 3, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.073 Vali Acc: 0.756 Test Loss: 1.073 Test Acc: 0.756
Validation loss decreased (-0.549985 --> -0.756239).  Saving model ...
Epoch: 4 cost time: 0.6868507862091064
Epoch: 4, Steps: 8 | Train Loss: 0.917 Vali Loss: 0.769 Vali Acc: 0.784 Test Loss: 0.769 Test Acc: 0.784
Validation loss decreased (-0.756239 --> -0.784367).  Saving model ...
Epoch: 5 cost time: 0.6812057495117188
Epoch: 5, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
Validation loss decreased (-0.784367 --> -0.803119).  Saving model ...
Epoch: 6 cost time: 0.6504733562469482
Epoch: 6, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
Validation loss decreased (-0.803119 --> -0.815620).  Saving model ...
Epoch: 7 cost time: 0.6794285774230957
Epoch: 7, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
Validation loss decreased (-0.815620 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.6685748100280762
Epoch: 8, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.6239950656890869
Epoch: 9, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.708686351776123
Epoch: 10, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.874798059463501
Epoch: 11, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8305068016052246
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7215054035186768
Epoch: 13, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.614 Vali Acc: 0.831 Test Loss: 0.614 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7495088577270508
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.633 Vali Acc: 0.831 Test Loss: 0.633 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7671570777893066
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.630 Vali Acc: 0.831 Test Loss: 0.630 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6636486053466797
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7959942817687988
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7873950004577637
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8084657192230225
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.670 Vali Acc: 0.831 Test Loss: 0.670 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 161480
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.092261552810669
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 1.996 Vali Acc: 0.156 Test Loss: 1.996 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 0.7743570804595947
Epoch: 2, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.659 Vali Acc: 0.494 Test Loss: 1.659 Test Acc: 0.494
Validation loss decreased (-0.156230 --> -0.493733).  Saving model ...
Epoch: 3 cost time: 0.7452645301818848
Epoch: 3, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.259 Vali Acc: 0.747 Test Loss: 1.259 Test Acc: 0.747
Validation loss decreased (-0.493733 --> -0.746862).  Saving model ...
Epoch: 4 cost time: 0.7825899124145508
Epoch: 4, Steps: 8 | Train Loss: 1.173 Vali Loss: 0.919 Vali Acc: 0.791 Test Loss: 0.919 Test Acc: 0.791
Validation loss decreased (-0.746862 --> -0.790616).  Saving model ...
Epoch: 5 cost time: 0.7197465896606445
Epoch: 5, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
Validation loss decreased (-0.790616 --> -0.806243).  Saving model ...
Epoch: 6 cost time: 0.6529738903045654
Epoch: 6, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8342456817626953
Epoch: 7, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.546 Vali Acc: 0.806 Test Loss: 0.546 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806245).  Saving model ...
Epoch: 8 cost time: 0.7268836498260498
Epoch: 8, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.497 Vali Acc: 0.828 Test Loss: 0.497 Test Acc: 0.828
Validation loss decreased (-0.806245 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 0.7570610046386719
Epoch: 9, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.6646385192871094
Epoch: 10, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7982094287872314
Epoch: 11, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7210254669189453
Epoch: 12, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6836905479431152
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7461667060852051
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6724700927734375
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7363460063934326
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6274621486663818
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6850197315216064
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6428649425506592
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 142024
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3507659435272217
Epoch: 1, Steps: 8 | Train Loss: 2.243 Vali Loss: 1.971 Vali Acc: 0.209 Test Loss: 1.971 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 0.6813220977783203
Epoch: 2, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.683 Vali Acc: 0.447 Test Loss: 1.683 Test Acc: 0.447
Validation loss decreased (-0.209355 --> -0.446858).  Saving model ...
Epoch: 3 cost time: 0.5970752239227295
Epoch: 3, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.333 Vali Acc: 0.666 Test Loss: 1.333 Test Acc: 0.666
Validation loss decreased (-0.446858 --> -0.665612).  Saving model ...
Epoch: 4 cost time: 0.6373214721679688
Epoch: 4, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.020 Vali Acc: 0.744 Test Loss: 1.020 Test Acc: 0.744
Validation loss decreased (-0.665612 --> -0.743740).  Saving model ...
Epoch: 5 cost time: 0.6785662174224854
Epoch: 5, Steps: 8 | Train Loss: 0.937 Vali Loss: 0.788 Vali Acc: 0.781 Test Loss: 0.788 Test Acc: 0.781
Validation loss decreased (-0.743740 --> -0.781242).  Saving model ...
Epoch: 6 cost time: 0.7443499565124512
Epoch: 6, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799994).  Saving model ...
Epoch: 7 cost time: 0.6897120475769043
Epoch: 7, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.799994 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 0.6301519870758057
Epoch: 8, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7209184169769287
Epoch: 9, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.6641499996185303
Epoch: 10, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.6763205528259277
Epoch: 11, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7523927688598633
Epoch: 12, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.6352403163909912
Epoch: 13, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7647781372070312
Epoch: 14, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7960400581359863
Epoch: 15, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7465894222259521
Epoch: 16, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8158566951751709
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7203757762908936
Epoch: 18, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.67392897605896
Epoch: 19, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 20 cost time: 0.7930457592010498
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 21 cost time: 0.6994674205780029
Epoch: 21, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 0.8255689144134521
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7181360721588135
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7588236331939697
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.580 Vali Acc: 0.834 Test Loss: 0.580 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8200817108154297
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.578 Vali Acc: 0.834 Test Loss: 0.578 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7092084884643555
Epoch: 26, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.594 Vali Acc: 0.834 Test Loss: 0.594 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.692180871963501
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.605 Vali Acc: 0.831 Test Loss: 0.605 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7838847637176514
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.606 Vali Acc: 0.838 Test Loss: 0.606 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6924097537994385
Epoch: 29, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.601 Vali Acc: 0.838 Test Loss: 0.601 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8028116226196289
Epoch: 30, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.831 Test Loss: 0.596 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7849292755126953
Epoch: 31, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.592 Vali Acc: 0.834 Test Loss: 0.592 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 131784
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3057212829589844
Epoch: 1, Steps: 8 | Train Loss: 2.142 Vali Loss: 2.069 Vali Acc: 0.156 Test Loss: 2.069 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.6521317958831787
Epoch: 2, Steps: 8 | Train Loss: 2.000 Vali Loss: 1.816 Vali Acc: 0.319 Test Loss: 1.816 Test Acc: 0.319
Validation loss decreased (-0.156229 --> -0.318732).  Saving model ...
Epoch: 3 cost time: 0.8006303310394287
Epoch: 3, Steps: 8 | Train Loss: 1.669 Vali Loss: 1.493 Vali Acc: 0.553 Test Loss: 1.493 Test Acc: 0.553
Validation loss decreased (-0.318732 --> -0.553110).  Saving model ...
Epoch: 4 cost time: 0.7443852424621582
Epoch: 4, Steps: 8 | Train Loss: 1.444 Vali Loss: 1.177 Vali Acc: 0.678 Test Loss: 1.177 Test Acc: 0.678
Validation loss decreased (-0.553110 --> -0.678113).  Saving model ...
Epoch: 5 cost time: 0.8031008243560791
Epoch: 5, Steps: 8 | Train Loss: 1.150 Vali Loss: 0.921 Vali Acc: 0.753 Test Loss: 0.921 Test Acc: 0.753
Validation loss decreased (-0.678113 --> -0.753116).  Saving model ...
Epoch: 6 cost time: 0.8585453033447266
Epoch: 6, Steps: 8 | Train Loss: 0.862 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
Validation loss decreased (-0.753116 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 0.805107831954956
Epoch: 7, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.632 Vali Acc: 0.812 Test Loss: 0.632 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 0.7428967952728271
Epoch: 8, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.6319162845611572
Epoch: 9, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.8130319118499756
Epoch: 10, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.8224329948425293
Epoch: 11, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.801537275314331
Epoch: 12, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.788076639175415
Epoch: 13, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8218026161193848
Epoch: 14, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8446733951568604
Epoch: 15, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.806614875793457
Epoch: 16, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 0.8874106407165527
Epoch: 17, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8405196666717529
Epoch: 18, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7888023853302002
Epoch: 19, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7880899906158447
Epoch: 20, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7604861259460449
Epoch: 21, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8242630958557129
Epoch: 22, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8237438201904297
Epoch: 23, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 24 cost time: 0.9218673706054688
Epoch: 24, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8399381637573242
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7081680297851562
Epoch: 26, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8447771072387695
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8135898113250732
Epoch: 28, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7690839767456055
Epoch: 29, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7182338237762451
Epoch: 30, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7430193424224854
Epoch: 31, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7400698661804199
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.557 Vali Acc: 0.853 Test Loss: 0.557 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.904188871383667
Epoch: 33, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 123592
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.311373710632324
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 2.088 Vali Acc: 0.163 Test Loss: 2.088 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 0.7541186809539795
Epoch: 2, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.884 Vali Acc: 0.322 Test Loss: 1.884 Test Acc: 0.322
Validation loss decreased (-0.162479 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 0.7572362422943115
Epoch: 3, Steps: 8 | Train Loss: 1.796 Vali Loss: 1.618 Vali Acc: 0.466 Test Loss: 1.618 Test Acc: 0.466
Validation loss decreased (-0.321856 --> -0.465609).  Saving model ...
Epoch: 4 cost time: 0.8354086875915527
Epoch: 4, Steps: 8 | Train Loss: 1.514 Vali Loss: 1.338 Vali Acc: 0.622 Test Loss: 1.338 Test Acc: 0.622
Validation loss decreased (-0.465609 --> -0.621862).  Saving model ...
Epoch: 5 cost time: 0.6332111358642578
Epoch: 5, Steps: 8 | Train Loss: 1.180 Vali Loss: 1.101 Vali Acc: 0.713 Test Loss: 1.101 Test Acc: 0.713
Validation loss decreased (-0.621862 --> -0.712489).  Saving model ...
Epoch: 6 cost time: 0.703789472579956
Epoch: 6, Steps: 8 | Train Loss: 1.019 Vali Loss: 0.909 Vali Acc: 0.766 Test Loss: 0.909 Test Acc: 0.766
Validation loss decreased (-0.712489 --> -0.765616).  Saving model ...
Epoch: 7 cost time: 0.7909815311431885
Epoch: 7, Steps: 8 | Train Loss: 0.856 Vali Loss: 0.772 Vali Acc: 0.794 Test Loss: 0.772 Test Acc: 0.794
Validation loss decreased (-0.765616 --> -0.793742).  Saving model ...
Epoch: 8 cost time: 0.8372282981872559
Epoch: 8, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
Validation loss decreased (-0.793742 --> -0.803118).  Saving model ...
Epoch: 9 cost time: 0.7937796115875244
Epoch: 9, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.7805013656616211
Epoch: 10, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 11 cost time: 0.7343161106109619
Epoch: 11, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.8564856052398682
Epoch: 12, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 0.8321607112884521
Epoch: 13, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.8019216060638428
Epoch: 14, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.7821526527404785
Epoch: 15, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6332643032073975
Epoch: 16, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.7930102348327637
Epoch: 17, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 0.7992637157440186
Epoch: 18, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 0.8095183372497559
Epoch: 19, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 0.8047306537628174
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.795508623123169
Epoch: 21, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6463871002197266
Epoch: 22, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7381160259246826
Epoch: 23, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.7321798801422119
Epoch: 24, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7344424724578857
Epoch: 25, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8554787635803223
Epoch: 26, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7708523273468018
Epoch: 27, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 28 cost time: 0.8024485111236572
Epoch: 28, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8114163875579834
Epoch: 29, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8126983642578125
Epoch: 30, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7877717018127441
Epoch: 31, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7759699821472168
Epoch: 32, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7934186458587646
Epoch: 33, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7378203868865967
Epoch: 34, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 35 cost time: 0.8465688228607178
Epoch: 35, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 36 cost time: 0.7500922679901123
Epoch: 36, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7189598083496094
Epoch: 37, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.820930004119873
Epoch: 38, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7823951244354248
Epoch: 39, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6957895755767822
Epoch: 40, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7658450603485107
Epoch: 41, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7469377517700195
Epoch: 42, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7575273513793945
Epoch: 43, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8132586479187012
Epoch: 44, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6320230960845947
Epoch: 45, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 118408
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.05972957611084
Epoch: 1, Steps: 8 | Train Loss: 2.207 Vali Loss: 2.081 Vali Acc: 0.169 Test Loss: 2.081 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 0.7334802150726318
Epoch: 2, Steps: 8 | Train Loss: 2.041 Vali Loss: 1.897 Vali Acc: 0.287 Test Loss: 1.897 Test Acc: 0.287
Validation loss decreased (-0.168729 --> -0.287481).  Saving model ...
Epoch: 3 cost time: 0.7309138774871826
Epoch: 3, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.657 Vali Acc: 0.497 Test Loss: 1.657 Test Acc: 0.497
Validation loss decreased (-0.287481 --> -0.496858).  Saving model ...
Epoch: 4 cost time: 0.7417879104614258
Epoch: 4, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.409 Vali Acc: 0.669 Test Loss: 1.409 Test Acc: 0.669
Validation loss decreased (-0.496858 --> -0.668736).  Saving model ...
Epoch: 5 cost time: 0.8529670238494873
Epoch: 5, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.180 Vali Acc: 0.722 Test Loss: 1.180 Test Acc: 0.722
Validation loss decreased (-0.668736 --> -0.721863).  Saving model ...
Epoch: 6 cost time: 0.8068020343780518
Epoch: 6, Steps: 8 | Train Loss: 1.120 Vali Loss: 0.999 Vali Acc: 0.747 Test Loss: 0.999 Test Acc: 0.747
Validation loss decreased (-0.721863 --> -0.746865).  Saving model ...
Epoch: 7 cost time: 0.7871396541595459
Epoch: 7, Steps: 8 | Train Loss: 0.964 Vali Loss: 0.856 Vali Acc: 0.756 Test Loss: 0.856 Test Acc: 0.756
Validation loss decreased (-0.746865 --> -0.756241).  Saving model ...
Epoch: 8 cost time: 0.723290205001831
Epoch: 8, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
Validation loss decreased (-0.756241 --> -0.778117).  Saving model ...
Epoch: 9 cost time: 0.7868895530700684
Epoch: 9, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.689 Vali Acc: 0.791 Test Loss: 0.689 Test Acc: 0.791
Validation loss decreased (-0.778117 --> -0.790618).  Saving model ...
Epoch: 10 cost time: 0.8499534130096436
Epoch: 10, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.643 Vali Acc: 0.797 Test Loss: 0.643 Test Acc: 0.797
Validation loss decreased (-0.790618 --> -0.796869).  Saving model ...
Epoch: 11 cost time: 0.7391691207885742
Epoch: 11, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
Validation loss decreased (-0.796869 --> -0.803119).  Saving model ...
Epoch: 12 cost time: 0.5870649814605713
Epoch: 12, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.563 Vali Acc: 0.812 Test Loss: 0.563 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 13 cost time: 0.6294217109680176
Epoch: 13, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 14 cost time: 0.7075009346008301
Epoch: 14, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 0.6636314392089844
Epoch: 15, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.516 Vali Acc: 0.828 Test Loss: 0.516 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 16 cost time: 0.6916558742523193
Epoch: 16, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 17 cost time: 0.6091108322143555
Epoch: 17, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 0.7145676612854004
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 0.7402725219726562
Epoch: 19, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 20 cost time: 0.7938313484191895
Epoch: 20, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 0.7232911586761475
Epoch: 21, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 0.7088730335235596
Epoch: 22, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.7888975143432617
Epoch: 23, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 24 cost time: 0.816608190536499
Epoch: 24, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7331974506378174
Epoch: 25, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 26 cost time: 0.8231906890869141
Epoch: 26, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7437283992767334
Epoch: 27, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.458 Vali Acc: 0.859 Test Loss: 0.458 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 28 cost time: 0.6427936553955078
Epoch: 28, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8321840763092041
Epoch: 29, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8334252834320068
Epoch: 30, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7380087375640869
Epoch: 31, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8044478893280029
Epoch: 32, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 33 cost time: 0.6442818641662598
Epoch: 33, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.464 Vali Acc: 0.859 Test Loss: 0.464 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7387359142303467
Epoch: 34, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7875189781188965
Epoch: 35, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.467 Vali Acc: 0.866 Test Loss: 0.467 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 36 cost time: 0.7348992824554443
Epoch: 36, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871871).  Saving model ...
Epoch: 37 cost time: 0.7491068840026855
Epoch: 37, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 38 cost time: 0.7913901805877686
Epoch: 38, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.445 Vali Acc: 0.872 Test Loss: 0.445 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.768235445022583
Epoch: 39, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.455 Vali Acc: 0.869 Test Loss: 0.455 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8280129432678223
Epoch: 40, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.456 Vali Acc: 0.866 Test Loss: 0.456 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8243858814239502
Epoch: 41, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8028805255889893
Epoch: 42, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.466 Vali Acc: 0.863 Test Loss: 0.466 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7905716896057129
Epoch: 43, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6568136215209961
Epoch: 44, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.464 Vali Acc: 0.869 Test Loss: 0.464 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7796380519866943
Epoch: 45, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.872 Test Loss: 0.459 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8171746730804443
Epoch: 46, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
Validation loss decreased (-0.871871 --> -0.874995).  Saving model ...
Epoch: 47 cost time: 0.6952135562896729
Epoch: 47, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7699539661407471
Epoch: 48, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8132648468017578
Epoch: 49, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 50 cost time: 0.6831259727478027
Epoch: 50, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6436750888824463
Epoch: 51, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7873892784118652
Epoch: 52, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8346724510192871
Epoch: 53, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.6227777004241943
Epoch: 54, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8229222297668457
Epoch: 55, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.7695097923278809
Epoch: 56, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.485 Vali Acc: 0.881 Test Loss: 0.485 Test Acc: 0.881
Validation loss decreased (-0.878120 --> -0.881245).  Saving model ...
Epoch: 57 cost time: 0.726036787033081
Epoch: 57, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.481 Vali Acc: 0.884 Test Loss: 0.481 Test Acc: 0.884
Validation loss decreased (-0.881245 --> -0.884370).  Saving model ...
Epoch: 58 cost time: 0.6858456134796143
Epoch: 58, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.474 Vali Acc: 0.884 Test Loss: 0.474 Test Acc: 0.884
Validation loss decreased (-0.884370 --> -0.884370).  Saving model ...
Epoch: 59 cost time: 0.6379492282867432
Epoch: 59, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.485 Vali Acc: 0.881 Test Loss: 0.485 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5975728034973145
Epoch: 60, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.488 Vali Acc: 0.884 Test Loss: 0.488 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6233203411102295
Epoch: 61, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.489 Vali Acc: 0.881 Test Loss: 0.489 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5830714702606201
Epoch: 62, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6184842586517334
Epoch: 63, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7046642303466797
Epoch: 64, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.7307136058807373
Epoch: 65, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.884 Test Loss: 0.483 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.6385049819946289
Epoch: 66, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.6572329998016357
Epoch: 67, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.884 Test Loss: 0.489 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.6686933040618896
Epoch: 68, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.488 Vali Acc: 0.887 Test Loss: 0.488 Test Acc: 0.887
Validation loss decreased (-0.884370 --> -0.887495).  Saving model ...
Epoch: 69 cost time: 0.7210421562194824
Epoch: 69, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.887 Test Loss: 0.489 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8120336532592773
Epoch: 70, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.887 Test Loss: 0.492 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6582558155059814
Epoch: 71, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.6678719520568848
Epoch: 72, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.8032410144805908
Epoch: 73, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.494 Vali Acc: 0.884 Test Loss: 0.494 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.8458309173583984
Epoch: 74, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.891 Test Loss: 0.486 Test Acc: 0.891
Validation loss decreased (-0.887495 --> -0.890620).  Saving model ...
Epoch: 75 cost time: 0.7787349224090576
Epoch: 75, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.491 Vali Acc: 0.887 Test Loss: 0.491 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7191376686096191
Epoch: 76, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.887 Test Loss: 0.492 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.8144936561584473
Epoch: 77, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.490 Vali Acc: 0.887 Test Loss: 0.490 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7778964042663574
Epoch: 78, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.887 Test Loss: 0.491 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.8176016807556152
Epoch: 79, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.887 Test Loss: 0.502 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.903784990310669
Epoch: 80, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.891 Test Loss: 0.505 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.7158024311065674
Epoch: 81, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.891 Test Loss: 0.502 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.8483808040618896
Epoch: 82, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.496 Vali Acc: 0.894 Test Loss: 0.496 Test Acc: 0.894
Validation loss decreased (-0.890620 --> -0.893745).  Saving model ...
Epoch: 83 cost time: 0.7257494926452637
Epoch: 83, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.496 Vali Acc: 0.894 Test Loss: 0.496 Test Acc: 0.894
Validation loss decreased (-0.893745 --> -0.893745).  Saving model ...
Epoch: 84 cost time: 0.7994589805603027
Epoch: 84, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.497 Vali Acc: 0.891 Test Loss: 0.497 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.6964013576507568
Epoch: 85, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.501 Vali Acc: 0.891 Test Loss: 0.501 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.7379696369171143
Epoch: 86, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.887 Test Loss: 0.501 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.8033769130706787
Epoch: 87, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.887 Test Loss: 0.504 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.7010517120361328
Epoch: 88, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.891 Test Loss: 0.495 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.8705675601959229
Epoch: 89, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.488 Vali Acc: 0.891 Test Loss: 0.488 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.7104325294494629
Epoch: 90, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.504 Vali Acc: 0.894 Test Loss: 0.504 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.8244943618774414
Epoch: 91, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.887 Test Loss: 0.523 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.8127121925354004
Epoch: 92, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.887 Test Loss: 0.521 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.6288127899169922
Epoch: 93, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.887 Test Loss: 0.520 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.89375
model parameter : 116360
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4816906452178955
Epoch: 1, Steps: 8 | Train Loss: 2.080 Vali Loss: 1.816 Vali Acc: 0.475 Test Loss: 1.816 Test Acc: 0.475
Validation loss decreased (inf --> -0.474982).  Saving model ...
Epoch: 2 cost time: 1.1128809452056885
Epoch: 2, Steps: 8 | Train Loss: 1.487 Vali Loss: 1.084 Vali Acc: 0.741 Test Loss: 1.084 Test Acc: 0.741
Validation loss decreased (-0.474982 --> -0.740614).  Saving model ...
Epoch: 3 cost time: 1.0431876182556152
Epoch: 3, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
Validation loss decreased (-0.740614 --> -0.803118).  Saving model ...
Epoch: 4 cost time: 0.842303991317749
Epoch: 4, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.584 Vali Acc: 0.794 Test Loss: 0.584 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8165230751037598
Epoch: 5, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.803118 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.8849778175354004
Epoch: 6, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9135885238647461
Epoch: 7, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8437423706054688
Epoch: 8, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8170883655548096
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8690500259399414
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1269655227661133
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8338630199432373
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.695 Vali Acc: 0.834 Test Loss: 0.695 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8867027759552002
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.707 Vali Acc: 0.838 Test Loss: 0.707 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9117519855499268
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.843043327331543
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.796 Vali Acc: 0.828 Test Loss: 0.796 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 196104
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2664597034454346
Epoch: 1, Steps: 8 | Train Loss: 2.213 Vali Loss: 1.997 Vali Acc: 0.287 Test Loss: 1.997 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 0.689359188079834
Epoch: 2, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.539 Vali Acc: 0.619 Test Loss: 1.539 Test Acc: 0.619
Validation loss decreased (-0.287480 --> -0.618735).  Saving model ...
Epoch: 3 cost time: 0.7937543392181396
Epoch: 3, Steps: 8 | Train Loss: 1.293 Vali Loss: 1.052 Vali Acc: 0.775 Test Loss: 1.052 Test Acc: 0.775
Validation loss decreased (-0.618735 --> -0.774989).  Saving model ...
Epoch: 4 cost time: 0.7309775352478027
Epoch: 4, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.733 Vali Acc: 0.819 Test Loss: 0.733 Test Acc: 0.819
Validation loss decreased (-0.774989 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 0.7380809783935547
Epoch: 5, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 0.7556595802307129
Epoch: 6, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.8617820739746094
Epoch: 7, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.6689662933349609
Epoch: 8, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7881312370300293
Epoch: 9, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.6348075866699219
Epoch: 10, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7679588794708252
Epoch: 11, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6927657127380371
Epoch: 12, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.680901288986206
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6798458099365234
Epoch: 14, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7111344337463379
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.607 Vali Acc: 0.831 Test Loss: 0.607 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5857665538787842
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7946276664733887
Epoch: 17, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.630 Vali Acc: 0.831 Test Loss: 0.630 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7395997047424316
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7773892879486084
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 136712
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3082334995269775
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 1.987 Vali Acc: 0.159 Test Loss: 1.987 Test Acc: 0.159
Validation loss decreased (inf --> -0.159355).  Saving model ...
Epoch: 2 cost time: 0.7908194065093994
Epoch: 2, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.643 Vali Acc: 0.525 Test Loss: 1.643 Test Acc: 0.525
Validation loss decreased (-0.159355 --> -0.524984).  Saving model ...
Epoch: 3 cost time: 0.753143310546875
Epoch: 3, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.234 Vali Acc: 0.722 Test Loss: 1.234 Test Acc: 0.722
Validation loss decreased (-0.524984 --> -0.721863).  Saving model ...
Epoch: 4 cost time: 0.8367509841918945
Epoch: 4, Steps: 8 | Train Loss: 1.107 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.721863 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 0.6751189231872559
Epoch: 5, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.724 Vali Acc: 0.794 Test Loss: 0.724 Test Acc: 0.794
Validation loss decreased (-0.749991 --> -0.793743).  Saving model ...
Epoch: 6 cost time: 0.6700553894042969
Epoch: 6, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799994).  Saving model ...
Epoch: 7 cost time: 0.6496524810791016
Epoch: 7, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.7492067813873291
Epoch: 8, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 0.6798069477081299
Epoch: 9, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6539661884307861
Epoch: 10, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.6881871223449707
Epoch: 11, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6066172122955322
Epoch: 12, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6640510559082031
Epoch: 13, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.659475564956665
Epoch: 14, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6308295726776123
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6551687717437744
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8871138095855713
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8026604652404785
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 0.6609535217285156
Epoch: 19, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7106657028198242
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6485371589660645
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.598 Vali Acc: 0.831 Test Loss: 0.598 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6855559349060059
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.595 Vali Acc: 0.834 Test Loss: 0.595 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.680903434753418
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6581239700317383
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.607 Vali Acc: 0.838 Test Loss: 0.607 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7136783599853516
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.614 Vali Acc: 0.834 Test Loss: 0.614 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6281893253326416
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.618 Vali Acc: 0.834 Test Loss: 0.618 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8186993598937988
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.838 Test Loss: 0.619 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7744643688201904
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.831 Test Loss: 0.635 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 117256
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1530702114105225
Epoch: 1, Steps: 8 | Train Loss: 2.262 Vali Loss: 2.092 Vali Acc: 0.172 Test Loss: 2.092 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.7077054977416992
Epoch: 2, Steps: 8 | Train Loss: 2.053 Vali Loss: 1.781 Vali Acc: 0.419 Test Loss: 1.781 Test Acc: 0.419
Validation loss decreased (-0.171854 --> -0.418732).  Saving model ...
Epoch: 3 cost time: 0.8017327785491943
Epoch: 3, Steps: 8 | Train Loss: 1.726 Vali Loss: 1.398 Vali Acc: 0.684 Test Loss: 1.398 Test Acc: 0.684
Validation loss decreased (-0.418732 --> -0.684361).  Saving model ...
Epoch: 4 cost time: 0.7043282985687256
Epoch: 4, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.070 Vali Acc: 0.744 Test Loss: 1.070 Test Acc: 0.744
Validation loss decreased (-0.684361 --> -0.743739).  Saving model ...
Epoch: 5 cost time: 0.8175902366638184
Epoch: 5, Steps: 8 | Train Loss: 0.983 Vali Loss: 0.821 Vali Acc: 0.794 Test Loss: 0.821 Test Acc: 0.794
Validation loss decreased (-0.743739 --> -0.793742).  Saving model ...
Epoch: 6 cost time: 0.6956241130828857
Epoch: 6, Steps: 8 | Train Loss: 0.720 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
Validation loss decreased (-0.793742 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 0.8086776733398438
Epoch: 7, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.593 Vali Acc: 0.806 Test Loss: 0.593 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 8 cost time: 0.8390078544616699
Epoch: 8, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818745).  Saving model ...
Epoch: 9 cost time: 0.9026257991790771
Epoch: 9, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.818745 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.6585581302642822
Epoch: 10, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.724132776260376
Epoch: 11, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7056326866149902
Epoch: 12, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.489 Vali Acc: 0.834 Test Loss: 0.489 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7102246284484863
Epoch: 13, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6765382289886475
Epoch: 14, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6850736141204834
Epoch: 15, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6854972839355469
Epoch: 16, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 0.7785208225250244
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6830368041992188
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6863532066345215
Epoch: 19, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7028307914733887
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7010400295257568
Epoch: 21, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6809976100921631
Epoch: 22, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6786863803863525
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7660238742828369
Epoch: 24, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.561 Vali Acc: 0.838 Test Loss: 0.561 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7292461395263672
Epoch: 25, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.693871259689331
Epoch: 26, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 107016
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2413578033447266
Epoch: 1, Steps: 8 | Train Loss: 2.429 Vali Loss: 2.244 Vali Acc: 0.053 Test Loss: 2.244 Test Acc: 0.053
Validation loss decreased (inf --> -0.053103).  Saving model ...
Epoch: 2 cost time: 0.6612715721130371
Epoch: 2, Steps: 8 | Train Loss: 2.232 Vali Loss: 1.977 Vali Acc: 0.253 Test Loss: 1.977 Test Acc: 0.253
Validation loss decreased (-0.053103 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 0.7553486824035645
Epoch: 3, Steps: 8 | Train Loss: 1.876 Vali Loss: 1.636 Vali Acc: 0.528 Test Loss: 1.636 Test Acc: 0.528
Validation loss decreased (-0.253105 --> -0.528109).  Saving model ...
Epoch: 4 cost time: 0.6752951145172119
Epoch: 4, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.288 Vali Acc: 0.741 Test Loss: 1.288 Test Acc: 0.741
Validation loss decreased (-0.528109 --> -0.740612).  Saving model ...
Epoch: 5 cost time: 0.8793671131134033
Epoch: 5, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.007 Vali Acc: 0.775 Test Loss: 1.007 Test Acc: 0.775
Validation loss decreased (-0.740612 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.7921574115753174
Epoch: 6, Steps: 8 | Train Loss: 0.942 Vali Loss: 0.805 Vali Acc: 0.797 Test Loss: 0.805 Test Acc: 0.797
Validation loss decreased (-0.774990 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.726771354675293
Epoch: 7, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.664 Vali Acc: 0.803 Test Loss: 0.664 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.6691615581512451
Epoch: 8, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.7166941165924072
Epoch: 9, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818745).  Saving model ...
Epoch: 10 cost time: 0.7179162502288818
Epoch: 10, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
Validation loss decreased (-0.818745 --> -0.824995).  Saving model ...
Epoch: 11 cost time: 0.7279458045959473
Epoch: 11, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.489 Vali Acc: 0.831 Test Loss: 0.489 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.7667937278747559
Epoch: 12, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.666771411895752
Epoch: 13, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 0.8085799217224121
Epoch: 14, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.6943056583404541
Epoch: 15, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.7343912124633789
Epoch: 16, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7670834064483643
Epoch: 17, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6626617908477783
Epoch: 18, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7599954605102539
Epoch: 19, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.712428092956543
Epoch: 20, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7362170219421387
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8290371894836426
Epoch: 22, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6813948154449463
Epoch: 23, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8177978992462158
Epoch: 24, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7234280109405518
Epoch: 25, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 98824
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4019298553466797
Epoch: 1, Steps: 8 | Train Loss: 2.220 Vali Loss: 2.048 Vali Acc: 0.103 Test Loss: 2.048 Test Acc: 0.103
Validation loss decreased (inf --> -0.103105).  Saving model ...
Epoch: 2 cost time: 0.7291972637176514
Epoch: 2, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.867 Vali Acc: 0.256 Test Loss: 1.867 Test Acc: 0.256
Validation loss decreased (-0.103105 --> -0.256231).  Saving model ...
Epoch: 3 cost time: 0.7348263263702393
Epoch: 3, Steps: 8 | Train Loss: 1.869 Vali Loss: 1.614 Vali Acc: 0.500 Test Loss: 1.614 Test Acc: 0.500
Validation loss decreased (-0.256231 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 0.7190606594085693
Epoch: 4, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.341 Vali Acc: 0.725 Test Loss: 1.341 Test Acc: 0.725
Validation loss decreased (-0.499984 --> -0.724987).  Saving model ...
Epoch: 5 cost time: 0.7817964553833008
Epoch: 5, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.098 Vali Acc: 0.781 Test Loss: 1.098 Test Acc: 0.781
Validation loss decreased (-0.724987 --> -0.781239).  Saving model ...
Epoch: 6 cost time: 0.7619998455047607
Epoch: 6, Steps: 8 | Train Loss: 1.052 Vali Loss: 0.915 Vali Acc: 0.800 Test Loss: 0.915 Test Acc: 0.800
Validation loss decreased (-0.781239 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.7792835235595703
Epoch: 7, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.776 Vali Acc: 0.812 Test Loss: 0.776 Test Acc: 0.812
Validation loss decreased (-0.799991 --> -0.812492).  Saving model ...
Epoch: 8 cost time: 0.7230868339538574
Epoch: 8, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.671 Vali Acc: 0.809 Test Loss: 0.671 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7455542087554932
Epoch: 9, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.590 Vali Acc: 0.806 Test Loss: 0.590 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7904098033905029
Epoch: 10, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7436356544494629
Epoch: 11, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.812492 --> -0.815620).  Saving model ...
Epoch: 12 cost time: 0.7934103012084961
Epoch: 12, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
Validation loss decreased (-0.815620 --> -0.821870).  Saving model ...
Epoch: 13 cost time: 0.8390953540802002
Epoch: 13, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.493 Vali Acc: 0.828 Test Loss: 0.493 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 0.7516920566558838
Epoch: 14, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.721874475479126
Epoch: 15, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 16 cost time: 0.6983981132507324
Epoch: 16, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.761878252029419
Epoch: 17, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.481 Vali Acc: 0.834 Test Loss: 0.481 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6762337684631348
Epoch: 18, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7240090370178223
Epoch: 19, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.456 Vali Acc: 0.859 Test Loss: 0.456 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 0.6850423812866211
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7146368026733398
Epoch: 21, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.785191535949707
Epoch: 22, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.685157299041748
Epoch: 23, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8360850811004639
Epoch: 24, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7689266204833984
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7782571315765381
Epoch: 26, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8297162055969238
Epoch: 27, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.753014087677002
Epoch: 28, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7574515342712402
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 93640
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.22617244720459
Epoch: 1, Steps: 8 | Train Loss: 2.204 Vali Loss: 2.106 Vali Acc: 0.069 Test Loss: 2.106 Test Acc: 0.069
Validation loss decreased (inf --> -0.068729).  Saving model ...
Epoch: 2 cost time: 0.7303385734558105
Epoch: 2, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.935 Vali Acc: 0.175 Test Loss: 1.935 Test Acc: 0.175
Validation loss decreased (-0.068729 --> -0.174981).  Saving model ...
Epoch: 3 cost time: 0.7121431827545166
Epoch: 3, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.712 Vali Acc: 0.406 Test Loss: 1.712 Test Acc: 0.406
Validation loss decreased (-0.174981 --> -0.406233).  Saving model ...
Epoch: 4 cost time: 0.7302901744842529
Epoch: 4, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.465 Vali Acc: 0.619 Test Loss: 1.465 Test Acc: 0.619
Validation loss decreased (-0.406233 --> -0.618735).  Saving model ...
Epoch: 5 cost time: 0.7199742794036865
Epoch: 5, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.246 Vali Acc: 0.706 Test Loss: 1.246 Test Acc: 0.706
Validation loss decreased (-0.618735 --> -0.706238).  Saving model ...
Epoch: 6 cost time: 0.660059928894043
Epoch: 6, Steps: 8 | Train Loss: 1.180 Vali Loss: 1.047 Vali Acc: 0.747 Test Loss: 1.047 Test Acc: 0.747
Validation loss decreased (-0.706238 --> -0.746865).  Saving model ...
Epoch: 7 cost time: 0.7221560478210449
Epoch: 7, Steps: 8 | Train Loss: 1.029 Vali Loss: 0.882 Vali Acc: 0.769 Test Loss: 0.882 Test Acc: 0.769
Validation loss decreased (-0.746865 --> -0.768741).  Saving model ...
Epoch: 8 cost time: 0.633181095123291
Epoch: 8, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
Validation loss decreased (-0.768741 --> -0.778117).  Saving model ...
Epoch: 9 cost time: 0.7177045345306396
Epoch: 9, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.680 Vali Acc: 0.784 Test Loss: 0.680 Test Acc: 0.784
Validation loss decreased (-0.778117 --> -0.784368).  Saving model ...
Epoch: 10 cost time: 0.698617696762085
Epoch: 10, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
Validation loss decreased (-0.784368 --> -0.803119).  Saving model ...
Epoch: 11 cost time: 0.7079050540924072
Epoch: 11, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 12 cost time: 0.7196855545043945
Epoch: 12, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.544 Vali Acc: 0.806 Test Loss: 0.544 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7473728656768799
Epoch: 13, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815620).  Saving model ...
Epoch: 14 cost time: 0.7065615653991699
Epoch: 14, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
Validation loss decreased (-0.815620 --> -0.828120).  Saving model ...
Epoch: 15 cost time: 0.7459707260131836
Epoch: 15, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 0.8839669227600098
Epoch: 16, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 0.78965163230896
Epoch: 17, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 0.8933076858520508
Epoch: 18, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.707209587097168
Epoch: 19, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.446 Vali Acc: 0.856 Test Loss: 0.446 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856246).  Saving model ...
Epoch: 20 cost time: 0.7598416805267334
Epoch: 20, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.435 Vali Acc: 0.859 Test Loss: 0.435 Test Acc: 0.859
Validation loss decreased (-0.856246 --> -0.859371).  Saving model ...
Epoch: 21 cost time: 0.8483800888061523
Epoch: 21, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.425 Vali Acc: 0.866 Test Loss: 0.425 Test Acc: 0.866
Validation loss decreased (-0.859371 --> -0.865621).  Saving model ...
Epoch: 22 cost time: 0.8997559547424316
Epoch: 22, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.421 Vali Acc: 0.872 Test Loss: 0.421 Test Acc: 0.872
Validation loss decreased (-0.865621 --> -0.871871).  Saving model ...
Epoch: 23 cost time: 0.8014316558837891
Epoch: 23, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.417 Vali Acc: 0.866 Test Loss: 0.417 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8555891513824463
Epoch: 24, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.411 Vali Acc: 0.869 Test Loss: 0.411 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7703108787536621
Epoch: 25, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.411 Vali Acc: 0.866 Test Loss: 0.411 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8068444728851318
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.416 Vali Acc: 0.863 Test Loss: 0.416 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8286020755767822
Epoch: 27, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.415 Vali Acc: 0.872 Test Loss: 0.415 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 28 cost time: 0.8306558132171631
Epoch: 28, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.415 Vali Acc: 0.869 Test Loss: 0.415 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7963407039642334
Epoch: 29, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.409 Vali Acc: 0.866 Test Loss: 0.409 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8342781066894531
Epoch: 30, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.409 Vali Acc: 0.869 Test Loss: 0.409 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7876660823822021
Epoch: 31, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
Validation loss decreased (-0.871871 --> -0.878121).  Saving model ...
Epoch: 32 cost time: 0.865734338760376
Epoch: 32, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
Validation loss decreased (-0.878121 --> -0.884371).  Saving model ...
Epoch: 33 cost time: 0.8441154956817627
Epoch: 33, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.401 Vali Acc: 0.881 Test Loss: 0.401 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.659808874130249
Epoch: 34, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.397 Vali Acc: 0.881 Test Loss: 0.397 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7851283550262451
Epoch: 35, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.403 Vali Acc: 0.881 Test Loss: 0.403 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8246099948883057
Epoch: 36, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7971117496490479
Epoch: 37, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.406 Vali Acc: 0.881 Test Loss: 0.406 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8767032623291016
Epoch: 38, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
Validation loss decreased (-0.884371 --> -0.884371).  Saving model ...
Epoch: 39 cost time: 0.8951151371002197
Epoch: 39, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.405 Vali Acc: 0.881 Test Loss: 0.405 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7365961074829102
Epoch: 40, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.414 Vali Acc: 0.881 Test Loss: 0.414 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8160181045532227
Epoch: 41, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.418 Vali Acc: 0.881 Test Loss: 0.418 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8537147045135498
Epoch: 42, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.413 Vali Acc: 0.881 Test Loss: 0.413 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.899543285369873
Epoch: 43, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8187558650970459
Epoch: 44, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.884 Test Loss: 0.419 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8396344184875488
Epoch: 45, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.425 Vali Acc: 0.881 Test Loss: 0.425 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.816655158996582
Epoch: 46, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.422 Vali Acc: 0.881 Test Loss: 0.422 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7787501811981201
Epoch: 47, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.858330249786377
Epoch: 48, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.425 Vali Acc: 0.881 Test Loss: 0.425 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm64_nh16_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 91592
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.206996202468872
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 1.946 Vali Acc: 0.203 Test Loss: 1.946 Test Acc: 0.203
Validation loss decreased (inf --> -0.203106).  Saving model ...
Epoch: 2 cost time: 0.806429386138916
Epoch: 2, Steps: 8 | Train Loss: 1.820 Vali Loss: 1.467 Vali Acc: 0.713 Test Loss: 1.467 Test Acc: 0.713
Validation loss decreased (-0.203106 --> -0.712485).  Saving model ...
Epoch: 3 cost time: 0.7318093776702881
Epoch: 3, Steps: 8 | Train Loss: 1.291 Vali Loss: 0.978 Vali Acc: 0.816 Test Loss: 0.978 Test Acc: 0.816
Validation loss decreased (-0.712485 --> -0.815615).  Saving model ...
Epoch: 4 cost time: 0.8128390312194824
Epoch: 4, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.690 Vali Acc: 0.812 Test Loss: 0.690 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7282254695892334
Epoch: 5, Steps: 8 | Train Loss: 0.569 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
Validation loss decreased (-0.815615 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 0.7668166160583496
Epoch: 6, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.7791268825531006
Epoch: 7, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.8515133857727051
Epoch: 8, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.498 Vali Acc: 0.828 Test Loss: 0.498 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8057305812835693
Epoch: 9, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.684201717376709
Epoch: 10, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.7333364486694336
Epoch: 11, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.8372480869293213
Epoch: 12, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.835233211517334
Epoch: 13, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8576028347015381
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7861051559448242
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9131035804748535
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.639 Vali Acc: 0.847 Test Loss: 0.639 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8703813552856445
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.644 Vali Acc: 0.847 Test Loss: 0.644 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7324814796447754
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.629 Vali Acc: 0.853 Test Loss: 0.629 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8377137184143066
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.620 Vali Acc: 0.847 Test Loss: 0.620 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7222235202789307
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.630 Vali Acc: 0.847 Test Loss: 0.630 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9082620143890381
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.655 Vali Acc: 0.838 Test Loss: 0.655 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6270773410797119
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.834 Test Loss: 0.672 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 123304
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1353096961975098
Epoch: 1, Steps: 8 | Train Loss: 2.246 Vali Loss: 2.077 Vali Acc: 0.184 Test Loss: 2.077 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 0.7101569175720215
Epoch: 2, Steps: 8 | Train Loss: 2.054 Vali Loss: 1.800 Vali Acc: 0.375 Test Loss: 1.800 Test Acc: 0.375
Validation loss decreased (-0.184354 --> -0.374982).  Saving model ...
Epoch: 3 cost time: 0.8300700187683105
Epoch: 3, Steps: 8 | Train Loss: 1.748 Vali Loss: 1.451 Vali Acc: 0.644 Test Loss: 1.451 Test Acc: 0.644
Validation loss decreased (-0.374982 --> -0.643735).  Saving model ...
Epoch: 4 cost time: 0.8294994831085205
Epoch: 4, Steps: 8 | Train Loss: 1.379 Vali Loss: 1.126 Vali Acc: 0.781 Test Loss: 1.126 Test Acc: 0.781
Validation loss decreased (-0.643735 --> -0.781239).  Saving model ...
Epoch: 5 cost time: 0.7809107303619385
Epoch: 5, Steps: 8 | Train Loss: 1.041 Vali Loss: 0.874 Vali Acc: 0.794 Test Loss: 0.874 Test Acc: 0.794
Validation loss decreased (-0.781239 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 0.7918753623962402
Epoch: 6, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.793741 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 0.7094583511352539
Epoch: 7, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
Validation loss decreased (-0.803118 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 0.6463265419006348
Epoch: 8, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.7938094139099121
Epoch: 9, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 0.7895705699920654
Epoch: 10, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8187963962554932
Epoch: 11, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7738330364227295
Epoch: 12, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.834370 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.6775310039520264
Epoch: 13, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8223927021026611
Epoch: 14, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7242164611816406
Epoch: 15, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7530865669250488
Epoch: 16, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7724354267120361
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7304744720458984
Epoch: 18, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.556 Vali Acc: 0.834 Test Loss: 0.556 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.705859899520874
Epoch: 19, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8334596157073975
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.570 Vali Acc: 0.834 Test Loss: 0.570 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6507968902587891
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7467653751373291
Epoch: 22, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 93608
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0956897735595703
Epoch: 1, Steps: 8 | Train Loss: 2.203 Vali Loss: 1.980 Vali Acc: 0.275 Test Loss: 1.980 Test Acc: 0.275
Validation loss decreased (inf --> -0.274980).  Saving model ...
Epoch: 2 cost time: 0.6638696193695068
Epoch: 2, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.803 Vali Acc: 0.422 Test Loss: 1.803 Test Acc: 0.422
Validation loss decreased (-0.274980 --> -0.421857).  Saving model ...
Epoch: 3 cost time: 0.7371079921722412
Epoch: 3, Steps: 8 | Train Loss: 1.784 Vali Loss: 1.568 Vali Acc: 0.594 Test Loss: 1.568 Test Acc: 0.594
Validation loss decreased (-0.421857 --> -0.593734).  Saving model ...
Epoch: 4 cost time: 0.6254615783691406
Epoch: 4, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.301 Vali Acc: 0.719 Test Loss: 1.301 Test Acc: 0.719
Validation loss decreased (-0.593734 --> -0.718737).  Saving model ...
Epoch: 5 cost time: 0.6338586807250977
Epoch: 5, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.059 Vali Acc: 0.787 Test Loss: 1.059 Test Acc: 0.787
Validation loss decreased (-0.718737 --> -0.787489).  Saving model ...
Epoch: 6 cost time: 0.7743136882781982
Epoch: 6, Steps: 8 | Train Loss: 1.039 Vali Loss: 0.863 Vali Acc: 0.806 Test Loss: 0.863 Test Acc: 0.806
Validation loss decreased (-0.787489 --> -0.806241).  Saving model ...
Epoch: 7 cost time: 0.6844534873962402
Epoch: 7, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
Validation loss decreased (-0.806241 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.6938142776489258
Epoch: 8, Steps: 8 | Train Loss: 0.680 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.8038041591644287
Epoch: 9, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.6225466728210449
Epoch: 10, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.7445929050445557
Epoch: 11, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.7417881488800049
Epoch: 12, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.7047460079193115
Epoch: 13, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.478 Vali Acc: 0.859 Test Loss: 0.478 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 0.8458731174468994
Epoch: 14, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6983327865600586
Epoch: 15, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 16 cost time: 0.6513712406158447
Epoch: 16, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8149099349975586
Epoch: 17, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.682448148727417
Epoch: 18, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8163254261016846
Epoch: 19, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.770057201385498
Epoch: 20, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7308096885681152
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7679777145385742
Epoch: 22, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6576886177062988
Epoch: 23, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6447458267211914
Epoch: 24, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8112022876739502
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 83880
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.360771894454956
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 2.073 Vali Acc: 0.209 Test Loss: 2.073 Test Acc: 0.209
Validation loss decreased (inf --> -0.209354).  Saving model ...
Epoch: 2 cost time: 0.6646285057067871
Epoch: 2, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.868 Vali Acc: 0.366 Test Loss: 1.868 Test Acc: 0.366
Validation loss decreased (-0.209354 --> -0.365606).  Saving model ...
Epoch: 3 cost time: 0.7322766780853271
Epoch: 3, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.617 Vali Acc: 0.537 Test Loss: 1.617 Test Acc: 0.537
Validation loss decreased (-0.365606 --> -0.537484).  Saving model ...
Epoch: 4 cost time: 0.6482210159301758
Epoch: 4, Steps: 8 | Train Loss: 1.539 Vali Loss: 1.365 Vali Acc: 0.647 Test Loss: 1.365 Test Acc: 0.647
Validation loss decreased (-0.537484 --> -0.646861).  Saving model ...
Epoch: 5 cost time: 0.6343071460723877
Epoch: 5, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.146 Vali Acc: 0.706 Test Loss: 1.146 Test Acc: 0.706
Validation loss decreased (-0.646861 --> -0.706239).  Saving model ...
Epoch: 6 cost time: 0.7732260227203369
Epoch: 6, Steps: 8 | Train Loss: 1.161 Vali Loss: 0.960 Vali Acc: 0.738 Test Loss: 0.960 Test Acc: 0.738
Validation loss decreased (-0.706239 --> -0.737490).  Saving model ...
Epoch: 7 cost time: 0.6599719524383545
Epoch: 7, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
Validation loss decreased (-0.737490 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 0.7224912643432617
Epoch: 8, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.698 Vali Acc: 0.797 Test Loss: 0.698 Test Acc: 0.797
Validation loss decreased (-0.774992 --> -0.796868).  Saving model ...
Epoch: 9 cost time: 0.7205657958984375
Epoch: 9, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 10 cost time: 0.6835558414459229
Epoch: 10, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.578 Vali Acc: 0.806 Test Loss: 0.578 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 11 cost time: 0.7318921089172363
Epoch: 11, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7252969741821289
Epoch: 12, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.537 Vali Acc: 0.812 Test Loss: 0.537 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812495).  Saving model ...
Epoch: 13 cost time: 0.7740926742553711
Epoch: 13, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
Validation loss decreased (-0.812495 --> -0.815620).  Saving model ...
Epoch: 14 cost time: 0.72074294090271
Epoch: 14, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.815620 --> -0.831245).  Saving model ...
Epoch: 15 cost time: 0.7843663692474365
Epoch: 15, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 0.6964058876037598
Epoch: 16, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7328474521636963
Epoch: 17, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.492 Vali Acc: 0.831 Test Loss: 0.492 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7704727649688721
Epoch: 18, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7605791091918945
Epoch: 19, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 0.7436645030975342
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8384430408477783
Epoch: 21, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8425760269165039
Epoch: 22, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7766964435577393
Epoch: 23, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8072583675384521
Epoch: 24, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7960801124572754
Epoch: 25, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7121531963348389
Epoch: 26, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7654275894165039
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6721346378326416
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.679663896560669
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 78760
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9802930355072021
Epoch: 1, Steps: 8 | Train Loss: 2.352 Vali Loss: 2.218 Vali Acc: 0.178 Test Loss: 2.218 Test Acc: 0.178
Validation loss decreased (inf --> -0.178103).  Saving model ...
Epoch: 2 cost time: 0.7114741802215576
Epoch: 2, Steps: 8 | Train Loss: 2.234 Vali Loss: 2.051 Vali Acc: 0.266 Test Loss: 2.051 Test Acc: 0.266
Validation loss decreased (-0.178103 --> -0.265604).  Saving model ...
Epoch: 3 cost time: 0.6829478740692139
Epoch: 3, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.834 Vali Acc: 0.356 Test Loss: 1.834 Test Acc: 0.356
Validation loss decreased (-0.265604 --> -0.356232).  Saving model ...
Epoch: 4 cost time: 0.7101917266845703
Epoch: 4, Steps: 8 | Train Loss: 1.816 Vali Loss: 1.599 Vali Acc: 0.469 Test Loss: 1.599 Test Acc: 0.469
Validation loss decreased (-0.356232 --> -0.468734).  Saving model ...
Epoch: 5 cost time: 0.6311814785003662
Epoch: 5, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.365 Vali Acc: 0.634 Test Loss: 1.365 Test Acc: 0.634
Validation loss decreased (-0.468734 --> -0.634361).  Saving model ...
Epoch: 6 cost time: 0.6418802738189697
Epoch: 6, Steps: 8 | Train Loss: 1.350 Vali Loss: 1.160 Vali Acc: 0.725 Test Loss: 1.160 Test Acc: 0.725
Validation loss decreased (-0.634361 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 0.6599807739257812
Epoch: 7, Steps: 8 | Train Loss: 1.141 Vali Loss: 0.989 Vali Acc: 0.753 Test Loss: 0.989 Test Acc: 0.753
Validation loss decreased (-0.724988 --> -0.753115).  Saving model ...
Epoch: 8 cost time: 0.7243821620941162
Epoch: 8, Steps: 8 | Train Loss: 1.001 Vali Loss: 0.849 Vali Acc: 0.787 Test Loss: 0.849 Test Acc: 0.787
Validation loss decreased (-0.753115 --> -0.787492).  Saving model ...
Epoch: 9 cost time: 0.73032546043396
Epoch: 9, Steps: 8 | Train Loss: 0.829 Vali Loss: 0.748 Vali Acc: 0.797 Test Loss: 0.748 Test Acc: 0.797
Validation loss decreased (-0.787492 --> -0.796868).  Saving model ...
Epoch: 10 cost time: 0.7693479061126709
Epoch: 10, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.667 Vali Acc: 0.816 Test Loss: 0.667 Test Acc: 0.816
Validation loss decreased (-0.796868 --> -0.815618).  Saving model ...
Epoch: 11 cost time: 0.7180039882659912
Epoch: 11, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.7462596893310547
Epoch: 12, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.7562799453735352
Epoch: 13, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.7523126602172852
Epoch: 14, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 15 cost time: 0.7105295658111572
Epoch: 15, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.678647518157959
Epoch: 16, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 17 cost time: 0.8387668132781982
Epoch: 17, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.7533848285675049
Epoch: 18, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7628316879272461
Epoch: 19, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 0.6862633228302002
Epoch: 20, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6960055828094482
Epoch: 21, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6805069446563721
Epoch: 22, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9554719924926758
Epoch: 23, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6083197593688965
Epoch: 24, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6548449993133545
Epoch: 25, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.627673864364624
Epoch: 26, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6179428100585938
Epoch: 27, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7098865509033203
Epoch: 28, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6874275207519531
Epoch: 29, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 30 cost time: 0.7652988433837891
Epoch: 30, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 31 cost time: 0.74861741065979
Epoch: 31, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.505 Vali Acc: 0.853 Test Loss: 0.505 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8042426109313965
Epoch: 32, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.737368106842041
Epoch: 33, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8427901268005371
Epoch: 34, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7078986167907715
Epoch: 35, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7596094608306885
Epoch: 36, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6614055633544922
Epoch: 37, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8168013095855713
Epoch: 38, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7010769844055176
Epoch: 39, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8149089813232422
Epoch: 40, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 74664
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.222079038619995
Epoch: 1, Steps: 8 | Train Loss: 2.328 Vali Loss: 2.265 Vali Acc: 0.103 Test Loss: 2.265 Test Acc: 0.103
Validation loss decreased (inf --> -0.103102).  Saving model ...
Epoch: 2 cost time: 0.7070918083190918
Epoch: 2, Steps: 8 | Train Loss: 2.229 Vali Loss: 2.132 Vali Acc: 0.141 Test Loss: 2.132 Test Acc: 0.141
Validation loss decreased (-0.103102 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 0.6498503684997559
Epoch: 3, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.941 Vali Acc: 0.222 Test Loss: 1.941 Test Acc: 0.222
Validation loss decreased (-0.140604 --> -0.221856).  Saving model ...
Epoch: 4 cost time: 0.6244451999664307
Epoch: 4, Steps: 8 | Train Loss: 1.888 Vali Loss: 1.732 Vali Acc: 0.459 Test Loss: 1.732 Test Acc: 0.459
Validation loss decreased (-0.221856 --> -0.459358).  Saving model ...
Epoch: 5 cost time: 0.7134606838226318
Epoch: 5, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.524 Vali Acc: 0.609 Test Loss: 1.524 Test Acc: 0.609
Validation loss decreased (-0.459358 --> -0.609360).  Saving model ...
Epoch: 6 cost time: 0.6699514389038086
Epoch: 6, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.335 Vali Acc: 0.700 Test Loss: 1.335 Test Acc: 0.700
Validation loss decreased (-0.609360 --> -0.699987).  Saving model ...
Epoch: 7 cost time: 0.6281216144561768
Epoch: 7, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.166 Vali Acc: 0.741 Test Loss: 1.166 Test Acc: 0.741
Validation loss decreased (-0.699987 --> -0.740613).  Saving model ...
Epoch: 8 cost time: 0.7096819877624512
Epoch: 8, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.020 Vali Acc: 0.772 Test Loss: 1.020 Test Acc: 0.772
Validation loss decreased (-0.740613 --> -0.771865).  Saving model ...
Epoch: 9 cost time: 0.7167024612426758
Epoch: 9, Steps: 8 | Train Loss: 1.002 Vali Loss: 0.902 Vali Acc: 0.778 Test Loss: 0.902 Test Acc: 0.778
Validation loss decreased (-0.771865 --> -0.778116).  Saving model ...
Epoch: 10 cost time: 0.6559579372406006
Epoch: 10, Steps: 8 | Train Loss: 0.850 Vali Loss: 0.810 Vali Acc: 0.784 Test Loss: 0.810 Test Acc: 0.784
Validation loss decreased (-0.778116 --> -0.784367).  Saving model ...
Epoch: 11 cost time: 0.7135858535766602
Epoch: 11, Steps: 8 | Train Loss: 0.776 Vali Loss: 0.734 Vali Acc: 0.794 Test Loss: 0.734 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793743).  Saving model ...
Epoch: 12 cost time: 0.6594305038452148
Epoch: 12, Steps: 8 | Train Loss: 0.640 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803118).  Saving model ...
Epoch: 13 cost time: 0.7253954410552979
Epoch: 13, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 0.8020143508911133
Epoch: 14, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7899627685546875
Epoch: 15, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 16 cost time: 0.7018814086914062
Epoch: 16, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 17 cost time: 0.7333996295928955
Epoch: 17, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 18 cost time: 0.6389079093933105
Epoch: 18, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 19 cost time: 0.8366527557373047
Epoch: 19, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 20 cost time: 0.6663656234741211
Epoch: 20, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 21 cost time: 0.7514915466308594
Epoch: 21, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 22 cost time: 0.7388784885406494
Epoch: 22, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 0.708712100982666
Epoch: 23, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.7800092697143555
Epoch: 24, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.6771378517150879
Epoch: 25, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 26 cost time: 0.7227902412414551
Epoch: 26, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6976549625396729
Epoch: 27, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 28 cost time: 0.62929368019104
Epoch: 28, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.466 Vali Acc: 0.863 Test Loss: 0.466 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 29 cost time: 0.7090375423431396
Epoch: 29, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 30 cost time: 0.5875146389007568
Epoch: 30, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 31 cost time: 0.6780612468719482
Epoch: 31, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.457 Vali Acc: 0.863 Test Loss: 0.457 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 32 cost time: 0.6042232513427734
Epoch: 32, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.460 Vali Acc: 0.863 Test Loss: 0.460 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6268026828765869
Epoch: 33, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.457 Vali Acc: 0.863 Test Loss: 0.457 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6161725521087646
Epoch: 34, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.453 Vali Acc: 0.866 Test Loss: 0.453 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 35 cost time: 0.570953369140625
Epoch: 35, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868746).  Saving model ...
Epoch: 36 cost time: 0.6102218627929688
Epoch: 36, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5593271255493164
Epoch: 37, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.446 Vali Acc: 0.866 Test Loss: 0.446 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.646414041519165
Epoch: 38, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.447 Vali Acc: 0.869 Test Loss: 0.447 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6542582511901855
Epoch: 39, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871871).  Saving model ...
Epoch: 40 cost time: 0.6377313137054443
Epoch: 40, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.448 Vali Acc: 0.869 Test Loss: 0.448 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6542587280273438
Epoch: 41, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.443 Vali Acc: 0.869 Test Loss: 0.443 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7269916534423828
Epoch: 42, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.447 Vali Acc: 0.869 Test Loss: 0.447 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6458816528320312
Epoch: 43, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.448 Vali Acc: 0.869 Test Loss: 0.448 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6251199245452881
Epoch: 44, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.455 Vali Acc: 0.869 Test Loss: 0.455 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.664078950881958
Epoch: 45, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7048418521881104
Epoch: 46, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.442 Vali Acc: 0.869 Test Loss: 0.442 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7114861011505127
Epoch: 47, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 48 cost time: 0.6568026542663574
Epoch: 48, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
Validation loss decreased (-0.871871 --> -0.874996).  Saving model ...
Epoch: 49 cost time: 0.6588294506072998
Epoch: 49, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 50 cost time: 0.6282727718353271
Epoch: 50, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6455142498016357
Epoch: 51, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.444 Vali Acc: 0.878 Test Loss: 0.444 Test Acc: 0.878
Validation loss decreased (-0.874996 --> -0.878121).  Saving model ...
Epoch: 52 cost time: 0.7028279304504395
Epoch: 52, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.446 Vali Acc: 0.881 Test Loss: 0.446 Test Acc: 0.881
Validation loss decreased (-0.878121 --> -0.881246).  Saving model ...
Epoch: 53 cost time: 0.6353957653045654
Epoch: 53, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.444 Vali Acc: 0.881 Test Loss: 0.444 Test Acc: 0.881
Validation loss decreased (-0.881246 --> -0.881246).  Saving model ...
Epoch: 54 cost time: 0.7643818855285645
Epoch: 54, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.448 Vali Acc: 0.878 Test Loss: 0.448 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6687037944793701
Epoch: 55, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.452 Vali Acc: 0.881 Test Loss: 0.452 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6069581508636475
Epoch: 56, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.455 Vali Acc: 0.878 Test Loss: 0.455 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6158668994903564
Epoch: 57, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.7543692588806152
Epoch: 58, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7241318225860596
Epoch: 59, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6812522411346436
Epoch: 60, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.6732470989227295
Epoch: 61, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.472 Vali Acc: 0.869 Test Loss: 0.472 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.631533145904541
Epoch: 62, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.6180040836334229
Epoch: 63, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 72072
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2919139862060547
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 2.106 Vali Acc: 0.153 Test Loss: 2.106 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 0.6452901363372803
Epoch: 2, Steps: 8 | Train Loss: 2.161 Vali Loss: 1.975 Vali Acc: 0.231 Test Loss: 1.975 Test Acc: 0.231
Validation loss decreased (-0.153104 --> -0.231230).  Saving model ...
Epoch: 3 cost time: 0.7312092781066895
Epoch: 3, Steps: 8 | Train Loss: 1.894 Vali Loss: 1.803 Vali Acc: 0.350 Test Loss: 1.803 Test Acc: 0.350
Validation loss decreased (-0.231230 --> -0.349982).  Saving model ...
Epoch: 4 cost time: 0.581895112991333
Epoch: 4, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.615 Vali Acc: 0.506 Test Loss: 1.615 Test Acc: 0.506
Validation loss decreased (-0.349982 --> -0.506234).  Saving model ...
Epoch: 5 cost time: 0.6903886795043945
Epoch: 5, Steps: 8 | Train Loss: 1.585 Vali Loss: 1.431 Vali Acc: 0.656 Test Loss: 1.431 Test Acc: 0.656
Validation loss decreased (-0.506234 --> -0.656236).  Saving model ...
Epoch: 6 cost time: 0.6482930183410645
Epoch: 6, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.255 Vali Acc: 0.738 Test Loss: 1.255 Test Acc: 0.738
Validation loss decreased (-0.656236 --> -0.737487).  Saving model ...
Epoch: 7 cost time: 0.6585054397583008
Epoch: 7, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.103 Vali Acc: 0.778 Test Loss: 1.103 Test Acc: 0.778
Validation loss decreased (-0.737487 --> -0.778114).  Saving model ...
Epoch: 8 cost time: 0.6252026557922363
Epoch: 8, Steps: 8 | Train Loss: 1.121 Vali Loss: 0.973 Vali Acc: 0.797 Test Loss: 0.973 Test Acc: 0.797
Validation loss decreased (-0.778114 --> -0.796865).  Saving model ...
Epoch: 9 cost time: 0.6451377868652344
Epoch: 9, Steps: 8 | Train Loss: 0.983 Vali Loss: 0.868 Vali Acc: 0.794 Test Loss: 0.868 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6470029354095459
Epoch: 10, Steps: 8 | Train Loss: 0.887 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
Validation loss decreased (-0.796865 --> -0.803117).  Saving model ...
Epoch: 11 cost time: 0.6107974052429199
Epoch: 11, Steps: 8 | Train Loss: 0.703 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
Validation loss decreased (-0.803117 --> -0.809368).  Saving model ...
Epoch: 12 cost time: 0.6173996925354004
Epoch: 12, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6500973701477051
Epoch: 13, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6273112297058105
Epoch: 14, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815619).  Saving model ...
Epoch: 15 cost time: 0.5914087295532227
Epoch: 15, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 16 cost time: 0.6216778755187988
Epoch: 16, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 17 cost time: 0.6805925369262695
Epoch: 17, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 0.6256024837493896
Epoch: 18, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 19 cost time: 0.7594342231750488
Epoch: 19, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 0.6341798305511475
Epoch: 20, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.516 Vali Acc: 0.828 Test Loss: 0.516 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.631446123123169
Epoch: 21, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 22 cost time: 0.6723499298095703
Epoch: 22, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 23 cost time: 0.68320631980896
Epoch: 23, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 24 cost time: 0.7454812526702881
Epoch: 24, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 25 cost time: 0.6134746074676514
Epoch: 25, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 26 cost time: 0.6568725109100342
Epoch: 26, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.460 Vali Acc: 0.863 Test Loss: 0.460 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 27 cost time: 0.7819316387176514
Epoch: 27, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 28 cost time: 0.6942169666290283
Epoch: 28, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.449 Vali Acc: 0.866 Test Loss: 0.449 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7129518985748291
Epoch: 29, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7313849925994873
Epoch: 30, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.437 Vali Acc: 0.866 Test Loss: 0.437 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7158260345458984
Epoch: 31, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.430 Vali Acc: 0.866 Test Loss: 0.430 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6232717037200928
Epoch: 32, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.424 Vali Acc: 0.872 Test Loss: 0.424 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871871).  Saving model ...
Epoch: 33 cost time: 0.7525007724761963
Epoch: 33, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.421 Vali Acc: 0.872 Test Loss: 0.421 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 34 cost time: 0.6473841667175293
Epoch: 34, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.427 Vali Acc: 0.866 Test Loss: 0.427 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6519227027893066
Epoch: 35, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.426 Vali Acc: 0.872 Test Loss: 0.426 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7708055973052979
Epoch: 36, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.432 Vali Acc: 0.863 Test Loss: 0.432 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6449689865112305
Epoch: 37, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.432 Vali Acc: 0.863 Test Loss: 0.432 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6205575466156006
Epoch: 38, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.431 Vali Acc: 0.866 Test Loss: 0.431 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7725751399993896
Epoch: 39, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.429 Vali Acc: 0.872 Test Loss: 0.429 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6351356506347656
Epoch: 40, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.428 Vali Acc: 0.872 Test Loss: 0.428 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6874544620513916
Epoch: 41, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.430 Vali Acc: 0.869 Test Loss: 0.430 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7640049457550049
Epoch: 42, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.437 Vali Acc: 0.866 Test Loss: 0.437 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6335163116455078
Epoch: 43, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.438 Vali Acc: 0.866 Test Loss: 0.438 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 71048
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1161701679229736
Epoch: 1, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.924 Vali Acc: 0.197 Test Loss: 1.924 Test Acc: 0.197
Validation loss decreased (inf --> -0.196856).  Saving model ...
Epoch: 2 cost time: 0.7442548274993896
Epoch: 2, Steps: 8 | Train Loss: 1.808 Vali Loss: 1.453 Vali Acc: 0.650 Test Loss: 1.453 Test Acc: 0.650
Validation loss decreased (-0.196856 --> -0.649985).  Saving model ...
Epoch: 3 cost time: 0.6759665012359619
Epoch: 3, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.007 Vali Acc: 0.738 Test Loss: 1.007 Test Acc: 0.738
Validation loss decreased (-0.649985 --> -0.737490).  Saving model ...
Epoch: 4 cost time: 0.6682801246643066
Epoch: 4, Steps: 8 | Train Loss: 0.783 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
Validation loss decreased (-0.737490 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 0.8110997676849365
Epoch: 5, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 6 cost time: 0.8253581523895264
Epoch: 6, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.803119 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.8571000099182129
Epoch: 7, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.7962613105773926
Epoch: 8, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.737743616104126
Epoch: 9, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8428733348846436
Epoch: 10, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9765415191650391
Epoch: 11, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8087525367736816
Epoch: 12, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8404054641723633
Epoch: 13, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.620 Vali Acc: 0.831 Test Loss: 0.620 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6932461261749268
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8585968017578125
Epoch: 15, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.626 Vali Acc: 0.831 Test Loss: 0.626 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7957725524902344
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8618278503417969
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 98344
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.357591390609741
Epoch: 1, Steps: 8 | Train Loss: 2.304 Vali Loss: 2.099 Vali Acc: 0.094 Test Loss: 2.099 Test Acc: 0.094
Validation loss decreased (inf --> -0.093729).  Saving model ...
Epoch: 2 cost time: 0.7503416538238525
Epoch: 2, Steps: 8 | Train Loss: 2.133 Vali Loss: 1.871 Vali Acc: 0.287 Test Loss: 1.871 Test Acc: 0.287
Validation loss decreased (-0.093729 --> -0.287481).  Saving model ...
Epoch: 3 cost time: 0.7692761421203613
Epoch: 3, Steps: 8 | Train Loss: 1.822 Vali Loss: 1.577 Vali Acc: 0.562 Test Loss: 1.577 Test Acc: 0.562
Validation loss decreased (-0.287481 --> -0.562484).  Saving model ...
Epoch: 4 cost time: 0.7798330783843994
Epoch: 4, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.269 Vali Acc: 0.716 Test Loss: 1.269 Test Acc: 0.716
Validation loss decreased (-0.562484 --> -0.715612).  Saving model ...
Epoch: 5 cost time: 0.5885396003723145
Epoch: 5, Steps: 8 | Train Loss: 1.172 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
Validation loss decreased (-0.715612 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.7498111724853516
Epoch: 6, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.794 Vali Acc: 0.794 Test Loss: 0.794 Test Acc: 0.794
Validation loss decreased (-0.749990 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.7481541633605957
Epoch: 7, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.671 Vali Acc: 0.791 Test Loss: 0.671 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6780824661254883
Epoch: 8, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.596 Vali Acc: 0.800 Test Loss: 0.596 Test Acc: 0.800
Validation loss decreased (-0.793742 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 0.7374656200408936
Epoch: 9, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.828120).  Saving model ...
Epoch: 10 cost time: 0.7735261917114258
Epoch: 10, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.7150464057922363
Epoch: 11, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 0.7525327205657959
Epoch: 12, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.7672655582427979
Epoch: 13, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7418098449707031
Epoch: 14, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6170554161071777
Epoch: 15, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7126762866973877
Epoch: 16, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7681641578674316
Epoch: 17, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8656213283538818
Epoch: 18, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7795529365539551
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6551675796508789
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.725717306137085
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7321321964263916
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 68648
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.611396551132202
Epoch: 1, Steps: 8 | Train Loss: 2.333 Vali Loss: 2.086 Vali Acc: 0.212 Test Loss: 2.086 Test Acc: 0.212
Validation loss decreased (inf --> -0.212479).  Saving model ...
Epoch: 2 cost time: 0.7408339977264404
Epoch: 2, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.891 Vali Acc: 0.322 Test Loss: 1.891 Test Acc: 0.322
Validation loss decreased (-0.212479 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 0.8593363761901855
Epoch: 3, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.639 Vali Acc: 0.572 Test Loss: 1.639 Test Acc: 0.572
Validation loss decreased (-0.321856 --> -0.571859).  Saving model ...
Epoch: 4 cost time: 0.7999577522277832
Epoch: 4, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.370 Vali Acc: 0.731 Test Loss: 1.370 Test Acc: 0.731
Validation loss decreased (-0.571859 --> -0.731236).  Saving model ...
Epoch: 5 cost time: 0.7976405620574951
Epoch: 5, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.117 Vali Acc: 0.762 Test Loss: 1.117 Test Acc: 0.762
Validation loss decreased (-0.731236 --> -0.762489).  Saving model ...
Epoch: 6 cost time: 0.5954065322875977
Epoch: 6, Steps: 8 | Train Loss: 1.111 Vali Loss: 0.900 Vali Acc: 0.781 Test Loss: 0.900 Test Acc: 0.781
Validation loss decreased (-0.762489 --> -0.781241).  Saving model ...
Epoch: 7 cost time: 0.6907539367675781
Epoch: 7, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.753 Vali Acc: 0.806 Test Loss: 0.753 Test Acc: 0.806
Validation loss decreased (-0.781241 --> -0.806242).  Saving model ...
Epoch: 8 cost time: 0.6661849021911621
Epoch: 8, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
Validation loss decreased (-0.806242 --> -0.815618).  Saving model ...
Epoch: 9 cost time: 0.8381645679473877
Epoch: 9, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.7181093692779541
Epoch: 10, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
Validation loss decreased (-0.818744 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.5635519027709961
Epoch: 11, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6474847793579102
Epoch: 12, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7069299221038818
Epoch: 13, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 0.7042310237884521
Epoch: 14, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.648489236831665
Epoch: 15, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.6778926849365234
Epoch: 16, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8002209663391113
Epoch: 17, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7774314880371094
Epoch: 18, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7540619373321533
Epoch: 19, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.80753493309021
Epoch: 20, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7097299098968506
Epoch: 21, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8258764743804932
Epoch: 22, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7058866024017334
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8094167709350586
Epoch: 24, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7425394058227539
Epoch: 25, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 58920
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2324564456939697
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.028 Vali Acc: 0.172 Test Loss: 2.028 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 0.7661991119384766
Epoch: 2, Steps: 8 | Train Loss: 2.079 Vali Loss: 1.869 Vali Acc: 0.325 Test Loss: 1.869 Test Acc: 0.325
Validation loss decreased (-0.171855 --> -0.324981).  Saving model ...
Epoch: 3 cost time: 0.7747349739074707
Epoch: 3, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.650 Vali Acc: 0.556 Test Loss: 1.650 Test Acc: 0.556
Validation loss decreased (-0.324981 --> -0.556233).  Saving model ...
Epoch: 4 cost time: 0.765643835067749
Epoch: 4, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.420 Vali Acc: 0.694 Test Loss: 1.420 Test Acc: 0.694
Validation loss decreased (-0.556233 --> -0.693736).  Saving model ...
Epoch: 5 cost time: 0.6721136569976807
Epoch: 5, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.200 Vali Acc: 0.734 Test Loss: 1.200 Test Acc: 0.734
Validation loss decreased (-0.693736 --> -0.734363).  Saving model ...
Epoch: 6 cost time: 0.6285784244537354
Epoch: 6, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.012 Vali Acc: 0.762 Test Loss: 1.012 Test Acc: 0.762
Validation loss decreased (-0.734363 --> -0.762490).  Saving model ...
Epoch: 7 cost time: 0.7954614162445068
Epoch: 7, Steps: 8 | Train Loss: 1.063 Vali Loss: 0.852 Vali Acc: 0.784 Test Loss: 0.852 Test Acc: 0.784
Validation loss decreased (-0.762490 --> -0.784366).  Saving model ...
Epoch: 8 cost time: 0.6629252433776855
Epoch: 8, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.732 Vali Acc: 0.809 Test Loss: 0.732 Test Acc: 0.809
Validation loss decreased (-0.784366 --> -0.809368).  Saving model ...
Epoch: 9 cost time: 0.7680842876434326
Epoch: 9, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.654 Vali Acc: 0.806 Test Loss: 0.654 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7703213691711426
Epoch: 10, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.809368 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 0.7225687503814697
Epoch: 11, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821870).  Saving model ...
Epoch: 12 cost time: 0.8015069961547852
Epoch: 12, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 0.7005300521850586
Epoch: 13, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 0.7608048915863037
Epoch: 14, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 0.7476949691772461
Epoch: 15, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8021066188812256
Epoch: 16, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.8061277866363525
Epoch: 17, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7604954242706299
Epoch: 18, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6399228572845459
Epoch: 19, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8414695262908936
Epoch: 20, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7865962982177734
Epoch: 21, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7484838962554932
Epoch: 22, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7860021591186523
Epoch: 23, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6384992599487305
Epoch: 24, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7065680027008057
Epoch: 25, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7797377109527588
Epoch: 26, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 53800
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2518908977508545
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.087 Vali Acc: 0.131 Test Loss: 2.087 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.8097596168518066
Epoch: 2, Steps: 8 | Train Loss: 2.123 Vali Loss: 1.946 Vali Acc: 0.219 Test Loss: 1.946 Test Acc: 0.219
Validation loss decreased (-0.131229 --> -0.218731).  Saving model ...
Epoch: 3 cost time: 0.7462084293365479
Epoch: 3, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.759 Vali Acc: 0.391 Test Loss: 1.759 Test Acc: 0.391
Validation loss decreased (-0.218731 --> -0.390607).  Saving model ...
Epoch: 4 cost time: 0.6743474006652832
Epoch: 4, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.550 Vali Acc: 0.547 Test Loss: 1.550 Test Acc: 0.547
Validation loss decreased (-0.390607 --> -0.546860).  Saving model ...
Epoch: 5 cost time: 0.7704105377197266
Epoch: 5, Steps: 8 | Train Loss: 1.460 Vali Loss: 1.340 Vali Acc: 0.656 Test Loss: 1.340 Test Acc: 0.656
Validation loss decreased (-0.546860 --> -0.656237).  Saving model ...
Epoch: 6 cost time: 0.726149320602417
Epoch: 6, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.156 Vali Acc: 0.731 Test Loss: 1.156 Test Acc: 0.731
Validation loss decreased (-0.656237 --> -0.731238).  Saving model ...
Epoch: 7 cost time: 0.7107565402984619
Epoch: 7, Steps: 8 | Train Loss: 1.169 Vali Loss: 0.984 Vali Acc: 0.766 Test Loss: 0.984 Test Acc: 0.766
Validation loss decreased (-0.731238 --> -0.765615).  Saving model ...
Epoch: 8 cost time: 0.7883894443511963
Epoch: 8, Steps: 8 | Train Loss: 0.961 Vali Loss: 0.847 Vali Acc: 0.784 Test Loss: 0.847 Test Acc: 0.784
Validation loss decreased (-0.765615 --> -0.784367).  Saving model ...
Epoch: 9 cost time: 0.672602653503418
Epoch: 9, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.738 Vali Acc: 0.794 Test Loss: 0.738 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793743).  Saving model ...
Epoch: 10 cost time: 0.6726081371307373
Epoch: 10, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 0.7166414260864258
Epoch: 11, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.615 Vali Acc: 0.806 Test Loss: 0.615 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 12 cost time: 0.6663691997528076
Epoch: 12, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
Validation loss decreased (-0.806244 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 0.8063886165618896
Epoch: 13, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.7788443565368652
Epoch: 14, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.655034065246582
Epoch: 15, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.7437407970428467
Epoch: 16, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.7657463550567627
Epoch: 17, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 0.6841213703155518
Epoch: 18, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6821448802947998
Epoch: 19, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7693097591400146
Epoch: 20, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 21 cost time: 0.6845262050628662
Epoch: 21, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 0.6933994293212891
Epoch: 22, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.764028787612915
Epoch: 23, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 24 cost time: 0.6617300510406494
Epoch: 24, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.478 Vali Acc: 0.834 Test Loss: 0.478 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5895085334777832
Epoch: 25, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6544585227966309
Epoch: 26, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6512327194213867
Epoch: 27, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6450645923614502
Epoch: 28, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6788249015808105
Epoch: 29, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8341386318206787
Epoch: 30, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7910056114196777
Epoch: 31, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 0.5612328052520752
Epoch: 32, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.7200534343719482
Epoch: 33, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6735432147979736
Epoch: 34, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6596152782440186
Epoch: 35, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 36 cost time: 0.6582310199737549
Epoch: 36, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 37 cost time: 0.6337785720825195
Epoch: 37, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 38 cost time: 0.7528126239776611
Epoch: 38, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6497828960418701
Epoch: 39, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7764632701873779
Epoch: 40, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.746168851852417
Epoch: 41, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6921749114990234
Epoch: 42, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7468452453613281
Epoch: 43, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7650432586669922
Epoch: 44, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7098791599273682
Epoch: 45, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6948385238647461
Epoch: 46, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.500 Vali Acc: 0.863 Test Loss: 0.500 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 47 cost time: 0.7232406139373779
Epoch: 47, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7389206886291504
Epoch: 48, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.502 Vali Acc: 0.859 Test Loss: 0.502 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7456710338592529
Epoch: 49, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7518310546875
Epoch: 50, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.505 Vali Acc: 0.853 Test Loss: 0.505 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6809954643249512
Epoch: 51, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.599297285079956
Epoch: 52, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7155089378356934
Epoch: 53, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7723720073699951
Epoch: 54, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7596278190612793
Epoch: 55, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.515 Vali Acc: 0.859 Test Loss: 0.515 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.7121446132659912
Epoch: 56, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 49704
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0789151191711426
Epoch: 1, Steps: 8 | Train Loss: 2.260 Vali Loss: 2.169 Vali Acc: 0.072 Test Loss: 2.169 Test Acc: 0.072
Validation loss decreased (inf --> -0.071853).  Saving model ...
Epoch: 2 cost time: 0.7967541217803955
Epoch: 2, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.042 Vali Acc: 0.125 Test Loss: 2.042 Test Acc: 0.125
Validation loss decreased (-0.071853 --> -0.124980).  Saving model ...
Epoch: 3 cost time: 0.7462563514709473
Epoch: 3, Steps: 8 | Train Loss: 1.913 Vali Loss: 1.878 Vali Acc: 0.272 Test Loss: 1.878 Test Acc: 0.272
Validation loss decreased (-0.124980 --> -0.271856).  Saving model ...
Epoch: 4 cost time: 0.6831111907958984
Epoch: 4, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.692 Vali Acc: 0.409 Test Loss: 1.692 Test Acc: 0.409
Validation loss decreased (-0.271856 --> -0.409358).  Saving model ...
Epoch: 5 cost time: 0.7270972728729248
Epoch: 5, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.504 Vali Acc: 0.575 Test Loss: 1.504 Test Acc: 0.575
Validation loss decreased (-0.409358 --> -0.574985).  Saving model ...
Epoch: 6 cost time: 0.6893205642700195
Epoch: 6, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.330 Vali Acc: 0.666 Test Loss: 1.330 Test Acc: 0.666
Validation loss decreased (-0.574985 --> -0.665612).  Saving model ...
Epoch: 7 cost time: 0.7324917316436768
Epoch: 7, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.169 Vali Acc: 0.747 Test Loss: 1.169 Test Acc: 0.747
Validation loss decreased (-0.665612 --> -0.746863).  Saving model ...
Epoch: 8 cost time: 0.6392979621887207
Epoch: 8, Steps: 8 | Train Loss: 1.171 Vali Loss: 1.034 Vali Acc: 0.784 Test Loss: 1.034 Test Acc: 0.784
Validation loss decreased (-0.746863 --> -0.784365).  Saving model ...
Epoch: 9 cost time: 0.7184555530548096
Epoch: 9, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.916 Vali Acc: 0.794 Test Loss: 0.916 Test Acc: 0.794
Validation loss decreased (-0.784365 --> -0.793741).  Saving model ...
Epoch: 10 cost time: 0.6990745067596436
Epoch: 10, Steps: 8 | Train Loss: 0.854 Vali Loss: 0.822 Vali Acc: 0.794 Test Loss: 0.822 Test Acc: 0.794
Validation loss decreased (-0.793741 --> -0.793742).  Saving model ...
Epoch: 11 cost time: 0.6037282943725586
Epoch: 11, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.741 Vali Acc: 0.812 Test Loss: 0.741 Test Acc: 0.812
Validation loss decreased (-0.793742 --> -0.812493).  Saving model ...
Epoch: 12 cost time: 0.6404995918273926
Epoch: 12, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6016056537628174
Epoch: 13, Steps: 8 | Train Loss: 0.584 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6243515014648438
Epoch: 14, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6843533515930176
Epoch: 15, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.589 Vali Acc: 0.806 Test Loss: 0.589 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6953105926513672
Epoch: 16, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5969557762145996
Epoch: 17, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.559 Vali Acc: 0.812 Test Loss: 0.559 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 18 cost time: 0.7090821266174316
Epoch: 18, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812495).  Saving model ...
Epoch: 19 cost time: 0.699676513671875
Epoch: 19, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.812495 --> -0.818745).  Saving model ...
Epoch: 20 cost time: 0.703648567199707
Epoch: 20, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
Validation loss decreased (-0.818745 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 0.6699590682983398
Epoch: 21, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.679495096206665
Epoch: 22, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7186391353607178
Epoch: 23, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6267721652984619
Epoch: 24, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 25 cost time: 0.7625441551208496
Epoch: 25, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6749944686889648
Epoch: 26, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7437982559204102
Epoch: 27, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6940526962280273
Epoch: 28, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.486 Vali Acc: 0.828 Test Loss: 0.486 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.650855541229248
Epoch: 29, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.484 Vali Acc: 0.828 Test Loss: 0.484 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7738678455352783
Epoch: 30, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.494 Vali Acc: 0.825 Test Loss: 0.494 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6487729549407959
Epoch: 31, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 32 cost time: 0.7344789505004883
Epoch: 32, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.486 Vali Acc: 0.834 Test Loss: 0.486 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 33 cost time: 0.6163144111633301
Epoch: 33, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.482 Vali Acc: 0.831 Test Loss: 0.482 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7325420379638672
Epoch: 34, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.478 Vali Acc: 0.828 Test Loss: 0.478 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7292394638061523
Epoch: 35, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.474 Vali Acc: 0.828 Test Loss: 0.474 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7928597927093506
Epoch: 36, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.474 Vali Acc: 0.831 Test Loss: 0.474 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8393940925598145
Epoch: 37, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.480 Vali Acc: 0.831 Test Loss: 0.480 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7647552490234375
Epoch: 38, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.484 Vali Acc: 0.834 Test Loss: 0.484 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 39 cost time: 0.8419864177703857
Epoch: 39, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 40 cost time: 0.8571910858154297
Epoch: 40, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.478 Vali Acc: 0.825 Test Loss: 0.478 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8371949195861816
Epoch: 41, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.477 Vali Acc: 0.834 Test Loss: 0.477 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8760054111480713
Epoch: 42, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.478 Vali Acc: 0.834 Test Loss: 0.478 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.796511173248291
Epoch: 43, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 44 cost time: 0.8149728775024414
Epoch: 44, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 45 cost time: 0.7436134815216064
Epoch: 45, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6975483894348145
Epoch: 46, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 47 cost time: 0.767038106918335
Epoch: 47, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 48 cost time: 0.7359035015106201
Epoch: 48, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7272346019744873
Epoch: 49, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 50 cost time: 0.7476189136505127
Epoch: 50, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7271416187286377
Epoch: 51, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.770822286605835
Epoch: 52, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8722479343414307
Epoch: 53, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7804157733917236
Epoch: 54, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 55 cost time: 0.6967949867248535
Epoch: 55, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7766737937927246
Epoch: 56, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 57 cost time: 0.7145700454711914
Epoch: 57, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7499485015869141
Epoch: 58, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8539712429046631
Epoch: 59, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7926738262176514
Epoch: 60, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8728983402252197
Epoch: 61, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8568897247314453
Epoch: 62, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.7926235198974609
Epoch: 63, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.8367288112640381
Epoch: 64, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.8173046112060547
Epoch: 65, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.9249422550201416
Epoch: 66, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 47112
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.320737361907959
Epoch: 1, Steps: 8 | Train Loss: 2.256 Vali Loss: 2.114 Vali Acc: 0.084 Test Loss: 2.114 Test Acc: 0.084
Validation loss decreased (inf --> -0.084354).  Saving model ...
Epoch: 2 cost time: 0.7222330570220947
Epoch: 2, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.000 Vali Acc: 0.166 Test Loss: 2.000 Test Acc: 0.166
Validation loss decreased (-0.084354 --> -0.165605).  Saving model ...
Epoch: 3 cost time: 0.8331334590911865
Epoch: 3, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.845 Vali Acc: 0.316 Test Loss: 1.845 Test Acc: 0.316
Validation loss decreased (-0.165605 --> -0.315607).  Saving model ...
Epoch: 4 cost time: 0.6326947212219238
Epoch: 4, Steps: 8 | Train Loss: 1.817 Vali Loss: 1.673 Vali Acc: 0.475 Test Loss: 1.673 Test Acc: 0.475
Validation loss decreased (-0.315607 --> -0.474983).  Saving model ...
Epoch: 5 cost time: 0.7577083110809326
Epoch: 5, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.504 Vali Acc: 0.578 Test Loss: 1.504 Test Acc: 0.578
Validation loss decreased (-0.474983 --> -0.578110).  Saving model ...
Epoch: 6 cost time: 0.7325665950775146
Epoch: 6, Steps: 8 | Train Loss: 1.497 Vali Loss: 1.351 Vali Acc: 0.644 Test Loss: 1.351 Test Acc: 0.644
Validation loss decreased (-0.578110 --> -0.643736).  Saving model ...
Epoch: 7 cost time: 0.8108036518096924
Epoch: 7, Steps: 8 | Train Loss: 1.354 Vali Loss: 1.213 Vali Acc: 0.725 Test Loss: 1.213 Test Acc: 0.725
Validation loss decreased (-0.643736 --> -0.724988).  Saving model ...
Epoch: 8 cost time: 0.7648160457611084
Epoch: 8, Steps: 8 | Train Loss: 1.275 Vali Loss: 1.087 Vali Acc: 0.759 Test Loss: 1.087 Test Acc: 0.759
Validation loss decreased (-0.724988 --> -0.759364).  Saving model ...
Epoch: 9 cost time: 0.7378151416778564
Epoch: 9, Steps: 8 | Train Loss: 1.121 Vali Loss: 0.982 Vali Acc: 0.772 Test Loss: 0.982 Test Acc: 0.772
Validation loss decreased (-0.759364 --> -0.771865).  Saving model ...
Epoch: 10 cost time: 0.715782880783081
Epoch: 10, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.891 Vali Acc: 0.794 Test Loss: 0.891 Test Acc: 0.794
Validation loss decreased (-0.771865 --> -0.793741).  Saving model ...
Epoch: 11 cost time: 0.713923454284668
Epoch: 11, Steps: 8 | Train Loss: 0.856 Vali Loss: 0.814 Vali Acc: 0.800 Test Loss: 0.814 Test Acc: 0.800
Validation loss decreased (-0.793741 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.699901819229126
Epoch: 12, Steps: 8 | Train Loss: 0.770 Vali Loss: 0.756 Vali Acc: 0.809 Test Loss: 0.756 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809367).  Saving model ...
Epoch: 13 cost time: 0.5702517032623291
Epoch: 13, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.702 Vali Acc: 0.812 Test Loss: 0.702 Test Acc: 0.812
Validation loss decreased (-0.809367 --> -0.812493).  Saving model ...
Epoch: 14 cost time: 0.6164228916168213
Epoch: 14, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.661 Vali Acc: 0.812 Test Loss: 0.661 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812493).  Saving model ...
Epoch: 15 cost time: 0.6725172996520996
Epoch: 15, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7240204811096191
Epoch: 16, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.604 Vali Acc: 0.806 Test Loss: 0.604 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7456090450286865
Epoch: 17, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7196476459503174
Epoch: 18, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 19 cost time: 0.6956305503845215
Epoch: 19, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 20 cost time: 0.7384843826293945
Epoch: 20, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 21 cost time: 0.7600860595703125
Epoch: 21, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 22 cost time: 0.7633113861083984
Epoch: 22, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 23 cost time: 0.7612457275390625
Epoch: 23, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7540667057037354
Epoch: 24, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 25 cost time: 0.8019533157348633
Epoch: 25, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 26 cost time: 0.7125952243804932
Epoch: 26, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 27 cost time: 0.7489495277404785
Epoch: 27, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8228821754455566
Epoch: 28, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7691440582275391
Epoch: 29, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6778459548950195
Epoch: 30, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7400124073028564
Epoch: 31, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6951289176940918
Epoch: 32, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.7895405292510986
Epoch: 33, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 34 cost time: 0.7379882335662842
Epoch: 34, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 35 cost time: 0.7556717395782471
Epoch: 35, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 36 cost time: 0.7709369659423828
Epoch: 36, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 37 cost time: 0.7515952587127686
Epoch: 37, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7210121154785156
Epoch: 38, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.686068058013916
Epoch: 39, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6710186004638672
Epoch: 40, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6978321075439453
Epoch: 41, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7151906490325928
Epoch: 42, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.671868085861206
Epoch: 43, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8013808727264404
Epoch: 44, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 45 cost time: 0.7379610538482666
Epoch: 45, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7356464862823486
Epoch: 46, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7512967586517334
Epoch: 47, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.750093936920166
Epoch: 48, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 49 cost time: 0.7573509216308594
Epoch: 49, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 50 cost time: 0.7813982963562012
Epoch: 50, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7282631397247314
Epoch: 51, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7743465900421143
Epoch: 52, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8048605918884277
Epoch: 53, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7578780651092529
Epoch: 54, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.468 Vali Acc: 0.866 Test Loss: 0.468 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 55 cost time: 0.7597637176513672
Epoch: 55, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.472 Vali Acc: 0.866 Test Loss: 0.472 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.816645622253418
Epoch: 56, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8609457015991211
Epoch: 57, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.476 Vali Acc: 0.863 Test Loss: 0.476 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8045485019683838
Epoch: 58, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7707476615905762
Epoch: 59, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.763505220413208
Epoch: 60, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.775292158126831
Epoch: 61, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.475 Vali Acc: 0.863 Test Loss: 0.475 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.855126142501831
Epoch: 62, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7821249961853027
Epoch: 63, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.476 Vali Acc: 0.863 Test Loss: 0.476 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7480788230895996
Epoch: 64, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.477 Vali Acc: 0.863 Test Loss: 0.477 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 46088
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2878775596618652
Epoch: 1, Steps: 8 | Train Loss: 2.097 Vali Loss: 1.877 Vali Acc: 0.325 Test Loss: 1.877 Test Acc: 0.325
Validation loss decreased (inf --> -0.324981).  Saving model ...
Epoch: 2 cost time: 0.7217938899993896
Epoch: 2, Steps: 8 | Train Loss: 1.700 Vali Loss: 1.384 Vali Acc: 0.697 Test Loss: 1.384 Test Acc: 0.697
Validation loss decreased (-0.324981 --> -0.696861).  Saving model ...
Epoch: 3 cost time: 0.7396361827850342
Epoch: 3, Steps: 8 | Train Loss: 1.198 Vali Loss: 0.944 Vali Acc: 0.769 Test Loss: 0.944 Test Acc: 0.769
Validation loss decreased (-0.696861 --> -0.768741).  Saving model ...
Epoch: 4 cost time: 0.7557923793792725
Epoch: 4, Steps: 8 | Train Loss: 0.812 Vali Loss: 0.684 Vali Acc: 0.803 Test Loss: 0.684 Test Acc: 0.803
Validation loss decreased (-0.768741 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 0.6743021011352539
Epoch: 5, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 0.7784161567687988
Epoch: 6, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.8082551956176758
Epoch: 7, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8029587268829346
Epoch: 8, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.8307056427001953
Epoch: 9, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7565703392028809
Epoch: 10, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7411744594573975
Epoch: 11, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 0.8031880855560303
Epoch: 12, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7669827938079834
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.576 Vali Acc: 0.834 Test Loss: 0.576 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6964423656463623
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7648396492004395
Epoch: 15, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.611 Vali Acc: 0.847 Test Loss: 0.611 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 16 cost time: 0.7156155109405518
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.628 Vali Acc: 0.841 Test Loss: 0.628 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7456607818603516
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.637 Vali Acc: 0.838 Test Loss: 0.637 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7397446632385254
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.651 Vali Acc: 0.838 Test Loss: 0.651 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7974328994750977
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.676 Vali Acc: 0.831 Test Loss: 0.676 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8920361995697021
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.691 Vali Acc: 0.825 Test Loss: 0.691 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.910024881362915
Epoch: 21, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.700 Vali Acc: 0.831 Test Loss: 0.700 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8641762733459473
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.706 Vali Acc: 0.825 Test Loss: 0.706 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9506504535675049
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.716 Vali Acc: 0.831 Test Loss: 0.716 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9540016651153564
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.721 Vali Acc: 0.838 Test Loss: 0.721 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9003348350524902
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.730 Vali Acc: 0.834 Test Loss: 0.730 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 85864
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2297143936157227
Epoch: 1, Steps: 8 | Train Loss: 2.260 Vali Loss: 2.164 Vali Acc: 0.181 Test Loss: 2.164 Test Acc: 0.181
Validation loss decreased (inf --> -0.181228).  Saving model ...
Epoch: 2 cost time: 0.7118229866027832
Epoch: 2, Steps: 8 | Train Loss: 2.081 Vali Loss: 1.903 Vali Acc: 0.309 Test Loss: 1.903 Test Acc: 0.309
Validation loss decreased (-0.181228 --> -0.309356).  Saving model ...
Epoch: 3 cost time: 0.9099612236022949
Epoch: 3, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.568 Vali Acc: 0.597 Test Loss: 1.568 Test Acc: 0.597
Validation loss decreased (-0.309356 --> -0.596859).  Saving model ...
Epoch: 4 cost time: 0.7507059574127197
Epoch: 4, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.238 Vali Acc: 0.688 Test Loss: 1.238 Test Acc: 0.688
Validation loss decreased (-0.596859 --> -0.687488).  Saving model ...
Epoch: 5 cost time: 0.7553935050964355
Epoch: 5, Steps: 8 | Train Loss: 1.161 Vali Loss: 0.966 Vali Acc: 0.744 Test Loss: 0.966 Test Acc: 0.744
Validation loss decreased (-0.687488 --> -0.743740).  Saving model ...
Epoch: 6 cost time: 0.8517293930053711
Epoch: 6, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.773 Vali Acc: 0.794 Test Loss: 0.773 Test Acc: 0.794
Validation loss decreased (-0.743740 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.7593286037445068
Epoch: 7, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
Validation loss decreased (-0.793742 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.7545700073242188
Epoch: 8, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
Validation loss decreased (-0.799993 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.9037528038024902
Epoch: 9, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8770372867584229
Epoch: 10, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.7950320243835449
Epoch: 11, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.9133400917053223
Epoch: 12, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 0.8024289608001709
Epoch: 13, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8041439056396484
Epoch: 14, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.838043212890625
Epoch: 15, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8929042816162109
Epoch: 16, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.748441219329834
Epoch: 17, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8745441436767578
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8521175384521484
Epoch: 19, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8845207691192627
Epoch: 20, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9385583400726318
Epoch: 21, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.855069637298584
Epoch: 22, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 56168
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.208224058151245
Epoch: 1, Steps: 8 | Train Loss: 2.123 Vali Loss: 2.032 Vali Acc: 0.191 Test Loss: 2.032 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 0.8738884925842285
Epoch: 2, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.814 Vali Acc: 0.372 Test Loss: 1.814 Test Acc: 0.372
Validation loss decreased (-0.190605 --> -0.371857).  Saving model ...
Epoch: 3 cost time: 0.8716170787811279
Epoch: 3, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.538 Vali Acc: 0.650 Test Loss: 1.538 Test Acc: 0.650
Validation loss decreased (-0.371857 --> -0.649985).  Saving model ...
Epoch: 4 cost time: 0.8562777042388916
Epoch: 4, Steps: 8 | Train Loss: 1.410 Vali Loss: 1.266 Vali Acc: 0.731 Test Loss: 1.266 Test Acc: 0.731
Validation loss decreased (-0.649985 --> -0.731237).  Saving model ...
Epoch: 5 cost time: 0.7616755962371826
Epoch: 5, Steps: 8 | Train Loss: 1.179 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
Validation loss decreased (-0.731237 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.7882449626922607
Epoch: 6, Steps: 8 | Train Loss: 0.944 Vali Loss: 0.842 Vali Acc: 0.781 Test Loss: 0.842 Test Acc: 0.781
Validation loss decreased (-0.774990 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.8693881034851074
Epoch: 7, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.7495965957641602
Epoch: 8, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.621 Vali Acc: 0.816 Test Loss: 0.621 Test Acc: 0.816
Validation loss decreased (-0.799993 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.7149195671081543
Epoch: 9, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.8322229385375977
Epoch: 10, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 0.7386586666107178
Epoch: 11, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.6583905220031738
Epoch: 12, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.6950259208679199
Epoch: 13, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 0.7573895454406738
Epoch: 14, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7785131931304932
Epoch: 15, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6867721080780029
Epoch: 16, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7445268630981445
Epoch: 17, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7649784088134766
Epoch: 18, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7984166145324707
Epoch: 19, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8016352653503418
Epoch: 20, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8236160278320312
Epoch: 21, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8088903427124023
Epoch: 22, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.793837308883667
Epoch: 23, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 46440
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.335585594177246
Epoch: 1, Steps: 8 | Train Loss: 2.032 Vali Loss: 2.037 Vali Acc: 0.175 Test Loss: 2.037 Test Acc: 0.175
Validation loss decreased (inf --> -0.174980).  Saving model ...
Epoch: 2 cost time: 0.8711271286010742
Epoch: 2, Steps: 8 | Train Loss: 1.922 Vali Loss: 1.898 Vali Acc: 0.353 Test Loss: 1.898 Test Acc: 0.353
Validation loss decreased (-0.174980 --> -0.353106).  Saving model ...
Epoch: 3 cost time: 0.8095693588256836
Epoch: 3, Steps: 8 | Train Loss: 1.855 Vali Loss: 1.706 Vali Acc: 0.503 Test Loss: 1.706 Test Acc: 0.503
Validation loss decreased (-0.353106 --> -0.503108).  Saving model ...
Epoch: 4 cost time: 0.9478640556335449
Epoch: 4, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.501 Vali Acc: 0.634 Test Loss: 1.501 Test Acc: 0.634
Validation loss decreased (-0.503108 --> -0.634360).  Saving model ...
Epoch: 5 cost time: 0.7837228775024414
Epoch: 5, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.294 Vali Acc: 0.703 Test Loss: 1.294 Test Acc: 0.703
Validation loss decreased (-0.634360 --> -0.703112).  Saving model ...
Epoch: 6 cost time: 0.92366623878479
Epoch: 6, Steps: 8 | Train Loss: 1.163 Vali Loss: 1.105 Vali Acc: 0.728 Test Loss: 1.105 Test Acc: 0.728
Validation loss decreased (-0.703112 --> -0.728114).  Saving model ...
Epoch: 7 cost time: 0.7240972518920898
Epoch: 7, Steps: 8 | Train Loss: 0.921 Vali Loss: 0.941 Vali Acc: 0.766 Test Loss: 0.941 Test Acc: 0.766
Validation loss decreased (-0.728114 --> -0.765616).  Saving model ...
Epoch: 8 cost time: 0.8988142013549805
Epoch: 8, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.804 Vali Acc: 0.778 Test Loss: 0.804 Test Acc: 0.778
Validation loss decreased (-0.765616 --> -0.778117).  Saving model ...
Epoch: 9 cost time: 0.8890829086303711
Epoch: 9, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.778117 --> -0.803118).  Saving model ...
Epoch: 10 cost time: 0.7669012546539307
Epoch: 10, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 11 cost time: 0.7405169010162354
Epoch: 11, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.593 Vali Acc: 0.800 Test Loss: 0.593 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8084440231323242
Epoch: 12, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 13 cost time: 0.8980164527893066
Epoch: 13, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821870).  Saving model ...
Epoch: 14 cost time: 0.8491628170013428
Epoch: 14, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.8385758399963379
Epoch: 15, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.8045852184295654
Epoch: 16, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.497 Vali Acc: 0.825 Test Loss: 0.497 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9015545845031738
Epoch: 17, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.492 Vali Acc: 0.828 Test Loss: 0.492 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7685348987579346
Epoch: 18, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.484 Vali Acc: 0.834 Test Loss: 0.484 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.939835786819458
Epoch: 19, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9022963047027588
Epoch: 20, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8714001178741455
Epoch: 21, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.491 Vali Acc: 0.831 Test Loss: 0.491 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8416440486907959
Epoch: 22, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8902628421783447
Epoch: 23, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7701542377471924
Epoch: 24, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 25 cost time: 0.8218872547149658
Epoch: 25, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7174479961395264
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7288706302642822
Epoch: 27, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8386948108673096
Epoch: 28, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8655412197113037
Epoch: 29, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 30 cost time: 0.8113176822662354
Epoch: 30, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9813487529754639
Epoch: 31, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7960731983184814
Epoch: 32, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 33 cost time: 0.8098671436309814
Epoch: 33, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8286964893341064
Epoch: 34, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9695851802825928
Epoch: 35, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.786536693572998
Epoch: 36, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8784148693084717
Epoch: 37, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7980191707611084
Epoch: 38, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8725121021270752
Epoch: 39, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8243870735168457
Epoch: 40, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.926931619644165
Epoch: 41, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9559059143066406
Epoch: 42, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 41320
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.124610185623169
Epoch: 1, Steps: 8 | Train Loss: 2.209 Vali Loss: 2.211 Vali Acc: 0.119 Test Loss: 2.211 Test Acc: 0.119
Validation loss decreased (inf --> -0.118728).  Saving model ...
Epoch: 2 cost time: 0.7409584522247314
Epoch: 2, Steps: 8 | Train Loss: 2.200 Vali Loss: 2.088 Vali Acc: 0.166 Test Loss: 2.088 Test Acc: 0.166
Validation loss decreased (-0.118728 --> -0.165604).  Saving model ...
Epoch: 3 cost time: 0.8038156032562256
Epoch: 3, Steps: 8 | Train Loss: 2.029 Vali Loss: 1.912 Vali Acc: 0.287 Test Loss: 1.912 Test Acc: 0.287
Validation loss decreased (-0.165604 --> -0.287481).  Saving model ...
Epoch: 4 cost time: 0.7767257690429688
Epoch: 4, Steps: 8 | Train Loss: 1.845 Vali Loss: 1.704 Vali Acc: 0.428 Test Loss: 1.704 Test Acc: 0.428
Validation loss decreased (-0.287481 --> -0.428108).  Saving model ...
Epoch: 5 cost time: 0.8403804302215576
Epoch: 5, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.489 Vali Acc: 0.597 Test Loss: 1.489 Test Acc: 0.597
Validation loss decreased (-0.428108 --> -0.596860).  Saving model ...
Epoch: 6 cost time: 0.7471673488616943
Epoch: 6, Steps: 8 | Train Loss: 1.366 Vali Loss: 1.286 Vali Acc: 0.700 Test Loss: 1.286 Test Acc: 0.700
Validation loss decreased (-0.596860 --> -0.699987).  Saving model ...
Epoch: 7 cost time: 0.829857587814331
Epoch: 7, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.105 Vali Acc: 0.756 Test Loss: 1.105 Test Acc: 0.756
Validation loss decreased (-0.699987 --> -0.756239).  Saving model ...
Epoch: 8 cost time: 0.7940940856933594
Epoch: 8, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.947 Vali Acc: 0.769 Test Loss: 0.947 Test Acc: 0.769
Validation loss decreased (-0.756239 --> -0.768741).  Saving model ...
Epoch: 9 cost time: 0.6669869422912598
Epoch: 9, Steps: 8 | Train Loss: 0.871 Vali Loss: 0.819 Vali Acc: 0.784 Test Loss: 0.819 Test Acc: 0.784
Validation loss decreased (-0.768741 --> -0.784367).  Saving model ...
Epoch: 10 cost time: 0.7510941028594971
Epoch: 10, Steps: 8 | Train Loss: 0.812 Vali Loss: 0.719 Vali Acc: 0.797 Test Loss: 0.719 Test Acc: 0.797
Validation loss decreased (-0.784367 --> -0.796868).  Saving model ...
Epoch: 11 cost time: 0.8365879058837891
Epoch: 11, Steps: 8 | Train Loss: 0.675 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
Validation loss decreased (-0.796868 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.910578727722168
Epoch: 12, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 0.8441371917724609
Epoch: 13, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 0.922957181930542
Epoch: 14, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8433804512023926
Epoch: 15, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 16 cost time: 0.8438334465026855
Epoch: 16, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.7825205326080322
Epoch: 17, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.701329231262207
Epoch: 18, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 0.7468571662902832
Epoch: 19, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9913015365600586
Epoch: 20, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 0.7904443740844727
Epoch: 21, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7371397018432617
Epoch: 22, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8320426940917969
Epoch: 23, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8897027969360352
Epoch: 24, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7968361377716064
Epoch: 25, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7349143028259277
Epoch: 26, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7320361137390137
Epoch: 27, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.784961462020874
Epoch: 28, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7112846374511719
Epoch: 29, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6905169486999512
Epoch: 30, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 37224
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.272124767303467
Epoch: 1, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.978 Vali Acc: 0.216 Test Loss: 1.978 Test Acc: 0.216
Validation loss decreased (inf --> -0.215605).  Saving model ...
Epoch: 2 cost time: 0.8371026515960693
Epoch: 2, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.830 Vali Acc: 0.300 Test Loss: 1.830 Test Acc: 0.300
Validation loss decreased (-0.215605 --> -0.299982).  Saving model ...
Epoch: 3 cost time: 0.77115797996521
Epoch: 3, Steps: 8 | Train Loss: 1.786 Vali Loss: 1.667 Vali Acc: 0.450 Test Loss: 1.667 Test Acc: 0.450
Validation loss decreased (-0.299982 --> -0.449983).  Saving model ...
Epoch: 4 cost time: 0.7396254539489746
Epoch: 4, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.498 Vali Acc: 0.578 Test Loss: 1.498 Test Acc: 0.578
Validation loss decreased (-0.449983 --> -0.578110).  Saving model ...
Epoch: 5 cost time: 0.8325161933898926
Epoch: 5, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.341 Vali Acc: 0.641 Test Loss: 1.341 Test Acc: 0.641
Validation loss decreased (-0.578110 --> -0.640612).  Saving model ...
Epoch: 6 cost time: 0.6972184181213379
Epoch: 6, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.190 Vali Acc: 0.691 Test Loss: 1.190 Test Acc: 0.691
Validation loss decreased (-0.640612 --> -0.690613).  Saving model ...
Epoch: 7 cost time: 0.8444902896881104
Epoch: 7, Steps: 8 | Train Loss: 1.170 Vali Loss: 1.058 Vali Acc: 0.741 Test Loss: 1.058 Test Acc: 0.741
Validation loss decreased (-0.690613 --> -0.740614).  Saving model ...
Epoch: 8 cost time: 0.7388906478881836
Epoch: 8, Steps: 8 | Train Loss: 1.016 Vali Loss: 0.947 Vali Acc: 0.762 Test Loss: 0.947 Test Acc: 0.762
Validation loss decreased (-0.740614 --> -0.762491).  Saving model ...
Epoch: 9 cost time: 0.7899539470672607
Epoch: 9, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.856 Vali Acc: 0.787 Test Loss: 0.856 Test Acc: 0.787
Validation loss decreased (-0.762491 --> -0.787491).  Saving model ...
Epoch: 10 cost time: 0.8138473033905029
Epoch: 10, Steps: 8 | Train Loss: 0.781 Vali Loss: 0.780 Vali Acc: 0.794 Test Loss: 0.780 Test Acc: 0.794
Validation loss decreased (-0.787491 --> -0.793742).  Saving model ...
Epoch: 11 cost time: 0.7483739852905273
Epoch: 11, Steps: 8 | Train Loss: 0.721 Vali Loss: 0.724 Vali Acc: 0.791 Test Loss: 0.724 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7260415554046631
Epoch: 12, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
Validation loss decreased (-0.793742 --> -0.793743).  Saving model ...
Epoch: 13 cost time: 0.8302533626556396
Epoch: 13, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.7275309562683105
Epoch: 14, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 0.8376784324645996
Epoch: 15, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
Validation loss decreased (-0.799994 --> -0.809369).  Saving model ...
Epoch: 16 cost time: 0.6319084167480469
Epoch: 16, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.589 Vali Acc: 0.806 Test Loss: 0.589 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7996177673339844
Epoch: 17, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 18 cost time: 0.8614919185638428
Epoch: 18, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8598244190216064
Epoch: 19, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8310034275054932
Epoch: 20, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8193473815917969
Epoch: 21, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8455395698547363
Epoch: 22, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 23 cost time: 0.7565958499908447
Epoch: 23, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 24 cost time: 0.7204883098602295
Epoch: 24, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 25 cost time: 0.9163639545440674
Epoch: 25, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 26 cost time: 0.7594799995422363
Epoch: 26, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 27 cost time: 0.840808629989624
Epoch: 27, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7202718257904053
Epoch: 28, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7249245643615723
Epoch: 29, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.788776159286499
Epoch: 30, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 31 cost time: 0.7419342994689941
Epoch: 31, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 32 cost time: 0.7528040409088135
Epoch: 32, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 33 cost time: 0.8259527683258057
Epoch: 33, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7777528762817383
Epoch: 34, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8336420059204102
Epoch: 35, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.867591142654419
Epoch: 36, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7554361820220947
Epoch: 37, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7481293678283691
Epoch: 38, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8837690353393555
Epoch: 39, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7589097023010254
Epoch: 40, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8250260353088379
Epoch: 41, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 0.7346365451812744
Epoch: 42, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 0.863530158996582
Epoch: 43, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 44 cost time: 0.7371766567230225
Epoch: 44, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7568480968475342
Epoch: 45, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.771587610244751
Epoch: 46, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7197344303131104
Epoch: 47, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6023468971252441
Epoch: 48, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7222893238067627
Epoch: 49, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9248974323272705
Epoch: 50, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7843823432922363
Epoch: 51, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7969703674316406
Epoch: 52, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.7749199867248535
Epoch: 53, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 34632
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3545100688934326
Epoch: 1, Steps: 8 | Train Loss: 2.343 Vali Loss: 2.262 Vali Acc: 0.072 Test Loss: 2.262 Test Acc: 0.072
Validation loss decreased (inf --> -0.071852).  Saving model ...
Epoch: 2 cost time: 0.7089645862579346
Epoch: 2, Steps: 8 | Train Loss: 2.204 Vali Loss: 2.158 Vali Acc: 0.122 Test Loss: 2.158 Test Acc: 0.122
Validation loss decreased (-0.071852 --> -0.121853).  Saving model ...
Epoch: 3 cost time: 0.7051053047180176
Epoch: 3, Steps: 8 | Train Loss: 2.108 Vali Loss: 2.020 Vali Acc: 0.216 Test Loss: 2.020 Test Acc: 0.216
Validation loss decreased (-0.121853 --> -0.215605).  Saving model ...
Epoch: 4 cost time: 0.7791106700897217
Epoch: 4, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.860 Vali Acc: 0.331 Test Loss: 1.860 Test Acc: 0.331
Validation loss decreased (-0.215605 --> -0.331231).  Saving model ...
Epoch: 5 cost time: 0.7143371105194092
Epoch: 5, Steps: 8 | Train Loss: 1.793 Vali Loss: 1.688 Vali Acc: 0.456 Test Loss: 1.688 Test Acc: 0.456
Validation loss decreased (-0.331231 --> -0.456233).  Saving model ...
Epoch: 6 cost time: 0.7536253929138184
Epoch: 6, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.517 Vali Acc: 0.575 Test Loss: 1.517 Test Acc: 0.575
Validation loss decreased (-0.456233 --> -0.574985).  Saving model ...
Epoch: 7 cost time: 0.8228003978729248
Epoch: 7, Steps: 8 | Train Loss: 1.445 Vali Loss: 1.355 Vali Acc: 0.647 Test Loss: 1.355 Test Acc: 0.647
Validation loss decreased (-0.574985 --> -0.646861).  Saving model ...
Epoch: 8 cost time: 0.7741448879241943
Epoch: 8, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.215 Vali Acc: 0.681 Test Loss: 1.215 Test Acc: 0.681
Validation loss decreased (-0.646861 --> -0.681238).  Saving model ...
Epoch: 9 cost time: 0.7088468074798584
Epoch: 9, Steps: 8 | Train Loss: 1.160 Vali Loss: 1.083 Vali Acc: 0.734 Test Loss: 1.083 Test Acc: 0.734
Validation loss decreased (-0.681238 --> -0.734364).  Saving model ...
Epoch: 10 cost time: 0.7172143459320068
Epoch: 10, Steps: 8 | Train Loss: 0.992 Vali Loss: 0.974 Vali Acc: 0.772 Test Loss: 0.974 Test Acc: 0.772
Validation loss decreased (-0.734364 --> -0.771865).  Saving model ...
Epoch: 11 cost time: 0.8063788414001465
Epoch: 11, Steps: 8 | Train Loss: 0.891 Vali Loss: 0.886 Vali Acc: 0.775 Test Loss: 0.886 Test Acc: 0.775
Validation loss decreased (-0.771865 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.6781446933746338
Epoch: 12, Steps: 8 | Train Loss: 0.799 Vali Loss: 0.813 Vali Acc: 0.778 Test Loss: 0.813 Test Acc: 0.778
Validation loss decreased (-0.774991 --> -0.778117).  Saving model ...
Epoch: 13 cost time: 0.8064627647399902
Epoch: 13, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.756 Vali Acc: 0.787 Test Loss: 0.756 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787492).  Saving model ...
Epoch: 14 cost time: 0.8011884689331055
Epoch: 14, Steps: 8 | Train Loss: 0.651 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 15 cost time: 0.7294158935546875
Epoch: 15, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.678 Vali Acc: 0.791 Test Loss: 0.678 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7222356796264648
Epoch: 16, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 17 cost time: 0.7982738018035889
Epoch: 17, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.636 Vali Acc: 0.794 Test Loss: 0.636 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793744).  Saving model ...
Epoch: 18 cost time: 0.9036197662353516
Epoch: 18, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.611 Vali Acc: 0.791 Test Loss: 0.611 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7399990558624268
Epoch: 19, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.601 Vali Acc: 0.797 Test Loss: 0.601 Test Acc: 0.797
Validation loss decreased (-0.793744 --> -0.796869).  Saving model ...
Epoch: 20 cost time: 0.6962823867797852
Epoch: 20, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
Validation loss decreased (-0.796869 --> -0.796869).  Saving model ...
Epoch: 21 cost time: 0.7459750175476074
Epoch: 21, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
Validation loss decreased (-0.796869 --> -0.812494).  Saving model ...
Epoch: 22 cost time: 0.8132460117340088
Epoch: 22, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7473292350769043
Epoch: 23, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 24 cost time: 0.7845687866210938
Epoch: 24, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815620).  Saving model ...
Epoch: 25 cost time: 0.7643420696258545
Epoch: 25, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
Validation loss decreased (-0.815620 --> -0.815620).  Saving model ...
Epoch: 26 cost time: 0.7756869792938232
Epoch: 26, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
Validation loss decreased (-0.815620 --> -0.818745).  Saving model ...
Epoch: 27 cost time: 0.676964521408081
Epoch: 27, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 28 cost time: 0.7314612865447998
Epoch: 28, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 29 cost time: 0.7106316089630127
Epoch: 29, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 30 cost time: 0.7881386280059814
Epoch: 30, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.61012864112854
Epoch: 31, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 32 cost time: 0.6123616695404053
Epoch: 32, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 33 cost time: 0.6211862564086914
Epoch: 33, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 34 cost time: 0.5822298526763916
Epoch: 34, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 0.5642311573028564
Epoch: 35, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 36 cost time: 0.6261534690856934
Epoch: 36, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6320662498474121
Epoch: 37, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7408699989318848
Epoch: 38, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 39 cost time: 0.6300792694091797
Epoch: 39, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6647622585296631
Epoch: 40, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6774680614471436
Epoch: 41, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7346165180206299
Epoch: 42, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6415529251098633
Epoch: 43, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 44 cost time: 0.6479694843292236
Epoch: 44, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 45 cost time: 0.6951737403869629
Epoch: 45, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 46 cost time: 0.6932258605957031
Epoch: 46, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.454 Vali Acc: 0.866 Test Loss: 0.454 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 47 cost time: 0.656761884689331
Epoch: 47, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6132113933563232
Epoch: 48, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6612734794616699
Epoch: 49, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7615594863891602
Epoch: 50, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6231098175048828
Epoch: 51, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.457 Vali Acc: 0.863 Test Loss: 0.457 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6130266189575195
Epoch: 52, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.6220273971557617
Epoch: 53, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.460 Vali Acc: 0.863 Test Loss: 0.460 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7209115028381348
Epoch: 54, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.461 Vali Acc: 0.866 Test Loss: 0.461 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7864463329315186
Epoch: 55, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8118367195129395
Epoch: 56, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm32_nh4_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 33608
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.233236789703369
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.060 Vali Acc: 0.206 Test Loss: 2.060 Test Acc: 0.206
Validation loss decreased (inf --> -0.206229).  Saving model ...
Epoch: 2 cost time: 0.7842197418212891
Epoch: 2, Steps: 8 | Train Loss: 2.028 Vali Loss: 1.778 Vali Acc: 0.406 Test Loss: 1.778 Test Acc: 0.406
Validation loss decreased (-0.206229 --> -0.406232).  Saving model ...
Epoch: 3 cost time: 0.7546215057373047
Epoch: 3, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.446 Vali Acc: 0.613 Test Loss: 1.446 Test Acc: 0.613
Validation loss decreased (-0.406232 --> -0.612486).  Saving model ...
Epoch: 4 cost time: 0.8614292144775391
Epoch: 4, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.126 Vali Acc: 0.762 Test Loss: 1.126 Test Acc: 0.762
Validation loss decreased (-0.612486 --> -0.762489).  Saving model ...
Epoch: 5 cost time: 0.8752286434173584
Epoch: 5, Steps: 8 | Train Loss: 1.051 Vali Loss: 0.871 Vali Acc: 0.778 Test Loss: 0.871 Test Acc: 0.778
Validation loss decreased (-0.762489 --> -0.778116).  Saving model ...
Epoch: 6 cost time: 0.8064277172088623
Epoch: 6, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
Validation loss decreased (-0.778116 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 0.7756807804107666
Epoch: 7, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 0.7451341152191162
Epoch: 8, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.7932157516479492
Epoch: 9, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.7892308235168457
Epoch: 10, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.8365232944488525
Epoch: 11, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.9134678840637207
Epoch: 12, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9544551372528076
Epoch: 13, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8330652713775635
Epoch: 14, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8855395317077637
Epoch: 15, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9192838668823242
Epoch: 16, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7972750663757324
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9162454605102539
Epoch: 18, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9470198154449463
Epoch: 19, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.902393102645874
Epoch: 20, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.982201337814331
Epoch: 21, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.573 Vali Acc: 0.847 Test Loss: 0.573 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 58968
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.370391607284546
Epoch: 1, Steps: 8 | Train Loss: 2.271 Vali Loss: 2.146 Vali Acc: 0.131 Test Loss: 2.146 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.9311783313751221
Epoch: 2, Steps: 8 | Train Loss: 2.208 Vali Loss: 2.023 Vali Acc: 0.266 Test Loss: 2.023 Test Acc: 0.266
Validation loss decreased (-0.131229 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 0.8706977367401123
Epoch: 3, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.849 Vali Acc: 0.375 Test Loss: 1.849 Test Acc: 0.375
Validation loss decreased (-0.265605 --> -0.374982).  Saving model ...
Epoch: 4 cost time: 0.8002109527587891
Epoch: 4, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.644 Vali Acc: 0.522 Test Loss: 1.644 Test Acc: 0.522
Validation loss decreased (-0.374982 --> -0.521859).  Saving model ...
Epoch: 5 cost time: 1.0259373188018799
Epoch: 5, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.422 Vali Acc: 0.634 Test Loss: 1.422 Test Acc: 0.634
Validation loss decreased (-0.521859 --> -0.634361).  Saving model ...
Epoch: 6 cost time: 0.9401326179504395
Epoch: 6, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.186 Vali Acc: 0.709 Test Loss: 1.186 Test Acc: 0.709
Validation loss decreased (-0.634361 --> -0.709363).  Saving model ...
Epoch: 7 cost time: 0.8053617477416992
Epoch: 7, Steps: 8 | Train Loss: 1.085 Vali Loss: 0.964 Vali Acc: 0.759 Test Loss: 0.964 Test Acc: 0.759
Validation loss decreased (-0.709363 --> -0.759365).  Saving model ...
Epoch: 8 cost time: 0.912261962890625
Epoch: 8, Steps: 8 | Train Loss: 0.886 Vali Loss: 0.799 Vali Acc: 0.803 Test Loss: 0.799 Test Acc: 0.803
Validation loss decreased (-0.759365 --> -0.803117).  Saving model ...
Epoch: 9 cost time: 0.9216079711914062
Epoch: 9, Steps: 8 | Train Loss: 0.704 Vali Loss: 0.690 Vali Acc: 0.816 Test Loss: 0.690 Test Acc: 0.816
Validation loss decreased (-0.803117 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 0.9222016334533691
Epoch: 10, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.632 Vali Acc: 0.816 Test Loss: 0.632 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.9656493663787842
Epoch: 11, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8835210800170898
Epoch: 12, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7814269065856934
Epoch: 13, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 14 cost time: 0.8172109127044678
Epoch: 14, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 1.0477983951568604
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.9318408966064453
Epoch: 16, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.8150861263275146
Epoch: 17, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 0.9720785617828369
Epoch: 18, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 1.0087637901306152
Epoch: 19, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8808226585388184
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8610365390777588
Epoch: 21, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9532878398895264
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9646103382110596
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9586727619171143
Epoch: 24, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9547722339630127
Epoch: 25, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 26 cost time: 0.8220751285552979
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.540 Vali Acc: 0.853 Test Loss: 0.540 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9567503929138184
Epoch: 27, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7753193378448486
Epoch: 28, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8376984596252441
Epoch: 29, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7338817119598389
Epoch: 30, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7627487182617188
Epoch: 31, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7985093593597412
Epoch: 32, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7519412040710449
Epoch: 33, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7915163040161133
Epoch: 34, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8234133720397949
Epoch: 35, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 44120
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.485089063644409
Epoch: 1, Steps: 8 | Train Loss: 2.237 Vali Loss: 2.170 Vali Acc: 0.062 Test Loss: 2.170 Test Acc: 0.062
Validation loss decreased (inf --> -0.062478).  Saving model ...
Epoch: 2 cost time: 0.9402332305908203
Epoch: 2, Steps: 8 | Train Loss: 2.091 Vali Loss: 2.053 Vali Acc: 0.087 Test Loss: 2.053 Test Acc: 0.087
Validation loss decreased (-0.062478 --> -0.087479).  Saving model ...
Epoch: 3 cost time: 0.8036987781524658
Epoch: 3, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.895 Vali Acc: 0.231 Test Loss: 1.895 Test Acc: 0.231
Validation loss decreased (-0.087479 --> -0.231231).  Saving model ...
Epoch: 4 cost time: 0.8421730995178223
Epoch: 4, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.715 Vali Acc: 0.453 Test Loss: 1.715 Test Acc: 0.453
Validation loss decreased (-0.231231 --> -0.453108).  Saving model ...
Epoch: 5 cost time: 0.7651970386505127
Epoch: 5, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.524 Vali Acc: 0.569 Test Loss: 1.524 Test Acc: 0.569
Validation loss decreased (-0.453108 --> -0.568735).  Saving model ...
Epoch: 6 cost time: 0.8842296600341797
Epoch: 6, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.336 Vali Acc: 0.653 Test Loss: 1.336 Test Acc: 0.653
Validation loss decreased (-0.568735 --> -0.653112).  Saving model ...
Epoch: 7 cost time: 0.7615396976470947
Epoch: 7, Steps: 8 | Train Loss: 1.382 Vali Loss: 1.162 Vali Acc: 0.734 Test Loss: 1.162 Test Acc: 0.734
Validation loss decreased (-0.653112 --> -0.734363).  Saving model ...
Epoch: 8 cost time: 0.834742546081543
Epoch: 8, Steps: 8 | Train Loss: 1.096 Vali Loss: 1.006 Vali Acc: 0.784 Test Loss: 1.006 Test Acc: 0.784
Validation loss decreased (-0.734363 --> -0.784365).  Saving model ...
Epoch: 9 cost time: 0.8423128128051758
Epoch: 9, Steps: 8 | Train Loss: 0.956 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
Validation loss decreased (-0.784365 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.8585247993469238
Epoch: 10, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.769 Vali Acc: 0.809 Test Loss: 0.769 Test Acc: 0.809
Validation loss decreased (-0.799991 --> -0.809367).  Saving model ...
Epoch: 11 cost time: 0.8046379089355469
Epoch: 11, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
Validation loss decreased (-0.809367 --> -0.815618).  Saving model ...
Epoch: 12 cost time: 0.8626527786254883
Epoch: 12, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.8933460712432861
Epoch: 13, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.8220133781433105
Epoch: 14, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.573 Vali Acc: 0.831 Test Loss: 0.573 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 0.7361629009246826
Epoch: 15, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.8795897960662842
Epoch: 16, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 0.8052899837493896
Epoch: 17, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7676475048065186
Epoch: 18, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7700855731964111
Epoch: 19, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7212839126586914
Epoch: 20, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6949827671051025
Epoch: 21, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.752694845199585
Epoch: 22, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6605844497680664
Epoch: 23, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7928731441497803
Epoch: 24, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7331619262695312
Epoch: 25, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 0.835336446762085
Epoch: 26, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8771789073944092
Epoch: 27, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7568175792694092
Epoch: 28, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8369846343994141
Epoch: 29, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8314411640167236
Epoch: 30, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 31 cost time: 0.7699527740478516
Epoch: 31, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7698962688446045
Epoch: 32, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9416782855987549
Epoch: 33, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7485654354095459
Epoch: 34, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.797269344329834
Epoch: 35, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8397393226623535
Epoch: 36, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8329737186431885
Epoch: 37, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.839318037033081
Epoch: 38, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7361724376678467
Epoch: 39, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 40 cost time: 0.7887518405914307
Epoch: 40, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8511712551116943
Epoch: 41, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7961122989654541
Epoch: 42, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7477378845214844
Epoch: 43, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8363301753997803
Epoch: 44, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8126776218414307
Epoch: 45, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.759394645690918
Epoch: 46, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.774010181427002
Epoch: 47, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7737371921539307
Epoch: 48, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7371461391448975
Epoch: 49, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 39256
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.118989944458008
Epoch: 1, Steps: 8 | Train Loss: 2.230 Vali Loss: 2.129 Vali Acc: 0.216 Test Loss: 2.129 Test Acc: 0.216
Validation loss decreased (inf --> -0.215604).  Saving model ...
Epoch: 2 cost time: 0.8518476486206055
Epoch: 2, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.028 Vali Acc: 0.250 Test Loss: 2.028 Test Acc: 0.250
Validation loss decreased (-0.215604 --> -0.249980).  Saving model ...
Epoch: 3 cost time: 0.8692874908447266
Epoch: 3, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.899 Vali Acc: 0.322 Test Loss: 1.899 Test Acc: 0.322
Validation loss decreased (-0.249980 --> -0.321856).  Saving model ...
Epoch: 4 cost time: 0.8297297954559326
Epoch: 4, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.746 Vali Acc: 0.434 Test Loss: 1.746 Test Acc: 0.434
Validation loss decreased (-0.321856 --> -0.434358).  Saving model ...
Epoch: 5 cost time: 0.7539880275726318
Epoch: 5, Steps: 8 | Train Loss: 1.812 Vali Loss: 1.586 Vali Acc: 0.519 Test Loss: 1.586 Test Acc: 0.519
Validation loss decreased (-0.434358 --> -0.518734).  Saving model ...
Epoch: 6 cost time: 0.8547887802124023
Epoch: 6, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.418 Vali Acc: 0.594 Test Loss: 1.418 Test Acc: 0.594
Validation loss decreased (-0.518734 --> -0.593736).  Saving model ...
Epoch: 7 cost time: 0.796473503112793
Epoch: 7, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.252 Vali Acc: 0.662 Test Loss: 1.252 Test Acc: 0.662
Validation loss decreased (-0.593736 --> -0.662487).  Saving model ...
Epoch: 8 cost time: 0.7600843906402588
Epoch: 8, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.098 Vali Acc: 0.725 Test Loss: 1.098 Test Acc: 0.725
Validation loss decreased (-0.662487 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.8153538703918457
Epoch: 9, Steps: 8 | Train Loss: 1.067 Vali Loss: 0.965 Vali Acc: 0.747 Test Loss: 0.965 Test Acc: 0.747
Validation loss decreased (-0.724989 --> -0.746865).  Saving model ...
Epoch: 10 cost time: 0.7647936344146729
Epoch: 10, Steps: 8 | Train Loss: 0.874 Vali Loss: 0.860 Vali Acc: 0.766 Test Loss: 0.860 Test Acc: 0.766
Validation loss decreased (-0.746865 --> -0.765616).  Saving model ...
Epoch: 11 cost time: 0.770766019821167
Epoch: 11, Steps: 8 | Train Loss: 0.809 Vali Loss: 0.777 Vali Acc: 0.781 Test Loss: 0.777 Test Acc: 0.781
Validation loss decreased (-0.765616 --> -0.781242).  Saving model ...
Epoch: 12 cost time: 0.817042350769043
Epoch: 12, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.715 Vali Acc: 0.791 Test Loss: 0.715 Test Acc: 0.791
Validation loss decreased (-0.781242 --> -0.790618).  Saving model ...
Epoch: 13 cost time: 0.7783379554748535
Epoch: 13, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.666 Vali Acc: 0.806 Test Loss: 0.666 Test Acc: 0.806
Validation loss decreased (-0.790618 --> -0.806243).  Saving model ...
Epoch: 14 cost time: 0.7591633796691895
Epoch: 14, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812494).  Saving model ...
Epoch: 15 cost time: 0.8980109691619873
Epoch: 15, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 16 cost time: 0.8610401153564453
Epoch: 16, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.772897481918335
Epoch: 17, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.564 Vali Acc: 0.812 Test Loss: 0.564 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 18 cost time: 0.8874797821044922
Epoch: 18, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 19 cost time: 0.7791836261749268
Epoch: 19, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821870).  Saving model ...
Epoch: 20 cost time: 0.7487554550170898
Epoch: 20, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8281300067901611
Epoch: 21, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 22 cost time: 0.7975659370422363
Epoch: 22, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 23 cost time: 0.7003202438354492
Epoch: 23, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8369472026824951
Epoch: 24, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 25 cost time: 0.8188502788543701
Epoch: 25, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 26 cost time: 0.7403030395507812
Epoch: 26, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.515 Vali Acc: 0.825 Test Loss: 0.515 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.779470682144165
Epoch: 27, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 28 cost time: 0.7223026752471924
Epoch: 28, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7227060794830322
Epoch: 29, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7525241374969482
Epoch: 30, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 31 cost time: 0.7800681591033936
Epoch: 31, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 32 cost time: 0.7929625511169434
Epoch: 32, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.814483642578125
Epoch: 33, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 34 cost time: 0.8453445434570312
Epoch: 34, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8092777729034424
Epoch: 35, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.504 Vali Acc: 0.825 Test Loss: 0.504 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7768583297729492
Epoch: 36, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8858578205108643
Epoch: 37, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7991538047790527
Epoch: 38, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 39 cost time: 0.7894883155822754
Epoch: 39, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 40 cost time: 0.8082363605499268
Epoch: 40, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7790334224700928
Epoch: 41, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.770758867263794
Epoch: 42, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7455747127532959
Epoch: 43, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7696712017059326
Epoch: 44, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7947311401367188
Epoch: 45, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7783257961273193
Epoch: 46, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8513298034667969
Epoch: 47, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8067128658294678
Epoch: 48, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7910611629486084
Epoch: 49, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 36696
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.190929889678955
Epoch: 1, Steps: 8 | Train Loss: 2.077 Vali Loss: 1.962 Vali Acc: 0.225 Test Loss: 1.962 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 0.7638325691223145
Epoch: 2, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.889 Vali Acc: 0.256 Test Loss: 1.889 Test Acc: 0.256
Validation loss decreased (-0.224980 --> -0.256231).  Saving model ...
Epoch: 3 cost time: 0.8088579177856445
Epoch: 3, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.790 Vali Acc: 0.359 Test Loss: 1.790 Test Acc: 0.359
Validation loss decreased (-0.256231 --> -0.359357).  Saving model ...
Epoch: 4 cost time: 0.7732119560241699
Epoch: 4, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.682 Vali Acc: 0.466 Test Loss: 1.682 Test Acc: 0.466
Validation loss decreased (-0.359357 --> -0.465608).  Saving model ...
Epoch: 5 cost time: 0.74165940284729
Epoch: 5, Steps: 8 | Train Loss: 1.700 Vali Loss: 1.569 Vali Acc: 0.547 Test Loss: 1.569 Test Acc: 0.547
Validation loss decreased (-0.465608 --> -0.546859).  Saving model ...
Epoch: 6 cost time: 0.7939872741699219
Epoch: 6, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.454 Vali Acc: 0.606 Test Loss: 1.454 Test Acc: 0.606
Validation loss decreased (-0.546859 --> -0.606235).  Saving model ...
Epoch: 7 cost time: 0.7968845367431641
Epoch: 7, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.346 Vali Acc: 0.644 Test Loss: 1.346 Test Acc: 0.644
Validation loss decreased (-0.606235 --> -0.643737).  Saving model ...
Epoch: 8 cost time: 0.7822179794311523
Epoch: 8, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.233 Vali Acc: 0.709 Test Loss: 1.233 Test Acc: 0.709
Validation loss decreased (-0.643737 --> -0.709363).  Saving model ...
Epoch: 9 cost time: 0.7900307178497314
Epoch: 9, Steps: 8 | Train Loss: 1.216 Vali Loss: 1.122 Vali Acc: 0.759 Test Loss: 1.122 Test Acc: 0.759
Validation loss decreased (-0.709363 --> -0.759364).  Saving model ...
Epoch: 10 cost time: 0.7626557350158691
Epoch: 10, Steps: 8 | Train Loss: 1.075 Vali Loss: 1.021 Vali Acc: 0.766 Test Loss: 1.021 Test Acc: 0.766
Validation loss decreased (-0.759364 --> -0.765615).  Saving model ...
Epoch: 11 cost time: 0.8271994590759277
Epoch: 11, Steps: 8 | Train Loss: 1.004 Vali Loss: 0.935 Vali Acc: 0.775 Test Loss: 0.935 Test Acc: 0.775
Validation loss decreased (-0.765615 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.8420736789703369
Epoch: 12, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.858 Vali Acc: 0.791 Test Loss: 0.858 Test Acc: 0.791
Validation loss decreased (-0.774991 --> -0.790616).  Saving model ...
Epoch: 13 cost time: 0.8693068027496338
Epoch: 13, Steps: 8 | Train Loss: 0.787 Vali Loss: 0.791 Vali Acc: 0.787 Test Loss: 0.791 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7910881042480469
Epoch: 14, Steps: 8 | Train Loss: 0.697 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.790616 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 0.8273694515228271
Epoch: 15, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803118).  Saving model ...
Epoch: 16 cost time: 0.8933770656585693
Epoch: 16, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.669 Vali Acc: 0.803 Test Loss: 0.669 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803118).  Saving model ...
Epoch: 17 cost time: 0.8134074211120605
Epoch: 17, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 18 cost time: 0.8302001953125
Epoch: 18, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818744).  Saving model ...
Epoch: 19 cost time: 0.7583081722259521
Epoch: 19, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.886847972869873
Epoch: 20, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8390438556671143
Epoch: 21, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7565035820007324
Epoch: 22, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.843315601348877
Epoch: 23, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8384087085723877
Epoch: 24, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7917053699493408
Epoch: 25, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7101278305053711
Epoch: 26, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7974677085876465
Epoch: 27, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7651352882385254
Epoch: 28, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 34648
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2739834785461426
Epoch: 1, Steps: 8 | Train Loss: 2.200 Vali Loss: 2.173 Vali Acc: 0.094 Test Loss: 2.173 Test Acc: 0.094
Validation loss decreased (inf --> -0.093728).  Saving model ...
Epoch: 2 cost time: 0.7535648345947266
Epoch: 2, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.087 Vali Acc: 0.122 Test Loss: 2.087 Test Acc: 0.122
Validation loss decreased (-0.093728 --> -0.121854).  Saving model ...
Epoch: 3 cost time: 0.753570556640625
Epoch: 3, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.986 Vali Acc: 0.175 Test Loss: 1.986 Test Acc: 0.175
Validation loss decreased (-0.121854 --> -0.174980).  Saving model ...
Epoch: 4 cost time: 0.739098072052002
Epoch: 4, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.877 Vali Acc: 0.297 Test Loss: 1.877 Test Acc: 0.297
Validation loss decreased (-0.174980 --> -0.296856).  Saving model ...
Epoch: 5 cost time: 0.8357384204864502
Epoch: 5, Steps: 8 | Train Loss: 1.850 Vali Loss: 1.764 Vali Acc: 0.378 Test Loss: 1.764 Test Acc: 0.378
Validation loss decreased (-0.296856 --> -0.378107).  Saving model ...
Epoch: 6 cost time: 0.7510554790496826
Epoch: 6, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.654 Vali Acc: 0.494 Test Loss: 1.654 Test Acc: 0.494
Validation loss decreased (-0.378107 --> -0.493733).  Saving model ...
Epoch: 7 cost time: 0.74411940574646
Epoch: 7, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.543 Vali Acc: 0.559 Test Loss: 1.543 Test Acc: 0.559
Validation loss decreased (-0.493733 --> -0.559360).  Saving model ...
Epoch: 8 cost time: 0.7950892448425293
Epoch: 8, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.431 Vali Acc: 0.622 Test Loss: 1.431 Test Acc: 0.622
Validation loss decreased (-0.559360 --> -0.621861).  Saving model ...
Epoch: 9 cost time: 0.8421058654785156
Epoch: 9, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.322 Vali Acc: 0.647 Test Loss: 1.322 Test Acc: 0.647
Validation loss decreased (-0.621861 --> -0.646862).  Saving model ...
Epoch: 10 cost time: 0.872044563293457
Epoch: 10, Steps: 8 | Train Loss: 1.314 Vali Loss: 1.220 Vali Acc: 0.672 Test Loss: 1.220 Test Acc: 0.672
Validation loss decreased (-0.646862 --> -0.671863).  Saving model ...
Epoch: 11 cost time: 0.7524499893188477
Epoch: 11, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.123 Vali Acc: 0.709 Test Loss: 1.123 Test Acc: 0.709
Validation loss decreased (-0.671863 --> -0.709364).  Saving model ...
Epoch: 12 cost time: 0.7324929237365723
Epoch: 12, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.040 Vali Acc: 0.728 Test Loss: 1.040 Test Acc: 0.728
Validation loss decreased (-0.709364 --> -0.728115).  Saving model ...
Epoch: 13 cost time: 0.7994599342346191
Epoch: 13, Steps: 8 | Train Loss: 1.024 Vali Loss: 0.963 Vali Acc: 0.753 Test Loss: 0.963 Test Acc: 0.753
Validation loss decreased (-0.728115 --> -0.753115).  Saving model ...
Epoch: 14 cost time: 0.7166109085083008
Epoch: 14, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.897 Vali Acc: 0.769 Test Loss: 0.897 Test Acc: 0.769
Validation loss decreased (-0.753115 --> -0.768741).  Saving model ...
Epoch: 15 cost time: 0.7671000957489014
Epoch: 15, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.842 Vali Acc: 0.797 Test Loss: 0.842 Test Acc: 0.797
Validation loss decreased (-0.768741 --> -0.796867).  Saving model ...
Epoch: 16 cost time: 0.7978763580322266
Epoch: 16, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.796867 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.8378152847290039
Epoch: 17, Steps: 8 | Train Loss: 0.699 Vali Loss: 0.756 Vali Acc: 0.797 Test Loss: 0.756 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7980735301971436
Epoch: 18, Steps: 8 | Train Loss: 0.689 Vali Loss: 0.720 Vali Acc: 0.797 Test Loss: 0.720 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7359392642974854
Epoch: 19, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.697 Vali Acc: 0.791 Test Loss: 0.697 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7859876155853271
Epoch: 20, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.677 Vali Acc: 0.791 Test Loss: 0.677 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7712109088897705
Epoch: 21, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.661 Vali Acc: 0.794 Test Loss: 0.661 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7950336933135986
Epoch: 22, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
Validation loss decreased (-0.799992 --> -0.803119).  Saving model ...
Epoch: 23 cost time: 0.7907199859619141
Epoch: 23, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.627 Vali Acc: 0.806 Test Loss: 0.627 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 24 cost time: 0.799067497253418
Epoch: 24, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818744).  Saving model ...
Epoch: 25 cost time: 0.7267487049102783
Epoch: 25, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 0.877500057220459
Epoch: 26, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 0.8659529685974121
Epoch: 27, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 0.75107741355896
Epoch: 28, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8451704978942871
Epoch: 29, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9339981079101562
Epoch: 30, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 31 cost time: 0.9066214561462402
Epoch: 31, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 32 cost time: 0.8773398399353027
Epoch: 32, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 33 cost time: 0.7474226951599121
Epoch: 33, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 34 cost time: 0.7716789245605469
Epoch: 34, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 35 cost time: 0.8522346019744873
Epoch: 35, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8999450206756592
Epoch: 36, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.965369462966919
Epoch: 37, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 38 cost time: 0.9227001667022705
Epoch: 38, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 39 cost time: 0.908088207244873
Epoch: 39, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8636784553527832
Epoch: 40, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8742218017578125
Epoch: 41, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8628201484680176
Epoch: 42, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9483897686004639
Epoch: 43, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9508354663848877
Epoch: 44, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8530664443969727
Epoch: 45, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8823051452636719
Epoch: 46, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9023885726928711
Epoch: 47, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9442780017852783
Epoch: 48, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 33352
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2753114700317383
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.018 Vali Acc: 0.178 Test Loss: 2.018 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.7039124965667725
Epoch: 2, Steps: 8 | Train Loss: 2.102 Vali Loss: 1.958 Vali Acc: 0.181 Test Loss: 1.958 Test Acc: 0.181
Validation loss decreased (-0.178105 --> -0.181230).  Saving model ...
Epoch: 3 cost time: 0.8327212333679199
Epoch: 3, Steps: 8 | Train Loss: 2.070 Vali Loss: 1.876 Vali Acc: 0.203 Test Loss: 1.876 Test Acc: 0.203
Validation loss decreased (-0.181230 --> -0.203106).  Saving model ...
Epoch: 4 cost time: 0.8435986042022705
Epoch: 4, Steps: 8 | Train Loss: 1.935 Vali Loss: 1.781 Vali Acc: 0.281 Test Loss: 1.781 Test Acc: 0.281
Validation loss decreased (-0.203106 --> -0.281232).  Saving model ...
Epoch: 5 cost time: 0.7655105590820312
Epoch: 5, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.685 Vali Acc: 0.388 Test Loss: 1.685 Test Acc: 0.388
Validation loss decreased (-0.281232 --> -0.387483).  Saving model ...
Epoch: 6 cost time: 0.7016582489013672
Epoch: 6, Steps: 8 | Train Loss: 1.731 Vali Loss: 1.588 Vali Acc: 0.475 Test Loss: 1.588 Test Acc: 0.475
Validation loss decreased (-0.387483 --> -0.474984).  Saving model ...
Epoch: 7 cost time: 0.7780165672302246
Epoch: 7, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.492 Vali Acc: 0.559 Test Loss: 1.492 Test Acc: 0.559
Validation loss decreased (-0.474984 --> -0.559360).  Saving model ...
Epoch: 8 cost time: 0.733076810836792
Epoch: 8, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.402 Vali Acc: 0.588 Test Loss: 1.402 Test Acc: 0.588
Validation loss decreased (-0.559360 --> -0.587486).  Saving model ...
Epoch: 9 cost time: 0.7176046371459961
Epoch: 9, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.313 Vali Acc: 0.647 Test Loss: 1.313 Test Acc: 0.647
Validation loss decreased (-0.587486 --> -0.646862).  Saving model ...
Epoch: 10 cost time: 0.734534502029419
Epoch: 10, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.227 Vali Acc: 0.672 Test Loss: 1.227 Test Acc: 0.672
Validation loss decreased (-0.646862 --> -0.671863).  Saving model ...
Epoch: 11 cost time: 0.7184872627258301
Epoch: 11, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.142 Vali Acc: 0.694 Test Loss: 1.142 Test Acc: 0.694
Validation loss decreased (-0.671863 --> -0.693739).  Saving model ...
Epoch: 12 cost time: 0.6974196434020996
Epoch: 12, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.064 Vali Acc: 0.703 Test Loss: 1.064 Test Acc: 0.703
Validation loss decreased (-0.693739 --> -0.703114).  Saving model ...
Epoch: 13 cost time: 0.7306463718414307
Epoch: 13, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.999 Vali Acc: 0.731 Test Loss: 0.999 Test Acc: 0.731
Validation loss decreased (-0.703114 --> -0.731240).  Saving model ...
Epoch: 14 cost time: 0.7898025512695312
Epoch: 14, Steps: 8 | Train Loss: 1.011 Vali Loss: 0.939 Vali Acc: 0.741 Test Loss: 0.939 Test Acc: 0.741
Validation loss decreased (-0.731240 --> -0.740616).  Saving model ...
Epoch: 15 cost time: 0.7825624942779541
Epoch: 15, Steps: 8 | Train Loss: 0.909 Vali Loss: 0.880 Vali Acc: 0.766 Test Loss: 0.880 Test Acc: 0.766
Validation loss decreased (-0.740616 --> -0.765616).  Saving model ...
Epoch: 16 cost time: 0.8185157775878906
Epoch: 16, Steps: 8 | Train Loss: 0.841 Vali Loss: 0.837 Vali Acc: 0.772 Test Loss: 0.837 Test Acc: 0.772
Validation loss decreased (-0.765616 --> -0.771867).  Saving model ...
Epoch: 17 cost time: 0.8776037693023682
Epoch: 17, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.800 Vali Acc: 0.772 Test Loss: 0.800 Test Acc: 0.772
Validation loss decreased (-0.771867 --> -0.771867).  Saving model ...
Epoch: 18 cost time: 0.7401134967803955
Epoch: 18, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.762 Vali Acc: 0.778 Test Loss: 0.762 Test Acc: 0.778
Validation loss decreased (-0.771867 --> -0.778117).  Saving model ...
Epoch: 19 cost time: 0.7377195358276367
Epoch: 19, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
Validation loss decreased (-0.778117 --> -0.778118).  Saving model ...
Epoch: 20 cost time: 0.8694615364074707
Epoch: 20, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.709 Vali Acc: 0.781 Test Loss: 0.709 Test Acc: 0.781
Validation loss decreased (-0.778118 --> -0.781243).  Saving model ...
Epoch: 21 cost time: 0.7119483947753906
Epoch: 21, Steps: 8 | Train Loss: 0.626 Vali Loss: 0.687 Vali Acc: 0.787 Test Loss: 0.687 Test Acc: 0.787
Validation loss decreased (-0.781243 --> -0.787493).  Saving model ...
Epoch: 22 cost time: 0.7640750408172607
Epoch: 22, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.666 Vali Acc: 0.787 Test Loss: 0.666 Test Acc: 0.787
Validation loss decreased (-0.787493 --> -0.787493).  Saving model ...
Epoch: 23 cost time: 0.8624012470245361
Epoch: 23, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.648 Vali Acc: 0.794 Test Loss: 0.648 Test Acc: 0.794
Validation loss decreased (-0.787493 --> -0.793744).  Saving model ...
Epoch: 24 cost time: 0.8354637622833252
Epoch: 24, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.631 Vali Acc: 0.794 Test Loss: 0.631 Test Acc: 0.794
Validation loss decreased (-0.793744 --> -0.793744).  Saving model ...
Epoch: 25 cost time: 0.7391130924224854
Epoch: 25, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
Validation loss decreased (-0.793744 --> -0.803119).  Saving model ...
Epoch: 26 cost time: 0.807964563369751
Epoch: 26, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 27 cost time: 0.7705259323120117
Epoch: 27, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.591 Vali Acc: 0.800 Test Loss: 0.591 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8025298118591309
Epoch: 28, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.582 Vali Acc: 0.806 Test Loss: 0.582 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 29 cost time: 0.7345411777496338
Epoch: 29, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 30 cost time: 0.7266106605529785
Epoch: 30, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 31 cost time: 0.7499651908874512
Epoch: 31, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 32 cost time: 0.6836545467376709
Epoch: 32, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828120).  Saving model ...
Epoch: 33 cost time: 0.7607128620147705
Epoch: 33, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 34 cost time: 0.6839025020599365
Epoch: 34, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 35 cost time: 0.7914578914642334
Epoch: 35, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8994717597961426
Epoch: 36, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 37 cost time: 0.857459545135498
Epoch: 37, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 38 cost time: 0.763291597366333
Epoch: 38, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8651342391967773
Epoch: 39, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7850501537322998
Epoch: 40, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8048210144042969
Epoch: 41, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 42 cost time: 0.8056988716125488
Epoch: 42, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7913110256195068
Epoch: 43, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7672750949859619
Epoch: 44, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 0.7233033180236816
Epoch: 45, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8040225505828857
Epoch: 46, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8624513149261475
Epoch: 47, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.813542366027832
Epoch: 48, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7526352405548096
Epoch: 49, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8501436710357666
Epoch: 50, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 51 cost time: 0.7711920738220215
Epoch: 51, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.791142463684082
Epoch: 52, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7546672821044922
Epoch: 53, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8621222972869873
Epoch: 54, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 55 cost time: 0.7326664924621582
Epoch: 55, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7674281597137451
Epoch: 56, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8461055755615234
Epoch: 57, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8285822868347168
Epoch: 58, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7846238613128662
Epoch: 59, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8302862644195557
Epoch: 60, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.779454231262207
Epoch: 61, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.7250216007232666
Epoch: 62, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8099305629730225
Epoch: 63, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7936115264892578
Epoch: 64, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 65 cost time: 0.7841238975524902
Epoch: 65, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7313728332519531
Epoch: 66, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7422072887420654
Epoch: 67, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8335182666778564
Epoch: 68, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.8511371612548828
Epoch: 69, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8488373756408691
Epoch: 70, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.7512500286102295
Epoch: 71, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.7984733581542969
Epoch: 72, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.8573310375213623
Epoch: 73, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.795053243637085
Epoch: 74, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 32840
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.250293254852295
Epoch: 1, Steps: 8 | Train Loss: 2.207 Vali Loss: 2.085 Vali Acc: 0.241 Test Loss: 2.085 Test Acc: 0.241
Validation loss decreased (inf --> -0.240604).  Saving model ...
Epoch: 2 cost time: 0.9833574295043945
Epoch: 2, Steps: 8 | Train Loss: 2.032 Vali Loss: 1.829 Vali Acc: 0.353 Test Loss: 1.829 Test Acc: 0.353
Validation loss decreased (-0.240604 --> -0.353107).  Saving model ...
Epoch: 3 cost time: 0.761660099029541
Epoch: 3, Steps: 8 | Train Loss: 1.751 Vali Loss: 1.504 Vali Acc: 0.619 Test Loss: 1.504 Test Acc: 0.619
Validation loss decreased (-0.353107 --> -0.618735).  Saving model ...
Epoch: 4 cost time: 0.8326296806335449
Epoch: 4, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.174 Vali Acc: 0.738 Test Loss: 1.174 Test Acc: 0.738
Validation loss decreased (-0.618735 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.7616469860076904
Epoch: 5, Steps: 8 | Train Loss: 1.083 Vali Loss: 0.897 Vali Acc: 0.794 Test Loss: 0.897 Test Acc: 0.794
Validation loss decreased (-0.737488 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 0.7496378421783447
Epoch: 6, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
Validation loss decreased (-0.793741 --> -0.806243).  Saving model ...
Epoch: 7 cost time: 0.7189199924468994
Epoch: 7, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
Validation loss decreased (-0.806243 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 0.7944366931915283
Epoch: 8, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.9664654731750488
Epoch: 9, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.7541916370391846
Epoch: 10, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.7718520164489746
Epoch: 11, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7250556945800781
Epoch: 12, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7726011276245117
Epoch: 13, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.8776206970214844
Epoch: 14, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8451001644134521
Epoch: 15, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8032684326171875
Epoch: 16, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.776216983795166
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8484542369842529
Epoch: 18, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8165509700775146
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8015139102935791
Epoch: 20, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8631632328033447
Epoch: 21, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8618512153625488
Epoch: 22, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7937123775482178
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 46296
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3307254314422607
Epoch: 1, Steps: 8 | Train Loss: 2.511 Vali Loss: 2.244 Vali Acc: 0.097 Test Loss: 2.244 Test Acc: 0.097
Validation loss decreased (inf --> -0.096853).  Saving model ...
Epoch: 2 cost time: 0.7525787353515625
Epoch: 2, Steps: 8 | Train Loss: 2.251 Vali Loss: 2.087 Vali Acc: 0.141 Test Loss: 2.087 Test Acc: 0.141
Validation loss decreased (-0.096853 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 0.8232266902923584
Epoch: 3, Steps: 8 | Train Loss: 2.028 Vali Loss: 1.867 Vali Acc: 0.266 Test Loss: 1.867 Test Acc: 0.266
Validation loss decreased (-0.140604 --> -0.265606).  Saving model ...
Epoch: 4 cost time: 0.7203257083892822
Epoch: 4, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.630 Vali Acc: 0.537 Test Loss: 1.630 Test Acc: 0.537
Validation loss decreased (-0.265606 --> -0.537484).  Saving model ...
Epoch: 5 cost time: 0.8071870803833008
Epoch: 5, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.375 Vali Acc: 0.703 Test Loss: 1.375 Test Acc: 0.703
Validation loss decreased (-0.537484 --> -0.703111).  Saving model ...
Epoch: 6 cost time: 0.7471795082092285
Epoch: 6, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.141 Vali Acc: 0.747 Test Loss: 1.141 Test Acc: 0.747
Validation loss decreased (-0.703111 --> -0.746864).  Saving model ...
Epoch: 7 cost time: 0.6869518756866455
Epoch: 7, Steps: 8 | Train Loss: 1.090 Vali Loss: 0.949 Vali Acc: 0.778 Test Loss: 0.949 Test Acc: 0.778
Validation loss decreased (-0.746864 --> -0.778116).  Saving model ...
Epoch: 8 cost time: 0.7467312812805176
Epoch: 8, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.809 Vali Acc: 0.778 Test Loss: 0.809 Test Acc: 0.778
Validation loss decreased (-0.778116 --> -0.778117).  Saving model ...
Epoch: 9 cost time: 0.7514522075653076
Epoch: 9, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.711 Vali Acc: 0.787 Test Loss: 0.711 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787493).  Saving model ...
Epoch: 10 cost time: 0.7771785259246826
Epoch: 10, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
Validation loss decreased (-0.787493 --> -0.803119).  Saving model ...
Epoch: 11 cost time: 0.8472692966461182
Epoch: 11, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 12 cost time: 0.7663083076477051
Epoch: 12, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 13 cost time: 0.7545802593231201
Epoch: 13, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.812494 --> -0.824995).  Saving model ...
Epoch: 14 cost time: 0.7468180656433105
Epoch: 14, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 15 cost time: 0.755671501159668
Epoch: 15, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7457385063171387
Epoch: 16, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 17 cost time: 0.7729396820068359
Epoch: 17, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8258144855499268
Epoch: 18, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7901086807250977
Epoch: 19, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.793304443359375
Epoch: 20, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7436220645904541
Epoch: 21, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8790085315704346
Epoch: 22, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 0.7445027828216553
Epoch: 23, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.7355005741119385
Epoch: 24, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7256588935852051
Epoch: 25, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7471373081207275
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8216409683227539
Epoch: 27, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7777118682861328
Epoch: 28, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8530881404876709
Epoch: 29, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.562 Vali Acc: 0.853 Test Loss: 0.562 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 30 cost time: 0.7861151695251465
Epoch: 30, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9174046516418457
Epoch: 31, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.566 Vali Acc: 0.847 Test Loss: 0.566 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8587698936462402
Epoch: 32, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7672598361968994
Epoch: 33, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.571 Vali Acc: 0.847 Test Loss: 0.571 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8188381195068359
Epoch: 34, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8444452285766602
Epoch: 35, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8110356330871582
Epoch: 36, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8045387268066406
Epoch: 37, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7155253887176514
Epoch: 38, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8173725605010986
Epoch: 39, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.572 Vali Acc: 0.853 Test Loss: 0.572 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 31448
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3232884407043457
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 1.990 Vali Acc: 0.178 Test Loss: 1.990 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.8275322914123535
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.892 Vali Acc: 0.281 Test Loss: 1.892 Test Acc: 0.281
Validation loss decreased (-0.178105 --> -0.281231).  Saving model ...
Epoch: 3 cost time: 0.7909154891967773
Epoch: 3, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.760 Vali Acc: 0.450 Test Loss: 1.760 Test Acc: 0.450
Validation loss decreased (-0.281231 --> -0.449982).  Saving model ...
Epoch: 4 cost time: 0.8790988922119141
Epoch: 4, Steps: 8 | Train Loss: 1.733 Vali Loss: 1.604 Vali Acc: 0.597 Test Loss: 1.604 Test Acc: 0.597
Validation loss decreased (-0.449982 --> -0.596859).  Saving model ...
Epoch: 5 cost time: 0.7767598628997803
Epoch: 5, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.435 Vali Acc: 0.697 Test Loss: 1.435 Test Acc: 0.697
Validation loss decreased (-0.596859 --> -0.696861).  Saving model ...
Epoch: 6 cost time: 0.8398182392120361
Epoch: 6, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.265 Vali Acc: 0.753 Test Loss: 1.265 Test Acc: 0.753
Validation loss decreased (-0.696861 --> -0.753112).  Saving model ...
Epoch: 7 cost time: 0.8202619552612305
Epoch: 7, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.106 Vali Acc: 0.772 Test Loss: 1.106 Test Acc: 0.772
Validation loss decreased (-0.753112 --> -0.771864).  Saving model ...
Epoch: 8 cost time: 0.717266321182251
Epoch: 8, Steps: 8 | Train Loss: 1.117 Vali Loss: 0.962 Vali Acc: 0.787 Test Loss: 0.962 Test Acc: 0.787
Validation loss decreased (-0.771864 --> -0.787490).  Saving model ...
Epoch: 9 cost time: 0.7846114635467529
Epoch: 9, Steps: 8 | Train Loss: 0.958 Vali Loss: 0.837 Vali Acc: 0.797 Test Loss: 0.837 Test Acc: 0.797
Validation loss decreased (-0.787490 --> -0.796867).  Saving model ...
Epoch: 10 cost time: 0.7535514831542969
Epoch: 10, Steps: 8 | Train Loss: 0.799 Vali Loss: 0.736 Vali Acc: 0.797 Test Loss: 0.736 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 11 cost time: 0.8344414234161377
Epoch: 11, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.8983595371246338
Epoch: 12, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 13 cost time: 0.8070943355560303
Epoch: 13, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
Validation loss decreased (-0.803119 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.8307945728302002
Epoch: 14, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 0.8171699047088623
Epoch: 15, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 0.8922281265258789
Epoch: 16, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7285671234130859
Epoch: 17, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 0.8536701202392578
Epoch: 18, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.9002587795257568
Epoch: 19, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8751745223999023
Epoch: 20, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8316998481750488
Epoch: 21, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.80413818359375
Epoch: 22, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.8107428550720215
Epoch: 23, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.479 Vali Acc: 0.853 Test Loss: 0.479 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 24 cost time: 0.818183422088623
Epoch: 24, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 25 cost time: 0.8588306903839111
Epoch: 25, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.846764326095581
Epoch: 26, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8468213081359863
Epoch: 27, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8009705543518066
Epoch: 28, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8175983428955078
Epoch: 29, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 30 cost time: 0.7997589111328125
Epoch: 30, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8332364559173584
Epoch: 31, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8102016448974609
Epoch: 32, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7665059566497803
Epoch: 33, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8291542530059814
Epoch: 34, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.490 Vali Acc: 0.859 Test Loss: 0.490 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8174951076507568
Epoch: 35, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9146585464477539
Epoch: 36, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8120143413543701
Epoch: 37, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7519598007202148
Epoch: 38, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.853 Test Loss: 0.500 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7753844261169434
Epoch: 39, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 26584
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3033506870269775
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 2.074 Vali Acc: 0.156 Test Loss: 2.074 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.8218417167663574
Epoch: 2, Steps: 8 | Train Loss: 2.045 Vali Loss: 1.987 Vali Acc: 0.206 Test Loss: 1.987 Test Acc: 0.206
Validation loss decreased (-0.156229 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 0.7954449653625488
Epoch: 3, Steps: 8 | Train Loss: 1.878 Vali Loss: 1.865 Vali Acc: 0.297 Test Loss: 1.865 Test Acc: 0.297
Validation loss decreased (-0.206230 --> -0.296856).  Saving model ...
Epoch: 4 cost time: 0.8502957820892334
Epoch: 4, Steps: 8 | Train Loss: 1.785 Vali Loss: 1.718 Vali Acc: 0.422 Test Loss: 1.718 Test Acc: 0.422
Validation loss decreased (-0.296856 --> -0.421858).  Saving model ...
Epoch: 5 cost time: 0.7925996780395508
Epoch: 5, Steps: 8 | Train Loss: 1.635 Vali Loss: 1.563 Vali Acc: 0.512 Test Loss: 1.563 Test Acc: 0.512
Validation loss decreased (-0.421858 --> -0.512484).  Saving model ...
Epoch: 6 cost time: 0.843055248260498
Epoch: 6, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.408 Vali Acc: 0.584 Test Loss: 1.408 Test Acc: 0.584
Validation loss decreased (-0.512484 --> -0.584361).  Saving model ...
Epoch: 7 cost time: 0.8624765872955322
Epoch: 7, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.260 Vali Acc: 0.656 Test Loss: 1.260 Test Acc: 0.656
Validation loss decreased (-0.584361 --> -0.656237).  Saving model ...
Epoch: 8 cost time: 0.7846875190734863
Epoch: 8, Steps: 8 | Train Loss: 1.189 Vali Loss: 1.119 Vali Acc: 0.713 Test Loss: 1.119 Test Acc: 0.713
Validation loss decreased (-0.656237 --> -0.712489).  Saving model ...
Epoch: 9 cost time: 0.7676105499267578
Epoch: 9, Steps: 8 | Train Loss: 1.028 Vali Loss: 0.994 Vali Acc: 0.750 Test Loss: 0.994 Test Acc: 0.750
Validation loss decreased (-0.712489 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.7979624271392822
Epoch: 10, Steps: 8 | Train Loss: 0.909 Vali Loss: 0.888 Vali Acc: 0.772 Test Loss: 0.888 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.771866).  Saving model ...
Epoch: 11 cost time: 0.9310357570648193
Epoch: 11, Steps: 8 | Train Loss: 0.764 Vali Loss: 0.802 Vali Acc: 0.784 Test Loss: 0.802 Test Acc: 0.784
Validation loss decreased (-0.771866 --> -0.784367).  Saving model ...
Epoch: 12 cost time: 0.8588685989379883
Epoch: 12, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.737 Vali Acc: 0.787 Test Loss: 0.737 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 13 cost time: 0.8102390766143799
Epoch: 13, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.684 Vali Acc: 0.797 Test Loss: 0.684 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796868).  Saving model ...
Epoch: 14 cost time: 0.8730659484863281
Epoch: 14, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 15 cost time: 0.7580282688140869
Epoch: 15, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 16 cost time: 0.837648868560791
Epoch: 16, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 17 cost time: 0.8315615653991699
Epoch: 17, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 18 cost time: 0.7564048767089844
Epoch: 18, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.562 Vali Acc: 0.834 Test Loss: 0.562 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 19 cost time: 0.7837517261505127
Epoch: 19, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 20 cost time: 0.8591408729553223
Epoch: 20, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 21 cost time: 0.829540491104126
Epoch: 21, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 22 cost time: 0.7802176475524902
Epoch: 22, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8069334030151367
Epoch: 23, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 24 cost time: 0.8320517539978027
Epoch: 24, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8212432861328125
Epoch: 25, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8425121307373047
Epoch: 26, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8118398189544678
Epoch: 27, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 28 cost time: 0.8515262603759766
Epoch: 28, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 29 cost time: 0.8625211715698242
Epoch: 29, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8609378337860107
Epoch: 30, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 31 cost time: 0.8198864459991455
Epoch: 31, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8444976806640625
Epoch: 32, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 33 cost time: 0.8846702575683594
Epoch: 33, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8762266635894775
Epoch: 34, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.864065408706665
Epoch: 35, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8753371238708496
Epoch: 36, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7684717178344727
Epoch: 37, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8389055728912354
Epoch: 38, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.780684232711792
Epoch: 39, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8765871524810791
Epoch: 40, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.832463264465332
Epoch: 41, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8444023132324219
Epoch: 42, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 24024
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.27578067779541
Epoch: 1, Steps: 8 | Train Loss: 2.300 Vali Loss: 2.197 Vali Acc: 0.178 Test Loss: 2.197 Test Acc: 0.178
Validation loss decreased (inf --> -0.178103).  Saving model ...
Epoch: 2 cost time: 0.799774169921875
Epoch: 2, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.122 Vali Acc: 0.209 Test Loss: 2.122 Test Acc: 0.209
Validation loss decreased (-0.178103 --> -0.209354).  Saving model ...
Epoch: 3 cost time: 0.9013729095458984
Epoch: 3, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.024 Vali Acc: 0.228 Test Loss: 2.024 Test Acc: 0.228
Validation loss decreased (-0.209354 --> -0.228105).  Saving model ...
Epoch: 4 cost time: 0.8344893455505371
Epoch: 4, Steps: 8 | Train Loss: 2.056 Vali Loss: 1.907 Vali Acc: 0.291 Test Loss: 1.907 Test Acc: 0.291
Validation loss decreased (-0.228105 --> -0.290606).  Saving model ...
Epoch: 5 cost time: 0.8903989791870117
Epoch: 5, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.778 Vali Acc: 0.381 Test Loss: 1.778 Test Acc: 0.381
Validation loss decreased (-0.290606 --> -0.381232).  Saving model ...
Epoch: 6 cost time: 0.7680759429931641
Epoch: 6, Steps: 8 | Train Loss: 1.749 Vali Loss: 1.645 Vali Acc: 0.478 Test Loss: 1.645 Test Acc: 0.478
Validation loss decreased (-0.381232 --> -0.478109).  Saving model ...
Epoch: 7 cost time: 0.721207857131958
Epoch: 7, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.509 Vali Acc: 0.575 Test Loss: 1.509 Test Acc: 0.575
Validation loss decreased (-0.478109 --> -0.574985).  Saving model ...
Epoch: 8 cost time: 0.8403723239898682
Epoch: 8, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.376 Vali Acc: 0.634 Test Loss: 1.376 Test Acc: 0.634
Validation loss decreased (-0.574985 --> -0.634361).  Saving model ...
Epoch: 9 cost time: 0.752061128616333
Epoch: 9, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.250 Vali Acc: 0.669 Test Loss: 1.250 Test Acc: 0.669
Validation loss decreased (-0.634361 --> -0.668737).  Saving model ...
Epoch: 10 cost time: 0.7901027202606201
Epoch: 10, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.134 Vali Acc: 0.706 Test Loss: 1.134 Test Acc: 0.706
Validation loss decreased (-0.668737 --> -0.706239).  Saving model ...
Epoch: 11 cost time: 1.0300161838531494
Epoch: 11, Steps: 8 | Train Loss: 1.057 Vali Loss: 1.028 Vali Acc: 0.744 Test Loss: 1.028 Test Acc: 0.744
Validation loss decreased (-0.706239 --> -0.743740).  Saving model ...
Epoch: 12 cost time: 0.8946411609649658
Epoch: 12, Steps: 8 | Train Loss: 1.000 Vali Loss: 0.934 Vali Acc: 0.766 Test Loss: 0.934 Test Acc: 0.766
Validation loss decreased (-0.743740 --> -0.765616).  Saving model ...
Epoch: 13 cost time: 0.8585789203643799
Epoch: 13, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.859 Vali Acc: 0.772 Test Loss: 0.859 Test Acc: 0.772
Validation loss decreased (-0.765616 --> -0.771866).  Saving model ...
Epoch: 14 cost time: 0.8920707702636719
Epoch: 14, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.793 Vali Acc: 0.784 Test Loss: 0.793 Test Acc: 0.784
Validation loss decreased (-0.771866 --> -0.784367).  Saving model ...
Epoch: 15 cost time: 0.8512046337127686
Epoch: 15, Steps: 8 | Train Loss: 0.703 Vali Loss: 0.742 Vali Acc: 0.787 Test Loss: 0.742 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 16 cost time: 0.843841552734375
Epoch: 16, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.696 Vali Acc: 0.797 Test Loss: 0.696 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796868).  Saving model ...
Epoch: 17 cost time: 0.8666772842407227
Epoch: 17, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.8221132755279541
Epoch: 18, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 19 cost time: 0.7974209785461426
Epoch: 19, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.830486536026001
Epoch: 20, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 21 cost time: 0.8521430492401123
Epoch: 21, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 22 cost time: 0.8412775993347168
Epoch: 22, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 23 cost time: 0.9091322422027588
Epoch: 23, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.920722484588623
Epoch: 24, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 25 cost time: 0.8702385425567627
Epoch: 25, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8796725273132324
Epoch: 26, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8573029041290283
Epoch: 27, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7810111045837402
Epoch: 28, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8290040493011475
Epoch: 29, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 30 cost time: 0.8657655715942383
Epoch: 30, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 31 cost time: 0.8675954341888428
Epoch: 31, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8368353843688965
Epoch: 32, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8389978408813477
Epoch: 33, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 34 cost time: 0.9737529754638672
Epoch: 34, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8837699890136719
Epoch: 35, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.856250524520874
Epoch: 36, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 37 cost time: 0.8873710632324219
Epoch: 37, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 38 cost time: 0.8609330654144287
Epoch: 38, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8819506168365479
Epoch: 39, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 40 cost time: 0.8903806209564209
Epoch: 40, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9445896148681641
Epoch: 41, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9922232627868652
Epoch: 42, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0413830280303955
Epoch: 43, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0193984508514404
Epoch: 44, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8759369850158691
Epoch: 45, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0741565227508545
Epoch: 46, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9117555618286133
Epoch: 47, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9398863315582275
Epoch: 48, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9340965747833252
Epoch: 49, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 21976
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4795095920562744
Epoch: 1, Steps: 8 | Train Loss: 2.243 Vali Loss: 2.193 Vali Acc: 0.125 Test Loss: 2.193 Test Acc: 0.125
Validation loss decreased (inf --> -0.124978).  Saving model ...
Epoch: 2 cost time: 0.9627547264099121
Epoch: 2, Steps: 8 | Train Loss: 2.278 Vali Loss: 2.146 Vali Acc: 0.175 Test Loss: 2.146 Test Acc: 0.175
Validation loss decreased (-0.124978 --> -0.174979).  Saving model ...
Epoch: 3 cost time: 0.962515115737915
Epoch: 3, Steps: 8 | Train Loss: 2.153 Vali Loss: 2.069 Vali Acc: 0.228 Test Loss: 2.069 Test Acc: 0.228
Validation loss decreased (-0.174979 --> -0.228104).  Saving model ...
Epoch: 4 cost time: 0.8198888301849365
Epoch: 4, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.972 Vali Acc: 0.266 Test Loss: 1.972 Test Acc: 0.266
Validation loss decreased (-0.228104 --> -0.265605).  Saving model ...
Epoch: 5 cost time: 0.9514071941375732
Epoch: 5, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.865 Vali Acc: 0.334 Test Loss: 1.865 Test Acc: 0.334
Validation loss decreased (-0.265605 --> -0.334356).  Saving model ...
Epoch: 6 cost time: 0.9191389083862305
Epoch: 6, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.754 Vali Acc: 0.419 Test Loss: 1.754 Test Acc: 0.419
Validation loss decreased (-0.334356 --> -0.418732).  Saving model ...
Epoch: 7 cost time: 0.9129843711853027
Epoch: 7, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.638 Vali Acc: 0.506 Test Loss: 1.638 Test Acc: 0.506
Validation loss decreased (-0.418732 --> -0.506234).  Saving model ...
Epoch: 8 cost time: 1.0284790992736816
Epoch: 8, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.519 Vali Acc: 0.569 Test Loss: 1.519 Test Acc: 0.569
Validation loss decreased (-0.506234 --> -0.568735).  Saving model ...
Epoch: 9 cost time: 0.7619166374206543
Epoch: 9, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.402 Vali Acc: 0.628 Test Loss: 1.402 Test Acc: 0.628
Validation loss decreased (-0.568735 --> -0.628111).  Saving model ...
Epoch: 10 cost time: 0.7964398860931396
Epoch: 10, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.288 Vali Acc: 0.656 Test Loss: 1.288 Test Acc: 0.656
Validation loss decreased (-0.628111 --> -0.656237).  Saving model ...
Epoch: 11 cost time: 0.9230799674987793
Epoch: 11, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.180 Vali Acc: 0.688 Test Loss: 1.180 Test Acc: 0.688
Validation loss decreased (-0.656237 --> -0.687488).  Saving model ...
Epoch: 12 cost time: 1.0460186004638672
Epoch: 12, Steps: 8 | Train Loss: 1.160 Vali Loss: 1.082 Vali Acc: 0.716 Test Loss: 1.082 Test Acc: 0.716
Validation loss decreased (-0.687488 --> -0.715614).  Saving model ...
Epoch: 13 cost time: 0.9845235347747803
Epoch: 13, Steps: 8 | Train Loss: 1.080 Vali Loss: 1.000 Vali Acc: 0.741 Test Loss: 1.000 Test Acc: 0.741
Validation loss decreased (-0.715614 --> -0.740615).  Saving model ...
Epoch: 14 cost time: 0.9503264427185059
Epoch: 14, Steps: 8 | Train Loss: 1.018 Vali Loss: 0.927 Vali Acc: 0.756 Test Loss: 0.927 Test Acc: 0.756
Validation loss decreased (-0.740615 --> -0.756241).  Saving model ...
Epoch: 15 cost time: 0.8704392910003662
Epoch: 15, Steps: 8 | Train Loss: 0.873 Vali Loss: 0.860 Vali Acc: 0.759 Test Loss: 0.860 Test Acc: 0.759
Validation loss decreased (-0.756241 --> -0.759366).  Saving model ...
Epoch: 16 cost time: 0.9800035953521729
Epoch: 16, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.808 Vali Acc: 0.762 Test Loss: 0.808 Test Acc: 0.762
Validation loss decreased (-0.759366 --> -0.762492).  Saving model ...
Epoch: 17 cost time: 0.8038568496704102
Epoch: 17, Steps: 8 | Train Loss: 0.729 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.762492 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 0.8454785346984863
Epoch: 18, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.726 Vali Acc: 0.784 Test Loss: 0.726 Test Acc: 0.784
Validation loss decreased (-0.774992 --> -0.784368).  Saving model ...
Epoch: 19 cost time: 0.9164152145385742
Epoch: 19, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.698 Vali Acc: 0.787 Test Loss: 0.698 Test Acc: 0.787
Validation loss decreased (-0.784368 --> -0.787493).  Saving model ...
Epoch: 20 cost time: 0.8844494819641113
Epoch: 20, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.672 Vali Acc: 0.787 Test Loss: 0.672 Test Acc: 0.787
Validation loss decreased (-0.787493 --> -0.787493).  Saving model ...
Epoch: 21 cost time: 0.9109501838684082
Epoch: 21, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.651 Vali Acc: 0.787 Test Loss: 0.651 Test Acc: 0.787
Validation loss decreased (-0.787493 --> -0.787493).  Saving model ...
Epoch: 22 cost time: 0.9198782444000244
Epoch: 22, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.632 Vali Acc: 0.797 Test Loss: 0.632 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796869).  Saving model ...
Epoch: 23 cost time: 0.799018383026123
Epoch: 23, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.615 Vali Acc: 0.806 Test Loss: 0.615 Test Acc: 0.806
Validation loss decreased (-0.796869 --> -0.806244).  Saving model ...
Epoch: 24 cost time: 0.9212391376495361
Epoch: 24, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 25 cost time: 0.7652621269226074
Epoch: 25, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 26 cost time: 0.7720541954040527
Epoch: 26, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9633398056030273
Epoch: 27, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 28 cost time: 0.9346439838409424
Epoch: 28, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 29 cost time: 0.9390335083007812
Epoch: 29, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 30 cost time: 1.0092155933380127
Epoch: 30, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 31 cost time: 0.9438738822937012
Epoch: 31, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821870).  Saving model ...
Epoch: 32 cost time: 1.0539593696594238
Epoch: 32, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 33 cost time: 0.9364025592803955
Epoch: 33, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8531942367553711
Epoch: 34, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 35 cost time: 0.9207308292388916
Epoch: 35, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 36 cost time: 1.1035676002502441
Epoch: 36, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9903295040130615
Epoch: 37, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9235672950744629
Epoch: 38, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9494376182556152
Epoch: 39, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8910629749298096
Epoch: 40, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1206564903259277
Epoch: 41, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.511 Vali Acc: 0.819 Test Loss: 0.511 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9557321071624756
Epoch: 42, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 43 cost time: 0.9294657707214355
Epoch: 43, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 44 cost time: 0.9927618503570557
Epoch: 44, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9114079475402832
Epoch: 45, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9870898723602295
Epoch: 46, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 47 cost time: 1.0052597522735596
Epoch: 47, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.484 Vali Acc: 0.834 Test Loss: 0.484 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 48 cost time: 0.8433797359466553
Epoch: 48, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 49 cost time: 0.953317403793335
Epoch: 49, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 50 cost time: 0.7678549289703369
Epoch: 50, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9152562618255615
Epoch: 51, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9302966594696045
Epoch: 52, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7836868762969971
Epoch: 53, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8541018962860107
Epoch: 54, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.787752628326416
Epoch: 55, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.487 Vali Acc: 0.828 Test Loss: 0.487 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8474123477935791
Epoch: 56, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.484 Vali Acc: 0.834 Test Loss: 0.484 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.8782892227172852
Epoch: 57, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 58 cost time: 0.6628539562225342
Epoch: 58, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9182813167572021
Epoch: 59, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8177170753479004
Epoch: 60, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.488 Vali Acc: 0.831 Test Loss: 0.488 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9030003547668457
Epoch: 61, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8033010959625244
Epoch: 62, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.486 Vali Acc: 0.831 Test Loss: 0.486 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0103731155395508
Epoch: 63, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8119521141052246
Epoch: 64, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9162321090698242
Epoch: 65, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.777785062789917
Epoch: 66, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.490 Vali Acc: 0.834 Test Loss: 0.490 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.9390065670013428
Epoch: 67, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.490 Vali Acc: 0.834 Test Loss: 0.490 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 20680
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4076664447784424
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.119 Vali Acc: 0.138 Test Loss: 2.119 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.8514773845672607
Epoch: 2, Steps: 8 | Train Loss: 2.095 Vali Loss: 2.038 Vali Acc: 0.172 Test Loss: 2.038 Test Acc: 0.172
Validation loss decreased (-0.137479 --> -0.171855).  Saving model ...
Epoch: 3 cost time: 0.9073202610015869
Epoch: 3, Steps: 8 | Train Loss: 2.089 Vali Loss: 1.946 Vali Acc: 0.234 Test Loss: 1.946 Test Acc: 0.234
Validation loss decreased (-0.171855 --> -0.234356).  Saving model ...
Epoch: 4 cost time: 0.8562018871307373
Epoch: 4, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.844 Vali Acc: 0.334 Test Loss: 1.844 Test Acc: 0.334
Validation loss decreased (-0.234356 --> -0.334357).  Saving model ...
Epoch: 5 cost time: 0.8576650619506836
Epoch: 5, Steps: 8 | Train Loss: 1.859 Vali Loss: 1.738 Vali Acc: 0.428 Test Loss: 1.738 Test Acc: 0.428
Validation loss decreased (-0.334357 --> -0.428108).  Saving model ...
Epoch: 6 cost time: 0.7877187728881836
Epoch: 6, Steps: 8 | Train Loss: 1.828 Vali Loss: 1.635 Vali Acc: 0.525 Test Loss: 1.635 Test Acc: 0.525
Validation loss decreased (-0.428108 --> -0.524984).  Saving model ...
Epoch: 7 cost time: 0.8803703784942627
Epoch: 7, Steps: 8 | Train Loss: 1.624 Vali Loss: 1.534 Vali Acc: 0.581 Test Loss: 1.534 Test Acc: 0.581
Validation loss decreased (-0.524984 --> -0.581235).  Saving model ...
Epoch: 8 cost time: 0.8962819576263428
Epoch: 8, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.439 Vali Acc: 0.613 Test Loss: 1.439 Test Acc: 0.613
Validation loss decreased (-0.581235 --> -0.612486).  Saving model ...
Epoch: 9 cost time: 0.9311211109161377
Epoch: 9, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.346 Vali Acc: 0.644 Test Loss: 1.346 Test Acc: 0.644
Validation loss decreased (-0.612486 --> -0.643737).  Saving model ...
Epoch: 10 cost time: 0.8245995044708252
Epoch: 10, Steps: 8 | Train Loss: 1.316 Vali Loss: 1.265 Vali Acc: 0.678 Test Loss: 1.265 Test Acc: 0.678
Validation loss decreased (-0.643737 --> -0.678112).  Saving model ...
Epoch: 11 cost time: 0.8756086826324463
Epoch: 11, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.184 Vali Acc: 0.694 Test Loss: 1.184 Test Acc: 0.694
Validation loss decreased (-0.678112 --> -0.693738).  Saving model ...
Epoch: 12 cost time: 0.7495453357696533
Epoch: 12, Steps: 8 | Train Loss: 1.156 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
Validation loss decreased (-0.693738 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.8661551475524902
Epoch: 13, Steps: 8 | Train Loss: 1.105 Vali Loss: 1.037 Vali Acc: 0.725 Test Loss: 1.037 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.7803559303283691
Epoch: 14, Steps: 8 | Train Loss: 1.039 Vali Loss: 0.983 Vali Acc: 0.747 Test Loss: 0.983 Test Acc: 0.747
Validation loss decreased (-0.724990 --> -0.746865).  Saving model ...
Epoch: 15 cost time: 0.8877267837524414
Epoch: 15, Steps: 8 | Train Loss: 0.993 Vali Loss: 0.930 Vali Acc: 0.756 Test Loss: 0.930 Test Acc: 0.756
Validation loss decreased (-0.746865 --> -0.756241).  Saving model ...
Epoch: 16 cost time: 0.7415685653686523
Epoch: 16, Steps: 8 | Train Loss: 0.899 Vali Loss: 0.878 Vali Acc: 0.766 Test Loss: 0.878 Test Acc: 0.766
Validation loss decreased (-0.756241 --> -0.765616).  Saving model ...
Epoch: 17 cost time: 0.7125635147094727
Epoch: 17, Steps: 8 | Train Loss: 0.868 Vali Loss: 0.830 Vali Acc: 0.769 Test Loss: 0.830 Test Acc: 0.769
Validation loss decreased (-0.765616 --> -0.768742).  Saving model ...
Epoch: 18 cost time: 0.7576756477355957
Epoch: 18, Steps: 8 | Train Loss: 0.801 Vali Loss: 0.793 Vali Acc: 0.778 Test Loss: 0.793 Test Acc: 0.778
Validation loss decreased (-0.768742 --> -0.778117).  Saving model ...
Epoch: 19 cost time: 0.7825644016265869
Epoch: 19, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.764 Vali Acc: 0.787 Test Loss: 0.764 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787492).  Saving model ...
Epoch: 20 cost time: 0.7323973178863525
Epoch: 20, Steps: 8 | Train Loss: 0.680 Vali Loss: 0.737 Vali Acc: 0.787 Test Loss: 0.737 Test Acc: 0.787
Validation loss decreased (-0.787492 --> -0.787493).  Saving model ...
Epoch: 21 cost time: 0.7732868194580078
Epoch: 21, Steps: 8 | Train Loss: 0.657 Vali Loss: 0.713 Vali Acc: 0.791 Test Loss: 0.713 Test Acc: 0.791
Validation loss decreased (-0.787493 --> -0.790618).  Saving model ...
Epoch: 22 cost time: 0.7160167694091797
Epoch: 22, Steps: 8 | Train Loss: 0.623 Vali Loss: 0.693 Vali Acc: 0.797 Test Loss: 0.693 Test Acc: 0.797
Validation loss decreased (-0.790618 --> -0.796868).  Saving model ...
Epoch: 23 cost time: 0.7649145126342773
Epoch: 23, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.669 Vali Acc: 0.803 Test Loss: 0.669 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803118).  Saving model ...
Epoch: 24 cost time: 0.8049595355987549
Epoch: 24, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 25 cost time: 0.7972187995910645
Epoch: 25, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.634 Vali Acc: 0.816 Test Loss: 0.634 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 26 cost time: 0.8538734912872314
Epoch: 26, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 27 cost time: 0.8485534191131592
Epoch: 27, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 28 cost time: 0.7365052700042725
Epoch: 28, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.594 Vali Acc: 0.831 Test Loss: 0.594 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 29 cost time: 0.8255941867828369
Epoch: 29, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.585 Vali Acc: 0.834 Test Loss: 0.585 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 30 cost time: 0.9313042163848877
Epoch: 30, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.577 Vali Acc: 0.834 Test Loss: 0.577 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 31 cost time: 0.7549052238464355
Epoch: 31, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.863471508026123
Epoch: 32, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9387855529785156
Epoch: 33, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.794497013092041
Epoch: 34, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 35 cost time: 0.8307039737701416
Epoch: 35, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 36 cost time: 0.8306074142456055
Epoch: 36, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 37 cost time: 0.8291025161743164
Epoch: 37, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 38 cost time: 0.9173202514648438
Epoch: 38, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 39 cost time: 0.8949615955352783
Epoch: 39, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 40 cost time: 0.8215146064758301
Epoch: 40, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 41 cost time: 0.9028723239898682
Epoch: 41, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8119714260101318
Epoch: 42, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.819979190826416
Epoch: 43, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8304860591888428
Epoch: 44, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 45 cost time: 0.8547360897064209
Epoch: 45, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 46 cost time: 0.835700273513794
Epoch: 46, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8941969871520996
Epoch: 47, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8173294067382812
Epoch: 48, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7928555011749268
Epoch: 49, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9270079135894775
Epoch: 50, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 51 cost time: 0.7901968955993652
Epoch: 51, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 52 cost time: 0.893425464630127
Epoch: 52, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7718772888183594
Epoch: 53, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7552475929260254
Epoch: 54, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7751681804656982
Epoch: 55, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 56 cost time: 0.7481794357299805
Epoch: 56, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.449 Vali Acc: 0.869 Test Loss: 0.449 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868746).  Saving model ...
Epoch: 57 cost time: 0.7758023738861084
Epoch: 57, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7736990451812744
Epoch: 58, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8020157814025879
Epoch: 59, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.449 Vali Acc: 0.866 Test Loss: 0.449 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7145581245422363
Epoch: 60, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.446 Vali Acc: 0.866 Test Loss: 0.446 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.800349235534668
Epoch: 61, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.866 Test Loss: 0.451 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.7124249935150146
Epoch: 62, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871871).  Saving model ...
Epoch: 63 cost time: 0.9311013221740723
Epoch: 63, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 64 cost time: 0.7205502986907959
Epoch: 64, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.443 Vali Acc: 0.872 Test Loss: 0.443 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7607159614562988
Epoch: 65, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9034764766693115
Epoch: 66, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 67 cost time: 0.7983391284942627
Epoch: 67, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.448 Vali Acc: 0.869 Test Loss: 0.448 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8921403884887695
Epoch: 68, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.455 Vali Acc: 0.863 Test Loss: 0.455 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8639380931854248
Epoch: 69, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7751367092132568
Epoch: 70, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.459 Vali Acc: 0.863 Test Loss: 0.459 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8500332832336426
Epoch: 71, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.451 Vali Acc: 0.869 Test Loss: 0.451 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.9676928520202637
Epoch: 72, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8638942241668701
Epoch: 73, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.456 Vali Acc: 0.869 Test Loss: 0.456 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.8711144924163818
Epoch: 74, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.463 Vali Acc: 0.866 Test Loss: 0.463 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.9600038528442383
Epoch: 75, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.462 Vali Acc: 0.866 Test Loss: 0.462 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.8495264053344727
Epoch: 76, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 20168
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3537991046905518
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 1.935 Vali Acc: 0.278 Test Loss: 1.935 Test Acc: 0.278
Validation loss decreased (inf --> -0.278106).  Saving model ...
Epoch: 2 cost time: 0.9361593723297119
Epoch: 2, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.655 Vali Acc: 0.509 Test Loss: 1.655 Test Acc: 0.509
Validation loss decreased (-0.278106 --> -0.509358).  Saving model ...
Epoch: 3 cost time: 0.979027509689331
Epoch: 3, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.333 Vali Acc: 0.656 Test Loss: 1.333 Test Acc: 0.656
Validation loss decreased (-0.509358 --> -0.656237).  Saving model ...
Epoch: 4 cost time: 0.9666664600372314
Epoch: 4, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.032 Vali Acc: 0.794 Test Loss: 1.032 Test Acc: 0.794
Validation loss decreased (-0.656237 --> -0.793740).  Saving model ...
Epoch: 5 cost time: 0.8927059173583984
Epoch: 5, Steps: 8 | Train Loss: 0.999 Vali Loss: 0.804 Vali Acc: 0.819 Test Loss: 0.804 Test Acc: 0.819
Validation loss decreased (-0.793740 --> -0.818742).  Saving model ...
Epoch: 6 cost time: 0.8236258029937744
Epoch: 6, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
Validation loss decreased (-0.818742 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.9184179306030273
Epoch: 7, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.8395204544067383
Epoch: 8, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 0.7272202968597412
Epoch: 9, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 10 cost time: 0.807703971862793
Epoch: 10, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.676245927810669
Epoch: 11, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
Validation loss decreased (-0.840620 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 0.8433382511138916
Epoch: 12, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7637617588043213
Epoch: 13, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7902414798736572
Epoch: 14, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7993123531341553
Epoch: 15, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7522134780883789
Epoch: 16, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7585859298706055
Epoch: 17, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8405687808990479
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7461795806884766
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8199825286865234
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.811866044998169
Epoch: 21, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 39960
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3125853538513184
Epoch: 1, Steps: 8 | Train Loss: 2.308 Vali Loss: 2.229 Vali Acc: 0.144 Test Loss: 2.229 Test Acc: 0.144
Validation loss decreased (inf --> -0.143728).  Saving model ...
Epoch: 2 cost time: 0.7891807556152344
Epoch: 2, Steps: 8 | Train Loss: 2.232 Vali Loss: 2.063 Vali Acc: 0.200 Test Loss: 2.063 Test Acc: 0.200
Validation loss decreased (-0.143728 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 0.7747802734375
Epoch: 3, Steps: 8 | Train Loss: 2.032 Vali Loss: 1.852 Vali Acc: 0.306 Test Loss: 1.852 Test Acc: 0.306
Validation loss decreased (-0.199979 --> -0.306231).  Saving model ...
Epoch: 4 cost time: 0.7503035068511963
Epoch: 4, Steps: 8 | Train Loss: 1.864 Vali Loss: 1.609 Vali Acc: 0.544 Test Loss: 1.609 Test Acc: 0.544
Validation loss decreased (-0.306231 --> -0.543734).  Saving model ...
Epoch: 5 cost time: 0.7901022434234619
Epoch: 5, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.368 Vali Acc: 0.662 Test Loss: 1.368 Test Acc: 0.662
Validation loss decreased (-0.543734 --> -0.662486).  Saving model ...
Epoch: 6 cost time: 0.792447566986084
Epoch: 6, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.141 Vali Acc: 0.744 Test Loss: 1.141 Test Acc: 0.744
Validation loss decreased (-0.662486 --> -0.743739).  Saving model ...
Epoch: 7 cost time: 0.818634033203125
Epoch: 7, Steps: 8 | Train Loss: 1.147 Vali Loss: 0.955 Vali Acc: 0.778 Test Loss: 0.955 Test Acc: 0.778
Validation loss decreased (-0.743739 --> -0.778115).  Saving model ...
Epoch: 8 cost time: 0.8641936779022217
Epoch: 8, Steps: 8 | Train Loss: 0.907 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
Validation loss decreased (-0.778115 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 0.7582082748413086
Epoch: 9, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.700 Vali Acc: 0.816 Test Loss: 0.700 Test Acc: 0.816
Validation loss decreased (-0.799992 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 0.7804577350616455
Epoch: 10, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.8653922080993652
Epoch: 11, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8220000267028809
Epoch: 12, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821870).  Saving model ...
Epoch: 13 cost time: 0.8309097290039062
Epoch: 13, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 14 cost time: 0.7954943180084229
Epoch: 14, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.824995 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.8409154415130615
Epoch: 15, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.7916924953460693
Epoch: 16, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 0.7278482913970947
Epoch: 17, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7597782611846924
Epoch: 18, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7727062702178955
Epoch: 19, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6546859741210938
Epoch: 20, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7971320152282715
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.789273738861084
Epoch: 22, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8383567333221436
Epoch: 23, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7884871959686279
Epoch: 24, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8698852062225342
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8984982967376709
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 25112
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2487189769744873
Epoch: 1, Steps: 8 | Train Loss: 2.207 Vali Loss: 2.140 Vali Acc: 0.141 Test Loss: 2.140 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 0.8742537498474121
Epoch: 2, Steps: 8 | Train Loss: 2.170 Vali Loss: 2.046 Vali Acc: 0.159 Test Loss: 2.046 Test Acc: 0.159
Validation loss decreased (-0.140604 --> -0.159355).  Saving model ...
Epoch: 3 cost time: 0.7520437240600586
Epoch: 3, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.910 Vali Acc: 0.278 Test Loss: 1.910 Test Acc: 0.278
Validation loss decreased (-0.159355 --> -0.278106).  Saving model ...
Epoch: 4 cost time: 0.7038912773132324
Epoch: 4, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.757 Vali Acc: 0.463 Test Loss: 1.757 Test Acc: 0.463
Validation loss decreased (-0.278106 --> -0.462482).  Saving model ...
Epoch: 5 cost time: 0.7956907749176025
Epoch: 5, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.597 Vali Acc: 0.594 Test Loss: 1.597 Test Acc: 0.594
Validation loss decreased (-0.462482 --> -0.593734).  Saving model ...
Epoch: 6 cost time: 0.8345682621002197
Epoch: 6, Steps: 8 | Train Loss: 1.548 Vali Loss: 1.423 Vali Acc: 0.700 Test Loss: 1.423 Test Acc: 0.700
Validation loss decreased (-0.593734 --> -0.699986).  Saving model ...
Epoch: 7 cost time: 0.870445728302002
Epoch: 7, Steps: 8 | Train Loss: 1.481 Vali Loss: 1.258 Vali Acc: 0.728 Test Loss: 1.258 Test Acc: 0.728
Validation loss decreased (-0.699986 --> -0.728112).  Saving model ...
Epoch: 8 cost time: 0.798558235168457
Epoch: 8, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.102 Vali Acc: 0.759 Test Loss: 1.102 Test Acc: 0.759
Validation loss decreased (-0.728112 --> -0.759364).  Saving model ...
Epoch: 9 cost time: 0.8497805595397949
Epoch: 9, Steps: 8 | Train Loss: 1.102 Vali Loss: 0.959 Vali Acc: 0.781 Test Loss: 0.959 Test Acc: 0.781
Validation loss decreased (-0.759364 --> -0.781240).  Saving model ...
Epoch: 10 cost time: 0.76682448387146
Epoch: 10, Steps: 8 | Train Loss: 0.928 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.781240 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.7769775390625
Epoch: 11, Steps: 8 | Train Loss: 0.818 Vali Loss: 0.758 Vali Acc: 0.806 Test Loss: 0.758 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.806242).  Saving model ...
Epoch: 12 cost time: 0.7767298221588135
Epoch: 12, Steps: 8 | Train Loss: 0.725 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
Validation loss decreased (-0.806242 --> -0.806243).  Saving model ...
Epoch: 13 cost time: 0.831249475479126
Epoch: 13, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.648 Vali Acc: 0.806 Test Loss: 0.648 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 14 cost time: 0.8275716304779053
Epoch: 14, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.614 Vali Acc: 0.812 Test Loss: 0.614 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 15 cost time: 0.7673516273498535
Epoch: 15, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 16 cost time: 0.8230631351470947
Epoch: 16, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8050520420074463
Epoch: 17, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 0.7494463920593262
Epoch: 18, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7542493343353271
Epoch: 19, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 0.817922830581665
Epoch: 20, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9245705604553223
Epoch: 21, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8455746173858643
Epoch: 22, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 23 cost time: 0.8098635673522949
Epoch: 23, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.893805980682373
Epoch: 24, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9319348335266113
Epoch: 25, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 26 cost time: 0.87770676612854
Epoch: 26, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 27 cost time: 0.859853982925415
Epoch: 27, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 28 cost time: 0.9168298244476318
Epoch: 28, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.744680643081665
Epoch: 29, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8319504261016846
Epoch: 30, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9251744747161865
Epoch: 31, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8532187938690186
Epoch: 32, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.933476448059082
Epoch: 33, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 34 cost time: 0.887031078338623
Epoch: 34, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8859536647796631
Epoch: 35, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8405845165252686
Epoch: 36, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8995888233184814
Epoch: 37, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8862912654876709
Epoch: 38, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9256384372711182
Epoch: 39, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9415125846862793
Epoch: 40, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.817786455154419
Epoch: 41, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8264317512512207
Epoch: 42, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8104922771453857
Epoch: 43, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 20248
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5006091594696045
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.091 Vali Acc: 0.172 Test Loss: 2.091 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.8547043800354004
Epoch: 2, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.008 Vali Acc: 0.197 Test Loss: 2.008 Test Acc: 0.197
Validation loss decreased (-0.171854 --> -0.196855).  Saving model ...
Epoch: 3 cost time: 0.8638327121734619
Epoch: 3, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.891 Vali Acc: 0.278 Test Loss: 1.891 Test Acc: 0.278
Validation loss decreased (-0.196855 --> -0.278106).  Saving model ...
Epoch: 4 cost time: 0.8291013240814209
Epoch: 4, Steps: 8 | Train Loss: 1.931 Vali Loss: 1.752 Vali Acc: 0.428 Test Loss: 1.752 Test Acc: 0.428
Validation loss decreased (-0.278106 --> -0.428107).  Saving model ...
Epoch: 5 cost time: 0.8810195922851562
Epoch: 5, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.606 Vali Acc: 0.559 Test Loss: 1.606 Test Acc: 0.559
Validation loss decreased (-0.428107 --> -0.559359).  Saving model ...
Epoch: 6 cost time: 0.8019158840179443
Epoch: 6, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.457 Vali Acc: 0.641 Test Loss: 1.457 Test Acc: 0.641
Validation loss decreased (-0.559359 --> -0.640610).  Saving model ...
Epoch: 7 cost time: 0.7550654411315918
Epoch: 7, Steps: 8 | Train Loss: 1.467 Vali Loss: 1.312 Vali Acc: 0.706 Test Loss: 1.312 Test Acc: 0.706
Validation loss decreased (-0.640610 --> -0.706237).  Saving model ...
Epoch: 8 cost time: 0.7407925128936768
Epoch: 8, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.175 Vali Acc: 0.722 Test Loss: 1.175 Test Acc: 0.722
Validation loss decreased (-0.706237 --> -0.721863).  Saving model ...
Epoch: 9 cost time: 0.8679707050323486
Epoch: 9, Steps: 8 | Train Loss: 1.185 Vali Loss: 1.045 Vali Acc: 0.756 Test Loss: 1.045 Test Acc: 0.756
Validation loss decreased (-0.721863 --> -0.756240).  Saving model ...
Epoch: 10 cost time: 0.7416090965270996
Epoch: 10, Steps: 8 | Train Loss: 1.069 Vali Loss: 0.928 Vali Acc: 0.769 Test Loss: 0.928 Test Acc: 0.769
Validation loss decreased (-0.756240 --> -0.768741).  Saving model ...
Epoch: 11 cost time: 0.8293147087097168
Epoch: 11, Steps: 8 | Train Loss: 0.905 Vali Loss: 0.834 Vali Acc: 0.778 Test Loss: 0.834 Test Acc: 0.778
Validation loss decreased (-0.768741 --> -0.778117).  Saving model ...
Epoch: 12 cost time: 0.8069207668304443
Epoch: 12, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.751 Vali Acc: 0.791 Test Loss: 0.751 Test Acc: 0.791
Validation loss decreased (-0.778117 --> -0.790617).  Saving model ...
Epoch: 13 cost time: 0.7778558731079102
Epoch: 13, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
Validation loss decreased (-0.790617 --> -0.803118).  Saving model ...
Epoch: 14 cost time: 0.8398759365081787
Epoch: 14, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 15 cost time: 0.973224401473999
Epoch: 15, Steps: 8 | Train Loss: 0.518 Vali Loss: 0.611 Vali Acc: 0.806 Test Loss: 0.611 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 16 cost time: 1.0212066173553467
Epoch: 16, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.588 Vali Acc: 0.806 Test Loss: 0.588 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 17 cost time: 0.9013001918792725
Epoch: 17, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.006119966506958
Epoch: 18, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.556 Vali Acc: 0.806 Test Loss: 0.556 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 19 cost time: 0.9449872970581055
Epoch: 19, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821870).  Saving model ...
Epoch: 20 cost time: 1.0599133968353271
Epoch: 20, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 1.0871150493621826
Epoch: 21, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.8750433921813965
Epoch: 22, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 23 cost time: 1.0092401504516602
Epoch: 23, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 24 cost time: 0.9933483600616455
Epoch: 24, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9174995422363281
Epoch: 25, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.082320213317871
Epoch: 26, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9834499359130859
Epoch: 27, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9831349849700928
Epoch: 28, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0286991596221924
Epoch: 29, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9631264209747314
Epoch: 30, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8907289505004883
Epoch: 31, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9495382308959961
Epoch: 32, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9025130271911621
Epoch: 33, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 34 cost time: 0.7674798965454102
Epoch: 34, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8776934146881104
Epoch: 35, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8957562446594238
Epoch: 36, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 37 cost time: 0.8916666507720947
Epoch: 37, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9262609481811523
Epoch: 38, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9614582061767578
Epoch: 39, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8720412254333496
Epoch: 40, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 41 cost time: 0.9079093933105469
Epoch: 41, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 42 cost time: 0.9673409461975098
Epoch: 42, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8317680358886719
Epoch: 43, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0966911315917969
Epoch: 44, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9148685932159424
Epoch: 45, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9961028099060059
Epoch: 46, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9553961753845215
Epoch: 47, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.898735523223877
Epoch: 48, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9810872077941895
Epoch: 49, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9386591911315918
Epoch: 50, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9184281826019287
Epoch: 51, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 17688
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.446254253387451
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 2.149 Vali Acc: 0.116 Test Loss: 2.149 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.7901163101196289
Epoch: 2, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.061 Vali Acc: 0.150 Test Loss: 2.061 Test Acc: 0.150
Validation loss decreased (-0.115604 --> -0.149979).  Saving model ...
Epoch: 3 cost time: 0.8171679973602295
Epoch: 3, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.961 Vali Acc: 0.188 Test Loss: 1.961 Test Acc: 0.188
Validation loss decreased (-0.149979 --> -0.187480).  Saving model ...
Epoch: 4 cost time: 0.7817203998565674
Epoch: 4, Steps: 8 | Train Loss: 1.949 Vali Loss: 1.851 Vali Acc: 0.281 Test Loss: 1.851 Test Acc: 0.281
Validation loss decreased (-0.187480 --> -0.281231).  Saving model ...
Epoch: 5 cost time: 0.7736306190490723
Epoch: 5, Steps: 8 | Train Loss: 1.857 Vali Loss: 1.727 Vali Acc: 0.381 Test Loss: 1.727 Test Acc: 0.381
Validation loss decreased (-0.281231 --> -0.381233).  Saving model ...
Epoch: 6 cost time: 0.7983205318450928
Epoch: 6, Steps: 8 | Train Loss: 1.740 Vali Loss: 1.601 Vali Acc: 0.516 Test Loss: 1.601 Test Acc: 0.516
Validation loss decreased (-0.381233 --> -0.515609).  Saving model ...
Epoch: 7 cost time: 0.8200461864471436
Epoch: 7, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.472 Vali Acc: 0.609 Test Loss: 1.472 Test Acc: 0.609
Validation loss decreased (-0.515609 --> -0.609360).  Saving model ...
Epoch: 8 cost time: 0.8041365146636963
Epoch: 8, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.346 Vali Acc: 0.688 Test Loss: 1.346 Test Acc: 0.688
Validation loss decreased (-0.609360 --> -0.687487).  Saving model ...
Epoch: 9 cost time: 0.8338196277618408
Epoch: 9, Steps: 8 | Train Loss: 1.330 Vali Loss: 1.222 Vali Acc: 0.731 Test Loss: 1.222 Test Acc: 0.731
Validation loss decreased (-0.687487 --> -0.731238).  Saving model ...
Epoch: 10 cost time: 0.8913805484771729
Epoch: 10, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.110 Vali Acc: 0.750 Test Loss: 1.110 Test Acc: 0.750
Validation loss decreased (-0.731238 --> -0.749989).  Saving model ...
Epoch: 11 cost time: 0.8445842266082764
Epoch: 11, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.010 Vali Acc: 0.769 Test Loss: 1.010 Test Acc: 0.769
Validation loss decreased (-0.749989 --> -0.768740).  Saving model ...
Epoch: 12 cost time: 0.8970663547515869
Epoch: 12, Steps: 8 | Train Loss: 0.951 Vali Loss: 0.925 Vali Acc: 0.781 Test Loss: 0.925 Test Acc: 0.781
Validation loss decreased (-0.768740 --> -0.781241).  Saving model ...
Epoch: 13 cost time: 0.7135424613952637
Epoch: 13, Steps: 8 | Train Loss: 0.884 Vali Loss: 0.851 Vali Acc: 0.791 Test Loss: 0.851 Test Acc: 0.791
Validation loss decreased (-0.781241 --> -0.790616).  Saving model ...
Epoch: 14 cost time: 0.8979701995849609
Epoch: 14, Steps: 8 | Train Loss: 0.788 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.790616 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.7707726955413818
Epoch: 15, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
Validation loss decreased (-0.799992 --> -0.803118).  Saving model ...
Epoch: 16 cost time: 0.8274381160736084
Epoch: 16, Steps: 8 | Train Loss: 0.639 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.861685037612915
Epoch: 17, Steps: 8 | Train Loss: 0.595 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803118).  Saving model ...
Epoch: 18 cost time: 0.7591493129730225
Epoch: 18, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.650 Vali Acc: 0.812 Test Loss: 0.650 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812493).  Saving model ...
Epoch: 19 cost time: 0.9655675888061523
Epoch: 19, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.837735652923584
Epoch: 20, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.619 Vali Acc: 0.812 Test Loss: 0.619 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 21 cost time: 0.9445829391479492
Epoch: 21, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 22 cost time: 0.8699500560760498
Epoch: 22, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 23 cost time: 0.953244686126709
Epoch: 23, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8561584949493408
Epoch: 24, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 25 cost time: 0.8234174251556396
Epoch: 25, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 26 cost time: 0.9285123348236084
Epoch: 26, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 27 cost time: 0.9057292938232422
Epoch: 27, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 0.91902756690979
Epoch: 28, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 29 cost time: 0.8172850608825684
Epoch: 29, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8966145515441895
Epoch: 30, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8634223937988281
Epoch: 31, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8700058460235596
Epoch: 32, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7588531970977783
Epoch: 33, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8081655502319336
Epoch: 34, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0601756572723389
Epoch: 35, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 36 cost time: 0.843134880065918
Epoch: 36, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 37 cost time: 0.8917841911315918
Epoch: 37, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 38 cost time: 0.896824836730957
Epoch: 38, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8403820991516113
Epoch: 39, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7981858253479004
Epoch: 40, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.843949556350708
Epoch: 41, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8927984237670898
Epoch: 42, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8434386253356934
Epoch: 43, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8330478668212891
Epoch: 44, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8668580055236816
Epoch: 45, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9584574699401855
Epoch: 46, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.867943286895752
Epoch: 47, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 15640
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4421777725219727
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.086 Vali Acc: 0.159 Test Loss: 2.086 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.9060966968536377
Epoch: 2, Steps: 8 | Train Loss: 2.172 Vali Loss: 2.036 Vali Acc: 0.219 Test Loss: 2.036 Test Acc: 0.219
Validation loss decreased (-0.159354 --> -0.218730).  Saving model ...
Epoch: 3 cost time: 0.8364074230194092
Epoch: 3, Steps: 8 | Train Loss: 2.110 Vali Loss: 1.959 Vali Acc: 0.269 Test Loss: 1.959 Test Acc: 0.269
Validation loss decreased (-0.218730 --> -0.268730).  Saving model ...
Epoch: 4 cost time: 0.8252029418945312
Epoch: 4, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.865 Vali Acc: 0.338 Test Loss: 1.865 Test Acc: 0.338
Validation loss decreased (-0.268730 --> -0.337481).  Saving model ...
Epoch: 5 cost time: 0.963454008102417
Epoch: 5, Steps: 8 | Train Loss: 1.907 Vali Loss: 1.761 Vali Acc: 0.419 Test Loss: 1.761 Test Acc: 0.419
Validation loss decreased (-0.337481 --> -0.418732).  Saving model ...
Epoch: 6 cost time: 0.8734018802642822
Epoch: 6, Steps: 8 | Train Loss: 1.806 Vali Loss: 1.656 Vali Acc: 0.512 Test Loss: 1.656 Test Acc: 0.512
Validation loss decreased (-0.418732 --> -0.512483).  Saving model ...
Epoch: 7 cost time: 0.8902287483215332
Epoch: 7, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.549 Vali Acc: 0.550 Test Loss: 1.549 Test Acc: 0.550
Validation loss decreased (-0.512483 --> -0.549985).  Saving model ...
Epoch: 8 cost time: 0.9417119026184082
Epoch: 8, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.440 Vali Acc: 0.603 Test Loss: 1.440 Test Acc: 0.603
Validation loss decreased (-0.549985 --> -0.603111).  Saving model ...
Epoch: 9 cost time: 0.8564603328704834
Epoch: 9, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.329 Vali Acc: 0.659 Test Loss: 1.329 Test Acc: 0.659
Validation loss decreased (-0.603111 --> -0.659362).  Saving model ...
Epoch: 10 cost time: 0.8707170486450195
Epoch: 10, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.223 Vali Acc: 0.703 Test Loss: 1.223 Test Acc: 0.703
Validation loss decreased (-0.659362 --> -0.703113).  Saving model ...
Epoch: 11 cost time: 0.8740708827972412
Epoch: 11, Steps: 8 | Train Loss: 1.227 Vali Loss: 1.123 Vali Acc: 0.738 Test Loss: 1.123 Test Acc: 0.738
Validation loss decreased (-0.703113 --> -0.737489).  Saving model ...
Epoch: 12 cost time: 0.8455984592437744
Epoch: 12, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.028 Vali Acc: 0.766 Test Loss: 1.028 Test Acc: 0.766
Validation loss decreased (-0.737489 --> -0.765615).  Saving model ...
Epoch: 13 cost time: 1.0310752391815186
Epoch: 13, Steps: 8 | Train Loss: 0.998 Vali Loss: 0.949 Vali Acc: 0.766 Test Loss: 0.949 Test Acc: 0.766
Validation loss decreased (-0.765615 --> -0.765616).  Saving model ...
Epoch: 14 cost time: 0.8429789543151855
Epoch: 14, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.880 Vali Acc: 0.772 Test Loss: 0.880 Test Acc: 0.772
Validation loss decreased (-0.765616 --> -0.771866).  Saving model ...
Epoch: 15 cost time: 0.9225254058837891
Epoch: 15, Steps: 8 | Train Loss: 0.817 Vali Loss: 0.821 Vali Acc: 0.772 Test Loss: 0.821 Test Acc: 0.772
Validation loss decreased (-0.771866 --> -0.771867).  Saving model ...
Epoch: 16 cost time: 1.0129683017730713
Epoch: 16, Steps: 8 | Train Loss: 0.754 Vali Loss: 0.772 Vali Acc: 0.781 Test Loss: 0.772 Test Acc: 0.781
Validation loss decreased (-0.771867 --> -0.781242).  Saving model ...
Epoch: 17 cost time: 0.9284663200378418
Epoch: 17, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.733 Vali Acc: 0.787 Test Loss: 0.733 Test Acc: 0.787
Validation loss decreased (-0.781242 --> -0.787493).  Saving model ...
Epoch: 18 cost time: 0.8735141754150391
Epoch: 18, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.699 Vali Acc: 0.791 Test Loss: 0.699 Test Acc: 0.791
Validation loss decreased (-0.787493 --> -0.790618).  Saving model ...
Epoch: 19 cost time: 0.8827109336853027
Epoch: 19, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 20 cost time: 0.8598339557647705
Epoch: 20, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799994).  Saving model ...
Epoch: 21 cost time: 0.8608546257019043
Epoch: 21, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 22 cost time: 0.8991506099700928
Epoch: 22, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 23 cost time: 0.7527937889099121
Epoch: 23, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.596 Vali Acc: 0.806 Test Loss: 0.596 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 24 cost time: 0.9036099910736084
Epoch: 24, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 25 cost time: 0.8166248798370361
Epoch: 25, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 26 cost time: 0.7569923400878906
Epoch: 26, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 27 cost time: 0.7001545429229736
Epoch: 27, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 28 cost time: 0.9196937084197998
Epoch: 28, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 29 cost time: 0.8100690841674805
Epoch: 29, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 0.8965954780578613
Epoch: 30, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 31 cost time: 0.8039333820343018
Epoch: 31, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 32 cost time: 0.8531057834625244
Epoch: 32, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 33 cost time: 0.9163987636566162
Epoch: 33, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 34 cost time: 0.8376312255859375
Epoch: 34, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 35 cost time: 0.8297457695007324
Epoch: 35, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8746533393859863
Epoch: 36, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 37 cost time: 1.0197856426239014
Epoch: 37, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9167191982269287
Epoch: 38, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.909245491027832
Epoch: 39, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.511 Vali Acc: 0.828 Test Loss: 0.511 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9885601997375488
Epoch: 40, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8950691223144531
Epoch: 41, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 42 cost time: 0.9555671215057373
Epoch: 42, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 43 cost time: 0.9863440990447998
Epoch: 43, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 44 cost time: 0.8021981716156006
Epoch: 44, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 45 cost time: 0.7690310478210449
Epoch: 45, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9860477447509766
Epoch: 46, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8654897212982178
Epoch: 47, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7991600036621094
Epoch: 48, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.491 Vali Acc: 0.834 Test Loss: 0.491 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9116115570068359
Epoch: 49, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8612990379333496
Epoch: 50, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9388718605041504
Epoch: 51, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 52 cost time: 0.9098484516143799
Epoch: 52, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 53 cost time: 0.8848447799682617
Epoch: 53, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9942715167999268
Epoch: 54, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.899285078048706
Epoch: 55, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9299490451812744
Epoch: 56, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9668018817901611
Epoch: 57, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9932327270507812
Epoch: 58, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9092578887939453
Epoch: 59, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 60 cost time: 1.005228042602539
Epoch: 60, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 61 cost time: 0.8729457855224609
Epoch: 61, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9959702491760254
Epoch: 62, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9402163028717041
Epoch: 63, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8342928886413574
Epoch: 64, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8202106952667236
Epoch: 65, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8182599544525146
Epoch: 66, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.8334722518920898
Epoch: 67, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.994905948638916
Epoch: 68, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.0091462135314941
Epoch: 69, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.7870547771453857
Epoch: 70, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 14344
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1895837783813477
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.117 Vali Acc: 0.106 Test Loss: 2.117 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 0.9130816459655762
Epoch: 2, Steps: 8 | Train Loss: 2.123 Vali Loss: 2.060 Vali Acc: 0.156 Test Loss: 2.060 Test Acc: 0.156
Validation loss decreased (-0.106229 --> -0.156229).  Saving model ...
Epoch: 3 cost time: 1.0357627868652344
Epoch: 3, Steps: 8 | Train Loss: 2.046 Vali Loss: 1.983 Vali Acc: 0.200 Test Loss: 1.983 Test Acc: 0.200
Validation loss decreased (-0.156229 --> -0.199980).  Saving model ...
Epoch: 4 cost time: 0.9158041477203369
Epoch: 4, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.894 Vali Acc: 0.269 Test Loss: 1.894 Test Acc: 0.269
Validation loss decreased (-0.199980 --> -0.268731).  Saving model ...
Epoch: 5 cost time: 0.8477139472961426
Epoch: 5, Steps: 8 | Train Loss: 1.857 Vali Loss: 1.792 Vali Acc: 0.353 Test Loss: 1.792 Test Acc: 0.353
Validation loss decreased (-0.268731 --> -0.353107).  Saving model ...
Epoch: 6 cost time: 0.9420220851898193
Epoch: 6, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.690 Vali Acc: 0.428 Test Loss: 1.690 Test Acc: 0.428
Validation loss decreased (-0.353107 --> -0.428108).  Saving model ...
Epoch: 7 cost time: 0.8973255157470703
Epoch: 7, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.581 Vali Acc: 0.509 Test Loss: 1.581 Test Acc: 0.509
Validation loss decreased (-0.428108 --> -0.509359).  Saving model ...
Epoch: 8 cost time: 0.8710372447967529
Epoch: 8, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.476 Vali Acc: 0.591 Test Loss: 1.476 Test Acc: 0.591
Validation loss decreased (-0.509359 --> -0.590610).  Saving model ...
Epoch: 9 cost time: 0.8328144550323486
Epoch: 9, Steps: 8 | Train Loss: 1.514 Vali Loss: 1.375 Vali Acc: 0.631 Test Loss: 1.375 Test Acc: 0.631
Validation loss decreased (-0.590610 --> -0.631236).  Saving model ...
Epoch: 10 cost time: 1.058070182800293
Epoch: 10, Steps: 8 | Train Loss: 1.402 Vali Loss: 1.282 Vali Acc: 0.681 Test Loss: 1.282 Test Acc: 0.681
Validation loss decreased (-0.631236 --> -0.681237).  Saving model ...
Epoch: 11 cost time: 0.9348933696746826
Epoch: 11, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.191 Vali Acc: 0.722 Test Loss: 1.191 Test Acc: 0.722
Validation loss decreased (-0.681237 --> -0.721863).  Saving model ...
Epoch: 12 cost time: 0.9585444927215576
Epoch: 12, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.109 Vali Acc: 0.769 Test Loss: 1.109 Test Acc: 0.769
Validation loss decreased (-0.721863 --> -0.768739).  Saving model ...
Epoch: 13 cost time: 0.9754583835601807
Epoch: 13, Steps: 8 | Train Loss: 1.078 Vali Loss: 1.033 Vali Acc: 0.769 Test Loss: 1.033 Test Acc: 0.769
Validation loss decreased (-0.768739 --> -0.768740).  Saving model ...
Epoch: 14 cost time: 0.9397244453430176
Epoch: 14, Steps: 8 | Train Loss: 1.064 Vali Loss: 0.963 Vali Acc: 0.772 Test Loss: 0.963 Test Acc: 0.772
Validation loss decreased (-0.768740 --> -0.771865).  Saving model ...
Epoch: 15 cost time: 0.907367467880249
Epoch: 15, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.902 Vali Acc: 0.769 Test Loss: 0.902 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8637659549713135
Epoch: 16, Steps: 8 | Train Loss: 0.859 Vali Loss: 0.850 Vali Acc: 0.772 Test Loss: 0.850 Test Acc: 0.772
Validation loss decreased (-0.771865 --> -0.771867).  Saving model ...
Epoch: 17 cost time: 0.9263429641723633
Epoch: 17, Steps: 8 | Train Loss: 0.786 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
Validation loss decreased (-0.771867 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 0.9760241508483887
Epoch: 18, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.770 Vali Acc: 0.781 Test Loss: 0.770 Test Acc: 0.781
Validation loss decreased (-0.774992 --> -0.781242).  Saving model ...
Epoch: 19 cost time: 1.0104796886444092
Epoch: 19, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.734 Vali Acc: 0.787 Test Loss: 0.734 Test Acc: 0.787
Validation loss decreased (-0.781242 --> -0.787493).  Saving model ...
Epoch: 20 cost time: 1.0959229469299316
Epoch: 20, Steps: 8 | Train Loss: 0.690 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
Validation loss decreased (-0.787493 --> -0.793743).  Saving model ...
Epoch: 21 cost time: 0.967998743057251
Epoch: 21, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.682 Vali Acc: 0.794 Test Loss: 0.682 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 22 cost time: 0.8985767364501953
Epoch: 22, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.659 Vali Acc: 0.797 Test Loss: 0.659 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 23 cost time: 0.8753838539123535
Epoch: 23, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 0.8651378154754639
Epoch: 24, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
Validation loss decreased (-0.799994 --> -0.812494).  Saving model ...
Epoch: 25 cost time: 0.9482986927032471
Epoch: 25, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.610 Vali Acc: 0.806 Test Loss: 0.610 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9171011447906494
Epoch: 26, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.598 Vali Acc: 0.806 Test Loss: 0.598 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8703582286834717
Epoch: 27, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9206271171569824
Epoch: 28, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 29 cost time: 0.9234907627105713
Epoch: 29, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 30 cost time: 1.0131053924560547
Epoch: 30, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 31 cost time: 1.0260632038116455
Epoch: 31, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 32 cost time: 0.9183502197265625
Epoch: 32, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
Validation loss decreased (-0.818745 --> -0.831245).  Saving model ...
Epoch: 33 cost time: 0.9706523418426514
Epoch: 33, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 34 cost time: 0.9502289295196533
Epoch: 34, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 35 cost time: 0.9472672939300537
Epoch: 35, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 36 cost time: 0.9057908058166504
Epoch: 36, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 37 cost time: 0.8972783088684082
Epoch: 37, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8963477611541748
Epoch: 38, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 39 cost time: 0.9770832061767578
Epoch: 39, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 40 cost time: 0.9834935665130615
Epoch: 40, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 41 cost time: 0.9929592609405518
Epoch: 41, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.489 Vali Acc: 0.866 Test Loss: 0.489 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 42 cost time: 0.8942849636077881
Epoch: 42, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0639269351959229
Epoch: 43, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0211822986602783
Epoch: 44, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8841025829315186
Epoch: 45, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9169471263885498
Epoch: 46, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9694292545318604
Epoch: 47, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.467 Vali Acc: 0.866 Test Loss: 0.467 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 48 cost time: 0.9734649658203125
Epoch: 48, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.467 Vali Acc: 0.869 Test Loss: 0.467 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 49 cost time: 0.9286212921142578
Epoch: 49, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9609353542327881
Epoch: 50, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.459 Vali Acc: 0.872 Test Loss: 0.459 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 51 cost time: 0.9292526245117188
Epoch: 51, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 52 cost time: 0.8937294483184814
Epoch: 52, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.074617624282837
Epoch: 53, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.456 Vali Acc: 0.866 Test Loss: 0.456 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.84423828125
Epoch: 54, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.453 Vali Acc: 0.866 Test Loss: 0.453 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0701749324798584
Epoch: 55, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 56 cost time: 0.9372684955596924
Epoch: 56, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871871).  Saving model ...
Epoch: 57 cost time: 0.9522266387939453
Epoch: 57, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.446 Vali Acc: 0.869 Test Loss: 0.446 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0354013442993164
Epoch: 58, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 59 cost time: 0.9347929954528809
Epoch: 59, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.440 Vali Acc: 0.869 Test Loss: 0.440 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9937481880187988
Epoch: 60, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.0531032085418701
Epoch: 61, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.999387264251709
Epoch: 62, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.447 Vali Acc: 0.859 Test Loss: 0.447 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.9754362106323242
Epoch: 63, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9752316474914551
Epoch: 64, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.9232559204101562
Epoch: 65, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.9034061431884766
Epoch: 66, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.442 Vali Acc: 0.866 Test Loss: 0.442 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.970134973526001
Epoch: 67, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.438 Vali Acc: 0.872 Test Loss: 0.438 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 68 cost time: 1.0061657428741455
Epoch: 68, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.437 Vali Acc: 0.869 Test Loss: 0.437 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9704959392547607
Epoch: 69, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.439 Vali Acc: 0.869 Test Loss: 0.439 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9841582775115967
Epoch: 70, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.441 Vali Acc: 0.869 Test Loss: 0.441 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.0268118381500244
Epoch: 71, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.442 Vali Acc: 0.869 Test Loss: 0.442 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.0189945697784424
Epoch: 72, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.445 Vali Acc: 0.863 Test Loss: 0.445 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.9683229923248291
Epoch: 73, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.9814088344573975
Epoch: 74, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.455 Vali Acc: 0.863 Test Loss: 0.455 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.9943552017211914
Epoch: 75, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.0951664447784424
Epoch: 76, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.453 Vali Acc: 0.866 Test Loss: 0.453 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.9736402034759521
Epoch: 77, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.453 Vali Acc: 0.863 Test Loss: 0.453 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el3_dm16_nh4_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 13832
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4375393390655518
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 1.562 Vali Acc: 0.619 Test Loss: 1.562 Test Acc: 0.619
Validation loss decreased (inf --> -0.618734).  Saving model ...
Epoch: 2 cost time: 0.8571643829345703
Epoch: 2, Steps: 8 | Train Loss: 1.135 Vali Loss: 0.721 Vali Acc: 0.784 Test Loss: 0.721 Test Acc: 0.784
Validation loss decreased (-0.618734 --> -0.784368).  Saving model ...
Epoch: 3 cost time: 0.9667837619781494
Epoch: 3, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.784368 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 0.876650333404541
Epoch: 4, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9122433662414551
Epoch: 5, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 6 cost time: 0.875493049621582
Epoch: 6, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.652 Vali Acc: 0.816 Test Loss: 0.652 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0934438705444336
Epoch: 7, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.684 Vali Acc: 0.834 Test Loss: 0.684 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9266412258148193
Epoch: 8, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.724 Vali Acc: 0.828 Test Loss: 0.724 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8451697826385498
Epoch: 9, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.815 Vali Acc: 0.834 Test Loss: 0.815 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8498983383178711
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.793 Vali Acc: 0.831 Test Loss: 0.793 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9022798538208008
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.828 Test Loss: 0.834 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0100395679473877
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.925 Vali Acc: 0.822 Test Loss: 0.925 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.93556809425354
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.822 Test Loss: 0.953 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8224518299102783
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.841 Test Loss: 0.885 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8991131782531738
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.838 Test Loss: 0.897 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 505864
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.71844220161438
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 1.876 Vali Acc: 0.328 Test Loss: 1.876 Test Acc: 0.328
Validation loss decreased (inf --> -0.328106).  Saving model ...
Epoch: 2 cost time: 0.8951759338378906
Epoch: 2, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.093 Vali Acc: 0.772 Test Loss: 1.093 Test Acc: 0.772
Validation loss decreased (-0.328106 --> -0.771864).  Saving model ...
Epoch: 3 cost time: 0.9373629093170166
Epoch: 3, Steps: 8 | Train Loss: 0.855 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
Validation loss decreased (-0.771864 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 0.8946497440338135
Epoch: 4, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821870).  Saving model ...
Epoch: 5 cost time: 1.1093764305114746
Epoch: 5, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.558 Vali Acc: 0.806 Test Loss: 0.558 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9165878295898438
Epoch: 6, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.8822762966156006
Epoch: 7, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7763004302978516
Epoch: 8, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9542899131774902
Epoch: 9, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.675 Vali Acc: 0.812 Test Loss: 0.675 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.786182165145874
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1244678497314453
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.697 Vali Acc: 0.841 Test Loss: 0.697 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840618).  Saving model ...
Epoch: 12 cost time: 1.1509714126586914
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.747 Vali Acc: 0.831 Test Loss: 0.747 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9950318336486816
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0051078796386719
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.787 Vali Acc: 0.825 Test Loss: 0.787 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9529702663421631
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.758 Vali Acc: 0.828 Test Loss: 0.758 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0007905960083008
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.765 Vali Acc: 0.838 Test Loss: 0.765 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8846344947814941
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.806 Vali Acc: 0.834 Test Loss: 0.806 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1676530838012695
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1883666515350342
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.802 Vali Acc: 0.841 Test Loss: 0.802 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9281210899353027
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.841 Test Loss: 0.809 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0457720756530762
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.818 Vali Acc: 0.834 Test Loss: 0.818 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 387080
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.465608596801758
Epoch: 1, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.792 Vali Acc: 0.447 Test Loss: 1.792 Test Acc: 0.447
Validation loss decreased (inf --> -0.446857).  Saving model ...
Epoch: 2 cost time: 0.8682825565338135
Epoch: 2, Steps: 8 | Train Loss: 1.539 Vali Loss: 1.222 Vali Acc: 0.697 Test Loss: 1.222 Test Acc: 0.697
Validation loss decreased (-0.446857 --> -0.696863).  Saving model ...
Epoch: 3 cost time: 0.8393421173095703
Epoch: 3, Steps: 8 | Train Loss: 0.985 Vali Loss: 0.798 Vali Acc: 0.769 Test Loss: 0.798 Test Acc: 0.769
Validation loss decreased (-0.696863 --> -0.768742).  Saving model ...
Epoch: 4 cost time: 0.8026783466339111
Epoch: 4, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.768742 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 0.8975882530212402
Epoch: 5, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 0.8999381065368652
Epoch: 6, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.492 Vali Acc: 0.831 Test Loss: 0.492 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.8853645324707031
Epoch: 7, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.8879601955413818
Epoch: 8, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 1.0426025390625
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9986872673034668
Epoch: 10, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8903956413269043
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9759888648986816
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.644 Vali Acc: 0.816 Test Loss: 0.644 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8581950664520264
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0293586254119873
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.614 Vali Acc: 0.834 Test Loss: 0.614 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9779176712036133
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.628 Vali Acc: 0.834 Test Loss: 0.628 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.948645830154419
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9551918506622314
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.671 Vali Acc: 0.825 Test Loss: 0.671 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8029050827026367
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.678 Vali Acc: 0.828 Test Loss: 0.678 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 348168
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5764517784118652
Epoch: 1, Steps: 8 | Train Loss: 2.261 Vali Loss: 1.982 Vali Acc: 0.197 Test Loss: 1.982 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 0.7498421669006348
Epoch: 2, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.428 Vali Acc: 0.641 Test Loss: 1.428 Test Acc: 0.641
Validation loss decreased (-0.196855 --> -0.640611).  Saving model ...
Epoch: 3 cost time: 0.8305222988128662
Epoch: 3, Steps: 8 | Train Loss: 1.224 Vali Loss: 0.928 Vali Acc: 0.778 Test Loss: 0.928 Test Acc: 0.778
Validation loss decreased (-0.640611 --> -0.778116).  Saving model ...
Epoch: 4 cost time: 0.7750949859619141
Epoch: 4, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.670 Vali Acc: 0.787 Test Loss: 0.670 Test Acc: 0.787
Validation loss decreased (-0.778116 --> -0.787493).  Saving model ...
Epoch: 5 cost time: 0.729555606842041
Epoch: 5, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
Validation loss decreased (-0.787493 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 0.7274425029754639
Epoch: 6, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.7498023509979248
Epoch: 7, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.498 Vali Acc: 0.831 Test Loss: 0.498 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.7830138206481934
Epoch: 8, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7171878814697266
Epoch: 9, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7196824550628662
Epoch: 10, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.7215378284454346
Epoch: 11, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8405768871307373
Epoch: 12, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7341678142547607
Epoch: 13, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6812889575958252
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.768946647644043
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6802773475646973
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.596 Vali Acc: 0.838 Test Loss: 0.596 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6834530830383301
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.600 Vali Acc: 0.838 Test Loss: 0.600 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.799396276473999
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7819230556488037
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8771462440490723
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.831 Test Loss: 0.637 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 327688
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1641011238098145
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 1.908 Vali Acc: 0.300 Test Loss: 1.908 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 0.7077286243438721
Epoch: 2, Steps: 8 | Train Loss: 1.741 Vali Loss: 1.492 Vali Acc: 0.644 Test Loss: 1.492 Test Acc: 0.644
Validation loss decreased (-0.299981 --> -0.643735).  Saving model ...
Epoch: 3 cost time: 0.7573983669281006
Epoch: 3, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.052 Vali Acc: 0.775 Test Loss: 1.052 Test Acc: 0.775
Validation loss decreased (-0.643735 --> -0.774989).  Saving model ...
Epoch: 4 cost time: 0.6831550598144531
Epoch: 4, Steps: 8 | Train Loss: 0.932 Vali Loss: 0.750 Vali Acc: 0.787 Test Loss: 0.750 Test Acc: 0.787
Validation loss decreased (-0.774989 --> -0.787492).  Saving model ...
Epoch: 5 cost time: 0.8095347881317139
Epoch: 5, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.611 Vali Acc: 0.819 Test Loss: 0.611 Test Acc: 0.819
Validation loss decreased (-0.787492 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 0.7920382022857666
Epoch: 6, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 0.6646277904510498
Epoch: 7, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
Validation loss decreased (-0.818745 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.7051658630371094
Epoch: 8, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.7956774234771729
Epoch: 9, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6698639392852783
Epoch: 10, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6652374267578125
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6521782875061035
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6559066772460938
Epoch: 13, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7361700534820557
Epoch: 14, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.733884334564209
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.545 Vali Acc: 0.834 Test Loss: 0.545 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7036142349243164
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8125145435333252
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8370606899261475
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 0.782067060470581
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7742874622344971
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8001205921173096
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7331867218017578
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6756381988525391
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7193078994750977
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7558073997497559
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8223633766174316
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8202674388885498
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.594 Vali Acc: 0.853 Test Loss: 0.594 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7732563018798828
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 311304
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.338961124420166
Epoch: 1, Steps: 8 | Train Loss: 2.332 Vali Loss: 2.177 Vali Acc: 0.197 Test Loss: 2.177 Test Acc: 0.197
Validation loss decreased (inf --> -0.196853).  Saving model ...
Epoch: 2 cost time: 0.6966366767883301
Epoch: 2, Steps: 8 | Train Loss: 2.016 Vali Loss: 1.781 Vali Acc: 0.409 Test Loss: 1.781 Test Acc: 0.409
Validation loss decreased (-0.196853 --> -0.409357).  Saving model ...
Epoch: 3 cost time: 0.6597435474395752
Epoch: 3, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.314 Vali Acc: 0.644 Test Loss: 1.314 Test Acc: 0.644
Validation loss decreased (-0.409357 --> -0.643737).  Saving model ...
Epoch: 4 cost time: 0.5836639404296875
Epoch: 4, Steps: 8 | Train Loss: 1.124 Vali Loss: 0.955 Vali Acc: 0.747 Test Loss: 0.955 Test Acc: 0.747
Validation loss decreased (-0.643737 --> -0.746865).  Saving model ...
Epoch: 5 cost time: 0.6394550800323486
Epoch: 5, Steps: 8 | Train Loss: 0.800 Vali Loss: 0.747 Vali Acc: 0.784 Test Loss: 0.747 Test Acc: 0.784
Validation loss decreased (-0.746865 --> -0.784368).  Saving model ...
Epoch: 6 cost time: 0.706334114074707
Epoch: 6, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.637 Vali Acc: 0.787 Test Loss: 0.637 Test Acc: 0.787
Validation loss decreased (-0.784368 --> -0.787494).  Saving model ...
Epoch: 7 cost time: 0.6628825664520264
Epoch: 7, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
Validation loss decreased (-0.787494 --> -0.809370).  Saving model ...
Epoch: 8 cost time: 0.698906421661377
Epoch: 8, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.809370 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.7386844158172607
Epoch: 9, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.507 Vali Acc: 0.825 Test Loss: 0.507 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7188701629638672
Epoch: 10, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.491 Vali Acc: 0.834 Test Loss: 0.491 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.7626795768737793
Epoch: 11, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.834370 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.7090702056884766
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.6498701572418213
Epoch: 13, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7795155048370361
Epoch: 14, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6905076503753662
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7292287349700928
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.7903268337249756
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6625938415527344
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8413934707641602
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7428977489471436
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6566259860992432
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6464502811431885
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7084681987762451
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 24 cost time: 0.7375063896179199
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 25 cost time: 0.6493282318115234
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7289719581604004
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7542386054992676
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6978676319122314
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.743018627166748
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7317190170288086
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.540 Vali Acc: 0.853 Test Loss: 0.540 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6946675777435303
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.542 Vali Acc: 0.859 Test Loss: 0.542 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6846702098846436
Epoch: 32, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6485142707824707
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.866 Test Loss: 0.529 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 34 cost time: 0.7071654796600342
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.866 Test Loss: 0.525 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 35 cost time: 0.682842493057251
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 36 cost time: 0.7459888458251953
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 37 cost time: 0.7531671524047852
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7375607490539551
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.869 Test Loss: 0.535 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7151627540588379
Epoch: 39, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6557562351226807
Epoch: 40, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.616879940032959
Epoch: 41, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 42 cost time: 0.6901884078979492
Epoch: 42, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 43 cost time: 0.7900135517120361
Epoch: 43, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6309244632720947
Epoch: 44, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6389236450195312
Epoch: 45, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8152287006378174
Epoch: 46, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6693582534790039
Epoch: 47, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8128964900970459
Epoch: 48, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6346380710601807
Epoch: 49, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7497756481170654
Epoch: 50, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.539 Vali Acc: 0.875 Test Loss: 0.539 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7192933559417725
Epoch: 51, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6786909103393555
Epoch: 52, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 300936
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.195808172225952
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.019 Vali Acc: 0.178 Test Loss: 2.019 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.6013803482055664
Epoch: 2, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.681 Vali Acc: 0.456 Test Loss: 1.681 Test Acc: 0.456
Validation loss decreased (-0.178105 --> -0.456233).  Saving model ...
Epoch: 3 cost time: 0.6679821014404297
Epoch: 3, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.288 Vali Acc: 0.697 Test Loss: 1.288 Test Acc: 0.697
Validation loss decreased (-0.456233 --> -0.696862).  Saving model ...
Epoch: 4 cost time: 0.7583463191986084
Epoch: 4, Steps: 8 | Train Loss: 1.140 Vali Loss: 0.986 Vali Acc: 0.734 Test Loss: 0.986 Test Acc: 0.734
Validation loss decreased (-0.696862 --> -0.734365).  Saving model ...
Epoch: 5 cost time: 0.7445330619812012
Epoch: 5, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.797 Vali Acc: 0.766 Test Loss: 0.797 Test Acc: 0.766
Validation loss decreased (-0.734365 --> -0.765617).  Saving model ...
Epoch: 6 cost time: 0.6995868682861328
Epoch: 6, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
Validation loss decreased (-0.765617 --> -0.774993).  Saving model ...
Epoch: 7 cost time: 0.6770467758178711
Epoch: 7, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 0.7092099189758301
Epoch: 8, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.552 Vali Acc: 0.806 Test Loss: 0.552 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.6578538417816162
Epoch: 9, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809370).  Saving model ...
Epoch: 10 cost time: 0.709829568862915
Epoch: 10, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
Validation loss decreased (-0.809370 --> -0.821870).  Saving model ...
Epoch: 11 cost time: 0.7511467933654785
Epoch: 11, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
Validation loss decreased (-0.821870 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.7021300792694092
Epoch: 12, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6468145847320557
Epoch: 13, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 14 cost time: 0.7164144515991211
Epoch: 14, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6723291873931885
Epoch: 15, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7525479793548584
Epoch: 16, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6673953533172607
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 0.6617238521575928
Epoch: 18, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.502 Vali Acc: 0.828 Test Loss: 0.502 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.668440580368042
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.496 Vali Acc: 0.831 Test Loss: 0.496 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7033767700195312
Epoch: 20, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.481 Vali Acc: 0.831 Test Loss: 0.481 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7104761600494385
Epoch: 21, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8294107913970947
Epoch: 22, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7617707252502441
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0442368984222412
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.663886308670044
Epoch: 25, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6505906581878662
Epoch: 26, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6680634021759033
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 296840
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.704923391342163
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 1.648 Vali Acc: 0.444 Test Loss: 1.648 Test Acc: 0.444
Validation loss decreased (inf --> -0.443734).  Saving model ...
Epoch: 2 cost time: 1.019434928894043
Epoch: 2, Steps: 8 | Train Loss: 1.132 Vali Loss: 0.694 Vali Acc: 0.822 Test Loss: 0.694 Test Acc: 0.822
Validation loss decreased (-0.443734 --> -0.821868).  Saving model ...
Epoch: 3 cost time: 1.0834510326385498
Epoch: 3, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.821868 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 1.1505963802337646
Epoch: 4, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1202385425567627
Epoch: 5, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0583796501159668
Epoch: 6, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 1.0543818473815918
Epoch: 7, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.055647611618042
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0705056190490723
Epoch: 9, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.864 Vali Acc: 0.822 Test Loss: 0.864 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1261107921600342
Epoch: 10, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.766 Vali Acc: 0.838 Test Loss: 0.766 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1078307628631592
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1070878505706787
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.898 Vali Acc: 0.831 Test Loss: 0.898 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1053030490875244
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.952 Vali Acc: 0.828 Test Loss: 0.952 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.214529275894165
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.908 Vali Acc: 0.831 Test Loss: 0.908 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1407995223999023
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.917 Vali Acc: 0.828 Test Loss: 0.917 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.159879446029663
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.091 Vali Acc: 0.825 Test Loss: 1.091 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 440072
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.750011920928955
Epoch: 1, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.697 Vali Acc: 0.478 Test Loss: 1.697 Test Acc: 0.478
Validation loss decreased (inf --> -0.478108).  Saving model ...
Epoch: 2 cost time: 1.0580291748046875
Epoch: 2, Steps: 8 | Train Loss: 1.377 Vali Loss: 0.986 Vali Acc: 0.769 Test Loss: 0.986 Test Acc: 0.769
Validation loss decreased (-0.478108 --> -0.768740).  Saving model ...
Epoch: 3 cost time: 0.9858250617980957
Epoch: 3, Steps: 8 | Train Loss: 0.766 Vali Loss: 0.627 Vali Acc: 0.831 Test Loss: 0.627 Test Acc: 0.831
Validation loss decreased (-0.768740 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 1.0425703525543213
Epoch: 4, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 5 cost time: 0.9211688041687012
Epoch: 5, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.9642133712768555
Epoch: 6, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.028907060623169
Epoch: 7, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.571 Vali Acc: 0.838 Test Loss: 0.571 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0073294639587402
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9993259906768799
Epoch: 9, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.022599697113037
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.673 Vali Acc: 0.841 Test Loss: 0.673 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9790410995483398
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9078116416931152
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9113049507141113
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.720 Vali Acc: 0.834 Test Loss: 0.720 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0452558994293213
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.757 Vali Acc: 0.822 Test Loss: 0.757 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0129342079162598
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.771 Vali Acc: 0.828 Test Loss: 0.771 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9908888339996338
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.903 Vali Acc: 0.822 Test Loss: 0.903 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 321288
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.730340003967285
Epoch: 1, Steps: 8 | Train Loss: 2.087 Vali Loss: 1.900 Vali Acc: 0.306 Test Loss: 1.900 Test Acc: 0.306
Validation loss decreased (inf --> -0.306231).  Saving model ...
Epoch: 2 cost time: 0.9737372398376465
Epoch: 2, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.285 Vali Acc: 0.706 Test Loss: 1.285 Test Acc: 0.706
Validation loss decreased (-0.306231 --> -0.706237).  Saving model ...
Epoch: 3 cost time: 1.1709892749786377
Epoch: 3, Steps: 8 | Train Loss: 1.030 Vali Loss: 0.797 Vali Acc: 0.781 Test Loss: 0.797 Test Acc: 0.781
Validation loss decreased (-0.706237 --> -0.781242).  Saving model ...
Epoch: 4 cost time: 1.229238510131836
Epoch: 4, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.781242 --> -0.803119).  Saving model ...
Epoch: 5 cost time: 1.2680597305297852
Epoch: 5, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
Validation loss decreased (-0.803119 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 1.3088276386260986
Epoch: 6, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0109732151031494
Epoch: 7, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5453176498413086
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.821870 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 1.4078001976013184
Epoch: 9, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3519952297210693
Epoch: 10, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.575 Vali Acc: 0.838 Test Loss: 0.575 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1468558311462402
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3772146701812744
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4479484558105469
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3346004486083984
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.677 Vali Acc: 0.834 Test Loss: 0.677 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0578272342681885
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.689 Vali Acc: 0.834 Test Loss: 0.689 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.241642713546753
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3908233642578125
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.710 Vali Acc: 0.822 Test Loss: 0.710 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3826894760131836
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 282376
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2524256706237793
Epoch: 1, Steps: 8 | Train Loss: 2.093 Vali Loss: 1.925 Vali Acc: 0.141 Test Loss: 1.925 Test Acc: 0.141
Validation loss decreased (inf --> -0.140606).  Saving model ...
Epoch: 2 cost time: 0.9089062213897705
Epoch: 2, Steps: 8 | Train Loss: 1.710 Vali Loss: 1.345 Vali Acc: 0.656 Test Loss: 1.345 Test Acc: 0.656
Validation loss decreased (-0.140606 --> -0.656237).  Saving model ...
Epoch: 3 cost time: 0.7764260768890381
Epoch: 3, Steps: 8 | Train Loss: 1.131 Vali Loss: 0.891 Vali Acc: 0.762 Test Loss: 0.891 Test Acc: 0.762
Validation loss decreased (-0.656237 --> -0.762491).  Saving model ...
Epoch: 4 cost time: 0.8553009033203125
Epoch: 4, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.635 Vali Acc: 0.806 Test Loss: 0.635 Test Acc: 0.806
Validation loss decreased (-0.762491 --> -0.806244).  Saving model ...
Epoch: 5 cost time: 0.7982871532440186
Epoch: 5, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
Validation loss decreased (-0.806244 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 0.8222084045410156
Epoch: 6, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.7922232151031494
Epoch: 7, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.7864398956298828
Epoch: 8, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7563376426696777
Epoch: 9, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8266310691833496
Epoch: 10, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8520660400390625
Epoch: 11, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9431140422821045
Epoch: 12, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9388227462768555
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.544 Vali Acc: 0.831 Test Loss: 0.544 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7756412029266357
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9323644638061523
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9221112728118896
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8649351596832275
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 261896
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.199077844619751
Epoch: 1, Steps: 8 | Train Loss: 2.316 Vali Loss: 2.145 Vali Acc: 0.087 Test Loss: 2.145 Test Acc: 0.087
Validation loss decreased (inf --> -0.087479).  Saving model ...
Epoch: 2 cost time: 0.7983484268188477
Epoch: 2, Steps: 8 | Train Loss: 1.942 Vali Loss: 1.680 Vali Acc: 0.463 Test Loss: 1.680 Test Acc: 0.463
Validation loss decreased (-0.087479 --> -0.462483).  Saving model ...
Epoch: 3 cost time: 0.8268775939941406
Epoch: 3, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.165 Vali Acc: 0.734 Test Loss: 1.165 Test Acc: 0.734
Validation loss decreased (-0.462483 --> -0.734363).  Saving model ...
Epoch: 4 cost time: 0.837507963180542
Epoch: 4, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.816 Vali Acc: 0.778 Test Loss: 0.816 Test Acc: 0.778
Validation loss decreased (-0.734363 --> -0.778117).  Saving model ...
Epoch: 5 cost time: 0.8573613166809082
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
Validation loss decreased (-0.778117 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.8590445518493652
Epoch: 6, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.8277122974395752
Epoch: 7, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.8812110424041748
Epoch: 8, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 0.8115234375
Epoch: 9, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8875062465667725
Epoch: 10, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.523 Vali Acc: 0.819 Test Loss: 0.523 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8639023303985596
Epoch: 11, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.7817099094390869
Epoch: 12, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8299236297607422
Epoch: 13, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.834136962890625
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8279967308044434
Epoch: 15, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.772559642791748
Epoch: 16, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7672417163848877
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.572 Vali Acc: 0.834 Test Loss: 0.572 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8035578727722168
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7573356628417969
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7632324695587158
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6878490447998047
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 245512
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4995596408843994
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.065 Vali Acc: 0.234 Test Loss: 2.065 Test Acc: 0.234
Validation loss decreased (inf --> -0.234354).  Saving model ...
Epoch: 2 cost time: 0.7215447425842285
Epoch: 2, Steps: 8 | Train Loss: 1.877 Vali Loss: 1.697 Vali Acc: 0.434 Test Loss: 1.697 Test Acc: 0.434
Validation loss decreased (-0.234354 --> -0.434358).  Saving model ...
Epoch: 3 cost time: 0.6357641220092773
Epoch: 3, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.274 Vali Acc: 0.653 Test Loss: 1.274 Test Acc: 0.653
Validation loss decreased (-0.434358 --> -0.653112).  Saving model ...
Epoch: 4 cost time: 0.6752700805664062
Epoch: 4, Steps: 8 | Train Loss: 1.075 Vali Loss: 0.939 Vali Acc: 0.766 Test Loss: 0.939 Test Acc: 0.766
Validation loss decreased (-0.653112 --> -0.765616).  Saving model ...
Epoch: 5 cost time: 0.729299783706665
Epoch: 5, Steps: 8 | Train Loss: 0.801 Vali Loss: 0.715 Vali Acc: 0.803 Test Loss: 0.715 Test Acc: 0.803
Validation loss decreased (-0.765616 --> -0.803118).  Saving model ...
Epoch: 6 cost time: 0.7109622955322266
Epoch: 6, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 7 cost time: 0.7338461875915527
Epoch: 7, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821870).  Saving model ...
Epoch: 8 cost time: 0.7373743057250977
Epoch: 8, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 0.6994054317474365
Epoch: 9, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.7987420558929443
Epoch: 10, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.853222131729126
Epoch: 11, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8280632495880127
Epoch: 12, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8090364933013916
Epoch: 13, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.7137205600738525
Epoch: 14, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7289373874664307
Epoch: 15, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7072157859802246
Epoch: 16, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.922771692276001
Epoch: 17, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.869192361831665
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7656352519989014
Epoch: 19, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7521512508392334
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7225301265716553
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.77187180519104
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 23 cost time: 0.8382620811462402
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 24 cost time: 0.7717490196228027
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7930934429168701
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.528 Vali Acc: 0.853 Test Loss: 0.528 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7404394149780273
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7018237113952637
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8988559246063232
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.750455379486084
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6899623870849609
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8123724460601807
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7282764911651611
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 33 cost time: 0.7602708339691162
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7534322738647461
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.545 Vali Acc: 0.859 Test Loss: 0.545 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 35 cost time: 0.7257513999938965
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.541 Vali Acc: 0.859 Test Loss: 0.541 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 36 cost time: 0.7843794822692871
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7310009002685547
Epoch: 37, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.853 Test Loss: 0.552 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7944295406341553
Epoch: 38, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 39 cost time: 0.8184428215026855
Epoch: 39, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.756721019744873
Epoch: 40, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7836055755615234
Epoch: 41, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.865598201751709
Epoch: 42, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.853 Test Loss: 0.555 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.043952226638794
Epoch: 43, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.859 Test Loss: 0.551 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8126285076141357
Epoch: 44, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7683877944946289
Epoch: 45, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.558 Vali Acc: 0.866 Test Loss: 0.558 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 46 cost time: 0.6924912929534912
Epoch: 46, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.863 Test Loss: 0.557 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7683770656585693
Epoch: 47, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7018702030181885
Epoch: 48, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.866 Test Loss: 0.557 Test Acc: 0.866
Validation loss decreased (-0.865619 --> -0.865619).  Saving model ...
Epoch: 49 cost time: 0.7017266750335693
Epoch: 49, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7983677387237549
Epoch: 50, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.863 Test Loss: 0.564 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7714536190032959
Epoch: 51, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.863 Test Loss: 0.569 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7984702587127686
Epoch: 52, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.863 Test Loss: 0.568 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7790234088897705
Epoch: 53, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.859 Test Loss: 0.568 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7421684265136719
Epoch: 54, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.863 Test Loss: 0.564 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.9015293121337891
Epoch: 55, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.863 Test Loss: 0.562 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6845932006835938
Epoch: 56, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.866 Test Loss: 0.570 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7396020889282227
Epoch: 57, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.859 Test Loss: 0.577 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.6398458480834961
Epoch: 58, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.863 Test Loss: 0.575 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 235144
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3195650577545166
Epoch: 1, Steps: 8 | Train Loss: 2.206 Vali Loss: 2.053 Vali Acc: 0.212 Test Loss: 2.053 Test Acc: 0.212
Validation loss decreased (inf --> -0.212479).  Saving model ...
Epoch: 2 cost time: 0.8616483211517334
Epoch: 2, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.715 Vali Acc: 0.434 Test Loss: 1.715 Test Acc: 0.434
Validation loss decreased (-0.212479 --> -0.434358).  Saving model ...
Epoch: 3 cost time: 0.745154619216919
Epoch: 3, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.346 Vali Acc: 0.644 Test Loss: 1.346 Test Acc: 0.644
Validation loss decreased (-0.434358 --> -0.643737).  Saving model ...
Epoch: 4 cost time: 0.8382563591003418
Epoch: 4, Steps: 8 | Train Loss: 1.254 Vali Loss: 1.027 Vali Acc: 0.719 Test Loss: 1.027 Test Acc: 0.719
Validation loss decreased (-0.643737 --> -0.718740).  Saving model ...
Epoch: 5 cost time: 0.834261417388916
Epoch: 5, Steps: 8 | Train Loss: 0.921 Vali Loss: 0.801 Vali Acc: 0.778 Test Loss: 0.801 Test Acc: 0.778
Validation loss decreased (-0.718740 --> -0.778117).  Saving model ...
Epoch: 6 cost time: 0.8170204162597656
Epoch: 6, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.668 Vali Acc: 0.806 Test Loss: 0.668 Test Acc: 0.806
Validation loss decreased (-0.778117 --> -0.806243).  Saving model ...
Epoch: 7 cost time: 0.8054943084716797
Epoch: 7, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 0.746485710144043
Epoch: 8, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
Validation loss decreased (-0.815619 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.9434840679168701
Epoch: 9, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8768093585968018
Epoch: 10, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8408768177032471
Epoch: 11, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.76938796043396
Epoch: 12, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8227927684783936
Epoch: 13, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.502 Vali Acc: 0.819 Test Loss: 0.502 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7873518466949463
Epoch: 14, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.794452428817749
Epoch: 15, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.480 Vali Acc: 0.825 Test Loss: 0.480 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8282034397125244
Epoch: 16, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.481 Vali Acc: 0.831 Test Loss: 0.481 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7322859764099121
Epoch: 17, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7902262210845947
Epoch: 18, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 231048
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6651906967163086
Epoch: 1, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.537 Vali Acc: 0.503 Test Loss: 1.537 Test Acc: 0.503
Validation loss decreased (inf --> -0.503110).  Saving model ...
Epoch: 2 cost time: 1.124932050704956
Epoch: 2, Steps: 8 | Train Loss: 1.105 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
Validation loss decreased (-0.503110 --> -0.803118).  Saving model ...
Epoch: 3 cost time: 1.0733654499053955
Epoch: 3, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
Validation loss decreased (-0.803118 --> -0.824995).  Saving model ...
Epoch: 4 cost time: 1.0606517791748047
Epoch: 4, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.0833768844604492
Epoch: 5, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.604 Vali Acc: 0.834 Test Loss: 0.604 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2622394561767578
Epoch: 6, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1279516220092773
Epoch: 7, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.738 Vali Acc: 0.844 Test Loss: 0.738 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843743).  Saving model ...
Epoch: 8 cost time: 1.293527603149414
Epoch: 8, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.801 Vali Acc: 0.803 Test Loss: 0.801 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5050270557403564
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.818 Vali Acc: 0.825 Test Loss: 0.818 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3257005214691162
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4231922626495361
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.917 Vali Acc: 0.825 Test Loss: 0.917 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3661410808563232
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.952 Vali Acc: 0.831 Test Loss: 0.952 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2154717445373535
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.909 Vali Acc: 0.831 Test Loss: 0.909 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4341490268707275
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.831 Test Loss: 0.898 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.207472801208496
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.834 Test Loss: 0.910 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3794078826904297
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.941 Vali Acc: 0.834 Test Loss: 0.941 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.232372522354126
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.831 Test Loss: 0.969 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 407176
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9038913249969482
Epoch: 1, Steps: 8 | Train Loss: 2.061 Vali Loss: 1.792 Vali Acc: 0.378 Test Loss: 1.792 Test Acc: 0.378
Validation loss decreased (inf --> -0.378107).  Saving model ...
Epoch: 2 cost time: 0.9468212127685547
Epoch: 2, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.042 Vali Acc: 0.766 Test Loss: 1.042 Test Acc: 0.766
Validation loss decreased (-0.378107 --> -0.765615).  Saving model ...
Epoch: 3 cost time: 1.2652637958526611
Epoch: 3, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.648 Vali Acc: 0.794 Test Loss: 0.648 Test Acc: 0.794
Validation loss decreased (-0.765615 --> -0.793744).  Saving model ...
Epoch: 4 cost time: 1.1900930404663086
Epoch: 4, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.793744 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.2433292865753174
Epoch: 5, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1532418727874756
Epoch: 6, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2393977642059326
Epoch: 7, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0560500621795654
Epoch: 8, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.18888521194458
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0131220817565918
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0107355117797852
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1075472831726074
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.709 Vali Acc: 0.838 Test Loss: 0.709 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8509347438812256
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.748 Vali Acc: 0.831 Test Loss: 0.748 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0161488056182861
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.736 Vali Acc: 0.841 Test Loss: 0.736 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 288392
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.666703224182129
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 1.902 Vali Acc: 0.338 Test Loss: 1.902 Test Acc: 0.338
Validation loss decreased (inf --> -0.337481).  Saving model ...
Epoch: 2 cost time: 1.207810640335083
Epoch: 2, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.300 Vali Acc: 0.694 Test Loss: 1.300 Test Acc: 0.694
Validation loss decreased (-0.337481 --> -0.693737).  Saving model ...
Epoch: 3 cost time: 1.127929925918579
Epoch: 3, Steps: 8 | Train Loss: 1.022 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
Validation loss decreased (-0.693737 --> -0.809367).  Saving model ...
Epoch: 4 cost time: 1.155315637588501
Epoch: 4, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3192777633666992
Epoch: 5, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.809367 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.0826280117034912
Epoch: 6, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 1.2086632251739502
Epoch: 7, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.098449945449829
Epoch: 8, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.123291015625
Epoch: 9, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2335445880889893
Epoch: 10, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3238697052001953
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4570627212524414
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1958913803100586
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2226836681365967
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4504547119140625
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.611 Vali Acc: 0.831 Test Loss: 0.611 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2950310707092285
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.662 Vali Acc: 0.834 Test Loss: 0.662 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 249480
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.197747230529785
Epoch: 1, Steps: 8 | Train Loss: 2.305 Vali Loss: 1.917 Vali Acc: 0.266 Test Loss: 1.917 Test Acc: 0.266
Validation loss decreased (inf --> -0.265606).  Saving model ...
Epoch: 2 cost time: 0.7592403888702393
Epoch: 2, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.345 Vali Acc: 0.722 Test Loss: 1.345 Test Acc: 0.722
Validation loss decreased (-0.265606 --> -0.721862).  Saving model ...
Epoch: 3 cost time: 0.7819278240203857
Epoch: 3, Steps: 8 | Train Loss: 1.133 Vali Loss: 0.863 Vali Acc: 0.803 Test Loss: 0.863 Test Acc: 0.803
Validation loss decreased (-0.721862 --> -0.803116).  Saving model ...
Epoch: 4 cost time: 0.7069506645202637
Epoch: 4, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.630 Vali Acc: 0.816 Test Loss: 0.630 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 0.7300722599029541
Epoch: 5, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818745).  Saving model ...
Epoch: 6 cost time: 0.7540938854217529
Epoch: 6, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
Validation loss decreased (-0.818745 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.8020675182342529
Epoch: 7, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.477 Vali Acc: 0.859 Test Loss: 0.477 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.7901620864868164
Epoch: 8, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9575879573822021
Epoch: 9, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8651378154754639
Epoch: 10, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8085248470306396
Epoch: 11, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8057420253753662
Epoch: 12, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8773653507232666
Epoch: 13, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7988221645355225
Epoch: 14, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7802791595458984
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9264743328094482
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7287468910217285
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 229000
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3867359161376953
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 1.941 Vali Acc: 0.222 Test Loss: 1.941 Test Acc: 0.222
Validation loss decreased (inf --> -0.221856).  Saving model ...
Epoch: 2 cost time: 0.7584154605865479
Epoch: 2, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.517 Vali Acc: 0.600 Test Loss: 1.517 Test Acc: 0.600
Validation loss decreased (-0.221856 --> -0.599985).  Saving model ...
Epoch: 3 cost time: 0.7533292770385742
Epoch: 3, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.072 Vali Acc: 0.750 Test Loss: 1.072 Test Acc: 0.750
Validation loss decreased (-0.599985 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 0.9261751174926758
Epoch: 4, Steps: 8 | Train Loss: 0.939 Vali Loss: 0.778 Vali Acc: 0.794 Test Loss: 0.778 Test Acc: 0.794
Validation loss decreased (-0.749989 --> -0.793742).  Saving model ...
Epoch: 5 cost time: 0.8241212368011475
Epoch: 5, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.793742 --> -0.799994).  Saving model ...
Epoch: 6 cost time: 0.746877908706665
Epoch: 6, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
Validation loss decreased (-0.799994 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 0.8676776885986328
Epoch: 7, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.7989218235015869
Epoch: 8, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.8771407604217529
Epoch: 9, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.8307449817657471
Epoch: 10, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8147299289703369
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.9278354644775391
Epoch: 12, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8489964008331299
Epoch: 13, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9222702980041504
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8163645267486572
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8347315788269043
Epoch: 16, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9394657611846924
Epoch: 17, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8163683414459229
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8410251140594482
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7638194561004639
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8592407703399658
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 212616
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.442028284072876
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 1.973 Vali Acc: 0.209 Test Loss: 1.973 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 0.8850929737091064
Epoch: 2, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.619 Vali Acc: 0.478 Test Loss: 1.619 Test Acc: 0.478
Validation loss decreased (-0.209355 --> -0.478109).  Saving model ...
Epoch: 3 cost time: 0.8456020355224609
Epoch: 3, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.211 Vali Acc: 0.709 Test Loss: 1.211 Test Acc: 0.709
Validation loss decreased (-0.478109 --> -0.709363).  Saving model ...
Epoch: 4 cost time: 0.7986910343170166
Epoch: 4, Steps: 8 | Train Loss: 1.145 Vali Loss: 0.906 Vali Acc: 0.769 Test Loss: 0.906 Test Acc: 0.769
Validation loss decreased (-0.709363 --> -0.768741).  Saving model ...
Epoch: 5 cost time: 0.7667462825775146
Epoch: 5, Steps: 8 | Train Loss: 0.906 Vali Loss: 0.714 Vali Acc: 0.791 Test Loss: 0.714 Test Acc: 0.791
Validation loss decreased (-0.768741 --> -0.790618).  Saving model ...
Epoch: 6 cost time: 0.834259033203125
Epoch: 6, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
Validation loss decreased (-0.790618 --> -0.803119).  Saving model ...
Epoch: 7 cost time: 0.8039300441741943
Epoch: 7, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803120).  Saving model ...
Epoch: 8 cost time: 0.7524597644805908
Epoch: 8, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.803120 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.7620129585266113
Epoch: 9, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7738568782806396
Epoch: 10, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.7494461536407471
Epoch: 11, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.7992346286773682
Epoch: 12, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.872277021408081
Epoch: 13, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.853010892868042
Epoch: 14, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8437061309814453
Epoch: 15, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.8673429489135742
Epoch: 16, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9021637439727783
Epoch: 17, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8357646465301514
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8305048942565918
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 20 cost time: 0.7929339408874512
Epoch: 20, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7913088798522949
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8600921630859375
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8908765316009521
Epoch: 23, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.883486270904541
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 25 cost time: 0.8386068344116211
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.814671516418457
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8112452030181885
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8756768703460693
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.537 Vali Acc: 0.866 Test Loss: 0.537 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 29 cost time: 0.772458553314209
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.534 Vali Acc: 0.866 Test Loss: 0.534 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 30 cost time: 0.7888643741607666
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.528 Vali Acc: 0.866 Test Loss: 0.528 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 31 cost time: 0.8400342464447021
Epoch: 31, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8269309997558594
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9041318893432617
Epoch: 33, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8393943309783936
Epoch: 34, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.540 Vali Acc: 0.866 Test Loss: 0.540 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8941366672515869
Epoch: 35, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8180530071258545
Epoch: 36, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.866 Test Loss: 0.546 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7983195781707764
Epoch: 37, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.866 Test Loss: 0.559 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8007137775421143
Epoch: 38, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.866 Test Loss: 0.567 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.893871545791626
Epoch: 39, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.863 Test Loss: 0.562 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7900254726409912
Epoch: 40, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.555 Vali Acc: 0.863 Test Loss: 0.555 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 202248
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6181557178497314
Epoch: 1, Steps: 8 | Train Loss: 2.100 Vali Loss: 2.005 Vali Acc: 0.225 Test Loss: 2.005 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 0.9210109710693359
Epoch: 2, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.679 Vali Acc: 0.447 Test Loss: 1.679 Test Acc: 0.447
Validation loss decreased (-0.224980 --> -0.446858).  Saving model ...
Epoch: 3 cost time: 0.883587121963501
Epoch: 3, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.296 Vali Acc: 0.656 Test Loss: 1.296 Test Acc: 0.656
Validation loss decreased (-0.446858 --> -0.656237).  Saving model ...
Epoch: 4 cost time: 0.8849837779998779
Epoch: 4, Steps: 8 | Train Loss: 1.158 Vali Loss: 0.986 Vali Acc: 0.744 Test Loss: 0.986 Test Acc: 0.744
Validation loss decreased (-0.656237 --> -0.743740).  Saving model ...
Epoch: 5 cost time: 0.8635640144348145
Epoch: 5, Steps: 8 | Train Loss: 0.896 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
Validation loss decreased (-0.743740 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 0.8058998584747314
Epoch: 6, Steps: 8 | Train Loss: 0.689 Vali Loss: 0.672 Vali Acc: 0.787 Test Loss: 0.672 Test Acc: 0.787
Validation loss decreased (-0.774992 --> -0.787493).  Saving model ...
Epoch: 7 cost time: 0.9373207092285156
Epoch: 7, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.603 Vali Acc: 0.797 Test Loss: 0.603 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796869).  Saving model ...
Epoch: 8 cost time: 0.8983232975006104
Epoch: 8, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
Validation loss decreased (-0.796869 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.9451484680175781
Epoch: 9, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 0.8146240711212158
Epoch: 10, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7238731384277344
Epoch: 11, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.8902246952056885
Epoch: 12, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 13 cost time: 0.8915345668792725
Epoch: 13, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.496 Vali Acc: 0.828 Test Loss: 0.496 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 0.8964049816131592
Epoch: 14, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8829081058502197
Epoch: 15, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.480 Vali Acc: 0.825 Test Loss: 0.480 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.913825273513794
Epoch: 16, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.489 Vali Acc: 0.828 Test Loss: 0.489 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 17 cost time: 0.916344404220581
Epoch: 17, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.857250452041626
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 19 cost time: 0.8496551513671875
Epoch: 19, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 20 cost time: 0.8321535587310791
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.474 Vali Acc: 0.834 Test Loss: 0.474 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9097092151641846
Epoch: 21, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8776779174804688
Epoch: 22, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9012308120727539
Epoch: 23, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.488 Vali Acc: 0.831 Test Loss: 0.488 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8982987403869629
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7420754432678223
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.841456413269043
Epoch: 26, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8700098991394043
Epoch: 27, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 28 cost time: 0.8961384296417236
Epoch: 28, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 0.9703047275543213
Epoch: 29, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.9760355949401855
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.84407639503479
Epoch: 31, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0413625240325928
Epoch: 32, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9080784320831299
Epoch: 33, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9812462329864502
Epoch: 34, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0568699836730957
Epoch: 35, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9796862602233887
Epoch: 36, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.004770040512085
Epoch: 37, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.984015703201294
Epoch: 38, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.058063268661499
Epoch: 39, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm128_nh16_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 198152
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4957447052001953
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 1.713 Vali Acc: 0.491 Test Loss: 1.713 Test Acc: 0.491
Validation loss decreased (inf --> -0.490608).  Saving model ...
Epoch: 2 cost time: 1.6701085567474365
Epoch: 2, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.023 Vali Acc: 0.781 Test Loss: 1.023 Test Acc: 0.781
Validation loss decreased (-0.490608 --> -0.781240).  Saving model ...
Epoch: 3 cost time: 1.537994623184204
Epoch: 3, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.633 Vali Acc: 0.806 Test Loss: 0.633 Test Acc: 0.806
Validation loss decreased (-0.781240 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 1.1679465770721436
Epoch: 4, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.538 Vali Acc: 0.819 Test Loss: 0.538 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818745).  Saving model ...
Epoch: 5 cost time: 1.724851369857788
Epoch: 5, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
Validation loss decreased (-0.818745 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.7995879650115967
Epoch: 6, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.6901519298553467
Epoch: 7, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6351380348205566
Epoch: 8, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7695178985595703
Epoch: 9, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 10 cost time: 1.7557837963104248
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8466100692749023
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.654 Vali Acc: 0.834 Test Loss: 0.654 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5147292613983154
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7896554470062256
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.698 Vali Acc: 0.844 Test Loss: 0.698 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.759453296661377
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.746 Vali Acc: 0.828 Test Loss: 0.746 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8584439754486084
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.729 Vali Acc: 0.834 Test Loss: 0.729 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.727950096130371
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.730 Vali Acc: 0.844 Test Loss: 0.730 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.454563856124878
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.750 Vali Acc: 0.841 Test Loss: 0.750 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2798793315887451
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.767 Vali Acc: 0.838 Test Loss: 0.767 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2368292808532715
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.770 Vali Acc: 0.838 Test Loss: 0.770 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 220424
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5191752910614014
Epoch: 1, Steps: 8 | Train Loss: 2.081 Vali Loss: 1.928 Vali Acc: 0.209 Test Loss: 1.928 Test Acc: 0.209
Validation loss decreased (inf --> -0.209356).  Saving model ...
Epoch: 2 cost time: 1.0082628726959229
Epoch: 2, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.473 Vali Acc: 0.553 Test Loss: 1.473 Test Acc: 0.553
Validation loss decreased (-0.209356 --> -0.553110).  Saving model ...
Epoch: 3 cost time: 0.942547082901001
Epoch: 3, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.004 Vali Acc: 0.747 Test Loss: 1.004 Test Acc: 0.747
Validation loss decreased (-0.553110 --> -0.746865).  Saving model ...
Epoch: 4 cost time: 0.9518048763275146
Epoch: 4, Steps: 8 | Train Loss: 0.819 Vali Loss: 0.735 Vali Acc: 0.794 Test Loss: 0.735 Test Acc: 0.794
Validation loss decreased (-0.746865 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 1.0763342380523682
Epoch: 5, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.9700431823730469
Epoch: 6, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 1.0629510879516602
Epoch: 7, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 1.1488540172576904
Epoch: 8, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9704742431640625
Epoch: 9, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9730033874511719
Epoch: 10, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0503692626953125
Epoch: 11, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9496190547943115
Epoch: 12, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.04604172706604
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.592 Vali Acc: 0.828 Test Loss: 0.592 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.110196590423584
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.645 Vali Acc: 0.812 Test Loss: 0.645 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1831247806549072
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.679 Vali Acc: 0.825 Test Loss: 0.679 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.032515048980713
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.668 Vali Acc: 0.834 Test Loss: 0.668 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834368).  Saving model ...
Epoch: 17 cost time: 1.0329160690307617
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0116145610809326
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1180291175842285
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0900280475616455
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0412790775299072
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.685 Vali Acc: 0.828 Test Loss: 0.685 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9809896945953369
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0027515888214111
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0647897720336914
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.828 Test Loss: 0.704 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0806925296783447
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.825 Test Loss: 0.704 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.995715856552124
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 161032
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7449872493743896
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.921 Vali Acc: 0.328 Test Loss: 1.921 Test Acc: 0.328
Validation loss decreased (inf --> -0.328106).  Saving model ...
Epoch: 2 cost time: 0.8406565189361572
Epoch: 2, Steps: 8 | Train Loss: 1.806 Vali Loss: 1.583 Vali Acc: 0.575 Test Loss: 1.583 Test Acc: 0.575
Validation loss decreased (-0.328106 --> -0.574984).  Saving model ...
Epoch: 3 cost time: 0.8992955684661865
Epoch: 3, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.204 Vali Acc: 0.734 Test Loss: 1.204 Test Acc: 0.734
Validation loss decreased (-0.574984 --> -0.734363).  Saving model ...
Epoch: 4 cost time: 0.8176906108856201
Epoch: 4, Steps: 8 | Train Loss: 1.071 Vali Loss: 0.893 Vali Acc: 0.784 Test Loss: 0.893 Test Acc: 0.784
Validation loss decreased (-0.734363 --> -0.784366).  Saving model ...
Epoch: 5 cost time: 0.8729581832885742
Epoch: 5, Steps: 8 | Train Loss: 0.739 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
Validation loss decreased (-0.784366 --> -0.793743).  Saving model ...
Epoch: 6 cost time: 0.9022345542907715
Epoch: 6, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
Validation loss decreased (-0.793743 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 0.932295560836792
Epoch: 7, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 0.8469886779785156
Epoch: 8, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.9831414222717285
Epoch: 9, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.824995 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 1.1297645568847656
Epoch: 10, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9661662578582764
Epoch: 11, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9441845417022705
Epoch: 12, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9196014404296875
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1054589748382568
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0681803226470947
Epoch: 15, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9996914863586426
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8853795528411865
Epoch: 17, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9779171943664551
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9578986167907715
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 141576
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.738234043121338
Epoch: 1, Steps: 8 | Train Loss: 2.298 Vali Loss: 2.068 Vali Acc: 0.191 Test Loss: 2.068 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 0.9518716335296631
Epoch: 2, Steps: 8 | Train Loss: 2.040 Vali Loss: 1.732 Vali Acc: 0.447 Test Loss: 1.732 Test Acc: 0.447
Validation loss decreased (-0.190604 --> -0.446858).  Saving model ...
Epoch: 3 cost time: 0.7791812419891357
Epoch: 3, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.352 Vali Acc: 0.675 Test Loss: 1.352 Test Acc: 0.675
Validation loss decreased (-0.446858 --> -0.674986).  Saving model ...
Epoch: 4 cost time: 0.9087991714477539
Epoch: 4, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.026 Vali Acc: 0.753 Test Loss: 1.026 Test Acc: 0.753
Validation loss decreased (-0.674986 --> -0.753115).  Saving model ...
Epoch: 5 cost time: 1.0099382400512695
Epoch: 5, Steps: 8 | Train Loss: 0.906 Vali Loss: 0.794 Vali Acc: 0.791 Test Loss: 0.794 Test Acc: 0.791
Validation loss decreased (-0.753115 --> -0.790617).  Saving model ...
Epoch: 6 cost time: 0.9956884384155273
Epoch: 6, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.647 Vali Acc: 0.806 Test Loss: 0.647 Test Acc: 0.806
Validation loss decreased (-0.790617 --> -0.806244).  Saving model ...
Epoch: 7 cost time: 0.9512581825256348
Epoch: 7, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 0.8900659084320068
Epoch: 8, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818745).  Saving model ...
Epoch: 9 cost time: 1.017136573791504
Epoch: 9, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
Validation loss decreased (-0.818745 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.9950652122497559
Epoch: 10, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0077977180480957
Epoch: 11, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.497 Vali Acc: 0.828 Test Loss: 0.497 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9217369556427002
Epoch: 12, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8299353122711182
Epoch: 13, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8893585205078125
Epoch: 14, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.9528012275695801
Epoch: 15, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8724920749664307
Epoch: 16, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.9188997745513916
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8531627655029297
Epoch: 18, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9680345058441162
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0053718090057373
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8764288425445557
Epoch: 21, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.977043867111206
Epoch: 22, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9437341690063477
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9648418426513672
Epoch: 24, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9552040100097656
Epoch: 25, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0036070346832275
Epoch: 26, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 131336
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4916727542877197
Epoch: 1, Steps: 8 | Train Loss: 2.085 Vali Loss: 1.951 Vali Acc: 0.256 Test Loss: 1.951 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 0.8900883197784424
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.662 Vali Acc: 0.509 Test Loss: 1.662 Test Acc: 0.509
Validation loss decreased (-0.256230 --> -0.509358).  Saving model ...
Epoch: 3 cost time: 0.8984854221343994
Epoch: 3, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.330 Vali Acc: 0.703 Test Loss: 1.330 Test Acc: 0.703
Validation loss decreased (-0.509358 --> -0.703112).  Saving model ...
Epoch: 4 cost time: 0.9592053890228271
Epoch: 4, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.035 Vali Acc: 0.784 Test Loss: 1.035 Test Acc: 0.784
Validation loss decreased (-0.703112 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 0.8546669483184814
Epoch: 5, Steps: 8 | Train Loss: 0.966 Vali Loss: 0.816 Vali Acc: 0.787 Test Loss: 0.816 Test Acc: 0.787
Validation loss decreased (-0.784365 --> -0.787492).  Saving model ...
Epoch: 6 cost time: 0.8946337699890137
Epoch: 6, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.670 Vali Acc: 0.791 Test Loss: 0.670 Test Acc: 0.791
Validation loss decreased (-0.787492 --> -0.790618).  Saving model ...
Epoch: 7 cost time: 0.9171242713928223
Epoch: 7, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.790618 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 1.016728162765503
Epoch: 8, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.9806623458862305
Epoch: 9, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9583971500396729
Epoch: 10, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 11 cost time: 0.8842082023620605
Epoch: 11, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8929533958435059
Epoch: 12, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.481 Vali Acc: 0.828 Test Loss: 0.481 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 0.9478549957275391
Epoch: 13, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.489 Vali Acc: 0.825 Test Loss: 0.489 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8225476741790771
Epoch: 14, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8728532791137695
Epoch: 15, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.488 Vali Acc: 0.825 Test Loss: 0.488 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8666558265686035
Epoch: 16, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.487 Vali Acc: 0.825 Test Loss: 0.487 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8823513984680176
Epoch: 17, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9707117080688477
Epoch: 18, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8995599746704102
Epoch: 19, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.485 Vali Acc: 0.828 Test Loss: 0.485 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8363022804260254
Epoch: 20, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 0.9660189151763916
Epoch: 21, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.497 Vali Acc: 0.825 Test Loss: 0.497 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9372560977935791
Epoch: 22, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9085044860839844
Epoch: 23, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 24 cost time: 0.8385169506072998
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.9015381336212158
Epoch: 25, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0273566246032715
Epoch: 26, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8398237228393555
Epoch: 27, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 28 cost time: 0.8264484405517578
Epoch: 28, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 29 cost time: 0.8572490215301514
Epoch: 29, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8487732410430908
Epoch: 30, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.841158390045166
Epoch: 31, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.816871166229248
Epoch: 32, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9176657199859619
Epoch: 33, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9091906547546387
Epoch: 34, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8899452686309814
Epoch: 35, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8616423606872559
Epoch: 36, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9622266292572021
Epoch: 37, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9508876800537109
Epoch: 38, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 123144
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4799275398254395
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 2.037 Vali Acc: 0.163 Test Loss: 2.037 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 0.9681589603424072
Epoch: 2, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.830 Vali Acc: 0.322 Test Loss: 1.830 Test Acc: 0.322
Validation loss decreased (-0.162480 --> -0.321857).  Saving model ...
Epoch: 3 cost time: 0.9425563812255859
Epoch: 3, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.549 Vali Acc: 0.531 Test Loss: 1.549 Test Acc: 0.531
Validation loss decreased (-0.321857 --> -0.531235).  Saving model ...
Epoch: 4 cost time: 0.9142920970916748
Epoch: 4, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.259 Vali Acc: 0.700 Test Loss: 1.259 Test Acc: 0.700
Validation loss decreased (-0.531235 --> -0.699987).  Saving model ...
Epoch: 5 cost time: 0.9411256313323975
Epoch: 5, Steps: 8 | Train Loss: 1.164 Vali Loss: 1.018 Vali Acc: 0.762 Test Loss: 1.018 Test Acc: 0.762
Validation loss decreased (-0.699987 --> -0.762490).  Saving model ...
Epoch: 6 cost time: 0.9584589004516602
Epoch: 6, Steps: 8 | Train Loss: 0.999 Vali Loss: 0.855 Vali Acc: 0.756 Test Loss: 0.855 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8642373085021973
Epoch: 7, Steps: 8 | Train Loss: 0.789 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.762490 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.8797574043273926
Epoch: 8, Steps: 8 | Train Loss: 0.624 Vali Loss: 0.655 Vali Acc: 0.797 Test Loss: 0.655 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9107670783996582
Epoch: 9, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.9172744750976562
Epoch: 10, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815620).  Saving model ...
Epoch: 11 cost time: 0.9419300556182861
Epoch: 11, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
Validation loss decreased (-0.815620 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.8377425670623779
Epoch: 12, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9257569313049316
Epoch: 13, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.497 Vali Acc: 0.828 Test Loss: 0.497 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 0.7797145843505859
Epoch: 14, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.488 Vali Acc: 0.828 Test Loss: 0.488 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 15 cost time: 0.8394381999969482
Epoch: 15, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8626565933227539
Epoch: 16, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.729865312576294
Epoch: 17, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7206435203552246
Epoch: 18, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.482 Vali Acc: 0.828 Test Loss: 0.482 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 19 cost time: 0.7509555816650391
Epoch: 19, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 0.7223365306854248
Epoch: 20, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9013111591339111
Epoch: 21, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7638938426971436
Epoch: 22, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8994104862213135
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 24 cost time: 0.8463795185089111
Epoch: 24, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7554137706756592
Epoch: 25, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9183614253997803
Epoch: 26, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.818009614944458
Epoch: 27, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8749468326568604
Epoch: 28, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7921664714813232
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8425874710083008
Epoch: 30, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9147284030914307
Epoch: 31, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 0.8270401954650879
Epoch: 32, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7286868095397949
Epoch: 33, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9583094120025635
Epoch: 34, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8799419403076172
Epoch: 35, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8948285579681396
Epoch: 36, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8596019744873047
Epoch: 37, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8936219215393066
Epoch: 38, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9991860389709473
Epoch: 39, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 0.7962172031402588
Epoch: 40, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 41 cost time: 0.878352165222168
Epoch: 41, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 42 cost time: 0.7646591663360596
Epoch: 42, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7864537239074707
Epoch: 43, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8254904747009277
Epoch: 44, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8389718532562256
Epoch: 45, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 46 cost time: 0.7433876991271973
Epoch: 46, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7973387241363525
Epoch: 47, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 48 cost time: 0.8004856109619141
Epoch: 48, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.517 Vali Acc: 0.853 Test Loss: 0.517 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0416030883789062
Epoch: 49, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8302831649780273
Epoch: 50, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9236688613891602
Epoch: 51, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 52 cost time: 0.8430588245391846
Epoch: 52, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 53 cost time: 0.8592529296875
Epoch: 53, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8068792819976807
Epoch: 54, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9338357448577881
Epoch: 55, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.859 Test Loss: 0.532 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8549520969390869
Epoch: 56, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 57 cost time: 0.8844177722930908
Epoch: 57, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 58 cost time: 0.8246209621429443
Epoch: 58, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.524 Vali Acc: 0.859 Test Loss: 0.524 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 59 cost time: 0.8095703125
Epoch: 59, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7994167804718018
Epoch: 60, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8610241413116455
Epoch: 61, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9020488262176514
Epoch: 62, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8804500102996826
Epoch: 63, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9611589908599854
Epoch: 64, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8459396362304688
Epoch: 65, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.8875942230224609
Epoch: 66, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.9369957447052002
Epoch: 67, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 68 cost time: 0.8453867435455322
Epoch: 68, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8526113033294678
Epoch: 69, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8393054008483887
Epoch: 70, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8583927154541016
Epoch: 71, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9014739990234375
Epoch: 72, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.859 Test Loss: 0.541 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.8960056304931641
Epoch: 73, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.8785514831542969
Epoch: 74, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7989816665649414
Epoch: 75, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.863 Test Loss: 0.547 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.8606750965118408
Epoch: 76, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.866 Test Loss: 0.550 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 77 cost time: 0.7700176239013672
Epoch: 77, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.866 Test Loss: 0.546 Test Acc: 0.866
Validation loss decreased (-0.865619 --> -0.865620).  Saving model ...
Epoch: 78 cost time: 0.7669227123260498
Epoch: 78, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.866 Test Loss: 0.549 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7916946411132812
Epoch: 79, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8782520294189453
Epoch: 80, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.863 Test Loss: 0.546 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.8508753776550293
Epoch: 81, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.863 Test Loss: 0.552 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.8138222694396973
Epoch: 82, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.866 Test Loss: 0.562 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.8560378551483154
Epoch: 83, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.866 Test Loss: 0.558 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.864609956741333
Epoch: 84, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.869 Test Loss: 0.556 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868744).  Saving model ...
Epoch: 85 cost time: 0.8814554214477539
Epoch: 85, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.869 Test Loss: 0.550 Test Acc: 0.869
Validation loss decreased (-0.868744 --> -0.868745).  Saving model ...
Epoch: 86 cost time: 0.928849458694458
Epoch: 86, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.866 Test Loss: 0.543 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.9060957431793213
Epoch: 87, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.866 Test Loss: 0.543 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.9450156688690186
Epoch: 88, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.866 Test Loss: 0.546 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.8255512714385986
Epoch: 89, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.866 Test Loss: 0.547 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.9102177619934082
Epoch: 90, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.866 Test Loss: 0.553 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.8527092933654785
Epoch: 91, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.866 Test Loss: 0.561 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.8337490558624268
Epoch: 92, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.869 Test Loss: 0.563 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.8768975734710693
Epoch: 93, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.869 Test Loss: 0.561 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.8019101619720459
Epoch: 94, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.8309962749481201
Epoch: 95, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.866 Test Loss: 0.554 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 117960
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5505247116088867
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.016 Vali Acc: 0.212 Test Loss: 2.016 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.95992112159729
Epoch: 2, Steps: 8 | Train Loss: 2.000 Vali Loss: 1.817 Vali Acc: 0.362 Test Loss: 1.817 Test Acc: 0.362
Validation loss decreased (-0.212480 --> -0.362482).  Saving model ...
Epoch: 3 cost time: 1.014800786972046
Epoch: 3, Steps: 8 | Train Loss: 1.735 Vali Loss: 1.564 Vali Acc: 0.547 Test Loss: 1.564 Test Acc: 0.547
Validation loss decreased (-0.362482 --> -0.546859).  Saving model ...
Epoch: 4 cost time: 0.9530456066131592
Epoch: 4, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.310 Vali Acc: 0.684 Test Loss: 1.310 Test Acc: 0.684
Validation loss decreased (-0.546859 --> -0.684362).  Saving model ...
Epoch: 5 cost time: 0.936516284942627
Epoch: 5, Steps: 8 | Train Loss: 1.184 Vali Loss: 1.099 Vali Acc: 0.741 Test Loss: 1.099 Test Acc: 0.741
Validation loss decreased (-0.684362 --> -0.740614).  Saving model ...
Epoch: 6 cost time: 0.9135689735412598
Epoch: 6, Steps: 8 | Train Loss: 1.029 Vali Loss: 0.934 Vali Acc: 0.759 Test Loss: 0.934 Test Acc: 0.759
Validation loss decreased (-0.740614 --> -0.759366).  Saving model ...
Epoch: 7 cost time: 0.8880341053009033
Epoch: 7, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.759366 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 0.9396378993988037
Epoch: 8, Steps: 8 | Train Loss: 0.703 Vali Loss: 0.723 Vali Acc: 0.775 Test Loss: 0.723 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 9 cost time: 0.9300026893615723
Epoch: 9, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.656 Vali Acc: 0.794 Test Loss: 0.656 Test Acc: 0.794
Validation loss decreased (-0.774993 --> -0.793743).  Saving model ...
Epoch: 10 cost time: 0.9335176944732666
Epoch: 10, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803119).  Saving model ...
Epoch: 11 cost time: 0.7302522659301758
Epoch: 11, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 12 cost time: 0.9398040771484375
Epoch: 12, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.8640294075012207
Epoch: 13, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 14 cost time: 0.8989667892456055
Epoch: 14, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 0.8348374366760254
Epoch: 15, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9328811168670654
Epoch: 16, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 17 cost time: 0.9084513187408447
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.950298547744751
Epoch: 18, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 19 cost time: 0.8507504463195801
Epoch: 19, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9428706169128418
Epoch: 20, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 21 cost time: 0.7829899787902832
Epoch: 21, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 22 cost time: 1.006218433380127
Epoch: 22, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9913074970245361
Epoch: 23, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 24 cost time: 0.9763951301574707
Epoch: 24, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 0.9323067665100098
Epoch: 25, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8848836421966553
Epoch: 26, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9780805110931396
Epoch: 27, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 28 cost time: 0.953620433807373
Epoch: 28, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8595919609069824
Epoch: 29, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.7945191860198975
Epoch: 30, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8529872894287109
Epoch: 31, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 0.9603393077850342
Epoch: 32, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9253735542297363
Epoch: 33, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9039957523345947
Epoch: 34, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 35 cost time: 0.7879493236541748
Epoch: 35, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 36 cost time: 0.9761807918548584
Epoch: 36, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 37 cost time: 0.892411470413208
Epoch: 37, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 38 cost time: 0.8695907592773438
Epoch: 38, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.454 Vali Acc: 0.866 Test Loss: 0.454 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 39 cost time: 0.9861974716186523
Epoch: 39, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 40 cost time: 0.8251802921295166
Epoch: 40, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9975326061248779
Epoch: 41, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.458 Vali Acc: 0.866 Test Loss: 0.458 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9302706718444824
Epoch: 42, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9210546016693115
Epoch: 43, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9595026969909668
Epoch: 44, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.465 Vali Acc: 0.866 Test Loss: 0.465 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7739846706390381
Epoch: 45, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 46 cost time: 0.9218647480010986
Epoch: 46, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.869 Test Loss: 0.465 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9454178810119629
Epoch: 47, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.468 Vali Acc: 0.869 Test Loss: 0.468 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9304087162017822
Epoch: 48, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.469 Vali Acc: 0.869 Test Loss: 0.469 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8839514255523682
Epoch: 49, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.468 Vali Acc: 0.869 Test Loss: 0.468 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.84432053565979
Epoch: 50, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9118449687957764
Epoch: 51, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.473 Vali Acc: 0.869 Test Loss: 0.473 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9080545902252197
Epoch: 52, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 0.9451055526733398
Epoch: 53, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.468 Vali Acc: 0.878 Test Loss: 0.468 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 54 cost time: 0.938206672668457
Epoch: 54, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
Validation loss decreased (-0.878120 --> -0.878120).  Saving model ...
Epoch: 55 cost time: 0.9092628955841064
Epoch: 55, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9056119918823242
Epoch: 56, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
Validation loss decreased (-0.878120 --> -0.878120).  Saving model ...
Epoch: 57 cost time: 0.8785102367401123
Epoch: 57, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.899789571762085
Epoch: 58, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9245436191558838
Epoch: 59, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.476 Vali Acc: 0.869 Test Loss: 0.476 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8060300350189209
Epoch: 60, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.472 Vali Acc: 0.866 Test Loss: 0.472 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9692480564117432
Epoch: 61, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.470 Vali Acc: 0.872 Test Loss: 0.470 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9826252460479736
Epoch: 62, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.8826384544372559
Epoch: 63, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.8732447624206543
Epoch: 64, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.9305005073547363
Epoch: 65, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.8615779876708984
Epoch: 66, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 115912
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0655267238616943
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 1.768 Vali Acc: 0.406 Test Loss: 1.768 Test Acc: 0.406
Validation loss decreased (inf --> -0.406232).  Saving model ...
Epoch: 2 cost time: 1.2138636112213135
Epoch: 2, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.039 Vali Acc: 0.738 Test Loss: 1.039 Test Acc: 0.738
Validation loss decreased (-0.406232 --> -0.737490).  Saving model ...
Epoch: 3 cost time: 1.301245927810669
Epoch: 3, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
Validation loss decreased (-0.737490 --> -0.803118).  Saving model ...
Epoch: 4 cost time: 1.3178300857543945
Epoch: 4, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
Validation loss decreased (-0.803118 --> -0.818745).  Saving model ...
Epoch: 5 cost time: 1.2015492916107178
Epoch: 5, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
Validation loss decreased (-0.818745 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.4234802722930908
Epoch: 6, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.455263376235962
Epoch: 7, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.099172592163086
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.581 Vali Acc: 0.838 Test Loss: 0.581 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5586726665496826
Epoch: 9, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.633 Vali Acc: 0.831 Test Loss: 0.633 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3655436038970947
Epoch: 10, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4715502262115479
Epoch: 11, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4325008392333984
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.686 Vali Acc: 0.834 Test Loss: 0.686 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6353349685668945
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.774 Vali Acc: 0.834 Test Loss: 0.774 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3958454132080078
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.779 Vali Acc: 0.834 Test Loss: 0.779 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.630854606628418
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.754 Vali Acc: 0.841 Test Loss: 0.754 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.525031328201294
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.760 Vali Acc: 0.838 Test Loss: 0.760 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4371016025543213
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.776 Vali Acc: 0.838 Test Loss: 0.776 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 187400
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.293095111846924
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 1.884 Vali Acc: 0.341 Test Loss: 1.884 Test Acc: 0.341
Validation loss decreased (inf --> -0.340606).  Saving model ...
Epoch: 2 cost time: 0.8696532249450684
Epoch: 2, Steps: 8 | Train Loss: 1.752 Vali Loss: 1.448 Vali Acc: 0.656 Test Loss: 1.448 Test Acc: 0.656
Validation loss decreased (-0.340606 --> -0.656236).  Saving model ...
Epoch: 3 cost time: 0.8876969814300537
Epoch: 3, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.011 Vali Acc: 0.756 Test Loss: 1.011 Test Acc: 0.756
Validation loss decreased (-0.656236 --> -0.756240).  Saving model ...
Epoch: 4 cost time: 0.756178617477417
Epoch: 4, Steps: 8 | Train Loss: 0.950 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
Validation loss decreased (-0.756240 --> -0.774993).  Saving model ...
Epoch: 5 cost time: 1.016660451889038
Epoch: 5, Steps: 8 | Train Loss: 0.621 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
Validation loss decreased (-0.774993 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.9218082427978516
Epoch: 6, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
Validation loss decreased (-0.812494 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.8611185550689697
Epoch: 7, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9001479148864746
Epoch: 8, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9251224994659424
Epoch: 9, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8995168209075928
Epoch: 10, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8959612846374512
Epoch: 11, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8370218276977539
Epoch: 12, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9735677242279053
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9254410266876221
Epoch: 14, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.840383768081665
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.610 Vali Acc: 0.831 Test Loss: 0.610 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8074874877929688
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.641 Vali Acc: 0.831 Test Loss: 0.641 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 128008
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4507405757904053
Epoch: 1, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.894 Vali Acc: 0.331 Test Loss: 1.894 Test Acc: 0.331
Validation loss decreased (inf --> -0.331231).  Saving model ...
Epoch: 2 cost time: 0.8558022975921631
Epoch: 2, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.580 Vali Acc: 0.641 Test Loss: 1.580 Test Acc: 0.641
Validation loss decreased (-0.331231 --> -0.640609).  Saving model ...
Epoch: 3 cost time: 0.9148921966552734
Epoch: 3, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.211 Vali Acc: 0.756 Test Loss: 1.211 Test Acc: 0.756
Validation loss decreased (-0.640609 --> -0.756238).  Saving model ...
Epoch: 4 cost time: 0.8937013149261475
Epoch: 4, Steps: 8 | Train Loss: 1.068 Vali Loss: 0.901 Vali Acc: 0.781 Test Loss: 0.901 Test Acc: 0.781
Validation loss decreased (-0.756238 --> -0.781241).  Saving model ...
Epoch: 5 cost time: 0.8524258136749268
Epoch: 5, Steps: 8 | Train Loss: 0.787 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
Validation loss decreased (-0.781241 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 0.8236250877380371
Epoch: 6, Steps: 8 | Train Loss: 0.594 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.9534351825714111
Epoch: 7, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.824994 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.8463633060455322
Epoch: 8, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9267604351043701
Epoch: 9, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8260552883148193
Epoch: 10, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.013413906097412
Epoch: 11, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.481 Vali Acc: 0.866 Test Loss: 0.481 Test Acc: 0.866
Validation loss decreased (-0.843745 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 0.8021872043609619
Epoch: 12, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9066629409790039
Epoch: 13, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8752577304840088
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8313636779785156
Epoch: 15, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8902678489685059
Epoch: 16, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9113280773162842
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8839461803436279
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8615036010742188
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8885421752929688
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9810614585876465
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.590 Vali Acc: 0.838 Test Loss: 0.590 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 108552
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.500293016433716
Epoch: 1, Steps: 8 | Train Loss: 2.261 Vali Loss: 2.005 Vali Acc: 0.206 Test Loss: 2.005 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 0.7838878631591797
Epoch: 2, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.701 Vali Acc: 0.503 Test Loss: 1.701 Test Acc: 0.503
Validation loss decreased (-0.206230 --> -0.503108).  Saving model ...
Epoch: 3 cost time: 0.9614613056182861
Epoch: 3, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.328 Vali Acc: 0.703 Test Loss: 1.328 Test Acc: 0.703
Validation loss decreased (-0.503108 --> -0.703112).  Saving model ...
Epoch: 4 cost time: 0.9063377380371094
Epoch: 4, Steps: 8 | Train Loss: 1.202 Vali Loss: 1.005 Vali Acc: 0.766 Test Loss: 1.005 Test Acc: 0.766
Validation loss decreased (-0.703112 --> -0.765615).  Saving model ...
Epoch: 5 cost time: 0.8881075382232666
Epoch: 5, Steps: 8 | Train Loss: 0.901 Vali Loss: 0.779 Vali Acc: 0.784 Test Loss: 0.779 Test Acc: 0.784
Validation loss decreased (-0.765615 --> -0.784367).  Saving model ...
Epoch: 6 cost time: 0.8306193351745605
Epoch: 6, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.640 Vali Acc: 0.797 Test Loss: 0.640 Test Acc: 0.797
Validation loss decreased (-0.784367 --> -0.796869).  Saving model ...
Epoch: 7 cost time: 0.884768009185791
Epoch: 7, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
Validation loss decreased (-0.796869 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 0.7991311550140381
Epoch: 8, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.546 Vali Acc: 0.806 Test Loss: 0.546 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.806245).  Saving model ...
Epoch: 9 cost time: 0.7517166137695312
Epoch: 9, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.806245 --> -0.809370).  Saving model ...
Epoch: 10 cost time: 0.8073089122772217
Epoch: 10, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.809370 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.7754435539245605
Epoch: 11, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8590035438537598
Epoch: 12, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 0.8859074115753174
Epoch: 13, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9847762584686279
Epoch: 14, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9787564277648926
Epoch: 15, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 0.9596071243286133
Epoch: 16, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7908275127410889
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8517155647277832
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8041646480560303
Epoch: 19, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9193143844604492
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7048740386962891
Epoch: 21, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8587779998779297
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8389337062835693
Epoch: 23, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7594516277313232
Epoch: 24, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8372783660888672
Epoch: 25, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 98312
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5744521617889404
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.062 Vali Acc: 0.184 Test Loss: 2.062 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 0.921027421951294
Epoch: 2, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.814 Vali Acc: 0.284 Test Loss: 1.814 Test Acc: 0.284
Validation loss decreased (-0.184354 --> -0.284357).  Saving model ...
Epoch: 3 cost time: 0.8438212871551514
Epoch: 3, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.502 Vali Acc: 0.547 Test Loss: 1.502 Test Acc: 0.547
Validation loss decreased (-0.284357 --> -0.546860).  Saving model ...
Epoch: 4 cost time: 0.7669785022735596
Epoch: 4, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.194 Vali Acc: 0.713 Test Loss: 1.194 Test Acc: 0.713
Validation loss decreased (-0.546860 --> -0.712488).  Saving model ...
Epoch: 5 cost time: 0.9031109809875488
Epoch: 5, Steps: 8 | Train Loss: 1.048 Vali Loss: 0.947 Vali Acc: 0.769 Test Loss: 0.947 Test Acc: 0.769
Validation loss decreased (-0.712488 --> -0.768741).  Saving model ...
Epoch: 6 cost time: 0.8215715885162354
Epoch: 6, Steps: 8 | Train Loss: 0.852 Vali Loss: 0.768 Vali Acc: 0.803 Test Loss: 0.768 Test Acc: 0.803
Validation loss decreased (-0.768741 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.8956403732299805
Epoch: 7, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
Validation loss decreased (-0.803117 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 0.7743310928344727
Epoch: 8, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.9545609951019287
Epoch: 9, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821870).  Saving model ...
Epoch: 10 cost time: 0.998399019241333
Epoch: 10, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8828637599945068
Epoch: 11, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.502 Vali Acc: 0.828 Test Loss: 0.502 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 12 cost time: 0.9001479148864746
Epoch: 12, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 0.8779103755950928
Epoch: 13, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8794276714324951
Epoch: 14, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8851206302642822
Epoch: 15, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 0.8614840507507324
Epoch: 16, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9790480136871338
Epoch: 17, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8540997505187988
Epoch: 18, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9035608768463135
Epoch: 19, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9854137897491455
Epoch: 20, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9208154678344727
Epoch: 21, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9002408981323242
Epoch: 22, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8778285980224609
Epoch: 23, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8835756778717041
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.508 Vali Acc: 0.859 Test Loss: 0.508 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 25 cost time: 0.8259894847869873
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 26 cost time: 0.8611340522766113
Epoch: 26, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8353540897369385
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.524 Vali Acc: 0.847 Test Loss: 0.524 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9305405616760254
Epoch: 28, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7946443557739258
Epoch: 29, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9151277542114258
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8687689304351807
Epoch: 31, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.534 Vali Acc: 0.863 Test Loss: 0.534 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9461498260498047
Epoch: 32, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7020094394683838
Epoch: 33, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8925716876983643
Epoch: 34, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6694748401641846
Epoch: 35, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 90120
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3043415546417236
Epoch: 1, Steps: 8 | Train Loss: 2.285 Vali Loss: 2.133 Vali Acc: 0.134 Test Loss: 2.133 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 0.8001713752746582
Epoch: 2, Steps: 8 | Train Loss: 2.172 Vali Loss: 1.927 Vali Acc: 0.278 Test Loss: 1.927 Test Acc: 0.278
Validation loss decreased (-0.134354 --> -0.278106).  Saving model ...
Epoch: 3 cost time: 0.7873196601867676
Epoch: 3, Steps: 8 | Train Loss: 1.911 Vali Loss: 1.652 Vali Acc: 0.469 Test Loss: 1.652 Test Acc: 0.469
Validation loss decreased (-0.278106 --> -0.468733).  Saving model ...
Epoch: 4 cost time: 0.8511106967926025
Epoch: 4, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.368 Vali Acc: 0.619 Test Loss: 1.368 Test Acc: 0.619
Validation loss decreased (-0.468733 --> -0.618736).  Saving model ...
Epoch: 5 cost time: 0.8380610942840576
Epoch: 5, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.127 Vali Acc: 0.697 Test Loss: 1.127 Test Acc: 0.697
Validation loss decreased (-0.618736 --> -0.696864).  Saving model ...
Epoch: 6 cost time: 0.9181878566741943
Epoch: 6, Steps: 8 | Train Loss: 1.089 Vali Loss: 0.930 Vali Acc: 0.738 Test Loss: 0.930 Test Acc: 0.738
Validation loss decreased (-0.696864 --> -0.737491).  Saving model ...
Epoch: 7 cost time: 0.8473668098449707
Epoch: 7, Steps: 8 | Train Loss: 0.867 Vali Loss: 0.789 Vali Acc: 0.778 Test Loss: 0.789 Test Acc: 0.778
Validation loss decreased (-0.737491 --> -0.778117).  Saving model ...
Epoch: 8 cost time: 0.8575437068939209
Epoch: 8, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.691 Vali Acc: 0.791 Test Loss: 0.691 Test Acc: 0.791
Validation loss decreased (-0.778117 --> -0.790618).  Saving model ...
Epoch: 9 cost time: 0.8655228614807129
Epoch: 9, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.633 Vali Acc: 0.794 Test Loss: 0.633 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793744).  Saving model ...
Epoch: 10 cost time: 0.8353519439697266
Epoch: 10, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.591 Vali Acc: 0.797 Test Loss: 0.591 Test Acc: 0.797
Validation loss decreased (-0.793744 --> -0.796869).  Saving model ...
Epoch: 11 cost time: 0.654747486114502
Epoch: 11, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
Validation loss decreased (-0.796869 --> -0.809370).  Saving model ...
Epoch: 12 cost time: 0.8303828239440918
Epoch: 12, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
Validation loss decreased (-0.809370 --> -0.821870).  Saving model ...
Epoch: 13 cost time: 0.8109629154205322
Epoch: 13, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 14 cost time: 0.8538177013397217
Epoch: 14, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 0.9125146865844727
Epoch: 15, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7484917640686035
Epoch: 16, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8223600387573242
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 0.8612332344055176
Epoch: 18, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 0.9196844100952148
Epoch: 19, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8423194885253906
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 0.8296680450439453
Epoch: 21, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 0.8863866329193115
Epoch: 22, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.77482008934021
Epoch: 23, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.8890295028686523
Epoch: 24, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.8601715564727783
Epoch: 25, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8686223030090332
Epoch: 26, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8959825038909912
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9089908599853516
Epoch: 28, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8011484146118164
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.863940954208374
Epoch: 30, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8968243598937988
Epoch: 31, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7810053825378418
Epoch: 32, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9458096027374268
Epoch: 33, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9220991134643555
Epoch: 34, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 84936
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5479884147644043
Epoch: 1, Steps: 8 | Train Loss: 2.303 Vali Loss: 2.101 Vali Acc: 0.284 Test Loss: 2.101 Test Acc: 0.284
Validation loss decreased (inf --> -0.284354).  Saving model ...
Epoch: 2 cost time: 0.8502826690673828
Epoch: 2, Steps: 8 | Train Loss: 2.062 Vali Loss: 1.936 Vali Acc: 0.334 Test Loss: 1.936 Test Acc: 0.334
Validation loss decreased (-0.284354 --> -0.334356).  Saving model ...
Epoch: 3 cost time: 0.8332464694976807
Epoch: 3, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.707 Vali Acc: 0.412 Test Loss: 1.707 Test Acc: 0.412
Validation loss decreased (-0.334356 --> -0.412483).  Saving model ...
Epoch: 4 cost time: 0.8374161720275879
Epoch: 4, Steps: 8 | Train Loss: 1.666 Vali Loss: 1.455 Vali Acc: 0.575 Test Loss: 1.455 Test Acc: 0.575
Validation loss decreased (-0.412483 --> -0.574985).  Saving model ...
Epoch: 5 cost time: 0.8170003890991211
Epoch: 5, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.225 Vali Acc: 0.684 Test Loss: 1.225 Test Acc: 0.684
Validation loss decreased (-0.574985 --> -0.684363).  Saving model ...
Epoch: 6 cost time: 0.8347878456115723
Epoch: 6, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.037 Vali Acc: 0.728 Test Loss: 1.037 Test Acc: 0.728
Validation loss decreased (-0.684363 --> -0.728115).  Saving model ...
Epoch: 7 cost time: 0.7768447399139404
Epoch: 7, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.896 Vali Acc: 0.750 Test Loss: 0.896 Test Acc: 0.750
Validation loss decreased (-0.728115 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 0.719268798828125
Epoch: 8, Steps: 8 | Train Loss: 0.862 Vali Loss: 0.787 Vali Acc: 0.769 Test Loss: 0.787 Test Acc: 0.769
Validation loss decreased (-0.749991 --> -0.768742).  Saving model ...
Epoch: 9 cost time: 0.7520959377288818
Epoch: 9, Steps: 8 | Train Loss: 0.689 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.768742 --> -0.774993).  Saving model ...
Epoch: 10 cost time: 0.713376522064209
Epoch: 10, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.656 Vali Acc: 0.791 Test Loss: 0.656 Test Acc: 0.791
Validation loss decreased (-0.774993 --> -0.790618).  Saving model ...
Epoch: 11 cost time: 0.7726800441741943
Epoch: 11, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
Validation loss decreased (-0.790618 --> -0.803119).  Saving model ...
Epoch: 12 cost time: 0.8012816905975342
Epoch: 12, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 13 cost time: 0.7564229965209961
Epoch: 13, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 14 cost time: 0.8217182159423828
Epoch: 14, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818745).  Saving model ...
Epoch: 15 cost time: 0.9650030136108398
Epoch: 15, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 16 cost time: 0.827399730682373
Epoch: 16, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.821870 --> -0.831245).  Saving model ...
Epoch: 17 cost time: 0.8864984512329102
Epoch: 17, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9055488109588623
Epoch: 18, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8648715019226074
Epoch: 19, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9153926372528076
Epoch: 20, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8326568603515625
Epoch: 21, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7952256202697754
Epoch: 22, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.484 Vali Acc: 0.828 Test Loss: 0.484 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.852494478225708
Epoch: 23, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 24 cost time: 0.8561327457427979
Epoch: 24, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 25 cost time: 0.853306770324707
Epoch: 25, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 26 cost time: 0.8602054119110107
Epoch: 26, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7993144989013672
Epoch: 27, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9150612354278564
Epoch: 28, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.486 Vali Acc: 0.834 Test Loss: 0.486 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8542253971099854
Epoch: 29, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9203486442565918
Epoch: 30, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 31 cost time: 0.7847940921783447
Epoch: 31, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 32 cost time: 0.9495363235473633
Epoch: 32, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 33 cost time: 0.8707866668701172
Epoch: 33, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7864665985107422
Epoch: 34, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.761157751083374
Epoch: 35, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 36 cost time: 0.7971444129943848
Epoch: 36, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 37 cost time: 0.8505780696868896
Epoch: 37, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8829114437103271
Epoch: 38, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8237817287445068
Epoch: 39, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7923562526702881
Epoch: 40, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8372888565063477
Epoch: 41, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9560990333557129
Epoch: 42, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8488097190856934
Epoch: 43, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8879094123840332
Epoch: 44, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8499321937561035
Epoch: 45, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.853041410446167
Epoch: 46, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 82888
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6231400966644287
Epoch: 1, Steps: 8 | Train Loss: 2.079 Vali Loss: 1.764 Vali Acc: 0.475 Test Loss: 1.764 Test Acc: 0.475
Validation loss decreased (inf --> -0.474982).  Saving model ...
Epoch: 2 cost time: 1.0904161930084229
Epoch: 2, Steps: 8 | Train Loss: 1.458 Vali Loss: 1.095 Vali Acc: 0.713 Test Loss: 1.095 Test Acc: 0.713
Validation loss decreased (-0.474982 --> -0.712489).  Saving model ...
Epoch: 3 cost time: 1.2470993995666504
Epoch: 3, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.712489 --> -0.821869).  Saving model ...
Epoch: 4 cost time: 1.2467889785766602
Epoch: 4, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3011813163757324
Epoch: 5, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.821869 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.3382441997528076
Epoch: 6, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3733396530151367
Epoch: 7, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.3646008968353271
Epoch: 8, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3083693981170654
Epoch: 9, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.622 Vali Acc: 0.812 Test Loss: 0.622 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.097707748413086
Epoch: 10, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3077340126037598
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3543741703033447
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.741 Vali Acc: 0.822 Test Loss: 0.741 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1690995693206787
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.663 Vali Acc: 0.838 Test Loss: 0.663 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2662501335144043
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.722 Vali Acc: 0.831 Test Loss: 0.722 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2705261707305908
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.837 Vali Acc: 0.828 Test Loss: 0.837 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.256639003753662
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.813 Vali Acc: 0.834 Test Loss: 0.813 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3017430305480957
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.819 Vali Acc: 0.831 Test Loss: 0.819 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 170888
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3164544105529785
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 1.965 Vali Acc: 0.194 Test Loss: 1.965 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.8151676654815674
Epoch: 2, Steps: 8 | Train Loss: 1.751 Vali Loss: 1.493 Vali Acc: 0.631 Test Loss: 1.493 Test Acc: 0.631
Validation loss decreased (-0.193730 --> -0.631235).  Saving model ...
Epoch: 3 cost time: 0.7749490737915039
Epoch: 3, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.025 Vali Acc: 0.753 Test Loss: 1.025 Test Acc: 0.753
Validation loss decreased (-0.631235 --> -0.753115).  Saving model ...
Epoch: 4 cost time: 0.8271529674530029
Epoch: 4, Steps: 8 | Train Loss: 0.827 Vali Loss: 0.728 Vali Acc: 0.791 Test Loss: 0.728 Test Acc: 0.791
Validation loss decreased (-0.753115 --> -0.790618).  Saving model ...
Epoch: 5 cost time: 0.8752949237823486
Epoch: 5, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.790618 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 0.881309986114502
Epoch: 6, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.818744 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 0.937915563583374
Epoch: 7, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9278707504272461
Epoch: 8, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7969386577606201
Epoch: 9, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.8635303974151611
Epoch: 10, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9696838855743408
Epoch: 11, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9456329345703125
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.904160737991333
Epoch: 13, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7695989608764648
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9450473785400391
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9340560436248779
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9346210956573486
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.636 Vali Acc: 0.834 Test Loss: 0.636 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8101511001586914
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9339892864227295
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.652 Vali Acc: 0.834 Test Loss: 0.652 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 111496
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.448251724243164
Epoch: 1, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.896 Vali Acc: 0.309 Test Loss: 1.896 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 0.857083797454834
Epoch: 2, Steps: 8 | Train Loss: 1.761 Vali Loss: 1.548 Vali Acc: 0.625 Test Loss: 1.548 Test Acc: 0.625
Validation loss decreased (-0.309356 --> -0.624985).  Saving model ...
Epoch: 3 cost time: 0.8278989791870117
Epoch: 3, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.158 Vali Acc: 0.762 Test Loss: 1.158 Test Acc: 0.762
Validation loss decreased (-0.624985 --> -0.762488).  Saving model ...
Epoch: 4 cost time: 0.7407653331756592
Epoch: 4, Steps: 8 | Train Loss: 0.985 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
Validation loss decreased (-0.762488 --> -0.809367).  Saving model ...
Epoch: 5 cost time: 0.8583192825317383
Epoch: 5, Steps: 8 | Train Loss: 0.725 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9105150699615479
Epoch: 6, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
Validation loss decreased (-0.809367 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 1.0066428184509277
Epoch: 7, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.512 Vali Acc: 0.825 Test Loss: 0.512 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7158141136169434
Epoch: 8, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.8565273284912109
Epoch: 9, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.478 Vali Acc: 0.834 Test Loss: 0.478 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8805246353149414
Epoch: 10, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8937654495239258
Epoch: 11, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9101569652557373
Epoch: 12, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.85970139503479
Epoch: 13, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8791992664337158
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8167197704315186
Epoch: 15, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8369078636169434
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8525197505950928
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.87502121925354
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 92040
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.260511875152588
Epoch: 1, Steps: 8 | Train Loss: 2.080 Vali Loss: 1.934 Vali Acc: 0.212 Test Loss: 1.934 Test Acc: 0.212
Validation loss decreased (inf --> -0.212481).  Saving model ...
Epoch: 2 cost time: 0.9009830951690674
Epoch: 2, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.612 Vali Acc: 0.509 Test Loss: 1.612 Test Acc: 0.509
Validation loss decreased (-0.212481 --> -0.509359).  Saving model ...
Epoch: 3 cost time: 0.8263945579528809
Epoch: 3, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.265 Vali Acc: 0.709 Test Loss: 1.265 Test Acc: 0.709
Validation loss decreased (-0.509359 --> -0.709362).  Saving model ...
Epoch: 4 cost time: 0.855180025100708
Epoch: 4, Steps: 8 | Train Loss: 1.169 Vali Loss: 0.968 Vali Acc: 0.778 Test Loss: 0.968 Test Acc: 0.778
Validation loss decreased (-0.709362 --> -0.778115).  Saving model ...
Epoch: 5 cost time: 0.9130563735961914
Epoch: 5, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.762 Vali Acc: 0.797 Test Loss: 0.762 Test Acc: 0.797
Validation loss decreased (-0.778115 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 0.8245029449462891
Epoch: 6, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
Validation loss decreased (-0.796867 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 0.8417704105377197
Epoch: 7, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 0.8787908554077148
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8810198307037354
Epoch: 9, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8933072090148926
Epoch: 10, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.9509885311126709
Epoch: 11, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.489 Vali Acc: 0.834 Test Loss: 0.489 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 0.9176657199859619
Epoch: 12, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8718063831329346
Epoch: 13, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7105927467346191
Epoch: 14, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8662493228912354
Epoch: 15, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8729312419891357
Epoch: 16, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.8241317272186279
Epoch: 17, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9506769180297852
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.00942063331604
Epoch: 19, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.834 Test Loss: 0.564 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8500142097473145
Epoch: 20, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8556365966796875
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9381942749023438
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9478754997253418
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9139492511749268
Epoch: 24, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9015989303588867
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9308860301971436
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.585 Vali Acc: 0.838 Test Loss: 0.585 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 81800
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5172245502471924
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.068 Vali Acc: 0.194 Test Loss: 2.068 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.8926036357879639
Epoch: 2, Steps: 8 | Train Loss: 1.997 Vali Loss: 1.832 Vali Acc: 0.434 Test Loss: 1.832 Test Acc: 0.434
Validation loss decreased (-0.193729 --> -0.434357).  Saving model ...
Epoch: 3 cost time: 0.8554513454437256
Epoch: 3, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.536 Vali Acc: 0.600 Test Loss: 1.536 Test Acc: 0.600
Validation loss decreased (-0.434357 --> -0.599985).  Saving model ...
Epoch: 4 cost time: 0.89835524559021
Epoch: 4, Steps: 8 | Train Loss: 1.455 Vali Loss: 1.243 Vali Acc: 0.697 Test Loss: 1.243 Test Acc: 0.697
Validation loss decreased (-0.599985 --> -0.696863).  Saving model ...
Epoch: 5 cost time: 1.0012714862823486
Epoch: 5, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.001 Vali Acc: 0.731 Test Loss: 1.001 Test Acc: 0.731
Validation loss decreased (-0.696863 --> -0.731240).  Saving model ...
Epoch: 6 cost time: 0.8324956893920898
Epoch: 6, Steps: 8 | Train Loss: 0.911 Vali Loss: 0.819 Vali Acc: 0.753 Test Loss: 0.819 Test Acc: 0.753
Validation loss decreased (-0.731240 --> -0.753117).  Saving model ...
Epoch: 7 cost time: 0.9381077289581299
Epoch: 7, Steps: 8 | Train Loss: 0.720 Vali Loss: 0.693 Vali Acc: 0.778 Test Loss: 0.693 Test Acc: 0.778
Validation loss decreased (-0.753117 --> -0.778118).  Saving model ...
Epoch: 8 cost time: 0.9715864658355713
Epoch: 8, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.611 Vali Acc: 0.819 Test Loss: 0.611 Test Acc: 0.819
Validation loss decreased (-0.778118 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.9599864482879639
Epoch: 9, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.561 Vali Acc: 0.828 Test Loss: 0.561 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.8340399265289307
Epoch: 10, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.8956756591796875
Epoch: 11, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9443199634552002
Epoch: 12, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.948204517364502
Epoch: 13, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 0.941239595413208
Epoch: 14, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.851733922958374
Epoch: 15, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8630526065826416
Epoch: 16, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8772950172424316
Epoch: 17, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8188662528991699
Epoch: 18, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 0.9956648349761963
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.776813268661499
Epoch: 20, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8391592502593994
Epoch: 21, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8443758487701416
Epoch: 22, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8776249885559082
Epoch: 23, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.017822265625
Epoch: 24, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8647146224975586
Epoch: 25, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.923992395401001
Epoch: 26, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9395999908447266
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8271381855010986
Epoch: 28, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 73608
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4447007179260254
Epoch: 1, Steps: 8 | Train Loss: 2.161 Vali Loss: 2.068 Vali Acc: 0.212 Test Loss: 2.068 Test Acc: 0.212
Validation loss decreased (inf --> -0.212479).  Saving model ...
Epoch: 2 cost time: 0.8323764801025391
Epoch: 2, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.862 Vali Acc: 0.322 Test Loss: 1.862 Test Acc: 0.322
Validation loss decreased (-0.212479 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 0.8139853477478027
Epoch: 3, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.595 Vali Acc: 0.497 Test Loss: 1.595 Test Acc: 0.497
Validation loss decreased (-0.321856 --> -0.496859).  Saving model ...
Epoch: 4 cost time: 0.9869017601013184
Epoch: 4, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.318 Vali Acc: 0.669 Test Loss: 1.318 Test Acc: 0.669
Validation loss decreased (-0.496859 --> -0.668737).  Saving model ...
Epoch: 5 cost time: 0.880821943283081
Epoch: 5, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.081 Vali Acc: 0.747 Test Loss: 1.081 Test Acc: 0.747
Validation loss decreased (-0.668737 --> -0.746864).  Saving model ...
Epoch: 6 cost time: 0.8482310771942139
Epoch: 6, Steps: 8 | Train Loss: 0.986 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
Validation loss decreased (-0.746864 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.7762777805328369
Epoch: 7, Steps: 8 | Train Loss: 0.828 Vali Loss: 0.777 Vali Acc: 0.791 Test Loss: 0.777 Test Acc: 0.791
Validation loss decreased (-0.774991 --> -0.790617).  Saving model ...
Epoch: 8 cost time: 0.8868072032928467
Epoch: 8, Steps: 8 | Train Loss: 0.766 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.790617 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.8365466594696045
Epoch: 9, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.617 Vali Acc: 0.806 Test Loss: 0.617 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.865849494934082
Epoch: 10, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9461531639099121
Epoch: 11, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815620).  Saving model ...
Epoch: 12 cost time: 0.8635368347167969
Epoch: 12, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8587169647216797
Epoch: 13, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
Validation loss decreased (-0.815620 --> -0.815620).  Saving model ...
Epoch: 14 cost time: 0.8546388149261475
Epoch: 14, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
Validation loss decreased (-0.815620 --> -0.821870).  Saving model ...
Epoch: 15 cost time: 0.8210842609405518
Epoch: 15, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
Validation loss decreased (-0.821870 --> -0.831245).  Saving model ...
Epoch: 16 cost time: 0.7779440879821777
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.853186845779419
Epoch: 17, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 18 cost time: 0.9335558414459229
Epoch: 18, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 19 cost time: 0.8198249340057373
Epoch: 19, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7824661731719971
Epoch: 20, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 21 cost time: 0.8699495792388916
Epoch: 21, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8511812686920166
Epoch: 22, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8396873474121094
Epoch: 23, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7343027591705322
Epoch: 24, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7983574867248535
Epoch: 25, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7304365634918213
Epoch: 26, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8195037841796875
Epoch: 27, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7960166931152344
Epoch: 28, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7925522327423096
Epoch: 29, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 30 cost time: 0.7597508430480957
Epoch: 30, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7589662075042725
Epoch: 31, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8594846725463867
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9018855094909668
Epoch: 33, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8174211978912354
Epoch: 34, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 35 cost time: 0.8190090656280518
Epoch: 35, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7551491260528564
Epoch: 36, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7889890670776367
Epoch: 37, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8089168071746826
Epoch: 38, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8491458892822266
Epoch: 39, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7905924320220947
Epoch: 40, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8805007934570312
Epoch: 41, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 0.7290270328521729
Epoch: 42, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 0.9414510726928711
Epoch: 43, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8547914028167725
Epoch: 44, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8229172229766846
Epoch: 45, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.853 Test Loss: 0.545 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 46 cost time: 0.8057425022125244
Epoch: 46, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8307380676269531
Epoch: 47, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9736177921295166
Epoch: 48, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 49 cost time: 0.841423511505127
Epoch: 49, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.559 Vali Acc: 0.853 Test Loss: 0.559 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8567502498626709
Epoch: 50, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.565 Vali Acc: 0.853 Test Loss: 0.565 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8991599082946777
Epoch: 51, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9301352500915527
Epoch: 52, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8285458087921143
Epoch: 53, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8046126365661621
Epoch: 54, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.853 Test Loss: 0.568 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.7994236946105957
Epoch: 55, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.560 Vali Acc: 0.853 Test Loss: 0.560 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7216901779174805
Epoch: 56, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.859 Test Loss: 0.556 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 57 cost time: 0.8234670162200928
Epoch: 57, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.555 Vali Acc: 0.863 Test Loss: 0.555 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 58 cost time: 0.8067736625671387
Epoch: 58, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7414262294769287
Epoch: 59, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8507120609283447
Epoch: 60, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8335056304931641
Epoch: 61, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9103007316589355
Epoch: 62, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.859 Test Loss: 0.569 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.8444421291351318
Epoch: 63, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.7826728820800781
Epoch: 64, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.8715815544128418
Epoch: 65, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8103067874908447
Epoch: 66, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.7795717716217041
Epoch: 67, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 68424
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4044697284698486
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 1.982 Vali Acc: 0.253 Test Loss: 1.982 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 0.8424379825592041
Epoch: 2, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.813 Vali Acc: 0.378 Test Loss: 1.813 Test Acc: 0.378
Validation loss decreased (-0.253105 --> -0.378107).  Saving model ...
Epoch: 3 cost time: 0.7531020641326904
Epoch: 3, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.595 Vali Acc: 0.550 Test Loss: 1.595 Test Acc: 0.550
Validation loss decreased (-0.378107 --> -0.549984).  Saving model ...
Epoch: 4 cost time: 0.8167028427124023
Epoch: 4, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.368 Vali Acc: 0.662 Test Loss: 1.368 Test Acc: 0.662
Validation loss decreased (-0.549984 --> -0.662486).  Saving model ...
Epoch: 5 cost time: 0.8786251544952393
Epoch: 5, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.163 Vali Acc: 0.725 Test Loss: 1.163 Test Acc: 0.725
Validation loss decreased (-0.662486 --> -0.724988).  Saving model ...
Epoch: 6 cost time: 0.7265889644622803
Epoch: 6, Steps: 8 | Train Loss: 1.117 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.8013198375701904
Epoch: 7, Steps: 8 | Train Loss: 0.932 Vali Loss: 0.866 Vali Acc: 0.766 Test Loss: 0.866 Test Acc: 0.766
Validation loss decreased (-0.749990 --> -0.765616).  Saving model ...
Epoch: 8 cost time: 0.8557834625244141
Epoch: 8, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.774 Vali Acc: 0.784 Test Loss: 0.774 Test Acc: 0.784
Validation loss decreased (-0.765616 --> -0.784367).  Saving model ...
Epoch: 9 cost time: 0.7250745296478271
Epoch: 9, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.698 Vali Acc: 0.794 Test Loss: 0.698 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793743).  Saving model ...
Epoch: 10 cost time: 0.8462255001068115
Epoch: 10, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.639 Vali Acc: 0.812 Test Loss: 0.639 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 0.8294589519500732
Epoch: 11, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.8997063636779785
Epoch: 12, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6732361316680908
Epoch: 13, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.556 Vali Acc: 0.812 Test Loss: 0.556 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6980023384094238
Epoch: 14, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6590549945831299
Epoch: 15, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 16 cost time: 0.7154793739318848
Epoch: 16, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.7607507705688477
Epoch: 17, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7645018100738525
Epoch: 18, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.511 Vali Acc: 0.828 Test Loss: 0.511 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7266254425048828
Epoch: 19, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7897355556488037
Epoch: 20, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 21 cost time: 0.731865644454956
Epoch: 21, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 0.8019485473632812
Epoch: 22, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.8267467021942139
Epoch: 23, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.779524564743042
Epoch: 24, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8631601333618164
Epoch: 25, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.475 Vali Acc: 0.834 Test Loss: 0.475 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8254232406616211
Epoch: 26, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8815817832946777
Epoch: 27, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7986314296722412
Epoch: 28, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8245878219604492
Epoch: 29, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7760932445526123
Epoch: 30, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.448 Vali Acc: 0.838 Test Loss: 0.448 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9017252922058105
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.816805362701416
Epoch: 32, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm64_nh16_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 66376
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.531256914138794
Epoch: 1, Steps: 8 | Train Loss: 2.251 Vali Loss: 2.033 Vali Acc: 0.163 Test Loss: 2.033 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 0.8091816902160645
Epoch: 2, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.540 Vali Acc: 0.547 Test Loss: 1.540 Test Acc: 0.547
Validation loss decreased (-0.162480 --> -0.546860).  Saving model ...
Epoch: 3 cost time: 0.7432281970977783
Epoch: 3, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.043 Vali Acc: 0.734 Test Loss: 1.043 Test Acc: 0.734
Validation loss decreased (-0.546860 --> -0.734365).  Saving model ...
Epoch: 4 cost time: 0.8835155963897705
Epoch: 4, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
Validation loss decreased (-0.734365 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 0.6673777103424072
Epoch: 5, Steps: 8 | Train Loss: 0.599 Vali Loss: 0.594 Vali Acc: 0.800 Test Loss: 0.594 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8092210292816162
Epoch: 6, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 0.7951078414916992
Epoch: 7, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.8193204402923584
Epoch: 8, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8519370555877686
Epoch: 9, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8404340744018555
Epoch: 10, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.7650573253631592
Epoch: 11, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.579 Vali Acc: 0.834 Test Loss: 0.579 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6960692405700684
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8589837551116943
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.602 Vali Acc: 0.834 Test Loss: 0.602 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8053493499755859
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.613 Vali Acc: 0.838 Test Loss: 0.613 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8653225898742676
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 16 cost time: 0.7890243530273438
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8289339542388916
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.671 Vali Acc: 0.828 Test Loss: 0.671 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.793248176574707
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.776679277420044
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.689 Vali Acc: 0.838 Test Loss: 0.689 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8205342292785645
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.698 Vali Acc: 0.838 Test Loss: 0.698 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7580955028533936
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.700 Vali Acc: 0.834 Test Loss: 0.700 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8337903022766113
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.701 Vali Acc: 0.838 Test Loss: 0.701 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8434047698974609
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.719 Vali Acc: 0.831 Test Loss: 0.719 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8420150279998779
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.735 Vali Acc: 0.828 Test Loss: 0.735 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7514388561248779
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.834 Test Loss: 0.740 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 102280
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2457685470581055
Epoch: 1, Steps: 8 | Train Loss: 2.342 Vali Loss: 2.144 Vali Acc: 0.097 Test Loss: 2.144 Test Acc: 0.097
Validation loss decreased (inf --> -0.096854).  Saving model ...
Epoch: 2 cost time: 0.8524773120880127
Epoch: 2, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.854 Vali Acc: 0.328 Test Loss: 1.854 Test Acc: 0.328
Validation loss decreased (-0.096854 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 0.7279143333435059
Epoch: 3, Steps: 8 | Train Loss: 1.695 Vali Loss: 1.499 Vali Acc: 0.634 Test Loss: 1.499 Test Acc: 0.634
Validation loss decreased (-0.328106 --> -0.634360).  Saving model ...
Epoch: 4 cost time: 0.7378818988800049
Epoch: 4, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.165 Vali Acc: 0.753 Test Loss: 1.165 Test Acc: 0.753
Validation loss decreased (-0.634360 --> -0.753113).  Saving model ...
Epoch: 5 cost time: 0.8442389965057373
Epoch: 5, Steps: 8 | Train Loss: 1.120 Vali Loss: 0.904 Vali Acc: 0.753 Test Loss: 0.904 Test Acc: 0.753
Validation loss decreased (-0.753113 --> -0.753116).  Saving model ...
Epoch: 6 cost time: 0.8403000831604004
Epoch: 6, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.727 Vali Acc: 0.778 Test Loss: 0.727 Test Acc: 0.778
Validation loss decreased (-0.753116 --> -0.778118).  Saving model ...
Epoch: 7 cost time: 0.8165783882141113
Epoch: 7, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
Validation loss decreased (-0.778118 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 0.8327851295471191
Epoch: 8, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.8127176761627197
Epoch: 9, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.803119 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 0.7588539123535156
Epoch: 10, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8261935710906982
Epoch: 11, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.548 Vali Acc: 0.806 Test Loss: 0.548 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7985825538635254
Epoch: 12, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8270936012268066
Epoch: 13, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.7050669193267822
Epoch: 14, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7540538311004639
Epoch: 15, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7324755191802979
Epoch: 16, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7117507457733154
Epoch: 17, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8213498592376709
Epoch: 18, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7177920341491699
Epoch: 19, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8445396423339844
Epoch: 20, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7064809799194336
Epoch: 21, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8708362579345703
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.573 Vali Acc: 0.831 Test Loss: 0.573 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7537996768951416
Epoch: 23, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 72584
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4898295402526855
Epoch: 1, Steps: 8 | Train Loss: 2.181 Vali Loss: 2.147 Vali Acc: 0.116 Test Loss: 2.147 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.7321667671203613
Epoch: 2, Steps: 8 | Train Loss: 2.101 Vali Loss: 1.948 Vali Acc: 0.303 Test Loss: 1.948 Test Acc: 0.303
Validation loss decreased (-0.115604 --> -0.303106).  Saving model ...
Epoch: 3 cost time: 0.7799491882324219
Epoch: 3, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.688 Vali Acc: 0.506 Test Loss: 1.688 Test Acc: 0.506
Validation loss decreased (-0.303106 --> -0.506233).  Saving model ...
Epoch: 4 cost time: 0.752800464630127
Epoch: 4, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.410 Vali Acc: 0.694 Test Loss: 1.410 Test Acc: 0.694
Validation loss decreased (-0.506233 --> -0.693736).  Saving model ...
Epoch: 5 cost time: 0.9218502044677734
Epoch: 5, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.157 Vali Acc: 0.744 Test Loss: 1.157 Test Acc: 0.744
Validation loss decreased (-0.693736 --> -0.743738).  Saving model ...
Epoch: 6 cost time: 0.8505740165710449
Epoch: 6, Steps: 8 | Train Loss: 1.106 Vali Loss: 0.940 Vali Acc: 0.787 Test Loss: 0.940 Test Acc: 0.787
Validation loss decreased (-0.743738 --> -0.787491).  Saving model ...
Epoch: 7 cost time: 0.7825374603271484
Epoch: 7, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.781 Vali Acc: 0.794 Test Loss: 0.781 Test Acc: 0.794
Validation loss decreased (-0.787491 --> -0.793742).  Saving model ...
Epoch: 8 cost time: 0.8430371284484863
Epoch: 8, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.675 Vali Acc: 0.809 Test Loss: 0.675 Test Acc: 0.809
Validation loss decreased (-0.793742 --> -0.809368).  Saving model ...
Epoch: 9 cost time: 0.7834250926971436
Epoch: 9, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.7963142395019531
Epoch: 10, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.8861501216888428
Epoch: 11, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 12 cost time: 0.8302998542785645
Epoch: 12, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 13 cost time: 0.8627872467041016
Epoch: 13, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.9520797729492188
Epoch: 14, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9294109344482422
Epoch: 15, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6965374946594238
Epoch: 16, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8430056571960449
Epoch: 17, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8290848731994629
Epoch: 18, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8642990589141846
Epoch: 19, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7764871120452881
Epoch: 20, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8351016044616699
Epoch: 21, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7532167434692383
Epoch: 22, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8241567611694336
Epoch: 23, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 62856
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.563511371612549
Epoch: 1, Steps: 8 | Train Loss: 2.280 Vali Loss: 2.093 Vali Acc: 0.172 Test Loss: 2.093 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.728757381439209
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.929 Vali Acc: 0.259 Test Loss: 1.929 Test Acc: 0.259
Validation loss decreased (-0.171854 --> -0.259356).  Saving model ...
Epoch: 3 cost time: 0.8537347316741943
Epoch: 3, Steps: 8 | Train Loss: 1.925 Vali Loss: 1.707 Vali Acc: 0.487 Test Loss: 1.707 Test Acc: 0.487
Validation loss decreased (-0.259356 --> -0.487483).  Saving model ...
Epoch: 4 cost time: 0.8208811283111572
Epoch: 4, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.465 Vali Acc: 0.669 Test Loss: 1.465 Test Acc: 0.669
Validation loss decreased (-0.487483 --> -0.668735).  Saving model ...
Epoch: 5 cost time: 0.8659317493438721
Epoch: 5, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.228 Vali Acc: 0.734 Test Loss: 1.228 Test Acc: 0.734
Validation loss decreased (-0.668735 --> -0.734363).  Saving model ...
Epoch: 6 cost time: 0.8154926300048828
Epoch: 6, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.019 Vali Acc: 0.781 Test Loss: 1.019 Test Acc: 0.781
Validation loss decreased (-0.734363 --> -0.781240).  Saving model ...
Epoch: 7 cost time: 0.8211808204650879
Epoch: 7, Steps: 8 | Train Loss: 1.059 Vali Loss: 0.852 Vali Acc: 0.791 Test Loss: 0.852 Test Acc: 0.791
Validation loss decreased (-0.781240 --> -0.790616).  Saving model ...
Epoch: 8 cost time: 0.790790319442749
Epoch: 8, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.733 Vali Acc: 0.797 Test Loss: 0.733 Test Acc: 0.797
Validation loss decreased (-0.790616 --> -0.796868).  Saving model ...
Epoch: 9 cost time: 0.7596638202667236
Epoch: 9, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.7754409313201904
Epoch: 10, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.7337672710418701
Epoch: 11, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.8157742023468018
Epoch: 12, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.534 Vali Acc: 0.816 Test Loss: 0.534 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7875432968139648
Epoch: 13, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7524285316467285
Epoch: 14, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6808798313140869
Epoch: 15, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6798076629638672
Epoch: 16, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7384116649627686
Epoch: 17, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 0.7063663005828857
Epoch: 18, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7489514350891113
Epoch: 19, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8004629611968994
Epoch: 20, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8126382827758789
Epoch: 21, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6012885570526123
Epoch: 22, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7917170524597168
Epoch: 23, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8125636577606201
Epoch: 24, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.760716438293457
Epoch: 25, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7918717861175537
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8029990196228027
Epoch: 27, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 57736
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.391533136367798
Epoch: 1, Steps: 8 | Train Loss: 2.226 Vali Loss: 2.146 Vali Acc: 0.103 Test Loss: 2.146 Test Acc: 0.103
Validation loss decreased (inf --> -0.103104).  Saving model ...
Epoch: 2 cost time: 0.8651118278503418
Epoch: 2, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.994 Vali Acc: 0.206 Test Loss: 1.994 Test Acc: 0.206
Validation loss decreased (-0.103104 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 0.7413957118988037
Epoch: 3, Steps: 8 | Train Loss: 1.938 Vali Loss: 1.800 Vali Acc: 0.397 Test Loss: 1.800 Test Acc: 0.397
Validation loss decreased (-0.206230 --> -0.396857).  Saving model ...
Epoch: 4 cost time: 0.8692624568939209
Epoch: 4, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.590 Vali Acc: 0.566 Test Loss: 1.590 Test Acc: 0.566
Validation loss decreased (-0.396857 --> -0.565609).  Saving model ...
Epoch: 5 cost time: 0.765974760055542
Epoch: 5, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.376 Vali Acc: 0.709 Test Loss: 1.376 Test Acc: 0.709
Validation loss decreased (-0.565609 --> -0.709361).  Saving model ...
Epoch: 6 cost time: 0.8064155578613281
Epoch: 6, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.182 Vali Acc: 0.759 Test Loss: 1.182 Test Acc: 0.759
Validation loss decreased (-0.709361 --> -0.759363).  Saving model ...
Epoch: 7 cost time: 0.8774335384368896
Epoch: 7, Steps: 8 | Train Loss: 1.171 Vali Loss: 1.004 Vali Acc: 0.787 Test Loss: 1.004 Test Acc: 0.787
Validation loss decreased (-0.759363 --> -0.787490).  Saving model ...
Epoch: 8 cost time: 0.8161616325378418
Epoch: 8, Steps: 8 | Train Loss: 0.935 Vali Loss: 0.862 Vali Acc: 0.812 Test Loss: 0.862 Test Acc: 0.812
Validation loss decreased (-0.787490 --> -0.812491).  Saving model ...
Epoch: 9 cost time: 0.8788161277770996
Epoch: 9, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.754 Vali Acc: 0.819 Test Loss: 0.754 Test Acc: 0.819
Validation loss decreased (-0.812491 --> -0.818742).  Saving model ...
Epoch: 10 cost time: 0.7875003814697266
Epoch: 10, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8429627418518066
Epoch: 11, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.7995564937591553
Epoch: 12, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.8307774066925049
Epoch: 13, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.7987909317016602
Epoch: 14, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.78167724609375
Epoch: 15, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8295676708221436
Epoch: 16, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7624533176422119
Epoch: 17, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7913942337036133
Epoch: 18, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.71793532371521
Epoch: 19, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 20 cost time: 0.774137020111084
Epoch: 20, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7856872081756592
Epoch: 21, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8265538215637207
Epoch: 22, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7811229228973389
Epoch: 23, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8867030143737793
Epoch: 24, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9218671321868896
Epoch: 25, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7988171577453613
Epoch: 26, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8831484317779541
Epoch: 27, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8508017063140869
Epoch: 28, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.479 Vali Acc: 0.853 Test Loss: 0.479 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 29 cost time: 0.7955148220062256
Epoch: 29, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7729592323303223
Epoch: 30, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8436734676361084
Epoch: 31, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.820786714553833
Epoch: 32, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8848803043365479
Epoch: 33, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7884883880615234
Epoch: 34, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7743082046508789
Epoch: 35, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8277032375335693
Epoch: 36, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7417404651641846
Epoch: 37, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8566691875457764
Epoch: 38, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 53640
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6921932697296143
Epoch: 1, Steps: 8 | Train Loss: 2.301 Vali Loss: 2.246 Vali Acc: 0.109 Test Loss: 2.246 Test Acc: 0.109
Validation loss decreased (inf --> -0.109353).  Saving model ...
Epoch: 2 cost time: 0.8413968086242676
Epoch: 2, Steps: 8 | Train Loss: 2.228 Vali Loss: 2.108 Vali Acc: 0.172 Test Loss: 2.108 Test Acc: 0.172
Validation loss decreased (-0.109353 --> -0.171854).  Saving model ...
Epoch: 3 cost time: 0.783937931060791
Epoch: 3, Steps: 8 | Train Loss: 2.128 Vali Loss: 1.916 Vali Acc: 0.234 Test Loss: 1.916 Test Acc: 0.234
Validation loss decreased (-0.171854 --> -0.234356).  Saving model ...
Epoch: 4 cost time: 0.7078568935394287
Epoch: 4, Steps: 8 | Train Loss: 1.898 Vali Loss: 1.705 Vali Acc: 0.388 Test Loss: 1.705 Test Acc: 0.388
Validation loss decreased (-0.234356 --> -0.387483).  Saving model ...
Epoch: 5 cost time: 0.724961519241333
Epoch: 5, Steps: 8 | Train Loss: 1.703 Vali Loss: 1.495 Vali Acc: 0.572 Test Loss: 1.495 Test Acc: 0.572
Validation loss decreased (-0.387483 --> -0.571860).  Saving model ...
Epoch: 6 cost time: 0.754544734954834
Epoch: 6, Steps: 8 | Train Loss: 1.474 Vali Loss: 1.304 Vali Acc: 0.681 Test Loss: 1.304 Test Acc: 0.681
Validation loss decreased (-0.571860 --> -0.681237).  Saving model ...
Epoch: 7 cost time: 0.8514645099639893
Epoch: 7, Steps: 8 | Train Loss: 1.290 Vali Loss: 1.132 Vali Acc: 0.741 Test Loss: 1.132 Test Acc: 0.741
Validation loss decreased (-0.681237 --> -0.740614).  Saving model ...
Epoch: 8 cost time: 0.8592751026153564
Epoch: 8, Steps: 8 | Train Loss: 1.118 Vali Loss: 0.985 Vali Acc: 0.769 Test Loss: 0.985 Test Acc: 0.769
Validation loss decreased (-0.740614 --> -0.768740).  Saving model ...
Epoch: 9 cost time: 0.7583887577056885
Epoch: 9, Steps: 8 | Train Loss: 0.920 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
Validation loss decreased (-0.768740 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.7591812610626221
Epoch: 10, Steps: 8 | Train Loss: 0.828 Vali Loss: 0.782 Vali Acc: 0.791 Test Loss: 0.782 Test Acc: 0.791
Validation loss decreased (-0.774991 --> -0.790617).  Saving model ...
Epoch: 11 cost time: 0.8433554172515869
Epoch: 11, Steps: 8 | Train Loss: 0.726 Vali Loss: 0.715 Vali Acc: 0.794 Test Loss: 0.715 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 12 cost time: 0.8513641357421875
Epoch: 12, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803118).  Saving model ...
Epoch: 13 cost time: 0.7234711647033691
Epoch: 13, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 0.8026330471038818
Epoch: 14, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.595 Vali Acc: 0.806 Test Loss: 0.595 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 15 cost time: 0.7464377880096436
Epoch: 15, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 16 cost time: 0.8927021026611328
Epoch: 16, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 17 cost time: 0.7389881610870361
Epoch: 17, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815620).  Saving model ...
Epoch: 18 cost time: 0.7914524078369141
Epoch: 18, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
Validation loss decreased (-0.815620 --> -0.828120).  Saving model ...
Epoch: 19 cost time: 0.8914079666137695
Epoch: 19, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 20 cost time: 0.7677032947540283
Epoch: 20, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 21 cost time: 0.7256155014038086
Epoch: 21, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 22 cost time: 0.7125256061553955
Epoch: 22, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 23 cost time: 0.8992466926574707
Epoch: 23, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 24 cost time: 0.8874661922454834
Epoch: 24, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 25 cost time: 0.7975318431854248
Epoch: 25, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 26 cost time: 0.7987020015716553
Epoch: 26, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 27 cost time: 0.8083527088165283
Epoch: 27, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 28 cost time: 0.8900144100189209
Epoch: 28, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9374730587005615
Epoch: 29, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.469 Vali Acc: 0.859 Test Loss: 0.469 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 30 cost time: 0.8934957981109619
Epoch: 30, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9426755905151367
Epoch: 31, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9340298175811768
Epoch: 32, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9319725036621094
Epoch: 33, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 34 cost time: 0.8285880088806152
Epoch: 34, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.464 Vali Acc: 0.859 Test Loss: 0.464 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.784538745880127
Epoch: 35, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 36 cost time: 0.8978204727172852
Epoch: 36, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 37 cost time: 0.8493518829345703
Epoch: 37, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.457 Vali Acc: 0.866 Test Loss: 0.457 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 38 cost time: 0.9490952491760254
Epoch: 38, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.456 Vali Acc: 0.866 Test Loss: 0.456 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 39 cost time: 0.747272253036499
Epoch: 39, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8731689453125
Epoch: 40, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 41 cost time: 0.8621342182159424
Epoch: 41, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 42 cost time: 0.8794431686401367
Epoch: 42, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.455 Vali Acc: 0.869 Test Loss: 0.455 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9297235012054443
Epoch: 43, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9632890224456787
Epoch: 44, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.454 Vali Acc: 0.866 Test Loss: 0.454 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9027235507965088
Epoch: 45, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.461 Vali Acc: 0.866 Test Loss: 0.461 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9381802082061768
Epoch: 46, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8455262184143066
Epoch: 47, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7903227806091309
Epoch: 48, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8578677177429199
Epoch: 49, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8147268295288086
Epoch: 50, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9336814880371094
Epoch: 51, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.474 Vali Acc: 0.859 Test Loss: 0.474 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 51048
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.401454448699951
Epoch: 1, Steps: 8 | Train Loss: 2.199 Vali Loss: 2.147 Vali Acc: 0.109 Test Loss: 2.147 Test Acc: 0.109
Validation loss decreased (inf --> -0.109354).  Saving model ...
Epoch: 2 cost time: 0.7875041961669922
Epoch: 2, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.028 Vali Acc: 0.175 Test Loss: 2.028 Test Acc: 0.175
Validation loss decreased (-0.109354 --> -0.174980).  Saving model ...
Epoch: 3 cost time: 0.8481061458587646
Epoch: 3, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.870 Vali Acc: 0.309 Test Loss: 1.870 Test Acc: 0.309
Validation loss decreased (-0.174980 --> -0.309356).  Saving model ...
Epoch: 4 cost time: 0.8897926807403564
Epoch: 4, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.697 Vali Acc: 0.466 Test Loss: 1.697 Test Acc: 0.466
Validation loss decreased (-0.309356 --> -0.465608).  Saving model ...
Epoch: 5 cost time: 0.9092047214508057
Epoch: 5, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.524 Vali Acc: 0.569 Test Loss: 1.524 Test Acc: 0.569
Validation loss decreased (-0.465608 --> -0.568735).  Saving model ...
Epoch: 6 cost time: 0.8242318630218506
Epoch: 6, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.358 Vali Acc: 0.662 Test Loss: 1.358 Test Acc: 0.662
Validation loss decreased (-0.568735 --> -0.662486).  Saving model ...
Epoch: 7 cost time: 0.8822662830352783
Epoch: 7, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.209 Vali Acc: 0.713 Test Loss: 1.209 Test Acc: 0.713
Validation loss decreased (-0.662486 --> -0.712488).  Saving model ...
Epoch: 8 cost time: 0.8186745643615723
Epoch: 8, Steps: 8 | Train Loss: 1.126 Vali Loss: 1.083 Vali Acc: 0.738 Test Loss: 1.083 Test Acc: 0.738
Validation loss decreased (-0.712488 --> -0.737489).  Saving model ...
Epoch: 9 cost time: 0.8382759094238281
Epoch: 9, Steps: 8 | Train Loss: 1.004 Vali Loss: 0.973 Vali Acc: 0.747 Test Loss: 0.973 Test Acc: 0.747
Validation loss decreased (-0.737489 --> -0.746865).  Saving model ...
Epoch: 10 cost time: 0.8387482166290283
Epoch: 10, Steps: 8 | Train Loss: 0.930 Vali Loss: 0.878 Vali Acc: 0.762 Test Loss: 0.878 Test Acc: 0.762
Validation loss decreased (-0.746865 --> -0.762491).  Saving model ...
Epoch: 11 cost time: 0.9157450199127197
Epoch: 11, Steps: 8 | Train Loss: 0.837 Vali Loss: 0.794 Vali Acc: 0.797 Test Loss: 0.794 Test Acc: 0.797
Validation loss decreased (-0.762491 --> -0.796867).  Saving model ...
Epoch: 12 cost time: 0.9251620769500732
Epoch: 12, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.734 Vali Acc: 0.794 Test Loss: 0.734 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8512139320373535
Epoch: 13, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 14 cost time: 0.8206367492675781
Epoch: 14, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 15 cost time: 0.9241335391998291
Epoch: 15, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 0.902198076248169
Epoch: 16, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.597 Vali Acc: 0.806 Test Loss: 0.597 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.806244).  Saving model ...
Epoch: 17 cost time: 0.860936164855957
Epoch: 17, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 18 cost time: 0.8835291862487793
Epoch: 18, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818745).  Saving model ...
Epoch: 19 cost time: 0.8574948310852051
Epoch: 19, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
Validation loss decreased (-0.818745 --> -0.824995).  Saving model ...
Epoch: 20 cost time: 0.8566446304321289
Epoch: 20, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8028357028961182
Epoch: 21, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 22 cost time: 0.8010373115539551
Epoch: 22, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7548773288726807
Epoch: 23, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 0.7795851230621338
Epoch: 24, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 0.8328869342803955
Epoch: 25, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 26 cost time: 0.8509812355041504
Epoch: 26, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8365342617034912
Epoch: 27, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8728103637695312
Epoch: 28, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 29 cost time: 0.830620288848877
Epoch: 29, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9474043846130371
Epoch: 30, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.444 Vali Acc: 0.863 Test Loss: 0.444 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 31 cost time: 0.7963330745697021
Epoch: 31, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.437 Vali Acc: 0.863 Test Loss: 0.437 Test Acc: 0.863
Validation loss decreased (-0.862496 --> -0.862496).  Saving model ...
Epoch: 32 cost time: 0.8455543518066406
Epoch: 32, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.433 Vali Acc: 0.859 Test Loss: 0.433 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8364963531494141
Epoch: 33, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.432 Vali Acc: 0.859 Test Loss: 0.432 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.768115758895874
Epoch: 34, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8927085399627686
Epoch: 35, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9473288059234619
Epoch: 36, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.430 Vali Acc: 0.853 Test Loss: 0.430 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9656858444213867
Epoch: 37, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.419 Vali Acc: 0.863 Test Loss: 0.419 Test Acc: 0.863
Validation loss decreased (-0.862496 --> -0.862496).  Saving model ...
Epoch: 38 cost time: 0.8580069541931152
Epoch: 38, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.415 Vali Acc: 0.856 Test Loss: 0.415 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9146947860717773
Epoch: 39, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.416 Vali Acc: 0.859 Test Loss: 0.416 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9241557121276855
Epoch: 40, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.423 Vali Acc: 0.859 Test Loss: 0.423 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8646905422210693
Epoch: 41, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.422 Vali Acc: 0.863 Test Loss: 0.422 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8447010517120361
Epoch: 42, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.420 Vali Acc: 0.859 Test Loss: 0.420 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7662820816040039
Epoch: 43, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.420 Vali Acc: 0.859 Test Loss: 0.420 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.826042890548706
Epoch: 44, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.420 Vali Acc: 0.863 Test Loss: 0.420 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8183262348175049
Epoch: 45, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.422 Vali Acc: 0.859 Test Loss: 0.422 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8370590209960938
Epoch: 46, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.424 Vali Acc: 0.859 Test Loss: 0.424 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7938408851623535
Epoch: 47, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.421 Vali Acc: 0.863 Test Loss: 0.421 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 50024
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.333437442779541
Epoch: 1, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.946 Vali Acc: 0.175 Test Loss: 1.946 Test Acc: 0.175
Validation loss decreased (inf --> -0.174981).  Saving model ...
Epoch: 2 cost time: 0.9490618705749512
Epoch: 2, Steps: 8 | Train Loss: 1.794 Vali Loss: 1.458 Vali Acc: 0.591 Test Loss: 1.458 Test Acc: 0.591
Validation loss decreased (-0.174981 --> -0.590610).  Saving model ...
Epoch: 3 cost time: 0.7553615570068359
Epoch: 3, Steps: 8 | Train Loss: 1.208 Vali Loss: 0.984 Vali Acc: 0.772 Test Loss: 0.984 Test Acc: 0.772
Validation loss decreased (-0.590610 --> -0.771865).  Saving model ...
Epoch: 4 cost time: 0.8057518005371094
Epoch: 4, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.691 Vali Acc: 0.812 Test Loss: 0.691 Test Acc: 0.812
Validation loss decreased (-0.771865 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 0.7889385223388672
Epoch: 5, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.8423285484313965
Epoch: 6, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.6973745822906494
Epoch: 7, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6927287578582764
Epoch: 8, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.7919058799743652
Epoch: 9, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.8069026470184326
Epoch: 10, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.8101165294647217
Epoch: 11, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.857804536819458
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.570 Vali Acc: 0.834 Test Loss: 0.570 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6751117706298828
Epoch: 13, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.880103588104248
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.752105712890625
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.644 Vali Acc: 0.834 Test Loss: 0.644 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8019087314605713
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.666 Vali Acc: 0.834 Test Loss: 0.666 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8254275321960449
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.669 Vali Acc: 0.834 Test Loss: 0.669 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8280124664306641
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.682 Vali Acc: 0.834 Test Loss: 0.682 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.840827226638794
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.694 Vali Acc: 0.831 Test Loss: 0.694 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8015463352203369
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.704 Vali Acc: 0.838 Test Loss: 0.704 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 85640
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5201644897460938
Epoch: 1, Steps: 8 | Train Loss: 2.263 Vali Loss: 2.098 Vali Acc: 0.134 Test Loss: 2.098 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 0.7746765613555908
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.848 Vali Acc: 0.322 Test Loss: 1.848 Test Acc: 0.322
Validation loss decreased (-0.134354 --> -0.321857).  Saving model ...
Epoch: 3 cost time: 0.8340964317321777
Epoch: 3, Steps: 8 | Train Loss: 1.710 Vali Loss: 1.517 Vali Acc: 0.709 Test Loss: 1.517 Test Acc: 0.709
Validation loss decreased (-0.321857 --> -0.709360).  Saving model ...
Epoch: 4 cost time: 0.8325586318969727
Epoch: 4, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.181 Vali Acc: 0.794 Test Loss: 1.181 Test Acc: 0.794
Validation loss decreased (-0.709360 --> -0.793738).  Saving model ...
Epoch: 5 cost time: 0.9163241386413574
Epoch: 5, Steps: 8 | Train Loss: 1.065 Vali Loss: 0.915 Vali Acc: 0.800 Test Loss: 0.915 Test Acc: 0.800
Validation loss decreased (-0.793738 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 0.8797755241394043
Epoch: 6, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.8802175521850586
Epoch: 7, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 0.847498893737793
Epoch: 8, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.9394865036010742
Epoch: 9, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
Validation loss decreased (-0.815619 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.8892123699188232
Epoch: 10, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.8257324695587158
Epoch: 11, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.7813513278961182
Epoch: 12, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.9977731704711914
Epoch: 13, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8742742538452148
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8827681541442871
Epoch: 15, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9873249530792236
Epoch: 16, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.779059886932373
Epoch: 17, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7710652351379395
Epoch: 18, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.8035132884979248
Epoch: 19, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.752509355545044
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8589880466461182
Epoch: 21, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.586 Vali Acc: 0.834 Test Loss: 0.586 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.866142988204956
Epoch: 22, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.592 Vali Acc: 0.838 Test Loss: 0.592 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7264461517333984
Epoch: 23, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.595 Vali Acc: 0.838 Test Loss: 0.595 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8388476371765137
Epoch: 24, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.609 Vali Acc: 0.834 Test Loss: 0.609 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8193066120147705
Epoch: 25, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.619 Vali Acc: 0.834 Test Loss: 0.619 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8398942947387695
Epoch: 26, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.618 Vali Acc: 0.834 Test Loss: 0.618 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9516162872314453
Epoch: 27, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7152020931243896
Epoch: 28, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.618 Vali Acc: 0.834 Test Loss: 0.618 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 55944
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3665783405303955
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 2.008 Vali Acc: 0.284 Test Loss: 2.008 Test Acc: 0.284
Validation loss decreased (inf --> -0.284355).  Saving model ...
Epoch: 2 cost time: 0.7131335735321045
Epoch: 2, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.818 Vali Acc: 0.388 Test Loss: 1.818 Test Acc: 0.388
Validation loss decreased (-0.284355 --> -0.387482).  Saving model ...
Epoch: 3 cost time: 0.8258175849914551
Epoch: 3, Steps: 8 | Train Loss: 1.756 Vali Loss: 1.580 Vali Acc: 0.541 Test Loss: 1.580 Test Acc: 0.541
Validation loss decreased (-0.387482 --> -0.540609).  Saving model ...
Epoch: 4 cost time: 0.7854866981506348
Epoch: 4, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.319 Vali Acc: 0.681 Test Loss: 1.319 Test Acc: 0.681
Validation loss decreased (-0.540609 --> -0.681237).  Saving model ...
Epoch: 5 cost time: 0.833521842956543
Epoch: 5, Steps: 8 | Train Loss: 1.297 Vali Loss: 1.084 Vali Acc: 0.756 Test Loss: 1.084 Test Acc: 0.756
Validation loss decreased (-0.681237 --> -0.756239).  Saving model ...
Epoch: 6 cost time: 0.8534078598022461
Epoch: 6, Steps: 8 | Train Loss: 0.998 Vali Loss: 0.885 Vali Acc: 0.784 Test Loss: 0.885 Test Acc: 0.784
Validation loss decreased (-0.756239 --> -0.784366).  Saving model ...
Epoch: 7 cost time: 0.7973408699035645
Epoch: 7, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
Validation loss decreased (-0.784366 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.818495512008667
Epoch: 8, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.643 Vali Acc: 0.812 Test Loss: 0.643 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.8824460506439209
Epoch: 9, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.812494 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.6929111480712891
Epoch: 10, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8921103477478027
Epoch: 11, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 12 cost time: 0.891756534576416
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.7906708717346191
Epoch: 13, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 0.725820779800415
Epoch: 14, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 0.7073354721069336
Epoch: 15, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8531734943389893
Epoch: 16, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8348538875579834
Epoch: 17, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7357535362243652
Epoch: 18, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6769046783447266
Epoch: 19, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.828911304473877
Epoch: 20, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7349319458007812
Epoch: 21, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.943181037902832
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9593226909637451
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9676411151885986
Epoch: 24, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 46216
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5570425987243652
Epoch: 1, Steps: 8 | Train Loss: 2.236 Vali Loss: 2.121 Vali Acc: 0.156 Test Loss: 2.121 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.7894058227539062
Epoch: 2, Steps: 8 | Train Loss: 2.093 Vali Loss: 1.933 Vali Acc: 0.263 Test Loss: 1.933 Test Acc: 0.263
Validation loss decreased (-0.156229 --> -0.262481).  Saving model ...
Epoch: 3 cost time: 0.7476286888122559
Epoch: 3, Steps: 8 | Train Loss: 1.884 Vali Loss: 1.710 Vali Acc: 0.453 Test Loss: 1.710 Test Acc: 0.453
Validation loss decreased (-0.262481 --> -0.453108).  Saving model ...
Epoch: 4 cost time: 0.8166975975036621
Epoch: 4, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.484 Vali Acc: 0.619 Test Loss: 1.484 Test Acc: 0.619
Validation loss decreased (-0.453108 --> -0.618735).  Saving model ...
Epoch: 5 cost time: 0.846022367477417
Epoch: 5, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.271 Vali Acc: 0.719 Test Loss: 1.271 Test Acc: 0.719
Validation loss decreased (-0.618735 --> -0.718737).  Saving model ...
Epoch: 6 cost time: 0.7623488903045654
Epoch: 6, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.073 Vali Acc: 0.759 Test Loss: 1.073 Test Acc: 0.759
Validation loss decreased (-0.718737 --> -0.759364).  Saving model ...
Epoch: 7 cost time: 0.8752214908599854
Epoch: 7, Steps: 8 | Train Loss: 1.064 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
Validation loss decreased (-0.759364 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.7940673828125
Epoch: 8, Steps: 8 | Train Loss: 0.850 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
Validation loss decreased (-0.799991 --> -0.803117).  Saving model ...
Epoch: 9 cost time: 0.9187827110290527
Epoch: 9, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.803117 --> -0.809368).  Saving model ...
Epoch: 10 cost time: 0.8724114894866943
Epoch: 10, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.622 Vali Acc: 0.809 Test Loss: 0.622 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809369).  Saving model ...
Epoch: 11 cost time: 0.8440499305725098
Epoch: 11, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.582 Vali Acc: 0.806 Test Loss: 0.582 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8191795349121094
Epoch: 12, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818745).  Saving model ...
Epoch: 13 cost time: 0.8338522911071777
Epoch: 13, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
Validation loss decreased (-0.818745 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.7923290729522705
Epoch: 14, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.7956433296203613
Epoch: 15, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 0.7623333930969238
Epoch: 16, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 0.8592231273651123
Epoch: 17, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 0.8298444747924805
Epoch: 18, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.7687876224517822
Epoch: 19, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 20 cost time: 0.7984898090362549
Epoch: 20, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7454900741577148
Epoch: 21, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8140671253204346
Epoch: 22, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.806351900100708
Epoch: 23, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7929327487945557
Epoch: 24, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8498847484588623
Epoch: 25, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7753243446350098
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 27 cost time: 0.7691431045532227
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 28 cost time: 0.8002629280090332
Epoch: 28, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 29 cost time: 0.7984929084777832
Epoch: 29, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7885541915893555
Epoch: 30, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8842554092407227
Epoch: 31, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.505 Vali Acc: 0.853 Test Loss: 0.505 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9174590110778809
Epoch: 32, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7727351188659668
Epoch: 33, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7985937595367432
Epoch: 34, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.847 Test Loss: 0.524 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8947992324829102
Epoch: 35, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8010764122009277
Epoch: 36, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8694627285003662
Epoch: 37, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7391989231109619
Epoch: 38, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 41096
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5264790058135986
Epoch: 1, Steps: 8 | Train Loss: 2.097 Vali Loss: 2.074 Vali Acc: 0.209 Test Loss: 2.074 Test Acc: 0.209
Validation loss decreased (inf --> -0.209354).  Saving model ...
Epoch: 2 cost time: 0.7095732688903809
Epoch: 2, Steps: 8 | Train Loss: 2.041 Vali Loss: 1.921 Vali Acc: 0.269 Test Loss: 1.921 Test Acc: 0.269
Validation loss decreased (-0.209354 --> -0.268731).  Saving model ...
Epoch: 3 cost time: 0.7692196369171143
Epoch: 3, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.727 Vali Acc: 0.406 Test Loss: 1.727 Test Acc: 0.406
Validation loss decreased (-0.268731 --> -0.406233).  Saving model ...
Epoch: 4 cost time: 0.7647547721862793
Epoch: 4, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.519 Vali Acc: 0.534 Test Loss: 1.519 Test Acc: 0.534
Validation loss decreased (-0.406233 --> -0.534360).  Saving model ...
Epoch: 5 cost time: 0.712428092956543
Epoch: 5, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.309 Vali Acc: 0.656 Test Loss: 1.309 Test Acc: 0.656
Validation loss decreased (-0.534360 --> -0.656237).  Saving model ...
Epoch: 6 cost time: 0.8159537315368652
Epoch: 6, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.130 Vali Acc: 0.722 Test Loss: 1.130 Test Acc: 0.722
Validation loss decreased (-0.656237 --> -0.721864).  Saving model ...
Epoch: 7 cost time: 0.7850654125213623
Epoch: 7, Steps: 8 | Train Loss: 1.109 Vali Loss: 0.971 Vali Acc: 0.759 Test Loss: 0.971 Test Acc: 0.759
Validation loss decreased (-0.721864 --> -0.759365).  Saving model ...
Epoch: 8 cost time: 0.7937161922454834
Epoch: 8, Steps: 8 | Train Loss: 0.969 Vali Loss: 0.846 Vali Acc: 0.772 Test Loss: 0.846 Test Acc: 0.772
Validation loss decreased (-0.759365 --> -0.771867).  Saving model ...
Epoch: 9 cost time: 0.8059737682342529
Epoch: 9, Steps: 8 | Train Loss: 0.817 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
Validation loss decreased (-0.771867 --> -0.793743).  Saving model ...
Epoch: 10 cost time: 0.8969337940216064
Epoch: 10, Steps: 8 | Train Loss: 0.684 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803118).  Saving model ...
Epoch: 11 cost time: 0.8537335395812988
Epoch: 11, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0062222480773926
Epoch: 12, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 13 cost time: 0.7871665954589844
Epoch: 13, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.938269853591919
Epoch: 14, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809370).  Saving model ...
Epoch: 15 cost time: 0.7596650123596191
Epoch: 15, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
Validation loss decreased (-0.809370 --> -0.812495).  Saving model ...
Epoch: 16 cost time: 0.7660284042358398
Epoch: 16, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8319389820098877
Epoch: 17, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
Validation loss decreased (-0.812495 --> -0.821870).  Saving model ...
Epoch: 18 cost time: 0.8338949680328369
Epoch: 18, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 0.8640656471252441
Epoch: 19, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.504 Vali Acc: 0.825 Test Loss: 0.504 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8286635875701904
Epoch: 20, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 21 cost time: 0.7521669864654541
Epoch: 21, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8097548484802246
Epoch: 22, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 23 cost time: 0.7952098846435547
Epoch: 23, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8164184093475342
Epoch: 24, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7455484867095947
Epoch: 25, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7567789554595947
Epoch: 26, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7601490020751953
Epoch: 27, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8861002922058105
Epoch: 28, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7693252563476562
Epoch: 29, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7219991683959961
Epoch: 30, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 31 cost time: 0.7558059692382812
Epoch: 31, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 32 cost time: 0.8385424613952637
Epoch: 32, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 33 cost time: 0.8324620723724365
Epoch: 33, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.771723747253418
Epoch: 34, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7709059715270996
Epoch: 35, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9542145729064941
Epoch: 36, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8343861103057861
Epoch: 37, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7975218296051025
Epoch: 38, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8017446994781494
Epoch: 39, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 0.773841381072998
Epoch: 40, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 41 cost time: 0.872711181640625
Epoch: 41, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8644442558288574
Epoch: 42, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8010263442993164
Epoch: 43, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.515 Vali Acc: 0.859 Test Loss: 0.515 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 44 cost time: 0.8588874340057373
Epoch: 44, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.517 Vali Acc: 0.859 Test Loss: 0.517 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9747002124786377
Epoch: 45, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9225618839263916
Epoch: 46, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.524 Vali Acc: 0.863 Test Loss: 0.524 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 47 cost time: 0.9596374034881592
Epoch: 47, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8088729381561279
Epoch: 48, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9005193710327148
Epoch: 49, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9334702491760254
Epoch: 50, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7389869689941406
Epoch: 51, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.537 Vali Acc: 0.863 Test Loss: 0.537 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8648490905761719
Epoch: 52, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.952949047088623
Epoch: 53, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.537 Vali Acc: 0.863 Test Loss: 0.537 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9088819026947021
Epoch: 54, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8655824661254883
Epoch: 55, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9467864036560059
Epoch: 56, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.548 Vali Acc: 0.859 Test Loss: 0.548 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 37000
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3769869804382324
Epoch: 1, Steps: 8 | Train Loss: 2.223 Vali Loss: 2.159 Vali Acc: 0.153 Test Loss: 2.159 Test Acc: 0.153
Validation loss decreased (inf --> -0.153103).  Saving model ...
Epoch: 2 cost time: 0.7599644660949707
Epoch: 2, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.044 Vali Acc: 0.206 Test Loss: 2.044 Test Acc: 0.206
Validation loss decreased (-0.153103 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 0.7595598697662354
Epoch: 3, Steps: 8 | Train Loss: 1.985 Vali Loss: 1.879 Vali Acc: 0.319 Test Loss: 1.879 Test Acc: 0.319
Validation loss decreased (-0.206230 --> -0.318731).  Saving model ...
Epoch: 4 cost time: 0.7676868438720703
Epoch: 4, Steps: 8 | Train Loss: 1.822 Vali Loss: 1.697 Vali Acc: 0.456 Test Loss: 1.697 Test Acc: 0.456
Validation loss decreased (-0.318731 --> -0.456233).  Saving model ...
Epoch: 5 cost time: 0.7941792011260986
Epoch: 5, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.510 Vali Acc: 0.588 Test Loss: 1.510 Test Acc: 0.588
Validation loss decreased (-0.456233 --> -0.587485).  Saving model ...
Epoch: 6 cost time: 0.8360373973846436
Epoch: 6, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.338 Vali Acc: 0.678 Test Loss: 1.338 Test Acc: 0.678
Validation loss decreased (-0.587485 --> -0.678112).  Saving model ...
Epoch: 7 cost time: 0.7805216312408447
Epoch: 7, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.183 Vali Acc: 0.722 Test Loss: 1.183 Test Acc: 0.722
Validation loss decreased (-0.678112 --> -0.721863).  Saving model ...
Epoch: 8 cost time: 0.7842617034912109
Epoch: 8, Steps: 8 | Train Loss: 1.096 Vali Loss: 1.056 Vali Acc: 0.747 Test Loss: 1.056 Test Acc: 0.747
Validation loss decreased (-0.721863 --> -0.746864).  Saving model ...
Epoch: 9 cost time: 0.8658285140991211
Epoch: 9, Steps: 8 | Train Loss: 0.970 Vali Loss: 0.940 Vali Acc: 0.766 Test Loss: 0.940 Test Acc: 0.766
Validation loss decreased (-0.746864 --> -0.765616).  Saving model ...
Epoch: 10 cost time: 0.8043115139007568
Epoch: 10, Steps: 8 | Train Loss: 0.861 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
Validation loss decreased (-0.765616 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.7763597965240479
Epoch: 11, Steps: 8 | Train Loss: 0.774 Vali Loss: 0.774 Vali Acc: 0.778 Test Loss: 0.774 Test Acc: 0.778
Validation loss decreased (-0.774991 --> -0.778117).  Saving model ...
Epoch: 12 cost time: 0.7496383190155029
Epoch: 12, Steps: 8 | Train Loss: 0.719 Vali Loss: 0.722 Vali Acc: 0.794 Test Loss: 0.722 Test Acc: 0.794
Validation loss decreased (-0.778117 --> -0.793743).  Saving model ...
Epoch: 13 cost time: 0.7343921661376953
Epoch: 13, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.676 Vali Acc: 0.797 Test Loss: 0.676 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 14 cost time: 0.7251574993133545
Epoch: 14, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 0.8514363765716553
Epoch: 15, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.616 Vali Acc: 0.794 Test Loss: 0.616 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8324368000030518
Epoch: 16, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.599 Vali Acc: 0.794 Test Loss: 0.599 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7392723560333252
Epoch: 17, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 0.7714402675628662
Epoch: 18, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
Validation loss decreased (-0.799994 --> -0.815619).  Saving model ...
Epoch: 19 cost time: 0.816617488861084
Epoch: 19, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818745).  Saving model ...
Epoch: 20 cost time: 0.9223251342773438
Epoch: 20, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 21 cost time: 0.8515141010284424
Epoch: 21, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8513011932373047
Epoch: 22, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 23 cost time: 0.88460373878479
Epoch: 23, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.926236629486084
Epoch: 24, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 25 cost time: 0.8544807434082031
Epoch: 25, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 26 cost time: 0.7706437110900879
Epoch: 26, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7967545986175537
Epoch: 27, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7947719097137451
Epoch: 28, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 29 cost time: 0.7454133033752441
Epoch: 29, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7199633121490479
Epoch: 30, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7612974643707275
Epoch: 31, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.70762038230896
Epoch: 32, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7192964553833008
Epoch: 33, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 34 cost time: 0.7665555477142334
Epoch: 34, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7620706558227539
Epoch: 35, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 36 cost time: 0.7496771812438965
Epoch: 36, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7138056755065918
Epoch: 37, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7945897579193115
Epoch: 38, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7469310760498047
Epoch: 39, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7714297771453857
Epoch: 40, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8293361663818359
Epoch: 41, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6890976428985596
Epoch: 42, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7082452774047852
Epoch: 43, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7816977500915527
Epoch: 44, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6243607997894287
Epoch: 45, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 34408
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4534687995910645
Epoch: 1, Steps: 8 | Train Loss: 2.243 Vali Loss: 2.211 Vali Acc: 0.138 Test Loss: 2.211 Test Acc: 0.138
Validation loss decreased (inf --> -0.137478).  Saving model ...
Epoch: 2 cost time: 0.8196167945861816
Epoch: 2, Steps: 8 | Train Loss: 2.170 Vali Loss: 2.093 Vali Acc: 0.200 Test Loss: 2.093 Test Acc: 0.200
Validation loss decreased (-0.137478 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 0.7891578674316406
Epoch: 3, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.947 Vali Acc: 0.284 Test Loss: 1.947 Test Acc: 0.284
Validation loss decreased (-0.199979 --> -0.284356).  Saving model ...
Epoch: 4 cost time: 0.6936936378479004
Epoch: 4, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.782 Vali Acc: 0.366 Test Loss: 1.782 Test Acc: 0.366
Validation loss decreased (-0.284356 --> -0.365607).  Saving model ...
Epoch: 5 cost time: 0.7703745365142822
Epoch: 5, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.613 Vali Acc: 0.491 Test Loss: 1.613 Test Acc: 0.491
Validation loss decreased (-0.365607 --> -0.490609).  Saving model ...
Epoch: 6 cost time: 0.7659409046173096
Epoch: 6, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.449 Vali Acc: 0.597 Test Loss: 1.449 Test Acc: 0.597
Validation loss decreased (-0.490609 --> -0.596861).  Saving model ...
Epoch: 7 cost time: 0.8525955677032471
Epoch: 7, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.300 Vali Acc: 0.644 Test Loss: 1.300 Test Acc: 0.644
Validation loss decreased (-0.596861 --> -0.643737).  Saving model ...
Epoch: 8 cost time: 0.868330717086792
Epoch: 8, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.167 Vali Acc: 0.681 Test Loss: 1.167 Test Acc: 0.681
Validation loss decreased (-0.643737 --> -0.681238).  Saving model ...
Epoch: 9 cost time: 0.8457367420196533
Epoch: 9, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.044 Vali Acc: 0.709 Test Loss: 1.044 Test Acc: 0.709
Validation loss decreased (-0.681238 --> -0.709365).  Saving model ...
Epoch: 10 cost time: 0.695213794708252
Epoch: 10, Steps: 8 | Train Loss: 1.001 Vali Loss: 0.948 Vali Acc: 0.728 Test Loss: 0.948 Test Acc: 0.728
Validation loss decreased (-0.709365 --> -0.728116).  Saving model ...
Epoch: 11 cost time: 0.7019329071044922
Epoch: 11, Steps: 8 | Train Loss: 0.911 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
Validation loss decreased (-0.728116 --> -0.756241).  Saving model ...
Epoch: 12 cost time: 0.7682468891143799
Epoch: 12, Steps: 8 | Train Loss: 0.787 Vali Loss: 0.796 Vali Acc: 0.778 Test Loss: 0.796 Test Acc: 0.778
Validation loss decreased (-0.756241 --> -0.778117).  Saving model ...
Epoch: 13 cost time: 0.7532331943511963
Epoch: 13, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.740 Vali Acc: 0.787 Test Loss: 0.740 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787493).  Saving model ...
Epoch: 14 cost time: 0.7668704986572266
Epoch: 14, Steps: 8 | Train Loss: 0.662 Vali Loss: 0.704 Vali Acc: 0.791 Test Loss: 0.704 Test Acc: 0.791
Validation loss decreased (-0.787493 --> -0.790618).  Saving model ...
Epoch: 15 cost time: 0.7734673023223877
Epoch: 15, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.671 Vali Acc: 0.797 Test Loss: 0.671 Test Acc: 0.797
Validation loss decreased (-0.790618 --> -0.796868).  Saving model ...
Epoch: 16 cost time: 0.8328721523284912
Epoch: 16, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.639 Vali Acc: 0.800 Test Loss: 0.639 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 0.7664680480957031
Epoch: 17, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.617 Vali Acc: 0.806 Test Loss: 0.617 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.806244).  Saving model ...
Epoch: 18 cost time: 0.8214290142059326
Epoch: 18, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.598 Vali Acc: 0.806 Test Loss: 0.598 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 19 cost time: 0.7872104644775391
Epoch: 19, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 20 cost time: 0.7787926197052002
Epoch: 20, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 21 cost time: 0.778212308883667
Epoch: 21, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 0.7523384094238281
Epoch: 22, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 23 cost time: 0.8612236976623535
Epoch: 23, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 0.7646298408508301
Epoch: 24, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9323678016662598
Epoch: 25, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 26 cost time: 0.8588151931762695
Epoch: 26, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 27 cost time: 0.8252859115600586
Epoch: 27, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8192579746246338
Epoch: 28, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8309803009033203
Epoch: 29, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7413516044616699
Epoch: 30, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7699568271636963
Epoch: 31, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.793734073638916
Epoch: 32, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 33 cost time: 0.8170256614685059
Epoch: 33, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 34 cost time: 0.736851692199707
Epoch: 34, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8635284900665283
Epoch: 35, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7408366203308105
Epoch: 36, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7974452972412109
Epoch: 37, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7688937187194824
Epoch: 38, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 39 cost time: 0.6941878795623779
Epoch: 39, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 40 cost time: 0.7390491962432861
Epoch: 40, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.452 Vali Acc: 0.844 Test Loss: 0.452 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7287240028381348
Epoch: 41, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 42 cost time: 0.7690894603729248
Epoch: 42, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6663811206817627
Epoch: 43, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7421932220458984
Epoch: 44, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.445 Vali Acc: 0.847 Test Loss: 0.445 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8409438133239746
Epoch: 45, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8161156177520752
Epoch: 46, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.440 Vali Acc: 0.853 Test Loss: 0.440 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853121).  Saving model ...
Epoch: 47 cost time: 0.8778414726257324
Epoch: 47, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
Validation loss decreased (-0.853121 --> -0.856246).  Saving model ...
Epoch: 48 cost time: 0.8565573692321777
Epoch: 48, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8608856201171875
Epoch: 49, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7450695037841797
Epoch: 50, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
Validation loss decreased (-0.856246 --> -0.862496).  Saving model ...
Epoch: 51 cost time: 0.8249123096466064
Epoch: 51, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.441 Vali Acc: 0.859 Test Loss: 0.441 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7919816970825195
Epoch: 52, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.441 Vali Acc: 0.863 Test Loss: 0.441 Test Acc: 0.863
Validation loss decreased (-0.862496 --> -0.862496).  Saving model ...
Epoch: 53 cost time: 0.8009231090545654
Epoch: 53, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.444 Vali Acc: 0.863 Test Loss: 0.444 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8693361282348633
Epoch: 54, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7702426910400391
Epoch: 55, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8218448162078857
Epoch: 56, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9019169807434082
Epoch: 57, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.8324239253997803
Epoch: 58, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9167838096618652
Epoch: 59, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.8243980407714844
Epoch: 60, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.9733600616455078
Epoch: 61, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.7746191024780273
Epoch: 62, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 33384
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.817723274230957
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.932 Vali Acc: 0.253 Test Loss: 1.932 Test Acc: 0.253
Validation loss decreased (inf --> -0.253106).  Saving model ...
Epoch: 2 cost time: 0.8630223274230957
Epoch: 2, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.432 Vali Acc: 0.631 Test Loss: 1.432 Test Acc: 0.631
Validation loss decreased (-0.253106 --> -0.631236).  Saving model ...
Epoch: 3 cost time: 0.9031727313995361
Epoch: 3, Steps: 8 | Train Loss: 1.231 Vali Loss: 0.992 Vali Acc: 0.744 Test Loss: 0.992 Test Acc: 0.744
Validation loss decreased (-0.631236 --> -0.743740).  Saving model ...
Epoch: 4 cost time: 0.8540828227996826
Epoch: 4, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
Validation loss decreased (-0.743740 --> -0.796868).  Saving model ...
Epoch: 5 cost time: 1.0766243934631348
Epoch: 5, Steps: 8 | Train Loss: 0.584 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
Validation loss decreased (-0.796868 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.9350004196166992
Epoch: 6, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 0.9597065448760986
Epoch: 7, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.815619 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.9254992008209229
Epoch: 8, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9147918224334717
Epoch: 9, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.834317684173584
Epoch: 10, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8054709434509277
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7608273029327393
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8005294799804688
Epoch: 13, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.577 Vali Acc: 0.834 Test Loss: 0.577 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8560857772827148
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.621 Vali Acc: 0.834 Test Loss: 0.621 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8875234127044678
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.636 Vali Acc: 0.834 Test Loss: 0.636 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8307008743286133
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.639 Vali Acc: 0.831 Test Loss: 0.639 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8176651000976562
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.635 Vali Acc: 0.834 Test Loss: 0.635 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 77320
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.685107469558716
Epoch: 1, Steps: 8 | Train Loss: 2.197 Vali Loss: 2.029 Vali Acc: 0.259 Test Loss: 2.029 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 0.8242619037628174
Epoch: 2, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.765 Vali Acc: 0.475 Test Loss: 1.765 Test Acc: 0.475
Validation loss decreased (-0.259355 --> -0.474982).  Saving model ...
Epoch: 3 cost time: 0.9046571254730225
Epoch: 3, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.437 Vali Acc: 0.681 Test Loss: 1.437 Test Acc: 0.681
Validation loss decreased (-0.474982 --> -0.681236).  Saving model ...
Epoch: 4 cost time: 0.833989143371582
Epoch: 4, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.138 Vali Acc: 0.778 Test Loss: 1.138 Test Acc: 0.778
Validation loss decreased (-0.681236 --> -0.778114).  Saving model ...
Epoch: 5 cost time: 0.8214950561523438
Epoch: 5, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.900 Vali Acc: 0.794 Test Loss: 0.900 Test Acc: 0.794
Validation loss decreased (-0.778114 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 0.9112436771392822
Epoch: 6, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.722 Vali Acc: 0.822 Test Loss: 0.722 Test Acc: 0.822
Validation loss decreased (-0.793741 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 0.8221712112426758
Epoch: 7, Steps: 8 | Train Loss: 0.639 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8350882530212402
Epoch: 8, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
Validation loss decreased (-0.821868 --> -0.837494).  Saving model ...
Epoch: 9 cost time: 0.8641984462738037
Epoch: 9, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8031313419342041
Epoch: 10, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8821892738342285
Epoch: 11, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7923166751861572
Epoch: 12, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.827857255935669
Epoch: 13, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7806496620178223
Epoch: 14, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.8291330337524414
Epoch: 15, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8119628429412842
Epoch: 16, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8575747013092041
Epoch: 17, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8389661312103271
Epoch: 18, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8202145099639893
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8276283740997314
Epoch: 20, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9557743072509766
Epoch: 21, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9007587432861328
Epoch: 22, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8726365566253662
Epoch: 23, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.585 Vali Acc: 0.831 Test Loss: 0.585 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9521703720092773
Epoch: 24, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 47624
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7997853755950928
Epoch: 1, Steps: 8 | Train Loss: 1.940 Vali Loss: 1.825 Vali Acc: 0.369 Test Loss: 1.825 Test Acc: 0.369
Validation loss decreased (inf --> -0.368732).  Saving model ...
Epoch: 2 cost time: 0.904930830001831
Epoch: 2, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.641 Vali Acc: 0.547 Test Loss: 1.641 Test Acc: 0.547
Validation loss decreased (-0.368732 --> -0.546859).  Saving model ...
Epoch: 3 cost time: 0.9172677993774414
Epoch: 3, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.417 Vali Acc: 0.641 Test Loss: 1.417 Test Acc: 0.641
Validation loss decreased (-0.546859 --> -0.640611).  Saving model ...
Epoch: 4 cost time: 0.845186710357666
Epoch: 4, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.187 Vali Acc: 0.719 Test Loss: 1.187 Test Acc: 0.719
Validation loss decreased (-0.640611 --> -0.718738).  Saving model ...
Epoch: 5 cost time: 0.7844626903533936
Epoch: 5, Steps: 8 | Train Loss: 1.092 Vali Loss: 0.984 Vali Acc: 0.738 Test Loss: 0.984 Test Acc: 0.738
Validation loss decreased (-0.718738 --> -0.737490).  Saving model ...
Epoch: 6 cost time: 0.9173746109008789
Epoch: 6, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.818 Vali Acc: 0.781 Test Loss: 0.818 Test Acc: 0.781
Validation loss decreased (-0.737490 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.8038835525512695
Epoch: 7, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
Validation loss decreased (-0.781242 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.8075799942016602
Epoch: 8, Steps: 8 | Train Loss: 0.595 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 0.86928391456604
Epoch: 9, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.7983982563018799
Epoch: 10, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9466910362243652
Epoch: 11, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.8507366180419922
Epoch: 12, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 0.7624542713165283
Epoch: 13, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.8416194915771484
Epoch: 14, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.8196392059326172
Epoch: 15, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.010197639465332
Epoch: 16, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.7672760486602783
Epoch: 17, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 0.7300021648406982
Epoch: 18, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8905274868011475
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7826039791107178
Epoch: 20, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 0.9022893905639648
Epoch: 21, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9159698486328125
Epoch: 22, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.865196704864502
Epoch: 23, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9545559883117676
Epoch: 24, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7578160762786865
Epoch: 25, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8017470836639404
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8726685047149658
Epoch: 27, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.789863109588623
Epoch: 28, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7975790500640869
Epoch: 29, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9031102657318115
Epoch: 30, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 37896
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4925498962402344
Epoch: 1, Steps: 8 | Train Loss: 2.202 Vali Loss: 2.141 Vali Acc: 0.147 Test Loss: 2.141 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.7879085540771484
Epoch: 2, Steps: 8 | Train Loss: 2.093 Vali Loss: 1.982 Vali Acc: 0.269 Test Loss: 1.982 Test Acc: 0.269
Validation loss decreased (-0.146854 --> -0.268730).  Saving model ...
Epoch: 3 cost time: 0.8905010223388672
Epoch: 3, Steps: 8 | Train Loss: 1.915 Vali Loss: 1.767 Vali Acc: 0.431 Test Loss: 1.767 Test Acc: 0.431
Validation loss decreased (-0.268730 --> -0.431232).  Saving model ...
Epoch: 4 cost time: 0.8276083469390869
Epoch: 4, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.536 Vali Acc: 0.588 Test Loss: 1.536 Test Acc: 0.588
Validation loss decreased (-0.431232 --> -0.587485).  Saving model ...
Epoch: 5 cost time: 0.8227171897888184
Epoch: 5, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.309 Vali Acc: 0.691 Test Loss: 1.309 Test Acc: 0.691
Validation loss decreased (-0.587485 --> -0.690612).  Saving model ...
Epoch: 6 cost time: 0.8785533905029297
Epoch: 6, Steps: 8 | Train Loss: 1.254 Vali Loss: 1.108 Vali Acc: 0.747 Test Loss: 1.108 Test Acc: 0.747
Validation loss decreased (-0.690612 --> -0.746864).  Saving model ...
Epoch: 7 cost time: 0.8230528831481934
Epoch: 7, Steps: 8 | Train Loss: 1.057 Vali Loss: 0.940 Vali Acc: 0.769 Test Loss: 0.940 Test Acc: 0.769
Validation loss decreased (-0.746864 --> -0.768741).  Saving model ...
Epoch: 8 cost time: 0.9140913486480713
Epoch: 8, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.799 Vali Acc: 0.787 Test Loss: 0.799 Test Acc: 0.787
Validation loss decreased (-0.768741 --> -0.787492).  Saving model ...
Epoch: 9 cost time: 0.8644046783447266
Epoch: 9, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.694 Vali Acc: 0.794 Test Loss: 0.694 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 10 cost time: 0.8201138973236084
Epoch: 10, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 0.8505151271820068
Epoch: 11, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
Validation loss decreased (-0.799994 --> -0.812494).  Saving model ...
Epoch: 12 cost time: 0.901099681854248
Epoch: 12, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812495).  Saving model ...
Epoch: 13 cost time: 0.7797229290008545
Epoch: 13, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8354713916778564
Epoch: 14, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
Validation loss decreased (-0.812495 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 0.9503676891326904
Epoch: 15, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.501 Vali Acc: 0.825 Test Loss: 0.501 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 16 cost time: 0.9258480072021484
Epoch: 16, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.495 Vali Acc: 0.828 Test Loss: 0.495 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 17 cost time: 1.0841031074523926
Epoch: 17, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8127367496490479
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.485 Vali Acc: 0.831 Test Loss: 0.485 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 19 cost time: 0.9399900436401367
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.481 Vali Acc: 0.834 Test Loss: 0.481 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 20 cost time: 0.8433351516723633
Epoch: 20, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 0.9568545818328857
Epoch: 21, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.482 Vali Acc: 0.834 Test Loss: 0.482 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.732379674911499
Epoch: 22, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.486 Vali Acc: 0.834 Test Loss: 0.486 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8829159736633301
Epoch: 23, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.492 Vali Acc: 0.831 Test Loss: 0.492 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9164791107177734
Epoch: 24, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.496 Vali Acc: 0.831 Test Loss: 0.496 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9866864681243896
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9514598846435547
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.493 Vali Acc: 0.831 Test Loss: 0.493 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0615403652191162
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8951878547668457
Epoch: 28, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8274428844451904
Epoch: 29, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.813495397567749
Epoch: 30, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 32776
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.399641275405884
Epoch: 1, Steps: 8 | Train Loss: 2.270 Vali Loss: 2.126 Vali Acc: 0.159 Test Loss: 2.126 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.9249212741851807
Epoch: 2, Steps: 8 | Train Loss: 2.083 Vali Loss: 1.981 Vali Acc: 0.216 Test Loss: 1.981 Test Acc: 0.216
Validation loss decreased (-0.159354 --> -0.215605).  Saving model ...
Epoch: 3 cost time: 0.9938173294067383
Epoch: 3, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.783 Vali Acc: 0.394 Test Loss: 1.783 Test Acc: 0.394
Validation loss decreased (-0.215605 --> -0.393732).  Saving model ...
Epoch: 4 cost time: 0.8376989364624023
Epoch: 4, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.565 Vali Acc: 0.525 Test Loss: 1.565 Test Acc: 0.525
Validation loss decreased (-0.393732 --> -0.524984).  Saving model ...
Epoch: 5 cost time: 0.7923719882965088
Epoch: 5, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.356 Vali Acc: 0.688 Test Loss: 1.356 Test Acc: 0.688
Validation loss decreased (-0.524984 --> -0.687486).  Saving model ...
Epoch: 6 cost time: 0.916790246963501
Epoch: 6, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.166 Vali Acc: 0.750 Test Loss: 1.166 Test Acc: 0.750
Validation loss decreased (-0.687486 --> -0.749988).  Saving model ...
Epoch: 7 cost time: 0.8924942016601562
Epoch: 7, Steps: 8 | Train Loss: 1.189 Vali Loss: 0.992 Vali Acc: 0.775 Test Loss: 0.992 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.8057174682617188
Epoch: 8, Steps: 8 | Train Loss: 1.024 Vali Loss: 0.854 Vali Acc: 0.781 Test Loss: 0.854 Test Acc: 0.781
Validation loss decreased (-0.774990 --> -0.781241).  Saving model ...
Epoch: 9 cost time: 0.7275629043579102
Epoch: 9, Steps: 8 | Train Loss: 0.800 Vali Loss: 0.752 Vali Acc: 0.794 Test Loss: 0.752 Test Acc: 0.794
Validation loss decreased (-0.781241 --> -0.793742).  Saving model ...
Epoch: 10 cost time: 0.7839951515197754
Epoch: 10, Steps: 8 | Train Loss: 0.717 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.793742 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 0.9122889041900635
Epoch: 11, Steps: 8 | Train Loss: 0.598 Vali Loss: 0.620 Vali Acc: 0.809 Test Loss: 0.620 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 12 cost time: 0.8831210136413574
Epoch: 12, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.9687423706054688
Epoch: 13, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 1.0609853267669678
Epoch: 14, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.9140450954437256
Epoch: 15, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.777632474899292
Epoch: 16, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0477640628814697
Epoch: 17, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8700757026672363
Epoch: 18, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8603987693786621
Epoch: 19, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9248571395874023
Epoch: 20, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8533670902252197
Epoch: 21, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 0.8190004825592041
Epoch: 22, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0533883571624756
Epoch: 23, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9055073261260986
Epoch: 24, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8493258953094482
Epoch: 25, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.497 Vali Acc: 0.834 Test Loss: 0.497 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9061212539672852
Epoch: 26, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8960576057434082
Epoch: 27, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8111779689788818
Epoch: 28, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7403483390808105
Epoch: 29, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8901221752166748
Epoch: 30, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 31 cost time: 0.812666654586792
Epoch: 31, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.790553092956543
Epoch: 32, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.8745582103729248
Epoch: 33, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7713630199432373
Epoch: 34, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8522648811340332
Epoch: 35, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8646490573883057
Epoch: 36, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0978710651397705
Epoch: 37, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.786017894744873
Epoch: 38, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7369556427001953
Epoch: 39, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9669537544250488
Epoch: 40, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.541 Vali Acc: 0.847 Test Loss: 0.541 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0805537700653076
Epoch: 41, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.088064432144165
Epoch: 42, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 28680
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.170707941055298
Epoch: 1, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.961 Vali Acc: 0.241 Test Loss: 1.961 Test Acc: 0.241
Validation loss decreased (inf --> -0.240605).  Saving model ...
Epoch: 2 cost time: 0.9960637092590332
Epoch: 2, Steps: 8 | Train Loss: 1.867 Vali Loss: 1.852 Vali Acc: 0.294 Test Loss: 1.852 Test Acc: 0.294
Validation loss decreased (-0.240605 --> -0.293731).  Saving model ...
Epoch: 3 cost time: 1.0609538555145264
Epoch: 3, Steps: 8 | Train Loss: 1.786 Vali Loss: 1.710 Vali Acc: 0.422 Test Loss: 1.710 Test Acc: 0.422
Validation loss decreased (-0.293731 --> -0.421858).  Saving model ...
Epoch: 4 cost time: 1.0099382400512695
Epoch: 4, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.556 Vali Acc: 0.528 Test Loss: 1.556 Test Acc: 0.528
Validation loss decreased (-0.421858 --> -0.528109).  Saving model ...
Epoch: 5 cost time: 0.9085426330566406
Epoch: 5, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.398 Vali Acc: 0.653 Test Loss: 1.398 Test Acc: 0.653
Validation loss decreased (-0.528109 --> -0.653111).  Saving model ...
Epoch: 6 cost time: 1.2769062519073486
Epoch: 6, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.252 Vali Acc: 0.681 Test Loss: 1.252 Test Acc: 0.681
Validation loss decreased (-0.653111 --> -0.681237).  Saving model ...
Epoch: 7 cost time: 1.0703370571136475
Epoch: 7, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.122 Vali Acc: 0.741 Test Loss: 1.122 Test Acc: 0.741
Validation loss decreased (-0.681237 --> -0.740614).  Saving model ...
Epoch: 8 cost time: 1.0372183322906494
Epoch: 8, Steps: 8 | Train Loss: 1.050 Vali Loss: 1.001 Vali Acc: 0.762 Test Loss: 1.001 Test Acc: 0.762
Validation loss decreased (-0.740614 --> -0.762490).  Saving model ...
Epoch: 9 cost time: 0.9260869026184082
Epoch: 9, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.899 Vali Acc: 0.778 Test Loss: 0.899 Test Acc: 0.778
Validation loss decreased (-0.762490 --> -0.778116).  Saving model ...
Epoch: 10 cost time: 0.9123871326446533
Epoch: 10, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.819 Vali Acc: 0.784 Test Loss: 0.819 Test Acc: 0.784
Validation loss decreased (-0.778116 --> -0.784367).  Saving model ...
Epoch: 11 cost time: 1.0408706665039062
Epoch: 11, Steps: 8 | Train Loss: 0.747 Vali Loss: 0.750 Vali Acc: 0.797 Test Loss: 0.750 Test Acc: 0.797
Validation loss decreased (-0.784367 --> -0.796867).  Saving model ...
Epoch: 12 cost time: 0.9385380744934082
Epoch: 12, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 13 cost time: 0.9510812759399414
Epoch: 13, Steps: 8 | Train Loss: 0.642 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815618).  Saving model ...
Epoch: 14 cost time: 0.9119389057159424
Epoch: 14, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 15 cost time: 1.1616747379302979
Epoch: 15, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 16 cost time: 1.2492146492004395
Epoch: 16, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 17 cost time: 0.9131274223327637
Epoch: 17, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 1.4583556652069092
Epoch: 18, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3378045558929443
Epoch: 19, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1953015327453613
Epoch: 20, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0444295406341553
Epoch: 21, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 1.1745755672454834
Epoch: 22, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2147130966186523
Epoch: 23, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9929294586181641
Epoch: 24, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 25 cost time: 1.0619590282440186
Epoch: 25, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1647889614105225
Epoch: 26, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 27 cost time: 1.21097993850708
Epoch: 27, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0412559509277344
Epoch: 28, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 29 cost time: 1.1991453170776367
Epoch: 29, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 30 cost time: 1.0406444072723389
Epoch: 30, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 31 cost time: 0.9556930065155029
Epoch: 31, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 32 cost time: 0.9705262184143066
Epoch: 32, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 1.1140093803405762
Epoch: 33, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 34 cost time: 1.1239137649536133
Epoch: 34, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2437140941619873
Epoch: 35, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1072030067443848
Epoch: 36, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1246812343597412
Epoch: 37, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0313756465911865
Epoch: 38, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0675804615020752
Epoch: 39, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0249617099761963
Epoch: 40, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0497868061065674
Epoch: 41, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 42 cost time: 0.9861645698547363
Epoch: 42, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.292222261428833
Epoch: 43, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2287013530731201
Epoch: 44, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.067192554473877
Epoch: 45, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8447158336639404
Epoch: 46, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0892276763916016
Epoch: 47, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 48 cost time: 0.9115636348724365
Epoch: 48, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 49 cost time: 0.8246300220489502
Epoch: 49, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 50 cost time: 1.0896461009979248
Epoch: 50, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 51 cost time: 0.9463169574737549
Epoch: 51, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0941073894500732
Epoch: 52, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.334214210510254
Epoch: 53, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1341912746429443
Epoch: 54, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0139493942260742
Epoch: 55, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.469 Vali Acc: 0.866 Test Loss: 0.469 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0815227031707764
Epoch: 56, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.474 Vali Acc: 0.866 Test Loss: 0.474 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9630842208862305
Epoch: 57, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.0590457916259766
Epoch: 58, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8443315029144287
Epoch: 59, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.488 Vali Acc: 0.863 Test Loss: 0.488 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1435010433197021
Epoch: 60, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.489 Vali Acc: 0.866 Test Loss: 0.489 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 26088
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1677803993225098
Epoch: 1, Steps: 8 | Train Loss: 2.223 Vali Loss: 2.100 Vali Acc: 0.100 Test Loss: 2.100 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 1.0057179927825928
Epoch: 2, Steps: 8 | Train Loss: 2.167 Vali Loss: 1.994 Vali Acc: 0.159 Test Loss: 1.994 Test Acc: 0.159
Validation loss decreased (-0.099979 --> -0.159355).  Saving model ...
Epoch: 3 cost time: 0.8971271514892578
Epoch: 3, Steps: 8 | Train Loss: 2.058 Vali Loss: 1.851 Vali Acc: 0.259 Test Loss: 1.851 Test Acc: 0.259
Validation loss decreased (-0.159355 --> -0.259356).  Saving model ...
Epoch: 4 cost time: 1.112736463546753
Epoch: 4, Steps: 8 | Train Loss: 1.887 Vali Loss: 1.694 Vali Acc: 0.397 Test Loss: 1.694 Test Acc: 0.397
Validation loss decreased (-0.259356 --> -0.396858).  Saving model ...
Epoch: 5 cost time: 1.3055570125579834
Epoch: 5, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.533 Vali Acc: 0.597 Test Loss: 1.533 Test Acc: 0.597
Validation loss decreased (-0.396858 --> -0.596860).  Saving model ...
Epoch: 6 cost time: 1.0466272830963135
Epoch: 6, Steps: 8 | Train Loss: 1.631 Vali Loss: 1.377 Vali Acc: 0.691 Test Loss: 1.377 Test Acc: 0.691
Validation loss decreased (-0.596860 --> -0.690611).  Saving model ...
Epoch: 7 cost time: 0.9391052722930908
Epoch: 7, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.228 Vali Acc: 0.753 Test Loss: 1.228 Test Acc: 0.753
Validation loss decreased (-0.690611 --> -0.753113).  Saving model ...
Epoch: 8 cost time: 1.219653844833374
Epoch: 8, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.096 Vali Acc: 0.766 Test Loss: 1.096 Test Acc: 0.766
Validation loss decreased (-0.753113 --> -0.765614).  Saving model ...
Epoch: 9 cost time: 1.0875272750854492
Epoch: 9, Steps: 8 | Train Loss: 1.104 Vali Loss: 0.988 Vali Acc: 0.775 Test Loss: 0.988 Test Acc: 0.775
Validation loss decreased (-0.765614 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.9269089698791504
Epoch: 10, Steps: 8 | Train Loss: 1.009 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 1.0211987495422363
Epoch: 11, Steps: 8 | Train Loss: 0.890 Vali Loss: 0.818 Vali Acc: 0.778 Test Loss: 0.818 Test Acc: 0.778
Validation loss decreased (-0.774991 --> -0.778117).  Saving model ...
Epoch: 12 cost time: 1.132068395614624
Epoch: 12, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.754 Vali Acc: 0.787 Test Loss: 0.754 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787492).  Saving model ...
Epoch: 13 cost time: 1.0641965866088867
Epoch: 13, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.712 Vali Acc: 0.794 Test Loss: 0.712 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 14 cost time: 1.0691044330596924
Epoch: 14, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803118).  Saving model ...
Epoch: 15 cost time: 0.9058897495269775
Epoch: 15, Steps: 8 | Train Loss: 0.595 Vali Loss: 0.631 Vali Acc: 0.794 Test Loss: 0.631 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1723566055297852
Epoch: 16, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 17 cost time: 1.1504528522491455
Epoch: 17, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818744).  Saving model ...
Epoch: 18 cost time: 1.2758777141571045
Epoch: 18, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2249677181243896
Epoch: 19, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 20 cost time: 0.9846169948577881
Epoch: 20, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 21 cost time: 0.9106411933898926
Epoch: 21, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8655962944030762
Epoch: 22, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0825691223144531
Epoch: 23, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 24 cost time: 1.0944197177886963
Epoch: 24, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 25 cost time: 1.241147518157959
Epoch: 25, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.261376142501831
Epoch: 26, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1837315559387207
Epoch: 27, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 28 cost time: 0.921088457107544
Epoch: 28, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.489 Vali Acc: 0.834 Test Loss: 0.489 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 29 cost time: 1.0618267059326172
Epoch: 29, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.482 Vali Acc: 0.834 Test Loss: 0.482 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 30 cost time: 0.910444974899292
Epoch: 30, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.476 Vali Acc: 0.831 Test Loss: 0.476 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9789841175079346
Epoch: 31, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.471 Vali Acc: 0.831 Test Loss: 0.471 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9101095199584961
Epoch: 32, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 33 cost time: 1.0466201305389404
Epoch: 33, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 34 cost time: 1.1625447273254395
Epoch: 34, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 35 cost time: 1.1882498264312744
Epoch: 35, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4385535717010498
Epoch: 36, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1523919105529785
Epoch: 37, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8631999492645264
Epoch: 38, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.003727674484253
Epoch: 39, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1097404956817627
Epoch: 40, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 41 cost time: 1.1658670902252197
Epoch: 41, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.450 Vali Acc: 0.844 Test Loss: 0.450 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9969277381896973
Epoch: 42, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0915048122406006
Epoch: 43, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.445 Vali Acc: 0.847 Test Loss: 0.445 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846871).  Saving model ...
Epoch: 44 cost time: 1.271718978881836
Epoch: 44, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1927831172943115
Epoch: 45, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1946370601654053
Epoch: 46, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9962148666381836
Epoch: 47, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.435 Vali Acc: 0.841 Test Loss: 0.435 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0312650203704834
Epoch: 48, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.441 Vali Acc: 0.844 Test Loss: 0.441 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0338501930236816
Epoch: 49, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2351484298706055
Epoch: 50, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.440 Vali Acc: 0.847 Test Loss: 0.440 Test Acc: 0.847
Validation loss decreased (-0.846871 --> -0.846871).  Saving model ...
Epoch: 51 cost time: 1.2310397624969482
Epoch: 51, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.440 Vali Acc: 0.847 Test Loss: 0.440 Test Acc: 0.847
Validation loss decreased (-0.846871 --> -0.846871).  Saving model ...
Epoch: 52 cost time: 1.0252704620361328
Epoch: 52, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.439 Vali Acc: 0.847 Test Loss: 0.439 Test Acc: 0.847
Validation loss decreased (-0.846871 --> -0.846871).  Saving model ...
Epoch: 53 cost time: 0.9403781890869141
Epoch: 53, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2827768325805664
Epoch: 54, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.436 Vali Acc: 0.847 Test Loss: 0.436 Test Acc: 0.847
Validation loss decreased (-0.846871 --> -0.846871).  Saving model ...
Epoch: 55 cost time: 1.15324068069458
Epoch: 55, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.846871 --> -0.849996).  Saving model ...
Epoch: 56 cost time: 1.0697667598724365
Epoch: 56, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.437 Vali Acc: 0.847 Test Loss: 0.437 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1761832237243652
Epoch: 57, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.97247314453125
Epoch: 58, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.4195332527160645
Epoch: 59, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.048452615737915
Epoch: 60, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.967684268951416
Epoch: 61, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.0272352695465088
Epoch: 62, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.9702835083007812
Epoch: 63, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.9336724281311035
Epoch: 64, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.9388539791107178
Epoch: 65, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm32_nh4_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 25064
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.408360481262207
Epoch: 1, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.883 Vali Acc: 0.250 Test Loss: 1.883 Test Acc: 0.250
Validation loss decreased (inf --> -0.249981).  Saving model ...
Epoch: 2 cost time: 0.9659435749053955
Epoch: 2, Steps: 8 | Train Loss: 1.769 Vali Loss: 1.610 Vali Acc: 0.516 Test Loss: 1.610 Test Acc: 0.516
Validation loss decreased (-0.249981 --> -0.515609).  Saving model ...
Epoch: 3 cost time: 1.3451511859893799
Epoch: 3, Steps: 8 | Train Loss: 1.439 Vali Loss: 1.300 Vali Acc: 0.697 Test Loss: 1.300 Test Acc: 0.697
Validation loss decreased (-0.515609 --> -0.696862).  Saving model ...
Epoch: 4 cost time: 1.014876365661621
Epoch: 4, Steps: 8 | Train Loss: 1.185 Vali Loss: 1.017 Vali Acc: 0.775 Test Loss: 1.017 Test Acc: 0.775
Validation loss decreased (-0.696862 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 1.158804178237915
Epoch: 5, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.804 Vali Acc: 0.787 Test Loss: 0.804 Test Acc: 0.787
Validation loss decreased (-0.774990 --> -0.787492).  Saving model ...
Epoch: 6 cost time: 1.1199297904968262
Epoch: 6, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
Validation loss decreased (-0.787492 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.1368098258972168
Epoch: 7, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.1011807918548584
Epoch: 8, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 1.0067222118377686
Epoch: 9, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0196771621704102
Epoch: 10, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.9920969009399414
Epoch: 11, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.1638171672821045
Epoch: 12, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0798790454864502
Epoch: 13, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2512156963348389
Epoch: 14, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2134230136871338
Epoch: 15, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0904669761657715
Epoch: 16, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9501321315765381
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.545 Vali Acc: 0.834 Test Loss: 0.545 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8784403800964355
Epoch: 18, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2040510177612305
Epoch: 19, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2096364498138428
Epoch: 20, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8485085964202881
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 49352
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4969217777252197
Epoch: 1, Steps: 8 | Train Loss: 2.234 Vali Loss: 2.149 Vali Acc: 0.153 Test Loss: 2.149 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 0.9735064506530762
Epoch: 2, Steps: 8 | Train Loss: 2.204 Vali Loss: 2.002 Vali Acc: 0.247 Test Loss: 2.002 Test Acc: 0.247
Validation loss decreased (-0.153104 --> -0.246855).  Saving model ...
Epoch: 3 cost time: 0.9729328155517578
Epoch: 3, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.814 Vali Acc: 0.356 Test Loss: 1.814 Test Acc: 0.356
Validation loss decreased (-0.246855 --> -0.356232).  Saving model ...
Epoch: 4 cost time: 0.9617090225219727
Epoch: 4, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.603 Vali Acc: 0.534 Test Loss: 1.603 Test Acc: 0.534
Validation loss decreased (-0.356232 --> -0.534359).  Saving model ...
Epoch: 5 cost time: 1.1863558292388916
Epoch: 5, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.396 Vali Acc: 0.662 Test Loss: 1.396 Test Acc: 0.662
Validation loss decreased (-0.534359 --> -0.662486).  Saving model ...
Epoch: 6 cost time: 0.9966592788696289
Epoch: 6, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.188 Vali Acc: 0.741 Test Loss: 1.188 Test Acc: 0.741
Validation loss decreased (-0.662486 --> -0.740613).  Saving model ...
Epoch: 7 cost time: 0.9991142749786377
Epoch: 7, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.002 Vali Acc: 0.753 Test Loss: 1.002 Test Acc: 0.753
Validation loss decreased (-0.740613 --> -0.753115).  Saving model ...
Epoch: 8 cost time: 1.0825321674346924
Epoch: 8, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.848 Vali Acc: 0.784 Test Loss: 0.848 Test Acc: 0.784
Validation loss decreased (-0.753115 --> -0.784367).  Saving model ...
Epoch: 9 cost time: 1.0575354099273682
Epoch: 9, Steps: 8 | Train Loss: 0.789 Vali Loss: 0.733 Vali Acc: 0.787 Test Loss: 0.733 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 10 cost time: 0.9658510684967041
Epoch: 10, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.659 Vali Acc: 0.794 Test Loss: 0.659 Test Acc: 0.794
Validation loss decreased (-0.787493 --> -0.793743).  Saving model ...
Epoch: 11 cost time: 0.985379695892334
Epoch: 11, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803119).  Saving model ...
Epoch: 12 cost time: 1.0958828926086426
Epoch: 12, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.803119 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.9901747703552246
Epoch: 13, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9931468963623047
Epoch: 14, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 1.1362025737762451
Epoch: 15, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1923024654388428
Epoch: 16, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 0.8779118061065674
Epoch: 17, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 1.025465488433838
Epoch: 18, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 1.0398509502410889
Epoch: 19, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.042064905166626
Epoch: 20, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9107460975646973
Epoch: 21, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9134073257446289
Epoch: 22, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1687312126159668
Epoch: 23, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.130420446395874
Epoch: 24, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1840100288391113
Epoch: 25, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0800127983093262
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8188550472259521
Epoch: 27, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8739109039306641
Epoch: 28, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 34504
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.565070867538452
Epoch: 1, Steps: 8 | Train Loss: 2.266 Vali Loss: 2.167 Vali Acc: 0.075 Test Loss: 2.167 Test Acc: 0.075
Validation loss decreased (inf --> -0.074978).  Saving model ...
Epoch: 2 cost time: 1.1110200881958008
Epoch: 2, Steps: 8 | Train Loss: 2.177 Vali Loss: 2.026 Vali Acc: 0.097 Test Loss: 2.026 Test Acc: 0.097
Validation loss decreased (-0.074978 --> -0.096855).  Saving model ...
Epoch: 3 cost time: 1.1863799095153809
Epoch: 3, Steps: 8 | Train Loss: 1.992 Vali Loss: 1.840 Vali Acc: 0.263 Test Loss: 1.840 Test Acc: 0.263
Validation loss decreased (-0.096855 --> -0.262482).  Saving model ...
Epoch: 4 cost time: 1.2646639347076416
Epoch: 4, Steps: 8 | Train Loss: 1.839 Vali Loss: 1.642 Vali Acc: 0.487 Test Loss: 1.642 Test Acc: 0.487
Validation loss decreased (-0.262482 --> -0.487484).  Saving model ...
Epoch: 5 cost time: 1.276289701461792
Epoch: 5, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.444 Vali Acc: 0.603 Test Loss: 1.444 Test Acc: 0.603
Validation loss decreased (-0.487484 --> -0.603111).  Saving model ...
Epoch: 6 cost time: 1.2699077129364014
Epoch: 6, Steps: 8 | Train Loss: 1.376 Vali Loss: 1.251 Vali Acc: 0.706 Test Loss: 1.251 Test Acc: 0.706
Validation loss decreased (-0.603111 --> -0.706237).  Saving model ...
Epoch: 7 cost time: 1.3260200023651123
Epoch: 7, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.082 Vali Acc: 0.744 Test Loss: 1.082 Test Acc: 0.744
Validation loss decreased (-0.706237 --> -0.743739).  Saving model ...
Epoch: 8 cost time: 1.0796453952789307
Epoch: 8, Steps: 8 | Train Loss: 1.068 Vali Loss: 0.949 Vali Acc: 0.753 Test Loss: 0.949 Test Acc: 0.753
Validation loss decreased (-0.743739 --> -0.753116).  Saving model ...
Epoch: 9 cost time: 1.0207583904266357
Epoch: 9, Steps: 8 | Train Loss: 0.918 Vali Loss: 0.840 Vali Acc: 0.759 Test Loss: 0.840 Test Acc: 0.759
Validation loss decreased (-0.753116 --> -0.759367).  Saving model ...
Epoch: 10 cost time: 1.09425687789917
Epoch: 10, Steps: 8 | Train Loss: 0.764 Vali Loss: 0.745 Vali Acc: 0.787 Test Loss: 0.745 Test Acc: 0.787
Validation loss decreased (-0.759367 --> -0.787493).  Saving model ...
Epoch: 11 cost time: 1.1839268207550049
Epoch: 11, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.680 Vali Acc: 0.797 Test Loss: 0.680 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796868).  Saving model ...
Epoch: 12 cost time: 1.2813911437988281
Epoch: 12, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 13 cost time: 1.215360164642334
Epoch: 13, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 1.2724409103393555
Epoch: 14, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 15 cost time: 1.0182514190673828
Epoch: 15, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0842814445495605
Epoch: 16, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 17 cost time: 1.0952954292297363
Epoch: 17, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 1.4043278694152832
Epoch: 18, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.14011549949646
Epoch: 19, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 20 cost time: 1.2156436443328857
Epoch: 20, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3843817710876465
Epoch: 21, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0335495471954346
Epoch: 22, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.260636806488037
Epoch: 23, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 1.0852410793304443
Epoch: 24, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9504156112670898
Epoch: 25, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.516 Vali Acc: 0.828 Test Loss: 0.516 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1944811344146729
Epoch: 26, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9561395645141602
Epoch: 27, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.079681158065796
Epoch: 28, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 29 cost time: 0.9545369148254395
Epoch: 29, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9656331539154053
Epoch: 30, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1315975189208984
Epoch: 31, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1872310638427734
Epoch: 32, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.100358486175537
Epoch: 33, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0552525520324707
Epoch: 34, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0390734672546387
Epoch: 35, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 36 cost time: 0.9358911514282227
Epoch: 36, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.015714168548584
Epoch: 37, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9902372360229492
Epoch: 38, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1059558391571045
Epoch: 39, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1693294048309326
Epoch: 40, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1698534488677979
Epoch: 41, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0883469581604004
Epoch: 42, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2379977703094482
Epoch: 43, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.541 Vali Acc: 0.847 Test Loss: 0.541 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0867211818695068
Epoch: 44, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.095731496810913
Epoch: 45, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 29640
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.458641290664673
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 2.132 Vali Acc: 0.138 Test Loss: 2.132 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.9932875633239746
Epoch: 2, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.053 Vali Acc: 0.150 Test Loss: 2.053 Test Acc: 0.150
Validation loss decreased (-0.137479 --> -0.149979).  Saving model ...
Epoch: 3 cost time: 1.181455373764038
Epoch: 3, Steps: 8 | Train Loss: 2.071 Vali Loss: 1.935 Vali Acc: 0.203 Test Loss: 1.935 Test Acc: 0.203
Validation loss decreased (-0.149979 --> -0.203106).  Saving model ...
Epoch: 4 cost time: 0.9907817840576172
Epoch: 4, Steps: 8 | Train Loss: 1.927 Vali Loss: 1.789 Vali Acc: 0.381 Test Loss: 1.789 Test Acc: 0.381
Validation loss decreased (-0.203106 --> -0.381232).  Saving model ...
Epoch: 5 cost time: 1.1337354183197021
Epoch: 5, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.636 Vali Acc: 0.509 Test Loss: 1.636 Test Acc: 0.509
Validation loss decreased (-0.381232 --> -0.509359).  Saving model ...
Epoch: 6 cost time: 1.0594499111175537
Epoch: 6, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.477 Vali Acc: 0.613 Test Loss: 1.477 Test Acc: 0.613
Validation loss decreased (-0.509359 --> -0.612485).  Saving model ...
Epoch: 7 cost time: 1.3470323085784912
Epoch: 7, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.315 Vali Acc: 0.669 Test Loss: 1.315 Test Acc: 0.669
Validation loss decreased (-0.612485 --> -0.668737).  Saving model ...
Epoch: 8 cost time: 1.0170574188232422
Epoch: 8, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.156 Vali Acc: 0.728 Test Loss: 1.156 Test Acc: 0.728
Validation loss decreased (-0.668737 --> -0.728113).  Saving model ...
Epoch: 9 cost time: 1.1617178916931152
Epoch: 9, Steps: 8 | Train Loss: 1.075 Vali Loss: 1.016 Vali Acc: 0.741 Test Loss: 1.016 Test Acc: 0.741
Validation loss decreased (-0.728113 --> -0.740615).  Saving model ...
Epoch: 10 cost time: 1.1237618923187256
Epoch: 10, Steps: 8 | Train Loss: 0.952 Vali Loss: 0.903 Vali Acc: 0.759 Test Loss: 0.903 Test Acc: 0.759
Validation loss decreased (-0.740615 --> -0.759366).  Saving model ...
Epoch: 11 cost time: 1.048100233078003
Epoch: 11, Steps: 8 | Train Loss: 0.826 Vali Loss: 0.812 Vali Acc: 0.762 Test Loss: 0.812 Test Acc: 0.762
Validation loss decreased (-0.759366 --> -0.762492).  Saving model ...
Epoch: 12 cost time: 1.0540261268615723
Epoch: 12, Steps: 8 | Train Loss: 0.719 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
Validation loss decreased (-0.762492 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 1.174652338027954
Epoch: 13, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.680 Vali Acc: 0.778 Test Loss: 0.680 Test Acc: 0.778
Validation loss decreased (-0.774993 --> -0.778118).  Saving model ...
Epoch: 14 cost time: 1.2064006328582764
Epoch: 14, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.15608549118042
Epoch: 15, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.613 Vali Acc: 0.784 Test Loss: 0.613 Test Acc: 0.784
Validation loss decreased (-0.778118 --> -0.784369).  Saving model ...
Epoch: 16 cost time: 1.1852967739105225
Epoch: 16, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.591 Vali Acc: 0.781 Test Loss: 0.591 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2255806922912598
Epoch: 17, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.576 Vali Acc: 0.791 Test Loss: 0.576 Test Acc: 0.791
Validation loss decreased (-0.784369 --> -0.790619).  Saving model ...
Epoch: 18 cost time: 1.1178975105285645
Epoch: 18, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.560 Vali Acc: 0.794 Test Loss: 0.560 Test Acc: 0.794
Validation loss decreased (-0.790619 --> -0.793744).  Saving model ...
Epoch: 19 cost time: 1.0267724990844727
Epoch: 19, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.554 Vali Acc: 0.794 Test Loss: 0.554 Test Acc: 0.794
Validation loss decreased (-0.793744 --> -0.793744).  Saving model ...
Epoch: 20 cost time: 1.1812207698822021
Epoch: 20, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.548 Vali Acc: 0.797 Test Loss: 0.548 Test Acc: 0.797
Validation loss decreased (-0.793744 --> -0.796870).  Saving model ...
Epoch: 21 cost time: 1.2305686473846436
Epoch: 21, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
Validation loss decreased (-0.796870 --> -0.799995).  Saving model ...
Epoch: 22 cost time: 0.9832892417907715
Epoch: 22, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
Validation loss decreased (-0.799995 --> -0.803120).  Saving model ...
Epoch: 23 cost time: 0.9811902046203613
Epoch: 23, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.540 Vali Acc: 0.806 Test Loss: 0.540 Test Acc: 0.806
Validation loss decreased (-0.803120 --> -0.806245).  Saving model ...
Epoch: 24 cost time: 1.0667319297790527
Epoch: 24, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
Validation loss decreased (-0.806245 --> -0.809370).  Saving model ...
Epoch: 25 cost time: 0.9935698509216309
Epoch: 25, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.524 Vali Acc: 0.812 Test Loss: 0.524 Test Acc: 0.812
Validation loss decreased (-0.809370 --> -0.812495).  Saving model ...
Epoch: 26 cost time: 1.0003077983856201
Epoch: 26, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
Validation loss decreased (-0.812495 --> -0.818745).  Saving model ...
Epoch: 27 cost time: 0.9812991619110107
Epoch: 27, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 28 cost time: 1.3229494094848633
Epoch: 28, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 29 cost time: 1.25911545753479
Epoch: 29, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3324778079986572
Epoch: 30, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2456591129302979
Epoch: 31, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 32 cost time: 1.191739797592163
Epoch: 32, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2862370014190674
Epoch: 33, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1252837181091309
Epoch: 34, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.272641897201538
Epoch: 35, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1727538108825684
Epoch: 36, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1160094738006592
Epoch: 37, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9788215160369873
Epoch: 38, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2526659965515137
Epoch: 39, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4544439315795898
Epoch: 40, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0563299655914307
Epoch: 41, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 27080
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5140604972839355
Epoch: 1, Steps: 8 | Train Loss: 2.372 Vali Loss: 2.163 Vali Acc: 0.041 Test Loss: 2.163 Test Acc: 0.041
Validation loss decreased (inf --> -0.040603).  Saving model ...
Epoch: 2 cost time: 1.534724235534668
Epoch: 2, Steps: 8 | Train Loss: 2.306 Vali Loss: 2.091 Vali Acc: 0.091 Test Loss: 2.091 Test Acc: 0.091
Validation loss decreased (-0.040603 --> -0.090604).  Saving model ...
Epoch: 3 cost time: 0.8987231254577637
Epoch: 3, Steps: 8 | Train Loss: 2.148 Vali Loss: 1.986 Vali Acc: 0.153 Test Loss: 1.986 Test Acc: 0.153
Validation loss decreased (-0.090604 --> -0.153105).  Saving model ...
Epoch: 4 cost time: 1.1655247211456299
Epoch: 4, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.865 Vali Acc: 0.253 Test Loss: 1.865 Test Acc: 0.253
Validation loss decreased (-0.153105 --> -0.253106).  Saving model ...
Epoch: 5 cost time: 1.1211292743682861
Epoch: 5, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.738 Vali Acc: 0.416 Test Loss: 1.738 Test Acc: 0.416
Validation loss decreased (-0.253106 --> -0.415608).  Saving model ...
Epoch: 6 cost time: 1.0028696060180664
Epoch: 6, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.608 Vali Acc: 0.541 Test Loss: 1.608 Test Acc: 0.541
Validation loss decreased (-0.415608 --> -0.540609).  Saving model ...
Epoch: 7 cost time: 1.0361344814300537
Epoch: 7, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.477 Vali Acc: 0.616 Test Loss: 1.477 Test Acc: 0.616
Validation loss decreased (-0.540609 --> -0.615610).  Saving model ...
Epoch: 8 cost time: 1.2285590171813965
Epoch: 8, Steps: 8 | Train Loss: 1.487 Vali Loss: 1.343 Vali Acc: 0.656 Test Loss: 1.343 Test Acc: 0.656
Validation loss decreased (-0.615610 --> -0.656237).  Saving model ...
Epoch: 9 cost time: 1.1072611808776855
Epoch: 9, Steps: 8 | Train Loss: 1.379 Vali Loss: 1.214 Vali Acc: 0.691 Test Loss: 1.214 Test Acc: 0.691
Validation loss decreased (-0.656237 --> -0.690613).  Saving model ...
Epoch: 10 cost time: 1.3331286907196045
Epoch: 10, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.097 Vali Acc: 0.719 Test Loss: 1.097 Test Acc: 0.719
Validation loss decreased (-0.690613 --> -0.718739).  Saving model ...
Epoch: 11 cost time: 1.1307978630065918
Epoch: 11, Steps: 8 | Train Loss: 1.113 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.718739 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 1.1397407054901123
Epoch: 12, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.899 Vali Acc: 0.794 Test Loss: 0.899 Test Acc: 0.794
Validation loss decreased (-0.749990 --> -0.793741).  Saving model ...
Epoch: 13 cost time: 1.09525728225708
Epoch: 13, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.821 Vali Acc: 0.803 Test Loss: 0.821 Test Acc: 0.803
Validation loss decreased (-0.793741 --> -0.803117).  Saving model ...
Epoch: 14 cost time: 1.1020584106445312
Epoch: 14, Steps: 8 | Train Loss: 0.779 Vali Loss: 0.755 Vali Acc: 0.806 Test Loss: 0.755 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806242).  Saving model ...
Epoch: 15 cost time: 0.9639620780944824
Epoch: 15, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2565810680389404
Epoch: 16, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.663 Vali Acc: 0.806 Test Loss: 0.663 Test Acc: 0.806
Validation loss decreased (-0.806242 --> -0.806243).  Saving model ...
Epoch: 17 cost time: 1.22678804397583
Epoch: 17, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.632 Vali Acc: 0.816 Test Loss: 0.632 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 18 cost time: 1.0318408012390137
Epoch: 18, Steps: 8 | Train Loss: 0.518 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 19 cost time: 1.0466866493225098
Epoch: 19, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 20 cost time: 1.0113639831542969
Epoch: 20, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 21 cost time: 1.2789835929870605
Epoch: 21, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 22 cost time: 1.2605009078979492
Epoch: 22, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 23 cost time: 1.1507718563079834
Epoch: 23, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 24 cost time: 0.9471971988677979
Epoch: 24, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 25 cost time: 1.0954349040985107
Epoch: 25, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 26 cost time: 1.0459363460540771
Epoch: 26, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 27 cost time: 1.0753366947174072
Epoch: 27, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 28 cost time: 1.0556650161743164
Epoch: 28, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 29 cost time: 1.108677625656128
Epoch: 29, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.498 Vali Acc: 0.831 Test Loss: 0.498 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 30 cost time: 1.0414361953735352
Epoch: 30, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.493 Vali Acc: 0.828 Test Loss: 0.493 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9687068462371826
Epoch: 31, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9726564884185791
Epoch: 32, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.493 Vali Acc: 0.825 Test Loss: 0.493 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1537511348724365
Epoch: 33, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1161844730377197
Epoch: 34, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.480 Vali Acc: 0.828 Test Loss: 0.480 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1891281604766846
Epoch: 35, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 36 cost time: 0.9376413822174072
Epoch: 36, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 37 cost time: 1.1019246578216553
Epoch: 37, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 38 cost time: 1.1146109104156494
Epoch: 38, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 39 cost time: 1.3017768859863281
Epoch: 39, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.473 Vali Acc: 0.822 Test Loss: 0.473 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0475075244903564
Epoch: 40, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.473 Vali Acc: 0.825 Test Loss: 0.473 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1696491241455078
Epoch: 41, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.470 Vali Acc: 0.825 Test Loss: 0.470 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1280269622802734
Epoch: 42, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.466 Vali Acc: 0.831 Test Loss: 0.466 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1750800609588623
Epoch: 43, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.468 Vali Acc: 0.831 Test Loss: 0.468 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0511586666107178
Epoch: 44, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.471 Vali Acc: 0.828 Test Loss: 0.471 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.043114423751831
Epoch: 45, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.474 Vali Acc: 0.825 Test Loss: 0.474 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0481925010681152
Epoch: 46, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9113633632659912
Epoch: 47, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0275747776031494
Epoch: 48, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 25032
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1828556060791016
Epoch: 1, Steps: 8 | Train Loss: 2.291 Vali Loss: 2.225 Vali Acc: 0.144 Test Loss: 2.225 Test Acc: 0.144
Validation loss decreased (inf --> -0.143728).  Saving model ...
Epoch: 2 cost time: 0.9590070247650146
Epoch: 2, Steps: 8 | Train Loss: 2.220 Vali Loss: 2.149 Vali Acc: 0.153 Test Loss: 2.149 Test Acc: 0.153
Validation loss decreased (-0.143728 --> -0.153104).  Saving model ...
Epoch: 3 cost time: 1.2115342617034912
Epoch: 3, Steps: 8 | Train Loss: 2.215 Vali Loss: 2.063 Vali Acc: 0.181 Test Loss: 2.063 Test Acc: 0.181
Validation loss decreased (-0.153104 --> -0.181229).  Saving model ...
Epoch: 4 cost time: 1.03851318359375
Epoch: 4, Steps: 8 | Train Loss: 2.043 Vali Loss: 1.963 Vali Acc: 0.241 Test Loss: 1.963 Test Acc: 0.241
Validation loss decreased (-0.181229 --> -0.240605).  Saving model ...
Epoch: 5 cost time: 1.2473454475402832
Epoch: 5, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.852 Vali Acc: 0.344 Test Loss: 1.852 Test Acc: 0.344
Validation loss decreased (-0.240605 --> -0.343731).  Saving model ...
Epoch: 6 cost time: 1.0386967658996582
Epoch: 6, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.735 Vali Acc: 0.456 Test Loss: 1.735 Test Acc: 0.456
Validation loss decreased (-0.343731 --> -0.456233).  Saving model ...
Epoch: 7 cost time: 1.1580986976623535
Epoch: 7, Steps: 8 | Train Loss: 1.778 Vali Loss: 1.620 Vali Acc: 0.550 Test Loss: 1.620 Test Acc: 0.550
Validation loss decreased (-0.456233 --> -0.549984).  Saving model ...
Epoch: 8 cost time: 1.09114408493042
Epoch: 8, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.502 Vali Acc: 0.619 Test Loss: 1.502 Test Acc: 0.619
Validation loss decreased (-0.549984 --> -0.618735).  Saving model ...
Epoch: 9 cost time: 1.140495777130127
Epoch: 9, Steps: 8 | Train Loss: 1.491 Vali Loss: 1.391 Vali Acc: 0.669 Test Loss: 1.391 Test Acc: 0.669
Validation loss decreased (-0.618735 --> -0.668736).  Saving model ...
Epoch: 10 cost time: 1.0804812908172607
Epoch: 10, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.279 Vali Acc: 0.700 Test Loss: 1.279 Test Acc: 0.700
Validation loss decreased (-0.668736 --> -0.699987).  Saving model ...
Epoch: 11 cost time: 1.0916743278503418
Epoch: 11, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.169 Vali Acc: 0.728 Test Loss: 1.169 Test Acc: 0.728
Validation loss decreased (-0.699987 --> -0.728113).  Saving model ...
Epoch: 12 cost time: 1.0579380989074707
Epoch: 12, Steps: 8 | Train Loss: 1.131 Vali Loss: 1.067 Vali Acc: 0.738 Test Loss: 1.067 Test Acc: 0.738
Validation loss decreased (-0.728113 --> -0.737489).  Saving model ...
Epoch: 13 cost time: 1.1050968170166016
Epoch: 13, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.982 Vali Acc: 0.747 Test Loss: 0.982 Test Acc: 0.747
Validation loss decreased (-0.737489 --> -0.746865).  Saving model ...
Epoch: 14 cost time: 1.519728660583496
Epoch: 14, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.903 Vali Acc: 0.762 Test Loss: 0.903 Test Acc: 0.762
Validation loss decreased (-0.746865 --> -0.762491).  Saving model ...
Epoch: 15 cost time: 1.1114215850830078
Epoch: 15, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.837 Vali Acc: 0.769 Test Loss: 0.837 Test Acc: 0.769
Validation loss decreased (-0.762491 --> -0.768742).  Saving model ...
Epoch: 16 cost time: 0.9831287860870361
Epoch: 16, Steps: 8 | Train Loss: 0.746 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
Validation loss decreased (-0.768742 --> -0.778117).  Saving model ...
Epoch: 17 cost time: 1.245549201965332
Epoch: 17, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.739 Vali Acc: 0.787 Test Loss: 0.739 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787493).  Saving model ...
Epoch: 18 cost time: 1.3457973003387451
Epoch: 18, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.712 Vali Acc: 0.787 Test Loss: 0.712 Test Acc: 0.787
Validation loss decreased (-0.787493 --> -0.787493).  Saving model ...
Epoch: 19 cost time: 1.306788444519043
Epoch: 19, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.787493 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.2755727767944336
Epoch: 20, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809368).  Saving model ...
Epoch: 21 cost time: 1.098423957824707
Epoch: 21, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
Validation loss decreased (-0.809368 --> -0.812494).  Saving model ...
Epoch: 22 cost time: 1.081571340560913
Epoch: 22, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 23 cost time: 1.0365519523620605
Epoch: 23, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 24 cost time: 1.1632070541381836
Epoch: 24, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 25 cost time: 1.2549834251403809
Epoch: 25, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0445139408111572
Epoch: 26, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 1.0294957160949707
Epoch: 27, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 28 cost time: 1.0917768478393555
Epoch: 28, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 29 cost time: 1.0109593868255615
Epoch: 29, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 30 cost time: 0.9959185123443604
Epoch: 30, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 31 cost time: 0.9712083339691162
Epoch: 31, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 32 cost time: 0.9720396995544434
Epoch: 32, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 33 cost time: 1.0401709079742432
Epoch: 33, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 34 cost time: 1.0616281032562256
Epoch: 34, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 1.1109275817871094
Epoch: 35, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9147191047668457
Epoch: 36, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1695291996002197
Epoch: 37, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1400136947631836
Epoch: 38, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.25331449508667
Epoch: 39, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1693072319030762
Epoch: 40, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1487300395965576
Epoch: 41, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.976731538772583
Epoch: 42, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 1.0958669185638428
Epoch: 43, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0299005508422852
Epoch: 44, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.5243175029754639
Epoch: 45, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0969326496124268
Epoch: 46, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1658339500427246
Epoch: 47, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 48 cost time: 1.0045549869537354
Epoch: 48, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.159980297088623
Epoch: 49, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2576818466186523
Epoch: 50, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.5558075904846191
Epoch: 51, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0109293460845947
Epoch: 52, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.196584939956665
Epoch: 53, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.130401611328125
Epoch: 54, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.5790574550628662
Epoch: 55, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.293088436126709
Epoch: 56, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.912614107131958
Epoch: 57, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 23736
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.159595012664795
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 2.256 Vali Acc: 0.153 Test Loss: 2.256 Test Acc: 0.153
Validation loss decreased (inf --> -0.153102).  Saving model ...
Epoch: 2 cost time: 1.085496425628662
Epoch: 2, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.168 Vali Acc: 0.181 Test Loss: 2.168 Test Acc: 0.181
Validation loss decreased (-0.153102 --> -0.181228).  Saving model ...
Epoch: 3 cost time: 1.0171582698822021
Epoch: 3, Steps: 8 | Train Loss: 2.142 Vali Loss: 2.068 Vali Acc: 0.212 Test Loss: 2.068 Test Acc: 0.212
Validation loss decreased (-0.181228 --> -0.212479).  Saving model ...
Epoch: 4 cost time: 1.0103495121002197
Epoch: 4, Steps: 8 | Train Loss: 1.992 Vali Loss: 1.956 Vali Acc: 0.256 Test Loss: 1.956 Test Acc: 0.256
Validation loss decreased (-0.212479 --> -0.256230).  Saving model ...
Epoch: 5 cost time: 1.0370638370513916
Epoch: 5, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.841 Vali Acc: 0.303 Test Loss: 1.841 Test Acc: 0.303
Validation loss decreased (-0.256230 --> -0.303107).  Saving model ...
Epoch: 6 cost time: 1.0527231693267822
Epoch: 6, Steps: 8 | Train Loss: 1.785 Vali Loss: 1.724 Vali Acc: 0.362 Test Loss: 1.724 Test Acc: 0.362
Validation loss decreased (-0.303107 --> -0.362483).  Saving model ...
Epoch: 7 cost time: 0.9638333320617676
Epoch: 7, Steps: 8 | Train Loss: 1.680 Vali Loss: 1.611 Vali Acc: 0.453 Test Loss: 1.611 Test Acc: 0.453
Validation loss decreased (-0.362483 --> -0.453109).  Saving model ...
Epoch: 8 cost time: 1.1118364334106445
Epoch: 8, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.498 Vali Acc: 0.522 Test Loss: 1.498 Test Acc: 0.522
Validation loss decreased (-0.453109 --> -0.521860).  Saving model ...
Epoch: 9 cost time: 1.2417824268341064
Epoch: 9, Steps: 8 | Train Loss: 1.450 Vali Loss: 1.395 Vali Acc: 0.600 Test Loss: 1.395 Test Acc: 0.600
Validation loss decreased (-0.521860 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.9965434074401855
Epoch: 10, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.296 Vali Acc: 0.653 Test Loss: 1.296 Test Acc: 0.653
Validation loss decreased (-0.599986 --> -0.653112).  Saving model ...
Epoch: 11 cost time: 0.9021420478820801
Epoch: 11, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.206 Vali Acc: 0.694 Test Loss: 1.206 Test Acc: 0.694
Validation loss decreased (-0.653112 --> -0.693738).  Saving model ...
Epoch: 12 cost time: 1.209465503692627
Epoch: 12, Steps: 8 | Train Loss: 1.161 Vali Loss: 1.128 Vali Acc: 0.713 Test Loss: 1.128 Test Acc: 0.713
Validation loss decreased (-0.693738 --> -0.712489).  Saving model ...
Epoch: 13 cost time: 1.0083496570587158
Epoch: 13, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.055 Vali Acc: 0.750 Test Loss: 1.055 Test Acc: 0.750
Validation loss decreased (-0.712489 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 1.0521109104156494
Epoch: 14, Steps: 8 | Train Loss: 0.983 Vali Loss: 0.991 Vali Acc: 0.759 Test Loss: 0.991 Test Acc: 0.759
Validation loss decreased (-0.749989 --> -0.759365).  Saving model ...
Epoch: 15 cost time: 1.1878750324249268
Epoch: 15, Steps: 8 | Train Loss: 0.919 Vali Loss: 0.933 Vali Acc: 0.759 Test Loss: 0.933 Test Acc: 0.759
Validation loss decreased (-0.759365 --> -0.759366).  Saving model ...
Epoch: 16 cost time: 1.1217553615570068
Epoch: 16, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.880 Vali Acc: 0.756 Test Loss: 0.880 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0480461120605469
Epoch: 17, Steps: 8 | Train Loss: 0.788 Vali Loss: 0.837 Vali Acc: 0.762 Test Loss: 0.837 Test Acc: 0.762
Validation loss decreased (-0.759366 --> -0.762492).  Saving model ...
Epoch: 18 cost time: 1.1809730529785156
Epoch: 18, Steps: 8 | Train Loss: 0.748 Vali Loss: 0.799 Vali Acc: 0.778 Test Loss: 0.799 Test Acc: 0.778
Validation loss decreased (-0.762492 --> -0.778117).  Saving model ...
Epoch: 19 cost time: 1.0196516513824463
Epoch: 19, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.766 Vali Acc: 0.784 Test Loss: 0.766 Test Acc: 0.784
Validation loss decreased (-0.778117 --> -0.784367).  Saving model ...
Epoch: 20 cost time: 1.1525824069976807
Epoch: 20, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.739 Vali Acc: 0.778 Test Loss: 0.739 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0679924488067627
Epoch: 21, Steps: 8 | Train Loss: 0.619 Vali Loss: 0.713 Vali Acc: 0.791 Test Loss: 0.713 Test Acc: 0.791
Validation loss decreased (-0.784367 --> -0.790618).  Saving model ...
Epoch: 22 cost time: 1.0890016555786133
Epoch: 22, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 23 cost time: 1.2042922973632812
Epoch: 23, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 24 cost time: 1.0295641422271729
Epoch: 24, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.657 Vali Acc: 0.794 Test Loss: 0.657 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 25 cost time: 1.1272621154785156
Epoch: 25, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.642 Vali Acc: 0.797 Test Loss: 0.642 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796869).  Saving model ...
Epoch: 26 cost time: 1.2736825942993164
Epoch: 26, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.796869 --> -0.799994).  Saving model ...
Epoch: 27 cost time: 0.9475040435791016
Epoch: 27, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.621 Vali Acc: 0.797 Test Loss: 0.621 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.059833288192749
Epoch: 28, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 29 cost time: 1.015071153640747
Epoch: 29, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 30 cost time: 1.0195326805114746
Epoch: 30, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0727288722991943
Epoch: 31, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 32 cost time: 1.1673574447631836
Epoch: 32, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 33 cost time: 1.0337388515472412
Epoch: 33, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828119).  Saving model ...
Epoch: 34 cost time: 1.2058138847351074
Epoch: 34, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 35 cost time: 1.1086151599884033
Epoch: 35, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 36 cost time: 1.0458941459655762
Epoch: 36, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0090272426605225
Epoch: 37, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 38 cost time: 1.0704052448272705
Epoch: 38, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 39 cost time: 1.0655686855316162
Epoch: 39, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 40 cost time: 1.083493947982788
Epoch: 40, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 41 cost time: 0.9502630233764648
Epoch: 41, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 42 cost time: 1.1681807041168213
Epoch: 42, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.515 Vali Acc: 0.825 Test Loss: 0.515 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1369411945343018
Epoch: 43, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0538218021392822
Epoch: 44, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2367744445800781
Epoch: 45, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 46 cost time: 1.0167455673217773
Epoch: 46, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.061891794204712
Epoch: 47, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9360752105712891
Epoch: 48, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 49 cost time: 0.8712971210479736
Epoch: 49, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.488 Vali Acc: 0.834 Test Loss: 0.488 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4080665111541748
Epoch: 50, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 51 cost time: 1.0923595428466797
Epoch: 51, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 52 cost time: 1.209965467453003
Epoch: 52, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.483 Vali Acc: 0.831 Test Loss: 0.483 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9510014057159424
Epoch: 53, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.475 Vali Acc: 0.834 Test Loss: 0.475 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1438252925872803
Epoch: 54, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0056273937225342
Epoch: 55, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.474 Vali Acc: 0.834 Test Loss: 0.474 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2897067070007324
Epoch: 56, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 57 cost time: 1.2050890922546387
Epoch: 57, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0649147033691406
Epoch: 58, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 59 cost time: 0.9905824661254883
Epoch: 59, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 60 cost time: 0.9113519191741943
Epoch: 60, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0558032989501953
Epoch: 61, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0110194683074951
Epoch: 62, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.95408034324646
Epoch: 63, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9248754978179932
Epoch: 64, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1992247104644775
Epoch: 65, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.922370433807373
Epoch: 66, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.0660614967346191
Epoch: 67, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.0804355144500732
Epoch: 68, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.1150312423706055
Epoch: 69, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 23224
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4935226440429688
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.071 Vali Acc: 0.134 Test Loss: 2.071 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.0974407196044922
Epoch: 2, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.760 Vali Acc: 0.428 Test Loss: 1.760 Test Acc: 0.428
Validation loss decreased (-0.134354 --> -0.428107).  Saving model ...
Epoch: 3 cost time: 1.0668771266937256
Epoch: 3, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.381 Vali Acc: 0.716 Test Loss: 1.381 Test Acc: 0.716
Validation loss decreased (-0.428107 --> -0.715611).  Saving model ...
Epoch: 4 cost time: 0.9960765838623047
Epoch: 4, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.058 Vali Acc: 0.766 Test Loss: 1.058 Test Acc: 0.766
Validation loss decreased (-0.715611 --> -0.765614).  Saving model ...
Epoch: 5 cost time: 1.0813519954681396
Epoch: 5, Steps: 8 | Train Loss: 0.952 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
Validation loss decreased (-0.765614 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 1.1635396480560303
Epoch: 6, Steps: 8 | Train Loss: 0.782 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 1.054079532623291
Epoch: 7, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.9357991218566895
Epoch: 8, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 1.2447166442871094
Epoch: 9, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.111055612564087
Epoch: 10, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.0252952575683594
Epoch: 11, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.474 Vali Acc: 0.863 Test Loss: 0.474 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 1.282153606414795
Epoch: 12, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0616991519927979
Epoch: 13, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2046542167663574
Epoch: 14, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0394501686096191
Epoch: 15, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.207641839981079
Epoch: 16, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.865602970123291
Epoch: 17, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.511 Vali Acc: 0.863 Test Loss: 0.511 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3053665161132812
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.139913558959961
Epoch: 19, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0430972576141357
Epoch: 20, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2994863986968994
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 40904
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.732560873031616
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.038 Vali Acc: 0.203 Test Loss: 2.038 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 1.0576202869415283
Epoch: 2, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.896 Vali Acc: 0.294 Test Loss: 1.896 Test Acc: 0.294
Validation loss decreased (-0.203105 --> -0.293731).  Saving model ...
Epoch: 3 cost time: 1.542250394821167
Epoch: 3, Steps: 8 | Train Loss: 1.867 Vali Loss: 1.701 Vali Acc: 0.466 Test Loss: 1.701 Test Acc: 0.466
Validation loss decreased (-0.293731 --> -0.465608).  Saving model ...
Epoch: 4 cost time: 1.517585277557373
Epoch: 4, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.484 Vali Acc: 0.666 Test Loss: 1.484 Test Acc: 0.666
Validation loss decreased (-0.465608 --> -0.665610).  Saving model ...
Epoch: 5 cost time: 1.2873332500457764
Epoch: 5, Steps: 8 | Train Loss: 1.463 Vali Loss: 1.265 Vali Acc: 0.728 Test Loss: 1.265 Test Acc: 0.728
Validation loss decreased (-0.665610 --> -0.728112).  Saving model ...
Epoch: 6 cost time: 1.2438199520111084
Epoch: 6, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.075 Vali Acc: 0.756 Test Loss: 1.075 Test Acc: 0.756
Validation loss decreased (-0.728112 --> -0.756239).  Saving model ...
Epoch: 7 cost time: 0.977567195892334
Epoch: 7, Steps: 8 | Train Loss: 1.012 Vali Loss: 0.911 Vali Acc: 0.769 Test Loss: 0.911 Test Acc: 0.769
Validation loss decreased (-0.756239 --> -0.768741).  Saving model ...
Epoch: 8 cost time: 1.1959381103515625
Epoch: 8, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.785 Vali Acc: 0.787 Test Loss: 0.785 Test Acc: 0.787
Validation loss decreased (-0.768741 --> -0.787492).  Saving model ...
Epoch: 9 cost time: 1.242429494857788
Epoch: 9, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.699 Vali Acc: 0.794 Test Loss: 0.699 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 10 cost time: 1.130458116531372
Epoch: 10, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
Validation loss decreased (-0.793743 --> -0.806244).  Saving model ...
Epoch: 11 cost time: 1.4240942001342773
Epoch: 11, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 1.1608974933624268
Epoch: 12, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.0128092765808105
Epoch: 13, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 1.205697774887085
Epoch: 14, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5856313705444336
Epoch: 15, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.059443712234497
Epoch: 16, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 17 cost time: 0.9863913059234619
Epoch: 17, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 18 cost time: 1.1100306510925293
Epoch: 18, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 1.126715898513794
Epoch: 19, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1706480979919434
Epoch: 20, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4217133522033691
Epoch: 21, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2377028465270996
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3913404941558838
Epoch: 23, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2876687049865723
Epoch: 24, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.281355857849121
Epoch: 25, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2075815200805664
Epoch: 26, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1356823444366455
Epoch: 27, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 1.2263011932373047
Epoch: 28, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.165302038192749
Epoch: 29, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2536163330078125
Epoch: 30, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.217952013015747
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.076612949371338
Epoch: 32, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0566370487213135
Epoch: 33, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.132786750793457
Epoch: 34, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2475953102111816
Epoch: 35, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9149224758148193
Epoch: 36, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0854341983795166
Epoch: 37, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 26056
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2923436164855957
Epoch: 1, Steps: 8 | Train Loss: 2.325 Vali Loss: 2.127 Vali Acc: 0.122 Test Loss: 2.127 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 1.1896395683288574
Epoch: 2, Steps: 8 | Train Loss: 2.235 Vali Loss: 2.037 Vali Acc: 0.125 Test Loss: 2.037 Test Acc: 0.125
Validation loss decreased (-0.121854 --> -0.124980).  Saving model ...
Epoch: 3 cost time: 1.2380609512329102
Epoch: 3, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.918 Vali Acc: 0.184 Test Loss: 1.918 Test Acc: 0.184
Validation loss decreased (-0.124980 --> -0.184356).  Saving model ...
Epoch: 4 cost time: 1.1736068725585938
Epoch: 4, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.778 Vali Acc: 0.322 Test Loss: 1.778 Test Acc: 0.322
Validation loss decreased (-0.184356 --> -0.321857).  Saving model ...
Epoch: 5 cost time: 1.258453369140625
Epoch: 5, Steps: 8 | Train Loss: 1.867 Vali Loss: 1.622 Vali Acc: 0.516 Test Loss: 1.622 Test Acc: 0.516
Validation loss decreased (-0.321857 --> -0.515609).  Saving model ...
Epoch: 6 cost time: 1.1597380638122559
Epoch: 6, Steps: 8 | Train Loss: 1.641 Vali Loss: 1.452 Vali Acc: 0.659 Test Loss: 1.452 Test Acc: 0.659
Validation loss decreased (-0.515609 --> -0.659360).  Saving model ...
Epoch: 7 cost time: 1.1561472415924072
Epoch: 7, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.278 Vali Acc: 0.750 Test Loss: 1.278 Test Acc: 0.750
Validation loss decreased (-0.659360 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 1.3738150596618652
Epoch: 8, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.110 Vali Acc: 0.787 Test Loss: 1.110 Test Acc: 0.787
Validation loss decreased (-0.749987 --> -0.787489).  Saving model ...
Epoch: 9 cost time: 1.5151441097259521
Epoch: 9, Steps: 8 | Train Loss: 1.108 Vali Loss: 0.964 Vali Acc: 0.787 Test Loss: 0.964 Test Acc: 0.787
Validation loss decreased (-0.787489 --> -0.787490).  Saving model ...
Epoch: 10 cost time: 1.5807554721832275
Epoch: 10, Steps: 8 | Train Loss: 0.962 Vali Loss: 0.836 Vali Acc: 0.816 Test Loss: 0.836 Test Acc: 0.816
Validation loss decreased (-0.787490 --> -0.815617).  Saving model ...
Epoch: 11 cost time: 1.1910009384155273
Epoch: 11, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.732 Vali Acc: 0.822 Test Loss: 0.732 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821868).  Saving model ...
Epoch: 12 cost time: 1.0931532382965088
Epoch: 12, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.654 Vali Acc: 0.828 Test Loss: 0.654 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828118).  Saving model ...
Epoch: 13 cost time: 1.3666651248931885
Epoch: 13, Steps: 8 | Train Loss: 0.607 Vali Loss: 0.601 Vali Acc: 0.831 Test Loss: 0.601 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.0767874717712402
Epoch: 14, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840619).  Saving model ...
Epoch: 15 cost time: 0.9496068954467773
Epoch: 15, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4848082065582275
Epoch: 16, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0747301578521729
Epoch: 17, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 1.2294161319732666
Epoch: 18, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3583431243896484
Epoch: 19, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1480450630187988
Epoch: 20, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3538293838500977
Epoch: 21, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 22 cost time: 1.358734130859375
Epoch: 22, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.496 Vali Acc: 0.866 Test Loss: 0.496 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 23 cost time: 1.049832820892334
Epoch: 23, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.493 Vali Acc: 0.866 Test Loss: 0.493 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 24 cost time: 1.3071975708007812
Epoch: 24, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2825181484222412
Epoch: 25, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3064846992492676
Epoch: 26, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4064929485321045
Epoch: 27, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2423522472381592
Epoch: 28, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5143308639526367
Epoch: 29, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3110597133636475
Epoch: 30, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3798110485076904
Epoch: 31, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0951459407806396
Epoch: 32, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3073441982269287
Epoch: 33, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 21192
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.658695697784424
Epoch: 1, Steps: 8 | Train Loss: 2.183 Vali Loss: 2.022 Vali Acc: 0.163 Test Loss: 2.022 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 1.1142396926879883
Epoch: 2, Steps: 8 | Train Loss: 2.082 Vali Loss: 1.947 Vali Acc: 0.194 Test Loss: 1.947 Test Acc: 0.194
Validation loss decreased (-0.162480 --> -0.193731).  Saving model ...
Epoch: 3 cost time: 1.136871337890625
Epoch: 3, Steps: 8 | Train Loss: 1.973 Vali Loss: 1.826 Vali Acc: 0.275 Test Loss: 1.826 Test Acc: 0.275
Validation loss decreased (-0.193731 --> -0.274982).  Saving model ...
Epoch: 4 cost time: 1.0324811935424805
Epoch: 4, Steps: 8 | Train Loss: 1.878 Vali Loss: 1.684 Vali Acc: 0.428 Test Loss: 1.684 Test Acc: 0.428
Validation loss decreased (-0.274982 --> -0.428108).  Saving model ...
Epoch: 5 cost time: 1.2395880222320557
Epoch: 5, Steps: 8 | Train Loss: 1.668 Vali Loss: 1.539 Vali Acc: 0.553 Test Loss: 1.539 Test Acc: 0.553
Validation loss decreased (-0.428108 --> -0.553110).  Saving model ...
Epoch: 6 cost time: 1.255091667175293
Epoch: 6, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.390 Vali Acc: 0.675 Test Loss: 1.390 Test Acc: 0.675
Validation loss decreased (-0.553110 --> -0.674986).  Saving model ...
Epoch: 7 cost time: 1.4156429767608643
Epoch: 7, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.242 Vali Acc: 0.744 Test Loss: 1.242 Test Acc: 0.744
Validation loss decreased (-0.674986 --> -0.743738).  Saving model ...
Epoch: 8 cost time: 1.1586780548095703
Epoch: 8, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.096 Vali Acc: 0.778 Test Loss: 1.096 Test Acc: 0.778
Validation loss decreased (-0.743738 --> -0.778114).  Saving model ...
Epoch: 9 cost time: 1.285726547241211
Epoch: 9, Steps: 8 | Train Loss: 1.120 Vali Loss: 0.961 Vali Acc: 0.806 Test Loss: 0.961 Test Acc: 0.806
Validation loss decreased (-0.778114 --> -0.806240).  Saving model ...
Epoch: 10 cost time: 1.0960659980773926
Epoch: 10, Steps: 8 | Train Loss: 0.928 Vali Loss: 0.850 Vali Acc: 0.809 Test Loss: 0.850 Test Acc: 0.809
Validation loss decreased (-0.806240 --> -0.809366).  Saving model ...
Epoch: 11 cost time: 1.1015088558197021
Epoch: 11, Steps: 8 | Train Loss: 0.846 Vali Loss: 0.756 Vali Acc: 0.816 Test Loss: 0.756 Test Acc: 0.816
Validation loss decreased (-0.809366 --> -0.815617).  Saving model ...
Epoch: 12 cost time: 1.0989360809326172
Epoch: 12, Steps: 8 | Train Loss: 0.709 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821868).  Saving model ...
Epoch: 13 cost time: 1.1796667575836182
Epoch: 13, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 1.3357079029083252
Epoch: 14, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.593 Vali Acc: 0.831 Test Loss: 0.593 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 1.2188801765441895
Epoch: 15, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843744).  Saving model ...
Epoch: 16 cost time: 1.0964770317077637
Epoch: 16, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2480297088623047
Epoch: 17, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 1.2937583923339844
Epoch: 18, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.41664457321167
Epoch: 19, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.392883539199829
Epoch: 20, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0864925384521484
Epoch: 21, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2633061408996582
Epoch: 22, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2244069576263428
Epoch: 23, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0587801933288574
Epoch: 24, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 25 cost time: 1.2222232818603516
Epoch: 25, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 26 cost time: 1.2615621089935303
Epoch: 26, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 27 cost time: 1.2907767295837402
Epoch: 27, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2880027294158936
Epoch: 28, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.139413833618164
Epoch: 29, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5850505828857422
Epoch: 30, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5839052200317383
Epoch: 31, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1371586322784424
Epoch: 32, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.040224552154541
Epoch: 33, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2732794284820557
Epoch: 34, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3948590755462646
Epoch: 35, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5348389148712158
Epoch: 36, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 18632
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.420894145965576
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.127 Vali Acc: 0.050 Test Loss: 2.127 Test Acc: 0.050
Validation loss decreased (inf --> -0.049979).  Saving model ...
Epoch: 2 cost time: 0.9614078998565674
Epoch: 2, Steps: 8 | Train Loss: 2.124 Vali Loss: 2.059 Vali Acc: 0.144 Test Loss: 2.059 Test Acc: 0.144
Validation loss decreased (-0.049979 --> -0.143729).  Saving model ...
Epoch: 3 cost time: 1.0567119121551514
Epoch: 3, Steps: 8 | Train Loss: 2.052 Vali Loss: 1.973 Vali Acc: 0.231 Test Loss: 1.973 Test Acc: 0.231
Validation loss decreased (-0.143729 --> -0.231230).  Saving model ...
Epoch: 4 cost time: 1.2009162902832031
Epoch: 4, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.870 Vali Acc: 0.341 Test Loss: 1.870 Test Acc: 0.341
Validation loss decreased (-0.231230 --> -0.340606).  Saving model ...
Epoch: 5 cost time: 1.106236219406128
Epoch: 5, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.750 Vali Acc: 0.428 Test Loss: 1.750 Test Acc: 0.428
Validation loss decreased (-0.340606 --> -0.428107).  Saving model ...
Epoch: 6 cost time: 1.1585102081298828
Epoch: 6, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.625 Vali Acc: 0.506 Test Loss: 1.625 Test Acc: 0.506
Validation loss decreased (-0.428107 --> -0.506234).  Saving model ...
Epoch: 7 cost time: 1.142237663269043
Epoch: 7, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.497 Vali Acc: 0.631 Test Loss: 1.497 Test Acc: 0.631
Validation loss decreased (-0.506234 --> -0.631235).  Saving model ...
Epoch: 8 cost time: 1.2490129470825195
Epoch: 8, Steps: 8 | Train Loss: 1.501 Vali Loss: 1.369 Vali Acc: 0.688 Test Loss: 1.369 Test Acc: 0.688
Validation loss decreased (-0.631235 --> -0.687486).  Saving model ...
Epoch: 9 cost time: 1.2314846515655518
Epoch: 9, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.248 Vali Acc: 0.731 Test Loss: 1.248 Test Acc: 0.731
Validation loss decreased (-0.687486 --> -0.731238).  Saving model ...
Epoch: 10 cost time: 0.9310498237609863
Epoch: 10, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.128 Vali Acc: 0.762 Test Loss: 1.128 Test Acc: 0.762
Validation loss decreased (-0.731238 --> -0.762489).  Saving model ...
Epoch: 11 cost time: 1.0603969097137451
Epoch: 11, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.025 Vali Acc: 0.772 Test Loss: 1.025 Test Acc: 0.772
Validation loss decreased (-0.762489 --> -0.771865).  Saving model ...
Epoch: 12 cost time: 1.0883660316467285
Epoch: 12, Steps: 8 | Train Loss: 0.957 Vali Loss: 0.931 Vali Acc: 0.778 Test Loss: 0.931 Test Acc: 0.778
Validation loss decreased (-0.771865 --> -0.778116).  Saving model ...
Epoch: 13 cost time: 1.1064410209655762
Epoch: 13, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.856 Vali Acc: 0.784 Test Loss: 0.856 Test Acc: 0.784
Validation loss decreased (-0.778116 --> -0.784366).  Saving model ...
Epoch: 14 cost time: 1.104823350906372
Epoch: 14, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.795 Vali Acc: 0.784 Test Loss: 0.795 Test Acc: 0.784
Validation loss decreased (-0.784366 --> -0.784367).  Saving model ...
Epoch: 15 cost time: 1.4687230587005615
Epoch: 15, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.746 Vali Acc: 0.784 Test Loss: 0.746 Test Acc: 0.784
Validation loss decreased (-0.784367 --> -0.784368).  Saving model ...
Epoch: 16 cost time: 0.8976449966430664
Epoch: 16, Steps: 8 | Train Loss: 0.624 Vali Loss: 0.705 Vali Acc: 0.787 Test Loss: 0.705 Test Acc: 0.787
Validation loss decreased (-0.784368 --> -0.787493).  Saving model ...
Epoch: 17 cost time: 1.2809944152832031
Epoch: 17, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.672 Vali Acc: 0.791 Test Loss: 0.672 Test Acc: 0.791
Validation loss decreased (-0.787493 --> -0.790618).  Saving model ...
Epoch: 18 cost time: 1.0555357933044434
Epoch: 18, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.645 Vali Acc: 0.791 Test Loss: 0.645 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790619).  Saving model ...
Epoch: 19 cost time: 1.041792869567871
Epoch: 19, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.628 Vali Acc: 0.794 Test Loss: 0.628 Test Acc: 0.794
Validation loss decreased (-0.790619 --> -0.793744).  Saving model ...
Epoch: 20 cost time: 1.0603928565979004
Epoch: 20, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
Validation loss decreased (-0.793744 --> -0.803119).  Saving model ...
Epoch: 21 cost time: 1.1083569526672363
Epoch: 21, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.596 Vali Acc: 0.812 Test Loss: 0.596 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 22 cost time: 1.190913200378418
Epoch: 22, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 23 cost time: 1.4872238636016846
Epoch: 23, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 24 cost time: 1.2905175685882568
Epoch: 24, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 25 cost time: 1.152400016784668
Epoch: 25, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 26 cost time: 1.1750538349151611
Epoch: 26, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2192144393920898
Epoch: 27, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 1.1477246284484863
Epoch: 28, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0706794261932373
Epoch: 29, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1690902709960938
Epoch: 30, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0880045890808105
Epoch: 31, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1472811698913574
Epoch: 32, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5036711692810059
Epoch: 33, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.349513053894043
Epoch: 34, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.036938190460205
Epoch: 35, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2340645790100098
Epoch: 36, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 37 cost time: 1.1125056743621826
Epoch: 37, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 38 cost time: 1.077129602432251
Epoch: 38, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 39 cost time: 1.0546622276306152
Epoch: 39, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1674425601959229
Epoch: 40, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1633882522583008
Epoch: 41, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.175490140914917
Epoch: 42, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2112798690795898
Epoch: 43, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 44 cost time: 1.0376713275909424
Epoch: 44, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5901949405670166
Epoch: 45, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 46 cost time: 0.9706196784973145
Epoch: 46, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3591547012329102
Epoch: 47, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3796172142028809
Epoch: 48, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1406092643737793
Epoch: 49, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1388800144195557
Epoch: 50, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2884817123413086
Epoch: 51, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 52 cost time: 1.1507842540740967
Epoch: 52, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 53 cost time: 1.3626444339752197
Epoch: 53, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.388134241104126
Epoch: 54, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2465195655822754
Epoch: 55, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.200066328048706
Epoch: 56, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.134416103363037
Epoch: 57, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.193960428237915
Epoch: 58, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.3600621223449707
Epoch: 59, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.215876579284668
Epoch: 60, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.3742702007293701
Epoch: 61, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.1680946350097656
Epoch: 62, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 16584
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4047396183013916
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.078 Vali Acc: 0.178 Test Loss: 2.078 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 1.1887221336364746
Epoch: 2, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.985 Vali Acc: 0.203 Test Loss: 1.985 Test Acc: 0.203
Validation loss decreased (-0.178104 --> -0.203105).  Saving model ...
Epoch: 3 cost time: 1.3802049160003662
Epoch: 3, Steps: 8 | Train Loss: 1.996 Vali Loss: 1.882 Vali Acc: 0.278 Test Loss: 1.882 Test Acc: 0.278
Validation loss decreased (-0.203105 --> -0.278106).  Saving model ...
Epoch: 4 cost time: 1.2295186519622803
Epoch: 4, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.767 Vali Acc: 0.372 Test Loss: 1.767 Test Acc: 0.372
Validation loss decreased (-0.278106 --> -0.371857).  Saving model ...
Epoch: 5 cost time: 1.0243065357208252
Epoch: 5, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.651 Vali Acc: 0.494 Test Loss: 1.651 Test Acc: 0.494
Validation loss decreased (-0.371857 --> -0.493733).  Saving model ...
Epoch: 6 cost time: 1.4425880908966064
Epoch: 6, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.535 Vali Acc: 0.578 Test Loss: 1.535 Test Acc: 0.578
Validation loss decreased (-0.493733 --> -0.578110).  Saving model ...
Epoch: 7 cost time: 1.1637322902679443
Epoch: 7, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.419 Vali Acc: 0.644 Test Loss: 1.419 Test Acc: 0.644
Validation loss decreased (-0.578110 --> -0.643736).  Saving model ...
Epoch: 8 cost time: 1.1797990798950195
Epoch: 8, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.310 Vali Acc: 0.706 Test Loss: 1.310 Test Acc: 0.706
Validation loss decreased (-0.643736 --> -0.706237).  Saving model ...
Epoch: 9 cost time: 1.3599045276641846
Epoch: 9, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.210 Vali Acc: 0.734 Test Loss: 1.210 Test Acc: 0.734
Validation loss decreased (-0.706237 --> -0.734363).  Saving model ...
Epoch: 10 cost time: 1.1819899082183838
Epoch: 10, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.117 Vali Acc: 0.756 Test Loss: 1.117 Test Acc: 0.756
Validation loss decreased (-0.734363 --> -0.756239).  Saving model ...
Epoch: 11 cost time: 0.9419870376586914
Epoch: 11, Steps: 8 | Train Loss: 1.091 Vali Loss: 1.035 Vali Acc: 0.762 Test Loss: 1.035 Test Acc: 0.762
Validation loss decreased (-0.756239 --> -0.762490).  Saving model ...
Epoch: 12 cost time: 0.9607083797454834
Epoch: 12, Steps: 8 | Train Loss: 1.041 Vali Loss: 0.960 Vali Acc: 0.778 Test Loss: 0.960 Test Acc: 0.778
Validation loss decreased (-0.762490 --> -0.778115).  Saving model ...
Epoch: 13 cost time: 1.0605862140655518
Epoch: 13, Steps: 8 | Train Loss: 0.950 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3428900241851807
Epoch: 14, Steps: 8 | Train Loss: 0.902 Vali Loss: 0.839 Vali Acc: 0.772 Test Loss: 0.839 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.227534532546997
Epoch: 15, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.791 Vali Acc: 0.778 Test Loss: 0.791 Test Acc: 0.778
Validation loss decreased (-0.778115 --> -0.778117).  Saving model ...
Epoch: 16 cost time: 1.0241549015045166
Epoch: 16, Steps: 8 | Train Loss: 0.766 Vali Loss: 0.748 Vali Acc: 0.781 Test Loss: 0.748 Test Acc: 0.781
Validation loss decreased (-0.778117 --> -0.781243).  Saving model ...
Epoch: 17 cost time: 1.1581828594207764
Epoch: 17, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.720 Vali Acc: 0.784 Test Loss: 0.720 Test Acc: 0.784
Validation loss decreased (-0.781243 --> -0.784368).  Saving model ...
Epoch: 18 cost time: 1.0452344417572021
Epoch: 18, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.695 Vali Acc: 0.794 Test Loss: 0.695 Test Acc: 0.794
Validation loss decreased (-0.784368 --> -0.793743).  Saving model ...
Epoch: 19 cost time: 1.1033680438995361
Epoch: 19, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.672 Vali Acc: 0.794 Test Loss: 0.672 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 20 cost time: 0.9448599815368652
Epoch: 20, Steps: 8 | Train Loss: 0.595 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 21 cost time: 0.9857628345489502
Epoch: 21, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.636 Vali Acc: 0.794 Test Loss: 0.636 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793744).  Saving model ...
Epoch: 22 cost time: 0.9315214157104492
Epoch: 22, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
Validation loss decreased (-0.793744 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 0.9921126365661621
Epoch: 23, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 24 cost time: 1.3870840072631836
Epoch: 24, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
Validation loss decreased (-0.803119 --> -0.821869).  Saving model ...
Epoch: 25 cost time: 1.2787139415740967
Epoch: 25, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1102490425109863
Epoch: 26, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9619715213775635
Epoch: 27, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9906787872314453
Epoch: 28, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.010962963104248
Epoch: 29, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2857654094696045
Epoch: 30, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 31 cost time: 1.3349153995513916
Epoch: 31, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 32 cost time: 1.2369649410247803
Epoch: 32, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 33 cost time: 1.0845956802368164
Epoch: 33, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 34 cost time: 1.0149142742156982
Epoch: 34, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 35 cost time: 0.9469738006591797
Epoch: 35, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0487942695617676
Epoch: 36, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 37 cost time: 1.094799518585205
Epoch: 37, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 1.2649803161621094
Epoch: 38, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 39 cost time: 1.258913278579712
Epoch: 39, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 1.2179315090179443
Epoch: 40, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 1.276733160018921
Epoch: 41, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2263855934143066
Epoch: 42, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9962499141693115
Epoch: 43, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1205394268035889
Epoch: 44, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1858227252960205
Epoch: 45, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.475 Vali Acc: 0.847 Test Loss: 0.475 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.096735954284668
Epoch: 46, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.015897512435913
Epoch: 47, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 48 cost time: 1.242811918258667
Epoch: 48, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4335644245147705
Epoch: 49, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2765398025512695
Epoch: 50, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1839184761047363
Epoch: 51, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 52 cost time: 1.0984292030334473
Epoch: 52, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1827301979064941
Epoch: 53, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.453 Vali Acc: 0.863 Test Loss: 0.453 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 54 cost time: 1.5170965194702148
Epoch: 54, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.445 Vali Acc: 0.866 Test Loss: 0.445 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865621).  Saving model ...
Epoch: 55 cost time: 1.2639994621276855
Epoch: 55, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.442 Vali Acc: 0.869 Test Loss: 0.442 Test Acc: 0.869
Validation loss decreased (-0.865621 --> -0.868746).  Saving model ...
Epoch: 56 cost time: 1.3953657150268555
Epoch: 56, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.444 Vali Acc: 0.869 Test Loss: 0.444 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8555669784545898
Epoch: 57, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.222050666809082
Epoch: 58, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.3374557495117188
Epoch: 59, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.12898588180542
Epoch: 60, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.453 Vali Acc: 0.869 Test Loss: 0.453 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1669237613677979
Epoch: 61, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871871).  Saving model ...
Epoch: 62 cost time: 0.9331367015838623
Epoch: 62, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.446 Vali Acc: 0.869 Test Loss: 0.446 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0714025497436523
Epoch: 63, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 64 cost time: 1.0780494213104248
Epoch: 64, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.871871 --> -0.874996).  Saving model ...
Epoch: 65 cost time: 1.0542662143707275
Epoch: 65, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0212106704711914
Epoch: 66, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1524908542633057
Epoch: 67, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.448 Vali Acc: 0.872 Test Loss: 0.448 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.3184394836425781
Epoch: 68, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.448 Vali Acc: 0.872 Test Loss: 0.448 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.1886203289031982
Epoch: 69, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.445 Vali Acc: 0.872 Test Loss: 0.445 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.076615571975708
Epoch: 70, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.5564014911651611
Epoch: 71, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.0814740657806396
Epoch: 72, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.0149106979370117
Epoch: 73, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.132136583328247
Epoch: 74, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 15288
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8231379985809326
Epoch: 1, Steps: 8 | Train Loss: 2.301 Vali Loss: 2.201 Vali Acc: 0.113 Test Loss: 2.201 Test Acc: 0.113
Validation loss decreased (inf --> -0.112478).  Saving model ...
Epoch: 2 cost time: 1.116565227508545
Epoch: 2, Steps: 8 | Train Loss: 2.211 Vali Loss: 2.142 Vali Acc: 0.147 Test Loss: 2.142 Test Acc: 0.147
Validation loss decreased (-0.112478 --> -0.146854).  Saving model ...
Epoch: 3 cost time: 1.0551397800445557
Epoch: 3, Steps: 8 | Train Loss: 2.150 Vali Loss: 2.067 Vali Acc: 0.178 Test Loss: 2.067 Test Acc: 0.178
Validation loss decreased (-0.146854 --> -0.178104).  Saving model ...
Epoch: 4 cost time: 1.191845417022705
Epoch: 4, Steps: 8 | Train Loss: 2.138 Vali Loss: 1.977 Vali Acc: 0.231 Test Loss: 1.977 Test Acc: 0.231
Validation loss decreased (-0.178104 --> -0.231230).  Saving model ...
Epoch: 5 cost time: 1.3832008838653564
Epoch: 5, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.881 Vali Acc: 0.325 Test Loss: 1.881 Test Acc: 0.325
Validation loss decreased (-0.231230 --> -0.324981).  Saving model ...
Epoch: 6 cost time: 1.0158591270446777
Epoch: 6, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.779 Vali Acc: 0.412 Test Loss: 1.779 Test Acc: 0.412
Validation loss decreased (-0.324981 --> -0.412482).  Saving model ...
Epoch: 7 cost time: 1.1784043312072754
Epoch: 7, Steps: 8 | Train Loss: 1.864 Vali Loss: 1.674 Vali Acc: 0.475 Test Loss: 1.674 Test Acc: 0.475
Validation loss decreased (-0.412482 --> -0.474983).  Saving model ...
Epoch: 8 cost time: 1.2194535732269287
Epoch: 8, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.568 Vali Acc: 0.569 Test Loss: 1.568 Test Acc: 0.569
Validation loss decreased (-0.474983 --> -0.568734).  Saving model ...
Epoch: 9 cost time: 1.0214333534240723
Epoch: 9, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.462 Vali Acc: 0.606 Test Loss: 1.462 Test Acc: 0.606
Validation loss decreased (-0.568734 --> -0.606235).  Saving model ...
Epoch: 10 cost time: 1.0090656280517578
Epoch: 10, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.362 Vali Acc: 0.644 Test Loss: 1.362 Test Acc: 0.644
Validation loss decreased (-0.606235 --> -0.643736).  Saving model ...
Epoch: 11 cost time: 1.1913182735443115
Epoch: 11, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.266 Vali Acc: 0.669 Test Loss: 1.266 Test Acc: 0.669
Validation loss decreased (-0.643736 --> -0.668737).  Saving model ...
Epoch: 12 cost time: 0.8670997619628906
Epoch: 12, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.169 Vali Acc: 0.688 Test Loss: 1.169 Test Acc: 0.688
Validation loss decreased (-0.668737 --> -0.687488).  Saving model ...
Epoch: 13 cost time: 0.9845061302185059
Epoch: 13, Steps: 8 | Train Loss: 1.177 Vali Loss: 1.083 Vali Acc: 0.709 Test Loss: 1.083 Test Acc: 0.709
Validation loss decreased (-0.687488 --> -0.709364).  Saving model ...
Epoch: 14 cost time: 1.1946735382080078
Epoch: 14, Steps: 8 | Train Loss: 1.109 Vali Loss: 1.007 Vali Acc: 0.738 Test Loss: 1.007 Test Acc: 0.738
Validation loss decreased (-0.709364 --> -0.737490).  Saving model ...
Epoch: 15 cost time: 1.1115574836730957
Epoch: 15, Steps: 8 | Train Loss: 0.990 Vali Loss: 0.940 Vali Acc: 0.762 Test Loss: 0.940 Test Acc: 0.762
Validation loss decreased (-0.737490 --> -0.762491).  Saving model ...
Epoch: 16 cost time: 1.132920503616333
Epoch: 16, Steps: 8 | Train Loss: 0.914 Vali Loss: 0.887 Vali Acc: 0.772 Test Loss: 0.887 Test Acc: 0.772
Validation loss decreased (-0.762491 --> -0.771866).  Saving model ...
Epoch: 17 cost time: 1.3620388507843018
Epoch: 17, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.840 Vali Acc: 0.769 Test Loss: 0.840 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3981256484985352
Epoch: 18, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.799 Vali Acc: 0.781 Test Loss: 0.799 Test Acc: 0.781
Validation loss decreased (-0.771866 --> -0.781242).  Saving model ...
Epoch: 19 cost time: 1.2648296356201172
Epoch: 19, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.763 Vali Acc: 0.787 Test Loss: 0.763 Test Acc: 0.787
Validation loss decreased (-0.781242 --> -0.787492).  Saving model ...
Epoch: 20 cost time: 1.148284912109375
Epoch: 20, Steps: 8 | Train Loss: 0.709 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
Validation loss decreased (-0.787492 --> -0.803118).  Saving model ...
Epoch: 21 cost time: 1.0565752983093262
Epoch: 21, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803118).  Saving model ...
Epoch: 22 cost time: 1.1250689029693604
Epoch: 22, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803118).  Saving model ...
Epoch: 23 cost time: 1.220731258392334
Epoch: 23, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.670 Vali Acc: 0.797 Test Loss: 0.670 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5289981365203857
Epoch: 24, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803118).  Saving model ...
Epoch: 25 cost time: 1.382704496383667
Epoch: 25, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.640 Vali Acc: 0.812 Test Loss: 0.640 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 26 cost time: 1.0465455055236816
Epoch: 26, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.627 Vali Acc: 0.812 Test Loss: 0.627 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 27 cost time: 1.0304152965545654
Epoch: 27, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 28 cost time: 1.094982385635376
Epoch: 28, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 29 cost time: 1.1044514179229736
Epoch: 29, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 1.2438204288482666
Epoch: 30, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 31 cost time: 1.4387993812561035
Epoch: 31, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 32 cost time: 1.4093711376190186
Epoch: 32, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 33 cost time: 1.301781415939331
Epoch: 33, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 34 cost time: 1.3875823020935059
Epoch: 34, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0516142845153809
Epoch: 35, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 36 cost time: 1.1902058124542236
Epoch: 36, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2601912021636963
Epoch: 37, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2378661632537842
Epoch: 38, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 39 cost time: 1.2844359874725342
Epoch: 39, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3717079162597656
Epoch: 40, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0899193286895752
Epoch: 41, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0940322875976562
Epoch: 42, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.163348913192749
Epoch: 43, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9811251163482666
Epoch: 44, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4366319179534912
Epoch: 45, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1822705268859863
Epoch: 46, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0964019298553467
Epoch: 47, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3840973377227783
Epoch: 48, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 14776
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6128320693969727
Epoch: 1, Steps: 8 | Train Loss: 2.220 Vali Loss: 2.074 Vali Acc: 0.259 Test Loss: 2.074 Test Acc: 0.259
Validation loss decreased (inf --> -0.259354).  Saving model ...
Epoch: 2 cost time: 1.010512113571167
Epoch: 2, Steps: 8 | Train Loss: 2.032 Vali Loss: 1.775 Vali Acc: 0.469 Test Loss: 1.775 Test Acc: 0.469
Validation loss decreased (-0.259354 --> -0.468732).  Saving model ...
Epoch: 3 cost time: 1.0536348819732666
Epoch: 3, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.449 Vali Acc: 0.594 Test Loss: 1.449 Test Acc: 0.594
Validation loss decreased (-0.468732 --> -0.593736).  Saving model ...
Epoch: 4 cost time: 1.0738799571990967
Epoch: 4, Steps: 8 | Train Loss: 1.358 Vali Loss: 1.139 Vali Acc: 0.725 Test Loss: 1.139 Test Acc: 0.725
Validation loss decreased (-0.593736 --> -0.724989).  Saving model ...
Epoch: 5 cost time: 0.9302597045898438
Epoch: 5, Steps: 8 | Train Loss: 1.057 Vali Loss: 0.900 Vali Acc: 0.778 Test Loss: 0.900 Test Acc: 0.778
Validation loss decreased (-0.724989 --> -0.778116).  Saving model ...
Epoch: 6 cost time: 1.1941304206848145
Epoch: 6, Steps: 8 | Train Loss: 0.863 Vali Loss: 0.731 Vali Acc: 0.794 Test Loss: 0.731 Test Acc: 0.794
Validation loss decreased (-0.778116 --> -0.793743).  Saving model ...
Epoch: 7 cost time: 1.338332176208496
Epoch: 7, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 1.169816493988037
Epoch: 8, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 1.2291550636291504
Epoch: 9, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828120).  Saving model ...
Epoch: 10 cost time: 1.0216777324676514
Epoch: 10, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.121079683303833
Epoch: 11, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 1.3104729652404785
Epoch: 12, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2366774082183838
Epoch: 13, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0800158977508545
Epoch: 14, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 1.126760482788086
Epoch: 15, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.512 Vali Acc: 0.866 Test Loss: 0.512 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 1.194518804550171
Epoch: 16, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3155546188354492
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2973747253417969
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1014420986175537
Epoch: 19, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1097776889801025
Epoch: 20, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.573 Vali Acc: 0.831 Test Loss: 0.573 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2046098709106445
Epoch: 21, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1216020584106445
Epoch: 22, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0211927890777588
Epoch: 23, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0983796119689941
Epoch: 24, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1136493682861328
Epoch: 25, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36680
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.371669054031372
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.098 Vali Acc: 0.128 Test Loss: 2.098 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 0.9978125095367432
Epoch: 2, Steps: 8 | Train Loss: 2.066 Vali Loss: 1.949 Vali Acc: 0.303 Test Loss: 1.949 Test Acc: 0.303
Validation loss decreased (-0.128104 --> -0.303106).  Saving model ...
Epoch: 3 cost time: 1.1346161365509033
Epoch: 3, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.739 Vali Acc: 0.509 Test Loss: 1.739 Test Acc: 0.509
Validation loss decreased (-0.303106 --> -0.509358).  Saving model ...
Epoch: 4 cost time: 1.2048759460449219
Epoch: 4, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.513 Vali Acc: 0.659 Test Loss: 1.513 Test Acc: 0.659
Validation loss decreased (-0.509358 --> -0.659360).  Saving model ...
Epoch: 5 cost time: 1.1411008834838867
Epoch: 5, Steps: 8 | Train Loss: 1.473 Vali Loss: 1.298 Vali Acc: 0.728 Test Loss: 1.298 Test Acc: 0.728
Validation loss decreased (-0.659360 --> -0.728112).  Saving model ...
Epoch: 6 cost time: 1.7578356266021729
Epoch: 6, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.097 Vali Acc: 0.753 Test Loss: 1.097 Test Acc: 0.753
Validation loss decreased (-0.728112 --> -0.753114).  Saving model ...
Epoch: 7 cost time: 1.3075330257415771
Epoch: 7, Steps: 8 | Train Loss: 1.018 Vali Loss: 0.944 Vali Acc: 0.756 Test Loss: 0.944 Test Acc: 0.756
Validation loss decreased (-0.753114 --> -0.756241).  Saving model ...
Epoch: 8 cost time: 1.079552412033081
Epoch: 8, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.817 Vali Acc: 0.769 Test Loss: 0.817 Test Acc: 0.769
Validation loss decreased (-0.756241 --> -0.768742).  Saving model ...
Epoch: 9 cost time: 1.059910535812378
Epoch: 9, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.722 Vali Acc: 0.797 Test Loss: 0.722 Test Acc: 0.797
Validation loss decreased (-0.768742 --> -0.796868).  Saving model ...
Epoch: 10 cost time: 1.2375552654266357
Epoch: 10, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.655 Vali Acc: 0.791 Test Loss: 0.655 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1114954948425293
Epoch: 11, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 12 cost time: 1.0028655529022217
Epoch: 12, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.564 Vali Acc: 0.838 Test Loss: 0.564 Test Acc: 0.838
Validation loss decreased (-0.803119 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.1072089672088623
Epoch: 13, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.554 Vali Acc: 0.812 Test Loss: 0.554 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1079175472259521
Epoch: 14, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.074378252029419
Epoch: 15, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0154469013214111
Epoch: 16, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 1.0005619525909424
Epoch: 17, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0174436569213867
Epoch: 18, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 1.1198558807373047
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.0157690048217773
Epoch: 20, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.082270860671997
Epoch: 21, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0979557037353516
Epoch: 22, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1069412231445312
Epoch: 23, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0177700519561768
Epoch: 24, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0450117588043213
Epoch: 25, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1674549579620361
Epoch: 26, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1907525062561035
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.243459701538086
Epoch: 28, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3012278079986572
Epoch: 29, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 21832
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.380612850189209
Epoch: 1, Steps: 8 | Train Loss: 2.195 Vali Loss: 2.105 Vali Acc: 0.138 Test Loss: 2.105 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 1.0805470943450928
Epoch: 2, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.009 Vali Acc: 0.197 Test Loss: 2.009 Test Acc: 0.197
Validation loss decreased (-0.137479 --> -0.196855).  Saving model ...
Epoch: 3 cost time: 1.1787803173065186
Epoch: 3, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.871 Vali Acc: 0.319 Test Loss: 1.871 Test Acc: 0.319
Validation loss decreased (-0.196855 --> -0.318731).  Saving model ...
Epoch: 4 cost time: 1.2201101779937744
Epoch: 4, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.711 Vali Acc: 0.469 Test Loss: 1.711 Test Acc: 0.469
Validation loss decreased (-0.318731 --> -0.468733).  Saving model ...
Epoch: 5 cost time: 1.0116264820098877
Epoch: 5, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.544 Vali Acc: 0.534 Test Loss: 1.544 Test Acc: 0.534
Validation loss decreased (-0.468733 --> -0.534360).  Saving model ...
Epoch: 6 cost time: 0.9878473281860352
Epoch: 6, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.374 Vali Acc: 0.644 Test Loss: 1.374 Test Acc: 0.644
Validation loss decreased (-0.534360 --> -0.643736).  Saving model ...
Epoch: 7 cost time: 0.9959118366241455
Epoch: 7, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.209 Vali Acc: 0.700 Test Loss: 1.209 Test Acc: 0.700
Validation loss decreased (-0.643736 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.9950132369995117
Epoch: 8, Steps: 8 | Train Loss: 1.181 Vali Loss: 1.061 Vali Acc: 0.713 Test Loss: 1.061 Test Acc: 0.713
Validation loss decreased (-0.699988 --> -0.712489).  Saving model ...
Epoch: 9 cost time: 1.0230109691619873
Epoch: 9, Steps: 8 | Train Loss: 1.030 Vali Loss: 0.932 Vali Acc: 0.734 Test Loss: 0.932 Test Acc: 0.734
Validation loss decreased (-0.712489 --> -0.734366).  Saving model ...
Epoch: 10 cost time: 1.3166582584381104
Epoch: 10, Steps: 8 | Train Loss: 0.908 Vali Loss: 0.827 Vali Acc: 0.772 Test Loss: 0.827 Test Acc: 0.772
Validation loss decreased (-0.734366 --> -0.771867).  Saving model ...
Epoch: 11 cost time: 1.1766507625579834
Epoch: 11, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.739 Vali Acc: 0.803 Test Loss: 0.739 Test Acc: 0.803
Validation loss decreased (-0.771867 --> -0.803118).  Saving model ...
Epoch: 12 cost time: 1.1176683902740479
Epoch: 12, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.678 Vali Acc: 0.812 Test Loss: 0.678 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812493).  Saving model ...
Epoch: 13 cost time: 1.1278882026672363
Epoch: 13, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
Validation loss decreased (-0.812493 --> -0.818744).  Saving model ...
Epoch: 14 cost time: 1.0363717079162598
Epoch: 14, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 15 cost time: 1.055786371231079
Epoch: 15, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 1.0302073955535889
Epoch: 16, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 17 cost time: 1.0234107971191406
Epoch: 17, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 1.1669409275054932
Epoch: 18, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 1.1976962089538574
Epoch: 19, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1694800853729248
Epoch: 20, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0793731212615967
Epoch: 21, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.017697811126709
Epoch: 22, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 23 cost time: 1.2128229141235352
Epoch: 23, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 24 cost time: 1.1803383827209473
Epoch: 24, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2085981369018555
Epoch: 25, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2032814025878906
Epoch: 26, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4132344722747803
Epoch: 27, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.077578067779541
Epoch: 28, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3999757766723633
Epoch: 29, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3026947975158691
Epoch: 30, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.237549066543579
Epoch: 31, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.218320608139038
Epoch: 32, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1108019351959229
Epoch: 33, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 16968
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2771494388580322
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.121 Vali Acc: 0.228 Test Loss: 2.121 Test Acc: 0.228
Validation loss decreased (inf --> -0.228104).  Saving model ...
Epoch: 2 cost time: 0.9009997844696045
Epoch: 2, Steps: 8 | Train Loss: 2.135 Vali Loss: 2.018 Vali Acc: 0.259 Test Loss: 2.018 Test Acc: 0.259
Validation loss decreased (-0.228104 --> -0.259355).  Saving model ...
Epoch: 3 cost time: 0.9947679042816162
Epoch: 3, Steps: 8 | Train Loss: 2.057 Vali Loss: 1.895 Vali Acc: 0.306 Test Loss: 1.895 Test Acc: 0.306
Validation loss decreased (-0.259355 --> -0.306231).  Saving model ...
Epoch: 4 cost time: 1.2458906173706055
Epoch: 4, Steps: 8 | Train Loss: 1.913 Vali Loss: 1.760 Vali Acc: 0.403 Test Loss: 1.760 Test Acc: 0.403
Validation loss decreased (-0.306231 --> -0.403107).  Saving model ...
Epoch: 5 cost time: 1.2548284530639648
Epoch: 5, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.607 Vali Acc: 0.556 Test Loss: 1.607 Test Acc: 0.556
Validation loss decreased (-0.403107 --> -0.556234).  Saving model ...
Epoch: 6 cost time: 1.4617528915405273
Epoch: 6, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.447 Vali Acc: 0.662 Test Loss: 1.447 Test Acc: 0.662
Validation loss decreased (-0.556234 --> -0.662486).  Saving model ...
Epoch: 7 cost time: 1.1305294036865234
Epoch: 7, Steps: 8 | Train Loss: 1.435 Vali Loss: 1.287 Vali Acc: 0.738 Test Loss: 1.287 Test Acc: 0.738
Validation loss decreased (-0.662486 --> -0.737487).  Saving model ...
Epoch: 8 cost time: 1.0153577327728271
Epoch: 8, Steps: 8 | Train Loss: 1.327 Vali Loss: 1.131 Vali Acc: 0.769 Test Loss: 1.131 Test Acc: 0.769
Validation loss decreased (-0.737487 --> -0.768739).  Saving model ...
Epoch: 9 cost time: 1.02199125289917
Epoch: 9, Steps: 8 | Train Loss: 1.111 Vali Loss: 0.992 Vali Acc: 0.784 Test Loss: 0.992 Test Acc: 0.784
Validation loss decreased (-0.768739 --> -0.784365).  Saving model ...
Epoch: 10 cost time: 0.9213502407073975
Epoch: 10, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.875 Vali Acc: 0.812 Test Loss: 0.875 Test Acc: 0.812
Validation loss decreased (-0.784365 --> -0.812491).  Saving model ...
Epoch: 11 cost time: 1.174018144607544
Epoch: 11, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
Validation loss decreased (-0.812491 --> -0.818742).  Saving model ...
Epoch: 12 cost time: 1.0718779563903809
Epoch: 12, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.705 Vali Acc: 0.819 Test Loss: 0.705 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818743).  Saving model ...
Epoch: 13 cost time: 1.0870378017425537
Epoch: 13, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.818743 --> -0.821869).  Saving model ...
Epoch: 14 cost time: 1.1240589618682861
Epoch: 14, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 15 cost time: 1.2175633907318115
Epoch: 15, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 1.0373046398162842
Epoch: 16, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 17 cost time: 1.0091559886932373
Epoch: 17, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 0.9622647762298584
Epoch: 18, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 0.9935956001281738
Epoch: 19, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 1.0982532501220703
Epoch: 20, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.248514175415039
Epoch: 21, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0063583850860596
Epoch: 22, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1706607341766357
Epoch: 23, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0240528583526611
Epoch: 24, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.196258783340454
Epoch: 25, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0043573379516602
Epoch: 26, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2396891117095947
Epoch: 27, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9849593639373779
Epoch: 28, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 0.9803104400634766
Epoch: 29, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0643861293792725
Epoch: 30, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9678778648376465
Epoch: 31, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1929759979248047
Epoch: 32, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.186936378479004
Epoch: 33, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3280436992645264
Epoch: 34, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2237155437469482
Epoch: 35, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 36 cost time: 1.1997241973876953
Epoch: 36, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1279404163360596
Epoch: 37, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2203562259674072
Epoch: 38, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 39 cost time: 1.19158935546875
Epoch: 39, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 40 cost time: 0.9009377956390381
Epoch: 40, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2132461071014404
Epoch: 41, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 42 cost time: 1.1293463706970215
Epoch: 42, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1827688217163086
Epoch: 43, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0866148471832275
Epoch: 44, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1866827011108398
Epoch: 45, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9371578693389893
Epoch: 46, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2684776782989502
Epoch: 47, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0027928352355957
Epoch: 48, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.141021490097046
Epoch: 49, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2383456230163574
Epoch: 50, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.214341163635254
Epoch: 51, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 14408
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6444499492645264
Epoch: 1, Steps: 8 | Train Loss: 2.225 Vali Loss: 2.179 Vali Acc: 0.181 Test Loss: 2.179 Test Acc: 0.181
Validation loss decreased (inf --> -0.181228).  Saving model ...
Epoch: 2 cost time: 1.1923396587371826
Epoch: 2, Steps: 8 | Train Loss: 2.203 Vali Loss: 2.106 Vali Acc: 0.188 Test Loss: 2.106 Test Acc: 0.188
Validation loss decreased (-0.181228 --> -0.187479).  Saving model ...
Epoch: 3 cost time: 1.3609380722045898
Epoch: 3, Steps: 8 | Train Loss: 2.157 Vali Loss: 2.017 Vali Acc: 0.203 Test Loss: 2.017 Test Acc: 0.203
Validation loss decreased (-0.187479 --> -0.203105).  Saving model ...
Epoch: 4 cost time: 1.071580410003662
Epoch: 4, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.914 Vali Acc: 0.234 Test Loss: 1.914 Test Acc: 0.234
Validation loss decreased (-0.203105 --> -0.234356).  Saving model ...
Epoch: 5 cost time: 1.507155418395996
Epoch: 5, Steps: 8 | Train Loss: 1.957 Vali Loss: 1.802 Vali Acc: 0.316 Test Loss: 1.802 Test Acc: 0.316
Validation loss decreased (-0.234356 --> -0.315607).  Saving model ...
Epoch: 6 cost time: 1.148571491241455
Epoch: 6, Steps: 8 | Train Loss: 1.751 Vali Loss: 1.683 Vali Acc: 0.406 Test Loss: 1.683 Test Acc: 0.406
Validation loss decreased (-0.315607 --> -0.406233).  Saving model ...
Epoch: 7 cost time: 1.3380568027496338
Epoch: 7, Steps: 8 | Train Loss: 1.676 Vali Loss: 1.560 Vali Acc: 0.534 Test Loss: 1.560 Test Acc: 0.534
Validation loss decreased (-0.406233 --> -0.534359).  Saving model ...
Epoch: 8 cost time: 1.3090379238128662
Epoch: 8, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.438 Vali Acc: 0.631 Test Loss: 1.438 Test Acc: 0.631
Validation loss decreased (-0.534359 --> -0.631236).  Saving model ...
Epoch: 9 cost time: 1.1732797622680664
Epoch: 9, Steps: 8 | Train Loss: 1.416 Vali Loss: 1.319 Vali Acc: 0.688 Test Loss: 1.319 Test Acc: 0.688
Validation loss decreased (-0.631236 --> -0.687487).  Saving model ...
Epoch: 10 cost time: 1.6011462211608887
Epoch: 10, Steps: 8 | Train Loss: 1.350 Vali Loss: 1.202 Vali Acc: 0.722 Test Loss: 1.202 Test Acc: 0.722
Validation loss decreased (-0.687487 --> -0.721863).  Saving model ...
Epoch: 11 cost time: 1.464601755142212
Epoch: 11, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.099 Vali Acc: 0.741 Test Loss: 1.099 Test Acc: 0.741
Validation loss decreased (-0.721863 --> -0.740614).  Saving model ...
Epoch: 12 cost time: 1.1273415088653564
Epoch: 12, Steps: 8 | Train Loss: 1.030 Vali Loss: 1.003 Vali Acc: 0.747 Test Loss: 1.003 Test Acc: 0.747
Validation loss decreased (-0.740614 --> -0.746865).  Saving model ...
Epoch: 13 cost time: 1.226771593093872
Epoch: 13, Steps: 8 | Train Loss: 0.982 Vali Loss: 0.916 Vali Acc: 0.769 Test Loss: 0.916 Test Acc: 0.769
Validation loss decreased (-0.746865 --> -0.768741).  Saving model ...
Epoch: 14 cost time: 1.1205408573150635
Epoch: 14, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.844 Vali Acc: 0.784 Test Loss: 0.844 Test Acc: 0.784
Validation loss decreased (-0.768741 --> -0.784367).  Saving model ...
Epoch: 15 cost time: 1.2032651901245117
Epoch: 15, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.784 Vali Acc: 0.791 Test Loss: 0.784 Test Acc: 0.791
Validation loss decreased (-0.784367 --> -0.790617).  Saving model ...
Epoch: 16 cost time: 1.6110594272613525
Epoch: 16, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.733 Vali Acc: 0.797 Test Loss: 0.733 Test Acc: 0.797
Validation loss decreased (-0.790617 --> -0.796868).  Saving model ...
Epoch: 17 cost time: 1.570469617843628
Epoch: 17, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.245988130569458
Epoch: 18, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809368).  Saving model ...
Epoch: 19 cost time: 1.1153514385223389
Epoch: 19, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.634 Vali Acc: 0.819 Test Loss: 0.634 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 20 cost time: 1.232790470123291
Epoch: 20, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 21 cost time: 1.5551502704620361
Epoch: 21, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.602 Vali Acc: 0.816 Test Loss: 0.602 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.222499132156372
Epoch: 22, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 23 cost time: 1.2149274349212646
Epoch: 23, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 24 cost time: 1.572960615158081
Epoch: 24, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 25 cost time: 1.2894525527954102
Epoch: 25, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 26 cost time: 1.1974148750305176
Epoch: 26, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1622750759124756
Epoch: 27, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 28 cost time: 1.113994836807251
Epoch: 28, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3249974250793457
Epoch: 29, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1899139881134033
Epoch: 30, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 31 cost time: 1.2918245792388916
Epoch: 31, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2787950038909912
Epoch: 32, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2804391384124756
Epoch: 33, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3696486949920654
Epoch: 34, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5865418910980225
Epoch: 35, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 36 cost time: 1.152195692062378
Epoch: 36, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 37 cost time: 1.1520366668701172
Epoch: 37, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.124330997467041
Epoch: 38, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2481768131256104
Epoch: 39, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.259145975112915
Epoch: 40, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2718749046325684
Epoch: 41, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 42 cost time: 1.2935011386871338
Epoch: 42, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1039860248565674
Epoch: 43, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3531079292297363
Epoch: 44, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4000601768493652
Epoch: 45, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3735628128051758
Epoch: 46, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1327924728393555
Epoch: 47, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1116650104522705
Epoch: 48, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.420090913772583
Epoch: 49, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2009098529815674
Epoch: 50, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 51 cost time: 1.0657787322998047
Epoch: 51, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1750226020812988
Epoch: 52, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3439459800720215
Epoch: 53, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2566478252410889
Epoch: 54, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.5308599472045898
Epoch: 55, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3100461959838867
Epoch: 56, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2527010440826416
Epoch: 57, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1257216930389404
Epoch: 58, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.2807669639587402
Epoch: 59, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.436586618423462
Epoch: 60, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 61 cost time: 1.173952579498291
Epoch: 61, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.35905122756958
Epoch: 62, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.206399917602539
Epoch: 63, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.2720229625701904
Epoch: 64, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.2241454124450684
Epoch: 65, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.260235071182251
Epoch: 66, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.3755650520324707
Epoch: 67, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 68 cost time: 1.2358314990997314
Epoch: 68, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.3037567138671875
Epoch: 69, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.3167715072631836
Epoch: 70, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.2058191299438477
Epoch: 71, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.345905065536499
Epoch: 72, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.3926293849945068
Epoch: 73, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.265570878982544
Epoch: 74, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.3639228343963623
Epoch: 75, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.20068359375
Epoch: 76, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.565 Vali Acc: 0.838 Test Loss: 0.565 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.1745622158050537
Epoch: 77, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 12360
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.874850034713745
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.070 Vali Acc: 0.200 Test Loss: 2.070 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.146117925643921
Epoch: 2, Steps: 8 | Train Loss: 2.097 Vali Loss: 1.988 Vali Acc: 0.206 Test Loss: 1.988 Test Acc: 0.206
Validation loss decreased (-0.199979 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 1.2015137672424316
Epoch: 3, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.890 Vali Acc: 0.247 Test Loss: 1.890 Test Acc: 0.247
Validation loss decreased (-0.206230 --> -0.246856).  Saving model ...
Epoch: 4 cost time: 1.1144623756408691
Epoch: 4, Steps: 8 | Train Loss: 1.915 Vali Loss: 1.773 Vali Acc: 0.344 Test Loss: 1.773 Test Acc: 0.344
Validation loss decreased (-0.246856 --> -0.343732).  Saving model ...
Epoch: 5 cost time: 1.2767341136932373
Epoch: 5, Steps: 8 | Train Loss: 1.826 Vali Loss: 1.649 Vali Acc: 0.441 Test Loss: 1.649 Test Acc: 0.441
Validation loss decreased (-0.343732 --> -0.440609).  Saving model ...
Epoch: 6 cost time: 1.4240431785583496
Epoch: 6, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.527 Vali Acc: 0.562 Test Loss: 1.527 Test Acc: 0.562
Validation loss decreased (-0.440609 --> -0.562485).  Saving model ...
Epoch: 7 cost time: 1.3172261714935303
Epoch: 7, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.407 Vali Acc: 0.628 Test Loss: 1.407 Test Acc: 0.628
Validation loss decreased (-0.562485 --> -0.628111).  Saving model ...
Epoch: 8 cost time: 1.144207239151001
Epoch: 8, Steps: 8 | Train Loss: 1.426 Vali Loss: 1.291 Vali Acc: 0.684 Test Loss: 1.291 Test Acc: 0.684
Validation loss decreased (-0.628111 --> -0.684362).  Saving model ...
Epoch: 9 cost time: 1.1053638458251953
Epoch: 9, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.186 Vali Acc: 0.731 Test Loss: 1.186 Test Acc: 0.731
Validation loss decreased (-0.684362 --> -0.731238).  Saving model ...
Epoch: 10 cost time: 1.329498291015625
Epoch: 10, Steps: 8 | Train Loss: 1.230 Vali Loss: 1.087 Vali Acc: 0.750 Test Loss: 1.087 Test Acc: 0.750
Validation loss decreased (-0.731238 --> -0.749989).  Saving model ...
Epoch: 11 cost time: 1.2591605186462402
Epoch: 11, Steps: 8 | Train Loss: 1.100 Vali Loss: 0.996 Vali Acc: 0.766 Test Loss: 0.996 Test Acc: 0.766
Validation loss decreased (-0.749989 --> -0.765615).  Saving model ...
Epoch: 12 cost time: 1.1753008365631104
Epoch: 12, Steps: 8 | Train Loss: 1.011 Vali Loss: 0.917 Vali Acc: 0.772 Test Loss: 0.917 Test Acc: 0.772
Validation loss decreased (-0.765615 --> -0.771866).  Saving model ...
Epoch: 13 cost time: 1.180140733718872
Epoch: 13, Steps: 8 | Train Loss: 0.931 Vali Loss: 0.853 Vali Acc: 0.781 Test Loss: 0.853 Test Acc: 0.781
Validation loss decreased (-0.771866 --> -0.781241).  Saving model ...
Epoch: 14 cost time: 1.22554612159729
Epoch: 14, Steps: 8 | Train Loss: 0.837 Vali Loss: 0.802 Vali Acc: 0.791 Test Loss: 0.802 Test Acc: 0.791
Validation loss decreased (-0.781241 --> -0.790617).  Saving model ...
Epoch: 15 cost time: 1.328775405883789
Epoch: 15, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.757 Vali Acc: 0.794 Test Loss: 0.757 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793742).  Saving model ...
Epoch: 16 cost time: 1.111060619354248
Epoch: 16, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.722 Vali Acc: 0.791 Test Loss: 0.722 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0672571659088135
Epoch: 17, Steps: 8 | Train Loss: 0.672 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
Validation loss decreased (-0.793742 --> -0.793743).  Saving model ...
Epoch: 18 cost time: 1.1267294883728027
Epoch: 18, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.666 Vali Acc: 0.797 Test Loss: 0.666 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 19 cost time: 1.0129907131195068
Epoch: 19, Steps: 8 | Train Loss: 0.607 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 20 cost time: 1.3887338638305664
Epoch: 20, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.626 Vali Acc: 0.812 Test Loss: 0.626 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 21 cost time: 1.3012409210205078
Epoch: 21, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 22 cost time: 1.2790815830230713
Epoch: 22, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2942829132080078
Epoch: 23, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.414994478225708
Epoch: 24, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 25 cost time: 1.096144199371338
Epoch: 25, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 26 cost time: 1.1532115936279297
Epoch: 26, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 1.3845109939575195
Epoch: 27, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 1.2947514057159424
Epoch: 28, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 29 cost time: 1.1603176593780518
Epoch: 29, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 30 cost time: 1.3917310237884521
Epoch: 30, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 31 cost time: 1.0659055709838867
Epoch: 31, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 32 cost time: 1.1083590984344482
Epoch: 32, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.526 Vali Acc: 0.828 Test Loss: 0.526 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 33 cost time: 1.1092708110809326
Epoch: 33, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 34 cost time: 1.1265501976013184
Epoch: 34, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1872949600219727
Epoch: 35, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1254775524139404
Epoch: 36, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 37 cost time: 1.326491117477417
Epoch: 37, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 38 cost time: 1.4062058925628662
Epoch: 38, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 39 cost time: 1.2775113582611084
Epoch: 39, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 40 cost time: 1.4331374168395996
Epoch: 40, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3068976402282715
Epoch: 41, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0605049133300781
Epoch: 42, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4430038928985596
Epoch: 43, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2133688926696777
Epoch: 44, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 45 cost time: 1.3388433456420898
Epoch: 45, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 46 cost time: 1.3908355236053467
Epoch: 46, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 47 cost time: 1.4086449146270752
Epoch: 47, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.388641119003296
Epoch: 48, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 1.3530242443084717
Epoch: 49, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 50 cost time: 1.0711658000946045
Epoch: 50, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.224628210067749
Epoch: 51, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2721076011657715
Epoch: 52, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2326927185058594
Epoch: 53, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 54 cost time: 1.3201491832733154
Epoch: 54, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 55 cost time: 0.9997785091400146
Epoch: 55, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.173069715499878
Epoch: 56, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2623906135559082
Epoch: 57, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.2966432571411133
Epoch: 58, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.0718231201171875
Epoch: 59, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1447546482086182
Epoch: 60, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.3862419128417969
Epoch: 61, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 62 cost time: 1.2957556247711182
Epoch: 62, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 63 cost time: 1.3950116634368896
Epoch: 63, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.5078322887420654
Epoch: 64, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.2047138214111328
Epoch: 65, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 66 cost time: 1.2968900203704834
Epoch: 66, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 67 cost time: 1.3082072734832764
Epoch: 67, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 68 cost time: 1.2749865055084229
Epoch: 68, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 69 cost time: 1.4582715034484863
Epoch: 69, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.230104684829712
Epoch: 70, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.29349684715271
Epoch: 71, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.3891127109527588
Epoch: 72, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.6931302547454834
Epoch: 73, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 74 cost time: 1.3418653011322021
Epoch: 74, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 75 cost time: 1.3152129650115967
Epoch: 75, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.317051887512207
Epoch: 76, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 77 cost time: 1.3382258415222168
Epoch: 77, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0982859134674072
Epoch: 78, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.280987024307251
Epoch: 79, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.2713866233825684
Epoch: 80, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.541388988494873
Epoch: 81, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.471571445465088
Epoch: 82, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.1957805156707764
Epoch: 83, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.166245460510254
Epoch: 84, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.960881233215332
Epoch: 85, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.0484495162963867
Epoch: 86, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 11064
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.598525285720825
Epoch: 1, Steps: 8 | Train Loss: 2.337 Vali Loss: 2.240 Vali Acc: 0.113 Test Loss: 2.240 Test Acc: 0.113
Validation loss decreased (inf --> -0.112478).  Saving model ...
Epoch: 2 cost time: 1.0665056705474854
Epoch: 2, Steps: 8 | Train Loss: 2.191 Vali Loss: 2.160 Vali Acc: 0.128 Test Loss: 2.160 Test Acc: 0.128
Validation loss decreased (-0.112478 --> -0.128103).  Saving model ...
Epoch: 3 cost time: 0.9574747085571289
Epoch: 3, Steps: 8 | Train Loss: 2.135 Vali Loss: 2.065 Vali Acc: 0.169 Test Loss: 2.065 Test Acc: 0.169
Validation loss decreased (-0.128103 --> -0.168729).  Saving model ...
Epoch: 4 cost time: 1.047318458557129
Epoch: 4, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.951 Vali Acc: 0.247 Test Loss: 1.951 Test Acc: 0.247
Validation loss decreased (-0.168729 --> -0.246855).  Saving model ...
Epoch: 5 cost time: 1.0655739307403564
Epoch: 5, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.835 Vali Acc: 0.338 Test Loss: 1.835 Test Acc: 0.338
Validation loss decreased (-0.246855 --> -0.337482).  Saving model ...
Epoch: 6 cost time: 1.2678260803222656
Epoch: 6, Steps: 8 | Train Loss: 1.823 Vali Loss: 1.722 Vali Acc: 0.416 Test Loss: 1.722 Test Acc: 0.416
Validation loss decreased (-0.337482 --> -0.415608).  Saving model ...
Epoch: 7 cost time: 1.2930097579956055
Epoch: 7, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.606 Vali Acc: 0.503 Test Loss: 1.606 Test Acc: 0.503
Validation loss decreased (-0.415608 --> -0.503109).  Saving model ...
Epoch: 8 cost time: 1.285834789276123
Epoch: 8, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.491 Vali Acc: 0.594 Test Loss: 1.491 Test Acc: 0.594
Validation loss decreased (-0.503109 --> -0.593735).  Saving model ...
Epoch: 9 cost time: 1.0527606010437012
Epoch: 9, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.384 Vali Acc: 0.650 Test Loss: 1.384 Test Acc: 0.650
Validation loss decreased (-0.593735 --> -0.649986).  Saving model ...
Epoch: 10 cost time: 1.0778393745422363
Epoch: 10, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.282 Vali Acc: 0.694 Test Loss: 1.282 Test Acc: 0.694
Validation loss decreased (-0.649986 --> -0.693737).  Saving model ...
Epoch: 11 cost time: 1.1921398639678955
Epoch: 11, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.185 Vali Acc: 0.738 Test Loss: 1.185 Test Acc: 0.738
Validation loss decreased (-0.693737 --> -0.737488).  Saving model ...
Epoch: 12 cost time: 1.153918743133545
Epoch: 12, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.096 Vali Acc: 0.762 Test Loss: 1.096 Test Acc: 0.762
Validation loss decreased (-0.737488 --> -0.762489).  Saving model ...
Epoch: 13 cost time: 1.2521677017211914
Epoch: 13, Steps: 8 | Train Loss: 1.113 Vali Loss: 1.021 Vali Acc: 0.769 Test Loss: 1.021 Test Acc: 0.769
Validation loss decreased (-0.762489 --> -0.768740).  Saving model ...
Epoch: 14 cost time: 1.3023977279663086
Epoch: 14, Steps: 8 | Train Loss: 1.006 Vali Loss: 0.954 Vali Acc: 0.775 Test Loss: 0.954 Test Acc: 0.775
Validation loss decreased (-0.768740 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 1.1131105422973633
Epoch: 15, Steps: 8 | Train Loss: 0.958 Vali Loss: 0.894 Vali Acc: 0.787 Test Loss: 0.894 Test Acc: 0.787
Validation loss decreased (-0.774990 --> -0.787491).  Saving model ...
Epoch: 16 cost time: 1.2938916683197021
Epoch: 16, Steps: 8 | Train Loss: 0.863 Vali Loss: 0.846 Vali Acc: 0.797 Test Loss: 0.846 Test Acc: 0.797
Validation loss decreased (-0.787491 --> -0.796867).  Saving model ...
Epoch: 17 cost time: 1.4486291408538818
Epoch: 17, Steps: 8 | Train Loss: 0.786 Vali Loss: 0.805 Vali Acc: 0.803 Test Loss: 0.805 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803117).  Saving model ...
Epoch: 18 cost time: 1.133117914199829
Epoch: 18, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0508928298950195
Epoch: 19, Steps: 8 | Train Loss: 0.747 Vali Loss: 0.741 Vali Acc: 0.794 Test Loss: 0.741 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2090065479278564
Epoch: 20, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4658706188201904
Epoch: 21, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803118).  Saving model ...
Epoch: 22 cost time: 1.1696922779083252
Epoch: 22, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.672 Vali Acc: 0.797 Test Loss: 0.672 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1038234233856201
Epoch: 23, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4272451400756836
Epoch: 24, Steps: 8 | Train Loss: 0.575 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 25 cost time: 1.0976109504699707
Epoch: 25, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 26 cost time: 1.4532382488250732
Epoch: 26, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 27 cost time: 1.322890043258667
Epoch: 27, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 28 cost time: 1.0676500797271729
Epoch: 28, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2725603580474854
Epoch: 29, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3203744888305664
Epoch: 30, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1602039337158203
Epoch: 31, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 32 cost time: 1.3983118534088135
Epoch: 32, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 33 cost time: 1.572514533996582
Epoch: 33, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 34 cost time: 1.12386155128479
Epoch: 34, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2550201416015625
Epoch: 35, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 36 cost time: 1.1627702713012695
Epoch: 36, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 37 cost time: 1.2143919467926025
Epoch: 37, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
Validation loss decreased (-0.818745 --> -0.831245).  Saving model ...
Epoch: 38 cost time: 1.234712839126587
Epoch: 38, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 39 cost time: 1.369823932647705
Epoch: 39, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 40 cost time: 1.4156641960144043
Epoch: 40, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 41 cost time: 1.2454545497894287
Epoch: 41, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 42 cost time: 1.1930427551269531
Epoch: 42, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2775640487670898
Epoch: 43, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 44 cost time: 1.2399516105651855
Epoch: 44, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 45 cost time: 1.333726406097412
Epoch: 45, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 46 cost time: 1.2105395793914795
Epoch: 46, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 47 cost time: 1.361713171005249
Epoch: 47, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 48 cost time: 1.6373958587646484
Epoch: 48, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 49 cost time: 1.1917979717254639
Epoch: 49, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2062649726867676
Epoch: 50, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2038164138793945
Epoch: 51, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 52 cost time: 1.581460952758789
Epoch: 52, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5362775325775146
Epoch: 53, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 54 cost time: 1.6263689994812012
Epoch: 54, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1120977401733398
Epoch: 55, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.22878098487854
Epoch: 56, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.684880256652832
Epoch: 57, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.4865179061889648
Epoch: 58, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.2821872234344482
Epoch: 59, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.4385323524475098
Epoch: 60, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.201451063156128
Epoch: 61, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.2177362442016602
Epoch: 62, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.2689929008483887
Epoch: 63, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el2_dm16_nh4_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 10552
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4513299465179443
Epoch: 1, Steps: 8 | Train Loss: 2.127 Vali Loss: 1.610 Vali Acc: 0.591 Test Loss: 1.610 Test Acc: 0.591
Validation loss decreased (inf --> -0.590609).  Saving model ...
Epoch: 2 cost time: 0.9618015289306641
Epoch: 2, Steps: 8 | Train Loss: 1.267 Vali Loss: 0.725 Vali Acc: 0.791 Test Loss: 0.725 Test Acc: 0.791
Validation loss decreased (-0.590609 --> -0.790618).  Saving model ...
Epoch: 3 cost time: 1.1201765537261963
Epoch: 3, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
Validation loss decreased (-0.790618 --> -0.824995).  Saving model ...
Epoch: 4 cost time: 1.3344614505767822
Epoch: 4, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.824995 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.0976970195770264
Epoch: 5, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.573 Vali Acc: 0.834 Test Loss: 0.573 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3331356048583984
Epoch: 6, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 1.0981407165527344
Epoch: 7, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.647 Vali Acc: 0.838 Test Loss: 0.647 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0317564010620117
Epoch: 8, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.714 Vali Acc: 0.838 Test Loss: 0.714 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0237164497375488
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1844186782836914
Epoch: 10, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.767 Vali Acc: 0.834 Test Loss: 0.767 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9766561985015869
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.866 Vali Acc: 0.819 Test Loss: 0.866 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4966213703155518
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.903 Vali Acc: 0.822 Test Loss: 0.903 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2358577251434326
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.932 Vali Acc: 0.831 Test Loss: 0.932 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.146087408065796
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.925 Vali Acc: 0.825 Test Loss: 0.925 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.165029525756836
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.828 Test Loss: 0.910 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0144658088684082
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.909 Vali Acc: 0.831 Test Loss: 0.909 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 373384
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6659462451934814
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 1.849 Vali Acc: 0.388 Test Loss: 1.849 Test Acc: 0.388
Validation loss decreased (inf --> -0.387482).  Saving model ...
Epoch: 2 cost time: 1.1997604370117188
Epoch: 2, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.083 Vali Acc: 0.747 Test Loss: 1.083 Test Acc: 0.747
Validation loss decreased (-0.387482 --> -0.746864).  Saving model ...
Epoch: 3 cost time: 1.105666160583496
Epoch: 3, Steps: 8 | Train Loss: 0.753 Vali Loss: 0.647 Vali Acc: 0.806 Test Loss: 0.647 Test Acc: 0.806
Validation loss decreased (-0.746864 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 0.9465944766998291
Epoch: 4, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.806244 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.87919020652771
Epoch: 5, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.132699728012085
Epoch: 6, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9397368431091309
Epoch: 7, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9465742111206055
Epoch: 8, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 1.1293725967407227
Epoch: 9, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2558906078338623
Epoch: 10, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.644 Vali Acc: 0.841 Test Loss: 0.644 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1904070377349854
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.666 Vali Acc: 0.825 Test Loss: 0.666 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2795114517211914
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.677 Vali Acc: 0.841 Test Loss: 0.677 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.255641222000122
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.750 Vali Acc: 0.831 Test Loss: 0.750 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0759084224700928
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.758 Vali Acc: 0.819 Test Loss: 0.758 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0478830337524414
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.786 Vali Acc: 0.831 Test Loss: 0.786 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0807600021362305
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.820 Vali Acc: 0.828 Test Loss: 0.820 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3910534381866455
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.822 Vali Acc: 0.838 Test Loss: 0.822 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3418493270874023
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.827 Vali Acc: 0.834 Test Loss: 0.827 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 254600
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.053717613220215
Epoch: 1, Steps: 8 | Train Loss: 2.188 Vali Loss: 1.882 Vali Acc: 0.356 Test Loss: 1.882 Test Acc: 0.356
Validation loss decreased (inf --> -0.356231).  Saving model ...
Epoch: 2 cost time: 1.0964975357055664
Epoch: 2, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.255 Vali Acc: 0.741 Test Loss: 1.255 Test Acc: 0.741
Validation loss decreased (-0.356231 --> -0.740612).  Saving model ...
Epoch: 3 cost time: 1.137542486190796
Epoch: 3, Steps: 8 | Train Loss: 1.050 Vali Loss: 0.770 Vali Acc: 0.791 Test Loss: 0.770 Test Acc: 0.791
Validation loss decreased (-0.740612 --> -0.790617).  Saving model ...
Epoch: 4 cost time: 1.0132536888122559
Epoch: 4, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
Validation loss decreased (-0.790617 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.3210396766662598
Epoch: 5, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.821869 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 1.2832353115081787
Epoch: 6, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1964058876037598
Epoch: 7, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.505171775817871
Epoch: 8, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4923994541168213
Epoch: 9, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.239337682723999
Epoch: 10, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.210334300994873
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0693447589874268
Epoch: 12, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0508289337158203
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.143779993057251
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3334980010986328
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 215688
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.735544204711914
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 1.931 Vali Acc: 0.219 Test Loss: 1.931 Test Acc: 0.219
Validation loss decreased (inf --> -0.218731).  Saving model ...
Epoch: 2 cost time: 0.9916064739227295
Epoch: 2, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.344 Vali Acc: 0.700 Test Loss: 1.344 Test Acc: 0.700
Validation loss decreased (-0.218731 --> -0.699987).  Saving model ...
Epoch: 3 cost time: 1.2440681457519531
Epoch: 3, Steps: 8 | Train Loss: 1.118 Vali Loss: 0.868 Vali Acc: 0.766 Test Loss: 0.868 Test Acc: 0.766
Validation loss decreased (-0.699987 --> -0.765616).  Saving model ...
Epoch: 4 cost time: 0.9389567375183105
Epoch: 4, Steps: 8 | Train Loss: 0.755 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
Validation loss decreased (-0.765616 --> -0.803119).  Saving model ...
Epoch: 5 cost time: 0.8184831142425537
Epoch: 5, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.544 Vali Acc: 0.806 Test Loss: 0.544 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806245).  Saving model ...
Epoch: 6 cost time: 0.8265697956085205
Epoch: 6, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
Validation loss decreased (-0.806245 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.9064545631408691
Epoch: 7, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0107605457305908
Epoch: 8, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 1.12579345703125
Epoch: 9, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.1651794910430908
Epoch: 10, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0323407649993896
Epoch: 11, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1007628440856934
Epoch: 12, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.087536334991455
Epoch: 13, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.980128288269043
Epoch: 14, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3451292514801025
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0167768001556396
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.654 Vali Acc: 0.825 Test Loss: 0.654 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3435735702514648
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.648 Vali Acc: 0.828 Test Loss: 0.648 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9135980606079102
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.658 Vali Acc: 0.838 Test Loss: 0.658 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8994889259338379
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.650 Vali Acc: 0.831 Test Loss: 0.650 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 195208
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.178523063659668
Epoch: 1, Steps: 8 | Train Loss: 2.162 Vali Loss: 2.015 Vali Acc: 0.178 Test Loss: 2.015 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.0989813804626465
Epoch: 2, Steps: 8 | Train Loss: 1.855 Vali Loss: 1.566 Vali Acc: 0.525 Test Loss: 1.566 Test Acc: 0.525
Validation loss decreased (-0.178105 --> -0.524984).  Saving model ...
Epoch: 3 cost time: 1.1674518585205078
Epoch: 3, Steps: 8 | Train Loss: 1.376 Vali Loss: 1.118 Vali Acc: 0.753 Test Loss: 1.118 Test Acc: 0.753
Validation loss decreased (-0.524984 --> -0.753114).  Saving model ...
Epoch: 4 cost time: 0.9524807929992676
Epoch: 4, Steps: 8 | Train Loss: 0.968 Vali Loss: 0.812 Vali Acc: 0.772 Test Loss: 0.812 Test Acc: 0.772
Validation loss decreased (-0.753114 --> -0.771867).  Saving model ...
Epoch: 5 cost time: 0.8356208801269531
Epoch: 5, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
Validation loss decreased (-0.771867 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 1.1338958740234375
Epoch: 6, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821870).  Saving model ...
Epoch: 7 cost time: 1.0184500217437744
Epoch: 7, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1927433013916016
Epoch: 8, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 0.9754409790039062
Epoch: 9, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1849470138549805
Epoch: 10, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.063040018081665
Epoch: 11, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1910252571105957
Epoch: 12, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.046144962310791
Epoch: 13, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9723410606384277
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9176173210144043
Epoch: 15, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4190919399261475
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9392361640930176
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2789089679718018
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2147223949432373
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4625983238220215
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 178824
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8014538288116455
Epoch: 1, Steps: 8 | Train Loss: 2.304 Vali Loss: 2.067 Vali Acc: 0.181 Test Loss: 2.067 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 0.9447636604309082
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.685 Vali Acc: 0.453 Test Loss: 1.685 Test Acc: 0.453
Validation loss decreased (-0.181229 --> -0.453108).  Saving model ...
Epoch: 3 cost time: 1.2147846221923828
Epoch: 3, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.268 Vali Acc: 0.681 Test Loss: 1.268 Test Acc: 0.681
Validation loss decreased (-0.453108 --> -0.681237).  Saving model ...
Epoch: 4 cost time: 1.1252975463867188
Epoch: 4, Steps: 8 | Train Loss: 1.119 Vali Loss: 0.933 Vali Acc: 0.762 Test Loss: 0.933 Test Acc: 0.762
Validation loss decreased (-0.681237 --> -0.762491).  Saving model ...
Epoch: 5 cost time: 1.3006036281585693
Epoch: 5, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.733 Vali Acc: 0.806 Test Loss: 0.733 Test Acc: 0.806
Validation loss decreased (-0.762491 --> -0.806243).  Saving model ...
Epoch: 6 cost time: 1.1008610725402832
Epoch: 6, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 1.0049753189086914
Epoch: 7, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.567 Vali Acc: 0.812 Test Loss: 0.567 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 1.0429892539978027
Epoch: 8, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
Validation loss decreased (-0.812494 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 1.030791997909546
Epoch: 9, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 10 cost time: 1.1415367126464844
Epoch: 10, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 1.0579006671905518
Epoch: 11, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.886746883392334
Epoch: 12, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.128866195678711
Epoch: 13, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 1.0966839790344238
Epoch: 14, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0561366081237793
Epoch: 15, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 1.3072683811187744
Epoch: 16, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9837889671325684
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0263824462890625
Epoch: 18, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1005196571350098
Epoch: 19, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2107672691345215
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1304678916931152
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0594842433929443
Epoch: 22, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2835466861724854
Epoch: 23, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.328418254852295
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2697932720184326
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 168456
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6154422760009766
Epoch: 1, Steps: 8 | Train Loss: 2.216 Vali Loss: 2.076 Vali Acc: 0.106 Test Loss: 2.076 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 1.3615648746490479
Epoch: 2, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.748 Vali Acc: 0.397 Test Loss: 1.748 Test Acc: 0.397
Validation loss decreased (-0.106229 --> -0.396858).  Saving model ...
Epoch: 3 cost time: 1.1779143810272217
Epoch: 3, Steps: 8 | Train Loss: 1.560 Vali Loss: 1.368 Vali Acc: 0.666 Test Loss: 1.368 Test Acc: 0.666
Validation loss decreased (-0.396858 --> -0.665611).  Saving model ...
Epoch: 4 cost time: 1.0921046733856201
Epoch: 4, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.039 Vali Acc: 0.744 Test Loss: 1.039 Test Acc: 0.744
Validation loss decreased (-0.665611 --> -0.743740).  Saving model ...
Epoch: 5 cost time: 1.1436123847961426
Epoch: 5, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.831 Vali Acc: 0.769 Test Loss: 0.831 Test Acc: 0.769
Validation loss decreased (-0.743740 --> -0.768742).  Saving model ...
Epoch: 6 cost time: 0.9799959659576416
Epoch: 6, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.697 Vali Acc: 0.787 Test Loss: 0.697 Test Acc: 0.787
Validation loss decreased (-0.768742 --> -0.787493).  Saving model ...
Epoch: 7 cost time: 0.8110330104827881
Epoch: 7, Steps: 8 | Train Loss: 0.630 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
Validation loss decreased (-0.787493 --> -0.803119).  Saving model ...
Epoch: 8 cost time: 1.1075761318206787
Epoch: 8, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 1.2883732318878174
Epoch: 9, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818745).  Saving model ...
Epoch: 10 cost time: 1.4489285945892334
Epoch: 10, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 11 cost time: 1.1847176551818848
Epoch: 11, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 12 cost time: 0.8531653881072998
Epoch: 12, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 0.9281587600708008
Epoch: 13, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 14 cost time: 1.0282630920410156
Epoch: 14, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.9404356479644775
Epoch: 15, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 1.029975414276123
Epoch: 16, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 0.9126207828521729
Epoch: 17, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1525352001190186
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0316333770751953
Epoch: 19, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.482 Vali Acc: 0.831 Test Loss: 0.482 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0539741516113281
Epoch: 20, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.479 Vali Acc: 0.831 Test Loss: 0.479 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0046725273132324
Epoch: 21, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.927985429763794
Epoch: 22, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 1.1753242015838623
Epoch: 23, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3528516292572021
Epoch: 24, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0866978168487549
Epoch: 25, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9956152439117432
Epoch: 26, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.964421272277832
Epoch: 27, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2195563316345215
Epoch: 28, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.044947862625122
Epoch: 29, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.937838077545166
Epoch: 30, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0820300579071045
Epoch: 31, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 0.8258259296417236
Epoch: 32, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 1.0820891857147217
Epoch: 33, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.925241231918335
Epoch: 34, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2914025783538818
Epoch: 35, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2034869194030762
Epoch: 36, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1155734062194824
Epoch: 37, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 38 cost time: 0.9947521686553955
Epoch: 38, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1667590141296387
Epoch: 39, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.038900375366211
Epoch: 40, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.055391788482666
Epoch: 41, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.495708703994751
Epoch: 42, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1729137897491455
Epoch: 43, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3937327861785889
Epoch: 44, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1048202514648438
Epoch: 45, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.2539198398590088
Epoch: 46, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.853 Test Loss: 0.521 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0971052646636963
Epoch: 47, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 164360
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.928549289703369
Epoch: 1, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.545 Vali Acc: 0.647 Test Loss: 1.545 Test Acc: 0.647
Validation loss decreased (inf --> -0.646860).  Saving model ...
Epoch: 2 cost time: 1.298506259918213
Epoch: 2, Steps: 8 | Train Loss: 1.082 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
Validation loss decreased (-0.646860 --> -0.793743).  Saving model ...
Epoch: 3 cost time: 1.5886893272399902
Epoch: 3, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.793743 --> -0.843745).  Saving model ...
Epoch: 4 cost time: 1.441279649734497
Epoch: 4, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.591 Vali Acc: 0.806 Test Loss: 0.591 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0506141185760498
Epoch: 5, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1670544147491455
Epoch: 6, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.612 Vali Acc: 0.841 Test Loss: 0.612 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0989797115325928
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.728 Vali Acc: 0.797 Test Loss: 0.728 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1368827819824219
Epoch: 8, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2970681190490723
Epoch: 9, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.790 Vali Acc: 0.819 Test Loss: 0.790 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3960626125335693
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.869 Vali Acc: 0.831 Test Loss: 0.869 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2981939315795898
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.904 Vali Acc: 0.831 Test Loss: 0.904 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.160764455795288
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.912 Vali Acc: 0.841 Test Loss: 0.912 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9320394992828369
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.831 Test Loss: 0.907 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 340488
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.917346477508545
Epoch: 1, Steps: 8 | Train Loss: 2.115 Vali Loss: 1.847 Vali Acc: 0.247 Test Loss: 1.847 Test Acc: 0.247
Validation loss decreased (inf --> -0.246857).  Saving model ...
Epoch: 2 cost time: 1.2720954418182373
Epoch: 2, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.066 Vali Acc: 0.759 Test Loss: 1.066 Test Acc: 0.759
Validation loss decreased (-0.246857 --> -0.759364).  Saving model ...
Epoch: 3 cost time: 1.0008454322814941
Epoch: 3, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
Validation loss decreased (-0.759364 --> -0.809368).  Saving model ...
Epoch: 4 cost time: 1.2631142139434814
Epoch: 4, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
Validation loss decreased (-0.809368 --> -0.834370).  Saving model ...
Epoch: 5 cost time: 1.406062126159668
Epoch: 5, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.3208227157592773
Epoch: 6, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.0361199378967285
Epoch: 7, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2195427417755127
Epoch: 8, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3579590320587158
Epoch: 9, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.611 Vali Acc: 0.838 Test Loss: 0.611 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5196623802185059
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3028175830841064
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.700 Vali Acc: 0.831 Test Loss: 0.700 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3157989978790283
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.747 Vali Acc: 0.828 Test Loss: 0.747 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0133326053619385
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.739 Vali Acc: 0.828 Test Loss: 0.739 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.042438268661499
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.783 Vali Acc: 0.834 Test Loss: 0.783 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0933034420013428
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.827 Vali Acc: 0.828 Test Loss: 0.827 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0837314128875732
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.798 Vali Acc: 0.828 Test Loss: 0.798 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 221704
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.059678554534912
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 1.857 Vali Acc: 0.347 Test Loss: 1.857 Test Acc: 0.347
Validation loss decreased (inf --> -0.346856).  Saving model ...
Epoch: 2 cost time: 1.1242082118988037
Epoch: 2, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.240 Vali Acc: 0.691 Test Loss: 1.240 Test Acc: 0.691
Validation loss decreased (-0.346856 --> -0.690613).  Saving model ...
Epoch: 3 cost time: 1.115121603012085
Epoch: 3, Steps: 8 | Train Loss: 1.018 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
Validation loss decreased (-0.690613 --> -0.774992).  Saving model ...
Epoch: 4 cost time: 0.9922788143157959
Epoch: 4, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.774992 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.1153817176818848
Epoch: 5, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.501 Vali Acc: 0.825 Test Loss: 0.501 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 1.0588293075561523
Epoch: 6, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.824995 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.1900570392608643
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2727556228637695
Epoch: 8, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0325498580932617
Epoch: 9, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1830735206604004
Epoch: 10, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0402112007141113
Epoch: 11, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0387587547302246
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2443103790283203
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2268610000610352
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.655 Vali Acc: 0.834 Test Loss: 0.655 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9563794136047363
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.665 Vali Acc: 0.831 Test Loss: 0.665 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0245020389556885
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.683 Vali Acc: 0.816 Test Loss: 0.683 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 182792
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0116817951202393
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 1.903 Vali Acc: 0.278 Test Loss: 1.903 Test Acc: 0.278
Validation loss decreased (inf --> -0.278106).  Saving model ...
Epoch: 2 cost time: 1.1869111061096191
Epoch: 2, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.358 Vali Acc: 0.694 Test Loss: 1.358 Test Acc: 0.694
Validation loss decreased (-0.278106 --> -0.693736).  Saving model ...
Epoch: 3 cost time: 1.000396966934204
Epoch: 3, Steps: 8 | Train Loss: 1.146 Vali Loss: 0.897 Vali Acc: 0.778 Test Loss: 0.897 Test Acc: 0.778
Validation loss decreased (-0.693736 --> -0.778116).  Saving model ...
Epoch: 4 cost time: 1.1830213069915771
Epoch: 4, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
Validation loss decreased (-0.778116 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 0.9670679569244385
Epoch: 5, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 6 cost time: 1.140254020690918
Epoch: 6, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.803119 --> -0.824995).  Saving model ...
Epoch: 7 cost time: 1.0680732727050781
Epoch: 7, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9710640907287598
Epoch: 8, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 1.224015474319458
Epoch: 9, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 0.7598133087158203
Epoch: 10, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9170899391174316
Epoch: 11, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9788086414337158
Epoch: 12, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8334958553314209
Epoch: 13, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0803656578063965
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.623 Vali Acc: 0.834 Test Loss: 0.623 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.22640061378479
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.629 Vali Acc: 0.831 Test Loss: 0.629 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1846332550048828
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1596431732177734
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.671 Vali Acc: 0.825 Test Loss: 0.671 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.021937608718872
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.671 Vali Acc: 0.831 Test Loss: 0.671 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0327672958374023
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.674 Vali Acc: 0.831 Test Loss: 0.674 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 162312
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3063910007476807
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.917 Vali Acc: 0.247 Test Loss: 1.917 Test Acc: 0.247
Validation loss decreased (inf --> -0.246856).  Saving model ...
Epoch: 2 cost time: 1.3537256717681885
Epoch: 2, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.481 Vali Acc: 0.569 Test Loss: 1.481 Test Acc: 0.569
Validation loss decreased (-0.246856 --> -0.568735).  Saving model ...
Epoch: 3 cost time: 1.1019082069396973
Epoch: 3, Steps: 8 | Train Loss: 1.268 Vali Loss: 1.038 Vali Acc: 0.766 Test Loss: 1.038 Test Acc: 0.766
Validation loss decreased (-0.568735 --> -0.765615).  Saving model ...
Epoch: 4 cost time: 0.9828512668609619
Epoch: 4, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.754 Vali Acc: 0.797 Test Loss: 0.754 Test Acc: 0.797
Validation loss decreased (-0.765615 --> -0.796867).  Saving model ...
Epoch: 5 cost time: 1.1228511333465576
Epoch: 5, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.608 Vali Acc: 0.812 Test Loss: 0.608 Test Acc: 0.812
Validation loss decreased (-0.796867 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.9981434345245361
Epoch: 6, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.812494 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.8256654739379883
Epoch: 7, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.491 Vali Acc: 0.831 Test Loss: 0.491 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.213026523590088
Epoch: 8, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.479 Vali Acc: 0.834 Test Loss: 0.479 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 0.9694035053253174
Epoch: 9, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.214214563369751
Epoch: 10, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.467 Vali Acc: 0.834 Test Loss: 0.467 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 1.3392271995544434
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.477 Vali Acc: 0.834 Test Loss: 0.477 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.122882604598999
Epoch: 12, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.175135612487793
Epoch: 13, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0059216022491455
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1333539485931396
Epoch: 15, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1690030097961426
Epoch: 16, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9831423759460449
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2313365936279297
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.107304573059082
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2613434791564941
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 145928
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4705443382263184
Epoch: 1, Steps: 8 | Train Loss: 2.270 Vali Loss: 2.083 Vali Acc: 0.119 Test Loss: 2.083 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 1.1296052932739258
Epoch: 2, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.724 Vali Acc: 0.372 Test Loss: 1.724 Test Acc: 0.372
Validation loss decreased (-0.118729 --> -0.371858).  Saving model ...
Epoch: 3 cost time: 0.9255678653717041
Epoch: 3, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.319 Vali Acc: 0.659 Test Loss: 1.319 Test Acc: 0.659
Validation loss decreased (-0.371858 --> -0.659362).  Saving model ...
Epoch: 4 cost time: 0.8643016815185547
Epoch: 4, Steps: 8 | Train Loss: 1.202 Vali Loss: 0.979 Vali Acc: 0.738 Test Loss: 0.979 Test Acc: 0.738
Validation loss decreased (-0.659362 --> -0.737490).  Saving model ...
Epoch: 5 cost time: 0.8944613933563232
Epoch: 5, Steps: 8 | Train Loss: 0.850 Vali Loss: 0.769 Vali Acc: 0.759 Test Loss: 0.769 Test Acc: 0.759
Validation loss decreased (-0.737490 --> -0.759367).  Saving model ...
Epoch: 6 cost time: 1.0283823013305664
Epoch: 6, Steps: 8 | Train Loss: 0.646 Vali Loss: 0.653 Vali Acc: 0.784 Test Loss: 0.653 Test Acc: 0.784
Validation loss decreased (-0.759367 --> -0.784368).  Saving model ...
Epoch: 7 cost time: 0.8839631080627441
Epoch: 7, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
Validation loss decreased (-0.784368 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 1.119063138961792
Epoch: 8, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.540 Vali Acc: 0.806 Test Loss: 0.540 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.806245).  Saving model ...
Epoch: 9 cost time: 0.8902435302734375
Epoch: 9, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.514 Vali Acc: 0.812 Test Loss: 0.514 Test Acc: 0.812
Validation loss decreased (-0.806245 --> -0.812495).  Saving model ...
Epoch: 10 cost time: 0.8557064533233643
Epoch: 10, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
Validation loss decreased (-0.812495 --> -0.821870).  Saving model ...
Epoch: 11 cost time: 1.1202583312988281
Epoch: 11, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.9025728702545166
Epoch: 12, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.488 Vali Acc: 0.828 Test Loss: 0.488 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 0.8814387321472168
Epoch: 13, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.488 Vali Acc: 0.831 Test Loss: 0.488 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 14 cost time: 1.0518083572387695
Epoch: 14, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.492 Vali Acc: 0.831 Test Loss: 0.492 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9887433052062988
Epoch: 15, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 0.8968403339385986
Epoch: 16, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8939132690429688
Epoch: 17, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.992450475692749
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.9896457195281982
Epoch: 19, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9141654968261719
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0737807750701904
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9351823329925537
Epoch: 22, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0320723056793213
Epoch: 23, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2827558517456055
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0593414306640625
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1553001403808594
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.047473430633545
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9802525043487549
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 135560
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.695286273956299
Epoch: 1, Steps: 8 | Train Loss: 2.395 Vali Loss: 2.290 Vali Acc: 0.041 Test Loss: 2.290 Test Acc: 0.041
Validation loss decreased (inf --> -0.040602).  Saving model ...
Epoch: 2 cost time: 1.2650883197784424
Epoch: 2, Steps: 8 | Train Loss: 2.199 Vali Loss: 1.937 Vali Acc: 0.209 Test Loss: 1.937 Test Acc: 0.209
Validation loss decreased (-0.040602 --> -0.209356).  Saving model ...
Epoch: 3 cost time: 0.8751604557037354
Epoch: 3, Steps: 8 | Train Loss: 1.736 Vali Loss: 1.512 Vali Acc: 0.619 Test Loss: 1.512 Test Acc: 0.619
Validation loss decreased (-0.209356 --> -0.618735).  Saving model ...
Epoch: 4 cost time: 1.0141916275024414
Epoch: 4, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.145 Vali Acc: 0.716 Test Loss: 1.145 Test Acc: 0.716
Validation loss decreased (-0.618735 --> -0.715614).  Saving model ...
Epoch: 5 cost time: 1.0541279315948486
Epoch: 5, Steps: 8 | Train Loss: 1.019 Vali Loss: 0.883 Vali Acc: 0.759 Test Loss: 0.883 Test Acc: 0.759
Validation loss decreased (-0.715614 --> -0.759366).  Saving model ...
Epoch: 6 cost time: 1.2878332138061523
Epoch: 6, Steps: 8 | Train Loss: 0.807 Vali Loss: 0.720 Vali Acc: 0.797 Test Loss: 0.720 Test Acc: 0.797
Validation loss decreased (-0.759366 --> -0.796868).  Saving model ...
Epoch: 7 cost time: 1.1535007953643799
Epoch: 7, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.623 Vali Acc: 0.812 Test Loss: 0.623 Test Acc: 0.812
Validation loss decreased (-0.796868 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 0.9946837425231934
Epoch: 8, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.9078004360198975
Epoch: 9, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.0162091255187988
Epoch: 10, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 1.0083305835723877
Epoch: 11, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1214020252227783
Epoch: 12, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0360033512115479
Epoch: 13, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.0037388801574707
Epoch: 14, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 1.048142910003662
Epoch: 15, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.979724645614624
Epoch: 16, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9438278675079346
Epoch: 17, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9385313987731934
Epoch: 18, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0570950508117676
Epoch: 19, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8575670719146729
Epoch: 20, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9563503265380859
Epoch: 21, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9542088508605957
Epoch: 22, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.226637363433838
Epoch: 23, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9591739177703857
Epoch: 24, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 25 cost time: 1.1582574844360352
Epoch: 25, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9454302787780762
Epoch: 26, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.860039234161377
Epoch: 27, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0213570594787598
Epoch: 28, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.02089524269104
Epoch: 29, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3281323909759521
Epoch: 30, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2711217403411865
Epoch: 31, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.050459861755371
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.038689136505127
Epoch: 33, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0608723163604736
Epoch: 34, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 131464
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.596776247024536
Epoch: 1, Steps: 8 | Train Loss: 2.069 Vali Loss: 1.581 Vali Acc: 0.581 Test Loss: 1.581 Test Acc: 0.581
Validation loss decreased (inf --> -0.581234).  Saving model ...
Epoch: 2 cost time: 1.1651999950408936
Epoch: 2, Steps: 8 | Train Loss: 1.221 Vali Loss: 0.759 Vali Acc: 0.775 Test Loss: 0.759 Test Acc: 0.775
Validation loss decreased (-0.581234 --> -0.774992).  Saving model ...
Epoch: 3 cost time: 0.9624285697937012
Epoch: 3, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
Validation loss decreased (-0.774992 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 1.208862066268921
Epoch: 4, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.0381486415863037
Epoch: 5, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.578 Vali Acc: 0.853 Test Loss: 0.578 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853119).  Saving model ...
Epoch: 6 cost time: 1.138007402420044
Epoch: 6, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.724 Vali Acc: 0.791 Test Loss: 0.724 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2114558219909668
Epoch: 7, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.132521152496338
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.762 Vali Acc: 0.809 Test Loss: 0.762 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2599155902862549
Epoch: 9, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.755 Vali Acc: 0.834 Test Loss: 0.755 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9648845195770264
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.896 Vali Acc: 0.816 Test Loss: 0.896 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.049304723739624
Epoch: 11, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.854 Vali Acc: 0.838 Test Loss: 0.854 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8536581993103027
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.939 Vali Acc: 0.825 Test Loss: 0.939 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8668107986450195
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.002 Vali Acc: 0.809 Test Loss: 1.002 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9564502239227295
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.828 Test Loss: 0.996 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2821502685546875
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.158 Vali Acc: 0.816 Test Loss: 1.158 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 324040
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.555769920349121
Epoch: 1, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.815 Vali Acc: 0.362 Test Loss: 1.815 Test Acc: 0.362
Validation loss decreased (inf --> -0.362482).  Saving model ...
Epoch: 2 cost time: 1.0850293636322021
Epoch: 2, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.051 Vali Acc: 0.753 Test Loss: 1.051 Test Acc: 0.753
Validation loss decreased (-0.362482 --> -0.753114).  Saving model ...
Epoch: 3 cost time: 1.0085935592651367
Epoch: 3, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.652 Vali Acc: 0.797 Test Loss: 0.652 Test Acc: 0.797
Validation loss decreased (-0.753114 --> -0.796868).  Saving model ...
Epoch: 4 cost time: 0.6917695999145508
Epoch: 4, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
Validation loss decreased (-0.796868 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 0.9377498626708984
Epoch: 5, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0888118743896484
Epoch: 6, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1587011814117432
Epoch: 7, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0112829208374023
Epoch: 8, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.589 Vali Acc: 0.828 Test Loss: 0.589 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.9760251045227051
Epoch: 9, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9760298728942871
Epoch: 10, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9954800605773926
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.658 Vali Acc: 0.838 Test Loss: 0.658 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837493).  Saving model ...
Epoch: 12 cost time: 0.931387186050415
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.683 Vali Acc: 0.816 Test Loss: 0.683 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1010768413543701
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0713047981262207
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.822 Test Loss: 0.765 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0217092037200928
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.793 Vali Acc: 0.828 Test Loss: 0.793 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8877036571502686
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.825 Test Loss: 0.806 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3407800197601318
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.816 Vali Acc: 0.828 Test Loss: 0.816 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8736717700958252
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.826 Vali Acc: 0.819 Test Loss: 0.826 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.081857681274414
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.822 Vali Acc: 0.828 Test Loss: 0.822 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0042309761047363
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.827 Vali Acc: 0.831 Test Loss: 0.827 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2113924026489258
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.834 Test Loss: 0.831 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 205256
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.139470338821411
Epoch: 1, Steps: 8 | Train Loss: 2.124 Vali Loss: 1.902 Vali Acc: 0.291 Test Loss: 1.902 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 1.0222606658935547
Epoch: 2, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.260 Vali Acc: 0.725 Test Loss: 1.260 Test Acc: 0.725
Validation loss decreased (-0.290606 --> -0.724987).  Saving model ...
Epoch: 3 cost time: 1.0816543102264404
Epoch: 3, Steps: 8 | Train Loss: 1.064 Vali Loss: 0.794 Vali Acc: 0.806 Test Loss: 0.794 Test Acc: 0.806
Validation loss decreased (-0.724987 --> -0.806242).  Saving model ...
Epoch: 4 cost time: 1.1632435321807861
Epoch: 4, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.581 Vali Acc: 0.838 Test Loss: 0.581 Test Acc: 0.838
Validation loss decreased (-0.806242 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 1.2619547843933105
Epoch: 5, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.314934253692627
Epoch: 6, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.19694185256958
Epoch: 7, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4509162902832031
Epoch: 8, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.024930477142334
Epoch: 9, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 1.0685031414031982
Epoch: 10, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1913337707519531
Epoch: 11, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2184507846832275
Epoch: 12, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.596 Vali Acc: 0.834 Test Loss: 0.596 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1637811660766602
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.653 Vali Acc: 0.822 Test Loss: 0.653 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1398608684539795
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.205549716949463
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0166635513305664
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4014947414398193
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.704 Vali Acc: 0.828 Test Loss: 0.704 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1713926792144775
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.701 Vali Acc: 0.819 Test Loss: 0.701 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0431914329528809
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 166344
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3200767040252686
Epoch: 1, Steps: 8 | Train Loss: 2.323 Vali Loss: 2.064 Vali Acc: 0.156 Test Loss: 2.064 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.8361814022064209
Epoch: 2, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.454 Vali Acc: 0.628 Test Loss: 1.454 Test Acc: 0.628
Validation loss decreased (-0.156229 --> -0.628110).  Saving model ...
Epoch: 3 cost time: 1.0604166984558105
Epoch: 3, Steps: 8 | Train Loss: 1.213 Vali Loss: 0.923 Vali Acc: 0.787 Test Loss: 0.923 Test Acc: 0.787
Validation loss decreased (-0.628110 --> -0.787491).  Saving model ...
Epoch: 4 cost time: 0.8212325572967529
Epoch: 4, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.659 Vali Acc: 0.794 Test Loss: 0.659 Test Acc: 0.794
Validation loss decreased (-0.787491 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 1.2250449657440186
Epoch: 5, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.554 Vali Acc: 0.812 Test Loss: 0.554 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.9858074188232422
Epoch: 6, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815620).  Saving model ...
Epoch: 7 cost time: 0.9838581085205078
Epoch: 7, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
Validation loss decreased (-0.815620 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.9427945613861084
Epoch: 8, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9021329879760742
Epoch: 9, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0758466720581055
Epoch: 10, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2666478157043457
Epoch: 11, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.8410770893096924
Epoch: 12, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1663358211517334
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9760944843292236
Epoch: 14, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.632 Vali Acc: 0.816 Test Loss: 0.632 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.916013240814209
Epoch: 15, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.261997938156128
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9741184711456299
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1356279850006104
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.639 Vali Acc: 0.838 Test Loss: 0.639 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.025841236114502
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.655 Vali Acc: 0.825 Test Loss: 0.655 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8496534824371338
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8744397163391113
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 145864
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8969554901123047
Epoch: 1, Steps: 8 | Train Loss: 2.298 Vali Loss: 2.057 Vali Acc: 0.097 Test Loss: 2.057 Test Acc: 0.097
Validation loss decreased (inf --> -0.096854).  Saving model ...
Epoch: 2 cost time: 1.4107186794281006
Epoch: 2, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.600 Vali Acc: 0.519 Test Loss: 1.600 Test Acc: 0.519
Validation loss decreased (-0.096854 --> -0.518734).  Saving model ...
Epoch: 3 cost time: 1.1039049625396729
Epoch: 3, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.134 Vali Acc: 0.753 Test Loss: 1.134 Test Acc: 0.753
Validation loss decreased (-0.518734 --> -0.753114).  Saving model ...
Epoch: 4 cost time: 1.3022541999816895
Epoch: 4, Steps: 8 | Train Loss: 0.935 Vali Loss: 0.813 Vali Acc: 0.784 Test Loss: 0.813 Test Acc: 0.784
Validation loss decreased (-0.753114 --> -0.784367).  Saving model ...
Epoch: 5 cost time: 1.27628493309021
Epoch: 5, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.643 Vali Acc: 0.794 Test Loss: 0.643 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793744).  Saving model ...
Epoch: 6 cost time: 1.4373536109924316
Epoch: 6, Steps: 8 | Train Loss: 0.515 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
Validation loss decreased (-0.793744 --> -0.821870).  Saving model ...
Epoch: 7 cost time: 1.487715244293213
Epoch: 7, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
Validation loss decreased (-0.821870 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.9418704509735107
Epoch: 8, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2150499820709229
Epoch: 9, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8759820461273193
Epoch: 10, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0445079803466797
Epoch: 11, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0279924869537354
Epoch: 12, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.8290047645568848
Epoch: 13, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.875464677810669
Epoch: 14, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.337829828262329
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0083060264587402
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3638622760772705
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.455885410308838
Epoch: 18, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8846118450164795
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1309483051300049
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.297206163406372
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.612 Vali Acc: 0.831 Test Loss: 0.612 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0946714878082275
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.608 Vali Acc: 0.831 Test Loss: 0.608 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 129480
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0650877952575684
Epoch: 1, Steps: 8 | Train Loss: 2.125 Vali Loss: 1.976 Vali Acc: 0.247 Test Loss: 1.976 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 1.4615328311920166
Epoch: 2, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.645 Vali Acc: 0.481 Test Loss: 1.645 Test Acc: 0.481
Validation loss decreased (-0.246855 --> -0.481234).  Saving model ...
Epoch: 3 cost time: 0.9159467220306396
Epoch: 3, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.252 Vali Acc: 0.653 Test Loss: 1.252 Test Acc: 0.653
Validation loss decreased (-0.481234 --> -0.653112).  Saving model ...
Epoch: 4 cost time: 1.031064510345459
Epoch: 4, Steps: 8 | Train Loss: 1.119 Vali Loss: 0.941 Vali Acc: 0.762 Test Loss: 0.941 Test Acc: 0.762
Validation loss decreased (-0.653112 --> -0.762491).  Saving model ...
Epoch: 5 cost time: 1.1780860424041748
Epoch: 5, Steps: 8 | Train Loss: 0.825 Vali Loss: 0.749 Vali Acc: 0.787 Test Loss: 0.749 Test Acc: 0.787
Validation loss decreased (-0.762491 --> -0.787493).  Saving model ...
Epoch: 6 cost time: 1.4584214687347412
Epoch: 6, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.633 Vali Acc: 0.791 Test Loss: 0.633 Test Acc: 0.791
Validation loss decreased (-0.787493 --> -0.790619).  Saving model ...
Epoch: 7 cost time: 0.9718396663665771
Epoch: 7, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
Validation loss decreased (-0.790619 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 1.1335031986236572
Epoch: 8, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818745).  Saving model ...
Epoch: 9 cost time: 0.9538888931274414
Epoch: 9, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
Validation loss decreased (-0.818745 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 1.3458518981933594
Epoch: 10, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 1.2313358783721924
Epoch: 11, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 1.060866117477417
Epoch: 12, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 1.144392967224121
Epoch: 13, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9433972835540771
Epoch: 14, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.148871898651123
Epoch: 15, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0705468654632568
Epoch: 16, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.490372657775879
Epoch: 17, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9602944850921631
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0565273761749268
Epoch: 19, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9868087768554688
Epoch: 20, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.072566270828247
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.081427812576294
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 119112
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8318119049072266
Epoch: 1, Steps: 8 | Train Loss: 2.136 Vali Loss: 2.048 Vali Acc: 0.244 Test Loss: 2.048 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 1.025099515914917
Epoch: 2, Steps: 8 | Train Loss: 1.908 Vali Loss: 1.733 Vali Acc: 0.512 Test Loss: 1.733 Test Acc: 0.512
Validation loss decreased (-0.243730 --> -0.512483).  Saving model ...
Epoch: 3 cost time: 0.96905517578125
Epoch: 3, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.363 Vali Acc: 0.650 Test Loss: 1.363 Test Acc: 0.650
Validation loss decreased (-0.512483 --> -0.649986).  Saving model ...
Epoch: 4 cost time: 0.9096920490264893
Epoch: 4, Steps: 8 | Train Loss: 1.223 Vali Loss: 1.050 Vali Acc: 0.759 Test Loss: 1.050 Test Acc: 0.759
Validation loss decreased (-0.649986 --> -0.759364).  Saving model ...
Epoch: 5 cost time: 0.9652979373931885
Epoch: 5, Steps: 8 | Train Loss: 0.948 Vali Loss: 0.828 Vali Acc: 0.794 Test Loss: 0.828 Test Acc: 0.794
Validation loss decreased (-0.759364 --> -0.793742).  Saving model ...
Epoch: 6 cost time: 0.782381534576416
Epoch: 6, Steps: 8 | Train Loss: 0.774 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.793742 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.9278731346130371
Epoch: 7, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 8 cost time: 0.8202486038208008
Epoch: 8, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
Validation loss decreased (-0.803119 --> -0.821870).  Saving model ...
Epoch: 9 cost time: 1.2297651767730713
Epoch: 9, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 1.2324979305267334
Epoch: 10, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.4265153408050537
Epoch: 11, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.1480717658996582
Epoch: 12, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2086005210876465
Epoch: 13, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0211949348449707
Epoch: 14, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0219998359680176
Epoch: 15, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0169789791107178
Epoch: 16, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9813232421875
Epoch: 17, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.492 Vali Acc: 0.831 Test Loss: 0.492 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9954628944396973
Epoch: 18, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.479 Vali Acc: 0.834 Test Loss: 0.479 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.282228708267212
Epoch: 19, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 1.0419642925262451
Epoch: 20, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849996).  Saving model ...
Epoch: 21 cost time: 0.9780685901641846
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0244121551513672
Epoch: 22, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9697089195251465
Epoch: 23, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.110239028930664
Epoch: 24, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2257144451141357
Epoch: 25, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9819803237915039
Epoch: 26, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2451813220977783
Epoch: 27, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
Validation loss decreased (-0.849996 --> -0.853120).  Saving model ...
Epoch: 28 cost time: 1.1112396717071533
Epoch: 28, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 29 cost time: 1.0719058513641357
Epoch: 29, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0162112712860107
Epoch: 30, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2658476829528809
Epoch: 31, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1180384159088135
Epoch: 32, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.127687931060791
Epoch: 33, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.13765549659729
Epoch: 34, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2335970401763916
Epoch: 35, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.472 Vali Acc: 0.859 Test Loss: 0.472 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 36 cost time: 1.0544939041137695
Epoch: 36, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3005743026733398
Epoch: 37, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1440761089324951
Epoch: 38, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1655895709991455
Epoch: 39, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4444384574890137
Epoch: 40, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.866 Test Loss: 0.481 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 41 cost time: 1.1408207416534424
Epoch: 41, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874995).  Saving model ...
Epoch: 42 cost time: 1.0091123580932617
Epoch: 42, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.478 Vali Acc: 0.881 Test Loss: 0.478 Test Acc: 0.881
Validation loss decreased (-0.874995 --> -0.881245).  Saving model ...
Epoch: 43 cost time: 0.9747905731201172
Epoch: 43, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1129977703094482
Epoch: 44, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0257976055145264
Epoch: 45, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.869 Test Loss: 0.492 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3018896579742432
Epoch: 46, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.863 Test Loss: 0.502 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1905131340026855
Epoch: 47, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.498 Vali Acc: 0.863 Test Loss: 0.498 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.104543685913086
Epoch: 48, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.496 Vali Acc: 0.866 Test Loss: 0.496 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3080527782440186
Epoch: 49, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1501619815826416
Epoch: 50, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.493 Vali Acc: 0.866 Test Loss: 0.493 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0332210063934326
Epoch: 51, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.325788974761963
Epoch: 52, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.496 Vali Acc: 0.863 Test Loss: 0.496 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm128_nh16_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 115016
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6889474391937256
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 1.755 Vali Acc: 0.338 Test Loss: 1.755 Test Acc: 0.338
Validation loss decreased (inf --> -0.337482).  Saving model ...
Epoch: 2 cost time: 1.1090342998504639
Epoch: 2, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.051 Vali Acc: 0.741 Test Loss: 1.051 Test Acc: 0.741
Validation loss decreased (-0.337482 --> -0.740614).  Saving model ...
Epoch: 3 cost time: 1.173340082168579
Epoch: 3, Steps: 8 | Train Loss: 0.848 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (-0.740614 --> -0.818744).  Saving model ...
Epoch: 4 cost time: 1.188366413116455
Epoch: 4, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 1.2306897640228271
Epoch: 5, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0975723266601562
Epoch: 6, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
Validation loss decreased (-0.824995 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.4907574653625488
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.2937512397766113
Epoch: 8, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0263385772705078
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.404437780380249
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1196753978729248
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.641 Vali Acc: 0.847 Test Loss: 0.641 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2408299446105957
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.281224012374878
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.838 Test Loss: 0.705 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.284637689590454
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.731 Vali Acc: 0.838 Test Loss: 0.731 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.333770990371704
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.758 Vali Acc: 0.838 Test Loss: 0.758 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4349236488342285
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.762 Vali Acc: 0.841 Test Loss: 0.762 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0837385654449463
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.731 Vali Acc: 0.847 Test Loss: 0.731 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 170440
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.267115831375122
Epoch: 1, Steps: 8 | Train Loss: 2.235 Vali Loss: 2.039 Vali Acc: 0.156 Test Loss: 2.039 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 1.0766246318817139
Epoch: 2, Steps: 8 | Train Loss: 1.839 Vali Loss: 1.530 Vali Acc: 0.653 Test Loss: 1.530 Test Acc: 0.653
Validation loss decreased (-0.156230 --> -0.653110).  Saving model ...
Epoch: 3 cost time: 1.2767479419708252
Epoch: 3, Steps: 8 | Train Loss: 1.281 Vali Loss: 1.043 Vali Acc: 0.759 Test Loss: 1.043 Test Acc: 0.759
Validation loss decreased (-0.653110 --> -0.759365).  Saving model ...
Epoch: 4 cost time: 1.2459235191345215
Epoch: 4, Steps: 8 | Train Loss: 0.809 Vali Loss: 0.737 Vali Acc: 0.809 Test Loss: 0.737 Test Acc: 0.809
Validation loss decreased (-0.759365 --> -0.809368).  Saving model ...
Epoch: 5 cost time: 1.6478235721588135
Epoch: 5, Steps: 8 | Train Loss: 0.571 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 1.0861084461212158
Epoch: 6, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 1.410749912261963
Epoch: 7, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 1.1823601722717285
Epoch: 8, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.253483533859253
Epoch: 9, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3725619316101074
Epoch: 10, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2605335712432861
Epoch: 11, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9471249580383301
Epoch: 12, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.362349510192871
Epoch: 13, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.235912561416626
Epoch: 14, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2372651100158691
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.202559232711792
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.970257043838501
Epoch: 17, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 111048
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3462748527526855
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.975 Vali Acc: 0.188 Test Loss: 1.975 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 1.243652582168579
Epoch: 2, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.636 Vali Acc: 0.569 Test Loss: 1.636 Test Acc: 0.569
Validation loss decreased (-0.187480 --> -0.568734).  Saving model ...
Epoch: 3 cost time: 1.1645617485046387
Epoch: 3, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.251 Vali Acc: 0.700 Test Loss: 1.251 Test Acc: 0.700
Validation loss decreased (-0.568734 --> -0.699987).  Saving model ...
Epoch: 4 cost time: 1.0929722785949707
Epoch: 4, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.927 Vali Acc: 0.772 Test Loss: 0.927 Test Acc: 0.772
Validation loss decreased (-0.699987 --> -0.771866).  Saving model ...
Epoch: 5 cost time: 0.9763474464416504
Epoch: 5, Steps: 8 | Train Loss: 0.782 Vali Loss: 0.711 Vali Acc: 0.791 Test Loss: 0.711 Test Acc: 0.791
Validation loss decreased (-0.771866 --> -0.790618).  Saving model ...
Epoch: 6 cost time: 1.1602458953857422
Epoch: 6, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
Validation loss decreased (-0.790618 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 1.3825476169586182
Epoch: 7, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 1.1796624660491943
Epoch: 8, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0244181156158447
Epoch: 9, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9832329750061035
Epoch: 10, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 11 cost time: 1.2252793312072754
Epoch: 11, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 1.2657604217529297
Epoch: 12, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 1.0977137088775635
Epoch: 13, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0035154819488525
Epoch: 14, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0829689502716064
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2700965404510498
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3359296321868896
Epoch: 17, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1114239692687988
Epoch: 18, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.591 Vali Acc: 0.816 Test Loss: 0.591 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0300023555755615
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0725290775299072
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4496748447418213
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3449103832244873
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 91592
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4287447929382324
Epoch: 1, Steps: 8 | Train Loss: 2.241 Vali Loss: 2.063 Vali Acc: 0.231 Test Loss: 2.063 Test Acc: 0.231
Validation loss decreased (inf --> -0.231229).  Saving model ...
Epoch: 2 cost time: 1.2341887950897217
Epoch: 2, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.747 Vali Acc: 0.381 Test Loss: 1.747 Test Acc: 0.381
Validation loss decreased (-0.231229 --> -0.381233).  Saving model ...
Epoch: 3 cost time: 1.0220389366149902
Epoch: 3, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.366 Vali Acc: 0.678 Test Loss: 1.366 Test Acc: 0.678
Validation loss decreased (-0.381233 --> -0.678111).  Saving model ...
Epoch: 4 cost time: 1.0711338520050049
Epoch: 4, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.047 Vali Acc: 0.753 Test Loss: 1.047 Test Acc: 0.753
Validation loss decreased (-0.678111 --> -0.753115).  Saving model ...
Epoch: 5 cost time: 1.0707752704620361
Epoch: 5, Steps: 8 | Train Loss: 0.951 Vali Loss: 0.812 Vali Acc: 0.784 Test Loss: 0.812 Test Acc: 0.784
Validation loss decreased (-0.753115 --> -0.784367).  Saving model ...
Epoch: 6 cost time: 1.0388407707214355
Epoch: 6, Steps: 8 | Train Loss: 0.690 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.784367 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.178992748260498
Epoch: 7, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 0.955801248550415
Epoch: 8, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.9809377193450928
Epoch: 9, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.9838676452636719
Epoch: 10, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.9250209331512451
Epoch: 11, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.014129400253296
Epoch: 12, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2077066898345947
Epoch: 13, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0519776344299316
Epoch: 14, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5404114723205566
Epoch: 15, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 0.9628186225891113
Epoch: 16, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.926795244216919
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9468629360198975
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.056147575378418
Epoch: 19, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0356669425964355
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9811334609985352
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4433510303497314
Epoch: 22, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4452250003814697
Epoch: 23, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2931475639343262
Epoch: 24, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9967067241668701
Epoch: 25, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 81352
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4334475994110107
Epoch: 1, Steps: 8 | Train Loss: 2.208 Vali Loss: 2.058 Vali Acc: 0.175 Test Loss: 2.058 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 1.019174337387085
Epoch: 2, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.814 Vali Acc: 0.441 Test Loss: 1.814 Test Acc: 0.441
Validation loss decreased (-0.174979 --> -0.440607).  Saving model ...
Epoch: 3 cost time: 1.0385894775390625
Epoch: 3, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.502 Vali Acc: 0.616 Test Loss: 1.502 Test Acc: 0.616
Validation loss decreased (-0.440607 --> -0.615610).  Saving model ...
Epoch: 4 cost time: 0.9074196815490723
Epoch: 4, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.206 Vali Acc: 0.713 Test Loss: 1.206 Test Acc: 0.713
Validation loss decreased (-0.615610 --> -0.712488).  Saving model ...
Epoch: 5 cost time: 0.8781845569610596
Epoch: 5, Steps: 8 | Train Loss: 1.070 Vali Loss: 0.969 Vali Acc: 0.772 Test Loss: 0.969 Test Acc: 0.772
Validation loss decreased (-0.712488 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 1.0714762210845947
Epoch: 6, Steps: 8 | Train Loss: 0.890 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
Validation loss decreased (-0.771865 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.9092421531677246
Epoch: 7, Steps: 8 | Train Loss: 0.693 Vali Loss: 0.674 Vali Acc: 0.816 Test Loss: 0.674 Test Acc: 0.816
Validation loss decreased (-0.803117 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 1.1686654090881348
Epoch: 8, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.603 Vali Acc: 0.816 Test Loss: 0.603 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 1.1645708084106445
Epoch: 9, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 1.051650047302246
Epoch: 10, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.91141676902771
Epoch: 11, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 1.0853877067565918
Epoch: 12, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1894547939300537
Epoch: 13, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0606420040130615
Epoch: 14, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.021348476409912
Epoch: 15, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0878028869628906
Epoch: 16, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2913577556610107
Epoch: 17, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3000259399414062
Epoch: 18, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 1.0505239963531494
Epoch: 19, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9556667804718018
Epoch: 20, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.256899118423462
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0901780128479004
Epoch: 22, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0346219539642334
Epoch: 23, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9525973796844482
Epoch: 24, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5322976112365723
Epoch: 25, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2131550312042236
Epoch: 26, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0432472229003906
Epoch: 27, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.148909091949463
Epoch: 28, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 73160
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6474244594573975
Epoch: 1, Steps: 8 | Train Loss: 2.268 Vali Loss: 2.116 Vali Acc: 0.091 Test Loss: 2.116 Test Acc: 0.091
Validation loss decreased (inf --> -0.090604).  Saving model ...
Epoch: 2 cost time: 1.0983328819274902
Epoch: 2, Steps: 8 | Train Loss: 2.207 Vali Loss: 1.910 Vali Acc: 0.250 Test Loss: 1.910 Test Acc: 0.250
Validation loss decreased (-0.090604 --> -0.249981).  Saving model ...
Epoch: 3 cost time: 0.7877018451690674
Epoch: 3, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.639 Vali Acc: 0.512 Test Loss: 1.639 Test Acc: 0.512
Validation loss decreased (-0.249981 --> -0.512484).  Saving model ...
Epoch: 4 cost time: 0.8039751052856445
Epoch: 4, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.357 Vali Acc: 0.675 Test Loss: 1.357 Test Acc: 0.675
Validation loss decreased (-0.512484 --> -0.674986).  Saving model ...
Epoch: 5 cost time: 0.7798123359680176
Epoch: 5, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.112 Vali Acc: 0.747 Test Loss: 1.112 Test Acc: 0.747
Validation loss decreased (-0.674986 --> -0.746864).  Saving model ...
Epoch: 6 cost time: 1.003112554550171
Epoch: 6, Steps: 8 | Train Loss: 1.114 Vali Loss: 0.926 Vali Acc: 0.775 Test Loss: 0.926 Test Acc: 0.775
Validation loss decreased (-0.746864 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.0559427738189697
Epoch: 7, Steps: 8 | Train Loss: 0.909 Vali Loss: 0.798 Vali Acc: 0.784 Test Loss: 0.798 Test Acc: 0.784
Validation loss decreased (-0.774991 --> -0.784367).  Saving model ...
Epoch: 8 cost time: 1.1818785667419434
Epoch: 8, Steps: 8 | Train Loss: 0.739 Vali Loss: 0.707 Vali Acc: 0.797 Test Loss: 0.707 Test Acc: 0.797
Validation loss decreased (-0.784367 --> -0.796868).  Saving model ...
Epoch: 9 cost time: 1.0212361812591553
Epoch: 9, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (-0.796868 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 1.0850012302398682
Epoch: 10, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.8251066207885742
Epoch: 11, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 1.1606638431549072
Epoch: 12, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 13 cost time: 1.0203392505645752
Epoch: 13, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 1.0670921802520752
Epoch: 14, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0954012870788574
Epoch: 15, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 1.2455661296844482
Epoch: 16, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 1.1424810886383057
Epoch: 17, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 1.5272548198699951
Epoch: 18, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 1.029357671737671
Epoch: 19, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 1.3022069931030273
Epoch: 20, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0527758598327637
Epoch: 21, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0441486835479736
Epoch: 22, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0596427917480469
Epoch: 23, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8712003231048584
Epoch: 24, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2402198314666748
Epoch: 25, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.298793077468872
Epoch: 26, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3062744140625
Epoch: 27, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.459886074066162
Epoch: 28, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1815662384033203
Epoch: 29, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 67976
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9153192043304443
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.033 Vali Acc: 0.216 Test Loss: 2.033 Test Acc: 0.216
Validation loss decreased (inf --> -0.215605).  Saving model ...
Epoch: 2 cost time: 1.118288278579712
Epoch: 2, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.875 Vali Acc: 0.291 Test Loss: 1.875 Test Acc: 0.291
Validation loss decreased (-0.215605 --> -0.290606).  Saving model ...
Epoch: 3 cost time: 1.035191297531128
Epoch: 3, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.649 Vali Acc: 0.487 Test Loss: 1.649 Test Acc: 0.487
Validation loss decreased (-0.290606 --> -0.487484).  Saving model ...
Epoch: 4 cost time: 0.8612227439880371
Epoch: 4, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.409 Vali Acc: 0.647 Test Loss: 1.409 Test Acc: 0.647
Validation loss decreased (-0.487484 --> -0.646861).  Saving model ...
Epoch: 5 cost time: 0.9877848625183105
Epoch: 5, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.194 Vali Acc: 0.734 Test Loss: 1.194 Test Acc: 0.734
Validation loss decreased (-0.646861 --> -0.734363).  Saving model ...
Epoch: 6 cost time: 1.0528242588043213
Epoch: 6, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.017 Vali Acc: 0.775 Test Loss: 1.017 Test Acc: 0.775
Validation loss decreased (-0.734363 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 1.012087345123291
Epoch: 7, Steps: 8 | Train Loss: 0.971 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 1.1148078441619873
Epoch: 8, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 0.930234432220459
Epoch: 9, Steps: 8 | Train Loss: 0.684 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.806243).  Saving model ...
Epoch: 10 cost time: 0.9813733100891113
Epoch: 10, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.648 Vali Acc: 0.809 Test Loss: 0.648 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 11 cost time: 1.0241591930389404
Epoch: 11, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 12 cost time: 1.121985673904419
Epoch: 12, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 1.1229302883148193
Epoch: 13, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 0.9291102886199951
Epoch: 14, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 1.2485647201538086
Epoch: 15, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1508209705352783
Epoch: 16, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 0.931725025177002
Epoch: 17, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 1.0513558387756348
Epoch: 18, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 1.0163002014160156
Epoch: 19, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 1.000964879989624
Epoch: 20, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0630908012390137
Epoch: 21, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.068312644958496
Epoch: 22, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0708591938018799
Epoch: 23, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1091220378875732
Epoch: 24, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9233460426330566
Epoch: 25, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.065422534942627
Epoch: 26, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.480 Vali Acc: 0.834 Test Loss: 0.480 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.059236764907837
Epoch: 27, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.480 Vali Acc: 0.834 Test Loss: 0.480 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2177681922912598
Epoch: 28, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3113760948181152
Epoch: 29, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 65928
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4900388717651367
Epoch: 1, Steps: 8 | Train Loss: 2.059 Vali Loss: 1.763 Vali Acc: 0.456 Test Loss: 1.763 Test Acc: 0.456
Validation loss decreased (inf --> -0.456232).  Saving model ...
Epoch: 2 cost time: 1.101771593093872
Epoch: 2, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.045 Vali Acc: 0.759 Test Loss: 1.045 Test Acc: 0.759
Validation loss decreased (-0.456232 --> -0.759365).  Saving model ...
Epoch: 3 cost time: 1.149944543838501
Epoch: 3, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.658 Vali Acc: 0.791 Test Loss: 0.658 Test Acc: 0.791
Validation loss decreased (-0.759365 --> -0.790618).  Saving model ...
Epoch: 4 cost time: 1.4577953815460205
Epoch: 4, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
Validation loss decreased (-0.790618 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 1.1992509365081787
Epoch: 5, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.490 Vali Acc: 0.834 Test Loss: 0.490 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.3822176456451416
Epoch: 6, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4403142929077148
Epoch: 7, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840619).  Saving model ...
Epoch: 8 cost time: 1.0773048400878906
Epoch: 8, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3516473770141602
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2310681343078613
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2081401348114014
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.674 Vali Acc: 0.816 Test Loss: 0.674 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2532289028167725
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.677 Vali Acc: 0.831 Test Loss: 0.677 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4662094116210938
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.696 Vali Acc: 0.841 Test Loss: 0.696 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2285959720611572
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.714 Vali Acc: 0.838 Test Loss: 0.714 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2314550876617432
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.765 Vali Acc: 0.825 Test Loss: 0.765 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3578779697418213
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3018600940704346
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.831 Test Loss: 0.774 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 153928
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.507249116897583
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 1.942 Vali Acc: 0.259 Test Loss: 1.942 Test Acc: 0.259
Validation loss decreased (inf --> -0.259356).  Saving model ...
Epoch: 2 cost time: 1.3450210094451904
Epoch: 2, Steps: 8 | Train Loss: 1.733 Vali Loss: 1.471 Vali Acc: 0.675 Test Loss: 1.471 Test Acc: 0.675
Validation loss decreased (-0.259356 --> -0.674985).  Saving model ...
Epoch: 3 cost time: 0.9990408420562744
Epoch: 3, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.015 Vali Acc: 0.753 Test Loss: 1.015 Test Acc: 0.753
Validation loss decreased (-0.674985 --> -0.753115).  Saving model ...
Epoch: 4 cost time: 0.9809651374816895
Epoch: 4, Steps: 8 | Train Loss: 0.871 Vali Loss: 0.714 Vali Acc: 0.809 Test Loss: 0.714 Test Acc: 0.809
Validation loss decreased (-0.753115 --> -0.809368).  Saving model ...
Epoch: 5 cost time: 1.3749847412109375
Epoch: 5, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809369).  Saving model ...
Epoch: 6 cost time: 1.3875701427459717
Epoch: 6, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821870).  Saving model ...
Epoch: 7 cost time: 1.2076640129089355
Epoch: 7, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 8 cost time: 1.126889705657959
Epoch: 8, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 1.1252951622009277
Epoch: 9, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2953155040740967
Epoch: 10, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.1722691059112549
Epoch: 11, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2839455604553223
Epoch: 12, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1321678161621094
Epoch: 13, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.605 Vali Acc: 0.834 Test Loss: 0.605 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.088233470916748
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.606 Vali Acc: 0.831 Test Loss: 0.606 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2275166511535645
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.594 Vali Acc: 0.828 Test Loss: 0.594 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5007519721984863
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5045280456542969
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.649 Vali Acc: 0.834 Test Loss: 0.649 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3198673725128174
Epoch: 18, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.666 Vali Acc: 0.834 Test Loss: 0.666 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4964306354522705
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.679 Vali Acc: 0.834 Test Loss: 0.679 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3836829662322998
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.706 Vali Acc: 0.838 Test Loss: 0.706 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 94536
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.965573787689209
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.067 Vali Acc: 0.141 Test Loss: 2.067 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 1.2772059440612793
Epoch: 2, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.722 Vali Acc: 0.472 Test Loss: 1.722 Test Acc: 0.472
Validation loss decreased (-0.140604 --> -0.471858).  Saving model ...
Epoch: 3 cost time: 0.9940221309661865
Epoch: 3, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.333 Vali Acc: 0.684 Test Loss: 1.333 Test Acc: 0.684
Validation loss decreased (-0.471858 --> -0.684362).  Saving model ...
Epoch: 4 cost time: 0.929410457611084
Epoch: 4, Steps: 8 | Train Loss: 1.144 Vali Loss: 0.990 Vali Acc: 0.772 Test Loss: 0.990 Test Acc: 0.772
Validation loss decreased (-0.684362 --> -0.771865).  Saving model ...
Epoch: 5 cost time: 1.03989839553833
Epoch: 5, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.757 Vali Acc: 0.816 Test Loss: 0.757 Test Acc: 0.816
Validation loss decreased (-0.771865 --> -0.815617).  Saving model ...
Epoch: 6 cost time: 1.165149211883545
Epoch: 6, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 0.9802629947662354
Epoch: 7, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 1.0613019466400146
Epoch: 8, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9799461364746094
Epoch: 9, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1012070178985596
Epoch: 10, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 1.247185230255127
Epoch: 11, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.056699514389038
Epoch: 12, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0186834335327148
Epoch: 13, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2391908168792725
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.143524169921875
Epoch: 15, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9558262825012207
Epoch: 16, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0529704093933105
Epoch: 17, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2360045909881592
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 19 cost time: 1.0109953880310059
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 0.9963724613189697
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.586 Vali Acc: 0.825 Test Loss: 0.586 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.200268268585205
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.027637004852295
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.621 Vali Acc: 0.828 Test Loss: 0.621 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3048670291900635
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.607 Vali Acc: 0.834 Test Loss: 0.607 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0249879360198975
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.006408929824829
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.609 Vali Acc: 0.838 Test Loss: 0.609 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1435320377349854
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8818764686584473
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.633 Vali Acc: 0.825 Test Loss: 0.633 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.135793924331665
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.831 Test Loss: 0.637 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1829288005828857
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.638 Vali Acc: 0.828 Test Loss: 0.638 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 75080
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7044878005981445
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.024 Vali Acc: 0.166 Test Loss: 2.024 Test Acc: 0.166
Validation loss decreased (inf --> -0.165605).  Saving model ...
Epoch: 2 cost time: 1.2723679542541504
Epoch: 2, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.727 Vali Acc: 0.450 Test Loss: 1.727 Test Acc: 0.450
Validation loss decreased (-0.165605 --> -0.449983).  Saving model ...
Epoch: 3 cost time: 1.0116469860076904
Epoch: 3, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.365 Vali Acc: 0.681 Test Loss: 1.365 Test Acc: 0.681
Validation loss decreased (-0.449983 --> -0.681236).  Saving model ...
Epoch: 4 cost time: 1.011009693145752
Epoch: 4, Steps: 8 | Train Loss: 1.220 Vali Loss: 1.042 Vali Acc: 0.744 Test Loss: 1.042 Test Acc: 0.744
Validation loss decreased (-0.681236 --> -0.743740).  Saving model ...
Epoch: 5 cost time: 0.9244213104248047
Epoch: 5, Steps: 8 | Train Loss: 0.902 Vali Loss: 0.812 Vali Acc: 0.778 Test Loss: 0.812 Test Acc: 0.778
Validation loss decreased (-0.743740 --> -0.778117).  Saving model ...
Epoch: 6 cost time: 0.983649730682373
Epoch: 6, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
Validation loss decreased (-0.778117 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.0562987327575684
Epoch: 7, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 0.8926959037780762
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.550 Vali Acc: 0.806 Test Loss: 0.550 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9752838611602783
Epoch: 9, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.011587142944336
Epoch: 10, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.8223483562469482
Epoch: 11, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.112978458404541
Epoch: 12, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3136205673217773
Epoch: 13, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 1.2126052379608154
Epoch: 14, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0816550254821777
Epoch: 15, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0619232654571533
Epoch: 16, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0853092670440674
Epoch: 17, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1075425148010254
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1716423034667969
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5420668125152588
Epoch: 20, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0459766387939453
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.380420207977295
Epoch: 22, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9540455341339111
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 64840
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7015128135681152
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.042 Vali Acc: 0.188 Test Loss: 2.042 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 1.0648021697998047
Epoch: 2, Steps: 8 | Train Loss: 1.864 Vali Loss: 1.760 Vali Acc: 0.394 Test Loss: 1.760 Test Acc: 0.394
Validation loss decreased (-0.187480 --> -0.393732).  Saving model ...
Epoch: 3 cost time: 1.2170286178588867
Epoch: 3, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.435 Vali Acc: 0.675 Test Loss: 1.435 Test Acc: 0.675
Validation loss decreased (-0.393732 --> -0.674986).  Saving model ...
Epoch: 4 cost time: 1.0509226322174072
Epoch: 4, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.136 Vali Acc: 0.753 Test Loss: 1.136 Test Acc: 0.753
Validation loss decreased (-0.674986 --> -0.753114).  Saving model ...
Epoch: 5 cost time: 0.9377365112304688
Epoch: 5, Steps: 8 | Train Loss: 1.057 Vali Loss: 0.911 Vali Acc: 0.787 Test Loss: 0.911 Test Acc: 0.787
Validation loss decreased (-0.753114 --> -0.787491).  Saving model ...
Epoch: 6 cost time: 0.911238431930542
Epoch: 6, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.761 Vali Acc: 0.797 Test Loss: 0.761 Test Acc: 0.797
Validation loss decreased (-0.787491 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 1.1393122673034668
Epoch: 7, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
Validation loss decreased (-0.796867 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 1.263810634613037
Epoch: 8, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.576 Vali Acc: 0.806 Test Loss: 0.576 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.9898073673248291
Epoch: 9, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818745).  Saving model ...
Epoch: 10 cost time: 1.3607420921325684
Epoch: 10, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 1.2791059017181396
Epoch: 11, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.112989902496338
Epoch: 12, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 13 cost time: 1.0374972820281982
Epoch: 13, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 1.2408795356750488
Epoch: 14, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0786173343658447
Epoch: 15, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1232354640960693
Epoch: 16, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0207867622375488
Epoch: 17, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8343174457550049
Epoch: 18, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 0.9996209144592285
Epoch: 19, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 1.1258904933929443
Epoch: 20, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9688510894775391
Epoch: 21, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3247747421264648
Epoch: 22, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0852112770080566
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.066176414489746
Epoch: 24, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1683201789855957
Epoch: 25, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9982578754425049
Epoch: 26, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.937006950378418
Epoch: 27, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3126904964447021
Epoch: 28, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 29 cost time: 1.1165342330932617
Epoch: 29, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3578686714172363
Epoch: 30, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5113139152526855
Epoch: 31, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.584 Vali Acc: 0.847 Test Loss: 0.584 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9487559795379639
Epoch: 32, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0767066478729248
Epoch: 33, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2084338665008545
Epoch: 34, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.585 Vali Acc: 0.847 Test Loss: 0.585 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0673160552978516
Epoch: 35, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.831 Test Loss: 0.596 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.22432279586792
Epoch: 36, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.838 Test Loss: 0.602 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0853607654571533
Epoch: 37, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.248399257659912
Epoch: 38, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 56648
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.285538196563721
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.081 Vali Acc: 0.178 Test Loss: 2.081 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 0.9759964942932129
Epoch: 2, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.883 Vali Acc: 0.294 Test Loss: 1.883 Test Acc: 0.294
Validation loss decreased (-0.178104 --> -0.293731).  Saving model ...
Epoch: 3 cost time: 1.066601037979126
Epoch: 3, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.619 Vali Acc: 0.503 Test Loss: 1.619 Test Acc: 0.503
Validation loss decreased (-0.293731 --> -0.503109).  Saving model ...
Epoch: 4 cost time: 0.9912879467010498
Epoch: 4, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.350 Vali Acc: 0.656 Test Loss: 1.350 Test Acc: 0.656
Validation loss decreased (-0.503109 --> -0.656236).  Saving model ...
Epoch: 5 cost time: 1.368680715560913
Epoch: 5, Steps: 8 | Train Loss: 1.275 Vali Loss: 1.122 Vali Acc: 0.716 Test Loss: 1.122 Test Acc: 0.716
Validation loss decreased (-0.656236 --> -0.715614).  Saving model ...
Epoch: 6 cost time: 1.2910263538360596
Epoch: 6, Steps: 8 | Train Loss: 1.082 Vali Loss: 0.940 Vali Acc: 0.741 Test Loss: 0.940 Test Acc: 0.741
Validation loss decreased (-0.715614 --> -0.740616).  Saving model ...
Epoch: 7 cost time: 1.377535343170166
Epoch: 7, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
Validation loss decreased (-0.740616 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 1.427234172821045
Epoch: 8, Steps: 8 | Train Loss: 0.681 Vali Loss: 0.721 Vali Acc: 0.784 Test Loss: 0.721 Test Acc: 0.784
Validation loss decreased (-0.774992 --> -0.784368).  Saving model ...
Epoch: 9 cost time: 1.0256352424621582
Epoch: 9, Steps: 8 | Train Loss: 0.613 Vali Loss: 0.658 Vali Acc: 0.784 Test Loss: 0.658 Test Acc: 0.784
Validation loss decreased (-0.784368 --> -0.784368).  Saving model ...
Epoch: 10 cost time: 0.936633825302124
Epoch: 10, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.610 Vali Acc: 0.794 Test Loss: 0.610 Test Acc: 0.794
Validation loss decreased (-0.784368 --> -0.793744).  Saving model ...
Epoch: 11 cost time: 1.0706326961517334
Epoch: 11, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.590 Vali Acc: 0.797 Test Loss: 0.590 Test Acc: 0.797
Validation loss decreased (-0.793744 --> -0.796869).  Saving model ...
Epoch: 12 cost time: 0.9606754779815674
Epoch: 12, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.796869 --> -0.818744).  Saving model ...
Epoch: 13 cost time: 1.0009338855743408
Epoch: 13, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 14 cost time: 0.9978363513946533
Epoch: 14, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 1.2316060066223145
Epoch: 15, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9893264770507812
Epoch: 16, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.169996738433838
Epoch: 17, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 18 cost time: 1.2993009090423584
Epoch: 18, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 19 cost time: 0.9654555320739746
Epoch: 19, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 1.1084749698638916
Epoch: 20, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.936737060546875
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9583730697631836
Epoch: 22, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 23 cost time: 1.1567738056182861
Epoch: 23, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.101078748703003
Epoch: 24, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4141383171081543
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3312594890594482
Epoch: 26, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 27 cost time: 1.0881962776184082
Epoch: 27, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 28 cost time: 1.1056573390960693
Epoch: 28, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 29 cost time: 0.9191896915435791
Epoch: 29, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0798640251159668
Epoch: 30, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1910285949707031
Epoch: 31, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4158413410186768
Epoch: 32, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1278703212738037
Epoch: 33, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8861756324768066
Epoch: 34, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1189711093902588
Epoch: 35, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.476926326751709
Epoch: 36, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2302415370941162
Epoch: 37, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0320367813110352
Epoch: 38, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 51464
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.276268005371094
Epoch: 1, Steps: 8 | Train Loss: 2.250 Vali Loss: 2.126 Vali Acc: 0.100 Test Loss: 2.126 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 1.555530309677124
Epoch: 2, Steps: 8 | Train Loss: 2.152 Vali Loss: 1.951 Vali Acc: 0.209 Test Loss: 1.951 Test Acc: 0.209
Validation loss decreased (-0.099979 --> -0.209355).  Saving model ...
Epoch: 3 cost time: 1.2893245220184326
Epoch: 3, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.713 Vali Acc: 0.453 Test Loss: 1.713 Test Acc: 0.453
Validation loss decreased (-0.209355 --> -0.453108).  Saving model ...
Epoch: 4 cost time: 1.336942434310913
Epoch: 4, Steps: 8 | Train Loss: 1.630 Vali Loss: 1.451 Vali Acc: 0.637 Test Loss: 1.451 Test Acc: 0.637
Validation loss decreased (-0.453108 --> -0.637485).  Saving model ...
Epoch: 5 cost time: 1.0398564338684082
Epoch: 5, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.212 Vali Acc: 0.734 Test Loss: 1.212 Test Acc: 0.734
Validation loss decreased (-0.637485 --> -0.734363).  Saving model ...
Epoch: 6 cost time: 1.1785855293273926
Epoch: 6, Steps: 8 | Train Loss: 1.121 Vali Loss: 1.018 Vali Acc: 0.784 Test Loss: 1.018 Test Acc: 0.784
Validation loss decreased (-0.734363 --> -0.784365).  Saving model ...
Epoch: 7 cost time: 1.0337135791778564
Epoch: 7, Steps: 8 | Train Loss: 0.950 Vali Loss: 0.872 Vali Acc: 0.784 Test Loss: 0.872 Test Acc: 0.784
Validation loss decreased (-0.784365 --> -0.784366).  Saving model ...
Epoch: 8 cost time: 1.3274903297424316
Epoch: 8, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.780 Vali Acc: 0.791 Test Loss: 0.780 Test Acc: 0.791
Validation loss decreased (-0.784366 --> -0.790617).  Saving model ...
Epoch: 9 cost time: 1.2314953804016113
Epoch: 9, Steps: 8 | Train Loss: 0.730 Vali Loss: 0.702 Vali Acc: 0.791 Test Loss: 0.702 Test Acc: 0.791
Validation loss decreased (-0.790617 --> -0.790618).  Saving model ...
Epoch: 10 cost time: 1.2571680545806885
Epoch: 10, Steps: 8 | Train Loss: 0.575 Vali Loss: 0.645 Vali Acc: 0.794 Test Loss: 0.645 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793744).  Saving model ...
Epoch: 11 cost time: 1.2347218990325928
Epoch: 11, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.610 Vali Acc: 0.791 Test Loss: 0.610 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1202645301818848
Epoch: 12, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.582 Vali Acc: 0.800 Test Loss: 0.582 Test Acc: 0.800
Validation loss decreased (-0.793744 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 1.0953998565673828
Epoch: 13, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 1.2516515254974365
Epoch: 14, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 15 cost time: 0.9347774982452393
Epoch: 15, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 16 cost time: 1.222656488418579
Epoch: 16, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818745).  Saving model ...
Epoch: 17 cost time: 1.584778070449829
Epoch: 17, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 18 cost time: 0.9219908714294434
Epoch: 18, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 19 cost time: 1.1207637786865234
Epoch: 19, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 1.2303829193115234
Epoch: 20, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 21 cost time: 1.3543086051940918
Epoch: 21, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.275094985961914
Epoch: 22, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 0.9845788478851318
Epoch: 23, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1141762733459473
Epoch: 24, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0208733081817627
Epoch: 25, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8136889934539795
Epoch: 26, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1038408279418945
Epoch: 27, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 28 cost time: 1.1598689556121826
Epoch: 28, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.986626386642456
Epoch: 29, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.264657735824585
Epoch: 30, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4141335487365723
Epoch: 31, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2415251731872559
Epoch: 32, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1950440406799316
Epoch: 33, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 34 cost time: 1.4246809482574463
Epoch: 34, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2247116565704346
Epoch: 35, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1059503555297852
Epoch: 36, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 37 cost time: 1.2603602409362793
Epoch: 37, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 1.18015456199646
Epoch: 38, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1776344776153564
Epoch: 39, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1111373901367188
Epoch: 40, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9557430744171143
Epoch: 41, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1390419006347656
Epoch: 42, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1649081707000732
Epoch: 43, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 44 cost time: 1.0585899353027344
Epoch: 44, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 45 cost time: 1.013096809387207
Epoch: 45, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.268052577972412
Epoch: 46, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3441405296325684
Epoch: 47, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2211203575134277
Epoch: 48, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1252129077911377
Epoch: 49, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.524 Vali Acc: 0.847 Test Loss: 0.524 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1573235988616943
Epoch: 50, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9933614730834961
Epoch: 51, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.088186264038086
Epoch: 52, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.253587245941162
Epoch: 53, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.1662187576293945
Epoch: 54, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 55 cost time: 1.1436448097229004
Epoch: 55, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.528 Vali Acc: 0.853 Test Loss: 0.528 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.5547120571136475
Epoch: 56, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1656162738800049
Epoch: 57, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.113610029220581
Epoch: 58, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.0454182624816895
Epoch: 59, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1418545246124268
Epoch: 60, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 61 cost time: 1.2110824584960938
Epoch: 61, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1470856666564941
Epoch: 62, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9950847625732422
Epoch: 63, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.065814733505249
Epoch: 64, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.0475027561187744
Epoch: 65, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 66 cost time: 1.2132315635681152
Epoch: 66, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0162818431854248
Epoch: 67, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1680612564086914
Epoch: 68, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.859 Test Loss: 0.537 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.339538335800171
Epoch: 69, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.2155725955963135
Epoch: 70, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.1621618270874023
Epoch: 71, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.548 Vali Acc: 0.853 Test Loss: 0.548 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.2820720672607422
Epoch: 72, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.0154123306274414
Epoch: 73, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.0941965579986572
Epoch: 74, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.853 Test Loss: 0.552 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.254723072052002
Epoch: 75, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 49416
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5798897743225098
Epoch: 1, Steps: 8 | Train Loss: 2.123 Vali Loss: 1.808 Vali Acc: 0.425 Test Loss: 1.808 Test Acc: 0.425
Validation loss decreased (inf --> -0.424982).  Saving model ...
Epoch: 2 cost time: 1.4089500904083252
Epoch: 2, Steps: 8 | Train Loss: 1.435 Vali Loss: 1.084 Vali Acc: 0.781 Test Loss: 1.084 Test Acc: 0.781
Validation loss decreased (-0.424982 --> -0.781239).  Saving model ...
Epoch: 3 cost time: 1.1121013164520264
Epoch: 3, Steps: 8 | Train Loss: 0.849 Vali Loss: 0.668 Vali Acc: 0.806 Test Loss: 0.668 Test Acc: 0.806
Validation loss decreased (-0.781239 --> -0.806243).  Saving model ...
Epoch: 4 cost time: 1.3471736907958984
Epoch: 4, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
Validation loss decreased (-0.806243 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.3932201862335205
Epoch: 5, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.560 Vali Acc: 0.797 Test Loss: 0.560 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3215610980987549
Epoch: 6, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6165940761566162
Epoch: 7, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2556159496307373
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0901010036468506
Epoch: 9, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.590 Vali Acc: 0.828 Test Loss: 0.590 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2670791149139404
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.637 Vali Acc: 0.831 Test Loss: 0.637 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5942656993865967
Epoch: 11, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.276606559753418
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 1.203606367111206
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.704 Vali Acc: 0.834 Test Loss: 0.704 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3234543800354004
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.743 Vali Acc: 0.838 Test Loss: 0.743 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.295729398727417
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.756 Vali Acc: 0.838 Test Loss: 0.756 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0472683906555176
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.840 Vali Acc: 0.828 Test Loss: 0.840 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3525524139404297
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.808 Vali Acc: 0.825 Test Loss: 0.808 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.363222360610962
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.828 Test Loss: 0.781 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2195320129394531
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.809 Vali Acc: 0.834 Test Loss: 0.809 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1738884449005127
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.829 Vali Acc: 0.831 Test Loss: 0.829 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1533069610595703
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.828 Test Loss: 0.834 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3547861576080322
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.831 Test Loss: 0.842 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 145672
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.158928394317627
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 1.896 Vali Acc: 0.269 Test Loss: 1.896 Test Acc: 0.269
Validation loss decreased (inf --> -0.268731).  Saving model ...
Epoch: 2 cost time: 1.2152540683746338
Epoch: 2, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.390 Vali Acc: 0.688 Test Loss: 1.390 Test Acc: 0.688
Validation loss decreased (-0.268731 --> -0.687486).  Saving model ...
Epoch: 3 cost time: 0.9794390201568604
Epoch: 3, Steps: 8 | Train Loss: 1.222 Vali Loss: 0.948 Vali Acc: 0.772 Test Loss: 0.948 Test Acc: 0.772
Validation loss decreased (-0.687486 --> -0.771866).  Saving model ...
Epoch: 4 cost time: 1.0649785995483398
Epoch: 4, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.674 Vali Acc: 0.812 Test Loss: 0.674 Test Acc: 0.812
Validation loss decreased (-0.771866 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 1.081885576248169
Epoch: 5, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.3406000137329102
Epoch: 6, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 1.2551910877227783
Epoch: 7, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.0244626998901367
Epoch: 8, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2617745399475098
Epoch: 9, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1746950149536133
Epoch: 10, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0594933032989502
Epoch: 11, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.107607126235962
Epoch: 12, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.570 Vali Acc: 0.831 Test Loss: 0.570 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3080973625183105
Epoch: 13, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0211009979248047
Epoch: 14, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1759874820709229
Epoch: 15, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0577113628387451
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.643 Vali Acc: 0.831 Test Loss: 0.643 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9065876007080078
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.638 Vali Acc: 0.831 Test Loss: 0.638 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 86280
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7971079349517822
Epoch: 1, Steps: 8 | Train Loss: 2.072 Vali Loss: 1.933 Vali Acc: 0.253 Test Loss: 1.933 Test Acc: 0.253
Validation loss decreased (inf --> -0.253106).  Saving model ...
Epoch: 2 cost time: 1.0308833122253418
Epoch: 2, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.613 Vali Acc: 0.531 Test Loss: 1.613 Test Acc: 0.531
Validation loss decreased (-0.253106 --> -0.531234).  Saving model ...
Epoch: 3 cost time: 0.9092986583709717
Epoch: 3, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.237 Vali Acc: 0.694 Test Loss: 1.237 Test Acc: 0.694
Validation loss decreased (-0.531234 --> -0.693738).  Saving model ...
Epoch: 4 cost time: 0.9437711238861084
Epoch: 4, Steps: 8 | Train Loss: 1.093 Vali Loss: 0.921 Vali Acc: 0.762 Test Loss: 0.921 Test Acc: 0.762
Validation loss decreased (-0.693738 --> -0.762491).  Saving model ...
Epoch: 5 cost time: 0.8155372142791748
Epoch: 5, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.711 Vali Acc: 0.806 Test Loss: 0.711 Test Acc: 0.806
Validation loss decreased (-0.762491 --> -0.806243).  Saving model ...
Epoch: 6 cost time: 0.9927182197570801
Epoch: 6, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 1.2560114860534668
Epoch: 7, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.8934435844421387
Epoch: 8, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9724609851837158
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1425554752349854
Epoch: 10, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.496 Vali Acc: 0.828 Test Loss: 0.496 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2682609558105469
Epoch: 11, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.494 Vali Acc: 0.825 Test Loss: 0.494 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3109073638916016
Epoch: 12, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0135607719421387
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1275439262390137
Epoch: 14, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3529410362243652
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2054431438446045
Epoch: 16, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9657795429229736
Epoch: 17, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 66824
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.524730682373047
Epoch: 1, Steps: 8 | Train Loss: 2.255 Vali Loss: 2.080 Vali Acc: 0.203 Test Loss: 2.080 Test Acc: 0.203
Validation loss decreased (inf --> -0.203104).  Saving model ...
Epoch: 2 cost time: 1.1128454208374023
Epoch: 2, Steps: 8 | Train Loss: 1.977 Vali Loss: 1.764 Vali Acc: 0.372 Test Loss: 1.764 Test Acc: 0.372
Validation loss decreased (-0.203104 --> -0.371857).  Saving model ...
Epoch: 3 cost time: 1.1726443767547607
Epoch: 3, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.378 Vali Acc: 0.666 Test Loss: 1.378 Test Acc: 0.666
Validation loss decreased (-0.371857 --> -0.665611).  Saving model ...
Epoch: 4 cost time: 1.206883192062378
Epoch: 4, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.049 Vali Acc: 0.753 Test Loss: 1.049 Test Acc: 0.753
Validation loss decreased (-0.665611 --> -0.753115).  Saving model ...
Epoch: 5 cost time: 0.8607332706451416
Epoch: 5, Steps: 8 | Train Loss: 0.956 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
Validation loss decreased (-0.753115 --> -0.771867).  Saving model ...
Epoch: 6 cost time: 1.1093575954437256
Epoch: 6, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
Validation loss decreased (-0.771867 --> -0.793743).  Saving model ...
Epoch: 7 cost time: 0.9254066944122314
Epoch: 7, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 1.173631191253662
Epoch: 8, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9343090057373047
Epoch: 9, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812495).  Saving model ...
Epoch: 10 cost time: 1.049260139465332
Epoch: 10, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
Validation loss decreased (-0.812495 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 1.14571213722229
Epoch: 11, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.0936574935913086
Epoch: 12, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 0.971031904220581
Epoch: 13, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9281814098358154
Epoch: 14, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2251479625701904
Epoch: 15, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0780973434448242
Epoch: 16, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.043428897857666
Epoch: 17, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.077179193496704
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1805121898651123
Epoch: 19, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8788433074951172
Epoch: 20, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.234201431274414
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1129438877105713
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 56584
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.246436834335327
Epoch: 1, Steps: 8 | Train Loss: 2.289 Vali Loss: 2.103 Vali Acc: 0.225 Test Loss: 2.103 Test Acc: 0.225
Validation loss decreased (inf --> -0.224979).  Saving model ...
Epoch: 2 cost time: 1.0719070434570312
Epoch: 2, Steps: 8 | Train Loss: 2.099 Vali Loss: 1.868 Vali Acc: 0.347 Test Loss: 1.868 Test Acc: 0.347
Validation loss decreased (-0.224979 --> -0.346856).  Saving model ...
Epoch: 3 cost time: 0.9579811096191406
Epoch: 3, Steps: 8 | Train Loss: 1.759 Vali Loss: 1.548 Vali Acc: 0.531 Test Loss: 1.548 Test Acc: 0.531
Validation loss decreased (-0.346856 --> -0.531235).  Saving model ...
Epoch: 4 cost time: 1.006450891494751
Epoch: 4, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.239 Vali Acc: 0.684 Test Loss: 1.239 Test Acc: 0.684
Validation loss decreased (-0.531235 --> -0.684363).  Saving model ...
Epoch: 5 cost time: 0.9196553230285645
Epoch: 5, Steps: 8 | Train Loss: 1.157 Vali Loss: 0.983 Vali Acc: 0.759 Test Loss: 0.983 Test Acc: 0.759
Validation loss decreased (-0.684363 --> -0.759365).  Saving model ...
Epoch: 6 cost time: 1.5019991397857666
Epoch: 6, Steps: 8 | Train Loss: 0.912 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.759365 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.9339325428009033
Epoch: 7, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
Validation loss decreased (-0.799992 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 0.9509415626525879
Epoch: 8, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
Validation loss decreased (-0.818743 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.9652736186981201
Epoch: 9, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.9318559169769287
Epoch: 10, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 1.0576701164245605
Epoch: 11, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.1089143753051758
Epoch: 12, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1184895038604736
Epoch: 13, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0807764530181885
Epoch: 14, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.0380029678344727
Epoch: 15, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2297229766845703
Epoch: 16, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0610055923461914
Epoch: 17, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.020148515701294
Epoch: 18, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.000375509262085
Epoch: 19, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.071296215057373
Epoch: 20, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1738364696502686
Epoch: 21, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2066166400909424
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3770232200622559
Epoch: 23, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9827215671539307
Epoch: 24, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 48392
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1580381393432617
Epoch: 1, Steps: 8 | Train Loss: 2.153 Vali Loss: 1.921 Vali Acc: 0.281 Test Loss: 1.921 Test Acc: 0.281
Validation loss decreased (inf --> -0.281231).  Saving model ...
Epoch: 2 cost time: 1.2170703411102295
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.747 Vali Acc: 0.391 Test Loss: 1.747 Test Acc: 0.391
Validation loss decreased (-0.281231 --> -0.390608).  Saving model ...
Epoch: 3 cost time: 0.8930864334106445
Epoch: 3, Steps: 8 | Train Loss: 1.840 Vali Loss: 1.517 Vali Acc: 0.553 Test Loss: 1.517 Test Acc: 0.553
Validation loss decreased (-0.390608 --> -0.553110).  Saving model ...
Epoch: 4 cost time: 1.0592854022979736
Epoch: 4, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.285 Vali Acc: 0.644 Test Loss: 1.285 Test Acc: 0.644
Validation loss decreased (-0.553110 --> -0.643737).  Saving model ...
Epoch: 5 cost time: 1.1510403156280518
Epoch: 5, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.075 Vali Acc: 0.731 Test Loss: 1.075 Test Acc: 0.731
Validation loss decreased (-0.643737 --> -0.731239).  Saving model ...
Epoch: 6 cost time: 1.3865110874176025
Epoch: 6, Steps: 8 | Train Loss: 1.050 Vali Loss: 0.913 Vali Acc: 0.756 Test Loss: 0.913 Test Acc: 0.756
Validation loss decreased (-0.731239 --> -0.756241).  Saving model ...
Epoch: 7 cost time: 0.9308726787567139
Epoch: 7, Steps: 8 | Train Loss: 0.841 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
Validation loss decreased (-0.756241 --> -0.778117).  Saving model ...
Epoch: 8 cost time: 1.0274467468261719
Epoch: 8, Steps: 8 | Train Loss: 0.711 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.778117 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.9479427337646484
Epoch: 9, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 10 cost time: 0.9018864631652832
Epoch: 10, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1551384925842285
Epoch: 11, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
Validation loss decreased (-0.803119 --> -0.815619).  Saving model ...
Epoch: 12 cost time: 1.2145836353302002
Epoch: 12, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815620).  Saving model ...
Epoch: 13 cost time: 1.061598777770996
Epoch: 13, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
Validation loss decreased (-0.815620 --> -0.824995).  Saving model ...
Epoch: 14 cost time: 0.9538567066192627
Epoch: 14, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 0.8658604621887207
Epoch: 15, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.514 Vali Acc: 0.831 Test Loss: 0.514 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 16 cost time: 0.9294333457946777
Epoch: 16, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9502379894256592
Epoch: 17, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0386502742767334
Epoch: 18, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 19 cost time: 1.0432662963867188
Epoch: 19, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 20 cost time: 1.0152571201324463
Epoch: 20, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9754307270050049
Epoch: 21, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0963990688323975
Epoch: 22, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0344715118408203
Epoch: 23, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.882530927658081
Epoch: 24, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1562142372131348
Epoch: 25, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 26 cost time: 1.140829086303711
Epoch: 26, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 27 cost time: 1.2736454010009766
Epoch: 27, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1181013584136963
Epoch: 28, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8707044124603271
Epoch: 29, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0488195419311523
Epoch: 30, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 31 cost time: 1.010063886642456
Epoch: 31, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0327095985412598
Epoch: 32, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 33 cost time: 1.2048075199127197
Epoch: 33, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2343201637268066
Epoch: 34, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4176337718963623
Epoch: 35, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0971696376800537
Epoch: 36, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9897310733795166
Epoch: 37, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0814096927642822
Epoch: 38, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.058319091796875
Epoch: 39, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1114294528961182
Epoch: 40, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1132681369781494
Epoch: 41, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2669899463653564
Epoch: 42, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 1.0803799629211426
Epoch: 43, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.059150218963623
Epoch: 44, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.560 Vali Acc: 0.853 Test Loss: 0.560 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853119).  Saving model ...
Epoch: 45 cost time: 0.9545564651489258
Epoch: 45, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9924993515014648
Epoch: 46, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2673773765563965
Epoch: 47, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.015082597732544
Epoch: 48, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853120).  Saving model ...
Epoch: 49 cost time: 0.8749852180480957
Epoch: 49, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 50 cost time: 0.9613921642303467
Epoch: 50, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.555 Vali Acc: 0.859 Test Loss: 0.555 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 51 cost time: 1.3471336364746094
Epoch: 51, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.555 Vali Acc: 0.859 Test Loss: 0.555 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859369).  Saving model ...
Epoch: 52 cost time: 1.0693747997283936
Epoch: 52, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.555 Vali Acc: 0.853 Test Loss: 0.555 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2973995208740234
Epoch: 53, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.228193998336792
Epoch: 54, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.853 Test Loss: 0.559 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.950458288192749
Epoch: 55, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.0482797622680664
Epoch: 56, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.562 Vali Acc: 0.847 Test Loss: 0.562 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.3730874061584473
Epoch: 57, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.3119819164276123
Epoch: 58, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0989291667938232
Epoch: 59, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.8810040950775146
Epoch: 60, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.2746520042419434
Epoch: 61, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.853 Test Loss: 0.577 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 43208
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.527717113494873
Epoch: 1, Steps: 8 | Train Loss: 2.333 Vali Loss: 2.278 Vali Acc: 0.062 Test Loss: 2.278 Test Acc: 0.062
Validation loss decreased (inf --> -0.062477).  Saving model ...
Epoch: 2 cost time: 1.2063825130462646
Epoch: 2, Steps: 8 | Train Loss: 2.193 Vali Loss: 2.093 Vali Acc: 0.131 Test Loss: 2.093 Test Acc: 0.131
Validation loss decreased (-0.062477 --> -0.131229).  Saving model ...
Epoch: 3 cost time: 0.8956608772277832
Epoch: 3, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.852 Vali Acc: 0.303 Test Loss: 1.852 Test Acc: 0.303
Validation loss decreased (-0.131229 --> -0.303106).  Saving model ...
Epoch: 4 cost time: 1.2867910861968994
Epoch: 4, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.592 Vali Acc: 0.497 Test Loss: 1.592 Test Acc: 0.497
Validation loss decreased (-0.303106 --> -0.496859).  Saving model ...
Epoch: 5 cost time: 0.9410202503204346
Epoch: 5, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.352 Vali Acc: 0.659 Test Loss: 1.352 Test Acc: 0.659
Validation loss decreased (-0.496859 --> -0.659361).  Saving model ...
Epoch: 6 cost time: 1.0053346157073975
Epoch: 6, Steps: 8 | Train Loss: 1.261 Vali Loss: 1.139 Vali Acc: 0.738 Test Loss: 1.139 Test Acc: 0.738
Validation loss decreased (-0.659361 --> -0.737489).  Saving model ...
Epoch: 7 cost time: 1.2398831844329834
Epoch: 7, Steps: 8 | Train Loss: 1.067 Vali Loss: 0.966 Vali Acc: 0.766 Test Loss: 0.966 Test Acc: 0.766
Validation loss decreased (-0.737489 --> -0.765615).  Saving model ...
Epoch: 8 cost time: 1.0847127437591553
Epoch: 8, Steps: 8 | Train Loss: 0.867 Vali Loss: 0.837 Vali Acc: 0.781 Test Loss: 0.837 Test Acc: 0.781
Validation loss decreased (-0.765615 --> -0.781242).  Saving model ...
Epoch: 9 cost time: 1.0251591205596924
Epoch: 9, Steps: 8 | Train Loss: 0.746 Vali Loss: 0.738 Vali Acc: 0.791 Test Loss: 0.738 Test Acc: 0.791
Validation loss decreased (-0.781242 --> -0.790618).  Saving model ...
Epoch: 10 cost time: 1.046415090560913
Epoch: 10, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.667 Vali Acc: 0.794 Test Loss: 0.667 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 11 cost time: 1.1260340213775635
Epoch: 11, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.622 Vali Acc: 0.794 Test Loss: 0.622 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793744).  Saving model ...
Epoch: 12 cost time: 1.5263681411743164
Epoch: 12, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
Validation loss decreased (-0.793744 --> -0.809369).  Saving model ...
Epoch: 13 cost time: 1.17030930519104
Epoch: 13, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 14 cost time: 1.045050859451294
Epoch: 14, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815620).  Saving model ...
Epoch: 15 cost time: 1.1311531066894531
Epoch: 15, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
Validation loss decreased (-0.815620 --> -0.821870).  Saving model ...
Epoch: 16 cost time: 1.1002123355865479
Epoch: 16, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 17 cost time: 1.30379056930542
Epoch: 17, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 18 cost time: 1.1125073432922363
Epoch: 18, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 1.238283634185791
Epoch: 19, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 20 cost time: 1.2260563373565674
Epoch: 20, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 1.2103915214538574
Epoch: 21, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0382258892059326
Epoch: 22, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1251392364501953
Epoch: 23, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3868834972381592
Epoch: 24, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0435609817504883
Epoch: 25, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2095210552215576
Epoch: 26, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.01466703414917
Epoch: 27, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.492 Vali Acc: 0.831 Test Loss: 0.492 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1290929317474365
Epoch: 28, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.488 Vali Acc: 0.834 Test Loss: 0.488 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.938988447189331
Epoch: 29, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4908702373504639
Epoch: 30, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm64_nh16_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 41160
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.585172176361084
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 1.887 Vali Acc: 0.244 Test Loss: 1.887 Test Acc: 0.244
Validation loss decreased (inf --> -0.243731).  Saving model ...
Epoch: 2 cost time: 1.3134851455688477
Epoch: 2, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.360 Vali Acc: 0.719 Test Loss: 1.360 Test Acc: 0.719
Validation loss decreased (-0.243731 --> -0.718736).  Saving model ...
Epoch: 3 cost time: 1.000101089477539
Epoch: 3, Steps: 8 | Train Loss: 1.170 Vali Loss: 0.907 Vali Acc: 0.787 Test Loss: 0.907 Test Acc: 0.787
Validation loss decreased (-0.718736 --> -0.787491).  Saving model ...
Epoch: 4 cost time: 1.0831530094146729
Epoch: 4, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.676 Vali Acc: 0.819 Test Loss: 0.676 Test Acc: 0.819
Validation loss decreased (-0.787491 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 1.0518505573272705
Epoch: 5, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 6 cost time: 0.9732465744018555
Epoch: 6, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 1.0604829788208008
Epoch: 7, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.9899704456329346
Epoch: 8, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0816149711608887
Epoch: 9, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.129974603652954
Epoch: 10, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8381857872009277
Epoch: 11, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9929077625274658
Epoch: 12, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 0.9639880657196045
Epoch: 13, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1267220973968506
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9767162799835205
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.9913029670715332
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3946640491485596
Epoch: 17, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.626 Vali Acc: 0.841 Test Loss: 0.626 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9893789291381836
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8464457988739014
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.632 Vali Acc: 0.847 Test Loss: 0.632 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.099034070968628
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.656 Vali Acc: 0.838 Test Loss: 0.656 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1101644039154053
Epoch: 21, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2287349700927734
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9409337043762207
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1309785842895508
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.677 Vali Acc: 0.847 Test Loss: 0.677 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0966331958770752
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 81256
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.186488151550293
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 2.026 Vali Acc: 0.072 Test Loss: 2.026 Test Acc: 0.072
Validation loss decreased (inf --> -0.071855).  Saving model ...
Epoch: 2 cost time: 1.165257215499878
Epoch: 2, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.741 Vali Acc: 0.397 Test Loss: 1.741 Test Acc: 0.397
Validation loss decreased (-0.071855 --> -0.396858).  Saving model ...
Epoch: 3 cost time: 0.8786971569061279
Epoch: 3, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.417 Vali Acc: 0.647 Test Loss: 1.417 Test Acc: 0.647
Validation loss decreased (-0.396858 --> -0.646861).  Saving model ...
Epoch: 4 cost time: 0.8126659393310547
Epoch: 4, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.118 Vali Acc: 0.719 Test Loss: 1.118 Test Acc: 0.719
Validation loss decreased (-0.646861 --> -0.718739).  Saving model ...
Epoch: 5 cost time: 0.9831147193908691
Epoch: 5, Steps: 8 | Train Loss: 1.022 Vali Loss: 0.868 Vali Acc: 0.759 Test Loss: 0.868 Test Acc: 0.759
Validation loss decreased (-0.718739 --> -0.759366).  Saving model ...
Epoch: 6 cost time: 1.1064159870147705
Epoch: 6, Steps: 8 | Train Loss: 0.799 Vali Loss: 0.703 Vali Acc: 0.791 Test Loss: 0.703 Test Acc: 0.791
Validation loss decreased (-0.759366 --> -0.790618).  Saving model ...
Epoch: 7 cost time: 0.9859676361083984
Epoch: 7, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.598 Vali Acc: 0.834 Test Loss: 0.598 Test Acc: 0.834
Validation loss decreased (-0.790618 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 1.0182609558105469
Epoch: 8, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 1.1393251419067383
Epoch: 9, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 1.06180739402771
Epoch: 10, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.8537020683288574
Epoch: 11, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8606858253479004
Epoch: 12, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2872235774993896
Epoch: 13, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.51595139503479
Epoch: 14, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9919579029083252
Epoch: 15, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1536526679992676
Epoch: 16, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9992296695709229
Epoch: 17, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9137442111968994
Epoch: 18, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9440441131591797
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9567923545837402
Epoch: 20, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 51560
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0216825008392334
Epoch: 1, Steps: 8 | Train Loss: 2.231 Vali Loss: 1.976 Vali Acc: 0.275 Test Loss: 1.976 Test Acc: 0.275
Validation loss decreased (inf --> -0.274980).  Saving model ...
Epoch: 2 cost time: 1.3531575202941895
Epoch: 2, Steps: 8 | Train Loss: 2.052 Vali Loss: 1.787 Vali Acc: 0.384 Test Loss: 1.787 Test Acc: 0.384
Validation loss decreased (-0.274980 --> -0.384357).  Saving model ...
Epoch: 3 cost time: 1.0911250114440918
Epoch: 3, Steps: 8 | Train Loss: 1.754 Vali Loss: 1.535 Vali Acc: 0.591 Test Loss: 1.535 Test Acc: 0.591
Validation loss decreased (-0.384357 --> -0.590610).  Saving model ...
Epoch: 4 cost time: 1.5755970478057861
Epoch: 4, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.288 Vali Acc: 0.706 Test Loss: 1.288 Test Acc: 0.706
Validation loss decreased (-0.590610 --> -0.706237).  Saving model ...
Epoch: 5 cost time: 1.148911952972412
Epoch: 5, Steps: 8 | Train Loss: 1.190 Vali Loss: 1.056 Vali Acc: 0.766 Test Loss: 1.056 Test Acc: 0.766
Validation loss decreased (-0.706237 --> -0.765614).  Saving model ...
Epoch: 6 cost time: 1.2542662620544434
Epoch: 6, Steps: 8 | Train Loss: 1.015 Vali Loss: 0.862 Vali Acc: 0.803 Test Loss: 0.862 Test Acc: 0.803
Validation loss decreased (-0.765614 --> -0.803116).  Saving model ...
Epoch: 7 cost time: 1.0924592018127441
Epoch: 7, Steps: 8 | Train Loss: 0.781 Vali Loss: 0.726 Vali Acc: 0.812 Test Loss: 0.726 Test Acc: 0.812
Validation loss decreased (-0.803116 --> -0.812493).  Saving model ...
Epoch: 8 cost time: 1.3364675045013428
Epoch: 8, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9722530841827393
Epoch: 9, Steps: 8 | Train Loss: 0.569 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 1.1168744564056396
Epoch: 10, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1032838821411133
Epoch: 11, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828120).  Saving model ...
Epoch: 12 cost time: 1.290445327758789
Epoch: 12, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 1.3807456493377686
Epoch: 13, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 1.2926146984100342
Epoch: 14, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.276411533355713
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1789765357971191
Epoch: 16, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.9886152744293213
Epoch: 17, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 0.9853067398071289
Epoch: 18, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2394766807556152
Epoch: 19, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0440280437469482
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9444844722747803
Epoch: 21, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5131709575653076
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2496747970581055
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3097178936004639
Epoch: 24, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0532193183898926
Epoch: 25, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0782253742218018
Epoch: 26, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3096511363983154
Epoch: 27, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 41832
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.253881216049194
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.135 Vali Acc: 0.194 Test Loss: 2.135 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.9120192527770996
Epoch: 2, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.919 Vali Acc: 0.344 Test Loss: 1.919 Test Acc: 0.344
Validation loss decreased (-0.193729 --> -0.343731).  Saving model ...
Epoch: 3 cost time: 1.0935437679290771
Epoch: 3, Steps: 8 | Train Loss: 1.803 Vali Loss: 1.675 Vali Acc: 0.441 Test Loss: 1.675 Test Acc: 0.441
Validation loss decreased (-0.343731 --> -0.440608).  Saving model ...
Epoch: 4 cost time: 0.9578757286071777
Epoch: 4, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.429 Vali Acc: 0.600 Test Loss: 1.429 Test Acc: 0.600
Validation loss decreased (-0.440608 --> -0.599986).  Saving model ...
Epoch: 5 cost time: 1.2671682834625244
Epoch: 5, Steps: 8 | Train Loss: 1.342 Vali Loss: 1.204 Vali Acc: 0.719 Test Loss: 1.204 Test Acc: 0.719
Validation loss decreased (-0.599986 --> -0.718738).  Saving model ...
Epoch: 6 cost time: 1.366426706314087
Epoch: 6, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
Validation loss decreased (-0.718738 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 1.1911811828613281
Epoch: 7, Steps: 8 | Train Loss: 0.907 Vali Loss: 0.853 Vali Acc: 0.781 Test Loss: 0.853 Test Acc: 0.781
Validation loss decreased (-0.749990 --> -0.781241).  Saving model ...
Epoch: 8 cost time: 1.3246502876281738
Epoch: 8, Steps: 8 | Train Loss: 0.755 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.781241 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.1521131992340088
Epoch: 9, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 1.2783119678497314
Epoch: 10, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.605 Vali Acc: 0.797 Test Loss: 0.605 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9954583644866943
Epoch: 11, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 12 cost time: 1.200652837753296
Epoch: 12, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.534 Vali Acc: 0.816 Test Loss: 0.534 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815620).  Saving model ...
Epoch: 13 cost time: 1.1566264629364014
Epoch: 13, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
Validation loss decreased (-0.815620 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 0.7897026538848877
Epoch: 14, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.246952772140503
Epoch: 15, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0745837688446045
Epoch: 16, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.490 Vali Acc: 0.828 Test Loss: 0.490 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 17 cost time: 1.3879146575927734
Epoch: 17, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3767311573028564
Epoch: 18, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 19 cost time: 0.9908137321472168
Epoch: 19, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 1.2498643398284912
Epoch: 20, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.496 Vali Acc: 0.831 Test Loss: 0.496 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.902714729309082
Epoch: 21, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 1.1175122261047363
Epoch: 22, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 1.073899269104004
Epoch: 23, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0956404209136963
Epoch: 24, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1624653339385986
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 1.4605896472930908
Epoch: 26, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2255706787109375
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5072593688964844
Epoch: 28, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9992685317993164
Epoch: 29, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6447339057922363
Epoch: 30, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2299730777740479
Epoch: 31, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1240339279174805
Epoch: 32, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9175534248352051
Epoch: 33, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2867321968078613
Epoch: 34, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.327413558959961
Epoch: 35, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 36712
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6717028617858887
Epoch: 1, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.796 Vali Acc: 0.284 Test Loss: 1.796 Test Acc: 0.284
Validation loss decreased (inf --> -0.284357).  Saving model ...
Epoch: 2 cost time: 1.0093417167663574
Epoch: 2, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.675 Vali Acc: 0.403 Test Loss: 1.675 Test Acc: 0.403
Validation loss decreased (-0.284357 --> -0.403108).  Saving model ...
Epoch: 3 cost time: 1.1372876167297363
Epoch: 3, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.515 Vali Acc: 0.550 Test Loss: 1.515 Test Acc: 0.550
Validation loss decreased (-0.403108 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 1.2290558815002441
Epoch: 4, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.343 Vali Acc: 0.666 Test Loss: 1.343 Test Acc: 0.666
Validation loss decreased (-0.549985 --> -0.665612).  Saving model ...
Epoch: 5 cost time: 1.0917236804962158
Epoch: 5, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.179 Vali Acc: 0.738 Test Loss: 1.179 Test Acc: 0.738
Validation loss decreased (-0.665612 --> -0.737488).  Saving model ...
Epoch: 6 cost time: 1.011443853378296
Epoch: 6, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.029 Vali Acc: 0.769 Test Loss: 1.029 Test Acc: 0.769
Validation loss decreased (-0.737488 --> -0.768740).  Saving model ...
Epoch: 7 cost time: 0.970024585723877
Epoch: 7, Steps: 8 | Train Loss: 1.018 Vali Loss: 0.897 Vali Acc: 0.781 Test Loss: 0.897 Test Acc: 0.781
Validation loss decreased (-0.768740 --> -0.781241).  Saving model ...
Epoch: 8 cost time: 0.974137544631958
Epoch: 8, Steps: 8 | Train Loss: 0.851 Vali Loss: 0.794 Vali Acc: 0.791 Test Loss: 0.794 Test Acc: 0.791
Validation loss decreased (-0.781241 --> -0.790617).  Saving model ...
Epoch: 9 cost time: 1.0018463134765625
Epoch: 9, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.713 Vali Acc: 0.794 Test Loss: 0.713 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 10 cost time: 1.0012259483337402
Epoch: 10, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.652 Vali Acc: 0.797 Test Loss: 0.652 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 11 cost time: 0.9583835601806641
Epoch: 11, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 12 cost time: 1.1666889190673828
Epoch: 12, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 13 cost time: 1.1635448932647705
Epoch: 13, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821870).  Saving model ...
Epoch: 14 cost time: 0.9515604972839355
Epoch: 14, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 0.884817361831665
Epoch: 15, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0459916591644287
Epoch: 16, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 17 cost time: 0.9567160606384277
Epoch: 17, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 1.023430347442627
Epoch: 18, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.489 Vali Acc: 0.831 Test Loss: 0.489 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 19 cost time: 1.0686607360839844
Epoch: 19, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 1.075721263885498
Epoch: 20, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.488 Vali Acc: 0.831 Test Loss: 0.488 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.007652997970581
Epoch: 21, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 22 cost time: 1.228623867034912
Epoch: 22, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 1.237908124923706
Epoch: 23, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 24 cost time: 1.0593667030334473
Epoch: 24, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 1.244197130203247
Epoch: 25, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.34602689743042
Epoch: 26, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2490627765655518
Epoch: 27, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.238335132598877
Epoch: 28, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0324082374572754
Epoch: 29, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9720561504364014
Epoch: 30, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9672198295593262
Epoch: 31, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0099823474884033
Epoch: 32, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.236311912536621
Epoch: 33, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4532358646392822
Epoch: 34, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 32616
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5223498344421387
Epoch: 1, Steps: 8 | Train Loss: 2.324 Vali Loss: 2.251 Vali Acc: 0.103 Test Loss: 2.251 Test Acc: 0.103
Validation loss decreased (inf --> -0.103102).  Saving model ...
Epoch: 2 cost time: 1.0836615562438965
Epoch: 2, Steps: 8 | Train Loss: 2.206 Vali Loss: 2.145 Vali Acc: 0.163 Test Loss: 2.145 Test Acc: 0.163
Validation loss decreased (-0.103102 --> -0.162479).  Saving model ...
Epoch: 3 cost time: 1.1121320724487305
Epoch: 3, Steps: 8 | Train Loss: 2.117 Vali Loss: 1.995 Vali Acc: 0.291 Test Loss: 1.995 Test Acc: 0.291
Validation loss decreased (-0.162479 --> -0.290605).  Saving model ...
Epoch: 4 cost time: 0.9665467739105225
Epoch: 4, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.820 Vali Acc: 0.416 Test Loss: 1.820 Test Acc: 0.416
Validation loss decreased (-0.290605 --> -0.415607).  Saving model ...
Epoch: 5 cost time: 1.036430835723877
Epoch: 5, Steps: 8 | Train Loss: 1.754 Vali Loss: 1.639 Vali Acc: 0.506 Test Loss: 1.639 Test Acc: 0.506
Validation loss decreased (-0.415607 --> -0.506234).  Saving model ...
Epoch: 6 cost time: 0.943352222442627
Epoch: 6, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.459 Vali Acc: 0.575 Test Loss: 1.459 Test Acc: 0.575
Validation loss decreased (-0.506234 --> -0.574985).  Saving model ...
Epoch: 7 cost time: 1.1692626476287842
Epoch: 7, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.295 Vali Acc: 0.662 Test Loss: 1.295 Test Acc: 0.662
Validation loss decreased (-0.574985 --> -0.662487).  Saving model ...
Epoch: 8 cost time: 1.1639142036437988
Epoch: 8, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.149 Vali Acc: 0.709 Test Loss: 1.149 Test Acc: 0.709
Validation loss decreased (-0.662487 --> -0.709364).  Saving model ...
Epoch: 9 cost time: 1.0772292613983154
Epoch: 9, Steps: 8 | Train Loss: 1.028 Vali Loss: 1.016 Vali Acc: 0.738 Test Loss: 1.016 Test Acc: 0.738
Validation loss decreased (-0.709364 --> -0.737490).  Saving model ...
Epoch: 10 cost time: 1.0796458721160889
Epoch: 10, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.902 Vali Acc: 0.759 Test Loss: 0.902 Test Acc: 0.759
Validation loss decreased (-0.737490 --> -0.759366).  Saving model ...
Epoch: 11 cost time: 1.1602287292480469
Epoch: 11, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.810 Vali Acc: 0.784 Test Loss: 0.810 Test Acc: 0.784
Validation loss decreased (-0.759366 --> -0.784367).  Saving model ...
Epoch: 12 cost time: 1.1767661571502686
Epoch: 12, Steps: 8 | Train Loss: 0.764 Vali Loss: 0.741 Vali Acc: 0.787 Test Loss: 0.741 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 13 cost time: 1.0650320053100586
Epoch: 13, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796868).  Saving model ...
Epoch: 14 cost time: 1.4691627025604248
Epoch: 14, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 15 cost time: 1.1564977169036865
Epoch: 15, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 16 cost time: 1.409691333770752
Epoch: 16, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824994).  Saving model ...
Epoch: 17 cost time: 1.4074163436889648
Epoch: 17, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 18 cost time: 1.1982405185699463
Epoch: 18, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 19 cost time: 1.3183393478393555
Epoch: 19, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 1.2146661281585693
Epoch: 20, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 21 cost time: 1.1262495517730713
Epoch: 21, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.514 Vali Acc: 0.831 Test Loss: 0.514 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 22 cost time: 1.2025158405303955
Epoch: 22, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 1.1781227588653564
Epoch: 23, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.502 Vali Acc: 0.828 Test Loss: 0.502 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2398712635040283
Epoch: 24, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.375049114227295
Epoch: 25, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.487 Vali Acc: 0.828 Test Loss: 0.487 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2584280967712402
Epoch: 26, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.489 Vali Acc: 0.828 Test Loss: 0.489 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2042055130004883
Epoch: 27, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.485 Vali Acc: 0.828 Test Loss: 0.485 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.162020206451416
Epoch: 28, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.479 Vali Acc: 0.828 Test Loss: 0.479 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.13364577293396
Epoch: 29, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 30 cost time: 1.1258924007415771
Epoch: 30, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 31 cost time: 1.0770330429077148
Epoch: 31, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4035289287567139
Epoch: 32, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 33 cost time: 1.0149469375610352
Epoch: 33, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1369731426239014
Epoch: 34, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3381140232086182
Epoch: 35, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1026411056518555
Epoch: 36, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0482912063598633
Epoch: 37, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1849617958068848
Epoch: 38, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0426957607269287
Epoch: 39, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1443042755126953
Epoch: 40, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1223876476287842
Epoch: 41, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9906578063964844
Epoch: 42, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.460 Vali Acc: 0.844 Test Loss: 0.460 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 30024
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.538653135299683
Epoch: 1, Steps: 8 | Train Loss: 2.378 Vali Loss: 2.276 Vali Acc: 0.078 Test Loss: 2.276 Test Acc: 0.078
Validation loss decreased (inf --> -0.078102).  Saving model ...
Epoch: 2 cost time: 1.0463786125183105
Epoch: 2, Steps: 8 | Train Loss: 2.272 Vali Loss: 2.174 Vali Acc: 0.153 Test Loss: 2.174 Test Acc: 0.153
Validation loss decreased (-0.078102 --> -0.153103).  Saving model ...
Epoch: 3 cost time: 1.3605222702026367
Epoch: 3, Steps: 8 | Train Loss: 2.111 Vali Loss: 2.030 Vali Acc: 0.250 Test Loss: 2.030 Test Acc: 0.250
Validation loss decreased (-0.153103 --> -0.249980).  Saving model ...
Epoch: 4 cost time: 1.2757000923156738
Epoch: 4, Steps: 8 | Train Loss: 1.992 Vali Loss: 1.863 Vali Acc: 0.338 Test Loss: 1.863 Test Acc: 0.338
Validation loss decreased (-0.249980 --> -0.337481).  Saving model ...
Epoch: 5 cost time: 1.066796064376831
Epoch: 5, Steps: 8 | Train Loss: 1.833 Vali Loss: 1.681 Vali Acc: 0.469 Test Loss: 1.681 Test Acc: 0.469
Validation loss decreased (-0.337481 --> -0.468733).  Saving model ...
Epoch: 6 cost time: 1.3544580936431885
Epoch: 6, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.503 Vali Acc: 0.603 Test Loss: 1.503 Test Acc: 0.603
Validation loss decreased (-0.468733 --> -0.603110).  Saving model ...
Epoch: 7 cost time: 0.9272866249084473
Epoch: 7, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.338 Vali Acc: 0.678 Test Loss: 1.338 Test Acc: 0.678
Validation loss decreased (-0.603110 --> -0.678112).  Saving model ...
Epoch: 8 cost time: 1.1190130710601807
Epoch: 8, Steps: 8 | Train Loss: 1.268 Vali Loss: 1.196 Vali Acc: 0.719 Test Loss: 1.196 Test Acc: 0.719
Validation loss decreased (-0.678112 --> -0.718738).  Saving model ...
Epoch: 9 cost time: 1.079258680343628
Epoch: 9, Steps: 8 | Train Loss: 1.114 Vali Loss: 1.070 Vali Acc: 0.744 Test Loss: 1.070 Test Acc: 0.744
Validation loss decreased (-0.718738 --> -0.743739).  Saving model ...
Epoch: 10 cost time: 1.479475736618042
Epoch: 10, Steps: 8 | Train Loss: 1.015 Vali Loss: 0.959 Vali Acc: 0.762 Test Loss: 0.959 Test Acc: 0.762
Validation loss decreased (-0.743739 --> -0.762490).  Saving model ...
Epoch: 11 cost time: 1.2009634971618652
Epoch: 11, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
Validation loss decreased (-0.762490 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.1458344459533691
Epoch: 12, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.806 Vali Acc: 0.781 Test Loss: 0.806 Test Acc: 0.781
Validation loss decreased (-0.774991 --> -0.781242).  Saving model ...
Epoch: 13 cost time: 1.2307713031768799
Epoch: 13, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.748 Vali Acc: 0.797 Test Loss: 0.748 Test Acc: 0.797
Validation loss decreased (-0.781242 --> -0.796868).  Saving model ...
Epoch: 14 cost time: 1.0483121871948242
Epoch: 14, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.702 Vali Acc: 0.803 Test Loss: 0.702 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803118).  Saving model ...
Epoch: 15 cost time: 0.9712405204772949
Epoch: 15, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809368).  Saving model ...
Epoch: 16 cost time: 1.028028964996338
Epoch: 16, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
Validation loss decreased (-0.809368 --> -0.812494).  Saving model ...
Epoch: 17 cost time: 1.14522123336792
Epoch: 17, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 18 cost time: 1.168456792831421
Epoch: 18, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 19 cost time: 1.1119613647460938
Epoch: 19, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 20 cost time: 1.560593605041504
Epoch: 20, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 1.0272996425628662
Epoch: 21, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 1.0485570430755615
Epoch: 22, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 23 cost time: 1.0879662036895752
Epoch: 23, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 24 cost time: 1.1640748977661133
Epoch: 24, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 25 cost time: 0.9286961555480957
Epoch: 25, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 26 cost time: 1.2520287036895752
Epoch: 26, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 27 cost time: 1.2599773406982422
Epoch: 27, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3211259841918945
Epoch: 28, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 29 cost time: 1.076070785522461
Epoch: 29, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 30 cost time: 1.1730282306671143
Epoch: 30, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 31 cost time: 1.1526334285736084
Epoch: 31, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 32 cost time: 1.4509358406066895
Epoch: 32, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 33 cost time: 1.425555944442749
Epoch: 33, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.463 Vali Acc: 0.866 Test Loss: 0.463 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 34 cost time: 1.1753103733062744
Epoch: 34, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3180601596832275
Epoch: 35, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9204072952270508
Epoch: 36, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1462619304656982
Epoch: 37, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.306260347366333
Epoch: 38, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1501874923706055
Epoch: 39, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.5387139320373535
Epoch: 40, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6058974266052246
Epoch: 41, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0994415283203125
Epoch: 42, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4881291389465332
Epoch: 43, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 29000
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9658141136169434
Epoch: 1, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.880 Vali Acc: 0.266 Test Loss: 1.880 Test Acc: 0.266
Validation loss decreased (inf --> -0.265606).  Saving model ...
Epoch: 2 cost time: 1.0996294021606445
Epoch: 2, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.402 Vali Acc: 0.653 Test Loss: 1.402 Test Acc: 0.653
Validation loss decreased (-0.265606 --> -0.653111).  Saving model ...
Epoch: 3 cost time: 0.948906421661377
Epoch: 3, Steps: 8 | Train Loss: 1.206 Vali Loss: 0.958 Vali Acc: 0.778 Test Loss: 0.958 Test Acc: 0.778
Validation loss decreased (-0.653111 --> -0.778115).  Saving model ...
Epoch: 4 cost time: 1.3477916717529297
Epoch: 4, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.702 Vali Acc: 0.803 Test Loss: 0.702 Test Acc: 0.803
Validation loss decreased (-0.778115 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 1.0993413925170898
Epoch: 5, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.576 Vali Acc: 0.834 Test Loss: 0.576 Test Acc: 0.834
Validation loss decreased (-0.803118 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 1.1014928817749023
Epoch: 6, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.159555435180664
Epoch: 7, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0313506126403809
Epoch: 8, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9884829521179199
Epoch: 9, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.105841875076294
Epoch: 10, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.015873670578003
Epoch: 11, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9369668960571289
Epoch: 12, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0449633598327637
Epoch: 13, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2302711009979248
Epoch: 14, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0262160301208496
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 72936
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5650992393493652
Epoch: 1, Steps: 8 | Train Loss: 2.279 Vali Loss: 2.095 Vali Acc: 0.191 Test Loss: 2.095 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 1.0419909954071045
Epoch: 2, Steps: 8 | Train Loss: 2.141 Vali Loss: 1.832 Vali Acc: 0.378 Test Loss: 1.832 Test Acc: 0.378
Validation loss decreased (-0.190604 --> -0.378107).  Saving model ...
Epoch: 3 cost time: 1.0146737098693848
Epoch: 3, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.502 Vali Acc: 0.531 Test Loss: 1.502 Test Acc: 0.531
Validation loss decreased (-0.378107 --> -0.531235).  Saving model ...
Epoch: 4 cost time: 1.0263571739196777
Epoch: 4, Steps: 8 | Train Loss: 1.420 Vali Loss: 1.189 Vali Acc: 0.706 Test Loss: 1.189 Test Acc: 0.706
Validation loss decreased (-0.531235 --> -0.706238).  Saving model ...
Epoch: 5 cost time: 0.9283750057220459
Epoch: 5, Steps: 8 | Train Loss: 1.124 Vali Loss: 0.932 Vali Acc: 0.772 Test Loss: 0.932 Test Acc: 0.772
Validation loss decreased (-0.706238 --> -0.771866).  Saving model ...
Epoch: 6 cost time: 0.9433467388153076
Epoch: 6, Steps: 8 | Train Loss: 0.774 Vali Loss: 0.758 Vali Acc: 0.794 Test Loss: 0.758 Test Acc: 0.794
Validation loss decreased (-0.771866 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 1.123034954071045
Epoch: 7, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.654 Vali Acc: 0.797 Test Loss: 0.654 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.9426238536834717
Epoch: 8, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 1.090158462524414
Epoch: 9, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
Validation loss decreased (-0.803119 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 1.082784652709961
Epoch: 10, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 1.0048341751098633
Epoch: 11, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.526 Vali Acc: 0.828 Test Loss: 0.526 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.002927541732788
Epoch: 12, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.9492998123168945
Epoch: 13, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.249344825744629
Epoch: 14, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0936777591705322
Epoch: 15, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1627700328826904
Epoch: 16, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4123947620391846
Epoch: 17, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0765485763549805
Epoch: 18, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4919285774230957
Epoch: 19, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3825640678405762
Epoch: 20, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.374035120010376
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1497185230255127
Epoch: 22, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.583 Vali Acc: 0.834 Test Loss: 0.583 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2818591594696045
Epoch: 23, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.586 Vali Acc: 0.831 Test Loss: 0.586 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 43240
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.901008129119873
Epoch: 1, Steps: 8 | Train Loss: 2.283 Vali Loss: 2.166 Vali Acc: 0.184 Test Loss: 2.166 Test Acc: 0.184
Validation loss decreased (inf --> -0.184353).  Saving model ...
Epoch: 2 cost time: 1.0978925228118896
Epoch: 2, Steps: 8 | Train Loss: 2.168 Vali Loss: 1.969 Vali Acc: 0.266 Test Loss: 1.969 Test Acc: 0.266
Validation loss decreased (-0.184353 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 0.8656425476074219
Epoch: 3, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.710 Vali Acc: 0.484 Test Loss: 1.710 Test Acc: 0.484
Validation loss decreased (-0.265605 --> -0.484358).  Saving model ...
Epoch: 4 cost time: 1.1095125675201416
Epoch: 4, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.445 Vali Acc: 0.622 Test Loss: 1.445 Test Acc: 0.622
Validation loss decreased (-0.484358 --> -0.621861).  Saving model ...
Epoch: 5 cost time: 1.0766825675964355
Epoch: 5, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.186 Vali Acc: 0.681 Test Loss: 1.186 Test Acc: 0.681
Validation loss decreased (-0.621861 --> -0.681238).  Saving model ...
Epoch: 6 cost time: 1.0425140857696533
Epoch: 6, Steps: 8 | Train Loss: 1.070 Vali Loss: 0.972 Vali Acc: 0.741 Test Loss: 0.972 Test Acc: 0.741
Validation loss decreased (-0.681238 --> -0.740615).  Saving model ...
Epoch: 7 cost time: 1.3787498474121094
Epoch: 7, Steps: 8 | Train Loss: 0.866 Vali Loss: 0.810 Vali Acc: 0.769 Test Loss: 0.810 Test Acc: 0.769
Validation loss decreased (-0.740615 --> -0.768742).  Saving model ...
Epoch: 8 cost time: 1.0072240829467773
Epoch: 8, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.699 Vali Acc: 0.797 Test Loss: 0.699 Test Acc: 0.797
Validation loss decreased (-0.768742 --> -0.796868).  Saving model ...
Epoch: 9 cost time: 0.953521728515625
Epoch: 9, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
Validation loss decreased (-0.796868 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 1.184798002243042
Epoch: 10, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 1.1534907817840576
Epoch: 11, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 1.1192831993103027
Epoch: 12, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 1.1146202087402344
Epoch: 13, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1141960620880127
Epoch: 14, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.0296757221221924
Epoch: 15, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9168648719787598
Epoch: 16, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9827229976654053
Epoch: 17, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5072762966156006
Epoch: 18, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 1.199847936630249
Epoch: 19, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4940762519836426
Epoch: 20, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0106987953186035
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3539321422576904
Epoch: 22, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9828991889953613
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9346845149993896
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9494485855102539
Epoch: 25, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1961479187011719
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4241790771484375
Epoch: 27, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.08544921875
Epoch: 28, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 33512
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.262681245803833
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.044 Vali Acc: 0.212 Test Loss: 2.044 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 1.5775446891784668
Epoch: 2, Steps: 8 | Train Loss: 1.997 Vali Loss: 1.886 Vali Acc: 0.294 Test Loss: 1.886 Test Acc: 0.294
Validation loss decreased (-0.212480 --> -0.293731).  Saving model ...
Epoch: 3 cost time: 1.3426294326782227
Epoch: 3, Steps: 8 | Train Loss: 1.783 Vali Loss: 1.684 Vali Acc: 0.447 Test Loss: 1.684 Test Acc: 0.447
Validation loss decreased (-0.293731 --> -0.446858).  Saving model ...
Epoch: 4 cost time: 1.4506103992462158
Epoch: 4, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.461 Vali Acc: 0.631 Test Loss: 1.461 Test Acc: 0.631
Validation loss decreased (-0.446858 --> -0.631235).  Saving model ...
Epoch: 5 cost time: 1.3061540126800537
Epoch: 5, Steps: 8 | Train Loss: 1.354 Vali Loss: 1.253 Vali Acc: 0.688 Test Loss: 1.253 Test Acc: 0.688
Validation loss decreased (-0.631235 --> -0.687487).  Saving model ...
Epoch: 6 cost time: 0.9502770900726318
Epoch: 6, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.063 Vali Acc: 0.756 Test Loss: 1.063 Test Acc: 0.756
Validation loss decreased (-0.687487 --> -0.756239).  Saving model ...
Epoch: 7 cost time: 1.2019126415252686
Epoch: 7, Steps: 8 | Train Loss: 0.949 Vali Loss: 0.911 Vali Acc: 0.784 Test Loss: 0.911 Test Acc: 0.784
Validation loss decreased (-0.756239 --> -0.784366).  Saving model ...
Epoch: 8 cost time: 0.9717411994934082
Epoch: 8, Steps: 8 | Train Loss: 0.824 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
Validation loss decreased (-0.784366 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.2878763675689697
Epoch: 9, Steps: 8 | Train Loss: 0.646 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
Validation loss decreased (-0.799992 --> -0.803118).  Saving model ...
Epoch: 10 cost time: 1.0656373500823975
Epoch: 10, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 11 cost time: 1.109403133392334
Epoch: 11, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.581 Vali Acc: 0.834 Test Loss: 0.581 Test Acc: 0.834
Validation loss decreased (-0.809369 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 1.0950210094451904
Epoch: 12, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2341618537902832
Epoch: 13, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.9753751754760742
Epoch: 14, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 1.1229186058044434
Epoch: 15, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 1.306410551071167
Epoch: 16, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1881766319274902
Epoch: 17, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0935957431793213
Epoch: 18, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 0.9246413707733154
Epoch: 19, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 1.108504295349121
Epoch: 20, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3272669315338135
Epoch: 21, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.071030855178833
Epoch: 22, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0807840824127197
Epoch: 23, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2885246276855469
Epoch: 24, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2562613487243652
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.049567699432373
Epoch: 26, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3348307609558105
Epoch: 27, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1645736694335938
Epoch: 28, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3763988018035889
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 28392
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6159987449645996
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.058 Vali Acc: 0.181 Test Loss: 2.058 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 1.2657532691955566
Epoch: 2, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.922 Vali Acc: 0.281 Test Loss: 1.922 Test Acc: 0.281
Validation loss decreased (-0.181229 --> -0.281231).  Saving model ...
Epoch: 3 cost time: 1.1763863563537598
Epoch: 3, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.734 Vali Acc: 0.425 Test Loss: 1.734 Test Acc: 0.425
Validation loss decreased (-0.281231 --> -0.424983).  Saving model ...
Epoch: 4 cost time: 1.5483126640319824
Epoch: 4, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.523 Vali Acc: 0.644 Test Loss: 1.523 Test Acc: 0.644
Validation loss decreased (-0.424983 --> -0.643735).  Saving model ...
Epoch: 5 cost time: 0.9074101448059082
Epoch: 5, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.326 Vali Acc: 0.706 Test Loss: 1.326 Test Acc: 0.706
Validation loss decreased (-0.643735 --> -0.706237).  Saving model ...
Epoch: 6 cost time: 1.3066768646240234
Epoch: 6, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.148 Vali Acc: 0.750 Test Loss: 1.148 Test Acc: 0.750
Validation loss decreased (-0.706237 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 1.2111897468566895
Epoch: 7, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.997 Vali Acc: 0.756 Test Loss: 0.997 Test Acc: 0.756
Validation loss decreased (-0.749989 --> -0.756240).  Saving model ...
Epoch: 8 cost time: 1.268050193786621
Epoch: 8, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.868 Vali Acc: 0.784 Test Loss: 0.868 Test Acc: 0.784
Validation loss decreased (-0.756240 --> -0.784366).  Saving model ...
Epoch: 9 cost time: 1.6527249813079834
Epoch: 9, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.762 Vali Acc: 0.812 Test Loss: 0.762 Test Acc: 0.812
Validation loss decreased (-0.784366 --> -0.812492).  Saving model ...
Epoch: 10 cost time: 1.2066855430603027
Epoch: 10, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821868).  Saving model ...
Epoch: 11 cost time: 0.9693191051483154
Epoch: 11, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.634 Vali Acc: 0.819 Test Loss: 0.634 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0790197849273682
Epoch: 12, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.15907621383667
Epoch: 13, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.570 Vali Acc: 0.831 Test Loss: 0.570 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 0.8367459774017334
Epoch: 14, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 1.0125236511230469
Epoch: 15, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1929845809936523
Epoch: 16, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2029497623443604
Epoch: 17, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4442496299743652
Epoch: 18, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5761792659759521
Epoch: 19, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5675437450408936
Epoch: 20, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1078941822052002
Epoch: 21, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0090210437774658
Epoch: 22, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.231830358505249
Epoch: 23, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.515326976776123
Epoch: 24, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 24296
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.961287021636963
Epoch: 1, Steps: 8 | Train Loss: 2.093 Vali Loss: 2.025 Vali Acc: 0.197 Test Loss: 2.025 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 1.0675618648529053
Epoch: 2, Steps: 8 | Train Loss: 2.082 Vali Loss: 1.920 Vali Acc: 0.294 Test Loss: 1.920 Test Acc: 0.294
Validation loss decreased (-0.196855 --> -0.293731).  Saving model ...
Epoch: 3 cost time: 1.0892722606658936
Epoch: 3, Steps: 8 | Train Loss: 1.936 Vali Loss: 1.775 Vali Acc: 0.428 Test Loss: 1.775 Test Acc: 0.428
Validation loss decreased (-0.293731 --> -0.428107).  Saving model ...
Epoch: 4 cost time: 1.1395063400268555
Epoch: 4, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.607 Vali Acc: 0.550 Test Loss: 1.607 Test Acc: 0.550
Validation loss decreased (-0.428107 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 1.3108420372009277
Epoch: 5, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.433 Vali Acc: 0.647 Test Loss: 1.433 Test Acc: 0.647
Validation loss decreased (-0.549984 --> -0.646861).  Saving model ...
Epoch: 6 cost time: 1.1179990768432617
Epoch: 6, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.262 Vali Acc: 0.713 Test Loss: 1.262 Test Acc: 0.713
Validation loss decreased (-0.646861 --> -0.712487).  Saving model ...
Epoch: 7 cost time: 0.9515058994293213
Epoch: 7, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.107 Vali Acc: 0.753 Test Loss: 1.107 Test Acc: 0.753
Validation loss decreased (-0.712487 --> -0.753114).  Saving model ...
Epoch: 8 cost time: 1.228581190109253
Epoch: 8, Steps: 8 | Train Loss: 1.077 Vali Loss: 0.982 Vali Acc: 0.753 Test Loss: 0.982 Test Acc: 0.753
Validation loss decreased (-0.753114 --> -0.753115).  Saving model ...
Epoch: 9 cost time: 0.987576961517334
Epoch: 9, Steps: 8 | Train Loss: 0.962 Vali Loss: 0.883 Vali Acc: 0.756 Test Loss: 0.883 Test Acc: 0.756
Validation loss decreased (-0.753115 --> -0.756241).  Saving model ...
Epoch: 10 cost time: 1.2297892570495605
Epoch: 10, Steps: 8 | Train Loss: 0.891 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
Validation loss decreased (-0.756241 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 1.0695338249206543
Epoch: 11, Steps: 8 | Train Loss: 0.743 Vali Loss: 0.734 Vali Acc: 0.797 Test Loss: 0.734 Test Acc: 0.797
Validation loss decreased (-0.774992 --> -0.796868).  Saving model ...
Epoch: 12 cost time: 1.1537604331970215
Epoch: 12, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
Validation loss decreased (-0.796868 --> -0.806243).  Saving model ...
Epoch: 13 cost time: 1.0227925777435303
Epoch: 13, Steps: 8 | Train Loss: 0.622 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.297179937362671
Epoch: 14, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.611 Vali Acc: 0.806 Test Loss: 0.611 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 15 cost time: 1.3765759468078613
Epoch: 15, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 16 cost time: 1.0148768424987793
Epoch: 16, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 17 cost time: 1.231257677078247
Epoch: 17, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815620).  Saving model ...
Epoch: 18 cost time: 0.9990506172180176
Epoch: 18, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
Validation loss decreased (-0.815620 --> -0.821870).  Saving model ...
Epoch: 19 cost time: 1.1971652507781982
Epoch: 19, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 20 cost time: 1.2225842475891113
Epoch: 20, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 1.3116841316223145
Epoch: 21, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.512 Vali Acc: 0.825 Test Loss: 0.512 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 1.2399952411651611
Epoch: 22, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 23 cost time: 1.3755998611450195
Epoch: 23, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.496 Vali Acc: 0.828 Test Loss: 0.496 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 24 cost time: 1.0848824977874756
Epoch: 24, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 25 cost time: 1.1063852310180664
Epoch: 25, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 26 cost time: 1.062422513961792
Epoch: 26, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3829150199890137
Epoch: 27, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4229686260223389
Epoch: 28, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2617793083190918
Epoch: 29, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0283012390136719
Epoch: 30, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2026755809783936
Epoch: 31, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2576920986175537
Epoch: 32, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.205059289932251
Epoch: 33, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0694856643676758
Epoch: 34, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5811142921447754
Epoch: 35, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 36 cost time: 1.2552568912506104
Epoch: 36, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 37 cost time: 1.1686222553253174
Epoch: 37, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 38 cost time: 1.1841590404510498
Epoch: 38, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2079648971557617
Epoch: 39, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.255631923675537
Epoch: 40, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1039249897003174
Epoch: 41, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0704305171966553
Epoch: 42, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 43 cost time: 0.9000155925750732
Epoch: 43, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 44 cost time: 0.972801923751831
Epoch: 44, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2233641147613525
Epoch: 45, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9730894565582275
Epoch: 46, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 47 cost time: 1.1400635242462158
Epoch: 47, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 48 cost time: 1.388911485671997
Epoch: 48, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2919673919677734
Epoch: 49, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.4829349517822266
Epoch: 50, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0926597118377686
Epoch: 51, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8903689384460449
Epoch: 52, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 53 cost time: 0.7910721302032471
Epoch: 53, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 54 cost time: 0.9169008731842041
Epoch: 54, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.4355902671813965
Epoch: 55, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1661038398742676
Epoch: 56, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1499106884002686
Epoch: 57, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.471 Vali Acc: 0.869 Test Loss: 0.471 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.145650863647461
Epoch: 58, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.0819411277770996
Epoch: 59, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.9576771259307861
Epoch: 60, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1074233055114746
Epoch: 61, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.467 Vali Acc: 0.872 Test Loss: 0.467 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2621543407440186
Epoch: 62, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.468 Vali Acc: 0.866 Test Loss: 0.468 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.3058595657348633
Epoch: 63, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.4615213871002197
Epoch: 64, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.378859519958496
Epoch: 65, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.472 Vali Acc: 0.859 Test Loss: 0.472 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.1576507091522217
Epoch: 66, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.1956830024719238
Epoch: 67, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.6847591400146484
Epoch: 68, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.475 Vali Acc: 0.866 Test Loss: 0.475 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.399949073791504
Epoch: 69, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 21704
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.336677312850952
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.121 Vali Acc: 0.153 Test Loss: 2.121 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.2368664741516113
Epoch: 2, Steps: 8 | Train Loss: 2.041 Vali Loss: 1.960 Vali Acc: 0.212 Test Loss: 1.960 Test Acc: 0.212
Validation loss decreased (-0.153104 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 1.4307770729064941
Epoch: 3, Steps: 8 | Train Loss: 1.931 Vali Loss: 1.798 Vali Acc: 0.319 Test Loss: 1.798 Test Acc: 0.319
Validation loss decreased (-0.212480 --> -0.318732).  Saving model ...
Epoch: 4 cost time: 1.7568943500518799
Epoch: 4, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.630 Vali Acc: 0.456 Test Loss: 1.630 Test Acc: 0.456
Validation loss decreased (-0.318732 --> -0.456234).  Saving model ...
Epoch: 5 cost time: 1.5166006088256836
Epoch: 5, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.464 Vali Acc: 0.584 Test Loss: 1.464 Test Acc: 0.584
Validation loss decreased (-0.456234 --> -0.584360).  Saving model ...
Epoch: 6 cost time: 1.4403362274169922
Epoch: 6, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.313 Vali Acc: 0.650 Test Loss: 1.313 Test Acc: 0.650
Validation loss decreased (-0.584360 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 1.1943912506103516
Epoch: 7, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.179 Vali Acc: 0.713 Test Loss: 1.179 Test Acc: 0.713
Validation loss decreased (-0.649987 --> -0.712488).  Saving model ...
Epoch: 8 cost time: 1.3528575897216797
Epoch: 8, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.059 Vali Acc: 0.728 Test Loss: 1.059 Test Acc: 0.728
Validation loss decreased (-0.712488 --> -0.728114).  Saving model ...
Epoch: 9 cost time: 1.2533869743347168
Epoch: 9, Steps: 8 | Train Loss: 1.005 Vali Loss: 0.964 Vali Acc: 0.741 Test Loss: 0.964 Test Acc: 0.741
Validation loss decreased (-0.728114 --> -0.740615).  Saving model ...
Epoch: 10 cost time: 1.1368210315704346
Epoch: 10, Steps: 8 | Train Loss: 0.971 Vali Loss: 0.880 Vali Acc: 0.762 Test Loss: 0.880 Test Acc: 0.762
Validation loss decreased (-0.740615 --> -0.762491).  Saving model ...
Epoch: 11 cost time: 1.1859891414642334
Epoch: 11, Steps: 8 | Train Loss: 0.829 Vali Loss: 0.812 Vali Acc: 0.772 Test Loss: 0.812 Test Acc: 0.772
Validation loss decreased (-0.762491 --> -0.771867).  Saving model ...
Epoch: 12 cost time: 1.0142371654510498
Epoch: 12, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.762 Vali Acc: 0.781 Test Loss: 0.762 Test Acc: 0.781
Validation loss decreased (-0.771867 --> -0.781242).  Saving model ...
Epoch: 13 cost time: 1.312913417816162
Epoch: 13, Steps: 8 | Train Loss: 0.684 Vali Loss: 0.723 Vali Acc: 0.781 Test Loss: 0.723 Test Acc: 0.781
Validation loss decreased (-0.781242 --> -0.781243).  Saving model ...
Epoch: 14 cost time: 1.280393123626709
Epoch: 14, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.679 Vali Acc: 0.791 Test Loss: 0.679 Test Acc: 0.791
Validation loss decreased (-0.781243 --> -0.790618).  Saving model ...
Epoch: 15 cost time: 1.1709775924682617
Epoch: 15, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 16 cost time: 1.364989995956421
Epoch: 16, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 1.1744203567504883
Epoch: 17, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 1.3212740421295166
Epoch: 18, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.588 Vali Acc: 0.806 Test Loss: 0.588 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.806244).  Saving model ...
Epoch: 19 cost time: 1.1274151802062988
Epoch: 19, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 20 cost time: 1.0117714405059814
Epoch: 20, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 21 cost time: 1.123504638671875
Epoch: 21, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 22 cost time: 1.757223129272461
Epoch: 22, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821870).  Saving model ...
Epoch: 23 cost time: 1.3119983673095703
Epoch: 23, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 24 cost time: 1.0971605777740479
Epoch: 24, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 25 cost time: 1.3659112453460693
Epoch: 25, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 26 cost time: 1.151294231414795
Epoch: 26, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 27 cost time: 1.2362942695617676
Epoch: 27, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 28 cost time: 1.1186153888702393
Epoch: 28, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 29 cost time: 1.2494862079620361
Epoch: 29, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 30 cost time: 1.4072153568267822
Epoch: 30, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 31 cost time: 1.3388535976409912
Epoch: 31, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 32 cost time: 1.408571720123291
Epoch: 32, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.475 Vali Acc: 0.863 Test Loss: 0.475 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 33 cost time: 1.2848105430603027
Epoch: 33, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.474 Vali Acc: 0.859 Test Loss: 0.474 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4353394508361816
Epoch: 34, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8292028903961182
Epoch: 35, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9669713973999023
Epoch: 36, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0776336193084717
Epoch: 37, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2007298469543457
Epoch: 38, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2677760124206543
Epoch: 39, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0648021697998047
Epoch: 40, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.478851079940796
Epoch: 41, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.239807367324829
Epoch: 42, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 20680
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.36243748664856
Epoch: 1, Steps: 8 | Train Loss: 2.077 Vali Loss: 1.882 Vali Acc: 0.303 Test Loss: 1.882 Test Acc: 0.303
Validation loss decreased (inf --> -0.303106).  Saving model ...
Epoch: 2 cost time: 0.9947960376739502
Epoch: 2, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.376 Vali Acc: 0.691 Test Loss: 1.376 Test Acc: 0.691
Validation loss decreased (-0.303106 --> -0.690611).  Saving model ...
Epoch: 3 cost time: 0.8570542335510254
Epoch: 3, Steps: 8 | Train Loss: 1.211 Vali Loss: 0.953 Vali Acc: 0.791 Test Loss: 0.953 Test Acc: 0.791
Validation loss decreased (-0.690611 --> -0.790615).  Saving model ...
Epoch: 4 cost time: 1.0174164772033691
Epoch: 4, Steps: 8 | Train Loss: 0.847 Vali Loss: 0.708 Vali Acc: 0.806 Test Loss: 0.708 Test Acc: 0.806
Validation loss decreased (-0.790615 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 1.2047240734100342
Epoch: 5, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.0612208843231201
Epoch: 6, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 1.263451099395752
Epoch: 7, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 1.3025391101837158
Epoch: 8, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.9642064571380615
Epoch: 9, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 1.1284985542297363
Epoch: 10, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1030523777008057
Epoch: 11, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0667588710784912
Epoch: 12, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1825029850006104
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1459131240844727
Epoch: 14, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3278679847717285
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.602 Vali Acc: 0.834 Test Loss: 0.602 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4275312423706055
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.618 Vali Acc: 0.834 Test Loss: 0.618 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2930808067321777
Epoch: 17, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.646 Vali Acc: 0.841 Test Loss: 0.646 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9366869926452637
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.651 Vali Acc: 0.831 Test Loss: 0.651 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.163865089416504
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 68776
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5441317558288574
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 2.023 Vali Acc: 0.181 Test Loss: 2.023 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.0348870754241943
Epoch: 2, Steps: 8 | Train Loss: 1.894 Vali Loss: 1.766 Vali Acc: 0.338 Test Loss: 1.766 Test Acc: 0.338
Validation loss decreased (-0.181230 --> -0.337482).  Saving model ...
Epoch: 3 cost time: 1.1436598300933838
Epoch: 3, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.467 Vali Acc: 0.578 Test Loss: 1.467 Test Acc: 0.578
Validation loss decreased (-0.337482 --> -0.578110).  Saving model ...
Epoch: 4 cost time: 0.9183411598205566
Epoch: 4, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.172 Vali Acc: 0.700 Test Loss: 1.172 Test Acc: 0.700
Validation loss decreased (-0.578110 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 1.0852930545806885
Epoch: 5, Steps: 8 | Train Loss: 1.056 Vali Loss: 0.931 Vali Acc: 0.747 Test Loss: 0.931 Test Acc: 0.747
Validation loss decreased (-0.699988 --> -0.746866).  Saving model ...
Epoch: 6 cost time: 1.6120567321777344
Epoch: 6, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.757 Vali Acc: 0.778 Test Loss: 0.757 Test Acc: 0.778
Validation loss decreased (-0.746866 --> -0.778117).  Saving model ...
Epoch: 7 cost time: 1.1485893726348877
Epoch: 7, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.651 Vali Acc: 0.797 Test Loss: 0.651 Test Acc: 0.797
Validation loss decreased (-0.778117 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 1.0056288242340088
Epoch: 8, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.796868 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.9328820705413818
Epoch: 9, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.8557205200195312
Epoch: 10, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.821869 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.175358772277832
Epoch: 11, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.8921496868133545
Epoch: 12, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0716662406921387
Epoch: 13, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9076855182647705
Epoch: 14, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.977949857711792
Epoch: 15, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1796362400054932
Epoch: 16, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1748566627502441
Epoch: 17, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0577452182769775
Epoch: 18, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.026942253112793
Epoch: 19, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1186859607696533
Epoch: 20, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.574 Vali Acc: 0.831 Test Loss: 0.574 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.985112190246582
Epoch: 21, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 39080
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.505340337753296
Epoch: 1, Steps: 8 | Train Loss: 2.367 Vali Loss: 2.104 Vali Acc: 0.184 Test Loss: 2.104 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 1.24544095993042
Epoch: 2, Steps: 8 | Train Loss: 2.098 Vali Loss: 1.921 Vali Acc: 0.244 Test Loss: 1.921 Test Acc: 0.244
Validation loss decreased (-0.184354 --> -0.243731).  Saving model ...
Epoch: 3 cost time: 1.142646312713623
Epoch: 3, Steps: 8 | Train Loss: 1.835 Vali Loss: 1.668 Vali Acc: 0.416 Test Loss: 1.668 Test Acc: 0.416
Validation loss decreased (-0.243731 --> -0.415608).  Saving model ...
Epoch: 4 cost time: 1.2802937030792236
Epoch: 4, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.398 Vali Acc: 0.656 Test Loss: 1.398 Test Acc: 0.656
Validation loss decreased (-0.415608 --> -0.656236).  Saving model ...
Epoch: 5 cost time: 1.1245357990264893
Epoch: 5, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.143 Vali Acc: 0.781 Test Loss: 1.143 Test Acc: 0.781
Validation loss decreased (-0.656236 --> -0.781239).  Saving model ...
Epoch: 6 cost time: 0.8720529079437256
Epoch: 6, Steps: 8 | Train Loss: 1.103 Vali Loss: 0.932 Vali Acc: 0.803 Test Loss: 0.932 Test Acc: 0.803
Validation loss decreased (-0.781239 --> -0.803116).  Saving model ...
Epoch: 7 cost time: 1.087406873703003
Epoch: 7, Steps: 8 | Train Loss: 0.853 Vali Loss: 0.774 Vali Acc: 0.806 Test Loss: 0.774 Test Acc: 0.806
Validation loss decreased (-0.803116 --> -0.806242).  Saving model ...
Epoch: 8 cost time: 0.998354434967041
Epoch: 8, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
Validation loss decreased (-0.806242 --> -0.821868).  Saving model ...
Epoch: 9 cost time: 1.157820463180542
Epoch: 9, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9922525882720947
Epoch: 10, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824995).  Saving model ...
Epoch: 11 cost time: 1.1627392768859863
Epoch: 11, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 1.1899330615997314
Epoch: 12, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 0.9725518226623535
Epoch: 13, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.9723548889160156
Epoch: 14, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 1.2327661514282227
Epoch: 15, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.9422633647918701
Epoch: 16, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2532734870910645
Epoch: 17, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2202484607696533
Epoch: 18, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 1.3943140506744385
Epoch: 19, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1356496810913086
Epoch: 20, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2166521549224854
Epoch: 21, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8691935539245605
Epoch: 22, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8081610202789307
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8684337139129639
Epoch: 24, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9119982719421387
Epoch: 25, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.959977388381958
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1893208026885986
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3064255714416504
Epoch: 28, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 29352
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.088968276977539
Epoch: 1, Steps: 8 | Train Loss: 2.076 Vali Loss: 2.020 Vali Acc: 0.287 Test Loss: 2.020 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 1.068122386932373
Epoch: 2, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.893 Vali Acc: 0.341 Test Loss: 1.893 Test Acc: 0.341
Validation loss decreased (-0.287480 --> -0.340606).  Saving model ...
Epoch: 3 cost time: 1.1024093627929688
Epoch: 3, Steps: 8 | Train Loss: 1.775 Vali Loss: 1.707 Vali Acc: 0.444 Test Loss: 1.707 Test Acc: 0.444
Validation loss decreased (-0.340606 --> -0.443733).  Saving model ...
Epoch: 4 cost time: 1.0986626148223877
Epoch: 4, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.494 Vali Acc: 0.600 Test Loss: 1.494 Test Acc: 0.600
Validation loss decreased (-0.443733 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 1.1965830326080322
Epoch: 5, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.281 Vali Acc: 0.669 Test Loss: 1.281 Test Acc: 0.669
Validation loss decreased (-0.599985 --> -0.668737).  Saving model ...
Epoch: 6 cost time: 1.2973284721374512
Epoch: 6, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.087 Vali Acc: 0.753 Test Loss: 1.087 Test Acc: 0.753
Validation loss decreased (-0.668737 --> -0.753114).  Saving model ...
Epoch: 7 cost time: 1.0788319110870361
Epoch: 7, Steps: 8 | Train Loss: 0.991 Vali Loss: 0.922 Vali Acc: 0.784 Test Loss: 0.922 Test Acc: 0.784
Validation loss decreased (-0.753114 --> -0.784366).  Saving model ...
Epoch: 8 cost time: 1.1514439582824707
Epoch: 8, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.784366 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.1985974311828613
Epoch: 9, Steps: 8 | Train Loss: 0.689 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 10 cost time: 1.1565754413604736
Epoch: 10, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 1.4886436462402344
Epoch: 11, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2522854804992676
Epoch: 12, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.415085792541504
Epoch: 13, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 1.2058391571044922
Epoch: 14, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3648970127105713
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 1.345210313796997
Epoch: 16, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 1.3098673820495605
Epoch: 17, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 1.1721680164337158
Epoch: 18, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1723167896270752
Epoch: 19, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1279032230377197
Epoch: 20, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1722471714019775
Epoch: 21, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3814697265625
Epoch: 22, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4267394542694092
Epoch: 23, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5490572452545166
Epoch: 24, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3712048530578613
Epoch: 25, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1135215759277344
Epoch: 26, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1017568111419678
Epoch: 27, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 24232
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.406805038452148
Epoch: 1, Steps: 8 | Train Loss: 2.231 Vali Loss: 2.069 Vali Acc: 0.116 Test Loss: 2.069 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.9643230438232422
Epoch: 2, Steps: 8 | Train Loss: 2.103 Vali Loss: 1.954 Vali Acc: 0.206 Test Loss: 1.954 Test Acc: 0.206
Validation loss decreased (-0.115604 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 1.3829355239868164
Epoch: 3, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.792 Vali Acc: 0.341 Test Loss: 1.792 Test Acc: 0.341
Validation loss decreased (-0.206230 --> -0.340607).  Saving model ...
Epoch: 4 cost time: 0.9303886890411377
Epoch: 4, Steps: 8 | Train Loss: 1.798 Vali Loss: 1.602 Vali Acc: 0.519 Test Loss: 1.602 Test Acc: 0.519
Validation loss decreased (-0.340607 --> -0.518734).  Saving model ...
Epoch: 5 cost time: 1.2041375637054443
Epoch: 5, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.411 Vali Acc: 0.656 Test Loss: 1.411 Test Acc: 0.656
Validation loss decreased (-0.518734 --> -0.656236).  Saving model ...
Epoch: 6 cost time: 1.3685481548309326
Epoch: 6, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.227 Vali Acc: 0.750 Test Loss: 1.227 Test Acc: 0.750
Validation loss decreased (-0.656236 --> -0.749988).  Saving model ...
Epoch: 7 cost time: 1.3863694667816162
Epoch: 7, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.061 Vali Acc: 0.784 Test Loss: 1.061 Test Acc: 0.784
Validation loss decreased (-0.749988 --> -0.784364).  Saving model ...
Epoch: 8 cost time: 1.2591121196746826
Epoch: 8, Steps: 8 | Train Loss: 1.038 Vali Loss: 0.927 Vali Acc: 0.803 Test Loss: 0.927 Test Acc: 0.803
Validation loss decreased (-0.784364 --> -0.803116).  Saving model ...
Epoch: 9 cost time: 1.1305382251739502
Epoch: 9, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.816 Vali Acc: 0.812 Test Loss: 0.816 Test Acc: 0.812
Validation loss decreased (-0.803116 --> -0.812492).  Saving model ...
Epoch: 10 cost time: 1.1011598110198975
Epoch: 10, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.731 Vali Acc: 0.816 Test Loss: 0.731 Test Acc: 0.816
Validation loss decreased (-0.812492 --> -0.815618).  Saving model ...
Epoch: 11 cost time: 1.0065186023712158
Epoch: 11, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818743).  Saving model ...
Epoch: 12 cost time: 0.9947688579559326
Epoch: 12, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.1918444633483887
Epoch: 13, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.582 Vali Acc: 0.831 Test Loss: 0.582 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.229262113571167
Epoch: 14, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1647474765777588
Epoch: 15, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1850581169128418
Epoch: 16, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9463598728179932
Epoch: 17, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2876572608947754
Epoch: 18, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 1.2435276508331299
Epoch: 19, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5526444911956787
Epoch: 20, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1637089252471924
Epoch: 21, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.511 Vali Acc: 0.828 Test Loss: 0.511 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9588150978088379
Epoch: 22, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1819956302642822
Epoch: 23, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0814673900604248
Epoch: 24, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2785608768463135
Epoch: 25, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1930909156799316
Epoch: 26, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2158052921295166
Epoch: 27, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1315934658050537
Epoch: 28, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 20136
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.108628988265991
Epoch: 1, Steps: 8 | Train Loss: 2.164 Vali Loss: 2.088 Vali Acc: 0.181 Test Loss: 2.088 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 0.9530539512634277
Epoch: 2, Steps: 8 | Train Loss: 2.099 Vali Loss: 1.997 Vali Acc: 0.212 Test Loss: 1.997 Test Acc: 0.212
Validation loss decreased (-0.181229 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 1.2980468273162842
Epoch: 3, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.862 Vali Acc: 0.281 Test Loss: 1.862 Test Acc: 0.281
Validation loss decreased (-0.212480 --> -0.281231).  Saving model ...
Epoch: 4 cost time: 1.1630427837371826
Epoch: 4, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.696 Vali Acc: 0.416 Test Loss: 1.696 Test Acc: 0.416
Validation loss decreased (-0.281231 --> -0.415608).  Saving model ...
Epoch: 5 cost time: 1.172072410583496
Epoch: 5, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.524 Vali Acc: 0.503 Test Loss: 1.524 Test Acc: 0.503
Validation loss decreased (-0.415608 --> -0.503110).  Saving model ...
Epoch: 6 cost time: 1.2750442028045654
Epoch: 6, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.358 Vali Acc: 0.606 Test Loss: 1.358 Test Acc: 0.606
Validation loss decreased (-0.503110 --> -0.606236).  Saving model ...
Epoch: 7 cost time: 1.0299384593963623
Epoch: 7, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
Validation loss decreased (-0.606236 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.8257627487182617
Epoch: 8, Steps: 8 | Train Loss: 1.085 Vali Loss: 1.058 Vali Acc: 0.750 Test Loss: 1.058 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 1.0196592807769775
Epoch: 9, Steps: 8 | Train Loss: 0.969 Vali Loss: 0.933 Vali Acc: 0.769 Test Loss: 0.933 Test Acc: 0.769
Validation loss decreased (-0.749989 --> -0.768741).  Saving model ...
Epoch: 10 cost time: 1.0347158908843994
Epoch: 10, Steps: 8 | Train Loss: 0.872 Vali Loss: 0.835 Vali Acc: 0.784 Test Loss: 0.835 Test Acc: 0.784
Validation loss decreased (-0.768741 --> -0.784367).  Saving model ...
Epoch: 11 cost time: 1.1014044284820557
Epoch: 11, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.754 Vali Acc: 0.794 Test Loss: 0.754 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793742).  Saving model ...
Epoch: 12 cost time: 1.0280299186706543
Epoch: 12, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.689 Vali Acc: 0.812 Test Loss: 0.689 Test Acc: 0.812
Validation loss decreased (-0.793742 --> -0.812493).  Saving model ...
Epoch: 13 cost time: 0.8949477672576904
Epoch: 13, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.646 Vali Acc: 0.816 Test Loss: 0.646 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 14 cost time: 1.1764750480651855
Epoch: 14, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 15 cost time: 1.059159278869629
Epoch: 15, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 0.94962477684021
Epoch: 16, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 1.0471384525299072
Epoch: 17, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 1.044184923171997
Epoch: 18, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 19 cost time: 1.148660659790039
Epoch: 19, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 0.8796935081481934
Epoch: 20, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 1.1176903247833252
Epoch: 21, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3245024681091309
Epoch: 22, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1609210968017578
Epoch: 23, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.498 Vali Acc: 0.831 Test Loss: 0.498 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1112010478973389
Epoch: 24, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1888315677642822
Epoch: 25, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.488 Vali Acc: 0.831 Test Loss: 0.488 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0721189975738525
Epoch: 26, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.474 Vali Acc: 0.834 Test Loss: 0.474 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1920206546783447
Epoch: 27, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.467 Vali Acc: 0.838 Test Loss: 0.467 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 28 cost time: 1.310492753982544
Epoch: 28, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 29 cost time: 1.0967206954956055
Epoch: 29, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8732264041900635
Epoch: 30, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0170562267303467
Epoch: 31, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0619158744812012
Epoch: 32, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 1.0092992782592773
Epoch: 33, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 34 cost time: 1.0643970966339111
Epoch: 34, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 0.8874349594116211
Epoch: 35, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 36 cost time: 1.2981374263763428
Epoch: 36, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6274735927581787
Epoch: 37, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4390528202056885
Epoch: 38, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0680134296417236
Epoch: 39, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2255785465240479
Epoch: 40, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.224877119064331
Epoch: 41, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8565654754638672
Epoch: 42, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 1.0231010913848877
Epoch: 43, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.869511604309082
Epoch: 44, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.939063549041748
Epoch: 45, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.093970537185669
Epoch: 46, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.008624792098999
Epoch: 47, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0947036743164062
Epoch: 48, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1841235160827637
Epoch: 49, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.298203468322754
Epoch: 50, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2210276126861572
Epoch: 51, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.304551362991333
Epoch: 52, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 17544
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.05189323425293
Epoch: 1, Steps: 8 | Train Loss: 2.239 Vali Loss: 2.126 Vali Acc: 0.191 Test Loss: 2.126 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 0.9748885631561279
Epoch: 2, Steps: 8 | Train Loss: 2.102 Vali Loss: 2.043 Vali Acc: 0.228 Test Loss: 2.043 Test Acc: 0.228
Validation loss decreased (-0.190604 --> -0.228105).  Saving model ...
Epoch: 3 cost time: 1.0499708652496338
Epoch: 3, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.916 Vali Acc: 0.319 Test Loss: 1.916 Test Acc: 0.319
Validation loss decreased (-0.228105 --> -0.318731).  Saving model ...
Epoch: 4 cost time: 0.8743729591369629
Epoch: 4, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.767 Vali Acc: 0.428 Test Loss: 1.767 Test Acc: 0.428
Validation loss decreased (-0.318731 --> -0.428107).  Saving model ...
Epoch: 5 cost time: 1.0651516914367676
Epoch: 5, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.616 Vali Acc: 0.472 Test Loss: 1.616 Test Acc: 0.472
Validation loss decreased (-0.428107 --> -0.471859).  Saving model ...
Epoch: 6 cost time: 1.0160763263702393
Epoch: 6, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.468 Vali Acc: 0.553 Test Loss: 1.468 Test Acc: 0.553
Validation loss decreased (-0.471859 --> -0.553110).  Saving model ...
Epoch: 7 cost time: 1.283595085144043
Epoch: 7, Steps: 8 | Train Loss: 1.395 Vali Loss: 1.329 Vali Acc: 0.647 Test Loss: 1.329 Test Acc: 0.647
Validation loss decreased (-0.553110 --> -0.646862).  Saving model ...
Epoch: 8 cost time: 0.956784725189209
Epoch: 8, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.201 Vali Acc: 0.719 Test Loss: 1.201 Test Acc: 0.719
Validation loss decreased (-0.646862 --> -0.718738).  Saving model ...
Epoch: 9 cost time: 0.9792454242706299
Epoch: 9, Steps: 8 | Train Loss: 1.145 Vali Loss: 1.084 Vali Acc: 0.744 Test Loss: 1.084 Test Acc: 0.744
Validation loss decreased (-0.718738 --> -0.743739).  Saving model ...
Epoch: 10 cost time: 1.0913655757904053
Epoch: 10, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.987 Vali Acc: 0.762 Test Loss: 0.987 Test Acc: 0.762
Validation loss decreased (-0.743739 --> -0.762490).  Saving model ...
Epoch: 11 cost time: 0.976628303527832
Epoch: 11, Steps: 8 | Train Loss: 0.892 Vali Loss: 0.903 Vali Acc: 0.766 Test Loss: 0.903 Test Acc: 0.766
Validation loss decreased (-0.762490 --> -0.765616).  Saving model ...
Epoch: 12 cost time: 0.9576551914215088
Epoch: 12, Steps: 8 | Train Loss: 0.839 Vali Loss: 0.834 Vali Acc: 0.778 Test Loss: 0.834 Test Acc: 0.778
Validation loss decreased (-0.765616 --> -0.778117).  Saving model ...
Epoch: 13 cost time: 0.8500139713287354
Epoch: 13, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.784 Vali Acc: 0.781 Test Loss: 0.784 Test Acc: 0.781
Validation loss decreased (-0.778117 --> -0.781242).  Saving model ...
Epoch: 14 cost time: 0.9804432392120361
Epoch: 14, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.734 Vali Acc: 0.797 Test Loss: 0.734 Test Acc: 0.797
Validation loss decreased (-0.781242 --> -0.796868).  Saving model ...
Epoch: 15 cost time: 1.0940985679626465
Epoch: 15, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.698 Vali Acc: 0.797 Test Loss: 0.698 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 16 cost time: 1.081573724746704
Epoch: 16, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.673 Vali Acc: 0.797 Test Loss: 0.673 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 17 cost time: 0.9377236366271973
Epoch: 17, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.649 Vali Acc: 0.794 Test Loss: 0.649 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0614221096038818
Epoch: 18, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.632 Vali Acc: 0.794 Test Loss: 0.632 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9560749530792236
Epoch: 19, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.618 Vali Acc: 0.797 Test Loss: 0.618 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796869).  Saving model ...
Epoch: 20 cost time: 1.1583218574523926
Epoch: 20, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
Validation loss decreased (-0.796869 --> -0.806244).  Saving model ...
Epoch: 21 cost time: 1.0145299434661865
Epoch: 21, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.589 Vali Acc: 0.806 Test Loss: 0.589 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 22 cost time: 0.9848117828369141
Epoch: 22, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 23 cost time: 0.9087746143341064
Epoch: 23, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 24 cost time: 1.017190933227539
Epoch: 24, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 25 cost time: 0.9418253898620605
Epoch: 25, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 26 cost time: 0.9144458770751953
Epoch: 26, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3332719802856445
Epoch: 27, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 28 cost time: 0.9065570831298828
Epoch: 28, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1536962985992432
Epoch: 29, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 30 cost time: 0.9091556072235107
Epoch: 30, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 31 cost time: 1.1419379711151123
Epoch: 31, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2617785930633545
Epoch: 32, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0166659355163574
Epoch: 33, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 34 cost time: 1.1739516258239746
Epoch: 34, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 35 cost time: 0.9453449249267578
Epoch: 35, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9192094802856445
Epoch: 36, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1607484817504883
Epoch: 37, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0458965301513672
Epoch: 38, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.039189338684082
Epoch: 39, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 40 cost time: 1.2647521495819092
Epoch: 40, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.497 Vali Acc: 0.834 Test Loss: 0.497 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.05902099609375
Epoch: 41, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0364656448364258
Epoch: 42, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0419607162475586
Epoch: 43, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9437494277954102
Epoch: 44, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2674939632415771
Epoch: 45, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 46 cost time: 1.3061292171478271
Epoch: 46, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.211042881011963
Epoch: 47, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.098221778869629
Epoch: 48, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1178674697875977
Epoch: 49, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.093163013458252
Epoch: 50, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 51 cost time: 1.2577931880950928
Epoch: 51, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 52 cost time: 1.1546237468719482
Epoch: 52, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.6897668838500977
Epoch: 53, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.4145615100860596
Epoch: 54, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.08711576461792
Epoch: 55, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1243066787719727
Epoch: 56, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.189668893814087
Epoch: 57, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.1849427223205566
Epoch: 58, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9754173755645752
Epoch: 59, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.1622564792633057
Epoch: 60, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.9441883563995361
Epoch: 61, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 62 cost time: 1.4097306728363037
Epoch: 62, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 63 cost time: 1.432607889175415
Epoch: 63, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7572104930877686
Epoch: 64, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.912752628326416
Epoch: 65, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1713407039642334
Epoch: 66, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 67 cost time: 0.9065835475921631
Epoch: 67, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.018080234527588
Epoch: 68, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.5307798385620117
Epoch: 69, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.5236587524414062
Epoch: 70, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.3312492370605469
Epoch: 71, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.0128424167633057
Epoch: 72, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.196176528930664
Epoch: 73, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.0595057010650635
Epoch: 74, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.221264123916626
Epoch: 75, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.1427688598632812
Epoch: 76, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm32_nh4_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 16520
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.074587345123291
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 2.010 Vali Acc: 0.144 Test Loss: 2.010 Test Acc: 0.144
Validation loss decreased (inf --> -0.143730).  Saving model ...
Epoch: 2 cost time: 1.2602193355560303
Epoch: 2, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.722 Vali Acc: 0.494 Test Loss: 1.722 Test Acc: 0.494
Validation loss decreased (-0.143730 --> -0.493733).  Saving model ...
Epoch: 3 cost time: 1.003659725189209
Epoch: 3, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.398 Vali Acc: 0.669 Test Loss: 1.398 Test Acc: 0.669
Validation loss decreased (-0.493733 --> -0.668736).  Saving model ...
Epoch: 4 cost time: 1.0146763324737549
Epoch: 4, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.086 Vali Acc: 0.759 Test Loss: 1.086 Test Acc: 0.759
Validation loss decreased (-0.668736 --> -0.759364).  Saving model ...
Epoch: 5 cost time: 1.154651165008545
Epoch: 5, Steps: 8 | Train Loss: 1.033 Vali Loss: 0.845 Vali Acc: 0.809 Test Loss: 0.845 Test Acc: 0.809
Validation loss decreased (-0.759364 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 1.083014726638794
Epoch: 6, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
Validation loss decreased (-0.809367 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 1.1817052364349365
Epoch: 7, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.595 Vali Acc: 0.834 Test Loss: 0.595 Test Acc: 0.834
Validation loss decreased (-0.821868 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 1.0060608386993408
Epoch: 8, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0603880882263184
Epoch: 9, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 1.277395248413086
Epoch: 10, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 1.1742784976959229
Epoch: 11, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.8592226505279541
Epoch: 12, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9633889198303223
Epoch: 13, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0675463676452637
Epoch: 14, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9282605648040771
Epoch: 15, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0177533626556396
Epoch: 16, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 17 cost time: 1.0002877712249756
Epoch: 17, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9035120010375977
Epoch: 18, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9767765998840332
Epoch: 19, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8998186588287354
Epoch: 20, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0033864974975586
Epoch: 21, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9628698825836182
Epoch: 22, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1318442821502686
Epoch: 23, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9164414405822754
Epoch: 24, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.574 Vali Acc: 0.847 Test Loss: 0.574 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0111761093139648
Epoch: 25, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1976263523101807
Epoch: 26, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.594 Vali Acc: 0.847 Test Loss: 0.594 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 39736
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.431093215942383
Epoch: 1, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.987 Vali Acc: 0.212 Test Loss: 1.987 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 1.1860647201538086
Epoch: 2, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.837 Vali Acc: 0.384 Test Loss: 1.837 Test Acc: 0.384
Validation loss decreased (-0.212480 --> -0.384357).  Saving model ...
Epoch: 3 cost time: 0.8716437816619873
Epoch: 3, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.629 Vali Acc: 0.566 Test Loss: 1.629 Test Acc: 0.566
Validation loss decreased (-0.384357 --> -0.565609).  Saving model ...
Epoch: 4 cost time: 1.0967488288879395
Epoch: 4, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.408 Vali Acc: 0.666 Test Loss: 1.408 Test Acc: 0.666
Validation loss decreased (-0.565609 --> -0.665611).  Saving model ...
Epoch: 5 cost time: 1.1331653594970703
Epoch: 5, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.202 Vali Acc: 0.716 Test Loss: 1.202 Test Acc: 0.716
Validation loss decreased (-0.665611 --> -0.715613).  Saving model ...
Epoch: 6 cost time: 0.9240684509277344
Epoch: 6, Steps: 8 | Train Loss: 1.097 Vali Loss: 1.015 Vali Acc: 0.753 Test Loss: 1.015 Test Acc: 0.753
Validation loss decreased (-0.715613 --> -0.753115).  Saving model ...
Epoch: 7 cost time: 1.390559434890747
Epoch: 7, Steps: 8 | Train Loss: 0.918 Vali Loss: 0.872 Vali Acc: 0.769 Test Loss: 0.872 Test Acc: 0.769
Validation loss decreased (-0.753115 --> -0.768741).  Saving model ...
Epoch: 8 cost time: 1.1430442333221436
Epoch: 8, Steps: 8 | Train Loss: 0.779 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.768741 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.9462652206420898
Epoch: 9, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.665 Vali Acc: 0.822 Test Loss: 0.665 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.821868).  Saving model ...
Epoch: 10 cost time: 1.0773305892944336
Epoch: 10, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.611 Vali Acc: 0.812 Test Loss: 0.611 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1500766277313232
Epoch: 11, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0411522388458252
Epoch: 12, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.567 Vali Acc: 0.812 Test Loss: 0.567 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.186288833618164
Epoch: 13, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1899168491363525
Epoch: 14, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831245).  Saving model ...
Epoch: 15 cost time: 1.0534424781799316
Epoch: 15, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 1.2291474342346191
Epoch: 16, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.330472707748413
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 1.0752801895141602
Epoch: 18, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.095038652420044
Epoch: 19, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3754732608795166
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 21 cost time: 1.1258363723754883
Epoch: 21, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 1.0795960426330566
Epoch: 22, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.9089136123657227
Epoch: 23, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2074286937713623
Epoch: 24, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1397833824157715
Epoch: 25, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1501448154449463
Epoch: 26, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.554 Vali Acc: 0.847 Test Loss: 0.554 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0402445793151855
Epoch: 27, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2239272594451904
Epoch: 28, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1987318992614746
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9969556331634521
Epoch: 30, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1111667156219482
Epoch: 31, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8956348896026611
Epoch: 32, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 24888
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9685757160186768
Epoch: 1, Steps: 8 | Train Loss: 2.328 Vali Loss: 2.178 Vali Acc: 0.069 Test Loss: 2.178 Test Acc: 0.069
Validation loss decreased (inf --> -0.068728).  Saving model ...
Epoch: 2 cost time: 1.1494157314300537
Epoch: 2, Steps: 8 | Train Loss: 2.269 Vali Loss: 2.086 Vali Acc: 0.153 Test Loss: 2.086 Test Acc: 0.153
Validation loss decreased (-0.068728 --> -0.153104).  Saving model ...
Epoch: 3 cost time: 1.2940254211425781
Epoch: 3, Steps: 8 | Train Loss: 2.194 Vali Loss: 1.949 Vali Acc: 0.241 Test Loss: 1.949 Test Acc: 0.241
Validation loss decreased (-0.153104 --> -0.240606).  Saving model ...
Epoch: 4 cost time: 1.2046902179718018
Epoch: 4, Steps: 8 | Train Loss: 1.995 Vali Loss: 1.785 Vali Acc: 0.353 Test Loss: 1.785 Test Acc: 0.353
Validation loss decreased (-0.240606 --> -0.353107).  Saving model ...
Epoch: 5 cost time: 1.2292072772979736
Epoch: 5, Steps: 8 | Train Loss: 1.794 Vali Loss: 1.609 Vali Acc: 0.531 Test Loss: 1.609 Test Acc: 0.531
Validation loss decreased (-0.353107 --> -0.531234).  Saving model ...
Epoch: 6 cost time: 1.3412210941314697
Epoch: 6, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.420 Vali Acc: 0.656 Test Loss: 1.420 Test Acc: 0.656
Validation loss decreased (-0.531234 --> -0.656236).  Saving model ...
Epoch: 7 cost time: 1.2442903518676758
Epoch: 7, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.239 Vali Acc: 0.694 Test Loss: 1.239 Test Acc: 0.694
Validation loss decreased (-0.656236 --> -0.693738).  Saving model ...
Epoch: 8 cost time: 1.3474195003509521
Epoch: 8, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.073 Vali Acc: 0.738 Test Loss: 1.073 Test Acc: 0.738
Validation loss decreased (-0.693738 --> -0.737489).  Saving model ...
Epoch: 9 cost time: 1.1244802474975586
Epoch: 9, Steps: 8 | Train Loss: 1.080 Vali Loss: 0.933 Vali Acc: 0.769 Test Loss: 0.933 Test Acc: 0.769
Validation loss decreased (-0.737489 --> -0.768741).  Saving model ...
Epoch: 10 cost time: 1.378758192062378
Epoch: 10, Steps: 8 | Train Loss: 0.887 Vali Loss: 0.824 Vali Acc: 0.778 Test Loss: 0.824 Test Acc: 0.778
Validation loss decreased (-0.768741 --> -0.778117).  Saving model ...
Epoch: 11 cost time: 1.1565845012664795
Epoch: 11, Steps: 8 | Train Loss: 0.769 Vali Loss: 0.731 Vali Acc: 0.791 Test Loss: 0.731 Test Acc: 0.791
Validation loss decreased (-0.778117 --> -0.790618).  Saving model ...
Epoch: 12 cost time: 1.2794268131256104
Epoch: 12, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 13 cost time: 1.4680566787719727
Epoch: 13, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799994).  Saving model ...
Epoch: 14 cost time: 1.829833745956421
Epoch: 14, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.799994 --> -0.809369).  Saving model ...
Epoch: 15 cost time: 1.5836281776428223
Epoch: 15, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 16 cost time: 0.9783279895782471
Epoch: 16, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.556 Vali Acc: 0.812 Test Loss: 0.556 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 17 cost time: 1.122267484664917
Epoch: 17, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821870).  Saving model ...
Epoch: 18 cost time: 1.001706838607788
Epoch: 18, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3114149570465088
Epoch: 19, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 20 cost time: 1.1147284507751465
Epoch: 20, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
Validation loss decreased (-0.821870 --> -0.834370).  Saving model ...
Epoch: 21 cost time: 1.0007901191711426
Epoch: 21, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2106602191925049
Epoch: 22, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 23 cost time: 1.4531714916229248
Epoch: 23, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3247654438018799
Epoch: 24, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2485740184783936
Epoch: 25, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.384455680847168
Epoch: 26, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5048229694366455
Epoch: 27, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.402017593383789
Epoch: 28, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8955044746398926
Epoch: 29, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2848412990570068
Epoch: 30, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3024945259094238
Epoch: 31, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 32 cost time: 1.3404245376586914
Epoch: 32, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3042051792144775
Epoch: 33, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 34 cost time: 0.9337074756622314
Epoch: 34, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 35 cost time: 1.3133835792541504
Epoch: 35, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1513397693634033
Epoch: 36, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2761428356170654
Epoch: 37, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1230757236480713
Epoch: 38, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1315677165985107
Epoch: 39, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.42689847946167
Epoch: 40, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.423938274383545
Epoch: 41, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3381900787353516
Epoch: 42, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1373865604400635
Epoch: 43, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9094934463500977
Epoch: 44, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 20024
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.677401065826416
Epoch: 1, Steps: 8 | Train Loss: 2.248 Vali Loss: 2.122 Vali Acc: 0.134 Test Loss: 2.122 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.3672916889190674
Epoch: 2, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.042 Vali Acc: 0.219 Test Loss: 2.042 Test Acc: 0.219
Validation loss decreased (-0.134354 --> -0.218730).  Saving model ...
Epoch: 3 cost time: 1.4621059894561768
Epoch: 3, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.924 Vali Acc: 0.281 Test Loss: 1.924 Test Acc: 0.281
Validation loss decreased (-0.218730 --> -0.281231).  Saving model ...
Epoch: 4 cost time: 1.269756555557251
Epoch: 4, Steps: 8 | Train Loss: 1.931 Vali Loss: 1.786 Vali Acc: 0.409 Test Loss: 1.786 Test Acc: 0.409
Validation loss decreased (-0.281231 --> -0.409357).  Saving model ...
Epoch: 5 cost time: 1.167389154434204
Epoch: 5, Steps: 8 | Train Loss: 1.728 Vali Loss: 1.631 Vali Acc: 0.516 Test Loss: 1.631 Test Acc: 0.516
Validation loss decreased (-0.409357 --> -0.515609).  Saving model ...
Epoch: 6 cost time: 1.4446995258331299
Epoch: 6, Steps: 8 | Train Loss: 1.595 Vali Loss: 1.472 Vali Acc: 0.622 Test Loss: 1.472 Test Acc: 0.622
Validation loss decreased (-0.515609 --> -0.621860).  Saving model ...
Epoch: 7 cost time: 1.543363332748413
Epoch: 7, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.316 Vali Acc: 0.694 Test Loss: 1.316 Test Acc: 0.694
Validation loss decreased (-0.621860 --> -0.693737).  Saving model ...
Epoch: 8 cost time: 1.5248534679412842
Epoch: 8, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.171 Vali Acc: 0.734 Test Loss: 1.171 Test Acc: 0.734
Validation loss decreased (-0.693737 --> -0.734363).  Saving model ...
Epoch: 9 cost time: 1.0280706882476807
Epoch: 9, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.036 Vali Acc: 0.762 Test Loss: 1.036 Test Acc: 0.762
Validation loss decreased (-0.734363 --> -0.762490).  Saving model ...
Epoch: 10 cost time: 1.1048991680145264
Epoch: 10, Steps: 8 | Train Loss: 1.001 Vali Loss: 0.924 Vali Acc: 0.784 Test Loss: 0.924 Test Acc: 0.784
Validation loss decreased (-0.762490 --> -0.784366).  Saving model ...
Epoch: 11 cost time: 1.2900848388671875
Epoch: 11, Steps: 8 | Train Loss: 0.879 Vali Loss: 0.829 Vali Acc: 0.787 Test Loss: 0.829 Test Acc: 0.787
Validation loss decreased (-0.784366 --> -0.787492).  Saving model ...
Epoch: 12 cost time: 1.270000696182251
Epoch: 12, Steps: 8 | Train Loss: 0.735 Vali Loss: 0.753 Vali Acc: 0.800 Test Loss: 0.753 Test Acc: 0.800
Validation loss decreased (-0.787492 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.428954839706421
Epoch: 13, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.698 Vali Acc: 0.791 Test Loss: 0.698 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.342726469039917
Epoch: 14, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.659 Vali Acc: 0.794 Test Loss: 0.659 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1648650169372559
Epoch: 15, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.621 Vali Acc: 0.797 Test Loss: 0.621 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1557950973510742
Epoch: 16, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
Validation loss decreased (-0.799992 --> -0.803119).  Saving model ...
Epoch: 17 cost time: 0.9122743606567383
Epoch: 17, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 18 cost time: 1.3450281620025635
Epoch: 18, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
Validation loss decreased (-0.803119 --> -0.815619).  Saving model ...
Epoch: 19 cost time: 1.1000421047210693
Epoch: 19, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 20 cost time: 0.9379310607910156
Epoch: 20, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.271043300628662
Epoch: 21, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 22 cost time: 1.1456356048583984
Epoch: 22, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1130049228668213
Epoch: 23, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0727968215942383
Epoch: 24, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.524 Vali Acc: 0.812 Test Loss: 0.524 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9862089157104492
Epoch: 25, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.110840082168579
Epoch: 26, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2014193534851074
Epoch: 27, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9361827373504639
Epoch: 28, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8916692733764648
Epoch: 29, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8959100246429443
Epoch: 30, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.021709680557251
Epoch: 31, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
Validation loss decreased (-0.821870 --> -0.834370).  Saving model ...
Epoch: 32 cost time: 1.1804022789001465
Epoch: 32, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2205326557159424
Epoch: 33, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0492310523986816
Epoch: 34, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.061021327972412
Epoch: 35, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.082165002822876
Epoch: 36, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1850800514221191
Epoch: 37, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.261627197265625
Epoch: 38, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9721226692199707
Epoch: 39, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9916751384735107
Epoch: 40, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 41 cost time: 1.0585520267486572
Epoch: 41, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3288166522979736
Epoch: 42, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2712481021881104
Epoch: 43, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2856841087341309
Epoch: 44, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.460071086883545
Epoch: 45, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 46 cost time: 1.1745193004608154
Epoch: 46, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 47 cost time: 1.1557214260101318
Epoch: 47, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1912128925323486
Epoch: 48, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2889013290405273
Epoch: 49, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.931464672088623
Epoch: 50, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0144867897033691
Epoch: 51, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8943932056427002
Epoch: 52, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.0095181465148926
Epoch: 53, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0295846462249756
Epoch: 54, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0612363815307617
Epoch: 55, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.6991159915924072
Epoch: 56, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 17464
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8593204021453857
Epoch: 1, Steps: 8 | Train Loss: 2.159 Vali Loss: 2.106 Vali Acc: 0.147 Test Loss: 2.106 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 1.0777406692504883
Epoch: 2, Steps: 8 | Train Loss: 2.043 Vali Loss: 2.032 Vali Acc: 0.206 Test Loss: 2.032 Test Acc: 0.206
Validation loss decreased (-0.146854 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 0.8834154605865479
Epoch: 3, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.937 Vali Acc: 0.300 Test Loss: 1.937 Test Acc: 0.300
Validation loss decreased (-0.206230 --> -0.299981).  Saving model ...
Epoch: 4 cost time: 1.1475410461425781
Epoch: 4, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.823 Vali Acc: 0.400 Test Loss: 1.823 Test Acc: 0.400
Validation loss decreased (-0.299981 --> -0.399982).  Saving model ...
Epoch: 5 cost time: 0.9369897842407227
Epoch: 5, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.694 Vali Acc: 0.512 Test Loss: 1.694 Test Acc: 0.512
Validation loss decreased (-0.399982 --> -0.512483).  Saving model ...
Epoch: 6 cost time: 1.1876130104064941
Epoch: 6, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.564 Vali Acc: 0.578 Test Loss: 1.564 Test Acc: 0.578
Validation loss decreased (-0.512483 --> -0.578109).  Saving model ...
Epoch: 7 cost time: 1.0385725498199463
Epoch: 7, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.429 Vali Acc: 0.659 Test Loss: 1.429 Test Acc: 0.659
Validation loss decreased (-0.578109 --> -0.659361).  Saving model ...
Epoch: 8 cost time: 1.0880961418151855
Epoch: 8, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.304 Vali Acc: 0.700 Test Loss: 1.304 Test Acc: 0.700
Validation loss decreased (-0.659361 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.136131763458252
Epoch: 9, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.184 Vali Acc: 0.716 Test Loss: 1.184 Test Acc: 0.716
Validation loss decreased (-0.699987 --> -0.715613).  Saving model ...
Epoch: 10 cost time: 0.9656698703765869
Epoch: 10, Steps: 8 | Train Loss: 1.101 Vali Loss: 1.080 Vali Acc: 0.719 Test Loss: 1.080 Test Acc: 0.719
Validation loss decreased (-0.715613 --> -0.718739).  Saving model ...
Epoch: 11 cost time: 1.0492534637451172
Epoch: 11, Steps: 8 | Train Loss: 0.983 Vali Loss: 0.985 Vali Acc: 0.738 Test Loss: 0.985 Test Acc: 0.738
Validation loss decreased (-0.718739 --> -0.737490).  Saving model ...
Epoch: 12 cost time: 1.2301456928253174
Epoch: 12, Steps: 8 | Train Loss: 0.933 Vali Loss: 0.904 Vali Acc: 0.750 Test Loss: 0.904 Test Acc: 0.750
Validation loss decreased (-0.737490 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.0810987949371338
Epoch: 13, Steps: 8 | Train Loss: 0.786 Vali Loss: 0.837 Vali Acc: 0.762 Test Loss: 0.837 Test Acc: 0.762
Validation loss decreased (-0.749991 --> -0.762492).  Saving model ...
Epoch: 14 cost time: 1.336972713470459
Epoch: 14, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.785 Vali Acc: 0.769 Test Loss: 0.785 Test Acc: 0.769
Validation loss decreased (-0.762492 --> -0.768742).  Saving model ...
Epoch: 15 cost time: 1.1394855976104736
Epoch: 15, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.738 Vali Acc: 0.781 Test Loss: 0.738 Test Acc: 0.781
Validation loss decreased (-0.768742 --> -0.781243).  Saving model ...
Epoch: 16 cost time: 1.0924458503723145
Epoch: 16, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.698 Vali Acc: 0.794 Test Loss: 0.698 Test Acc: 0.794
Validation loss decreased (-0.781243 --> -0.793743).  Saving model ...
Epoch: 17 cost time: 1.1555414199829102
Epoch: 17, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.668 Vali Acc: 0.791 Test Loss: 0.668 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1874630451202393
Epoch: 18, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.645 Vali Acc: 0.800 Test Loss: 0.645 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 1.1499881744384766
Epoch: 19, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 0.9149460792541504
Epoch: 20, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
Validation loss decreased (-0.799994 --> -0.809369).  Saving model ...
Epoch: 21 cost time: 1.023674488067627
Epoch: 21, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.599 Vali Acc: 0.806 Test Loss: 0.599 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2198715209960938
Epoch: 22, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 23 cost time: 1.0462605953216553
Epoch: 23, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 24 cost time: 0.9085266590118408
Epoch: 24, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 25 cost time: 1.0673675537109375
Epoch: 25, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 26 cost time: 0.9675931930541992
Epoch: 26, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0658209323883057
Epoch: 27, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 28 cost time: 1.2623226642608643
Epoch: 28, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 29 cost time: 1.0675227642059326
Epoch: 29, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 30 cost time: 1.1859722137451172
Epoch: 30, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 31 cost time: 1.4128496646881104
Epoch: 31, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1082804203033447
Epoch: 32, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0440311431884766
Epoch: 33, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 34 cost time: 1.4577457904815674
Epoch: 34, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2737975120544434
Epoch: 35, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4461519718170166
Epoch: 36, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 37 cost time: 1.1975038051605225
Epoch: 37, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 1.4946725368499756
Epoch: 38, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.301490068435669
Epoch: 39, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1231346130371094
Epoch: 40, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0295286178588867
Epoch: 41, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6956431865692139
Epoch: 42, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.39390230178833
Epoch: 43, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5831632614135742
Epoch: 44, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0812675952911377
Epoch: 45, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3500621318817139
Epoch: 46, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9974026679992676
Epoch: 47, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 15416
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.327418088912964
Epoch: 1, Steps: 8 | Train Loss: 2.219 Vali Loss: 2.093 Vali Acc: 0.122 Test Loss: 2.093 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 1.281480312347412
Epoch: 2, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.046 Vali Acc: 0.178 Test Loss: 2.046 Test Acc: 0.178
Validation loss decreased (-0.121854 --> -0.178105).  Saving model ...
Epoch: 3 cost time: 1.299919605255127
Epoch: 3, Steps: 8 | Train Loss: 2.160 Vali Loss: 1.976 Vali Acc: 0.278 Test Loss: 1.976 Test Acc: 0.278
Validation loss decreased (-0.178105 --> -0.278105).  Saving model ...
Epoch: 4 cost time: 1.3413898944854736
Epoch: 4, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.885 Vali Acc: 0.350 Test Loss: 1.885 Test Acc: 0.350
Validation loss decreased (-0.278105 --> -0.349981).  Saving model ...
Epoch: 5 cost time: 1.0987234115600586
Epoch: 5, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.786 Vali Acc: 0.428 Test Loss: 1.786 Test Acc: 0.428
Validation loss decreased (-0.349981 --> -0.428107).  Saving model ...
Epoch: 6 cost time: 1.07598876953125
Epoch: 6, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.681 Vali Acc: 0.522 Test Loss: 1.681 Test Acc: 0.522
Validation loss decreased (-0.428107 --> -0.521858).  Saving model ...
Epoch: 7 cost time: 1.3628878593444824
Epoch: 7, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.568 Vali Acc: 0.600 Test Loss: 1.568 Test Acc: 0.600
Validation loss decreased (-0.521858 --> -0.599984).  Saving model ...
Epoch: 8 cost time: 1.1309232711791992
Epoch: 8, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.458 Vali Acc: 0.634 Test Loss: 1.458 Test Acc: 0.634
Validation loss decreased (-0.599984 --> -0.634360).  Saving model ...
Epoch: 9 cost time: 1.217963457107544
Epoch: 9, Steps: 8 | Train Loss: 1.467 Vali Loss: 1.347 Vali Acc: 0.662 Test Loss: 1.347 Test Acc: 0.662
Validation loss decreased (-0.634360 --> -0.662487).  Saving model ...
Epoch: 10 cost time: 1.404581069946289
Epoch: 10, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.236 Vali Acc: 0.684 Test Loss: 1.236 Test Acc: 0.684
Validation loss decreased (-0.662487 --> -0.684363).  Saving model ...
Epoch: 11 cost time: 1.1866364479064941
Epoch: 11, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.135 Vali Acc: 0.716 Test Loss: 1.135 Test Acc: 0.716
Validation loss decreased (-0.684363 --> -0.715614).  Saving model ...
Epoch: 12 cost time: 0.9905304908752441
Epoch: 12, Steps: 8 | Train Loss: 1.065 Vali Loss: 1.046 Vali Acc: 0.741 Test Loss: 1.046 Test Acc: 0.741
Validation loss decreased (-0.715614 --> -0.740615).  Saving model ...
Epoch: 13 cost time: 1.3653616905212402
Epoch: 13, Steps: 8 | Train Loss: 0.967 Vali Loss: 0.961 Vali Acc: 0.753 Test Loss: 0.961 Test Acc: 0.753
Validation loss decreased (-0.740615 --> -0.753115).  Saving model ...
Epoch: 14 cost time: 1.052384853363037
Epoch: 14, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.893 Vali Acc: 0.762 Test Loss: 0.893 Test Acc: 0.762
Validation loss decreased (-0.753115 --> -0.762491).  Saving model ...
Epoch: 15 cost time: 0.9665627479553223
Epoch: 15, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.828 Vali Acc: 0.769 Test Loss: 0.828 Test Acc: 0.769
Validation loss decreased (-0.762491 --> -0.768742).  Saving model ...
Epoch: 16 cost time: 1.1440205574035645
Epoch: 16, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.782 Vali Acc: 0.769 Test Loss: 0.782 Test Acc: 0.769
Validation loss decreased (-0.768742 --> -0.768742).  Saving model ...
Epoch: 17 cost time: 1.1796293258666992
Epoch: 17, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.742 Vali Acc: 0.778 Test Loss: 0.742 Test Acc: 0.778
Validation loss decreased (-0.768742 --> -0.778118).  Saving model ...
Epoch: 18 cost time: 0.965900182723999
Epoch: 18, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.709 Vali Acc: 0.791 Test Loss: 0.709 Test Acc: 0.791
Validation loss decreased (-0.778118 --> -0.790618).  Saving model ...
Epoch: 19 cost time: 1.082435131072998
Epoch: 19, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.680 Vali Acc: 0.794 Test Loss: 0.680 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 20 cost time: 1.094618320465088
Epoch: 20, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.657 Vali Acc: 0.794 Test Loss: 0.657 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 21 cost time: 1.2010056972503662
Epoch: 21, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 1.0029995441436768
Epoch: 22, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 1.2808053493499756
Epoch: 23, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 1.4981040954589844
Epoch: 24, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 25 cost time: 1.301589012145996
Epoch: 25, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 1.2777800559997559
Epoch: 26, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 27 cost time: 1.1323964595794678
Epoch: 27, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 28 cost time: 1.4088995456695557
Epoch: 28, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 29 cost time: 1.4040956497192383
Epoch: 29, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 30 cost time: 1.131523847579956
Epoch: 30, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 31 cost time: 1.2396996021270752
Epoch: 31, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 32 cost time: 1.3627197742462158
Epoch: 32, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5406179428100586
Epoch: 33, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 34 cost time: 1.0261306762695312
Epoch: 34, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 35 cost time: 1.215550422668457
Epoch: 35, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 36 cost time: 1.5069987773895264
Epoch: 36, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9962751865386963
Epoch: 37, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 38 cost time: 1.1060068607330322
Epoch: 38, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 39 cost time: 1.1948823928833008
Epoch: 39, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.163954257965088
Epoch: 40, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0654256343841553
Epoch: 41, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.217860460281372
Epoch: 42, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 43 cost time: 0.998680830001831
Epoch: 43, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 44 cost time: 1.0355761051177979
Epoch: 44, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 45 cost time: 1.1225979328155518
Epoch: 45, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 46 cost time: 1.079253911972046
Epoch: 46, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 47 cost time: 0.8747677803039551
Epoch: 47, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.476 Vali Acc: 0.834 Test Loss: 0.476 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0568997859954834
Epoch: 48, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 49 cost time: 1.3211102485656738
Epoch: 49, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0955500602722168
Epoch: 50, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9815552234649658
Epoch: 51, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.133373498916626
Epoch: 52, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 53 cost time: 1.401977777481079
Epoch: 53, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.165114402770996
Epoch: 54, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9149620532989502
Epoch: 55, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.870922327041626
Epoch: 56, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 57 cost time: 1.0262079238891602
Epoch: 57, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 58 cost time: 1.2778124809265137
Epoch: 58, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9505734443664551
Epoch: 59, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0352892875671387
Epoch: 60, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0920288562774658
Epoch: 61, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0202796459197998
Epoch: 62, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9722552299499512
Epoch: 63, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 64 cost time: 1.2174594402313232
Epoch: 64, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 65 cost time: 1.142812967300415
Epoch: 65, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.349968433380127
Epoch: 66, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 67 cost time: 1.1024830341339111
Epoch: 67, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1382560729980469
Epoch: 68, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0411593914031982
Epoch: 69, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 70 cost time: 1.155015230178833
Epoch: 70, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9652457237243652
Epoch: 71, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 72 cost time: 1.3374640941619873
Epoch: 72, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 73 cost time: 1.2991678714752197
Epoch: 73, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.3857412338256836
Epoch: 74, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.9731223583221436
Epoch: 75, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.0771739482879639
Epoch: 76, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.9494006633758545
Epoch: 77, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.1744191646575928
Epoch: 78, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.263597011566162
Epoch: 79, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 80 cost time: 1.2648191452026367
Epoch: 80, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.2697532176971436
Epoch: 81, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.006507158279419
Epoch: 82, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.0625059604644775
Epoch: 83, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.9084570407867432
Epoch: 84, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.4430415630340576
Epoch: 85, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.2380263805389404
Epoch: 86, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.2372870445251465
Epoch: 87, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 1.020071029663086
Epoch: 88, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 1.2197442054748535
Epoch: 89, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 14120
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6100049018859863
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.069 Vali Acc: 0.184 Test Loss: 2.069 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 1.3456737995147705
Epoch: 2, Steps: 8 | Train Loss: 2.120 Vali Loss: 2.010 Vali Acc: 0.203 Test Loss: 2.010 Test Acc: 0.203
Validation loss decreased (-0.184354 --> -0.203105).  Saving model ...
Epoch: 3 cost time: 1.0232176780700684
Epoch: 3, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.936 Vali Acc: 0.247 Test Loss: 1.936 Test Acc: 0.247
Validation loss decreased (-0.203105 --> -0.246856).  Saving model ...
Epoch: 4 cost time: 1.363952875137329
Epoch: 4, Steps: 8 | Train Loss: 1.978 Vali Loss: 1.849 Vali Acc: 0.303 Test Loss: 1.849 Test Acc: 0.303
Validation loss decreased (-0.246856 --> -0.303107).  Saving model ...
Epoch: 5 cost time: 1.0282402038574219
Epoch: 5, Steps: 8 | Train Loss: 1.819 Vali Loss: 1.754 Vali Acc: 0.394 Test Loss: 1.754 Test Acc: 0.394
Validation loss decreased (-0.303107 --> -0.393732).  Saving model ...
Epoch: 6 cost time: 1.1382386684417725
Epoch: 6, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.657 Vali Acc: 0.453 Test Loss: 1.657 Test Acc: 0.453
Validation loss decreased (-0.393732 --> -0.453108).  Saving model ...
Epoch: 7 cost time: 1.2071352005004883
Epoch: 7, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.563 Vali Acc: 0.516 Test Loss: 1.563 Test Acc: 0.516
Validation loss decreased (-0.453108 --> -0.515609).  Saving model ...
Epoch: 8 cost time: 1.3757190704345703
Epoch: 8, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.470 Vali Acc: 0.575 Test Loss: 1.470 Test Acc: 0.575
Validation loss decreased (-0.515609 --> -0.574985).  Saving model ...
Epoch: 9 cost time: 1.3958277702331543
Epoch: 9, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.380 Vali Acc: 0.641 Test Loss: 1.380 Test Acc: 0.641
Validation loss decreased (-0.574985 --> -0.640611).  Saving model ...
Epoch: 10 cost time: 1.496607780456543
Epoch: 10, Steps: 8 | Train Loss: 1.410 Vali Loss: 1.293 Vali Acc: 0.688 Test Loss: 1.293 Test Acc: 0.688
Validation loss decreased (-0.640611 --> -0.687487).  Saving model ...
Epoch: 11 cost time: 1.37437105178833
Epoch: 11, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.214 Vali Acc: 0.713 Test Loss: 1.214 Test Acc: 0.713
Validation loss decreased (-0.687487 --> -0.712488).  Saving model ...
Epoch: 12 cost time: 1.3680522441864014
Epoch: 12, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.137 Vali Acc: 0.738 Test Loss: 1.137 Test Acc: 0.738
Validation loss decreased (-0.712488 --> -0.737489).  Saving model ...
Epoch: 13 cost time: 1.3291232585906982
Epoch: 13, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.065 Vali Acc: 0.759 Test Loss: 1.065 Test Acc: 0.759
Validation loss decreased (-0.737489 --> -0.759364).  Saving model ...
Epoch: 14 cost time: 1.6393322944641113
Epoch: 14, Steps: 8 | Train Loss: 1.026 Vali Loss: 0.998 Vali Acc: 0.772 Test Loss: 0.998 Test Acc: 0.772
Validation loss decreased (-0.759364 --> -0.771865).  Saving model ...
Epoch: 15 cost time: 1.2690253257751465
Epoch: 15, Steps: 8 | Train Loss: 0.927 Vali Loss: 0.939 Vali Acc: 0.775 Test Loss: 0.939 Test Acc: 0.775
Validation loss decreased (-0.771865 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 1.198211669921875
Epoch: 16, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.887 Vali Acc: 0.787 Test Loss: 0.887 Test Acc: 0.787
Validation loss decreased (-0.774991 --> -0.787491).  Saving model ...
Epoch: 17 cost time: 1.0941908359527588
Epoch: 17, Steps: 8 | Train Loss: 0.812 Vali Loss: 0.843 Vali Acc: 0.784 Test Loss: 0.843 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.206604242324829
Epoch: 18, Steps: 8 | Train Loss: 0.757 Vali Loss: 0.806 Vali Acc: 0.787 Test Loss: 0.806 Test Acc: 0.787
Validation loss decreased (-0.787491 --> -0.787492).  Saving model ...
Epoch: 19 cost time: 1.2564260959625244
Epoch: 19, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.766 Vali Acc: 0.794 Test Loss: 0.766 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793742).  Saving model ...
Epoch: 20 cost time: 1.4041388034820557
Epoch: 20, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.737 Vali Acc: 0.797 Test Loss: 0.737 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796868).  Saving model ...
Epoch: 21 cost time: 1.3329882621765137
Epoch: 21, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.712 Vali Acc: 0.794 Test Loss: 0.712 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5248723030090332
Epoch: 22, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 23 cost time: 1.005028486251831
Epoch: 23, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803118).  Saving model ...
Epoch: 24 cost time: 1.4381325244903564
Epoch: 24, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2897515296936035
Epoch: 25, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.634 Vali Acc: 0.806 Test Loss: 0.634 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 26 cost time: 1.0767338275909424
Epoch: 26, Steps: 8 | Train Loss: 0.569 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 27 cost time: 1.2945530414581299
Epoch: 27, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 28 cost time: 1.016634464263916
Epoch: 28, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 29 cost time: 1.1390175819396973
Epoch: 29, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 30 cost time: 1.038841724395752
Epoch: 30, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 31 cost time: 1.0566956996917725
Epoch: 31, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 32 cost time: 1.104504108428955
Epoch: 32, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 33 cost time: 1.056015968322754
Epoch: 33, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 34 cost time: 1.2313263416290283
Epoch: 34, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 35 cost time: 1.278581142425537
Epoch: 35, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 36 cost time: 1.2034919261932373
Epoch: 36, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 37 cost time: 1.180016040802002
Epoch: 37, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 38 cost time: 1.2972440719604492
Epoch: 38, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 39 cost time: 1.2720832824707031
Epoch: 39, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 40 cost time: 1.2735767364501953
Epoch: 40, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 41 cost time: 1.1655819416046143
Epoch: 41, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3264100551605225
Epoch: 42, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 43 cost time: 1.097733736038208
Epoch: 43, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 44 cost time: 0.9694938659667969
Epoch: 44, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 45 cost time: 1.2093820571899414
Epoch: 45, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 46 cost time: 1.0108087062835693
Epoch: 46, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 47 cost time: 1.054544448852539
Epoch: 47, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853121).  Saving model ...
Epoch: 48 cost time: 1.4575603008270264
Epoch: 48, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
Validation loss decreased (-0.853121 --> -0.859371).  Saving model ...
Epoch: 49 cost time: 1.2122254371643066
Epoch: 49, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3239171504974365
Epoch: 50, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2058932781219482
Epoch: 51, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.437 Vali Acc: 0.859 Test Loss: 0.437 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 52 cost time: 1.1255748271942139
Epoch: 52, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.434 Vali Acc: 0.859 Test Loss: 0.434 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 53 cost time: 1.296269416809082
Epoch: 53, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.433 Vali Acc: 0.863 Test Loss: 0.433 Test Acc: 0.863
Validation loss decreased (-0.859371 --> -0.862496).  Saving model ...
Epoch: 54 cost time: 1.235658884048462
Epoch: 54, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.433 Vali Acc: 0.853 Test Loss: 0.433 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0630083084106445
Epoch: 55, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0531609058380127
Epoch: 56, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.435 Vali Acc: 0.847 Test Loss: 0.435 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.2424123287200928
Epoch: 57, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.430 Vali Acc: 0.853 Test Loss: 0.430 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.5063021183013916
Epoch: 58, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.420 Vali Acc: 0.856 Test Loss: 0.420 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.142676830291748
Epoch: 59, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.419 Vali Acc: 0.859 Test Loss: 0.419 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.2163095474243164
Epoch: 60, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.420 Vali Acc: 0.853 Test Loss: 0.420 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.2281873226165771
Epoch: 61, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.423 Vali Acc: 0.853 Test Loss: 0.423 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.2283151149749756
Epoch: 62, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.3297784328460693
Epoch: 63, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df256_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 13608
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.858236312866211
Epoch: 1, Steps: 8 | Train Loss: 2.322 Vali Loss: 2.141 Vali Acc: 0.075 Test Loss: 2.141 Test Acc: 0.075
Validation loss decreased (inf --> -0.074979).  Saving model ...
Epoch: 2 cost time: 1.2679545879364014
Epoch: 2, Steps: 8 | Train Loss: 2.048 Vali Loss: 1.861 Vali Acc: 0.341 Test Loss: 1.861 Test Acc: 0.341
Validation loss decreased (-0.074979 --> -0.340606).  Saving model ...
Epoch: 3 cost time: 1.7555549144744873
Epoch: 3, Steps: 8 | Train Loss: 1.712 Vali Loss: 1.526 Vali Acc: 0.597 Test Loss: 1.526 Test Acc: 0.597
Validation loss decreased (-0.340606 --> -0.596860).  Saving model ...
Epoch: 4 cost time: 1.1128108501434326
Epoch: 4, Steps: 8 | Train Loss: 1.409 Vali Loss: 1.200 Vali Acc: 0.709 Test Loss: 1.200 Test Acc: 0.709
Validation loss decreased (-0.596860 --> -0.709363).  Saving model ...
Epoch: 5 cost time: 1.1988131999969482
Epoch: 5, Steps: 8 | Train Loss: 1.088 Vali Loss: 0.930 Vali Acc: 0.766 Test Loss: 0.930 Test Acc: 0.766
Validation loss decreased (-0.709363 --> -0.765616).  Saving model ...
Epoch: 6 cost time: 1.2034194469451904
Epoch: 6, Steps: 8 | Train Loss: 0.836 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
Validation loss decreased (-0.765616 --> -0.793743).  Saving model ...
Epoch: 7 cost time: 1.3092589378356934
Epoch: 7, Steps: 8 | Train Loss: 0.624 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
Validation loss decreased (-0.793743 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 1.5494065284729004
Epoch: 8, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.320509910583496
Epoch: 9, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0111241340637207
Epoch: 10, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4958579540252686
Epoch: 11, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 1.0012922286987305
Epoch: 12, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.024528980255127
Epoch: 13, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0759303569793701
Epoch: 14, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2415871620178223
Epoch: 15, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3264579772949219
Epoch: 16, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6701462268829346
Epoch: 17, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6685755252838135
Epoch: 18, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.3004202842712402
Epoch: 19, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4733636379241943
Epoch: 20, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3641035556793213
Epoch: 21, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.45613694190979
Epoch: 22, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.588 Vali Acc: 0.834 Test Loss: 0.588 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5822157859802246
Epoch: 23, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.605 Vali Acc: 0.834 Test Loss: 0.605 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0746021270751953
Epoch: 24, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.604 Vali Acc: 0.831 Test Loss: 0.604 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3286170959472656
Epoch: 25, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.594 Vali Acc: 0.831 Test Loss: 0.594 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0433015823364258
Epoch: 26, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.601 Vali Acc: 0.831 Test Loss: 0.601 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5757369995117188
Epoch: 27, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1548984050750732
Epoch: 28, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.619 Vali Acc: 0.838 Test Loss: 0.619 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 35512
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.767240047454834
Epoch: 1, Steps: 8 | Train Loss: 2.323 Vali Loss: 2.233 Vali Acc: 0.106 Test Loss: 2.233 Test Acc: 0.106
Validation loss decreased (inf --> -0.106228).  Saving model ...
Epoch: 2 cost time: 0.9556903839111328
Epoch: 2, Steps: 8 | Train Loss: 2.252 Vali Loss: 2.081 Vali Acc: 0.194 Test Loss: 2.081 Test Acc: 0.194
Validation loss decreased (-0.106228 --> -0.193729).  Saving model ...
Epoch: 3 cost time: 1.3462564945220947
Epoch: 3, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.867 Vali Acc: 0.347 Test Loss: 1.867 Test Acc: 0.347
Validation loss decreased (-0.193729 --> -0.346856).  Saving model ...
Epoch: 4 cost time: 0.9688560962677002
Epoch: 4, Steps: 8 | Train Loss: 1.744 Vali Loss: 1.624 Vali Acc: 0.547 Test Loss: 1.624 Test Acc: 0.547
Validation loss decreased (-0.346856 --> -0.546859).  Saving model ...
Epoch: 5 cost time: 1.1627469062805176
Epoch: 5, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.389 Vali Acc: 0.731 Test Loss: 1.389 Test Acc: 0.731
Validation loss decreased (-0.546859 --> -0.731236).  Saving model ...
Epoch: 6 cost time: 0.9361138343811035
Epoch: 6, Steps: 8 | Train Loss: 1.262 Vali Loss: 1.172 Vali Acc: 0.762 Test Loss: 1.172 Test Acc: 0.762
Validation loss decreased (-0.731236 --> -0.762488).  Saving model ...
Epoch: 7 cost time: 1.0761628150939941
Epoch: 7, Steps: 8 | Train Loss: 1.045 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
Validation loss decreased (-0.762488 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.0746257305145264
Epoch: 8, Steps: 8 | Train Loss: 0.884 Vali Loss: 0.837 Vali Acc: 0.791 Test Loss: 0.837 Test Acc: 0.791
Validation loss decreased (-0.774990 --> -0.790617).  Saving model ...
Epoch: 9 cost time: 0.9799385070800781
Epoch: 9, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.728 Vali Acc: 0.806 Test Loss: 0.728 Test Acc: 0.806
Validation loss decreased (-0.790617 --> -0.806243).  Saving model ...
Epoch: 10 cost time: 1.1987946033477783
Epoch: 10, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 1.3112258911132812
Epoch: 11, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.607 Vali Acc: 0.806 Test Loss: 0.607 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.149632453918457
Epoch: 12, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.809368 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.99188232421875
Epoch: 13, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 1.0973634719848633
Epoch: 14, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 1.2064530849456787
Epoch: 15, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2057206630706787
Epoch: 16, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.077033281326294
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3043522834777832
Epoch: 18, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5334975719451904
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3524940013885498
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0512070655822754
Epoch: 21, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2299988269805908
Epoch: 22, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0454325675964355
Epoch: 23, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 24 cost time: 1.2276251316070557
Epoch: 24, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0091552734375
Epoch: 25, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1179406642913818
Epoch: 26, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1686766147613525
Epoch: 27, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2567367553710938
Epoch: 28, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2412424087524414
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0654077529907227
Epoch: 30, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2775352001190186
Epoch: 31, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0980513095855713
Epoch: 32, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1689565181732178
Epoch: 33, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 20664
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.231208562850952
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 2.155 Vali Acc: 0.094 Test Loss: 2.155 Test Acc: 0.094
Validation loss decreased (inf --> -0.093728).  Saving model ...
Epoch: 2 cost time: 1.3019599914550781
Epoch: 2, Steps: 8 | Train Loss: 2.153 Vali Loss: 2.059 Vali Acc: 0.156 Test Loss: 2.059 Test Acc: 0.156
Validation loss decreased (-0.093728 --> -0.156229).  Saving model ...
Epoch: 3 cost time: 1.2103147506713867
Epoch: 3, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.927 Vali Acc: 0.272 Test Loss: 1.927 Test Acc: 0.272
Validation loss decreased (-0.156229 --> -0.271856).  Saving model ...
Epoch: 4 cost time: 1.0175755023956299
Epoch: 4, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.772 Vali Acc: 0.444 Test Loss: 1.772 Test Acc: 0.444
Validation loss decreased (-0.271856 --> -0.443732).  Saving model ...
Epoch: 5 cost time: 1.0961668491363525
Epoch: 5, Steps: 8 | Train Loss: 1.713 Vali Loss: 1.600 Vali Acc: 0.594 Test Loss: 1.600 Test Acc: 0.594
Validation loss decreased (-0.443732 --> -0.593734).  Saving model ...
Epoch: 6 cost time: 1.0327377319335938
Epoch: 6, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.428 Vali Acc: 0.659 Test Loss: 1.428 Test Acc: 0.659
Validation loss decreased (-0.593734 --> -0.659361).  Saving model ...
Epoch: 7 cost time: 1.3139581680297852
Epoch: 7, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.258 Vali Acc: 0.703 Test Loss: 1.258 Test Acc: 0.703
Validation loss decreased (-0.659361 --> -0.703112).  Saving model ...
Epoch: 8 cost time: 1.109769344329834
Epoch: 8, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.107 Vali Acc: 0.750 Test Loss: 1.107 Test Acc: 0.750
Validation loss decreased (-0.703112 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 1.0635600090026855
Epoch: 9, Steps: 8 | Train Loss: 1.108 Vali Loss: 0.978 Vali Acc: 0.766 Test Loss: 0.978 Test Acc: 0.766
Validation loss decreased (-0.749989 --> -0.765615).  Saving model ...
Epoch: 10 cost time: 1.0109846591949463
Epoch: 10, Steps: 8 | Train Loss: 0.907 Vali Loss: 0.869 Vali Acc: 0.787 Test Loss: 0.869 Test Acc: 0.787
Validation loss decreased (-0.765615 --> -0.787491).  Saving model ...
Epoch: 11 cost time: 1.0495641231536865
Epoch: 11, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.787 Vali Acc: 0.791 Test Loss: 0.787 Test Acc: 0.791
Validation loss decreased (-0.787491 --> -0.790617).  Saving model ...
Epoch: 12 cost time: 0.981374979019165
Epoch: 12, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.716 Vali Acc: 0.806 Test Loss: 0.716 Test Acc: 0.806
Validation loss decreased (-0.790617 --> -0.806243).  Saving model ...
Epoch: 13 cost time: 0.9176638126373291
Epoch: 13, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812493).  Saving model ...
Epoch: 14 cost time: 1.3335926532745361
Epoch: 14, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.627 Vali Acc: 0.812 Test Loss: 0.627 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 15 cost time: 1.1556622982025146
Epoch: 15, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 16 cost time: 0.882540225982666
Epoch: 16, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 17 cost time: 1.2360332012176514
Epoch: 17, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 18 cost time: 1.141326904296875
Epoch: 18, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 19 cost time: 1.1623716354370117
Epoch: 19, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 20 cost time: 1.2052533626556396
Epoch: 20, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 21 cost time: 1.1619796752929688
Epoch: 21, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 22 cost time: 1.0172200202941895
Epoch: 22, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 23 cost time: 1.0428035259246826
Epoch: 23, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0898301601409912
Epoch: 24, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9920539855957031
Epoch: 25, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.098738193511963
Epoch: 26, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0716984272003174
Epoch: 27, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.137746810913086
Epoch: 28, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2902657985687256
Epoch: 29, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0181989669799805
Epoch: 30, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.156104326248169
Epoch: 31, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.23789644241333
Epoch: 32, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 33 cost time: 1.2436790466308594
Epoch: 33, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2713563442230225
Epoch: 34, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 35 cost time: 1.2655928134918213
Epoch: 35, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3889000415802002
Epoch: 36, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9838426113128662
Epoch: 37, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1970725059509277
Epoch: 38, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0532865524291992
Epoch: 39, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1013429164886475
Epoch: 40, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1271498203277588
Epoch: 41, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3459186553955078
Epoch: 42, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.268709659576416
Epoch: 43, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.576 Vali Acc: 0.838 Test Loss: 0.576 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2172298431396484
Epoch: 44, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.581 Vali Acc: 0.838 Test Loss: 0.581 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 15800
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.665653944015503
Epoch: 1, Steps: 8 | Train Loss: 2.161 Vali Loss: 2.091 Vali Acc: 0.163 Test Loss: 2.091 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 1.0292603969573975
Epoch: 2, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.993 Vali Acc: 0.244 Test Loss: 1.993 Test Acc: 0.244
Validation loss decreased (-0.162479 --> -0.243730).  Saving model ...
Epoch: 3 cost time: 1.145524263381958
Epoch: 3, Steps: 8 | Train Loss: 2.000 Vali Loss: 1.864 Vali Acc: 0.287 Test Loss: 1.864 Test Acc: 0.287
Validation loss decreased (-0.243730 --> -0.287481).  Saving model ...
Epoch: 4 cost time: 1.1295430660247803
Epoch: 4, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.721 Vali Acc: 0.388 Test Loss: 1.721 Test Acc: 0.388
Validation loss decreased (-0.287481 --> -0.387483).  Saving model ...
Epoch: 5 cost time: 1.3516044616699219
Epoch: 5, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.571 Vali Acc: 0.562 Test Loss: 1.571 Test Acc: 0.562
Validation loss decreased (-0.387483 --> -0.562484).  Saving model ...
Epoch: 6 cost time: 1.188427209854126
Epoch: 6, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.422 Vali Acc: 0.656 Test Loss: 1.422 Test Acc: 0.656
Validation loss decreased (-0.562484 --> -0.656236).  Saving model ...
Epoch: 7 cost time: 1.1614770889282227
Epoch: 7, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.276 Vali Acc: 0.756 Test Loss: 1.276 Test Acc: 0.756
Validation loss decreased (-0.656236 --> -0.756237).  Saving model ...
Epoch: 8 cost time: 1.2624766826629639
Epoch: 8, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.140 Vali Acc: 0.784 Test Loss: 1.140 Test Acc: 0.784
Validation loss decreased (-0.756237 --> -0.784364).  Saving model ...
Epoch: 9 cost time: 1.2711215019226074
Epoch: 9, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.012 Vali Acc: 0.791 Test Loss: 1.012 Test Acc: 0.791
Validation loss decreased (-0.784364 --> -0.790615).  Saving model ...
Epoch: 10 cost time: 1.179840326309204
Epoch: 10, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.910 Vali Acc: 0.791 Test Loss: 0.910 Test Acc: 0.791
Validation loss decreased (-0.790615 --> -0.790616).  Saving model ...
Epoch: 11 cost time: 1.1295571327209473
Epoch: 11, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.822 Vali Acc: 0.794 Test Loss: 0.822 Test Acc: 0.794
Validation loss decreased (-0.790616 --> -0.793742).  Saving model ...
Epoch: 12 cost time: 1.244455337524414
Epoch: 12, Steps: 8 | Train Loss: 0.712 Vali Loss: 0.751 Vali Acc: 0.816 Test Loss: 0.751 Test Acc: 0.816
Validation loss decreased (-0.793742 --> -0.815617).  Saving model ...
Epoch: 13 cost time: 1.164992332458496
Epoch: 13, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.691 Vali Acc: 0.816 Test Loss: 0.691 Test Acc: 0.816
Validation loss decreased (-0.815617 --> -0.815618).  Saving model ...
Epoch: 14 cost time: 1.1490702629089355
Epoch: 14, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.648 Vali Acc: 0.816 Test Loss: 0.648 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815619).  Saving model ...
Epoch: 15 cost time: 1.173919677734375
Epoch: 15, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.622 Vali Acc: 0.809 Test Loss: 0.622 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0030536651611328
Epoch: 16, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.596 Vali Acc: 0.812 Test Loss: 0.596 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1810874938964844
Epoch: 17, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3540775775909424
Epoch: 18, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5130183696746826
Epoch: 19, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3235411643981934
Epoch: 20, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.545 Vali Acc: 0.812 Test Loss: 0.545 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9887974262237549
Epoch: 21, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.544 Vali Acc: 0.806 Test Loss: 0.544 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.421933650970459
Epoch: 22, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3374135494232178
Epoch: 23, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 24 cost time: 1.7105045318603516
Epoch: 24, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 25 cost time: 1.5450613498687744
Epoch: 25, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 26 cost time: 1.4683609008789062
Epoch: 26, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3230650424957275
Epoch: 27, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.685814380645752
Epoch: 28, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4009432792663574
Epoch: 29, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.696671485900879
Epoch: 30, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 31 cost time: 1.4798412322998047
Epoch: 31, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 32 cost time: 1.2550854682922363
Epoch: 32, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1945722103118896
Epoch: 33, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0724477767944336
Epoch: 34, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2440896034240723
Epoch: 35, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3509929180145264
Epoch: 36, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3739569187164307
Epoch: 37, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4347851276397705
Epoch: 38, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 39 cost time: 1.1106297969818115
Epoch: 39, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0287940502166748
Epoch: 40, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 41 cost time: 1.3109803199768066
Epoch: 41, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 42 cost time: 1.163330078125
Epoch: 42, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 43 cost time: 0.9717495441436768
Epoch: 43, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.276993989944458
Epoch: 44, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.129108190536499
Epoch: 45, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3065185546875
Epoch: 46, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5040183067321777
Epoch: 47, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9135305881500244
Epoch: 48, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.252676248550415
Epoch: 49, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.062769889831543
Epoch: 50, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.3344757556915283
Epoch: 51, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1615557670593262
Epoch: 52, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 13240
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9219884872436523
Epoch: 1, Steps: 8 | Train Loss: 2.418 Vali Loss: 2.215 Vali Acc: 0.087 Test Loss: 2.215 Test Acc: 0.087
Validation loss decreased (inf --> -0.087478).  Saving model ...
Epoch: 2 cost time: 1.0410771369934082
Epoch: 2, Steps: 8 | Train Loss: 2.268 Vali Loss: 2.156 Vali Acc: 0.091 Test Loss: 2.156 Test Acc: 0.091
Validation loss decreased (-0.087478 --> -0.090603).  Saving model ...
Epoch: 3 cost time: 1.0827085971832275
Epoch: 3, Steps: 8 | Train Loss: 2.284 Vali Loss: 2.063 Vali Acc: 0.147 Test Loss: 2.063 Test Acc: 0.147
Validation loss decreased (-0.090603 --> -0.146854).  Saving model ...
Epoch: 4 cost time: 1.3109612464904785
Epoch: 4, Steps: 8 | Train Loss: 2.146 Vali Loss: 1.950 Vali Acc: 0.212 Test Loss: 1.950 Test Acc: 0.212
Validation loss decreased (-0.146854 --> -0.212481).  Saving model ...
Epoch: 5 cost time: 1.2144181728363037
Epoch: 5, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.826 Vali Acc: 0.334 Test Loss: 1.826 Test Acc: 0.334
Validation loss decreased (-0.212481 --> -0.334357).  Saving model ...
Epoch: 6 cost time: 1.0816450119018555
Epoch: 6, Steps: 8 | Train Loss: 1.881 Vali Loss: 1.698 Vali Acc: 0.463 Test Loss: 1.698 Test Acc: 0.463
Validation loss decreased (-0.334357 --> -0.462483).  Saving model ...
Epoch: 7 cost time: 1.075040578842163
Epoch: 7, Steps: 8 | Train Loss: 1.759 Vali Loss: 1.567 Vali Acc: 0.559 Test Loss: 1.567 Test Acc: 0.559
Validation loss decreased (-0.462483 --> -0.559359).  Saving model ...
Epoch: 8 cost time: 1.0296635627746582
Epoch: 8, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.440 Vali Acc: 0.659 Test Loss: 1.440 Test Acc: 0.659
Validation loss decreased (-0.559359 --> -0.659361).  Saving model ...
Epoch: 9 cost time: 1.0169241428375244
Epoch: 9, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.318 Vali Acc: 0.719 Test Loss: 1.318 Test Acc: 0.719
Validation loss decreased (-0.659361 --> -0.718737).  Saving model ...
Epoch: 10 cost time: 1.1211605072021484
Epoch: 10, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.196 Vali Acc: 0.741 Test Loss: 1.196 Test Acc: 0.741
Validation loss decreased (-0.718737 --> -0.740613).  Saving model ...
Epoch: 11 cost time: 1.2254838943481445
Epoch: 11, Steps: 8 | Train Loss: 1.228 Vali Loss: 1.087 Vali Acc: 0.756 Test Loss: 1.087 Test Acc: 0.756
Validation loss decreased (-0.740613 --> -0.756239).  Saving model ...
Epoch: 12 cost time: 1.2340903282165527
Epoch: 12, Steps: 8 | Train Loss: 1.099 Vali Loss: 0.993 Vali Acc: 0.759 Test Loss: 0.993 Test Acc: 0.759
Validation loss decreased (-0.756239 --> -0.759365).  Saving model ...
Epoch: 13 cost time: 1.1894495487213135
Epoch: 13, Steps: 8 | Train Loss: 0.971 Vali Loss: 0.910 Vali Acc: 0.769 Test Loss: 0.910 Test Acc: 0.769
Validation loss decreased (-0.759365 --> -0.768741).  Saving model ...
Epoch: 14 cost time: 1.442249059677124
Epoch: 14, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.838 Vali Acc: 0.778 Test Loss: 0.838 Test Acc: 0.778
Validation loss decreased (-0.768741 --> -0.778117).  Saving model ...
Epoch: 15 cost time: 1.1553750038146973
Epoch: 15, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1653847694396973
Epoch: 16, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.739 Vali Acc: 0.797 Test Loss: 0.739 Test Acc: 0.797
Validation loss decreased (-0.778117 --> -0.796868).  Saving model ...
Epoch: 17 cost time: 1.3055708408355713
Epoch: 17, Steps: 8 | Train Loss: 0.662 Vali Loss: 0.699 Vali Acc: 0.800 Test Loss: 0.699 Test Acc: 0.800
Validation loss decreased (-0.796868 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.2136611938476562
Epoch: 18, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.670 Vali Acc: 0.806 Test Loss: 0.670 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806243).  Saving model ...
Epoch: 19 cost time: 1.1044347286224365
Epoch: 19, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 20 cost time: 1.0964171886444092
Epoch: 20, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 21 cost time: 1.3927102088928223
Epoch: 21, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 22 cost time: 1.3047614097595215
Epoch: 22, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 23 cost time: 1.1697072982788086
Epoch: 23, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 24 cost time: 1.3635520935058594
Epoch: 24, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 25 cost time: 1.0376622676849365
Epoch: 25, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 26 cost time: 1.1036450862884521
Epoch: 26, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 27 cost time: 1.32896089553833
Epoch: 27, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4744455814361572
Epoch: 28, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5230777263641357
Epoch: 29, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2609319686889648
Epoch: 30, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0535945892333984
Epoch: 31, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4707841873168945
Epoch: 32, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 33 cost time: 1.1372227668762207
Epoch: 33, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 34 cost time: 1.028062343597412
Epoch: 34, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2377057075500488
Epoch: 35, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0195181369781494
Epoch: 36, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 37 cost time: 1.0902349948883057
Epoch: 37, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 38 cost time: 1.212399959564209
Epoch: 38, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 39 cost time: 0.8638248443603516
Epoch: 39, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0900235176086426
Epoch: 40, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 41 cost time: 0.9751715660095215
Epoch: 41, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 42 cost time: 0.8390614986419678
Epoch: 42, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1182177066802979
Epoch: 43, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0685620307922363
Epoch: 44, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 45 cost time: 1.081714391708374
Epoch: 45, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0918850898742676
Epoch: 46, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1815969944000244
Epoch: 47, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.045433759689331
Epoch: 48, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2547423839569092
Epoch: 49, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9359407424926758
Epoch: 50, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.078751564025879
Epoch: 51, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2614657878875732
Epoch: 52, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.0886075496673584
Epoch: 53, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.2237553596496582
Epoch: 54, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 11192
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.784821033477783
Epoch: 1, Steps: 8 | Train Loss: 2.229 Vali Loss: 2.139 Vali Acc: 0.184 Test Loss: 2.139 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 1.0541942119598389
Epoch: 2, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.071 Vali Acc: 0.200 Test Loss: 2.071 Test Acc: 0.200
Validation loss decreased (-0.184354 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 0.8656041622161865
Epoch: 3, Steps: 8 | Train Loss: 2.098 Vali Loss: 1.989 Vali Acc: 0.256 Test Loss: 1.989 Test Acc: 0.256
Validation loss decreased (-0.199979 --> -0.256230).  Saving model ...
Epoch: 4 cost time: 1.0397815704345703
Epoch: 4, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.896 Vali Acc: 0.287 Test Loss: 1.896 Test Acc: 0.287
Validation loss decreased (-0.256230 --> -0.287481).  Saving model ...
Epoch: 5 cost time: 1.1371028423309326
Epoch: 5, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.794 Vali Acc: 0.334 Test Loss: 1.794 Test Acc: 0.334
Validation loss decreased (-0.287481 --> -0.334357).  Saving model ...
Epoch: 6 cost time: 1.0581068992614746
Epoch: 6, Steps: 8 | Train Loss: 1.833 Vali Loss: 1.687 Vali Acc: 0.388 Test Loss: 1.687 Test Acc: 0.388
Validation loss decreased (-0.334357 --> -0.387483).  Saving model ...
Epoch: 7 cost time: 0.8860747814178467
Epoch: 7, Steps: 8 | Train Loss: 1.739 Vali Loss: 1.577 Vali Acc: 0.484 Test Loss: 1.577 Test Acc: 0.484
Validation loss decreased (-0.387483 --> -0.484359).  Saving model ...
Epoch: 8 cost time: 0.918595552444458
Epoch: 8, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.468 Vali Acc: 0.575 Test Loss: 1.468 Test Acc: 0.575
Validation loss decreased (-0.484359 --> -0.574985).  Saving model ...
Epoch: 9 cost time: 1.2225229740142822
Epoch: 9, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.358 Vali Acc: 0.666 Test Loss: 1.358 Test Acc: 0.666
Validation loss decreased (-0.574985 --> -0.665611).  Saving model ...
Epoch: 10 cost time: 1.0916926860809326
Epoch: 10, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.254 Vali Acc: 0.691 Test Loss: 1.254 Test Acc: 0.691
Validation loss decreased (-0.665611 --> -0.690612).  Saving model ...
Epoch: 11 cost time: 1.6709070205688477
Epoch: 11, Steps: 8 | Train Loss: 1.279 Vali Loss: 1.154 Vali Acc: 0.713 Test Loss: 1.154 Test Acc: 0.713
Validation loss decreased (-0.690612 --> -0.712488).  Saving model ...
Epoch: 12 cost time: 1.0822572708129883
Epoch: 12, Steps: 8 | Train Loss: 1.130 Vali Loss: 1.057 Vali Acc: 0.734 Test Loss: 1.057 Test Acc: 0.734
Validation loss decreased (-0.712488 --> -0.734364).  Saving model ...
Epoch: 13 cost time: 1.1055161952972412
Epoch: 13, Steps: 8 | Train Loss: 1.083 Vali Loss: 0.977 Vali Acc: 0.756 Test Loss: 0.977 Test Acc: 0.756
Validation loss decreased (-0.734364 --> -0.756240).  Saving model ...
Epoch: 14 cost time: 1.011247158050537
Epoch: 14, Steps: 8 | Train Loss: 0.968 Vali Loss: 0.904 Vali Acc: 0.766 Test Loss: 0.904 Test Acc: 0.766
Validation loss decreased (-0.756240 --> -0.765616).  Saving model ...
Epoch: 15 cost time: 1.2022290229797363
Epoch: 15, Steps: 8 | Train Loss: 0.902 Vali Loss: 0.842 Vali Acc: 0.772 Test Loss: 0.842 Test Acc: 0.772
Validation loss decreased (-0.765616 --> -0.771867).  Saving model ...
Epoch: 16 cost time: 1.0814571380615234
Epoch: 16, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.793 Vali Acc: 0.778 Test Loss: 0.793 Test Acc: 0.778
Validation loss decreased (-0.771867 --> -0.778117).  Saving model ...
Epoch: 17 cost time: 1.2600347995758057
Epoch: 17, Steps: 8 | Train Loss: 0.751 Vali Loss: 0.752 Vali Acc: 0.791 Test Loss: 0.752 Test Acc: 0.791
Validation loss decreased (-0.778117 --> -0.790617).  Saving model ...
Epoch: 18 cost time: 1.1275393962860107
Epoch: 18, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.720 Vali Acc: 0.794 Test Loss: 0.720 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 19 cost time: 1.3656377792358398
Epoch: 19, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 20 cost time: 1.3729000091552734
Epoch: 20, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.665 Vali Acc: 0.794 Test Loss: 0.665 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 21 cost time: 1.3540539741516113
Epoch: 21, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.643 Vali Acc: 0.797 Test Loss: 0.643 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796869).  Saving model ...
Epoch: 22 cost time: 1.2556910514831543
Epoch: 22, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.796869 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 0.9126224517822266
Epoch: 23, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.614 Vali Acc: 0.800 Test Loss: 0.614 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 0.9243183135986328
Epoch: 24, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 25 cost time: 1.1083698272705078
Epoch: 25, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.589 Vali Acc: 0.806 Test Loss: 0.589 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 26 cost time: 1.1114015579223633
Epoch: 26, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.577 Vali Acc: 0.812 Test Loss: 0.577 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 27 cost time: 1.4553556442260742
Epoch: 27, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 28 cost time: 1.0325305461883545
Epoch: 28, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 29 cost time: 1.2824428081512451
Epoch: 29, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.556 Vali Acc: 0.812 Test Loss: 0.556 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2651407718658447
Epoch: 30, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.549 Vali Acc: 0.812 Test Loss: 0.549 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1956162452697754
Epoch: 31, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1297357082366943
Epoch: 32, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815620).  Saving model ...
Epoch: 33 cost time: 1.6024718284606934
Epoch: 33, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
Validation loss decreased (-0.815620 --> -0.815620).  Saving model ...
Epoch: 34 cost time: 1.0843350887298584
Epoch: 34, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.815620 --> -0.815620).  Saving model ...
Epoch: 35 cost time: 1.2329473495483398
Epoch: 35, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
Validation loss decreased (-0.815620 --> -0.818745).  Saving model ...
Epoch: 36 cost time: 1.1785199642181396
Epoch: 36, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4576234817504883
Epoch: 37, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 38 cost time: 1.0961580276489258
Epoch: 38, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 39 cost time: 1.3423914909362793
Epoch: 39, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 40 cost time: 1.1275126934051514
Epoch: 40, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 41 cost time: 1.2113471031188965
Epoch: 41, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 42 cost time: 1.167616605758667
Epoch: 42, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3101999759674072
Epoch: 43, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1040198802947998
Epoch: 44, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3779289722442627
Epoch: 45, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.241515874862671
Epoch: 46, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 47 cost time: 1.037116289138794
Epoch: 47, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 48 cost time: 1.3233544826507568
Epoch: 48, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1117327213287354
Epoch: 49, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9578375816345215
Epoch: 50, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1607465744018555
Epoch: 51, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2674193382263184
Epoch: 52, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0877189636230469
Epoch: 53, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0245988368988037
Epoch: 54, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.0930068492889404
Epoch: 55, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.015378713607788
Epoch: 56, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.0697572231292725
Epoch: 57, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 9896
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8786919116973877
Epoch: 1, Steps: 8 | Train Loss: 2.202 Vali Loss: 2.189 Vali Acc: 0.106 Test Loss: 2.189 Test Acc: 0.106
Validation loss decreased (inf --> -0.106228).  Saving model ...
Epoch: 2 cost time: 1.144338607788086
Epoch: 2, Steps: 8 | Train Loss: 2.159 Vali Loss: 2.141 Vali Acc: 0.106 Test Loss: 2.141 Test Acc: 0.106
Validation loss decreased (-0.106228 --> -0.106229).  Saving model ...
Epoch: 3 cost time: 1.218552827835083
Epoch: 3, Steps: 8 | Train Loss: 2.074 Vali Loss: 2.068 Vali Acc: 0.131 Test Loss: 2.068 Test Acc: 0.131
Validation loss decreased (-0.106229 --> -0.131229).  Saving model ...
Epoch: 4 cost time: 1.1100144386291504
Epoch: 4, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.978 Vali Acc: 0.200 Test Loss: 1.978 Test Acc: 0.200
Validation loss decreased (-0.131229 --> -0.199980).  Saving model ...
Epoch: 5 cost time: 1.0785839557647705
Epoch: 5, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.880 Vali Acc: 0.263 Test Loss: 1.880 Test Acc: 0.263
Validation loss decreased (-0.199980 --> -0.262481).  Saving model ...
Epoch: 6 cost time: 1.2902655601501465
Epoch: 6, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.776 Vali Acc: 0.378 Test Loss: 1.776 Test Acc: 0.378
Validation loss decreased (-0.262481 --> -0.378107).  Saving model ...
Epoch: 7 cost time: 1.2079107761383057
Epoch: 7, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.668 Vali Acc: 0.478 Test Loss: 1.668 Test Acc: 0.478
Validation loss decreased (-0.378107 --> -0.478108).  Saving model ...
Epoch: 8 cost time: 1.259932279586792
Epoch: 8, Steps: 8 | Train Loss: 1.624 Vali Loss: 1.562 Vali Acc: 0.559 Test Loss: 1.562 Test Acc: 0.559
Validation loss decreased (-0.478108 --> -0.559359).  Saving model ...
Epoch: 9 cost time: 1.1421024799346924
Epoch: 9, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.459 Vali Acc: 0.634 Test Loss: 1.459 Test Acc: 0.634
Validation loss decreased (-0.559359 --> -0.634360).  Saving model ...
Epoch: 10 cost time: 1.2385919094085693
Epoch: 10, Steps: 8 | Train Loss: 1.410 Vali Loss: 1.358 Vali Acc: 0.691 Test Loss: 1.358 Test Acc: 0.691
Validation loss decreased (-0.634360 --> -0.690611).  Saving model ...
Epoch: 11 cost time: 1.2081480026245117
Epoch: 11, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.261 Vali Acc: 0.719 Test Loss: 1.261 Test Acc: 0.719
Validation loss decreased (-0.690611 --> -0.718737).  Saving model ...
Epoch: 12 cost time: 1.3484957218170166
Epoch: 12, Steps: 8 | Train Loss: 1.223 Vali Loss: 1.173 Vali Acc: 0.744 Test Loss: 1.173 Test Acc: 0.744
Validation loss decreased (-0.718737 --> -0.743738).  Saving model ...
Epoch: 13 cost time: 1.5030426979064941
Epoch: 13, Steps: 8 | Train Loss: 1.128 Vali Loss: 1.094 Vali Acc: 0.759 Test Loss: 1.094 Test Acc: 0.759
Validation loss decreased (-0.743738 --> -0.759364).  Saving model ...
Epoch: 14 cost time: 1.2635231018066406
Epoch: 14, Steps: 8 | Train Loss: 1.054 Vali Loss: 1.020 Vali Acc: 0.762 Test Loss: 1.020 Test Acc: 0.762
Validation loss decreased (-0.759364 --> -0.762490).  Saving model ...
Epoch: 15 cost time: 1.136110782623291
Epoch: 15, Steps: 8 | Train Loss: 0.973 Vali Loss: 0.958 Vali Acc: 0.772 Test Loss: 0.958 Test Acc: 0.772
Validation loss decreased (-0.762490 --> -0.771865).  Saving model ...
Epoch: 16 cost time: 1.1046373844146729
Epoch: 16, Steps: 8 | Train Loss: 0.892 Vali Loss: 0.909 Vali Acc: 0.769 Test Loss: 0.909 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1982929706573486
Epoch: 17, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
Validation loss decreased (-0.771865 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 1.0383543968200684
Epoch: 18, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.821 Vali Acc: 0.794 Test Loss: 0.821 Test Acc: 0.794
Validation loss decreased (-0.774991 --> -0.793742).  Saving model ...
Epoch: 19 cost time: 1.159172534942627
Epoch: 19, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.787 Vali Acc: 0.787 Test Loss: 0.787 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2086458206176758
Epoch: 20, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.758 Vali Acc: 0.794 Test Loss: 0.758 Test Acc: 0.794
Validation loss decreased (-0.793742 --> -0.793742).  Saving model ...
Epoch: 21 cost time: 1.038236379623413
Epoch: 21, Steps: 8 | Train Loss: 0.657 Vali Loss: 0.733 Vali Acc: 0.794 Test Loss: 0.733 Test Acc: 0.794
Validation loss decreased (-0.793742 --> -0.793743).  Saving model ...
Epoch: 22 cost time: 1.4816036224365234
Epoch: 22, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.2186777591705322
Epoch: 23, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.696 Vali Acc: 0.797 Test Loss: 0.696 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2950811386108398
Epoch: 24, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.679 Vali Acc: 0.791 Test Loss: 0.679 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0092220306396484
Epoch: 25, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.664 Vali Acc: 0.791 Test Loss: 0.664 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3773937225341797
Epoch: 26, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 27 cost time: 1.1301651000976562
Epoch: 27, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3463134765625
Epoch: 28, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4224801063537598
Epoch: 29, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 30 cost time: 1.5261447429656982
Epoch: 30, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 31 cost time: 1.4861540794372559
Epoch: 31, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 32 cost time: 1.042048454284668
Epoch: 32, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
Validation loss decreased (-0.803119 --> -0.806244).  Saving model ...
Epoch: 33 cost time: 1.1213021278381348
Epoch: 33, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.582 Vali Acc: 0.806 Test Loss: 0.582 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 34 cost time: 1.112818956375122
Epoch: 34, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9456827640533447
Epoch: 35, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4092729091644287
Epoch: 36, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.016920804977417
Epoch: 37, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.567 Vali Acc: 0.797 Test Loss: 0.567 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0986950397491455
Epoch: 38, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.456066370010376
Epoch: 39, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1327757835388184
Epoch: 40, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5251376628875732
Epoch: 41, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0849199295043945
Epoch: 42, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.544 Vali Acc: 0.800 Test Loss: 0.544 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2619352340698242
Epoch: 43, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.544 Vali Acc: 0.806 Test Loss: 0.544 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806245).  Saving model ...
Epoch: 44 cost time: 1.1147456169128418
Epoch: 44, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.540 Vali Acc: 0.806 Test Loss: 0.540 Test Acc: 0.806
Validation loss decreased (-0.806245 --> -0.806245).  Saving model ...
Epoch: 45 cost time: 1.303926944732666
Epoch: 45, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5693726539611816
Epoch: 46, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.541 Vali Acc: 0.806 Test Loss: 0.541 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.8047101497650146
Epoch: 47, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.536 Vali Acc: 0.806 Test Loss: 0.536 Test Acc: 0.806
Validation loss decreased (-0.806245 --> -0.806245).  Saving model ...
Epoch: 48 cost time: 1.6662859916687012
Epoch: 48, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.535 Vali Acc: 0.806 Test Loss: 0.535 Test Acc: 0.806
Validation loss decreased (-0.806245 --> -0.806245).  Saving model ...
Epoch: 49 cost time: 1.1469776630401611
Epoch: 49, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.537 Vali Acc: 0.806 Test Loss: 0.537 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2673461437225342
Epoch: 50, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
Validation loss decreased (-0.806245 --> -0.812495).  Saving model ...
Epoch: 51 cost time: 1.2038860321044922
Epoch: 51, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
Validation loss decreased (-0.812495 --> -0.821870).  Saving model ...
Epoch: 52 cost time: 1.092961072921753
Epoch: 52, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3979840278625488
Epoch: 53, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6692273616790771
Epoch: 54, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.6738049983978271
Epoch: 55, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 56 cost time: 1.3020944595336914
Epoch: 56, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 57 cost time: 0.8828887939453125
Epoch: 57, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1509814262390137
Epoch: 58, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.217538833618164
Epoch: 59, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.3688924312591553
Epoch: 60, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.2713751792907715
Epoch: 61, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.533 Vali Acc: 0.806 Test Loss: 0.533 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.3098015785217285
Epoch: 62, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.3318514823913574
Epoch: 63, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.4180006980895996
Epoch: 64, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.4400742053985596
Epoch: 65, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.2815515995025635
Epoch: 66, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df128_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 9384
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3867151737213135
Epoch: 1, Steps: 8 | Train Loss: 2.036 Vali Loss: 1.931 Vali Acc: 0.388 Test Loss: 1.931 Test Acc: 0.388
Validation loss decreased (inf --> -0.387481).  Saving model ...
Epoch: 2 cost time: 1.1336476802825928
Epoch: 2, Steps: 8 | Train Loss: 1.820 Vali Loss: 1.664 Vali Acc: 0.531 Test Loss: 1.664 Test Acc: 0.531
Validation loss decreased (-0.387481 --> -0.531233).  Saving model ...
Epoch: 3 cost time: 1.1540544033050537
Epoch: 3, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.355 Vali Acc: 0.684 Test Loss: 1.355 Test Acc: 0.684
Validation loss decreased (-0.531233 --> -0.684361).  Saving model ...
Epoch: 4 cost time: 1.156080722808838
Epoch: 4, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.065 Vali Acc: 0.791 Test Loss: 1.065 Test Acc: 0.791
Validation loss decreased (-0.684361 --> -0.790614).  Saving model ...
Epoch: 5 cost time: 1.0140202045440674
Epoch: 5, Steps: 8 | Train Loss: 0.987 Vali Loss: 0.847 Vali Acc: 0.803 Test Loss: 0.847 Test Acc: 0.803
Validation loss decreased (-0.790614 --> -0.803117).  Saving model ...
Epoch: 6 cost time: 1.3404920101165771
Epoch: 6, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.703 Vali Acc: 0.812 Test Loss: 0.703 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812493).  Saving model ...
Epoch: 7 cost time: 1.3540489673614502
Epoch: 7, Steps: 8 | Train Loss: 0.613 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.0459468364715576
Epoch: 8, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 0.9312446117401123
Epoch: 9, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.1037328243255615
Epoch: 10, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1668047904968262
Epoch: 11, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 1.2659010887145996
Epoch: 12, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 1.0566596984863281
Epoch: 13, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1543898582458496
Epoch: 14, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3145191669464111
Epoch: 15, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1164748668670654
Epoch: 16, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.062232494354248
Epoch: 17, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2521772384643555
Epoch: 18, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3648781776428223
Epoch: 19, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1723284721374512
Epoch: 20, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1758782863616943
Epoch: 21, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.261026382446289
Epoch: 22, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 33400
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.798961162567139
Epoch: 1, Steps: 8 | Train Loss: 2.061 Vali Loss: 1.933 Vali Acc: 0.275 Test Loss: 1.933 Test Acc: 0.275
Validation loss decreased (inf --> -0.274981).  Saving model ...
Epoch: 2 cost time: 1.3803009986877441
Epoch: 2, Steps: 8 | Train Loss: 1.930 Vali Loss: 1.793 Vali Acc: 0.419 Test Loss: 1.793 Test Acc: 0.419
Validation loss decreased (-0.274981 --> -0.418732).  Saving model ...
Epoch: 3 cost time: 1.081193447113037
Epoch: 3, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.604 Vali Acc: 0.541 Test Loss: 1.604 Test Acc: 0.541
Validation loss decreased (-0.418732 --> -0.540609).  Saving model ...
Epoch: 4 cost time: 1.1093292236328125
Epoch: 4, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.397 Vali Acc: 0.678 Test Loss: 1.397 Test Acc: 0.678
Validation loss decreased (-0.540609 --> -0.678111).  Saving model ...
Epoch: 5 cost time: 1.3034284114837646
Epoch: 5, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.195 Vali Acc: 0.731 Test Loss: 1.195 Test Acc: 0.731
Validation loss decreased (-0.678111 --> -0.731238).  Saving model ...
Epoch: 6 cost time: 1.1405296325683594
Epoch: 6, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.016 Vali Acc: 0.772 Test Loss: 1.016 Test Acc: 0.772
Validation loss decreased (-0.731238 --> -0.771865).  Saving model ...
Epoch: 7 cost time: 0.979572057723999
Epoch: 7, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.870 Vali Acc: 0.787 Test Loss: 0.870 Test Acc: 0.787
Validation loss decreased (-0.771865 --> -0.787491).  Saving model ...
Epoch: 8 cost time: 1.435734510421753
Epoch: 8, Steps: 8 | Train Loss: 0.809 Vali Loss: 0.758 Vali Acc: 0.791 Test Loss: 0.758 Test Acc: 0.791
Validation loss decreased (-0.787491 --> -0.790617).  Saving model ...
Epoch: 9 cost time: 1.1713330745697021
Epoch: 9, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
Validation loss decreased (-0.790617 --> -0.803118).  Saving model ...
Epoch: 10 cost time: 1.592160940170288
Epoch: 10, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
Validation loss decreased (-0.803118 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 1.0767309665679932
Epoch: 11, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 1.4370300769805908
Epoch: 12, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.462219476699829
Epoch: 13, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 1.3531396389007568
Epoch: 14, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 1.2547030448913574
Epoch: 15, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 1.0944533348083496
Epoch: 16, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4536473751068115
Epoch: 17, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3556764125823975
Epoch: 18, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 1.2993009090423584
Epoch: 19, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.512855052947998
Epoch: 20, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 1.1394963264465332
Epoch: 21, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1654071807861328
Epoch: 22, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3487303256988525
Epoch: 23, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4419457912445068
Epoch: 24, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2295782566070557
Epoch: 25, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2667269706726074
Epoch: 26, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3082151412963867
Epoch: 27, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.119718313217163
Epoch: 28, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.375967264175415
Epoch: 29, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1792218685150146
Epoch: 30, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 18552
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.006145715713501
Epoch: 1, Steps: 8 | Train Loss: 2.080 Vali Loss: 1.966 Vali Acc: 0.244 Test Loss: 1.966 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 1.1639413833618164
Epoch: 2, Steps: 8 | Train Loss: 1.977 Vali Loss: 1.865 Vali Acc: 0.350 Test Loss: 1.865 Test Acc: 0.350
Validation loss decreased (-0.243730 --> -0.349981).  Saving model ...
Epoch: 3 cost time: 1.4552302360534668
Epoch: 3, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.730 Vali Acc: 0.453 Test Loss: 1.730 Test Acc: 0.453
Validation loss decreased (-0.349981 --> -0.453108).  Saving model ...
Epoch: 4 cost time: 1.3380694389343262
Epoch: 4, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.572 Vali Acc: 0.625 Test Loss: 1.572 Test Acc: 0.625
Validation loss decreased (-0.453108 --> -0.624984).  Saving model ...
Epoch: 5 cost time: 1.373795747756958
Epoch: 5, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.408 Vali Acc: 0.713 Test Loss: 1.408 Test Acc: 0.713
Validation loss decreased (-0.624984 --> -0.712486).  Saving model ...
Epoch: 6 cost time: 1.4257471561431885
Epoch: 6, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.244 Vali Acc: 0.753 Test Loss: 1.244 Test Acc: 0.753
Validation loss decreased (-0.712486 --> -0.753113).  Saving model ...
Epoch: 7 cost time: 1.1548452377319336
Epoch: 7, Steps: 8 | Train Loss: 1.265 Vali Loss: 1.090 Vali Acc: 0.766 Test Loss: 1.090 Test Acc: 0.766
Validation loss decreased (-0.753113 --> -0.765614).  Saving model ...
Epoch: 8 cost time: 1.6496391296386719
Epoch: 8, Steps: 8 | Train Loss: 1.093 Vali Loss: 0.955 Vali Acc: 0.791 Test Loss: 0.955 Test Acc: 0.791
Validation loss decreased (-0.765614 --> -0.790615).  Saving model ...
Epoch: 9 cost time: 1.7577710151672363
Epoch: 9, Steps: 8 | Train Loss: 0.922 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.790615 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.657682180404663
Epoch: 10, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 1.5211114883422852
Epoch: 11, Steps: 8 | Train Loss: 0.693 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821868).  Saving model ...
Epoch: 12 cost time: 1.4579894542694092
Epoch: 12, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 1.3023607730865479
Epoch: 13, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2678637504577637
Epoch: 14, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 15 cost time: 1.2666385173797607
Epoch: 15, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 16 cost time: 1.1597137451171875
Epoch: 16, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 17 cost time: 1.8620266914367676
Epoch: 17, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 1.4702377319335938
Epoch: 18, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 19 cost time: 1.0312325954437256
Epoch: 19, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 20 cost time: 1.2472760677337646
Epoch: 20, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0566082000732422
Epoch: 21, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 22 cost time: 1.1473541259765625
Epoch: 22, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 23 cost time: 1.0955758094787598
Epoch: 23, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 24 cost time: 1.4749557971954346
Epoch: 24, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 1.762176752090454
Epoch: 25, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1505913734436035
Epoch: 26, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3492989540100098
Epoch: 27, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2334139347076416
Epoch: 28, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 29 cost time: 1.2755815982818604
Epoch: 29, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 1.16391921043396
Epoch: 30, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.161510705947876
Epoch: 31, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.194120168685913
Epoch: 32, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.17391037940979
Epoch: 33, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0891454219818115
Epoch: 34, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3316476345062256
Epoch: 35, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2483274936676025
Epoch: 36, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2413971424102783
Epoch: 37, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3154103755950928
Epoch: 38, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4442071914672852
Epoch: 39, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 13688
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9783005714416504
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.087 Vali Acc: 0.141 Test Loss: 2.087 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 1.1097850799560547
Epoch: 2, Steps: 8 | Train Loss: 2.047 Vali Loss: 1.994 Vali Acc: 0.225 Test Loss: 1.994 Test Acc: 0.225
Validation loss decreased (-0.140604 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 1.2487881183624268
Epoch: 3, Steps: 8 | Train Loss: 2.016 Vali Loss: 1.871 Vali Acc: 0.341 Test Loss: 1.871 Test Acc: 0.341
Validation loss decreased (-0.224980 --> -0.340606).  Saving model ...
Epoch: 4 cost time: 1.3302841186523438
Epoch: 4, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.731 Vali Acc: 0.469 Test Loss: 1.731 Test Acc: 0.469
Validation loss decreased (-0.340606 --> -0.468733).  Saving model ...
Epoch: 5 cost time: 1.1743593215942383
Epoch: 5, Steps: 8 | Train Loss: 1.721 Vali Loss: 1.580 Vali Acc: 0.578 Test Loss: 1.580 Test Acc: 0.578
Validation loss decreased (-0.468733 --> -0.578109).  Saving model ...
Epoch: 6 cost time: 1.0327823162078857
Epoch: 6, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.433 Vali Acc: 0.650 Test Loss: 1.433 Test Acc: 0.650
Validation loss decreased (-0.578109 --> -0.649986).  Saving model ...
Epoch: 7 cost time: 0.9448666572570801
Epoch: 7, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.286 Vali Acc: 0.703 Test Loss: 1.286 Test Acc: 0.703
Validation loss decreased (-0.649986 --> -0.703112).  Saving model ...
Epoch: 8 cost time: 0.8999366760253906
Epoch: 8, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.151 Vali Acc: 0.731 Test Loss: 1.151 Test Acc: 0.731
Validation loss decreased (-0.703112 --> -0.731238).  Saving model ...
Epoch: 9 cost time: 1.0677778720855713
Epoch: 9, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.029 Vali Acc: 0.747 Test Loss: 1.029 Test Acc: 0.747
Validation loss decreased (-0.731238 --> -0.746865).  Saving model ...
Epoch: 10 cost time: 1.1372079849243164
Epoch: 10, Steps: 8 | Train Loss: 1.008 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
Validation loss decreased (-0.746865 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.9941704273223877
Epoch: 11, Steps: 8 | Train Loss: 0.940 Vali Loss: 0.824 Vali Acc: 0.794 Test Loss: 0.824 Test Acc: 0.794
Validation loss decreased (-0.774991 --> -0.793742).  Saving model ...
Epoch: 12 cost time: 1.3011646270751953
Epoch: 12, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.750 Vali Acc: 0.809 Test Loss: 0.750 Test Acc: 0.809
Validation loss decreased (-0.793742 --> -0.809368).  Saving model ...
Epoch: 13 cost time: 1.0034372806549072
Epoch: 13, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.694 Vali Acc: 0.816 Test Loss: 0.694 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815618).  Saving model ...
Epoch: 14 cost time: 1.1417274475097656
Epoch: 14, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 15 cost time: 1.520970106124878
Epoch: 15, Steps: 8 | Train Loss: 0.632 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 16 cost time: 1.1566383838653564
Epoch: 16, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 17 cost time: 1.265925645828247
Epoch: 17, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 18 cost time: 1.4254717826843262
Epoch: 18, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 19 cost time: 1.0102672576904297
Epoch: 19, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 20 cost time: 1.3113524913787842
Epoch: 20, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1037347316741943
Epoch: 21, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0422871112823486
Epoch: 22, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 1.1964035034179688
Epoch: 23, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3479747772216797
Epoch: 24, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5313539505004883
Epoch: 25, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 26 cost time: 1.3219058513641357
Epoch: 26, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 27 cost time: 1.3067777156829834
Epoch: 27, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 28 cost time: 1.5094585418701172
Epoch: 28, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 29 cost time: 1.285402774810791
Epoch: 29, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1669881343841553
Epoch: 30, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 31 cost time: 1.1516907215118408
Epoch: 31, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 32 cost time: 1.2166318893432617
Epoch: 32, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 1.2212097644805908
Epoch: 33, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2036969661712646
Epoch: 34, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.498387098312378
Epoch: 35, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0492229461669922
Epoch: 36, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1348812580108643
Epoch: 37, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 38 cost time: 0.8816137313842773
Epoch: 38, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2587213516235352
Epoch: 39, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9264163970947266
Epoch: 40, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 41 cost time: 1.3875854015350342
Epoch: 41, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4268569946289062
Epoch: 42, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3698389530181885
Epoch: 43, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0137357711791992
Epoch: 44, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0542664527893066
Epoch: 45, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2972915172576904
Epoch: 46, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2983636856079102
Epoch: 47, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1360108852386475
Epoch: 48, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.6124210357666016
Epoch: 49, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1322486400604248
Epoch: 50, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 11128
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.811816930770874
Epoch: 1, Steps: 8 | Train Loss: 2.225 Vali Loss: 2.092 Vali Acc: 0.172 Test Loss: 2.092 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.9337098598480225
Epoch: 2, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.033 Vali Acc: 0.206 Test Loss: 2.033 Test Acc: 0.206
Validation loss decreased (-0.171854 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 1.0820927619934082
Epoch: 3, Steps: 8 | Train Loss: 2.075 Vali Loss: 1.950 Vali Acc: 0.275 Test Loss: 1.950 Test Acc: 0.275
Validation loss decreased (-0.206230 --> -0.274981).  Saving model ...
Epoch: 4 cost time: 0.9394967555999756
Epoch: 4, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.853 Vali Acc: 0.372 Test Loss: 1.853 Test Acc: 0.372
Validation loss decreased (-0.274981 --> -0.371856).  Saving model ...
Epoch: 5 cost time: 0.7699978351593018
Epoch: 5, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.745 Vali Acc: 0.419 Test Loss: 1.745 Test Acc: 0.419
Validation loss decreased (-0.371856 --> -0.418733).  Saving model ...
Epoch: 6 cost time: 0.8755009174346924
Epoch: 6, Steps: 8 | Train Loss: 1.760 Vali Loss: 1.633 Vali Acc: 0.512 Test Loss: 1.633 Test Acc: 0.512
Validation loss decreased (-0.418733 --> -0.512484).  Saving model ...
Epoch: 7 cost time: 0.9975435733795166
Epoch: 7, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.523 Vali Acc: 0.581 Test Loss: 1.523 Test Acc: 0.581
Validation loss decreased (-0.512484 --> -0.581235).  Saving model ...
Epoch: 8 cost time: 1.1891677379608154
Epoch: 8, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.411 Vali Acc: 0.628 Test Loss: 1.411 Test Acc: 0.628
Validation loss decreased (-0.581235 --> -0.628111).  Saving model ...
Epoch: 9 cost time: 0.9827876091003418
Epoch: 9, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.303 Vali Acc: 0.669 Test Loss: 1.303 Test Acc: 0.669
Validation loss decreased (-0.628111 --> -0.668737).  Saving model ...
Epoch: 10 cost time: 0.9457035064697266
Epoch: 10, Steps: 8 | Train Loss: 1.275 Vali Loss: 1.196 Vali Acc: 0.703 Test Loss: 1.196 Test Acc: 0.703
Validation loss decreased (-0.668737 --> -0.703113).  Saving model ...
Epoch: 11 cost time: 1.3274872303009033
Epoch: 11, Steps: 8 | Train Loss: 1.147 Vali Loss: 1.098 Vali Acc: 0.713 Test Loss: 1.098 Test Acc: 0.713
Validation loss decreased (-0.703113 --> -0.712489).  Saving model ...
Epoch: 12 cost time: 0.9945857524871826
Epoch: 12, Steps: 8 | Train Loss: 1.091 Vali Loss: 1.005 Vali Acc: 0.741 Test Loss: 1.005 Test Acc: 0.741
Validation loss decreased (-0.712489 --> -0.740615).  Saving model ...
Epoch: 13 cost time: 1.0784802436828613
Epoch: 13, Steps: 8 | Train Loss: 0.953 Vali Loss: 0.923 Vali Acc: 0.762 Test Loss: 0.923 Test Acc: 0.762
Validation loss decreased (-0.740615 --> -0.762491).  Saving model ...
Epoch: 14 cost time: 1.2086825370788574
Epoch: 14, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.853 Vali Acc: 0.766 Test Loss: 0.853 Test Acc: 0.766
Validation loss decreased (-0.762491 --> -0.765616).  Saving model ...
Epoch: 15 cost time: 1.0488860607147217
Epoch: 15, Steps: 8 | Train Loss: 0.739 Vali Loss: 0.792 Vali Acc: 0.778 Test Loss: 0.792 Test Acc: 0.778
Validation loss decreased (-0.765616 --> -0.778117).  Saving model ...
Epoch: 16 cost time: 1.1383366584777832
Epoch: 16, Steps: 8 | Train Loss: 0.717 Vali Loss: 0.745 Vali Acc: 0.791 Test Loss: 0.745 Test Acc: 0.791
Validation loss decreased (-0.778117 --> -0.790618).  Saving model ...
Epoch: 17 cost time: 1.0032246112823486
Epoch: 17, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.790618 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.9739458560943604
Epoch: 18, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803118).  Saving model ...
Epoch: 19 cost time: 1.1183180809020996
Epoch: 19, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 20 cost time: 1.0243585109710693
Epoch: 20, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818744).  Saving model ...
Epoch: 21 cost time: 1.0395433902740479
Epoch: 21, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.091721534729004
Epoch: 22, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4546945095062256
Epoch: 23, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 24 cost time: 1.0977931022644043
Epoch: 24, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 25 cost time: 1.292633056640625
Epoch: 25, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 1.379678726196289
Epoch: 26, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2434189319610596
Epoch: 27, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 0.9133734703063965
Epoch: 28, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 29 cost time: 1.0203752517700195
Epoch: 29, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9571895599365234
Epoch: 30, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0474121570587158
Epoch: 31, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1831741333007812
Epoch: 32, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1461286544799805
Epoch: 33, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0474748611450195
Epoch: 34, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2037181854248047
Epoch: 35, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0759661197662354
Epoch: 36, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.161595106124878
Epoch: 37, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.263850450515747
Epoch: 38, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 9080
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2637813091278076
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.048 Vali Acc: 0.212 Test Loss: 2.048 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 1.3487226963043213
Epoch: 2, Steps: 8 | Train Loss: 2.097 Vali Loss: 2.000 Vali Acc: 0.244 Test Loss: 2.000 Test Acc: 0.244
Validation loss decreased (-0.212480 --> -0.243730).  Saving model ...
Epoch: 3 cost time: 1.133582592010498
Epoch: 3, Steps: 8 | Train Loss: 2.074 Vali Loss: 1.925 Vali Acc: 0.275 Test Loss: 1.925 Test Acc: 0.275
Validation loss decreased (-0.243730 --> -0.274981).  Saving model ...
Epoch: 4 cost time: 1.5386428833007812
Epoch: 4, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.833 Vali Acc: 0.344 Test Loss: 1.833 Test Acc: 0.344
Validation loss decreased (-0.274981 --> -0.343732).  Saving model ...
Epoch: 5 cost time: 1.4113807678222656
Epoch: 5, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.730 Vali Acc: 0.406 Test Loss: 1.730 Test Acc: 0.406
Validation loss decreased (-0.343732 --> -0.406233).  Saving model ...
Epoch: 6 cost time: 1.5956025123596191
Epoch: 6, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.625 Vali Acc: 0.484 Test Loss: 1.625 Test Acc: 0.484
Validation loss decreased (-0.406233 --> -0.484359).  Saving model ...
Epoch: 7 cost time: 1.1879298686981201
Epoch: 7, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.513 Vali Acc: 0.541 Test Loss: 1.513 Test Acc: 0.541
Validation loss decreased (-0.484359 --> -0.540610).  Saving model ...
Epoch: 8 cost time: 1.5440030097961426
Epoch: 8, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.407 Vali Acc: 0.597 Test Loss: 1.407 Test Acc: 0.597
Validation loss decreased (-0.540610 --> -0.596861).  Saving model ...
Epoch: 9 cost time: 1.5630693435668945
Epoch: 9, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.301 Vali Acc: 0.669 Test Loss: 1.301 Test Acc: 0.669
Validation loss decreased (-0.596861 --> -0.668737).  Saving model ...
Epoch: 10 cost time: 1.2431063652038574
Epoch: 10, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.199 Vali Acc: 0.719 Test Loss: 1.199 Test Acc: 0.719
Validation loss decreased (-0.668737 --> -0.718738).  Saving model ...
Epoch: 11 cost time: 1.0774426460266113
Epoch: 11, Steps: 8 | Train Loss: 1.184 Vali Loss: 1.109 Vali Acc: 0.744 Test Loss: 1.109 Test Acc: 0.744
Validation loss decreased (-0.718738 --> -0.743739).  Saving model ...
Epoch: 12 cost time: 1.4988186359405518
Epoch: 12, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.021 Vali Acc: 0.762 Test Loss: 1.021 Test Acc: 0.762
Validation loss decreased (-0.743739 --> -0.762490).  Saving model ...
Epoch: 13 cost time: 1.113265037536621
Epoch: 13, Steps: 8 | Train Loss: 0.986 Vali Loss: 0.948 Vali Acc: 0.772 Test Loss: 0.948 Test Acc: 0.772
Validation loss decreased (-0.762490 --> -0.771866).  Saving model ...
Epoch: 14 cost time: 1.2661855220794678
Epoch: 14, Steps: 8 | Train Loss: 0.936 Vali Loss: 0.885 Vali Acc: 0.781 Test Loss: 0.885 Test Acc: 0.781
Validation loss decreased (-0.771866 --> -0.781241).  Saving model ...
Epoch: 15 cost time: 1.3788676261901855
Epoch: 15, Steps: 8 | Train Loss: 0.839 Vali Loss: 0.829 Vali Acc: 0.784 Test Loss: 0.829 Test Acc: 0.784
Validation loss decreased (-0.781241 --> -0.784367).  Saving model ...
Epoch: 16 cost time: 1.445601463317871
Epoch: 16, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.785 Vali Acc: 0.787 Test Loss: 0.785 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787492).  Saving model ...
Epoch: 17 cost time: 1.3454782962799072
Epoch: 17, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.747 Vali Acc: 0.794 Test Loss: 0.747 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 18 cost time: 1.6224772930145264
Epoch: 18, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 19 cost time: 1.621279239654541
Epoch: 19, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803118).  Saving model ...
Epoch: 20 cost time: 1.748490571975708
Epoch: 20, Steps: 8 | Train Loss: 0.632 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803118).  Saving model ...
Epoch: 21 cost time: 1.178952693939209
Epoch: 21, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.134305715560913
Epoch: 22, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 23 cost time: 1.4598114490509033
Epoch: 23, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.627 Vali Acc: 0.806 Test Loss: 0.627 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 24 cost time: 1.1917245388031006
Epoch: 24, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.615 Vali Acc: 0.806 Test Loss: 0.615 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 25 cost time: 1.534924030303955
Epoch: 25, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.606 Vali Acc: 0.806 Test Loss: 0.606 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 26 cost time: 1.3396830558776855
Epoch: 26, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.599 Vali Acc: 0.812 Test Loss: 0.599 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 27 cost time: 1.713273048400879
Epoch: 27, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 28 cost time: 1.1638031005859375
Epoch: 28, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 29 cost time: 1.4113750457763672
Epoch: 29, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 30 cost time: 1.3168840408325195
Epoch: 30, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2856814861297607
Epoch: 31, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.549276351928711
Epoch: 32, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 33 cost time: 1.5308318138122559
Epoch: 33, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3977007865905762
Epoch: 34, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.111018180847168
Epoch: 35, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3419184684753418
Epoch: 36, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6841864585876465
Epoch: 37, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3050673007965088
Epoch: 38, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 39 cost time: 1.2604317665100098
Epoch: 39, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4747569561004639
Epoch: 40, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 41 cost time: 1.3078436851501465
Epoch: 41, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 42 cost time: 1.6005642414093018
Epoch: 42, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 43 cost time: 1.1765258312225342
Epoch: 43, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 44 cost time: 1.1162974834442139
Epoch: 44, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 45 cost time: 1.2076783180236816
Epoch: 45, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1108675003051758
Epoch: 46, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2222373485565186
Epoch: 47, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.5656585693359375
Epoch: 48, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 49 cost time: 1.5514295101165771
Epoch: 49, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 50 cost time: 1.4766244888305664
Epoch: 50, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 51 cost time: 1.0870451927185059
Epoch: 51, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1729671955108643
Epoch: 52, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.06251859664917
Epoch: 53, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 54 cost time: 1.155625820159912
Epoch: 54, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.7154746055603027
Epoch: 55, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 56 cost time: 1.2867038249969482
Epoch: 56, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9510695934295654
Epoch: 57, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.377699613571167
Epoch: 58, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5175786018371582
Epoch: 59, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.167128324508667
Epoch: 60, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.3910162448883057
Epoch: 61, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.5867321491241455
Epoch: 62, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.345362663269043
Epoch: 63, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.5828444957733154
Epoch: 64, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.6114802360534668
Epoch: 65, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 7784
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps79_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.459160089492798
Epoch: 1, Steps: 8 | Train Loss: 2.304 Vali Loss: 2.281 Vali Acc: 0.125 Test Loss: 2.281 Test Acc: 0.125
Validation loss decreased (inf --> -0.124977).  Saving model ...
Epoch: 2 cost time: 1.5049951076507568
Epoch: 2, Steps: 8 | Train Loss: 2.292 Vali Loss: 2.216 Vali Acc: 0.138 Test Loss: 2.216 Test Acc: 0.138
Validation loss decreased (-0.124977 --> -0.137478).  Saving model ...
Epoch: 3 cost time: 1.5511598587036133
Epoch: 3, Steps: 8 | Train Loss: 2.229 Vali Loss: 2.133 Vali Acc: 0.175 Test Loss: 2.133 Test Acc: 0.175
Validation loss decreased (-0.137478 --> -0.174979).  Saving model ...
Epoch: 4 cost time: 1.7802977561950684
Epoch: 4, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.035 Vali Acc: 0.250 Test Loss: 2.035 Test Acc: 0.250
Validation loss decreased (-0.174979 --> -0.249980).  Saving model ...
Epoch: 5 cost time: 1.5700135231018066
Epoch: 5, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.935 Vali Acc: 0.338 Test Loss: 1.935 Test Acc: 0.338
Validation loss decreased (-0.249980 --> -0.337481).  Saving model ...
Epoch: 6 cost time: 0.9627420902252197
Epoch: 6, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.828 Vali Acc: 0.409 Test Loss: 1.828 Test Acc: 0.409
Validation loss decreased (-0.337481 --> -0.409357).  Saving model ...
Epoch: 7 cost time: 1.2351434230804443
Epoch: 7, Steps: 8 | Train Loss: 1.862 Vali Loss: 1.716 Vali Acc: 0.453 Test Loss: 1.716 Test Acc: 0.453
Validation loss decreased (-0.409357 --> -0.453108).  Saving model ...
Epoch: 8 cost time: 1.0287606716156006
Epoch: 8, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.609 Vali Acc: 0.497 Test Loss: 1.609 Test Acc: 0.497
Validation loss decreased (-0.453108 --> -0.496859).  Saving model ...
Epoch: 9 cost time: 1.0089523792266846
Epoch: 9, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.506 Vali Acc: 0.584 Test Loss: 1.506 Test Acc: 0.584
Validation loss decreased (-0.496859 --> -0.584360).  Saving model ...
Epoch: 10 cost time: 1.5809319019317627
Epoch: 10, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.395 Vali Acc: 0.647 Test Loss: 1.395 Test Acc: 0.647
Validation loss decreased (-0.584360 --> -0.646861).  Saving model ...
Epoch: 11 cost time: 1.298753261566162
Epoch: 11, Steps: 8 | Train Loss: 1.354 Vali Loss: 1.291 Vali Acc: 0.697 Test Loss: 1.291 Test Acc: 0.697
Validation loss decreased (-0.646861 --> -0.696862).  Saving model ...
Epoch: 12 cost time: 1.3106858730316162
Epoch: 12, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.196 Vali Acc: 0.716 Test Loss: 1.196 Test Acc: 0.716
Validation loss decreased (-0.696862 --> -0.715613).  Saving model ...
Epoch: 13 cost time: 1.3469808101654053
Epoch: 13, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.109 Vali Acc: 0.750 Test Loss: 1.109 Test Acc: 0.750
Validation loss decreased (-0.715613 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 1.8953793048858643
Epoch: 14, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.033 Vali Acc: 0.762 Test Loss: 1.033 Test Acc: 0.762
Validation loss decreased (-0.749989 --> -0.762490).  Saving model ...
Epoch: 15 cost time: 1.3926503658294678
Epoch: 15, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.965 Vali Acc: 0.778 Test Loss: 0.965 Test Acc: 0.778
Validation loss decreased (-0.762490 --> -0.778115).  Saving model ...
Epoch: 16 cost time: 1.308002233505249
Epoch: 16, Steps: 8 | Train Loss: 1.004 Vali Loss: 0.907 Vali Acc: 0.772 Test Loss: 0.907 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6993904113769531
Epoch: 17, Steps: 8 | Train Loss: 0.861 Vali Loss: 0.858 Vali Acc: 0.778 Test Loss: 0.858 Test Acc: 0.778
Validation loss decreased (-0.778115 --> -0.778116).  Saving model ...
Epoch: 18 cost time: 1.3316683769226074
Epoch: 18, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.821 Vali Acc: 0.781 Test Loss: 0.821 Test Acc: 0.781
Validation loss decreased (-0.778116 --> -0.781242).  Saving model ...
Epoch: 19 cost time: 1.1539499759674072
Epoch: 19, Steps: 8 | Train Loss: 0.764 Vali Loss: 0.787 Vali Acc: 0.784 Test Loss: 0.787 Test Acc: 0.784
Validation loss decreased (-0.781242 --> -0.784367).  Saving model ...
Epoch: 20 cost time: 1.127732276916504
Epoch: 20, Steps: 8 | Train Loss: 0.684 Vali Loss: 0.758 Vali Acc: 0.784 Test Loss: 0.758 Test Acc: 0.784
Validation loss decreased (-0.784367 --> -0.784367).  Saving model ...
Epoch: 21 cost time: 1.7488880157470703
Epoch: 21, Steps: 8 | Train Loss: 0.690 Vali Loss: 0.732 Vali Acc: 0.794 Test Loss: 0.732 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793743).  Saving model ...
Epoch: 22 cost time: 1.1568162441253662
Epoch: 22, Steps: 8 | Train Loss: 0.656 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.793743 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.2717275619506836
Epoch: 23, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 1.2156951427459717
Epoch: 24, Steps: 8 | Train Loss: 0.639 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 1.0922489166259766
Epoch: 25, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 1.4421985149383545
Epoch: 26, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 27 cost time: 1.2737324237823486
Epoch: 27, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.635 Vali Acc: 0.806 Test Loss: 0.635 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.743034839630127
Epoch: 28, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.623 Vali Acc: 0.806 Test Loss: 0.623 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.448378086090088
Epoch: 29, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 30 cost time: 1.2521040439605713
Epoch: 30, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 31 cost time: 1.0815882682800293
Epoch: 31, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 32 cost time: 1.6079068183898926
Epoch: 32, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 33 cost time: 1.8131203651428223
Epoch: 33, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 34 cost time: 1.8224191665649414
Epoch: 34, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 35 cost time: 1.087082862854004
Epoch: 35, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 36 cost time: 1.2216777801513672
Epoch: 36, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 37 cost time: 1.0365033149719238
Epoch: 37, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 38 cost time: 1.3256688117980957
Epoch: 38, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 39 cost time: 1.6788074970245361
Epoch: 39, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 40 cost time: 1.177201509475708
Epoch: 40, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815620).  Saving model ...
Epoch: 41 cost time: 1.3526761531829834
Epoch: 41, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
Validation loss decreased (-0.815620 --> -0.815620).  Saving model ...
Epoch: 42 cost time: 1.3446364402770996
Epoch: 42, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.815620 --> -0.818745).  Saving model ...
Epoch: 43 cost time: 1.4421253204345703
Epoch: 43, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 44 cost time: 1.2854058742523193
Epoch: 44, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 45 cost time: 1.4593615531921387
Epoch: 45, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
Validation loss decreased (-0.818745 --> -0.824995).  Saving model ...
Epoch: 46 cost time: 1.0412561893463135
Epoch: 46, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 47 cost time: 1.2754342555999756
Epoch: 47, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.26871919631958
Epoch: 48, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1626904010772705
Epoch: 49, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.4808080196380615
Epoch: 50, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 51 cost time: 1.2880995273590088
Epoch: 51, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 52 cost time: 1.3493478298187256
Epoch: 52, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 53 cost time: 1.329871654510498
Epoch: 53, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 54 cost time: 1.3744821548461914
Epoch: 54, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 55 cost time: 1.634260654449463
Epoch: 55, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.4526102542877197
Epoch: 56, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.3749098777770996
Epoch: 57, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.5233054161071777
Epoch: 58, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.0338521003723145
Epoch: 59, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.052375078201294
Epoch: 60, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1240711212158203
Epoch: 61, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.110640287399292
Epoch: 62, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.7018024921417236
Epoch: 63, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.4346239566802979
Epoch: 64, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_PatchTST_UEA_ftM_sl315_ll0_pl0_el1_dm16_nh4_df64_ps79_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 7272
model size : 0.34MB
