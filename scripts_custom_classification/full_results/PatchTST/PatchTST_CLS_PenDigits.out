Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5334550
	speed: 0.0502s/iter; left time: 2348.6143s
	iters: 200, epoch: 1 | loss: 0.3427986
	speed: 0.0364s/iter; left time: 1698.0750s
	iters: 300, epoch: 1 | loss: 0.0394759
	speed: 0.0371s/iter; left time: 1730.7887s
	iters: 400, epoch: 1 | loss: 0.0253544
	speed: 0.0378s/iter; left time: 1759.8355s
Epoch: 1 cost time: 18.70102286338806
Epoch: 1, Steps: 469 | Train Loss: 0.428 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (inf --> -0.948826).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3447060
	speed: 0.1817s/iter; left time: 8416.4573s
	iters: 200, epoch: 2 | loss: 0.0628642
	speed: 0.0308s/iter; left time: 1421.8568s
	iters: 300, epoch: 2 | loss: 0.0274098
	speed: 0.0309s/iter; left time: 1425.7326s
	iters: 400, epoch: 2 | loss: 0.0558624
	speed: 0.0310s/iter; left time: 1426.2907s
Epoch: 2 cost time: 14.719828844070435
Epoch: 2, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.948826 --> -0.951685).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1862094
	speed: 0.1739s/iter; left time: 7975.9198s
	iters: 200, epoch: 3 | loss: 0.0028291
	speed: 0.0304s/iter; left time: 1388.9546s
	iters: 300, epoch: 3 | loss: 0.0419707
	speed: 0.0311s/iter; left time: 1419.2309s
	iters: 400, epoch: 3 | loss: 0.1545835
	speed: 0.0302s/iter; left time: 1377.8310s
Epoch: 3 cost time: 14.975840091705322
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.951685 --> -0.956259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2182611
	speed: 0.2092s/iter; left time: 9497.8658s
	iters: 200, epoch: 4 | loss: 0.0298824
	speed: 0.0362s/iter; left time: 1638.8140s
	iters: 300, epoch: 4 | loss: 0.0300971
	speed: 0.0371s/iter; left time: 1675.6661s
	iters: 400, epoch: 4 | loss: 0.0042432
	speed: 0.0376s/iter; left time: 1693.9513s
Epoch: 4 cost time: 18.11092448234558
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
Validation loss decreased (-0.956259 --> -0.959117).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1276222
	speed: 0.2227s/iter; left time: 10005.8366s
	iters: 200, epoch: 5 | loss: 0.0179482
	speed: 0.0363s/iter; left time: 1628.1801s
	iters: 300, epoch: 5 | loss: 0.0000801
	speed: 0.0400s/iter; left time: 1789.8140s
	iters: 400, epoch: 5 | loss: 0.0145878
	speed: 0.0405s/iter; left time: 1808.4113s
Epoch: 5 cost time: 18.595003604888916
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2679580
	speed: 0.2232s/iter; left time: 9920.6373s
	iters: 200, epoch: 6 | loss: 0.3433564
	speed: 0.0361s/iter; left time: 1600.2065s
	iters: 300, epoch: 6 | loss: 0.2223836
	speed: 0.0378s/iter; left time: 1673.3495s
	iters: 400, epoch: 6 | loss: 0.0034816
	speed: 0.0395s/iter; left time: 1746.0251s
Epoch: 6 cost time: 18.229027271270752
Epoch: 6, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.352 Vali Acc: 0.940 Test Loss: 0.352 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0075640
	speed: 0.2077s/iter; left time: 9136.9091s
	iters: 200, epoch: 7 | loss: 0.0030938
	speed: 0.0347s/iter; left time: 1523.5831s
	iters: 300, epoch: 7 | loss: 0.0011157
	speed: 0.0360s/iter; left time: 1575.7404s
	iters: 400, epoch: 7 | loss: 0.1334711
	speed: 0.0378s/iter; left time: 1650.0561s
Epoch: 7 cost time: 17.34477162361145
Epoch: 7, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.385 Vali Acc: 0.923 Test Loss: 0.385 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0007758
	speed: 0.2078s/iter; left time: 9042.5367s
	iters: 200, epoch: 8 | loss: 0.5438213
	speed: 0.0352s/iter; left time: 1529.8278s
	iters: 300, epoch: 8 | loss: 0.0223893
	speed: 0.0352s/iter; left time: 1524.3157s
	iters: 400, epoch: 8 | loss: 0.1214522
	speed: 0.0373s/iter; left time: 1613.3720s
Epoch: 8 cost time: 17.40575909614563
Epoch: 8, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.347 Vali Acc: 0.937 Test Loss: 0.347 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1371311
	speed: 0.2048s/iter; left time: 8816.9905s
	iters: 200, epoch: 9 | loss: 0.0022102
	speed: 0.0359s/iter; left time: 1541.1352s
	iters: 300, epoch: 9 | loss: 0.3373576
	speed: 0.0348s/iter; left time: 1493.0373s
	iters: 400, epoch: 9 | loss: 0.2776237
	speed: 0.0359s/iter; left time: 1535.8796s
Epoch: 9 cost time: 17.425825595855713
Epoch: 9, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.339 Vali Acc: 0.944 Test Loss: 0.339 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5049862
	speed: 0.2092s/iter; left time: 8905.8151s
	iters: 200, epoch: 10 | loss: 0.0107061
	speed: 0.0355s/iter; left time: 1506.3946s
	iters: 300, epoch: 10 | loss: 0.0062171
	speed: 0.0351s/iter; left time: 1486.3441s
	iters: 400, epoch: 10 | loss: 1.2331042
	speed: 0.0365s/iter; left time: 1542.0962s
Epoch: 10 cost time: 17.631174564361572
Epoch: 10, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0024264
	speed: 0.2098s/iter; left time: 8836.9925s
	iters: 200, epoch: 11 | loss: 0.0416139
	speed: 0.0395s/iter; left time: 1658.8091s
	iters: 300, epoch: 11 | loss: 0.0060579
	speed: 0.0353s/iter; left time: 1477.7694s
	iters: 400, epoch: 11 | loss: 0.0018513
	speed: 0.0364s/iter; left time: 1519.8624s
Epoch: 11 cost time: 17.711767196655273
Epoch: 11, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.5795835
	speed: 0.1946s/iter; left time: 8102.4875s
	iters: 200, epoch: 12 | loss: 0.1666457
	speed: 0.0313s/iter; left time: 1300.3461s
	iters: 300, epoch: 12 | loss: 0.1307347
	speed: 0.0334s/iter; left time: 1382.6736s
	iters: 400, epoch: 12 | loss: 0.1487471
	speed: 0.0333s/iter; left time: 1376.4549s
Epoch: 12 cost time: 15.768993377685547
Epoch: 12, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0759324
	speed: 0.1816s/iter; left time: 7476.2303s
	iters: 200, epoch: 13 | loss: 0.0000803
	speed: 0.0335s/iter; left time: 1375.9357s
	iters: 300, epoch: 13 | loss: 0.0020020
	speed: 0.0384s/iter; left time: 1574.9344s
	iters: 400, epoch: 13 | loss: 0.0419119
	speed: 0.0378s/iter; left time: 1545.8262s
Epoch: 13 cost time: 17.127814054489136
Epoch: 13, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0179409
	speed: 0.2169s/iter; left time: 8826.9258s
	iters: 200, epoch: 14 | loss: 0.2007831
	speed: 0.0352s/iter; left time: 1427.6175s
	iters: 300, epoch: 14 | loss: 0.0068315
	speed: 0.0384s/iter; left time: 1553.6550s
	iters: 400, epoch: 14 | loss: 0.0019634
	speed: 0.0342s/iter; left time: 1383.3591s
Epoch: 14 cost time: 17.600648403167725
Epoch: 14, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.374 Vali Acc: 0.935 Test Loss: 0.374 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9591194968553459
model parameter : 418442
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4030466
	speed: 0.0717s/iter; left time: 3353.8928s
	iters: 200, epoch: 1 | loss: 0.4113066
	speed: 0.0518s/iter; left time: 2418.9050s
	iters: 300, epoch: 1 | loss: 0.1334946
	speed: 0.0566s/iter; left time: 2636.6319s
	iters: 400, epoch: 1 | loss: 0.1093668
	speed: 0.0521s/iter; left time: 2424.3523s
Epoch: 1 cost time: 26.44405221939087
Epoch: 1, Steps: 469 | Train Loss: 0.440 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (inf --> -0.944252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0218579
	speed: 0.2143s/iter; left time: 9930.1172s
	iters: 200, epoch: 2 | loss: 0.0899048
	speed: 0.0410s/iter; left time: 1897.7430s
	iters: 300, epoch: 2 | loss: 0.1543546
	speed: 0.0415s/iter; left time: 1916.4389s
	iters: 400, epoch: 2 | loss: 0.0252412
	speed: 0.0396s/iter; left time: 1821.4803s
Epoch: 2 cost time: 19.451891899108887
Epoch: 2, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
Validation loss decreased (-0.944252 --> -0.953114).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0073678
	speed: 0.1797s/iter; left time: 8239.3269s
	iters: 200, epoch: 3 | loss: 0.4101183
	speed: 0.0312s/iter; left time: 1429.7518s
	iters: 300, epoch: 3 | loss: 0.0065384
	speed: 0.0307s/iter; left time: 1403.4242s
	iters: 400, epoch: 3 | loss: 0.0058548
	speed: 0.0288s/iter; left time: 1311.4259s
Epoch: 3 cost time: 14.598994493484497
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0631051
	speed: 0.1685s/iter; left time: 7647.8184s
	iters: 200, epoch: 4 | loss: 0.0006158
	speed: 0.0324s/iter; left time: 1466.1780s
	iters: 300, epoch: 4 | loss: 0.0757323
	speed: 0.0419s/iter; left time: 1892.9239s
	iters: 400, epoch: 4 | loss: 0.0711429
	speed: 0.0371s/iter; left time: 1674.9799s
Epoch: 4 cost time: 18.175384044647217
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000689
	speed: 0.2202s/iter; left time: 9890.3727s
	iters: 200, epoch: 5 | loss: 0.0778082
	speed: 0.0432s/iter; left time: 1934.7195s
	iters: 300, epoch: 5 | loss: 0.0029694
	speed: 0.0412s/iter; left time: 1840.9950s
	iters: 400, epoch: 5 | loss: 0.0021395
	speed: 0.0436s/iter; left time: 1943.5614s
Epoch: 5 cost time: 20.26082444190979
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.382 Vali Acc: 0.923 Test Loss: 0.382 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0026311
	speed: 0.2149s/iter; left time: 9554.0563s
	iters: 200, epoch: 6 | loss: 0.0078367
	speed: 0.0527s/iter; left time: 2335.5175s
	iters: 300, epoch: 6 | loss: 0.1616998
	speed: 0.0499s/iter; left time: 2208.7275s
	iters: 400, epoch: 6 | loss: 0.1731776
	speed: 0.0486s/iter; left time: 2146.8729s
Epoch: 6 cost time: 24.265090465545654
Epoch: 6, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.282 Vali Acc: 0.951 Test Loss: 0.282 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0226983
	speed: 0.2316s/iter; left time: 10187.4857s
	iters: 200, epoch: 7 | loss: 0.0521390
	speed: 0.0405s/iter; left time: 1777.8918s
	iters: 300, epoch: 7 | loss: 0.1943674
	speed: 0.0369s/iter; left time: 1615.0928s
	iters: 400, epoch: 7 | loss: 0.0085910
	speed: 0.0399s/iter; left time: 1743.0500s
Epoch: 7 cost time: 19.695324420928955
Epoch: 7, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0043233
	speed: 0.1870s/iter; left time: 8137.9997s
	iters: 200, epoch: 8 | loss: 0.0122912
	speed: 0.0434s/iter; left time: 1883.7988s
	iters: 300, epoch: 8 | loss: 0.0002457
	speed: 0.0457s/iter; left time: 1978.6076s
	iters: 400, epoch: 8 | loss: 0.1025585
	speed: 0.0438s/iter; left time: 1891.7306s
Epoch: 8 cost time: 20.386943817138672
Epoch: 8, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.408 Vali Acc: 0.932 Test Loss: 0.408 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0255714
	speed: 0.2141s/iter; left time: 9218.2133s
	iters: 200, epoch: 9 | loss: 0.1610114
	speed: 0.0479s/iter; left time: 2057.0535s
	iters: 300, epoch: 9 | loss: 0.2478561
	speed: 0.0459s/iter; left time: 1966.1253s
	iters: 400, epoch: 9 | loss: 0.0501899
	speed: 0.0442s/iter; left time: 1887.8668s
Epoch: 9 cost time: 22.617282152175903
Epoch: 9, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0001044
	speed: 0.2181s/iter; left time: 9285.0053s
	iters: 200, epoch: 10 | loss: 0.2261407
	speed: 0.0428s/iter; left time: 1819.8824s
	iters: 300, epoch: 10 | loss: 0.3143606
	speed: 0.0393s/iter; left time: 1667.4314s
	iters: 400, epoch: 10 | loss: 0.0001541
	speed: 0.0440s/iter; left time: 1861.9593s
Epoch: 10 cost time: 20.46482491493225
Epoch: 10, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.346 Vali Acc: 0.948 Test Loss: 0.346 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0003902
	speed: 0.2028s/iter; left time: 8539.8231s
	iters: 200, epoch: 11 | loss: 0.0128879
	speed: 0.0415s/iter; left time: 1745.1840s
	iters: 300, epoch: 11 | loss: 1.2260009
	speed: 0.0495s/iter; left time: 2075.1835s
	iters: 400, epoch: 11 | loss: 0.0159271
	speed: 0.0470s/iter; left time: 1965.4218s
Epoch: 11 cost time: 21.352020502090454
Epoch: 11, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.350 Vali Acc: 0.955 Test Loss: 0.350 Test Acc: 0.955
Validation loss decreased (-0.953114 --> -0.955114).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1008738
	speed: 0.2100s/iter; left time: 8744.5753s
	iters: 200, epoch: 12 | loss: 0.0969200
	speed: 0.0368s/iter; left time: 1530.1139s
	iters: 300, epoch: 12 | loss: 0.0011764
	speed: 0.0392s/iter; left time: 1624.9591s
	iters: 400, epoch: 12 | loss: 0.5742555
	speed: 0.0401s/iter; left time: 1657.8336s
Epoch: 12 cost time: 19.11033034324646
Epoch: 12, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.305 Vali Acc: 0.952 Test Loss: 0.305 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1720041
	speed: 0.1960s/iter; left time: 8071.0566s
	iters: 200, epoch: 13 | loss: 0.0000696
	speed: 0.0324s/iter; left time: 1329.9459s
	iters: 300, epoch: 13 | loss: 0.0213852
	speed: 0.0342s/iter; left time: 1399.2733s
	iters: 400, epoch: 13 | loss: 0.0521986
	speed: 0.0318s/iter; left time: 1298.0323s
Epoch: 13 cost time: 15.980818748474121
Epoch: 13, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.955114 --> -0.957688).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0090060
	speed: 0.1700s/iter; left time: 6919.9089s
	iters: 200, epoch: 14 | loss: 0.2115584
	speed: 0.0318s/iter; left time: 1290.8127s
	iters: 300, epoch: 14 | loss: 0.0000799
	speed: 0.0326s/iter; left time: 1319.8286s
	iters: 400, epoch: 14 | loss: 0.0148669
	speed: 0.0380s/iter; left time: 1535.4593s
Epoch: 14 cost time: 16.823633909225464
Epoch: 14, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.491 Vali Acc: 0.926 Test Loss: 0.491 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0020770
	speed: 0.2146s/iter; left time: 8633.4452s
	iters: 200, epoch: 15 | loss: 0.0186306
	speed: 0.0464s/iter; left time: 1863.0097s
	iters: 300, epoch: 15 | loss: 0.0014307
	speed: 0.0430s/iter; left time: 1723.3517s
	iters: 400, epoch: 15 | loss: 0.6825339
	speed: 0.0398s/iter; left time: 1588.3194s
Epoch: 15 cost time: 21.074962377548218
Epoch: 15, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.388 Vali Acc: 0.945 Test Loss: 0.388 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0817522
	speed: 0.2071s/iter; left time: 8234.4378s
	iters: 200, epoch: 16 | loss: 0.0017937
	speed: 0.0379s/iter; left time: 1504.7509s
	iters: 300, epoch: 16 | loss: 0.5422610
	speed: 0.0370s/iter; left time: 1463.7434s
	iters: 400, epoch: 16 | loss: 0.0017092
	speed: 0.0438s/iter; left time: 1729.1334s
Epoch: 16 cost time: 19.406115770339966
Epoch: 16, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.451 Vali Acc: 0.930 Test Loss: 0.451 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0030902
	speed: 0.1882s/iter; left time: 7394.7233s
	iters: 200, epoch: 17 | loss: 0.0007306
	speed: 0.0406s/iter; left time: 1593.1282s
	iters: 300, epoch: 17 | loss: 0.0034364
	speed: 0.0609s/iter; left time: 2379.6424s
	iters: 400, epoch: 17 | loss: 0.0178334
	speed: 0.0591s/iter; left time: 2305.2488s
Epoch: 17 cost time: 23.861360788345337
Epoch: 17, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.339 Vali Acc: 0.952 Test Loss: 0.339 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5268847
	speed: 0.2437s/iter; left time: 9464.1418s
	iters: 200, epoch: 18 | loss: 0.0166795
	speed: 0.0658s/iter; left time: 2548.9996s
	iters: 300, epoch: 18 | loss: 0.3263652
	speed: 0.0617s/iter; left time: 2384.7430s
	iters: 400, epoch: 18 | loss: 0.0001393
	speed: 0.0471s/iter; left time: 1816.5130s
Epoch: 18 cost time: 27.416041135787964
Epoch: 18, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000055
	speed: 0.2623s/iter; left time: 10061.0155s
	iters: 200, epoch: 19 | loss: 0.0084936
	speed: 0.0540s/iter; left time: 2067.7205s
	iters: 300, epoch: 19 | loss: 0.3452388
	speed: 0.0497s/iter; left time: 1897.1964s
	iters: 400, epoch: 19 | loss: 0.0645691
	speed: 0.0648s/iter; left time: 2466.5958s
Epoch: 19 cost time: 27.861021757125854
Epoch: 19, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.321 Vali Acc: 0.940 Test Loss: 0.321 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0035805
	speed: 0.2499s/iter; left time: 9467.5025s
	iters: 200, epoch: 20 | loss: 0.0039347
	speed: 0.0577s/iter; left time: 2180.4299s
	iters: 300, epoch: 20 | loss: 0.0379565
	speed: 0.0629s/iter; left time: 2370.8487s
	iters: 400, epoch: 20 | loss: 0.2885890
	speed: 0.0531s/iter; left time: 1996.4861s
Epoch: 20 cost time: 26.80233097076416
Epoch: 20, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.368 Vali Acc: 0.948 Test Loss: 0.368 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0307749
	speed: 0.2587s/iter; left time: 9682.2409s
	iters: 200, epoch: 21 | loss: 0.0018789
	speed: 0.0631s/iter; left time: 2356.6302s
	iters: 300, epoch: 21 | loss: 0.2901200
	speed: 0.0509s/iter; left time: 1893.7718s
	iters: 400, epoch: 21 | loss: 0.0024418
	speed: 0.0526s/iter; left time: 1953.3433s
Epoch: 21 cost time: 27.461883783340454
Epoch: 21, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0403979
	speed: 0.2413s/iter; left time: 8915.5215s
	iters: 200, epoch: 22 | loss: 0.0178581
	speed: 0.0386s/iter; left time: 1421.2372s
	iters: 300, epoch: 22 | loss: 0.0140058
	speed: 0.0375s/iter; left time: 1377.9201s
	iters: 400, epoch: 22 | loss: 0.0596197
	speed: 0.0324s/iter; left time: 1188.0873s
Epoch: 22 cost time: 18.645288467407227
Epoch: 22, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.241 Vali Acc: 0.956 Test Loss: 0.241 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0005771
	speed: 0.1672s/iter; left time: 6101.2049s
	iters: 200, epoch: 23 | loss: 0.3940679
	speed: 0.0310s/iter; left time: 1127.9202s
	iters: 300, epoch: 23 | loss: 0.0040519
	speed: 0.0302s/iter; left time: 1095.6091s
	iters: 400, epoch: 23 | loss: 0.0004382
	speed: 0.0334s/iter; left time: 1209.9473s
Epoch: 23 cost time: 16.851662635803223
Epoch: 23, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9576901086335049
model parameter : 319754
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6834132
	speed: 0.0766s/iter; left time: 3583.9660s
	iters: 200, epoch: 1 | loss: 0.3470716
	speed: 0.0396s/iter; left time: 1851.4548s
	iters: 300, epoch: 1 | loss: 0.0672439
	speed: 0.0607s/iter; left time: 2827.0601s
	iters: 400, epoch: 1 | loss: 0.1105817
	speed: 0.0474s/iter; left time: 2202.4838s
Epoch: 1 cost time: 26.511653423309326
Epoch: 1, Steps: 469 | Train Loss: 0.442 Vali Loss: 0.299 Vali Acc: 0.929 Test Loss: 0.299 Test Acc: 0.929
Validation loss decreased (inf --> -0.928528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0889811
	speed: 0.2434s/iter; left time: 11278.9217s
	iters: 200, epoch: 2 | loss: 0.0094102
	speed: 0.0420s/iter; left time: 1943.9265s
	iters: 300, epoch: 2 | loss: 0.1481473
	speed: 0.0549s/iter; left time: 2534.2766s
	iters: 400, epoch: 2 | loss: 0.0182620
	speed: 0.0398s/iter; left time: 1831.0829s
Epoch: 2 cost time: 23.92501926422119
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.225 Vali Acc: 0.939 Test Loss: 0.225 Test Acc: 0.939
Validation loss decreased (-0.928528 --> -0.939106).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031528
	speed: 0.2381s/iter; left time: 10920.3331s
	iters: 200, epoch: 3 | loss: 0.0074557
	speed: 0.0491s/iter; left time: 2245.6149s
	iters: 300, epoch: 3 | loss: 0.0059128
	speed: 0.0578s/iter; left time: 2640.3907s
	iters: 400, epoch: 3 | loss: 0.0365855
	speed: 0.0434s/iter; left time: 1978.8038s
Epoch: 3 cost time: 24.9388325214386
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
Validation loss decreased (-0.939106 --> -0.956830).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0010679
	speed: 0.2382s/iter; left time: 10811.6118s
	iters: 200, epoch: 4 | loss: 0.0007281
	speed: 0.0472s/iter; left time: 2136.7411s
	iters: 300, epoch: 4 | loss: 0.0688222
	speed: 0.0584s/iter; left time: 2638.4612s
	iters: 400, epoch: 4 | loss: 0.0167801
	speed: 0.0533s/iter; left time: 2404.4650s
Epoch: 4 cost time: 25.890013933181763
Epoch: 4, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0115329
	speed: 0.2489s/iter; left time: 11180.9996s
	iters: 200, epoch: 5 | loss: 0.0001459
	speed: 0.0491s/iter; left time: 2198.7198s
	iters: 300, epoch: 5 | loss: 0.0079232
	speed: 0.0435s/iter; left time: 1945.4809s
	iters: 400, epoch: 5 | loss: 0.0056695
	speed: 0.0378s/iter; left time: 1687.5879s
Epoch: 5 cost time: 21.865942239761353
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0225492
	speed: 0.1775s/iter; left time: 7891.3130s
	iters: 200, epoch: 6 | loss: 0.2304849
	speed: 0.0437s/iter; left time: 1936.7423s
	iters: 300, epoch: 6 | loss: 0.0003202
	speed: 0.0514s/iter; left time: 2275.7782s
	iters: 400, epoch: 6 | loss: 0.0022943
	speed: 0.0533s/iter; left time: 2353.7850s
Epoch: 6 cost time: 22.370121002197266
Epoch: 6, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.343 Vali Acc: 0.939 Test Loss: 0.343 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1396656
	speed: 0.2247s/iter; left time: 9883.2139s
	iters: 200, epoch: 7 | loss: 0.0205810
	speed: 0.0479s/iter; left time: 2102.3205s
	iters: 300, epoch: 7 | loss: 0.0219832
	speed: 0.0471s/iter; left time: 2064.5205s
	iters: 400, epoch: 7 | loss: 0.0183817
	speed: 0.0548s/iter; left time: 2395.8267s
Epoch: 7 cost time: 24.16510820388794
Epoch: 7, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.242 Vali Acc: 0.949 Test Loss: 0.242 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0450602
	speed: 0.2041s/iter; left time: 8882.1768s
	iters: 200, epoch: 8 | loss: 0.0076828
	speed: 0.0331s/iter; left time: 1437.2174s
	iters: 300, epoch: 8 | loss: 0.0010203
	speed: 0.0312s/iter; left time: 1352.6931s
	iters: 400, epoch: 8 | loss: 0.0752031
	speed: 0.0374s/iter; left time: 1614.6826s
Epoch: 8 cost time: 16.721751928329468
Epoch: 8, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.256 Vali Acc: 0.963 Test Loss: 0.256 Test Acc: 0.963
Validation loss decreased (-0.956830 --> -0.963405).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0122374
	speed: 0.1677s/iter; left time: 7219.5195s
	iters: 200, epoch: 9 | loss: 0.1158775
	speed: 0.0313s/iter; left time: 1344.9879s
	iters: 300, epoch: 9 | loss: 0.0006623
	speed: 0.0318s/iter; left time: 1361.1428s
	iters: 400, epoch: 9 | loss: 0.0002442
	speed: 0.0318s/iter; left time: 1357.3515s
Epoch: 9 cost time: 15.354000568389893
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.244 Vali Acc: 0.951 Test Loss: 0.244 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002755
	speed: 0.1798s/iter; left time: 7656.2606s
	iters: 200, epoch: 10 | loss: 0.0334199
	speed: 0.0390s/iter; left time: 1656.5171s
	iters: 300, epoch: 10 | loss: 0.0287167
	speed: 0.0354s/iter; left time: 1498.5233s
	iters: 400, epoch: 10 | loss: 0.0381984
	speed: 0.0360s/iter; left time: 1524.1181s
Epoch: 10 cost time: 17.33159375190735
Epoch: 10, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.377 Vali Acc: 0.934 Test Loss: 0.377 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.9311850
	speed: 0.2078s/iter; left time: 8751.8071s
	iters: 200, epoch: 11 | loss: 0.0006975
	speed: 0.0455s/iter; left time: 1909.4724s
	iters: 300, epoch: 11 | loss: 0.0005940
	speed: 0.0475s/iter; left time: 1990.1796s
	iters: 400, epoch: 11 | loss: 0.0024772
	speed: 0.0440s/iter; left time: 1841.1259s
Epoch: 11 cost time: 21.991549968719482
Epoch: 11, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.470 Vali Acc: 0.912 Test Loss: 0.470 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0115056
	speed: 0.2042s/iter; left time: 8505.0105s
	iters: 200, epoch: 12 | loss: 0.0187988
	speed: 0.0376s/iter; left time: 1563.9490s
	iters: 300, epoch: 12 | loss: 0.0165035
	speed: 0.0364s/iter; left time: 1510.2714s
	iters: 400, epoch: 12 | loss: 0.0001484
	speed: 0.0355s/iter; left time: 1466.2727s
Epoch: 12 cost time: 17.679758548736572
Epoch: 12, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.303 Vali Acc: 0.949 Test Loss: 0.303 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0030123
	speed: 0.1853s/iter; left time: 7629.3331s
	iters: 200, epoch: 13 | loss: 0.1661801
	speed: 0.0350s/iter; left time: 1437.9525s
	iters: 300, epoch: 13 | loss: 0.0153915
	speed: 0.0463s/iter; left time: 1895.1419s
	iters: 400, epoch: 13 | loss: 0.4198457
	speed: 0.0447s/iter; left time: 1827.9685s
Epoch: 13 cost time: 19.14037251472473
Epoch: 13, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.533 Vali Acc: 0.926 Test Loss: 0.533 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0027862
	speed: 0.2087s/iter; left time: 8493.6499s
	iters: 200, epoch: 14 | loss: 0.0124396
	speed: 0.0396s/iter; left time: 1608.2401s
	iters: 300, epoch: 14 | loss: 0.0036265
	speed: 0.0415s/iter; left time: 1681.5023s
	iters: 400, epoch: 14 | loss: 0.0011513
	speed: 0.0472s/iter; left time: 1907.2679s
Epoch: 14 cost time: 21.435900449752808
Epoch: 14, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.403 Vali Acc: 0.940 Test Loss: 0.403 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0174874
	speed: 0.2114s/iter; left time: 8505.6906s
	iters: 200, epoch: 15 | loss: 0.0132373
	speed: 0.0494s/iter; left time: 1983.5113s
	iters: 300, epoch: 15 | loss: 0.1955823
	speed: 0.0493s/iter; left time: 1974.8036s
	iters: 400, epoch: 15 | loss: 0.0849433
	speed: 0.0454s/iter; left time: 1811.5818s
Epoch: 15 cost time: 21.887627363204956
Epoch: 15, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.272 Vali Acc: 0.959 Test Loss: 0.272 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0036413
	speed: 0.1890s/iter; left time: 7514.8289s
	iters: 200, epoch: 16 | loss: 0.0473873
	speed: 0.0372s/iter; left time: 1474.4907s
	iters: 300, epoch: 16 | loss: 0.0584062
	speed: 0.0375s/iter; left time: 1483.3311s
	iters: 400, epoch: 16 | loss: 0.1888889
	speed: 0.0383s/iter; left time: 1511.6754s
Epoch: 16 cost time: 18.62886142730713
Epoch: 16, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.229 Vali Acc: 0.947 Test Loss: 0.229 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0016498
	speed: 0.2023s/iter; left time: 7949.7436s
	iters: 200, epoch: 17 | loss: 0.0003794
	speed: 0.0375s/iter; left time: 1471.4593s
	iters: 300, epoch: 17 | loss: 0.9590778
	speed: 0.0380s/iter; left time: 1483.8029s
	iters: 400, epoch: 17 | loss: 0.0067173
	speed: 0.0372s/iter; left time: 1451.2920s
Epoch: 17 cost time: 18.15916872024536
Epoch: 17, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.408 Vali Acc: 0.937 Test Loss: 0.408 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0014371
	speed: 0.1883s/iter; left time: 7312.6699s
	iters: 200, epoch: 18 | loss: 0.0220362
	speed: 0.0335s/iter; left time: 1298.2651s
	iters: 300, epoch: 18 | loss: 0.0006587
	speed: 0.0390s/iter; left time: 1505.3367s
	iters: 400, epoch: 18 | loss: 0.6148745
	speed: 0.0367s/iter; left time: 1414.0175s
Epoch: 18 cost time: 17.811182737350464
Epoch: 18, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.220 Vali Acc: 0.969 Test Loss: 0.220 Test Acc: 0.969
Validation loss decreased (-0.963405 --> -0.968551).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0027763
	speed: 0.1905s/iter; left time: 7306.9660s
	iters: 200, epoch: 19 | loss: 0.0630406
	speed: 0.0397s/iter; left time: 1519.5260s
	iters: 300, epoch: 19 | loss: 0.2261193
	speed: 0.0398s/iter; left time: 1517.6555s
	iters: 400, epoch: 19 | loss: 0.4032546
	speed: 0.0400s/iter; left time: 1522.1749s
Epoch: 19 cost time: 18.652673959732056
Epoch: 19, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.265 Vali Acc: 0.953 Test Loss: 0.265 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0001051
	speed: 0.1866s/iter; left time: 7069.6145s
	iters: 200, epoch: 20 | loss: 0.0003396
	speed: 0.0385s/iter; left time: 1456.4206s
	iters: 300, epoch: 20 | loss: 0.0001267
	speed: 0.0373s/iter; left time: 1406.6477s
	iters: 400, epoch: 20 | loss: 0.0023422
	speed: 0.0385s/iter; left time: 1448.3425s
Epoch: 20 cost time: 18.66469407081604
Epoch: 20, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0089040
	speed: 0.1972s/iter; left time: 7378.5247s
	iters: 200, epoch: 21 | loss: 0.1996156
	speed: 0.0429s/iter; left time: 1602.3339s
	iters: 300, epoch: 21 | loss: 0.0002959
	speed: 0.0471s/iter; left time: 1752.4530s
	iters: 400, epoch: 21 | loss: 0.0443191
	speed: 0.0439s/iter; left time: 1628.6779s
Epoch: 21 cost time: 20.578312635421753
Epoch: 21, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0128144
	speed: 0.2018s/iter; left time: 7455.4986s
	iters: 200, epoch: 22 | loss: 0.0049928
	speed: 0.0471s/iter; left time: 1735.3944s
	iters: 300, epoch: 22 | loss: 0.0627137
	speed: 0.0422s/iter; left time: 1551.4571s
	iters: 400, epoch: 22 | loss: 0.0071394
	speed: 0.0447s/iter; left time: 1639.4811s
Epoch: 22 cost time: 20.504108428955078
Epoch: 22, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.296 Vali Acc: 0.946 Test Loss: 0.296 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0779524
	speed: 0.1892s/iter; left time: 6901.5944s
	iters: 200, epoch: 23 | loss: 0.0077526
	speed: 0.0396s/iter; left time: 1441.1367s
	iters: 300, epoch: 23 | loss: 0.0256951
	speed: 0.0429s/iter; left time: 1556.3525s
	iters: 400, epoch: 23 | loss: 0.0001788
	speed: 0.0598s/iter; left time: 2162.2975s
Epoch: 23 cost time: 23.026194095611572
Epoch: 23, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.332 Vali Acc: 0.957 Test Loss: 0.332 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000832
	speed: 0.2521s/iter; left time: 9078.4220s
	iters: 200, epoch: 24 | loss: 0.0001284
	speed: 0.0519s/iter; left time: 1864.4251s
	iters: 300, epoch: 24 | loss: 0.0002654
	speed: 0.0624s/iter; left time: 2233.4406s
	iters: 400, epoch: 24 | loss: 0.0002971
	speed: 0.0553s/iter; left time: 1975.8227s
Epoch: 24 cost time: 26.04408049583435
Epoch: 24, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1039665
	speed: 0.2473s/iter; left time: 8789.0859s
	iters: 200, epoch: 25 | loss: 0.0049180
	speed: 0.0604s/iter; left time: 2142.3675s
	iters: 300, epoch: 25 | loss: 0.0017236
	speed: 0.0492s/iter; left time: 1739.3060s
	iters: 400, epoch: 25 | loss: 0.3474845
	speed: 0.0641s/iter; left time: 2259.2328s
Epoch: 25 cost time: 28.22678303718567
Epoch: 25, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.289 Vali Acc: 0.958 Test Loss: 0.289 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0484330
	speed: 0.2583s/iter; left time: 9060.8648s
	iters: 200, epoch: 26 | loss: 0.0659374
	speed: 0.0490s/iter; left time: 1714.4566s
	iters: 300, epoch: 26 | loss: 0.0150645
	speed: 0.0561s/iter; left time: 1957.8780s
	iters: 400, epoch: 26 | loss: 0.1339315
	speed: 0.0487s/iter; left time: 1692.2102s
Epoch: 26 cost time: 24.20880913734436
Epoch: 26, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.415 Vali Acc: 0.947 Test Loss: 0.415 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000132
	speed: 0.2218s/iter; left time: 7676.3790s
	iters: 200, epoch: 27 | loss: 0.1717783
	speed: 0.0567s/iter; left time: 1955.2428s
	iters: 300, epoch: 27 | loss: 0.0092055
	speed: 0.0463s/iter; left time: 1594.1504s
	iters: 400, epoch: 27 | loss: 0.5425992
	speed: 0.0459s/iter; left time: 1576.3108s
Epoch: 27 cost time: 23.312074661254883
Epoch: 27, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.196 Vali Acc: 0.966 Test Loss: 0.196 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0047500
	speed: 0.2289s/iter; left time: 7814.7249s
	iters: 200, epoch: 28 | loss: 0.0000893
	speed: 0.0496s/iter; left time: 1687.6917s
	iters: 300, epoch: 28 | loss: 0.0051896
	speed: 0.0617s/iter; left time: 2092.9028s
	iters: 400, epoch: 28 | loss: 0.0054335
	speed: 0.0538s/iter; left time: 1821.1289s
Epoch: 28 cost time: 26.053338289260864
Epoch: 28, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9685534591194969
model parameter : 270410
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5955098
	speed: 0.0566s/iter; left time: 2650.4487s
	iters: 200, epoch: 1 | loss: 0.6406188
	speed: 0.0438s/iter; left time: 2046.4637s
	iters: 300, epoch: 1 | loss: 0.3263373
	speed: 0.0633s/iter; left time: 2949.8810s
	iters: 400, epoch: 1 | loss: 0.4068155
	speed: 0.0505s/iter; left time: 2347.1481s
Epoch: 1 cost time: 25.30315351486206
Epoch: 1, Steps: 469 | Train Loss: 0.568 Vali Loss: 0.195 Vali Acc: 0.947 Test Loss: 0.195 Test Acc: 0.947
Validation loss decreased (inf --> -0.947397).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0464785
	speed: 0.2508s/iter; left time: 11619.1517s
	iters: 200, epoch: 2 | loss: 0.0915399
	speed: 0.0600s/iter; left time: 2771.9528s
	iters: 300, epoch: 2 | loss: 0.0351084
	speed: 0.0462s/iter; left time: 2129.2521s
	iters: 400, epoch: 2 | loss: 0.0591632
	speed: 0.0573s/iter; left time: 2636.6713s
Epoch: 2 cost time: 26.383920907974243
Epoch: 2, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.947397 --> -0.959404).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0392534
	speed: 0.2577s/iter; left time: 11819.4096s
	iters: 200, epoch: 3 | loss: 0.0073426
	speed: 0.0450s/iter; left time: 2058.4595s
	iters: 300, epoch: 3 | loss: 0.0010109
	speed: 0.0571s/iter; left time: 2607.5255s
	iters: 400, epoch: 3 | loss: 0.1393354
	speed: 0.0527s/iter; left time: 2402.3081s
Epoch: 3 cost time: 26.25477147102356
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0397551
	speed: 0.2531s/iter; left time: 11488.6007s
	iters: 200, epoch: 4 | loss: 0.0463103
	speed: 0.0610s/iter; left time: 2764.1756s
	iters: 300, epoch: 4 | loss: 0.1106316
	speed: 0.0550s/iter; left time: 2485.2261s
	iters: 400, epoch: 4 | loss: 0.0145928
	speed: 0.0616s/iter; left time: 2779.0661s
Epoch: 4 cost time: 26.84843373298645
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.959404 --> -0.962548).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0087137
	speed: 0.2102s/iter; left time: 9444.8895s
	iters: 200, epoch: 5 | loss: 0.0051244
	speed: 0.0430s/iter; left time: 1927.1861s
	iters: 300, epoch: 5 | loss: 0.4001017
	speed: 0.0433s/iter; left time: 1937.0933s
	iters: 400, epoch: 5 | loss: 0.0018160
	speed: 0.0553s/iter; left time: 2466.8991s
Epoch: 5 cost time: 22.197479009628296
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
Validation loss decreased (-0.962548 --> -0.963406).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0168298
	speed: 0.2373s/iter; left time: 10548.9445s
	iters: 200, epoch: 6 | loss: 0.0083091
	speed: 0.0513s/iter; left time: 2276.3903s
	iters: 300, epoch: 6 | loss: 0.0127400
	speed: 0.0500s/iter; left time: 2213.5900s
	iters: 400, epoch: 6 | loss: 0.0198989
	speed: 0.0480s/iter; left time: 2119.3900s
Epoch: 6 cost time: 24.125150442123413
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0144801
	speed: 0.2372s/iter; left time: 10434.3078s
	iters: 200, epoch: 7 | loss: 0.0292367
	speed: 0.0461s/iter; left time: 2023.7985s
	iters: 300, epoch: 7 | loss: 0.0123597
	speed: 0.0356s/iter; left time: 1558.6223s
	iters: 400, epoch: 7 | loss: 0.1300016
	speed: 0.0350s/iter; left time: 1530.6824s
Epoch: 7 cost time: 19.987618446350098
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.963406 --> -0.975413).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0037295
	speed: 0.1787s/iter; left time: 7777.3481s
	iters: 200, epoch: 8 | loss: 0.0388532
	speed: 0.0409s/iter; left time: 1777.7229s
	iters: 300, epoch: 8 | loss: 0.0431191
	speed: 0.0442s/iter; left time: 1912.7886s
	iters: 400, epoch: 8 | loss: 0.1417384
	speed: 0.0468s/iter; left time: 2022.1577s
Epoch: 8 cost time: 20.35914969444275
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5058416
	speed: 0.2149s/iter; left time: 9249.7497s
	iters: 200, epoch: 9 | loss: 0.0043157
	speed: 0.0414s/iter; left time: 1776.7654s
	iters: 300, epoch: 9 | loss: 0.0531398
	speed: 0.0472s/iter; left time: 2021.1671s
	iters: 400, epoch: 9 | loss: 0.0000324
	speed: 0.0423s/iter; left time: 1807.9091s
Epoch: 9 cost time: 20.77149748802185
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0014430
	speed: 0.2122s/iter; left time: 9037.6044s
	iters: 200, epoch: 10 | loss: 0.0016196
	speed: 0.0470s/iter; left time: 1995.6895s
	iters: 300, epoch: 10 | loss: 0.0018936
	speed: 0.0473s/iter; left time: 2003.8209s
	iters: 400, epoch: 10 | loss: 0.2318417
	speed: 0.0433s/iter; left time: 1830.3330s
Epoch: 10 cost time: 22.03597593307495
Epoch: 10, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.213 Vali Acc: 0.961 Test Loss: 0.213 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0525908
	speed: 0.2256s/iter; left time: 9501.9137s
	iters: 200, epoch: 11 | loss: 0.0060549
	speed: 0.0430s/iter; left time: 1805.0197s
	iters: 300, epoch: 11 | loss: 0.0562023
	speed: 0.0406s/iter; left time: 1699.5889s
	iters: 400, epoch: 11 | loss: 0.0139063
	speed: 0.0386s/iter; left time: 1612.2294s
Epoch: 11 cost time: 20.67910408973694
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0019860
	speed: 0.2104s/iter; left time: 8760.1580s
	iters: 200, epoch: 12 | loss: 0.0001597
	speed: 0.0493s/iter; left time: 2047.0811s
	iters: 300, epoch: 12 | loss: 0.0027140
	speed: 0.0471s/iter; left time: 1950.8347s
	iters: 400, epoch: 12 | loss: 0.0018582
	speed: 0.0495s/iter; left time: 2047.5759s
Epoch: 12 cost time: 23.81360626220703
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.962 Test Loss: 0.218 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0006177
	speed: 0.2263s/iter; left time: 9315.9206s
	iters: 200, epoch: 13 | loss: 0.1666222
	speed: 0.0484s/iter; left time: 1987.2268s
	iters: 300, epoch: 13 | loss: 0.0015040
	speed: 0.0505s/iter; left time: 2069.7982s
	iters: 400, epoch: 13 | loss: 0.0008335
	speed: 0.0477s/iter; left time: 1948.7864s
Epoch: 13 cost time: 22.50978422164917
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.259 Vali Acc: 0.961 Test Loss: 0.259 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0004449
	speed: 0.2072s/iter; left time: 8435.4240s
	iters: 200, epoch: 14 | loss: 0.0098300
	speed: 0.0376s/iter; left time: 1527.9308s
	iters: 300, epoch: 14 | loss: 0.0684500
	speed: 0.0367s/iter; left time: 1487.5786s
	iters: 400, epoch: 14 | loss: 0.0010238
	speed: 0.0347s/iter; left time: 1401.0586s
Epoch: 14 cost time: 17.837050437927246
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.199 Vali Acc: 0.964 Test Loss: 0.199 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0153331
	speed: 0.2152s/iter; left time: 8657.9814s
	iters: 200, epoch: 15 | loss: 0.0814703
	speed: 0.0449s/iter; left time: 1802.1470s
	iters: 300, epoch: 15 | loss: 0.0003147
	speed: 0.0436s/iter; left time: 1745.5181s
	iters: 400, epoch: 15 | loss: 0.1285698
	speed: 0.0435s/iter; left time: 1736.3229s
Epoch: 15 cost time: 21.570804119110107
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.180 Vali Acc: 0.964 Test Loss: 0.180 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2065836
	speed: 0.2138s/iter; left time: 8500.9200s
	iters: 200, epoch: 16 | loss: 0.0008160
	speed: 0.0457s/iter; left time: 1811.5774s
	iters: 300, epoch: 16 | loss: 0.0327494
	speed: 0.0419s/iter; left time: 1658.0696s
	iters: 400, epoch: 16 | loss: 0.0010502
	speed: 0.0398s/iter; left time: 1569.9842s
Epoch: 16 cost time: 19.9701931476593
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.212 Vali Acc: 0.965 Test Loss: 0.212 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0029983
	speed: 0.1810s/iter; left time: 7114.6447s
	iters: 200, epoch: 17 | loss: 0.0010547
	speed: 0.0316s/iter; left time: 1236.8650s
	iters: 300, epoch: 17 | loss: 0.0019318
	speed: 0.0329s/iter; left time: 1284.6605s
	iters: 400, epoch: 17 | loss: 0.2561942
	speed: 0.0305s/iter; left time: 1190.2588s
Epoch: 17 cost time: 15.615229845046997
Epoch: 17, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 160458
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7508333
	speed: 0.0557s/iter; left time: 2605.4664s
	iters: 200, epoch: 1 | loss: 0.3977100
	speed: 0.0355s/iter; left time: 1655.7832s
	iters: 300, epoch: 1 | loss: 0.1594081
	speed: 0.0353s/iter; left time: 1643.6609s
	iters: 400, epoch: 1 | loss: 0.2809961
	speed: 0.0367s/iter; left time: 1705.4090s
Epoch: 1 cost time: 19.072169303894043
Epoch: 1, Steps: 469 | Train Loss: 0.585 Vali Loss: 0.254 Vali Acc: 0.929 Test Loss: 0.254 Test Acc: 0.929
Validation loss decreased (inf --> -0.929100).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0779027
	speed: 0.2009s/iter; left time: 9310.3301s
	iters: 200, epoch: 2 | loss: 0.0631334
	speed: 0.0451s/iter; left time: 2085.7126s
	iters: 300, epoch: 2 | loss: 0.1374011
	speed: 0.0445s/iter; left time: 2052.3759s
	iters: 400, epoch: 2 | loss: 0.0126513
	speed: 0.0455s/iter; left time: 2095.1540s
Epoch: 2 cost time: 21.42021155357361
Epoch: 2, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.929100 --> -0.951685).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0106194
	speed: 0.2037s/iter; left time: 9341.6816s
	iters: 200, epoch: 3 | loss: 0.1090711
	speed: 0.0400s/iter; left time: 1829.7160s
	iters: 300, epoch: 3 | loss: 0.0259657
	speed: 0.0391s/iter; left time: 1784.6173s
	iters: 400, epoch: 3 | loss: 0.0031796
	speed: 0.0377s/iter; left time: 1718.2779s
Epoch: 3 cost time: 19.622843742370605
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3122375
	speed: 0.2550s/iter; left time: 11577.1107s
	iters: 200, epoch: 4 | loss: 0.0874332
	speed: 0.0544s/iter; left time: 2463.9120s
	iters: 300, epoch: 4 | loss: 0.0103925
	speed: 0.0523s/iter; left time: 2361.4528s
	iters: 400, epoch: 4 | loss: 0.0218439
	speed: 0.0626s/iter; left time: 2822.2251s
Epoch: 4 cost time: 27.682891368865967
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.951685 --> -0.964835).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0031966
	speed: 0.2438s/iter; left time: 10951.5543s
	iters: 200, epoch: 5 | loss: 0.0285121
	speed: 0.0566s/iter; left time: 2535.4431s
	iters: 300, epoch: 5 | loss: 0.0725188
	speed: 0.0532s/iter; left time: 2381.0629s
	iters: 400, epoch: 5 | loss: 0.0028111
	speed: 0.0409s/iter; left time: 1826.6189s
Epoch: 5 cost time: 23.84360980987549
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0176981
	speed: 0.2401s/iter; left time: 10672.7782s
	iters: 200, epoch: 6 | loss: 0.1247025
	speed: 0.0570s/iter; left time: 2529.1950s
	iters: 300, epoch: 6 | loss: 0.0033899
	speed: 0.0483s/iter; left time: 2139.1279s
	iters: 400, epoch: 6 | loss: 0.0008040
	speed: 0.0599s/iter; left time: 2646.1219s
Epoch: 6 cost time: 27.132959842681885
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0082777
	speed: 0.2417s/iter; left time: 10631.4532s
	iters: 200, epoch: 7 | loss: 0.0542654
	speed: 0.0553s/iter; left time: 2426.1202s
	iters: 300, epoch: 7 | loss: 0.0034730
	speed: 0.0609s/iter; left time: 2665.7401s
	iters: 400, epoch: 7 | loss: 0.2838896
	speed: 0.0512s/iter; left time: 2235.8684s
Epoch: 7 cost time: 25.74490523338318
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.964835 --> -0.970267).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0110234
	speed: 0.2464s/iter; left time: 10723.8070s
	iters: 200, epoch: 8 | loss: 0.0160538
	speed: 0.0538s/iter; left time: 2336.0974s
	iters: 300, epoch: 8 | loss: 0.1410380
	speed: 0.0514s/iter; left time: 2224.7033s
	iters: 400, epoch: 8 | loss: 0.1224598
	speed: 0.0468s/iter; left time: 2024.5003s
Epoch: 8 cost time: 24.336769819259644
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0179278
	speed: 0.2222s/iter; left time: 9565.2216s
	iters: 200, epoch: 9 | loss: 0.1927233
	speed: 0.0487s/iter; left time: 2092.7972s
	iters: 300, epoch: 9 | loss: 0.0009011
	speed: 0.0410s/iter; left time: 1758.0246s
	iters: 400, epoch: 9 | loss: 0.0627785
	speed: 0.0449s/iter; left time: 1918.5509s
Epoch: 9 cost time: 22.22530221939087
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0195280
	speed: 0.2186s/iter; left time: 9308.0434s
	iters: 200, epoch: 10 | loss: 0.0048313
	speed: 0.0388s/iter; left time: 1648.0437s
	iters: 300, epoch: 10 | loss: 0.0153408
	speed: 0.0341s/iter; left time: 1444.3981s
	iters: 400, epoch: 10 | loss: 0.0207946
	speed: 0.0302s/iter; left time: 1275.3503s
Epoch: 10 cost time: 16.959684133529663
Epoch: 10, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0010146
	speed: 0.1706s/iter; left time: 7182.1148s
	iters: 200, epoch: 11 | loss: 0.0202224
	speed: 0.0493s/iter; left time: 2071.2959s
	iters: 300, epoch: 11 | loss: 0.0011748
	speed: 0.0394s/iter; left time: 1651.6467s
	iters: 400, epoch: 11 | loss: 0.0003472
	speed: 0.0427s/iter; left time: 1784.0599s
Epoch: 11 cost time: 20.17949628829956
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0451630
	speed: 0.2255s/iter; left time: 9390.2339s
	iters: 200, epoch: 12 | loss: 0.0047765
	speed: 0.0435s/iter; left time: 1805.8590s
	iters: 300, epoch: 12 | loss: 0.0042624
	speed: 0.0535s/iter; left time: 2218.6809s
	iters: 400, epoch: 12 | loss: 0.1836505
	speed: 0.0446s/iter; left time: 1845.2154s
Epoch: 12 cost time: 23.945335626602173
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0048020
	speed: 0.2377s/iter; left time: 9786.1671s
	iters: 200, epoch: 13 | loss: 0.0004503
	speed: 0.0452s/iter; left time: 1857.2946s
	iters: 300, epoch: 13 | loss: 0.0066495
	speed: 0.0542s/iter; left time: 2218.9446s
	iters: 400, epoch: 13 | loss: 0.0000277
	speed: 0.0469s/iter; left time: 1914.9481s
Epoch: 13 cost time: 24.542829751968384
Epoch: 13, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.223 Vali Acc: 0.961 Test Loss: 0.223 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3887943
	speed: 0.2036s/iter; left time: 8286.6633s
	iters: 200, epoch: 14 | loss: 0.0059340
	speed: 0.0380s/iter; left time: 1541.9408s
	iters: 300, epoch: 14 | loss: 0.5854400
	speed: 0.0356s/iter; left time: 1440.5317s
	iters: 400, epoch: 14 | loss: 0.0091290
	speed: 0.0341s/iter; left time: 1377.2802s
Epoch: 14 cost time: 17.019378185272217
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0006934
	speed: 0.1892s/iter; left time: 7611.9879s
	iters: 200, epoch: 15 | loss: 0.1558970
	speed: 0.0467s/iter; left time: 1875.7324s
	iters: 300, epoch: 15 | loss: 0.3424664
	speed: 0.0451s/iter; left time: 1804.5262s
	iters: 400, epoch: 15 | loss: 0.0053219
	speed: 0.0438s/iter; left time: 1751.1381s
Epoch: 15 cost time: 22.32891607284546
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0020842
	speed: 0.2310s/iter; left time: 9184.5380s
	iters: 200, epoch: 16 | loss: 0.0013012
	speed: 0.0484s/iter; left time: 1919.1005s
	iters: 300, epoch: 16 | loss: 0.0026380
	speed: 0.0422s/iter; left time: 1669.6338s
	iters: 400, epoch: 16 | loss: 0.0008656
	speed: 0.0492s/iter; left time: 1940.3582s
Epoch: 16 cost time: 22.271228075027466
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0019098
	speed: 0.2063s/iter; left time: 8108.2464s
	iters: 200, epoch: 17 | loss: 0.0105696
	speed: 0.0478s/iter; left time: 1873.8801s
	iters: 300, epoch: 17 | loss: 0.0480446
	speed: 0.0392s/iter; left time: 1531.5630s
	iters: 400, epoch: 17 | loss: 0.0000064
	speed: 0.0342s/iter; left time: 1332.4293s
Epoch: 17 cost time: 19.011021614074707
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.968 Test Loss: 0.212 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 110922
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5080054
	speed: 0.0565s/iter; left time: 2642.6465s
	iters: 200, epoch: 1 | loss: 0.3380232
	speed: 0.0375s/iter; left time: 1750.9704s
	iters: 300, epoch: 1 | loss: 0.1642295
	speed: 0.0374s/iter; left time: 1742.2895s
	iters: 400, epoch: 1 | loss: 0.2460555
	speed: 0.0377s/iter; left time: 1754.5825s
Epoch: 1 cost time: 19.40833067893982
Epoch: 1, Steps: 469 | Train Loss: 0.588 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (inf --> -0.928242).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1230133
	speed: 0.1866s/iter; left time: 8646.7402s
	iters: 200, epoch: 2 | loss: 0.0669931
	speed: 0.0416s/iter; left time: 1924.4568s
	iters: 300, epoch: 2 | loss: 0.0923093
	speed: 0.0412s/iter; left time: 1899.0905s
	iters: 400, epoch: 2 | loss: 0.0151926
	speed: 0.0343s/iter; left time: 1578.8651s
Epoch: 2 cost time: 18.26063299179077
Epoch: 2, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.928242 --> -0.961977).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0210753
	speed: 0.1948s/iter; left time: 8932.9877s
	iters: 200, epoch: 3 | loss: 0.0239147
	speed: 0.0471s/iter; left time: 2155.0037s
	iters: 300, epoch: 3 | loss: 0.1622690
	speed: 0.0429s/iter; left time: 1958.2356s
	iters: 400, epoch: 3 | loss: 0.0121259
	speed: 0.0415s/iter; left time: 1892.3741s
Epoch: 3 cost time: 21.52388048171997
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0108835
	speed: 0.2105s/iter; left time: 9555.3413s
	iters: 200, epoch: 4 | loss: 0.0174409
	speed: 0.0353s/iter; left time: 1601.0472s
	iters: 300, epoch: 4 | loss: 0.0010166
	speed: 0.0347s/iter; left time: 1568.5341s
	iters: 400, epoch: 4 | loss: 0.0012915
	speed: 0.0338s/iter; left time: 1524.6378s
Epoch: 4 cost time: 16.910699605941772
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
Validation loss decreased (-0.961977 --> -0.962548).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0644062
	speed: 0.1818s/iter; left time: 8166.6387s
	iters: 200, epoch: 5 | loss: 0.0707192
	speed: 0.0452s/iter; left time: 2024.9058s
	iters: 300, epoch: 5 | loss: 0.0964778
	speed: 0.0456s/iter; left time: 2041.0379s
	iters: 400, epoch: 5 | loss: 0.0043256
	speed: 0.0448s/iter; left time: 1998.1173s
Epoch: 5 cost time: 21.18313455581665
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.962548 --> -0.962834).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0215679
	speed: 0.2039s/iter; left time: 9065.7629s
	iters: 200, epoch: 6 | loss: 0.0238667
	speed: 0.0421s/iter; left time: 1866.8771s
	iters: 300, epoch: 6 | loss: 0.0060509
	speed: 0.0404s/iter; left time: 1787.9132s
	iters: 400, epoch: 6 | loss: 0.0015613
	speed: 0.0404s/iter; left time: 1783.8994s
Epoch: 6 cost time: 20.089483499526978
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0175067
	speed: 0.2105s/iter; left time: 9260.7267s
	iters: 200, epoch: 7 | loss: 0.0022909
	speed: 0.0399s/iter; left time: 1751.0574s
	iters: 300, epoch: 7 | loss: 0.0034884
	speed: 0.0429s/iter; left time: 1877.2831s
	iters: 400, epoch: 7 | loss: 0.0151127
	speed: 0.0364s/iter; left time: 1590.9726s
Epoch: 7 cost time: 19.371012210845947
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
Validation loss decreased (-0.962834 --> -0.968552).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001824
	speed: 0.1813s/iter; left time: 7890.1830s
	iters: 200, epoch: 8 | loss: 0.1578683
	speed: 0.0385s/iter; left time: 1670.9062s
	iters: 300, epoch: 8 | loss: 0.0003426
	speed: 0.0471s/iter; left time: 2038.4156s
	iters: 400, epoch: 8 | loss: 0.0014036
	speed: 0.0433s/iter; left time: 1872.5633s
Epoch: 8 cost time: 20.120609760284424
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0095637
	speed: 0.1900s/iter; left time: 8178.3635s
	iters: 200, epoch: 9 | loss: 0.2289446
	speed: 0.0324s/iter; left time: 1390.2331s
	iters: 300, epoch: 9 | loss: 0.0007299
	speed: 0.0369s/iter; left time: 1579.3306s
	iters: 400, epoch: 9 | loss: 0.0002257
	speed: 0.0371s/iter; left time: 1585.6192s
Epoch: 9 cost time: 16.99613070487976
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.968 Test Loss: 0.208 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0004519
	speed: 0.1764s/iter; left time: 7512.5471s
	iters: 200, epoch: 10 | loss: 0.0048074
	speed: 0.0318s/iter; left time: 1349.2477s
	iters: 300, epoch: 10 | loss: 0.0028520
	speed: 0.0328s/iter; left time: 1390.2115s
	iters: 400, epoch: 10 | loss: 0.0011079
	speed: 0.0372s/iter; left time: 1574.9282s
Epoch: 10 cost time: 16.858262062072754
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.968552 --> -0.971982).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0705587
	speed: 0.1819s/iter; left time: 7658.3669s
	iters: 200, epoch: 11 | loss: 0.0028126
	speed: 0.0355s/iter; left time: 1492.1277s
	iters: 300, epoch: 11 | loss: 0.0062936
	speed: 0.0371s/iter; left time: 1553.7846s
	iters: 400, epoch: 11 | loss: 0.1141617
	speed: 0.0367s/iter; left time: 1535.0271s
Epoch: 11 cost time: 17.162287712097168
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0066377
	speed: 0.1968s/iter; left time: 8196.4464s
	iters: 200, epoch: 12 | loss: 0.0150031
	speed: 0.0428s/iter; left time: 1777.7985s
	iters: 300, epoch: 12 | loss: 0.0018654
	speed: 0.0394s/iter; left time: 1634.2973s
	iters: 400, epoch: 12 | loss: 0.0015774
	speed: 0.0387s/iter; left time: 1601.1770s
Epoch: 12 cost time: 19.417985677719116
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1604889
	speed: 0.1937s/iter; left time: 7975.6079s
	iters: 200, epoch: 13 | loss: 0.0002879
	speed: 0.0361s/iter; left time: 1484.2808s
	iters: 300, epoch: 13 | loss: 0.0146347
	speed: 0.0369s/iter; left time: 1512.9560s
	iters: 400, epoch: 13 | loss: 0.2854246
	speed: 0.0378s/iter; left time: 1546.7070s
Epoch: 13 cost time: 18.125168561935425
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0003110
	speed: 0.2100s/iter; left time: 8546.7240s
	iters: 200, epoch: 14 | loss: 0.0000279
	speed: 0.0390s/iter; left time: 1582.3461s
	iters: 300, epoch: 14 | loss: 0.0001945
	speed: 0.0408s/iter; left time: 1653.5121s
	iters: 400, epoch: 14 | loss: 0.0031994
	speed: 0.0429s/iter; left time: 1734.2905s
Epoch: 14 cost time: 19.79331064224243
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.259 Vali Acc: 0.959 Test Loss: 0.259 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1786890
	speed: 0.1947s/iter; left time: 7835.6405s
	iters: 200, epoch: 15 | loss: 0.0000494
	speed: 0.0378s/iter; left time: 1516.8041s
	iters: 300, epoch: 15 | loss: 0.0095650
	speed: 0.0356s/iter; left time: 1424.8757s
	iters: 400, epoch: 15 | loss: 0.0174141
	speed: 0.0352s/iter; left time: 1405.6181s
Epoch: 15 cost time: 17.473546266555786
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0012450
	speed: 0.2151s/iter; left time: 8553.1221s
	iters: 200, epoch: 16 | loss: 0.0000970
	speed: 0.0491s/iter; left time: 1946.0398s
	iters: 300, epoch: 16 | loss: 0.1430540
	speed: 0.0598s/iter; left time: 2367.7702s
	iters: 400, epoch: 16 | loss: 0.0055458
	speed: 0.0510s/iter; left time: 2014.2490s
Epoch: 16 cost time: 25.24173665046692
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0013751
	speed: 0.2417s/iter; left time: 9499.8905s
	iters: 200, epoch: 17 | loss: 0.4576094
	speed: 0.0519s/iter; left time: 2035.8969s
	iters: 300, epoch: 17 | loss: 0.1531219
	speed: 0.0525s/iter; left time: 2053.5131s
	iters: 400, epoch: 17 | loss: 0.0468801
	speed: 0.0612s/iter; left time: 2385.3919s
Epoch: 17 cost time: 26.22856044769287
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.968 Test Loss: 0.215 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0278508
	speed: 0.2261s/iter; left time: 8777.8826s
	iters: 200, epoch: 18 | loss: 0.0000566
	speed: 0.0549s/iter; left time: 2127.6644s
	iters: 300, epoch: 18 | loss: 0.0003304
	speed: 0.0394s/iter; left time: 1523.5208s
	iters: 400, epoch: 18 | loss: 0.0000122
	speed: 0.0434s/iter; left time: 1670.2182s
Epoch: 18 cost time: 22.452795028686523
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0015808
	speed: 0.2024s/iter; left time: 7762.1620s
	iters: 200, epoch: 19 | loss: 0.0010718
	speed: 0.0431s/iter; left time: 1647.9317s
	iters: 300, epoch: 19 | loss: 0.0015645
	speed: 0.0522s/iter; left time: 1990.4177s
	iters: 400, epoch: 19 | loss: 0.0388035
	speed: 0.0397s/iter; left time: 1510.2238s
Epoch: 19 cost time: 20.395228385925293
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0359906
	speed: 0.2143s/iter; left time: 8119.7505s
	iters: 200, epoch: 20 | loss: 0.0023520
	speed: 0.0418s/iter; left time: 1580.7220s
	iters: 300, epoch: 20 | loss: 0.1141351
	speed: 0.0350s/iter; left time: 1319.7831s
	iters: 400, epoch: 20 | loss: 0.1256236
	speed: 0.0321s/iter; left time: 1206.2686s
Epoch: 20 cost time: 18.11985945701599
Epoch: 20, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 86154
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1883981
	speed: 0.0647s/iter; left time: 3029.4648s
	iters: 200, epoch: 1 | loss: 0.5715095
	speed: 0.0506s/iter; left time: 2365.1674s
	iters: 300, epoch: 1 | loss: 0.4897641
	speed: 0.0448s/iter; left time: 2088.9760s
	iters: 400, epoch: 1 | loss: 0.2189230
	speed: 0.0449s/iter; left time: 2087.9055s
Epoch: 1 cost time: 23.872251749038696
Epoch: 1, Steps: 469 | Train Loss: 0.790 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (inf --> -0.902512).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5509936
	speed: 0.2166s/iter; left time: 10035.0038s
	iters: 200, epoch: 2 | loss: 0.1030986
	speed: 0.0523s/iter; left time: 2416.3617s
	iters: 300, epoch: 2 | loss: 0.2075706
	speed: 0.0402s/iter; left time: 1853.8950s
	iters: 400, epoch: 2 | loss: 0.1121811
	speed: 0.0460s/iter; left time: 2119.0427s
Epoch: 2 cost time: 22.125284671783447
Epoch: 2, Steps: 469 | Train Loss: 0.172 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
Validation loss decreased (-0.902512 --> -0.953686).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1108528
	speed: 0.2115s/iter; left time: 9700.7147s
	iters: 200, epoch: 3 | loss: 0.0388623
	speed: 0.0461s/iter; left time: 2110.9202s
	iters: 300, epoch: 3 | loss: 0.3206717
	speed: 0.0408s/iter; left time: 1860.9871s
	iters: 400, epoch: 3 | loss: 0.0164044
	speed: 0.0518s/iter; left time: 2359.5059s
Epoch: 3 cost time: 22.025532722473145
Epoch: 3, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
Validation loss decreased (-0.953686 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0205125
	speed: 0.2200s/iter; left time: 9984.4950s
	iters: 200, epoch: 4 | loss: 0.0144901
	speed: 0.0477s/iter; left time: 2160.8458s
	iters: 300, epoch: 4 | loss: 0.0704646
	speed: 0.0424s/iter; left time: 1917.9024s
	iters: 400, epoch: 4 | loss: 0.0628860
	speed: 0.0493s/iter; left time: 2221.4776s
Epoch: 4 cost time: 22.067311763763428
Epoch: 4, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0310398
	speed: 0.1995s/iter; left time: 8962.0927s
	iters: 200, epoch: 5 | loss: 0.0130526
	speed: 0.0354s/iter; left time: 1586.9908s
	iters: 300, epoch: 5 | loss: 0.0744822
	speed: 0.0346s/iter; left time: 1549.4872s
	iters: 400, epoch: 5 | loss: 0.0525259
	speed: 0.0349s/iter; left time: 1558.7308s
Epoch: 5 cost time: 16.648672103881836
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5561725
	speed: 0.1830s/iter; left time: 8137.1327s
	iters: 200, epoch: 6 | loss: 0.0142470
	speed: 0.0381s/iter; left time: 1691.5928s
	iters: 300, epoch: 6 | loss: 0.0102080
	speed: 0.0367s/iter; left time: 1622.9696s
	iters: 400, epoch: 6 | loss: 0.0652433
	speed: 0.0376s/iter; left time: 1659.5815s
Epoch: 6 cost time: 18.252668619155884
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.961119 --> -0.970267).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0017009
	speed: 0.2042s/iter; left time: 8983.7875s
	iters: 200, epoch: 7 | loss: 0.0173780
	speed: 0.0330s/iter; left time: 1449.7561s
	iters: 300, epoch: 7 | loss: 0.4196172
	speed: 0.0391s/iter; left time: 1712.7713s
	iters: 400, epoch: 7 | loss: 0.0494660
	speed: 0.0389s/iter; left time: 1698.1388s
Epoch: 7 cost time: 17.681023359298706
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1452760
	speed: 0.1692s/iter; left time: 7364.6315s
	iters: 200, epoch: 8 | loss: 0.0006247
	speed: 0.0301s/iter; left time: 1305.1115s
	iters: 300, epoch: 8 | loss: 0.0059139
	speed: 0.0299s/iter; left time: 1296.2674s
	iters: 400, epoch: 8 | loss: 0.0771866
	speed: 0.0300s/iter; left time: 1295.9412s
Epoch: 8 cost time: 14.451813697814941
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4034485
	speed: 0.1688s/iter; left time: 7268.5248s
	iters: 200, epoch: 9 | loss: 0.0024513
	speed: 0.0435s/iter; left time: 1866.6134s
	iters: 300, epoch: 9 | loss: 0.2716544
	speed: 0.0475s/iter; left time: 2035.3921s
	iters: 400, epoch: 9 | loss: 0.0015249
	speed: 0.0414s/iter; left time: 1770.2264s
Epoch: 9 cost time: 20.950673580169678
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0058116
	speed: 0.2015s/iter; left time: 8578.6014s
	iters: 200, epoch: 10 | loss: 0.0161043
	speed: 0.0441s/iter; left time: 1872.4597s
	iters: 300, epoch: 10 | loss: 0.0159262
	speed: 0.0458s/iter; left time: 1941.7329s
	iters: 400, epoch: 10 | loss: 0.0190290
	speed: 0.0458s/iter; left time: 1936.5014s
Epoch: 10 cost time: 20.490955352783203
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0445955
	speed: 0.2054s/iter; left time: 8650.1210s
	iters: 200, epoch: 11 | loss: 0.0012013
	speed: 0.0425s/iter; left time: 1783.9372s
	iters: 300, epoch: 11 | loss: 0.0960710
	speed: 0.0439s/iter; left time: 1840.7987s
	iters: 400, epoch: 11 | loss: 0.0133598
	speed: 0.0354s/iter; left time: 1478.2296s
Epoch: 11 cost time: 19.254177570343018
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.245 Vali Acc: 0.954 Test Loss: 0.245 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1683334
	speed: 0.1773s/iter; left time: 7383.3775s
	iters: 200, epoch: 12 | loss: 0.0031759
	speed: 0.0359s/iter; left time: 1491.9871s
	iters: 300, epoch: 12 | loss: 0.0031402
	speed: 0.0406s/iter; left time: 1681.3731s
	iters: 400, epoch: 12 | loss: 0.0013799
	speed: 0.0418s/iter; left time: 1729.8043s
Epoch: 12 cost time: 18.688711404800415
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.966 Test Loss: 0.185 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0005065
	speed: 0.2023s/iter; left time: 8328.1455s
	iters: 200, epoch: 13 | loss: 0.1209073
	speed: 0.0395s/iter; left time: 1623.9279s
	iters: 300, epoch: 13 | loss: 0.0756683
	speed: 0.0423s/iter; left time: 1731.7550s
	iters: 400, epoch: 13 | loss: 0.1656307
	speed: 0.0429s/iter; left time: 1751.7365s
Epoch: 13 cost time: 19.987234354019165
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0030151
	speed: 0.2010s/iter; left time: 8181.8886s
	iters: 200, epoch: 14 | loss: 0.1132329
	speed: 0.0424s/iter; left time: 1723.4781s
	iters: 300, epoch: 14 | loss: 0.0041267
	speed: 0.0384s/iter; left time: 1554.5375s
	iters: 400, epoch: 14 | loss: 0.0006596
	speed: 0.0334s/iter; left time: 1347.6085s
Epoch: 14 cost time: 18.11544704437256
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0007249
	speed: 0.1530s/iter; left time: 6154.0266s
	iters: 200, epoch: 15 | loss: 0.0024889
	speed: 0.0357s/iter; left time: 1433.5133s
	iters: 300, epoch: 15 | loss: 0.3550459
	speed: 0.0328s/iter; left time: 1313.1598s
	iters: 400, epoch: 15 | loss: 0.0028914
	speed: 0.0346s/iter; left time: 1382.5020s
Epoch: 15 cost time: 16.115703582763672
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0059097
	speed: 0.1738s/iter; left time: 6912.2854s
	iters: 200, epoch: 16 | loss: 0.0142907
	speed: 0.0338s/iter; left time: 1341.2749s
	iters: 300, epoch: 16 | loss: 0.0067494
	speed: 0.0341s/iter; left time: 1347.5089s
	iters: 400, epoch: 16 | loss: 0.0166734
	speed: 0.0342s/iter; left time: 1348.6915s
Epoch: 16 cost time: 16.340815782546997
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 68330
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3138002
	speed: 0.0583s/iter; left time: 2727.1231s
	iters: 200, epoch: 1 | loss: 0.8078728
	speed: 0.0390s/iter; left time: 1819.8450s
	iters: 300, epoch: 1 | loss: 0.5111445
	speed: 0.0405s/iter; left time: 1886.5222s
	iters: 400, epoch: 1 | loss: 0.5146677
	speed: 0.0390s/iter; left time: 1815.2501s
Epoch: 1 cost time: 20.0866961479187
Epoch: 1, Steps: 469 | Train Loss: 0.833 Vali Loss: 0.374 Vali Acc: 0.901 Test Loss: 0.374 Test Acc: 0.901
Validation loss decreased (inf --> -0.901368).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1758163
	speed: 0.1706s/iter; left time: 7902.2282s
	iters: 200, epoch: 2 | loss: 0.1931384
	speed: 0.0334s/iter; left time: 1543.4374s
	iters: 300, epoch: 2 | loss: 0.0261088
	speed: 0.0340s/iter; left time: 1568.9720s
	iters: 400, epoch: 2 | loss: 0.1737259
	speed: 0.0368s/iter; left time: 1695.7942s
Epoch: 2 cost time: 16.752267599105835
Epoch: 2, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.213 Vali Acc: 0.947 Test Loss: 0.213 Test Acc: 0.947
Validation loss decreased (-0.901368 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1134596
	speed: 0.1875s/iter; left time: 8600.2820s
	iters: 200, epoch: 3 | loss: 0.1647565
	speed: 0.0375s/iter; left time: 1717.7475s
	iters: 300, epoch: 3 | loss: 0.0078330
	speed: 0.0364s/iter; left time: 1663.6193s
	iters: 400, epoch: 3 | loss: 0.2347017
	speed: 0.0373s/iter; left time: 1697.3961s
Epoch: 3 cost time: 17.52278709411621
Epoch: 3, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
Validation loss decreased (-0.946825 --> -0.953114).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0264568
	speed: 0.1847s/iter; left time: 8382.4732s
	iters: 200, epoch: 4 | loss: 0.0148340
	speed: 0.0385s/iter; left time: 1742.5909s
	iters: 300, epoch: 4 | loss: 0.0075501
	speed: 0.0385s/iter; left time: 1740.5072s
	iters: 400, epoch: 4 | loss: 0.0247080
	speed: 0.0426s/iter; left time: 1921.7930s
Epoch: 4 cost time: 18.82626700401306
Epoch: 4, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
Validation loss decreased (-0.953114 --> -0.955973).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0120808
	speed: 0.1714s/iter; left time: 7697.9412s
	iters: 200, epoch: 5 | loss: 0.1319694
	speed: 0.0342s/iter; left time: 1532.3440s
	iters: 300, epoch: 5 | loss: 0.0752397
	speed: 0.0333s/iter; left time: 1488.9978s
	iters: 400, epoch: 5 | loss: 0.2988953
	speed: 0.0347s/iter; left time: 1549.6131s
Epoch: 5 cost time: 17.805108785629272
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0136066
	speed: 0.2399s/iter; left time: 10663.4935s
	iters: 200, epoch: 6 | loss: 0.2339734
	speed: 0.0488s/iter; left time: 2164.5723s
	iters: 300, epoch: 6 | loss: 0.2059759
	speed: 0.0551s/iter; left time: 2437.2722s
	iters: 400, epoch: 6 | loss: 0.0032618
	speed: 0.0501s/iter; left time: 2214.0757s
Epoch: 6 cost time: 23.891198873519897
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
Validation loss decreased (-0.955973 --> -0.964264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0414432
	speed: 0.2036s/iter; left time: 8953.9618s
	iters: 200, epoch: 7 | loss: 0.0406833
	speed: 0.0397s/iter; left time: 1742.5836s
	iters: 300, epoch: 7 | loss: 0.0021678
	speed: 0.0430s/iter; left time: 1883.9128s
	iters: 400, epoch: 7 | loss: 0.0527062
	speed: 0.0491s/iter; left time: 2146.4263s
Epoch: 7 cost time: 21.180410146713257
Epoch: 7, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0247922
	speed: 0.2105s/iter; left time: 9161.1043s
	iters: 200, epoch: 8 | loss: 0.0241309
	speed: 0.0499s/iter; left time: 2165.2359s
	iters: 300, epoch: 8 | loss: 0.0023635
	speed: 0.0400s/iter; left time: 1731.6397s
	iters: 400, epoch: 8 | loss: 0.0111826
	speed: 0.0468s/iter; left time: 2022.5196s
Epoch: 8 cost time: 22.147722721099854
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.964264 --> -0.964836).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0029190
	speed: 0.2087s/iter; left time: 8983.6142s
	iters: 200, epoch: 9 | loss: 0.0696806
	speed: 0.0483s/iter; left time: 2075.0551s
	iters: 300, epoch: 9 | loss: 0.0015578
	speed: 0.0443s/iter; left time: 1899.3956s
	iters: 400, epoch: 9 | loss: 0.0089752
	speed: 0.0342s/iter; left time: 1459.9198s
Epoch: 9 cost time: 19.747480392456055
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.964836 --> -0.966551).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0049393
	speed: 0.1613s/iter; left time: 6866.4669s
	iters: 200, epoch: 10 | loss: 0.0005312
	speed: 0.0336s/iter; left time: 1426.9726s
	iters: 300, epoch: 10 | loss: 0.0698230
	speed: 0.0344s/iter; left time: 1459.8795s
	iters: 400, epoch: 10 | loss: 0.1123419
	speed: 0.0477s/iter; left time: 2016.3357s
Epoch: 10 cost time: 18.21017360687256
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.966551 --> -0.968838).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0098593
	speed: 0.2065s/iter; left time: 8695.7119s
	iters: 200, epoch: 11 | loss: 0.0976654
	speed: 0.0421s/iter; left time: 1766.6529s
	iters: 300, epoch: 11 | loss: 0.8059992
	speed: 0.0415s/iter; left time: 1740.0606s
	iters: 400, epoch: 11 | loss: 0.0110550
	speed: 0.0454s/iter; left time: 1896.6895s
Epoch: 11 cost time: 20.602392435073853
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0013469
	speed: 0.2016s/iter; left time: 8393.5706s
	iters: 200, epoch: 12 | loss: 0.0047454
	speed: 0.0378s/iter; left time: 1571.7174s
	iters: 300, epoch: 12 | loss: 0.0858877
	speed: 0.0458s/iter; left time: 1899.9216s
	iters: 400, epoch: 12 | loss: 0.0344002
	speed: 0.0426s/iter; left time: 1763.0868s
Epoch: 12 cost time: 20.40872097015381
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0247172
	speed: 0.2033s/iter; left time: 8369.3374s
	iters: 200, epoch: 13 | loss: 0.0026708
	speed: 0.0467s/iter; left time: 1917.8192s
	iters: 300, epoch: 13 | loss: 0.0467410
	speed: 0.0394s/iter; left time: 1615.3432s
	iters: 400, epoch: 13 | loss: 0.0095437
	speed: 0.0430s/iter; left time: 1759.3862s
Epoch: 13 cost time: 19.88950252532959
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0046789
	speed: 0.1998s/iter; left time: 8130.8923s
	iters: 200, epoch: 14 | loss: 0.0101610
	speed: 0.0380s/iter; left time: 1541.7428s
	iters: 300, epoch: 14 | loss: 0.0376737
	speed: 0.0437s/iter; left time: 1768.1547s
	iters: 400, epoch: 14 | loss: 0.0081992
	speed: 0.0409s/iter; left time: 1652.8739s
Epoch: 14 cost time: 20.147943019866943
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
Validation loss decreased (-0.968838 --> -0.971411).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0111921
	speed: 0.2033s/iter; left time: 8179.2632s
	iters: 200, epoch: 15 | loss: 0.0016678
	speed: 0.0454s/iter; left time: 1823.0627s
	iters: 300, epoch: 15 | loss: 0.0028357
	speed: 0.0414s/iter; left time: 1659.0430s
	iters: 400, epoch: 15 | loss: 0.3960288
	speed: 0.0461s/iter; left time: 1842.0556s
Epoch: 15 cost time: 20.750048398971558
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0019488
	speed: 0.1865s/iter; left time: 7416.8155s
	iters: 200, epoch: 16 | loss: 0.0019932
	speed: 0.0281s/iter; left time: 1115.5890s
	iters: 300, epoch: 16 | loss: 0.0820490
	speed: 0.0315s/iter; left time: 1248.0043s
	iters: 400, epoch: 16 | loss: 0.0048030
	speed: 0.0313s/iter; left time: 1235.8752s
Epoch: 16 cost time: 14.772157192230225
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.961 Test Loss: 0.210 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0013580
	speed: 0.1695s/iter; left time: 6659.1382s
	iters: 200, epoch: 17 | loss: 0.0033611
	speed: 0.0333s/iter; left time: 1304.5913s
	iters: 300, epoch: 17 | loss: 0.0017285
	speed: 0.0380s/iter; left time: 1484.2860s
	iters: 400, epoch: 17 | loss: 0.0033792
	speed: 0.0308s/iter; left time: 1200.9573s
Epoch: 17 cost time: 16.34199094772339
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0006067
	speed: 0.1800s/iter; left time: 6989.3893s
	iters: 200, epoch: 18 | loss: 0.0002501
	speed: 0.0341s/iter; left time: 1321.8919s
	iters: 300, epoch: 18 | loss: 0.0157521
	speed: 0.0348s/iter; left time: 1344.0833s
	iters: 400, epoch: 18 | loss: 0.0022775
	speed: 0.0323s/iter; left time: 1244.6927s
Epoch: 18 cost time: 16.439012050628662
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0010540
	speed: 0.1897s/iter; left time: 7275.8684s
	iters: 200, epoch: 19 | loss: 0.0211915
	speed: 0.0392s/iter; left time: 1500.2916s
	iters: 300, epoch: 19 | loss: 0.0028186
	speed: 0.0395s/iter; left time: 1505.7492s
	iters: 400, epoch: 19 | loss: 0.0049657
	speed: 0.0438s/iter; left time: 1666.3652s
Epoch: 19 cost time: 19.840670824050903
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0010288
	speed: 0.1868s/iter; left time: 7076.8562s
	iters: 200, epoch: 20 | loss: 0.0004846
	speed: 0.0338s/iter; left time: 1278.1893s
	iters: 300, epoch: 20 | loss: 0.0028120
	speed: 0.0344s/iter; left time: 1298.2928s
	iters: 400, epoch: 20 | loss: 0.1888399
	speed: 0.0346s/iter; left time: 1298.9989s
Epoch: 20 cost time: 16.578652143478394
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972554).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0303917
	speed: 0.1858s/iter; left time: 6953.5467s
	iters: 200, epoch: 21 | loss: 0.0014250
	speed: 0.0414s/iter; left time: 1546.1552s
	iters: 300, epoch: 21 | loss: 0.0142232
	speed: 0.0386s/iter; left time: 1436.4267s
	iters: 400, epoch: 21 | loss: 0.0013182
	speed: 0.0420s/iter; left time: 1558.2053s
Epoch: 21 cost time: 19.795504808425903
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0166776
	speed: 0.1925s/iter; left time: 7112.6753s
	iters: 200, epoch: 22 | loss: 0.0013451
	speed: 0.0591s/iter; left time: 2178.4185s
	iters: 300, epoch: 22 | loss: 0.0002250
	speed: 0.0586s/iter; left time: 2155.2454s
	iters: 400, epoch: 22 | loss: 0.0265334
	speed: 0.0598s/iter; left time: 2192.8090s
Epoch: 22 cost time: 25.93046736717224
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0036704
	speed: 0.2394s/iter; left time: 8735.1630s
	iters: 200, epoch: 23 | loss: 0.0000639
	speed: 0.0424s/iter; left time: 1543.2724s
	iters: 300, epoch: 23 | loss: 0.1137689
	speed: 0.0497s/iter; left time: 1802.6020s
	iters: 400, epoch: 23 | loss: 0.0246880
	speed: 0.0484s/iter; left time: 1750.8808s
Epoch: 23 cost time: 22.723612546920776
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1637025
	speed: 0.2282s/iter; left time: 8219.9837s
	iters: 200, epoch: 24 | loss: 0.0062687
	speed: 0.0480s/iter; left time: 1724.6995s
	iters: 300, epoch: 24 | loss: 0.0199696
	speed: 0.0543s/iter; left time: 1945.4046s
	iters: 400, epoch: 24 | loss: 0.1161484
	speed: 0.0544s/iter; left time: 1941.6763s
Epoch: 24 cost time: 24.532304286956787
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0004745
	speed: 0.2317s/iter; left time: 8234.9926s
	iters: 200, epoch: 25 | loss: 0.0066627
	speed: 0.0421s/iter; left time: 1492.4845s
	iters: 300, epoch: 25 | loss: 0.0001462
	speed: 0.0406s/iter; left time: 1435.6910s
	iters: 400, epoch: 25 | loss: 0.0015961
	speed: 0.0476s/iter; left time: 1678.4747s
Epoch: 25 cost time: 20.93230366706848
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0715460
	speed: 0.1937s/iter; left time: 6794.9234s
	iters: 200, epoch: 26 | loss: 0.0000099
	speed: 0.0410s/iter; left time: 1433.0843s
	iters: 300, epoch: 26 | loss: 0.0014098
	speed: 0.0431s/iter; left time: 1502.9086s
	iters: 400, epoch: 26 | loss: 0.0002066
	speed: 0.0492s/iter; left time: 1712.4018s
Epoch: 26 cost time: 20.57679057121277
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.5413806
	speed: 0.2160s/iter; left time: 7474.3607s
	iters: 200, epoch: 27 | loss: 0.0002847
	speed: 0.0436s/iter; left time: 1503.1296s
	iters: 300, epoch: 27 | loss: 0.0000101
	speed: 0.0409s/iter; left time: 1406.6064s
	iters: 400, epoch: 27 | loss: 0.1193144
	speed: 0.0496s/iter; left time: 1702.8340s
Epoch: 27 cost time: 21.707857608795166
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0194877
	speed: 0.2135s/iter; left time: 7289.7167s
	iters: 200, epoch: 28 | loss: 0.0116055
	speed: 0.0419s/iter; left time: 1424.9098s
	iters: 300, epoch: 28 | loss: 0.0001099
	speed: 0.0479s/iter; left time: 1626.3680s
	iters: 400, epoch: 28 | loss: 0.0000240
	speed: 0.0504s/iter; left time: 1703.9296s
Epoch: 28 cost time: 21.477261781692505
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.972554 --> -0.977128).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0004470
	speed: 0.2230s/iter; left time: 7508.9453s
	iters: 200, epoch: 29 | loss: 0.0003170
	speed: 0.0435s/iter; left time: 1461.6065s
	iters: 300, epoch: 29 | loss: 0.0000417
	speed: 0.0458s/iter; left time: 1531.6797s
	iters: 400, epoch: 29 | loss: 0.0579391
	speed: 0.0498s/iter; left time: 1661.6226s
Epoch: 29 cost time: 23.248974800109863
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0018233
	speed: 0.2338s/iter; left time: 7762.2514s
	iters: 200, epoch: 30 | loss: 0.0003100
	speed: 0.0462s/iter; left time: 1529.6376s
	iters: 300, epoch: 30 | loss: 0.0037212
	speed: 0.0479s/iter; left time: 1581.7779s
	iters: 400, epoch: 30 | loss: 0.2875429
	speed: 0.0494s/iter; left time: 1624.3226s
Epoch: 30 cost time: 22.627992630004883
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.962 Test Loss: 0.233 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0003167
	speed: 0.2343s/iter; left time: 7668.1754s
	iters: 200, epoch: 31 | loss: 0.0462353
	speed: 0.0453s/iter; left time: 1477.7289s
	iters: 300, epoch: 31 | loss: 0.0018678
	speed: 0.0431s/iter; left time: 1401.6994s
	iters: 400, epoch: 31 | loss: 0.0011425
	speed: 0.0420s/iter; left time: 1361.9954s
Epoch: 31 cost time: 21.722978115081787
Epoch: 31, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0065110
	speed: 0.2732s/iter; left time: 8815.3876s
	iters: 200, epoch: 32 | loss: 0.0001050
	speed: 0.0610s/iter; left time: 1960.7065s
	iters: 300, epoch: 32 | loss: 0.0211442
	speed: 0.0533s/iter; left time: 1708.3114s
	iters: 400, epoch: 32 | loss: 0.0052282
	speed: 0.0596s/iter; left time: 1904.4534s
Epoch: 32 cost time: 28.28179669380188
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.2393436
	speed: 0.2661s/iter; left time: 8461.4622s
	iters: 200, epoch: 33 | loss: 0.0364116
	speed: 0.0582s/iter; left time: 1844.4280s
	iters: 300, epoch: 33 | loss: 0.0011975
	speed: 0.0630s/iter; left time: 1990.9054s
	iters: 400, epoch: 33 | loss: 0.5436693
	speed: 0.0608s/iter; left time: 1914.0098s
Epoch: 33 cost time: 28.67418909072876
Epoch: 33, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.965 Test Loss: 0.214 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0010750
	speed: 0.2603s/iter; left time: 8153.9789s
	iters: 200, epoch: 34 | loss: 0.0006773
	speed: 0.0635s/iter; left time: 1981.1809s
	iters: 300, epoch: 34 | loss: 0.0000431
	speed: 0.0669s/iter; left time: 2082.3000s
	iters: 400, epoch: 34 | loss: 0.0218700
	speed: 0.0601s/iter; left time: 1866.0142s
Epoch: 34 cost time: 29.486268281936646
Epoch: 34, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0008689
	speed: 0.2342s/iter; left time: 7227.1757s
	iters: 200, epoch: 35 | loss: 0.0049014
	speed: 0.0497s/iter; left time: 1528.1506s
	iters: 300, epoch: 35 | loss: 0.0001847
	speed: 0.0456s/iter; left time: 1397.6174s
	iters: 400, epoch: 35 | loss: 0.0022616
	speed: 0.0529s/iter; left time: 1616.0618s
Epoch: 35 cost time: 23.011600732803345
Epoch: 35, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.964 Test Loss: 0.193 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0012320
	speed: 0.2194s/iter; left time: 6667.8223s
	iters: 200, epoch: 36 | loss: 0.0004079
	speed: 0.0522s/iter; left time: 1580.7181s
	iters: 300, epoch: 36 | loss: 0.0000895
	speed: 0.0565s/iter; left time: 1704.2759s
	iters: 400, epoch: 36 | loss: 0.0031905
	speed: 0.0565s/iter; left time: 1700.7159s
Epoch: 36 cost time: 24.66264820098877
Epoch: 36, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0156320
	speed: 0.2262s/iter; left time: 6768.2966s
	iters: 200, epoch: 37 | loss: 0.0004299
	speed: 0.0557s/iter; left time: 1662.1109s
	iters: 300, epoch: 37 | loss: 0.0752888
	speed: 0.0571s/iter; left time: 1698.0657s
	iters: 400, epoch: 37 | loss: 0.0043927
	speed: 0.0538s/iter; left time: 1592.0150s
Epoch: 37 cost time: 25.592764854431152
Epoch: 37, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0090202
	speed: 0.2249s/iter; left time: 6622.9185s
	iters: 200, epoch: 38 | loss: 0.0005528
	speed: 0.0529s/iter; left time: 1553.7075s
	iters: 300, epoch: 38 | loss: 0.0004153
	speed: 0.0512s/iter; left time: 1497.7432s
	iters: 400, epoch: 38 | loss: 0.0044619
	speed: 0.0541s/iter; left time: 1578.0204s
Epoch: 38 cost time: 25.146966695785522
Epoch: 38, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 43370
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2387929
	speed: 0.0659s/iter; left time: 3084.5884s
	iters: 200, epoch: 1 | loss: 0.3807953
	speed: 0.0465s/iter; left time: 2173.4344s
	iters: 300, epoch: 1 | loss: 0.4062405
	speed: 0.0404s/iter; left time: 1883.6707s
	iters: 400, epoch: 1 | loss: 0.2321527
	speed: 0.0461s/iter; left time: 2142.1207s
Epoch: 1 cost time: 23.070038080215454
Epoch: 1, Steps: 469 | Train Loss: 0.845 Vali Loss: 0.397 Vali Acc: 0.887 Test Loss: 0.397 Test Acc: 0.887
Validation loss decreased (inf --> -0.887360).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1505819
	speed: 0.2424s/iter; left time: 11232.5013s
	iters: 200, epoch: 2 | loss: 0.2465889
	speed: 0.0610s/iter; left time: 2821.9810s
	iters: 300, epoch: 2 | loss: 0.1184006
	speed: 0.0592s/iter; left time: 2731.8241s
	iters: 400, epoch: 2 | loss: 0.0850698
	speed: 0.0511s/iter; left time: 2351.9024s
Epoch: 2 cost time: 26.5967960357666
Epoch: 2, Steps: 469 | Train Loss: 0.193 Vali Loss: 0.259 Vali Acc: 0.947 Test Loss: 0.259 Test Acc: 0.947
Validation loss decreased (-0.887360 --> -0.947396).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0834030
	speed: 0.2223s/iter; left time: 10196.2253s
	iters: 200, epoch: 3 | loss: 0.0295513
	speed: 0.0467s/iter; left time: 2135.4100s
	iters: 300, epoch: 3 | loss: 0.0778329
	speed: 0.0477s/iter; left time: 2176.9765s
	iters: 400, epoch: 3 | loss: 0.0535556
	speed: 0.0422s/iter; left time: 1921.4397s
Epoch: 3 cost time: 22.044407844543457
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
Validation loss decreased (-0.947396 --> -0.948826).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4576884
	speed: 0.2352s/iter; left time: 10675.4696s
	iters: 200, epoch: 4 | loss: 0.0250276
	speed: 0.0563s/iter; left time: 2547.9025s
	iters: 300, epoch: 4 | loss: 0.0572369
	speed: 0.0584s/iter; left time: 2637.3751s
	iters: 400, epoch: 4 | loss: 0.0779887
	speed: 0.0596s/iter; left time: 2686.3569s
Epoch: 4 cost time: 26.792301893234253
Epoch: 4, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
Validation loss decreased (-0.948826 --> -0.954829).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1391215
	speed: 0.2335s/iter; left time: 10491.9322s
	iters: 200, epoch: 5 | loss: 0.0226480
	speed: 0.0542s/iter; left time: 2429.4824s
	iters: 300, epoch: 5 | loss: 0.0453730
	speed: 0.0524s/iter; left time: 2341.6188s
	iters: 400, epoch: 5 | loss: 0.2341327
	speed: 0.0493s/iter; left time: 2202.1611s
Epoch: 5 cost time: 24.432973861694336
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
Validation loss decreased (-0.954829 --> -0.956259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1921014
	speed: 0.2169s/iter; left time: 9642.3894s
	iters: 200, epoch: 6 | loss: 0.0354656
	speed: 0.0549s/iter; left time: 2435.2210s
	iters: 300, epoch: 6 | loss: 0.0227780
	speed: 0.0567s/iter; left time: 2511.4498s
	iters: 400, epoch: 6 | loss: 0.0083657
	speed: 0.0542s/iter; left time: 2394.8004s
Epoch: 6 cost time: 25.347249269485474
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
Validation loss decreased (-0.956259 --> -0.962548).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0023485
	speed: 0.2225s/iter; left time: 9786.3410s
	iters: 200, epoch: 7 | loss: 0.0847904
	speed: 0.0445s/iter; left time: 1952.0853s
	iters: 300, epoch: 7 | loss: 0.0030318
	speed: 0.0463s/iter; left time: 2029.2492s
	iters: 400, epoch: 7 | loss: 0.0738428
	speed: 0.0443s/iter; left time: 1936.2304s
Epoch: 7 cost time: 21.16395139694214
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.962548 --> -0.970267).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0159677
	speed: 0.1920s/iter; left time: 8354.1150s
	iters: 200, epoch: 8 | loss: 0.0205596
	speed: 0.0413s/iter; left time: 1793.7524s
	iters: 300, epoch: 8 | loss: 0.0248568
	speed: 0.0456s/iter; left time: 1976.5103s
	iters: 400, epoch: 8 | loss: 0.5053047
	speed: 0.0516s/iter; left time: 2228.7503s
Epoch: 8 cost time: 21.153472900390625
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0006696
	speed: 0.2144s/iter; left time: 9229.5901s
	iters: 200, epoch: 9 | loss: 0.0868671
	speed: 0.0412s/iter; left time: 1769.3155s
	iters: 300, epoch: 9 | loss: 0.0140704
	speed: 0.0494s/iter; left time: 2118.8799s
	iters: 400, epoch: 9 | loss: 0.0311959
	speed: 0.0527s/iter; left time: 2252.5675s
Epoch: 9 cost time: 22.12250018119812
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0026122
	speed: 0.2111s/iter; left time: 8987.4110s
	iters: 200, epoch: 10 | loss: 0.0079498
	speed: 0.0354s/iter; left time: 1501.8664s
	iters: 300, epoch: 10 | loss: 0.0049142
	speed: 0.0509s/iter; left time: 2156.9775s
	iters: 400, epoch: 10 | loss: 0.0047203
	speed: 0.0436s/iter; left time: 1844.5707s
Epoch: 10 cost time: 19.889491319656372
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.207 Vali Acc: 0.966 Test Loss: 0.207 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0996076
	speed: 0.1766s/iter; left time: 7436.7398s
	iters: 200, epoch: 11 | loss: 0.0237337
	speed: 0.0286s/iter; left time: 1203.5810s
	iters: 300, epoch: 11 | loss: 0.0109576
	speed: 0.0283s/iter; left time: 1186.3365s
	iters: 400, epoch: 11 | loss: 0.0013868
	speed: 0.0303s/iter; left time: 1265.8047s
Epoch: 11 cost time: 14.912753582000732
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0004440
	speed: 0.1495s/iter; left time: 6225.3350s
	iters: 200, epoch: 12 | loss: 0.0060868
	speed: 0.0288s/iter; left time: 1195.1520s
	iters: 300, epoch: 12 | loss: 0.0752621
	speed: 0.0299s/iter; left time: 1238.9096s
	iters: 400, epoch: 12 | loss: 0.0074905
	speed: 0.0280s/iter; left time: 1156.0562s
Epoch: 12 cost time: 14.104291439056396
Epoch: 12, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.952 Test Loss: 0.251 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0007635
	speed: 0.2118s/iter; left time: 8719.5144s
	iters: 200, epoch: 13 | loss: 0.0035530
	speed: 0.0513s/iter; left time: 2105.1311s
	iters: 300, epoch: 13 | loss: 0.2014224
	speed: 0.0546s/iter; left time: 2238.5578s
	iters: 400, epoch: 13 | loss: 0.0003058
	speed: 0.0541s/iter; left time: 2212.5049s
Epoch: 13 cost time: 24.884097814559937
Epoch: 13, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1356631
	speed: 0.2405s/iter; left time: 9787.4384s
	iters: 200, epoch: 14 | loss: 0.0113950
	speed: 0.0650s/iter; left time: 2639.6123s
	iters: 300, epoch: 14 | loss: 0.0010458
	speed: 0.0646s/iter; left time: 2616.4398s
	iters: 400, epoch: 14 | loss: 0.0586898
	speed: 0.0652s/iter; left time: 2634.1604s
Epoch: 14 cost time: 30.27754306793213
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0281465
	speed: 0.2657s/iter; left time: 10689.5246s
	iters: 200, epoch: 15 | loss: 0.0011295
	speed: 0.0613s/iter; left time: 2459.5215s
	iters: 300, epoch: 15 | loss: 0.0162445
	speed: 0.0619s/iter; left time: 2479.0164s
	iters: 400, epoch: 15 | loss: 0.0018092
	speed: 0.0576s/iter; left time: 2300.7859s
Epoch: 15 cost time: 29.357936143875122
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0014571
	speed: 0.2684s/iter; left time: 10672.1562s
	iters: 200, epoch: 16 | loss: 0.0022144
	speed: 0.0591s/iter; left time: 2344.3027s
	iters: 300, epoch: 16 | loss: 0.0007494
	speed: 0.0580s/iter; left time: 2294.4272s
	iters: 400, epoch: 16 | loss: 0.1689312
	speed: 0.0643s/iter; left time: 2537.6970s
Epoch: 16 cost time: 28.78014874458313
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
Validation loss decreased (-0.970267 --> -0.971696).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0014556
	speed: 0.2413s/iter; left time: 9482.4789s
	iters: 200, epoch: 17 | loss: 0.0011637
	speed: 0.0481s/iter; left time: 1884.4864s
	iters: 300, epoch: 17 | loss: 0.0111385
	speed: 0.0489s/iter; left time: 1912.7536s
	iters: 400, epoch: 17 | loss: 0.0002203
	speed: 0.0578s/iter; left time: 2254.5363s
Epoch: 17 cost time: 24.57370090484619
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.971696 --> -0.973126).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0023790
	speed: 0.2568s/iter; left time: 9971.1051s
	iters: 200, epoch: 18 | loss: 0.0370593
	speed: 0.0622s/iter; left time: 2407.8276s
	iters: 300, epoch: 18 | loss: 0.0073985
	speed: 0.0611s/iter; left time: 2361.4369s
	iters: 400, epoch: 18 | loss: 0.1068487
	speed: 0.0624s/iter; left time: 2405.2510s
Epoch: 18 cost time: 29.3117995262146
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0008658
	speed: 0.2487s/iter; left time: 9539.0079s
	iters: 200, epoch: 19 | loss: 0.2041528
	speed: 0.0506s/iter; left time: 1937.7963s
	iters: 300, epoch: 19 | loss: 0.0048370
	speed: 0.0519s/iter; left time: 1981.2832s
	iters: 400, epoch: 19 | loss: 0.0360328
	speed: 0.0507s/iter; left time: 1930.1804s
Epoch: 19 cost time: 24.469050884246826
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0001994
	speed: 0.2496s/iter; left time: 9456.3707s
	iters: 200, epoch: 20 | loss: 0.4327623
	speed: 0.0574s/iter; left time: 2170.3342s
	iters: 300, epoch: 20 | loss: 0.1984324
	speed: 0.0548s/iter; left time: 2067.0035s
	iters: 400, epoch: 20 | loss: 0.0061034
	speed: 0.0555s/iter; left time: 2086.0831s
Epoch: 20 cost time: 26.88494610786438
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0002537
	speed: 0.2321s/iter; left time: 8685.9302s
	iters: 200, epoch: 21 | loss: 0.0005450
	speed: 0.0462s/iter; left time: 1725.4734s
	iters: 300, epoch: 21 | loss: 0.0120728
	speed: 0.0455s/iter; left time: 1695.2664s
	iters: 400, epoch: 21 | loss: 0.0027637
	speed: 0.0495s/iter; left time: 1835.6998s
Epoch: 21 cost time: 23.23239541053772
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1130937
	speed: 0.2408s/iter; left time: 8899.3548s
	iters: 200, epoch: 22 | loss: 0.0007679
	speed: 0.0524s/iter; left time: 1932.3892s
	iters: 300, epoch: 22 | loss: 0.0001734
	speed: 0.0572s/iter; left time: 2100.5831s
	iters: 400, epoch: 22 | loss: 0.0044002
	speed: 0.0566s/iter; left time: 2072.9915s
Epoch: 22 cost time: 26.051716804504395
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0500847
	speed: 0.2493s/iter; left time: 9094.0034s
	iters: 200, epoch: 23 | loss: 0.0002058
	speed: 0.0554s/iter; left time: 2017.3509s
	iters: 300, epoch: 23 | loss: 0.2868190
	speed: 0.0476s/iter; left time: 1727.1750s
	iters: 400, epoch: 23 | loss: 0.0074644
	speed: 0.0471s/iter; left time: 1704.2775s
Epoch: 23 cost time: 24.189793825149536
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0171592
	speed: 0.2312s/iter; left time: 8326.2558s
	iters: 200, epoch: 24 | loss: 0.0013932
	speed: 0.0508s/iter; left time: 1824.7504s
	iters: 300, epoch: 24 | loss: 0.0005341
	speed: 0.0540s/iter; left time: 1932.8580s
	iters: 400, epoch: 24 | loss: 0.0004822
	speed: 0.0494s/iter; left time: 1764.5462s
Epoch: 24 cost time: 24.73114800453186
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0151327
	speed: 0.2360s/iter; left time: 8388.2001s
	iters: 200, epoch: 25 | loss: 0.4572750
	speed: 0.0498s/iter; left time: 1764.8399s
	iters: 300, epoch: 25 | loss: 0.0682884
	speed: 0.0493s/iter; left time: 1742.0680s
	iters: 400, epoch: 25 | loss: 0.0202660
	speed: 0.0486s/iter; left time: 1711.1594s
Epoch: 25 cost time: 23.77226972579956
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0001098
	speed: 0.2298s/iter; left time: 8058.8725s
	iters: 200, epoch: 26 | loss: 0.0076038
	speed: 0.0500s/iter; left time: 1750.1656s
	iters: 300, epoch: 26 | loss: 0.0002101
	speed: 0.0546s/iter; left time: 1904.9796s
	iters: 400, epoch: 26 | loss: 0.0007197
	speed: 0.0538s/iter; left time: 1872.3845s
Epoch: 26 cost time: 25.20492649078369
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0029555
	speed: 0.2390s/iter; left time: 8272.2841s
	iters: 200, epoch: 27 | loss: 0.0034291
	speed: 0.0508s/iter; left time: 1751.2638s
	iters: 300, epoch: 27 | loss: 0.0470861
	speed: 0.0512s/iter; left time: 1760.2746s
	iters: 400, epoch: 27 | loss: 0.0208495
	speed: 0.0471s/iter; left time: 1616.9652s
Epoch: 27 cost time: 23.73598551750183
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 30890
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4282404
	speed: 0.0695s/iter; left time: 3251.2431s
	iters: 200, epoch: 1 | loss: 0.8059105
	speed: 0.0510s/iter; left time: 2383.6020s
	iters: 300, epoch: 1 | loss: 0.5560350
	speed: 0.0522s/iter; left time: 2432.7543s
	iters: 400, epoch: 1 | loss: 1.1043693
	speed: 0.0521s/iter; left time: 2422.2154s
Epoch: 1 cost time: 26.08959174156189
Epoch: 1, Steps: 469 | Train Loss: 1.033 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
Validation loss decreased (inf --> -0.834471).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7403525
	speed: 0.2216s/iter; left time: 10268.8027s
	iters: 200, epoch: 2 | loss: 0.1492840
	speed: 0.0537s/iter; left time: 2481.1222s
	iters: 300, epoch: 2 | loss: 0.1059488
	speed: 0.0590s/iter; left time: 2719.7510s
	iters: 400, epoch: 2 | loss: 0.1554856
	speed: 0.0608s/iter; left time: 2799.9883s
Epoch: 2 cost time: 26.486260175704956
Epoch: 2, Steps: 469 | Train Loss: 0.305 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.834471 --> -0.917379).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0849342
	speed: 0.2575s/iter; left time: 11810.0337s
	iters: 200, epoch: 3 | loss: 0.0523584
	speed: 0.0579s/iter; left time: 2648.2519s
	iters: 300, epoch: 3 | loss: 0.0858741
	speed: 0.0552s/iter; left time: 2521.9183s
	iters: 400, epoch: 3 | loss: 0.0552064
	speed: 0.0536s/iter; left time: 2442.8758s
Epoch: 3 cost time: 27.135127782821655
Epoch: 3, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
Validation loss decreased (-0.917379 --> -0.942251).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0323088
	speed: 0.2501s/iter; left time: 11351.9991s
	iters: 200, epoch: 4 | loss: 0.1419528
	speed: 0.0562s/iter; left time: 2546.2464s
	iters: 300, epoch: 4 | loss: 0.0149977
	speed: 0.0555s/iter; left time: 2510.3884s
	iters: 400, epoch: 4 | loss: 0.0428029
	speed: 0.0534s/iter; left time: 2406.5446s
Epoch: 4 cost time: 25.865288496017456
Epoch: 4, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
Validation loss decreased (-0.942251 --> -0.960833).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0185825
	speed: 0.2144s/iter; left time: 9632.1413s
	iters: 200, epoch: 5 | loss: 0.1532790
	speed: 0.0442s/iter; left time: 1983.1403s
	iters: 300, epoch: 5 | loss: 0.0870460
	speed: 0.0544s/iter; left time: 2434.0009s
	iters: 400, epoch: 5 | loss: 0.2183090
	speed: 0.0564s/iter; left time: 2518.7443s
Epoch: 5 cost time: 23.8343448638916
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.960833 --> -0.962263).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1940555
	speed: 0.2214s/iter; left time: 9842.3130s
	iters: 200, epoch: 6 | loss: 0.1606176
	speed: 0.0462s/iter; left time: 2050.2113s
	iters: 300, epoch: 6 | loss: 0.0555603
	speed: 0.0469s/iter; left time: 2073.4947s
	iters: 400, epoch: 6 | loss: 0.0050194
	speed: 0.0457s/iter; left time: 2018.6806s
Epoch: 6 cost time: 22.190804481506348
Epoch: 6, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.962263 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0062741
	speed: 0.2233s/iter; left time: 9822.4595s
	iters: 200, epoch: 7 | loss: 0.0402575
	speed: 0.0502s/iter; left time: 2201.3338s
	iters: 300, epoch: 7 | loss: 0.0227415
	speed: 0.0512s/iter; left time: 2240.0175s
	iters: 400, epoch: 7 | loss: 0.0554914
	speed: 0.0516s/iter; left time: 2253.3456s
Epoch: 7 cost time: 24.143923044204712
Epoch: 7, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
Validation loss decreased (-0.963406 --> -0.966265).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0235548
	speed: 0.2366s/iter; left time: 10294.4652s
	iters: 200, epoch: 8 | loss: 0.0695741
	speed: 0.0504s/iter; left time: 2188.0926s
	iters: 300, epoch: 8 | loss: 0.0246886
	speed: 0.0498s/iter; left time: 2158.3506s
	iters: 400, epoch: 8 | loss: 0.1391300
	speed: 0.0544s/iter; left time: 2350.4454s
Epoch: 8 cost time: 24.71503210067749
Epoch: 8, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0024118
	speed: 0.2385s/iter; left time: 10265.2307s
	iters: 200, epoch: 9 | loss: 0.0032980
	speed: 0.0535s/iter; left time: 2298.6987s
	iters: 300, epoch: 9 | loss: 0.5032971
	speed: 0.0541s/iter; left time: 2317.1450s
	iters: 400, epoch: 9 | loss: 0.0022658
	speed: 0.0515s/iter; left time: 2202.4849s
Epoch: 9 cost time: 25.189265251159668
Epoch: 9, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2809476
	speed: 0.2353s/iter; left time: 10019.1991s
	iters: 200, epoch: 10 | loss: 0.0154408
	speed: 0.0560s/iter; left time: 2380.9439s
	iters: 300, epoch: 10 | loss: 0.0131229
	speed: 0.0508s/iter; left time: 2153.4766s
	iters: 400, epoch: 10 | loss: 0.0070103
	speed: 0.0484s/iter; left time: 2047.5525s
Epoch: 10 cost time: 24.3602511882782
Epoch: 10, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.966265 --> -0.970553).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0010805
	speed: 0.2163s/iter; left time: 9110.0185s
	iters: 200, epoch: 11 | loss: 0.0075174
	speed: 0.0508s/iter; left time: 2132.4676s
	iters: 300, epoch: 11 | loss: 0.0025936
	speed: 0.0477s/iter; left time: 1999.1088s
	iters: 400, epoch: 11 | loss: 0.0091760
	speed: 0.0498s/iter; left time: 2080.2525s
Epoch: 11 cost time: 23.671700716018677
Epoch: 11, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0107738
	speed: 0.2238s/iter; left time: 9317.7310s
	iters: 200, epoch: 12 | loss: 0.0094511
	speed: 0.0480s/iter; left time: 1994.9069s
	iters: 300, epoch: 12 | loss: 0.0331276
	speed: 0.0512s/iter; left time: 2122.1588s
	iters: 400, epoch: 12 | loss: 0.0735718
	speed: 0.0525s/iter; left time: 2169.6184s
Epoch: 12 cost time: 23.557018041610718
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0020314
	speed: 0.2249s/iter; left time: 9258.3049s
	iters: 200, epoch: 13 | loss: 0.0067785
	speed: 0.0513s/iter; left time: 2107.5919s
	iters: 300, epoch: 13 | loss: 0.0226867
	speed: 0.0527s/iter; left time: 2158.8503s
	iters: 400, epoch: 13 | loss: 0.0123935
	speed: 0.0518s/iter; left time: 2115.4478s
Epoch: 13 cost time: 24.353172302246094
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0608401
	speed: 0.2350s/iter; left time: 9563.6838s
	iters: 200, epoch: 14 | loss: 0.0094473
	speed: 0.0578s/iter; left time: 2345.2664s
	iters: 300, epoch: 14 | loss: 0.1773444
	speed: 0.0528s/iter; left time: 2137.8289s
	iters: 400, epoch: 14 | loss: 0.0041105
	speed: 0.0550s/iter; left time: 2223.5039s
Epoch: 14 cost time: 26.558133363723755
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0012835
	speed: 0.2502s/iter; left time: 10065.7284s
	iters: 200, epoch: 15 | loss: 0.1274302
	speed: 0.0520s/iter; left time: 2085.3036s
	iters: 300, epoch: 15 | loss: 0.0206551
	speed: 0.0600s/iter; left time: 2404.0026s
	iters: 400, epoch: 15 | loss: 0.0034196
	speed: 0.0593s/iter; left time: 2366.5279s
Epoch: 15 cost time: 26.658021211624146
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0370699
	speed: 0.2477s/iter; left time: 9851.9901s
	iters: 200, epoch: 16 | loss: 0.0178225
	speed: 0.0545s/iter; left time: 2161.3351s
	iters: 300, epoch: 16 | loss: 0.0086474
	speed: 0.0539s/iter; left time: 2132.8198s
	iters: 400, epoch: 16 | loss: 0.0134111
	speed: 0.0516s/iter; left time: 2035.5056s
Epoch: 16 cost time: 25.520217895507812
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0226188
	speed: 0.2452s/iter; left time: 9634.6851s
	iters: 200, epoch: 17 | loss: 0.0738303
	speed: 0.0495s/iter; left time: 1941.4281s
	iters: 300, epoch: 17 | loss: 0.0321345
	speed: 0.0490s/iter; left time: 1914.1572s
	iters: 400, epoch: 17 | loss: 0.0084608
	speed: 0.0503s/iter; left time: 1960.1520s
Epoch: 17 cost time: 24.063106298446655
Epoch: 17, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.970553 --> -0.971125).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0001652
	speed: 0.2388s/iter; left time: 9271.3242s
	iters: 200, epoch: 18 | loss: 0.0074118
	speed: 0.0478s/iter; left time: 1852.4800s
	iters: 300, epoch: 18 | loss: 0.0030412
	speed: 0.0516s/iter; left time: 1992.9859s
	iters: 400, epoch: 18 | loss: 0.0040534
	speed: 0.0521s/iter; left time: 2008.0010s
Epoch: 18 cost time: 24.143869400024414
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0009335
	speed: 0.2498s/iter; left time: 9583.4755s
	iters: 200, epoch: 19 | loss: 0.0018805
	speed: 0.0552s/iter; left time: 2111.3192s
	iters: 300, epoch: 19 | loss: 0.0040591
	speed: 0.0529s/iter; left time: 2017.0333s
	iters: 400, epoch: 19 | loss: 0.0005390
	speed: 0.0553s/iter; left time: 2105.7968s
Epoch: 19 cost time: 26.223846912384033
Epoch: 19, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.4767794
	speed: 0.2409s/iter; left time: 9129.4213s
	iters: 200, epoch: 20 | loss: 0.0014725
	speed: 0.0510s/iter; left time: 1927.1751s
	iters: 300, epoch: 20 | loss: 0.0018784
	speed: 0.0499s/iter; left time: 1879.4555s
	iters: 400, epoch: 20 | loss: 0.0017222
	speed: 0.0487s/iter; left time: 1832.3953s
Epoch: 20 cost time: 23.830716133117676
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0452428
	speed: 0.2460s/iter; left time: 9203.7396s
	iters: 200, epoch: 21 | loss: 0.0072665
	speed: 0.0538s/iter; left time: 2008.1573s
	iters: 300, epoch: 21 | loss: 0.0311647
	speed: 0.0534s/iter; left time: 1986.4284s
	iters: 400, epoch: 21 | loss: 0.0003418
	speed: 0.0523s/iter; left time: 1942.8123s
Epoch: 21 cost time: 25.858336210250854
Epoch: 21, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
Validation loss decreased (-0.971125 --> -0.971411).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0019569
	speed: 0.2457s/iter; left time: 9078.8089s
	iters: 200, epoch: 22 | loss: 0.0002879
	speed: 0.0475s/iter; left time: 1751.2253s
	iters: 300, epoch: 22 | loss: 0.0835710
	speed: 0.0476s/iter; left time: 1750.5490s
	iters: 400, epoch: 22 | loss: 0.0412579
	speed: 0.0485s/iter; left time: 1776.1425s
Epoch: 22 cost time: 23.476653337478638
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0011419
	speed: 0.2479s/iter; left time: 9045.1119s
	iters: 200, epoch: 23 | loss: 0.1073998
	speed: 0.0533s/iter; left time: 1940.4470s
	iters: 300, epoch: 23 | loss: 0.3619047
	speed: 0.0538s/iter; left time: 1953.6815s
	iters: 400, epoch: 23 | loss: 0.0281988
	speed: 0.0496s/iter; left time: 1794.6769s
Epoch: 23 cost time: 24.883697509765625
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0006624
	speed: 0.2331s/iter; left time: 8395.8943s
	iters: 200, epoch: 24 | loss: 0.0106084
	speed: 0.0455s/iter; left time: 1632.3777s
	iters: 300, epoch: 24 | loss: 0.0090029
	speed: 0.0454s/iter; left time: 1626.9948s
	iters: 400, epoch: 24 | loss: 0.0056288
	speed: 0.0502s/iter; left time: 1793.6635s
Epoch: 24 cost time: 22.841527700424194
Epoch: 24, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.2772047
	speed: 0.2475s/iter; left time: 8798.6555s
	iters: 200, epoch: 25 | loss: 0.0023305
	speed: 0.0636s/iter; left time: 2253.3346s
	iters: 300, epoch: 25 | loss: 0.0076477
	speed: 0.0627s/iter; left time: 2215.1881s
	iters: 400, epoch: 25 | loss: 0.0008347
	speed: 0.0550s/iter; left time: 1937.5092s
Epoch: 25 cost time: 27.758394718170166
Epoch: 25, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0007935
	speed: 0.2860s/iter; left time: 10032.1718s
	iters: 200, epoch: 26 | loss: 0.2888932
	speed: 0.0553s/iter; left time: 1935.4022s
	iters: 300, epoch: 26 | loss: 0.0022633
	speed: 0.0648s/iter; left time: 2259.2544s
	iters: 400, epoch: 26 | loss: 0.0090705
	speed: 0.0623s/iter; left time: 2166.7176s
Epoch: 26 cost time: 28.943073511123657
Epoch: 26, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0001504
	speed: 0.2833s/iter; left time: 9804.9447s
	iters: 200, epoch: 27 | loss: 0.0006224
	speed: 0.0619s/iter; left time: 2137.5464s
	iters: 300, epoch: 27 | loss: 0.0094282
	speed: 0.0604s/iter; left time: 2078.3200s
	iters: 400, epoch: 27 | loss: 0.0020887
	speed: 0.0619s/iter; left time: 2124.4384s
Epoch: 27 cost time: 29.97788166999817
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0078860
	speed: 0.2811s/iter; left time: 9596.9262s
	iters: 200, epoch: 28 | loss: 0.0003771
	speed: 0.0712s/iter; left time: 2422.8840s
	iters: 300, epoch: 28 | loss: 0.0017613
	speed: 0.0725s/iter; left time: 2460.7225s
	iters: 400, epoch: 28 | loss: 0.0003896
	speed: 0.0687s/iter; left time: 2323.4455s
Epoch: 28 cost time: 32.97085165977478
Epoch: 28, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0094912
	speed: 0.3000s/iter; left time: 10099.4670s
	iters: 200, epoch: 29 | loss: 0.1217240
	speed: 0.0659s/iter; left time: 2211.4250s
	iters: 300, epoch: 29 | loss: 0.0309893
	speed: 0.0653s/iter; left time: 2185.9934s
	iters: 400, epoch: 29 | loss: 0.0012168
	speed: 0.0583s/iter; left time: 1945.3380s
Epoch: 29 cost time: 30.980462551116943
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0244806
	speed: 0.2387s/iter; left time: 7925.7903s
	iters: 200, epoch: 30 | loss: 0.0140617
	speed: 0.0545s/iter; left time: 1805.0235s
	iters: 300, epoch: 30 | loss: 0.0678069
	speed: 0.0602s/iter; left time: 1987.2559s
	iters: 400, epoch: 30 | loss: 0.0116691
	speed: 0.0624s/iter; left time: 2051.4355s
Epoch: 30 cost time: 27.325952291488647
Epoch: 30, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0663586
	speed: 0.2647s/iter; left time: 8663.0042s
	iters: 200, epoch: 31 | loss: 0.0024416
	speed: 0.0604s/iter; left time: 1969.3292s
	iters: 300, epoch: 31 | loss: 0.0086678
	speed: 0.0596s/iter; left time: 1939.0528s
	iters: 400, epoch: 31 | loss: 0.0017359
	speed: 0.0563s/iter; left time: 1827.1530s
Epoch: 31 cost time: 27.897860527038574
Epoch: 31, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9714122355631789
model parameter : 31482
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7883668
	speed: 0.0656s/iter; left time: 3070.4248s
	iters: 200, epoch: 1 | loss: 1.3912686
	speed: 0.0504s/iter; left time: 2354.1360s
	iters: 300, epoch: 1 | loss: 0.5059975
	speed: 0.0526s/iter; left time: 2450.0251s
	iters: 400, epoch: 1 | loss: 0.4151386
	speed: 0.0509s/iter; left time: 2368.7751s
Epoch: 1 cost time: 25.682270765304565
Epoch: 1, Steps: 469 | Train Loss: 1.127 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
Validation loss decreased (inf --> -0.838760).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5332481
	speed: 0.2470s/iter; left time: 11442.1586s
	iters: 200, epoch: 2 | loss: 0.2353129
	speed: 0.0514s/iter; left time: 2377.7595s
	iters: 300, epoch: 2 | loss: 0.1955251
	speed: 0.0441s/iter; left time: 2035.5791s
	iters: 400, epoch: 2 | loss: 0.2595989
	speed: 0.0482s/iter; left time: 2218.3080s
Epoch: 2 cost time: 23.93205499649048
Epoch: 2, Steps: 469 | Train Loss: 0.326 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
Validation loss decreased (-0.838760 --> -0.913662).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0668640
	speed: 0.2394s/iter; left time: 10981.2490s
	iters: 200, epoch: 3 | loss: 0.1899243
	speed: 0.0498s/iter; left time: 2280.5042s
	iters: 300, epoch: 3 | loss: 0.1216713
	speed: 0.0536s/iter; left time: 2445.5018s
	iters: 400, epoch: 3 | loss: 0.1995520
	speed: 0.0479s/iter; left time: 2181.5726s
Epoch: 3 cost time: 23.377744674682617
Epoch: 3, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.913662 --> -0.936533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0733554
	speed: 0.2108s/iter; left time: 9571.1031s
	iters: 200, epoch: 4 | loss: 0.1315468
	speed: 0.0417s/iter; left time: 1888.1274s
	iters: 300, epoch: 4 | loss: 0.1088518
	speed: 0.0467s/iter; left time: 2111.4395s
	iters: 400, epoch: 4 | loss: 0.0807520
	speed: 0.0445s/iter; left time: 2005.4758s
Epoch: 4 cost time: 21.714293241500854
Epoch: 4, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.936533 --> -0.953114).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0769756
	speed: 0.2332s/iter; left time: 10474.4586s
	iters: 200, epoch: 5 | loss: 0.0385588
	speed: 0.0469s/iter; left time: 2101.0628s
	iters: 300, epoch: 5 | loss: 0.0460918
	speed: 0.0628s/iter; left time: 2810.3401s
	iters: 400, epoch: 5 | loss: 0.1848370
	speed: 0.0579s/iter; left time: 2582.7165s
Epoch: 5 cost time: 26.273568630218506
Epoch: 5, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.953114 --> -0.962548).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0088064
	speed: 0.2767s/iter; left time: 12301.3131s
	iters: 200, epoch: 6 | loss: 0.0201324
	speed: 0.0666s/iter; left time: 2956.1624s
	iters: 300, epoch: 6 | loss: 0.0060127
	speed: 0.0516s/iter; left time: 2281.4755s
	iters: 400, epoch: 6 | loss: 0.1955073
	speed: 0.0518s/iter; left time: 2285.2029s
Epoch: 6 cost time: 27.045743703842163
Epoch: 6, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0474479
	speed: 0.2398s/iter; left time: 10548.2970s
	iters: 200, epoch: 7 | loss: 0.0348059
	speed: 0.0486s/iter; left time: 2131.3133s
	iters: 300, epoch: 7 | loss: 0.0105746
	speed: 0.0502s/iter; left time: 2199.7345s
	iters: 400, epoch: 7 | loss: 0.0074559
	speed: 0.0492s/iter; left time: 2147.3265s
Epoch: 7 cost time: 23.78425884246826
Epoch: 7, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.962548 --> -0.963120).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0028174
	speed: 0.2470s/iter; left time: 10747.7209s
	iters: 200, epoch: 8 | loss: 0.1397598
	speed: 0.0491s/iter; left time: 2131.1058s
	iters: 300, epoch: 8 | loss: 0.0070576
	speed: 0.0531s/iter; left time: 2300.8107s
	iters: 400, epoch: 8 | loss: 0.0006282
	speed: 0.0552s/iter; left time: 2384.9364s
Epoch: 8 cost time: 25.13836979866028
Epoch: 8, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
Validation loss decreased (-0.963120 --> -0.965979).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0592278
	speed: 0.2293s/iter; left time: 9872.9716s
	iters: 200, epoch: 9 | loss: 0.0199247
	speed: 0.0457s/iter; left time: 1961.1912s
	iters: 300, epoch: 9 | loss: 0.0188081
	speed: 0.0467s/iter; left time: 1999.4927s
	iters: 400, epoch: 9 | loss: 0.0032251
	speed: 0.0491s/iter; left time: 2099.8955s
Epoch: 9 cost time: 22.35461139678955
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.965979 --> -0.969982).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0034545
	speed: 0.2447s/iter; left time: 10418.2943s
	iters: 200, epoch: 10 | loss: 0.0882550
	speed: 0.0485s/iter; left time: 2058.8395s
	iters: 300, epoch: 10 | loss: 0.0817077
	speed: 0.0501s/iter; left time: 2121.3120s
	iters: 400, epoch: 10 | loss: 0.0234376
	speed: 0.0487s/iter; left time: 2060.0245s
Epoch: 10 cost time: 23.81354546546936
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0612936
	speed: 0.2384s/iter; left time: 10040.9551s
	iters: 200, epoch: 11 | loss: 0.0127130
	speed: 0.0505s/iter; left time: 2119.9040s
	iters: 300, epoch: 11 | loss: 0.1106903
	speed: 0.0518s/iter; left time: 2170.8966s
	iters: 400, epoch: 11 | loss: 0.0030874
	speed: 0.0562s/iter; left time: 2349.0695s
Epoch: 11 cost time: 24.58385992050171
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0066287
	speed: 0.2521s/iter; left time: 10499.3939s
	iters: 200, epoch: 12 | loss: 0.1021354
	speed: 0.0499s/iter; left time: 2071.3225s
	iters: 300, epoch: 12 | loss: 0.0236420
	speed: 0.0531s/iter; left time: 2199.3758s
	iters: 400, epoch: 12 | loss: 0.0024206
	speed: 0.0554s/iter; left time: 2289.1427s
Epoch: 12 cost time: 25.034988164901733
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0088219
	speed: 0.2486s/iter; left time: 10234.0269s
	iters: 200, epoch: 13 | loss: 0.0717169
	speed: 0.0472s/iter; left time: 1939.1383s
	iters: 300, epoch: 13 | loss: 0.0104771
	speed: 0.0469s/iter; left time: 1920.8207s
	iters: 400, epoch: 13 | loss: 0.0571324
	speed: 0.0513s/iter; left time: 2098.0950s
Epoch: 13 cost time: 23.09491539001465
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2584476
	speed: 0.2402s/iter; left time: 9778.3788s
	iters: 200, epoch: 14 | loss: 0.0151368
	speed: 0.0409s/iter; left time: 1659.3253s
	iters: 300, epoch: 14 | loss: 0.3461513
	speed: 0.0442s/iter; left time: 1788.5595s
	iters: 400, epoch: 14 | loss: 0.0076826
	speed: 0.0461s/iter; left time: 1862.0702s
Epoch: 14 cost time: 21.2618670463562
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0087349
	speed: 0.3035s/iter; left time: 12210.9143s
	iters: 200, epoch: 15 | loss: 0.0125838
	speed: 0.0726s/iter; left time: 2915.7534s
	iters: 300, epoch: 15 | loss: 0.0040791
	speed: 0.0722s/iter; left time: 2889.6699s
	iters: 400, epoch: 15 | loss: 0.0515259
	speed: 0.0722s/iter; left time: 2884.2903s
Epoch: 15 cost time: 33.63694143295288
Epoch: 15, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969982 --> -0.970267).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2794886
	speed: 0.2881s/iter; left time: 11456.5906s
	iters: 200, epoch: 16 | loss: 0.0091429
	speed: 0.0571s/iter; left time: 2264.0450s
	iters: 300, epoch: 16 | loss: 0.0022812
	speed: 0.0592s/iter; left time: 2341.7686s
	iters: 400, epoch: 16 | loss: 0.0293796
	speed: 0.0683s/iter; left time: 2695.5327s
Epoch: 16 cost time: 29.630858659744263
Epoch: 16, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0012038
	speed: 0.2898s/iter; left time: 11386.6936s
	iters: 200, epoch: 17 | loss: 0.0023392
	speed: 0.0593s/iter; left time: 2324.6103s
	iters: 300, epoch: 17 | loss: 0.0179701
	speed: 0.0586s/iter; left time: 2290.4713s
	iters: 400, epoch: 17 | loss: 0.0123684
	speed: 0.0438s/iter; left time: 1706.3208s
Epoch: 17 cost time: 26.249392986297607
Epoch: 17, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.970553).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0008594
	speed: 0.2220s/iter; left time: 8619.3547s
	iters: 200, epoch: 18 | loss: 0.0122299
	speed: 0.0554s/iter; left time: 2146.0004s
	iters: 300, epoch: 18 | loss: 0.0030396
	speed: 0.0540s/iter; left time: 2086.9932s
	iters: 400, epoch: 18 | loss: 0.0007706
	speed: 0.0559s/iter; left time: 2154.3334s
Epoch: 18 cost time: 25.877679109573364
Epoch: 18, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0374137
	speed: 0.2603s/iter; left time: 9985.0787s
	iters: 200, epoch: 19 | loss: 0.0052432
	speed: 0.0534s/iter; left time: 2042.1218s
	iters: 300, epoch: 19 | loss: 0.0053885
	speed: 0.0583s/iter; left time: 2226.1694s
	iters: 400, epoch: 19 | loss: 0.0468733
	speed: 0.0582s/iter; left time: 2215.2893s
Epoch: 19 cost time: 27.12886381149292
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0011335
	speed: 0.2608s/iter; left time: 9881.9580s
	iters: 200, epoch: 20 | loss: 0.0697506
	speed: 0.0527s/iter; left time: 1989.8536s
	iters: 300, epoch: 20 | loss: 0.0206219
	speed: 0.0511s/iter; left time: 1924.2994s
	iters: 400, epoch: 20 | loss: 0.4753756
	speed: 0.0496s/iter; left time: 1866.1635s
Epoch: 20 cost time: 24.284359216690063
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0005693
	speed: 0.2466s/iter; left time: 9228.8493s
	iters: 200, epoch: 21 | loss: 0.0148678
	speed: 0.0547s/iter; left time: 2042.0580s
	iters: 300, epoch: 21 | loss: 0.0873613
	speed: 0.0496s/iter; left time: 1846.5409s
	iters: 400, epoch: 21 | loss: 0.1570655
	speed: 0.0502s/iter; left time: 1865.2882s
Epoch: 21 cost time: 24.55419945716858
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0129125
	speed: 0.2556s/iter; left time: 9445.1348s
	iters: 200, epoch: 22 | loss: 0.0153474
	speed: 0.0496s/iter; left time: 1827.8067s
	iters: 300, epoch: 22 | loss: 0.0087189
	speed: 0.0504s/iter; left time: 1853.6225s
	iters: 400, epoch: 22 | loss: 0.0088986
	speed: 0.0517s/iter; left time: 1895.8715s
Epoch: 22 cost time: 24.976386070251465
Epoch: 22, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.4231433
	speed: 0.2577s/iter; left time: 9401.3729s
	iters: 200, epoch: 23 | loss: 0.0993351
	speed: 0.0458s/iter; left time: 1666.9132s
	iters: 300, epoch: 23 | loss: 0.0012219
	speed: 0.0433s/iter; left time: 1571.7765s
	iters: 400, epoch: 23 | loss: 0.0042793
	speed: 0.0434s/iter; left time: 1569.4776s
Epoch: 23 cost time: 21.3985378742218
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0015761
	speed: 0.2441s/iter; left time: 8792.4357s
	iters: 200, epoch: 24 | loss: 0.0095711
	speed: 0.0492s/iter; left time: 1766.6887s
	iters: 300, epoch: 24 | loss: 0.0014445
	speed: 0.0582s/iter; left time: 2083.0806s
	iters: 400, epoch: 24 | loss: 0.0001375
	speed: 0.0586s/iter; left time: 2092.8287s
Epoch: 24 cost time: 26.019736766815186
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1238593
	speed: 0.2686s/iter; left time: 9548.3350s
	iters: 200, epoch: 25 | loss: 0.0004711
	speed: 0.0624s/iter; left time: 2211.7367s
	iters: 300, epoch: 25 | loss: 0.0005813
	speed: 0.0613s/iter; left time: 2168.3494s
	iters: 400, epoch: 25 | loss: 0.0193856
	speed: 0.0640s/iter; left time: 2256.9883s
Epoch: 25 cost time: 29.335174322128296
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.970553 --> -0.975127).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0382902
	speed: 0.2892s/iter; left time: 10142.8054s
	iters: 200, epoch: 26 | loss: 0.1619295
	speed: 0.0543s/iter; left time: 1900.1214s
	iters: 300, epoch: 26 | loss: 0.0010344
	speed: 0.0503s/iter; left time: 1755.1689s
	iters: 400, epoch: 26 | loss: 0.0013402
	speed: 0.0530s/iter; left time: 1841.6395s
Epoch: 26 cost time: 25.877538919448853
Epoch: 26, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0005045
	speed: 0.2570s/iter; left time: 8892.6354s
	iters: 200, epoch: 27 | loss: 0.0002146
	speed: 0.0518s/iter; left time: 1785.8281s
	iters: 300, epoch: 27 | loss: 0.1932386
	speed: 0.0496s/iter; left time: 1706.3253s
	iters: 400, epoch: 27 | loss: 0.0183676
	speed: 0.0486s/iter; left time: 1668.4461s
Epoch: 27 cost time: 24.14926791191101
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0104876
	speed: 0.2508s/iter; left time: 8562.2040s
	iters: 200, epoch: 28 | loss: 0.0003490
	speed: 0.0493s/iter; left time: 1678.2970s
	iters: 300, epoch: 28 | loss: 0.0609833
	speed: 0.0495s/iter; left time: 1680.4248s
	iters: 400, epoch: 28 | loss: 0.0389364
	speed: 0.0507s/iter; left time: 1717.0321s
Epoch: 28 cost time: 24.17335271835327
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0015056
	speed: 0.2545s/iter; left time: 8567.3394s
	iters: 200, epoch: 29 | loss: 0.0030793
	speed: 0.0487s/iter; left time: 1634.2960s
	iters: 300, epoch: 29 | loss: 0.0266993
	speed: 0.0467s/iter; left time: 1561.5206s
	iters: 400, epoch: 29 | loss: 0.0053649
	speed: 0.0488s/iter; left time: 1628.5262s
Epoch: 29 cost time: 23.471811532974243
Epoch: 29, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1570440
	speed: 0.2525s/iter; left time: 8382.2497s
	iters: 200, epoch: 30 | loss: 0.0012731
	speed: 0.0520s/iter; left time: 1722.4236s
	iters: 300, epoch: 30 | loss: 0.0067714
	speed: 0.0537s/iter; left time: 1770.6436s
	iters: 400, epoch: 30 | loss: 0.0006157
	speed: 0.0467s/iter; left time: 1537.9361s
Epoch: 30 cost time: 24.408810138702393
Epoch: 30, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0036595
	speed: 0.2400s/iter; left time: 7853.9509s
	iters: 200, epoch: 31 | loss: 0.0032292
	speed: 0.0478s/iter; left time: 1559.8145s
	iters: 300, epoch: 31 | loss: 0.0009171
	speed: 0.0424s/iter; left time: 1379.3279s
	iters: 400, epoch: 31 | loss: 0.0030590
	speed: 0.0455s/iter; left time: 1475.5857s
Epoch: 31 cost time: 21.93531036376953
Epoch: 31, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0006703
	speed: 0.2586s/iter; left time: 8343.7160s
	iters: 200, epoch: 32 | loss: 0.1095985
	speed: 0.0548s/iter; left time: 1761.8192s
	iters: 300, epoch: 32 | loss: 0.0006879
	speed: 0.0542s/iter; left time: 1736.4858s
	iters: 400, epoch: 32 | loss: 0.0002951
	speed: 0.0598s/iter; left time: 1911.6182s
Epoch: 32 cost time: 26.252385139465332
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.969 Test Loss: 0.194 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0001189
	speed: 0.2482s/iter; left time: 7889.9885s
	iters: 200, epoch: 33 | loss: 0.0004825
	speed: 0.0525s/iter; left time: 1664.0306s
	iters: 300, epoch: 33 | loss: 0.0079047
	speed: 0.0522s/iter; left time: 1647.8904s
	iters: 400, epoch: 33 | loss: 0.0011560
	speed: 0.0499s/iter; left time: 1570.3532s
Epoch: 33 cost time: 24.935314178466797
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.1441832
	speed: 0.2387s/iter; left time: 7477.3989s
	iters: 200, epoch: 34 | loss: 0.0003656
	speed: 0.0445s/iter; left time: 1389.2401s
	iters: 300, epoch: 34 | loss: 0.0003668
	speed: 0.0491s/iter; left time: 1528.1579s
	iters: 400, epoch: 34 | loss: 0.0000406
	speed: 0.0459s/iter; left time: 1423.7481s
Epoch: 34 cost time: 22.070183038711548
Epoch: 34, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0031197
	speed: 0.2439s/iter; left time: 7524.7407s
	iters: 200, epoch: 35 | loss: 0.0031776
	speed: 0.0515s/iter; left time: 1582.9778s
	iters: 300, epoch: 35 | loss: 0.0006634
	speed: 0.0454s/iter; left time: 1392.4500s
	iters: 400, epoch: 35 | loss: 0.0136389
	speed: 0.0500s/iter; left time: 1526.9099s
Epoch: 35 cost time: 23.72475814819336
Epoch: 35, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 18810
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7177116
	speed: 0.0680s/iter; left time: 3182.7309s
	iters: 200, epoch: 1 | loss: 1.6726685
	speed: 0.0534s/iter; left time: 2491.6223s
	iters: 300, epoch: 1 | loss: 0.7598446
	speed: 0.0579s/iter; left time: 2699.9231s
	iters: 400, epoch: 1 | loss: 0.3981802
	speed: 0.0574s/iter; left time: 2666.8523s
Epoch: 1 cost time: 27.54931330680847
Epoch: 1, Steps: 469 | Train Loss: 1.161 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (inf --> -0.850481).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2747739
	speed: 0.2573s/iter; left time: 11922.9732s
	iters: 200, epoch: 2 | loss: 0.5756164
	speed: 0.0576s/iter; left time: 2662.4246s
	iters: 300, epoch: 2 | loss: 0.2802832
	speed: 0.0454s/iter; left time: 2093.2556s
	iters: 400, epoch: 2 | loss: 0.3521120
	speed: 0.0419s/iter; left time: 1928.5180s
Epoch: 2 cost time: 22.949000597000122
Epoch: 2, Steps: 469 | Train Loss: 0.332 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.850481 --> -0.919094).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2966941
	speed: 0.2167s/iter; left time: 9940.0192s
	iters: 200, epoch: 3 | loss: 0.1227988
	speed: 0.0515s/iter; left time: 2356.2789s
	iters: 300, epoch: 3 | loss: 0.0972335
	speed: 0.0478s/iter; left time: 2181.6397s
	iters: 400, epoch: 3 | loss: 0.1102634
	speed: 0.0471s/iter; left time: 2144.9494s
Epoch: 3 cost time: 22.960819482803345
Epoch: 3, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.919094 --> -0.949969).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0851701
	speed: 0.2289s/iter; left time: 10388.7993s
	iters: 200, epoch: 4 | loss: 0.6217828
	speed: 0.0462s/iter; left time: 2090.7802s
	iters: 300, epoch: 4 | loss: 0.3020293
	speed: 0.0426s/iter; left time: 1924.1581s
	iters: 400, epoch: 4 | loss: 0.1421995
	speed: 0.0401s/iter; left time: 1808.5815s
Epoch: 4 cost time: 21.79202938079834
Epoch: 4, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
Validation loss decreased (-0.949969 --> -0.956545).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0509357
	speed: 0.2557s/iter; left time: 11485.8187s
	iters: 200, epoch: 5 | loss: 0.0266934
	speed: 0.0538s/iter; left time: 2412.9332s
	iters: 300, epoch: 5 | loss: 0.2839758
	speed: 0.0582s/iter; left time: 2602.4130s
	iters: 400, epoch: 5 | loss: 0.0622678
	speed: 0.0556s/iter; left time: 2482.9108s
Epoch: 5 cost time: 26.42917227745056
Epoch: 5, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0715572
	speed: 0.2384s/iter; left time: 10596.9445s
	iters: 200, epoch: 6 | loss: 0.0123686
	speed: 0.0567s/iter; left time: 2512.8749s
	iters: 300, epoch: 6 | loss: 0.0417801
	speed: 0.0504s/iter; left time: 2229.5062s
	iters: 400, epoch: 6 | loss: 0.4453302
	speed: 0.0449s/iter; left time: 1980.4279s
Epoch: 6 cost time: 23.70061421394348
Epoch: 6, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.195 Vali Acc: 0.961 Test Loss: 0.195 Test Acc: 0.961
Validation loss decreased (-0.956545 --> -0.960547).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0217262
	speed: 0.2323s/iter; left time: 10218.8936s
	iters: 200, epoch: 7 | loss: 0.0150679
	speed: 0.0461s/iter; left time: 2024.6647s
	iters: 300, epoch: 7 | loss: 0.0247776
	speed: 0.0447s/iter; left time: 1956.6451s
	iters: 400, epoch: 7 | loss: 0.0216943
	speed: 0.0452s/iter; left time: 1973.6379s
Epoch: 7 cost time: 21.947729349136353
Epoch: 7, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
Validation loss decreased (-0.960547 --> -0.962262).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0037123
	speed: 0.2368s/iter; left time: 10307.2267s
	iters: 200, epoch: 8 | loss: 0.1350987
	speed: 0.0484s/iter; left time: 2101.7614s
	iters: 300, epoch: 8 | loss: 0.0087110
	speed: 0.0489s/iter; left time: 2116.3776s
	iters: 400, epoch: 8 | loss: 0.0516576
	speed: 0.0466s/iter; left time: 2013.6661s
Epoch: 8 cost time: 23.382499933242798
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.962262 --> -0.964549).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1251529
	speed: 0.2377s/iter; left time: 10234.3776s
	iters: 200, epoch: 9 | loss: 0.0122481
	speed: 0.0451s/iter; left time: 1938.4432s
	iters: 300, epoch: 9 | loss: 0.1192849
	speed: 0.0435s/iter; left time: 1863.6641s
	iters: 400, epoch: 9 | loss: 0.0203371
	speed: 0.0423s/iter; left time: 1808.0535s
Epoch: 9 cost time: 21.17481541633606
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0018297
	speed: 0.2298s/iter; left time: 9783.9878s
	iters: 200, epoch: 10 | loss: 0.0154618
	speed: 0.0476s/iter; left time: 2022.3511s
	iters: 300, epoch: 10 | loss: 0.0073175
	speed: 0.0459s/iter; left time: 1946.8280s
	iters: 400, epoch: 10 | loss: 0.0932504
	speed: 0.0459s/iter; left time: 1938.9321s
Epoch: 10 cost time: 22.500393867492676
Epoch: 10, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0416216
	speed: 0.2326s/iter; left time: 9797.0435s
	iters: 200, epoch: 11 | loss: 0.0173559
	speed: 0.0488s/iter; left time: 2051.2153s
	iters: 300, epoch: 11 | loss: 0.0323217
	speed: 0.0485s/iter; left time: 2032.0374s
	iters: 400, epoch: 11 | loss: 0.0507483
	speed: 0.0486s/iter; left time: 2030.8909s
Epoch: 11 cost time: 23.18142580986023
Epoch: 11, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0004758
	speed: 0.2431s/iter; left time: 10124.2188s
	iters: 200, epoch: 12 | loss: 0.0030216
	speed: 0.0446s/iter; left time: 1851.9124s
	iters: 300, epoch: 12 | loss: 0.0236963
	speed: 0.0425s/iter; left time: 1760.0048s
	iters: 400, epoch: 12 | loss: 0.0798533
	speed: 0.0437s/iter; left time: 1805.0861s
Epoch: 12 cost time: 21.404375314712524
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0028263
	speed: 0.2421s/iter; left time: 9969.1500s
	iters: 200, epoch: 13 | loss: 0.0011480
	speed: 0.0508s/iter; left time: 2084.8184s
	iters: 300, epoch: 13 | loss: 0.0040380
	speed: 0.0534s/iter; left time: 2189.7704s
	iters: 400, epoch: 13 | loss: 0.0005779
	speed: 0.0538s/iter; left time: 2197.5805s
Epoch: 13 cost time: 25.15651297569275
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0025443
	speed: 0.2556s/iter; left time: 10405.6390s
	iters: 200, epoch: 14 | loss: 0.0036149
	speed: 0.0451s/iter; left time: 1832.3095s
	iters: 300, epoch: 14 | loss: 0.0068178
	speed: 0.0451s/iter; left time: 1827.4025s
	iters: 400, epoch: 14 | loss: 0.0084866
	speed: 0.0437s/iter; left time: 1764.3891s
Epoch: 14 cost time: 22.299325942993164
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.964549 --> -0.967694).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0195872
	speed: 0.2364s/iter; left time: 9510.7291s
	iters: 200, epoch: 15 | loss: 0.0005244
	speed: 0.0475s/iter; left time: 1906.0750s
	iters: 300, epoch: 15 | loss: 0.0480505
	speed: 0.0466s/iter; left time: 1864.9031s
	iters: 400, epoch: 15 | loss: 0.0391124
	speed: 0.0451s/iter; left time: 1801.2771s
Epoch: 15 cost time: 22.401435375213623
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
Validation loss decreased (-0.967694 --> -0.967980).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0028825
	speed: 0.2381s/iter; left time: 9466.5525s
	iters: 200, epoch: 16 | loss: 0.0207465
	speed: 0.0499s/iter; left time: 1980.1123s
	iters: 300, epoch: 16 | loss: 0.0511893
	speed: 0.0492s/iter; left time: 1947.5145s
	iters: 400, epoch: 16 | loss: 0.0012749
	speed: 0.0509s/iter; left time: 2010.7176s
Epoch: 16 cost time: 24.32507014274597
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0234822
	speed: 0.2477s/iter; left time: 9735.7679s
	iters: 200, epoch: 17 | loss: 0.0816908
	speed: 0.0473s/iter; left time: 1853.0044s
	iters: 300, epoch: 17 | loss: 0.0009695
	speed: 0.0483s/iter; left time: 1886.6065s
	iters: 400, epoch: 17 | loss: 0.0087350
	speed: 0.0480s/iter; left time: 1871.7079s
Epoch: 17 cost time: 23.14300560951233
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0024741
	speed: 0.2376s/iter; left time: 9225.6243s
	iters: 200, epoch: 18 | loss: 0.0235623
	speed: 0.0489s/iter; left time: 1894.2167s
	iters: 300, epoch: 18 | loss: 0.0156253
	speed: 0.0475s/iter; left time: 1833.5154s
	iters: 400, epoch: 18 | loss: 0.0047965
	speed: 0.0474s/iter; left time: 1825.6790s
Epoch: 18 cost time: 22.875736474990845
Epoch: 18, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.967980 --> -0.968266).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0302252
	speed: 0.2461s/iter; left time: 9440.6852s
	iters: 200, epoch: 19 | loss: 0.0015752
	speed: 0.0663s/iter; left time: 2537.1097s
	iters: 300, epoch: 19 | loss: 0.0299598
	speed: 0.0556s/iter; left time: 2120.6831s
	iters: 400, epoch: 19 | loss: 0.0223448
	speed: 0.0684s/iter; left time: 2604.1977s
Epoch: 19 cost time: 30.922905206680298
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0071661
	speed: 0.3147s/iter; left time: 11922.1588s
	iters: 200, epoch: 20 | loss: 0.0550438
	speed: 0.0697s/iter; left time: 2634.0249s
	iters: 300, epoch: 20 | loss: 0.0009924
	speed: 0.0646s/iter; left time: 2436.0569s
	iters: 400, epoch: 20 | loss: 0.0027890
	speed: 0.0741s/iter; left time: 2786.6830s
Epoch: 20 cost time: 33.19392967224121
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.968266 --> -0.969981).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.4695356
	speed: 0.3050s/iter; left time: 11413.8201s
	iters: 200, epoch: 21 | loss: 0.0018965
	speed: 0.0682s/iter; left time: 2545.6493s
	iters: 300, epoch: 21 | loss: 0.0047539
	speed: 0.0644s/iter; left time: 2397.2884s
	iters: 400, epoch: 21 | loss: 0.0013086
	speed: 0.0717s/iter; left time: 2660.9775s
Epoch: 21 cost time: 32.15606904029846
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0196000
	speed: 0.2968s/iter; left time: 10966.2525s
	iters: 200, epoch: 22 | loss: 0.0197322
	speed: 0.0605s/iter; left time: 2230.9636s
	iters: 300, epoch: 22 | loss: 0.0938803
	speed: 0.0585s/iter; left time: 2148.7045s
	iters: 400, epoch: 22 | loss: 0.0006035
	speed: 0.0665s/iter; left time: 2437.8157s
Epoch: 22 cost time: 29.673774242401123
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0002102
	speed: 0.2933s/iter; left time: 10699.9726s
	iters: 200, epoch: 23 | loss: 0.0018870
	speed: 0.0596s/iter; left time: 2169.6499s
	iters: 300, epoch: 23 | loss: 0.0084528
	speed: 0.0577s/iter; left time: 2093.4402s
	iters: 400, epoch: 23 | loss: 0.0393332
	speed: 0.0630s/iter; left time: 2281.1130s
Epoch: 23 cost time: 28.12786293029785
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0004898
	speed: 0.2559s/iter; left time: 9215.2554s
	iters: 200, epoch: 24 | loss: 0.0145010
	speed: 0.0461s/iter; left time: 1656.2156s
	iters: 300, epoch: 24 | loss: 0.0014839
	speed: 0.0478s/iter; left time: 1710.3247s
	iters: 400, epoch: 24 | loss: 0.2692290
	speed: 0.0479s/iter; left time: 1711.7880s
Epoch: 24 cost time: 22.714685916900635
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0305534
	speed: 0.2717s/iter; left time: 9656.9747s
	iters: 200, epoch: 25 | loss: 0.0039353
	speed: 0.0574s/iter; left time: 2036.0296s
	iters: 300, epoch: 25 | loss: 0.0704120
	speed: 0.0546s/iter; left time: 1928.0974s
	iters: 400, epoch: 25 | loss: 0.1801540
	speed: 0.0589s/iter; left time: 2074.5656s
Epoch: 25 cost time: 27.351150512695312
Epoch: 25, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.194 Vali Acc: 0.966 Test Loss: 0.194 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0024570
	speed: 0.2666s/iter; left time: 9352.7928s
	iters: 200, epoch: 26 | loss: 0.0067975
	speed: 0.0542s/iter; left time: 1896.4978s
	iters: 300, epoch: 26 | loss: 0.0002086
	speed: 0.0526s/iter; left time: 1833.4552s
	iters: 400, epoch: 26 | loss: 0.1727751
	speed: 0.0584s/iter; left time: 2032.6507s
Epoch: 26 cost time: 26.378096342086792
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.182 Vali Acc: 0.966 Test Loss: 0.182 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0017870
	speed: 0.2724s/iter; left time: 9428.1160s
	iters: 200, epoch: 27 | loss: 0.0012070
	speed: 0.0570s/iter; left time: 1965.4835s
	iters: 300, epoch: 27 | loss: 0.0148504
	speed: 0.0586s/iter; left time: 2014.6819s
	iters: 400, epoch: 27 | loss: 0.2482895
	speed: 0.0607s/iter; left time: 2081.6299s
Epoch: 27 cost time: 28.59090280532837
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0094473
	speed: 0.2881s/iter; left time: 9834.0697s
	iters: 200, epoch: 28 | loss: 0.0319492
	speed: 0.0627s/iter; left time: 2134.1020s
	iters: 300, epoch: 28 | loss: 0.0357826
	speed: 0.0659s/iter; left time: 2237.4797s
	iters: 400, epoch: 28 | loss: 0.0006443
	speed: 0.0713s/iter; left time: 2411.6599s
Epoch: 28 cost time: 31.696594953536987
Epoch: 28, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
Validation loss decreased (-0.969981 --> -0.970553).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0060409
	speed: 0.2920s/iter; left time: 9831.6183s
	iters: 200, epoch: 29 | loss: 0.0034994
	speed: 0.0615s/iter; left time: 2063.3496s
	iters: 300, epoch: 29 | loss: 0.0402494
	speed: 0.0654s/iter; left time: 2189.0766s
	iters: 400, epoch: 29 | loss: 0.0112079
	speed: 0.0621s/iter; left time: 2072.2726s
Epoch: 29 cost time: 28.75367832183838
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
Validation loss decreased (-0.970553 --> -0.973984).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0074983
	speed: 0.2584s/iter; left time: 8578.7438s
	iters: 200, epoch: 30 | loss: 0.0023666
	speed: 0.0549s/iter; left time: 1818.7884s
	iters: 300, epoch: 30 | loss: 0.0010985
	speed: 0.0671s/iter; left time: 2213.8386s
	iters: 400, epoch: 30 | loss: 0.0178333
	speed: 0.0688s/iter; left time: 2264.2764s
Epoch: 30 cost time: 29.316584587097168
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.1414607
	speed: 0.2983s/iter; left time: 9764.1696s
	iters: 200, epoch: 31 | loss: 0.0070912
	speed: 0.0502s/iter; left time: 1639.1930s
	iters: 300, epoch: 31 | loss: 0.0084136
	speed: 0.0550s/iter; left time: 1790.5296s
	iters: 400, epoch: 31 | loss: 0.0066582
	speed: 0.0640s/iter; left time: 2075.2443s
Epoch: 31 cost time: 27.632444381713867
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0069117
	speed: 0.2872s/iter; left time: 9264.6303s
	iters: 200, epoch: 32 | loss: 0.0077278
	speed: 0.0577s/iter; left time: 1857.0937s
	iters: 300, epoch: 32 | loss: 0.0004672
	speed: 0.0483s/iter; left time: 1547.2325s
	iters: 400, epoch: 32 | loss: 0.0152880
	speed: 0.0476s/iter; left time: 1521.8446s
Epoch: 32 cost time: 25.502546310424805
Epoch: 32, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
Validation loss decreased (-0.973984 --> -0.976556).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0001704
	speed: 0.2671s/iter; left time: 8492.1545s
	iters: 200, epoch: 33 | loss: 0.0217379
	speed: 0.0610s/iter; left time: 1933.8897s
	iters: 300, epoch: 33 | loss: 0.0013385
	speed: 0.0612s/iter; left time: 1933.7808s
	iters: 400, epoch: 33 | loss: 0.0004921
	speed: 0.0607s/iter; left time: 1912.4488s
Epoch: 33 cost time: 29.720678091049194
Epoch: 33, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0017064
	speed: 0.3017s/iter; left time: 9449.9974s
	iters: 200, epoch: 34 | loss: 0.0319636
	speed: 0.0648s/iter; left time: 2023.9077s
	iters: 300, epoch: 34 | loss: 0.0018916
	speed: 0.0658s/iter; left time: 2046.6390s
	iters: 400, epoch: 34 | loss: 0.0019494
	speed: 0.0579s/iter; left time: 1797.0878s
Epoch: 34 cost time: 28.98636794090271
Epoch: 34, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0032922
	speed: 0.2669s/iter; left time: 8234.0289s
	iters: 200, epoch: 35 | loss: 0.0030016
	speed: 0.0641s/iter; left time: 1972.8154s
	iters: 300, epoch: 35 | loss: 0.0007634
	speed: 0.0673s/iter; left time: 2063.7120s
	iters: 400, epoch: 35 | loss: 0.0058414
	speed: 0.0602s/iter; left time: 1840.8379s
Epoch: 35 cost time: 30.66086483001709
Epoch: 35, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0074256
	speed: 0.2714s/iter; left time: 8247.2018s
	iters: 200, epoch: 36 | loss: 0.1701434
	speed: 0.0710s/iter; left time: 2149.2628s
	iters: 300, epoch: 36 | loss: 0.0049937
	speed: 0.0711s/iter; left time: 2146.7820s
	iters: 400, epoch: 36 | loss: 0.0010382
	speed: 0.0642s/iter; left time: 1932.5752s
Epoch: 36 cost time: 32.495506286621094
Epoch: 36, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0017990
	speed: 0.3022s/iter; left time: 9041.8823s
	iters: 200, epoch: 37 | loss: 0.0649489
	speed: 0.0693s/iter; left time: 2066.2012s
	iters: 300, epoch: 37 | loss: 0.0006873
	speed: 0.0678s/iter; left time: 2014.9340s
	iters: 400, epoch: 37 | loss: 0.0009065
	speed: 0.0703s/iter; left time: 2082.4499s
Epoch: 37 cost time: 32.41173577308655
Epoch: 37, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0189714
	speed: 0.2878s/iter; left time: 8476.5016s
	iters: 200, epoch: 38 | loss: 0.0538475
	speed: 0.0545s/iter; left time: 1598.3712s
	iters: 300, epoch: 38 | loss: 0.0020497
	speed: 0.0624s/iter; left time: 1825.1822s
	iters: 400, epoch: 38 | loss: 0.0007901
	speed: 0.0707s/iter; left time: 2061.7955s
Epoch: 38 cost time: 29.160923957824707
Epoch: 38, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0727128
	speed: 0.3139s/iter; left time: 9097.0995s
	iters: 200, epoch: 39 | loss: 0.0141417
	speed: 0.0596s/iter; left time: 1721.1467s
	iters: 300, epoch: 39 | loss: 0.0019555
	speed: 0.0552s/iter; left time: 1587.6278s
	iters: 400, epoch: 39 | loss: 0.0004092
	speed: 0.0581s/iter; left time: 1667.0413s
Epoch: 39 cost time: 29.64873743057251
Epoch: 39, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0019288
	speed: 0.2907s/iter; left time: 8288.0315s
	iters: 200, epoch: 40 | loss: 0.0168815
	speed: 0.0732s/iter; left time: 2080.4356s
	iters: 300, epoch: 40 | loss: 0.0008088
	speed: 0.0805s/iter; left time: 2278.9515s
	iters: 400, epoch: 40 | loss: 0.0498907
	speed: 0.0717s/iter; left time: 2023.6960s
Epoch: 40 cost time: 34.30742025375366
Epoch: 40, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0023542
	speed: 0.3361s/iter; left time: 9424.9567s
	iters: 200, epoch: 41 | loss: 0.0019867
	speed: 0.0817s/iter; left time: 2282.5086s
	iters: 300, epoch: 41 | loss: 0.0001468
	speed: 0.0728s/iter; left time: 2025.9716s
	iters: 400, epoch: 41 | loss: 0.2666088
	speed: 0.0827s/iter; left time: 2294.5410s
Epoch: 41 cost time: 37.131139516830444
Epoch: 41, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.965 Test Loss: 0.197 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0003914
	speed: 0.3340s/iter; left time: 9210.4249s
	iters: 200, epoch: 42 | loss: 0.0017554
	speed: 0.0837s/iter; left time: 2300.5808s
	iters: 300, epoch: 42 | loss: 0.0043715
	speed: 0.0841s/iter; left time: 2300.8777s
	iters: 400, epoch: 42 | loss: 0.0000477
	speed: 0.0835s/iter; left time: 2278.1821s
Epoch: 42 cost time: 40.311306953430176
Epoch: 42, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 12474
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3769656
	speed: 0.0661s/iter; left time: 3095.7807s
	iters: 200, epoch: 1 | loss: 0.0960267
	speed: 0.0442s/iter; left time: 2065.7770s
	iters: 300, epoch: 1 | loss: 0.0592210
	speed: 0.0416s/iter; left time: 1937.0734s
	iters: 400, epoch: 1 | loss: 0.0254541
	speed: 0.0415s/iter; left time: 1931.0314s
Epoch: 1 cost time: 22.427745580673218
Epoch: 1, Steps: 469 | Train Loss: 0.442 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
Validation loss decreased (inf --> -0.942536).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0481493
	speed: 0.3114s/iter; left time: 14429.2394s
	iters: 200, epoch: 2 | loss: 0.4430032
	speed: 0.0442s/iter; left time: 2042.4139s
	iters: 300, epoch: 2 | loss: 0.0037641
	speed: 0.0431s/iter; left time: 1988.4567s
	iters: 400, epoch: 2 | loss: 0.0685224
	speed: 0.0413s/iter; left time: 1899.9383s
Epoch: 2 cost time: 20.83318042755127
Epoch: 2, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
Validation loss decreased (-0.942536 --> -0.947968).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1327605
	speed: 0.2483s/iter; left time: 11389.3312s
	iters: 200, epoch: 3 | loss: 0.0070960
	speed: 0.0443s/iter; left time: 2025.0384s
	iters: 300, epoch: 3 | loss: 0.0424195
	speed: 0.0428s/iter; left time: 1956.3797s
	iters: 400, epoch: 3 | loss: 0.2505957
	speed: 0.0453s/iter; left time: 2062.3504s
Epoch: 3 cost time: 21.2033908367157
Epoch: 3, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1099952
	speed: 0.2996s/iter; left time: 13598.2044s
	iters: 200, epoch: 4 | loss: 0.0014912
	speed: 0.0413s/iter; left time: 1871.1089s
	iters: 300, epoch: 4 | loss: 0.0228745
	speed: 0.0427s/iter; left time: 1930.4752s
	iters: 400, epoch: 4 | loss: 0.0044207
	speed: 0.0391s/iter; left time: 1761.4847s
Epoch: 4 cost time: 19.70829939842224
Epoch: 4, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0021566
	speed: 0.2863s/iter; left time: 12862.4356s
	iters: 200, epoch: 5 | loss: 0.0006998
	speed: 0.0402s/iter; left time: 1801.0936s
	iters: 300, epoch: 5 | loss: 0.0274243
	speed: 0.0434s/iter; left time: 1941.9368s
	iters: 400, epoch: 5 | loss: 0.0836645
	speed: 0.0425s/iter; left time: 1895.2471s
Epoch: 5 cost time: 20.315287828445435
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
Validation loss decreased (-0.947968 --> -0.954829).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0085217
	speed: 0.2919s/iter; left time: 12978.2998s
	iters: 200, epoch: 6 | loss: 0.0013306
	speed: 0.0362s/iter; left time: 1603.8764s
	iters: 300, epoch: 6 | loss: 0.0295497
	speed: 0.0383s/iter; left time: 1692.8722s
	iters: 400, epoch: 6 | loss: 0.0312166
	speed: 0.0387s/iter; left time: 1708.8866s
Epoch: 6 cost time: 18.325576066970825
Epoch: 6, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.261 Vali Acc: 0.956 Test Loss: 0.261 Test Acc: 0.956
Validation loss decreased (-0.954829 --> -0.955686).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002717
	speed: 0.2979s/iter; left time: 13104.5005s
	iters: 200, epoch: 7 | loss: 0.0000557
	speed: 0.0466s/iter; left time: 2044.7216s
	iters: 300, epoch: 7 | loss: 0.0024912
	speed: 0.0466s/iter; left time: 2042.5111s
	iters: 400, epoch: 7 | loss: 0.0247944
	speed: 0.0430s/iter; left time: 1876.8352s
Epoch: 7 cost time: 22.05389928817749
Epoch: 7, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0121866
	speed: 0.2914s/iter; left time: 12682.3566s
	iters: 200, epoch: 8 | loss: 0.0008792
	speed: 0.0423s/iter; left time: 1837.5185s
	iters: 300, epoch: 8 | loss: 1.2648220
	speed: 0.0434s/iter; left time: 1880.6922s
	iters: 400, epoch: 8 | loss: 0.0028999
	speed: 0.0439s/iter; left time: 1896.4915s
Epoch: 8 cost time: 20.998198747634888
Epoch: 8, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.388 Vali Acc: 0.944 Test Loss: 0.388 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0005468
	speed: 0.2903s/iter; left time: 12495.1750s
	iters: 200, epoch: 9 | loss: 0.0033214
	speed: 0.0397s/iter; left time: 1706.0086s
	iters: 300, epoch: 9 | loss: 0.0095091
	speed: 0.0395s/iter; left time: 1690.8321s
	iters: 400, epoch: 9 | loss: 0.0241097
	speed: 0.0398s/iter; left time: 1699.7336s
Epoch: 9 cost time: 19.20414137840271
Epoch: 9, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.316 Vali Acc: 0.943 Test Loss: 0.316 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1522315
	speed: 0.2861s/iter; left time: 12181.9741s
	iters: 200, epoch: 10 | loss: 0.0147638
	speed: 0.0420s/iter; left time: 1782.8634s
	iters: 300, epoch: 10 | loss: 0.0246347
	speed: 0.0430s/iter; left time: 1821.2796s
	iters: 400, epoch: 10 | loss: 0.1715886
	speed: 0.0419s/iter; left time: 1772.0729s
Epoch: 10 cost time: 20.241620540618896
Epoch: 10, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.283 Vali Acc: 0.954 Test Loss: 0.283 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2209162
	speed: 0.2921s/iter; left time: 12298.9558s
	iters: 200, epoch: 11 | loss: 0.0002815
	speed: 0.0439s/iter; left time: 1845.2626s
	iters: 300, epoch: 11 | loss: 0.0321781
	speed: 0.0457s/iter; left time: 1913.3700s
	iters: 400, epoch: 11 | loss: 0.0111724
	speed: 0.0428s/iter; left time: 1791.1598s
Epoch: 11 cost time: 21.281354427337646
Epoch: 11, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.287 Vali Acc: 0.962 Test Loss: 0.287 Test Acc: 0.962
Validation loss decreased (-0.955686 --> -0.961690).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0008277
	speed: 0.2828s/iter; left time: 11776.6117s
	iters: 200, epoch: 12 | loss: 0.0087010
	speed: 0.0433s/iter; left time: 1797.0801s
	iters: 300, epoch: 12 | loss: 0.0008037
	speed: 0.0402s/iter; left time: 1664.9798s
	iters: 400, epoch: 12 | loss: 0.0027688
	speed: 0.0420s/iter; left time: 1738.3792s
Epoch: 12 cost time: 19.99501943588257
Epoch: 12, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.475 Vali Acc: 0.936 Test Loss: 0.475 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0052918
	speed: 0.2794s/iter; left time: 11503.2727s
	iters: 200, epoch: 13 | loss: 0.0000537
	speed: 0.0392s/iter; left time: 1610.3704s
	iters: 300, epoch: 13 | loss: 0.0013608
	speed: 0.0412s/iter; left time: 1689.0816s
	iters: 400, epoch: 13 | loss: 0.0316813
	speed: 0.0405s/iter; left time: 1655.0936s
Epoch: 13 cost time: 19.19589114189148
Epoch: 13, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.297 Vali Acc: 0.947 Test Loss: 0.297 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0002741
	speed: 0.2714s/iter; left time: 11045.8552s
	iters: 200, epoch: 14 | loss: 0.0014706
	speed: 0.0401s/iter; left time: 1628.6766s
	iters: 300, epoch: 14 | loss: 0.0006866
	speed: 0.0428s/iter; left time: 1732.5210s
	iters: 400, epoch: 14 | loss: 0.0056243
	speed: 0.0424s/iter; left time: 1711.6489s
Epoch: 14 cost time: 20.370604991912842
Epoch: 14, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.264 Vali Acc: 0.955 Test Loss: 0.264 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3950358
	speed: 0.2870s/iter; left time: 11546.4252s
	iters: 200, epoch: 15 | loss: 0.0044446
	speed: 0.0388s/iter; left time: 1557.2069s
	iters: 300, epoch: 15 | loss: 0.0271070
	speed: 0.0431s/iter; left time: 1725.0153s
	iters: 400, epoch: 15 | loss: 0.0003257
	speed: 0.0394s/iter; left time: 1572.1193s
Epoch: 15 cost time: 19.47014856338501
Epoch: 15, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1697407
	speed: 0.2323s/iter; left time: 9236.5741s
	iters: 200, epoch: 16 | loss: 0.0002304
	speed: 0.0367s/iter; left time: 1453.7998s
	iters: 300, epoch: 16 | loss: 0.0053473
	speed: 0.0394s/iter; left time: 1559.1658s
	iters: 400, epoch: 16 | loss: 0.0035835
	speed: 0.0397s/iter; left time: 1568.0211s
Epoch: 16 cost time: 18.508298635482788
Epoch: 16, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0009210
	speed: 0.2566s/iter; left time: 10082.0256s
	iters: 200, epoch: 17 | loss: 0.0009590
	speed: 0.0375s/iter; left time: 1470.0831s
	iters: 300, epoch: 17 | loss: 0.0009344
	speed: 0.0398s/iter; left time: 1555.5966s
	iters: 400, epoch: 17 | loss: 0.1406460
	speed: 0.0403s/iter; left time: 1571.1981s
Epoch: 17 cost time: 18.982486724853516
Epoch: 17, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.199 Vali Acc: 0.971 Test Loss: 0.199 Test Acc: 0.971
Validation loss decreased (-0.961690 --> -0.971410).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0102922
	speed: 0.2557s/iter; left time: 9927.9687s
	iters: 200, epoch: 18 | loss: 0.0909660
	speed: 0.0355s/iter; left time: 1376.3083s
	iters: 300, epoch: 18 | loss: 0.0003821
	speed: 0.0346s/iter; left time: 1336.1450s
	iters: 400, epoch: 18 | loss: 0.0777885
	speed: 0.0362s/iter; left time: 1396.3913s
Epoch: 18 cost time: 17.310921907424927
Epoch: 18, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.245 Vali Acc: 0.951 Test Loss: 0.245 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0004355
	speed: 0.2547s/iter; left time: 9769.1928s
	iters: 200, epoch: 19 | loss: 0.0001193
	speed: 0.0390s/iter; left time: 1490.6374s
	iters: 300, epoch: 19 | loss: 0.0009174
	speed: 0.0384s/iter; left time: 1464.4588s
	iters: 400, epoch: 19 | loss: 0.1489225
	speed: 0.0392s/iter; left time: 1492.2221s
Epoch: 19 cost time: 18.617000341415405
Epoch: 19, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1623187
	speed: 0.2523s/iter; left time: 9558.7560s
	iters: 200, epoch: 20 | loss: 0.2122558
	speed: 0.0389s/iter; left time: 1471.4674s
	iters: 300, epoch: 20 | loss: 0.0001751
	speed: 0.0387s/iter; left time: 1457.2318s
	iters: 400, epoch: 20 | loss: 0.0000373
	speed: 0.0380s/iter; left time: 1428.7845s
Epoch: 20 cost time: 18.463930368423462
Epoch: 20, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.365 Vali Acc: 0.952 Test Loss: 0.365 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0131475
	speed: 0.2497s/iter; left time: 9345.1933s
	iters: 200, epoch: 21 | loss: 0.0009091
	speed: 0.0372s/iter; left time: 1390.0162s
	iters: 300, epoch: 21 | loss: 0.0007898
	speed: 0.0378s/iter; left time: 1407.5529s
	iters: 400, epoch: 21 | loss: 0.1484581
	speed: 0.0363s/iter; left time: 1345.6413s
Epoch: 21 cost time: 17.97182583808899
Epoch: 21, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.233 Vali Acc: 0.964 Test Loss: 0.233 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0529970
	speed: 0.2515s/iter; left time: 9293.4223s
	iters: 200, epoch: 22 | loss: 0.0008214
	speed: 0.0383s/iter; left time: 1410.0123s
	iters: 300, epoch: 22 | loss: 0.0050426
	speed: 0.0369s/iter; left time: 1357.8719s
	iters: 400, epoch: 22 | loss: 0.7609653
	speed: 0.0376s/iter; left time: 1379.2318s
Epoch: 22 cost time: 18.318179607391357
Epoch: 22, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.971410 --> -0.973126).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0155483
	speed: 0.2436s/iter; left time: 8888.8066s
	iters: 200, epoch: 23 | loss: 0.0011203
	speed: 0.0373s/iter; left time: 1356.9602s
	iters: 300, epoch: 23 | loss: 0.1170891
	speed: 0.0354s/iter; left time: 1284.2482s
	iters: 400, epoch: 23 | loss: 0.0000344
	speed: 0.0399s/iter; left time: 1445.0683s
Epoch: 23 cost time: 18.3034610748291
Epoch: 23, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.284 Vali Acc: 0.955 Test Loss: 0.284 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0056995
	speed: 0.2943s/iter; left time: 10597.5115s
	iters: 200, epoch: 24 | loss: 0.0000758
	speed: 0.0421s/iter; left time: 1511.1796s
	iters: 300, epoch: 24 | loss: 0.0458421
	speed: 0.0388s/iter; left time: 1389.6975s
	iters: 400, epoch: 24 | loss: 0.0022217
	speed: 0.0415s/iter; left time: 1483.3402s
Epoch: 24 cost time: 20.043015003204346
Epoch: 24, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.261 Vali Acc: 0.953 Test Loss: 0.261 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0021824
	speed: 0.2785s/iter; left time: 9899.6222s
	iters: 200, epoch: 25 | loss: 0.0031208
	speed: 0.0431s/iter; left time: 1526.1467s
	iters: 300, epoch: 25 | loss: 0.0006983
	speed: 0.0447s/iter; left time: 1581.2726s
	iters: 400, epoch: 25 | loss: 0.0001925
	speed: 0.0438s/iter; left time: 1545.0533s
Epoch: 25 cost time: 20.31972646713257
Epoch: 25, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.318 Vali Acc: 0.936 Test Loss: 0.318 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0019115
	speed: 0.2749s/iter; left time: 9642.9838s
	iters: 200, epoch: 26 | loss: 0.1068883
	speed: 0.0414s/iter; left time: 1449.3885s
	iters: 300, epoch: 26 | loss: 0.0174629
	speed: 0.0410s/iter; left time: 1430.6017s
	iters: 400, epoch: 26 | loss: 0.0146584
	speed: 0.0399s/iter; left time: 1387.3908s
Epoch: 26 cost time: 19.987400770187378
Epoch: 26, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.321 Vali Acc: 0.956 Test Loss: 0.321 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.6690779
	speed: 0.2858s/iter; left time: 9890.9906s
	iters: 200, epoch: 27 | loss: 0.0001083
	speed: 0.0393s/iter; left time: 1355.0922s
	iters: 300, epoch: 27 | loss: 0.2208075
	speed: 0.0408s/iter; left time: 1403.5241s
	iters: 400, epoch: 27 | loss: 0.0443461
	speed: 0.0413s/iter; left time: 1418.1344s
Epoch: 27 cost time: 19.71418595314026
Epoch: 27, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1147984
	speed: 0.2737s/iter; left time: 9342.9278s
	iters: 200, epoch: 28 | loss: 0.0078034
	speed: 0.0414s/iter; left time: 1407.7574s
	iters: 300, epoch: 28 | loss: 0.0007226
	speed: 0.0410s/iter; left time: 1391.7023s
	iters: 400, epoch: 28 | loss: 0.0006846
	speed: 0.0415s/iter; left time: 1405.3886s
Epoch: 28 cost time: 19.679920434951782
Epoch: 28, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.207 Vali Acc: 0.968 Test Loss: 0.207 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0248257
	speed: 0.2680s/iter; left time: 9023.1231s
	iters: 200, epoch: 29 | loss: 0.0003150
	speed: 0.0417s/iter; left time: 1401.4286s
	iters: 300, epoch: 29 | loss: 0.0007500
	speed: 0.0403s/iter; left time: 1348.1785s
	iters: 400, epoch: 29 | loss: 0.4021389
	speed: 0.0395s/iter; left time: 1317.6737s
Epoch: 29 cost time: 19.51796007156372
Epoch: 29, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0008090
	speed: 0.2495s/iter; left time: 8283.7553s
	iters: 200, epoch: 30 | loss: 0.0089546
	speed: 0.0421s/iter; left time: 1392.3130s
	iters: 300, epoch: 30 | loss: 0.0003722
	speed: 0.0383s/iter; left time: 1262.4489s
	iters: 400, epoch: 30 | loss: 0.0025863
	speed: 0.0413s/iter; left time: 1359.9585s
Epoch: 30 cost time: 19.37877321243286
Epoch: 30, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.222 Vali Acc: 0.966 Test Loss: 0.222 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.2415916
	speed: 0.2822s/iter; left time: 9236.4079s
	iters: 200, epoch: 31 | loss: 0.0005721
	speed: 0.0407s/iter; left time: 1327.4963s
	iters: 300, epoch: 31 | loss: 0.0094993
	speed: 0.0392s/iter; left time: 1276.6633s
	iters: 400, epoch: 31 | loss: 0.0006050
	speed: 0.0404s/iter; left time: 1310.7366s
Epoch: 31 cost time: 19.573183059692383
Epoch: 31, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.244 Vali Acc: 0.957 Test Loss: 0.244 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000160
	speed: 0.2612s/iter; left time: 8427.4833s
	iters: 200, epoch: 32 | loss: 0.0966431
	speed: 0.0395s/iter; left time: 1270.5419s
	iters: 300, epoch: 32 | loss: 0.0011153
	speed: 0.0412s/iter; left time: 1320.4224s
	iters: 400, epoch: 32 | loss: 0.0000153
	speed: 0.0404s/iter; left time: 1290.2873s
Epoch: 32 cost time: 19.428388357162476
Epoch: 32, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 285962
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6955689
	speed: 0.0653s/iter; left time: 3056.3547s
	iters: 200, epoch: 1 | loss: 0.1710294
	speed: 0.0526s/iter; left time: 2457.2428s
	iters: 300, epoch: 1 | loss: 0.3126366
	speed: 0.0555s/iter; left time: 2584.7409s
	iters: 400, epoch: 1 | loss: 0.0377064
	speed: 0.0590s/iter; left time: 2743.3013s
Epoch: 1 cost time: 27.478816270828247
Epoch: 1, Steps: 469 | Train Loss: 0.436 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (inf --> -0.950255).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0589967
	speed: 0.2932s/iter; left time: 13582.7795s
	iters: 200, epoch: 2 | loss: 0.1299912
	speed: 0.0563s/iter; left time: 2603.0931s
	iters: 300, epoch: 2 | loss: 0.0112485
	speed: 0.0528s/iter; left time: 2436.5834s
	iters: 400, epoch: 2 | loss: 0.0270994
	speed: 0.0586s/iter; left time: 2698.8414s
Epoch: 2 cost time: 27.13381838798523
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0111061
	speed: 0.2886s/iter; left time: 13236.7186s
	iters: 200, epoch: 3 | loss: 0.0182672
	speed: 0.0572s/iter; left time: 2618.1453s
	iters: 300, epoch: 3 | loss: 0.0539340
	speed: 0.0471s/iter; left time: 2151.9829s
	iters: 400, epoch: 3 | loss: 0.1581009
	speed: 0.0476s/iter; left time: 2169.9651s
Epoch: 3 cost time: 24.329588651657104
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
Validation loss decreased (-0.950255 --> -0.961976).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1451553
	speed: 0.2794s/iter; left time: 12683.5150s
	iters: 200, epoch: 4 | loss: 0.0043830
	speed: 0.0606s/iter; left time: 2745.4191s
	iters: 300, epoch: 4 | loss: 0.0201431
	speed: 0.0586s/iter; left time: 2648.3839s
	iters: 400, epoch: 4 | loss: 0.2415482
	speed: 0.0580s/iter; left time: 2615.0720s
Epoch: 4 cost time: 27.99258828163147
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0082061
	speed: 0.2826s/iter; left time: 12694.9345s
	iters: 200, epoch: 5 | loss: 0.0412249
	speed: 0.0463s/iter; left time: 2074.8164s
	iters: 300, epoch: 5 | loss: 0.0017316
	speed: 0.0550s/iter; left time: 2460.6184s
	iters: 400, epoch: 5 | loss: 0.0013767
	speed: 0.0562s/iter; left time: 2506.3788s
Epoch: 5 cost time: 25.75334072113037
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.322 Vali Acc: 0.942 Test Loss: 0.322 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5404012
	speed: 0.2914s/iter; left time: 12953.7702s
	iters: 200, epoch: 6 | loss: 0.0031151
	speed: 0.0627s/iter; left time: 2780.4718s
	iters: 300, epoch: 6 | loss: 0.0045457
	speed: 0.0633s/iter; left time: 2800.0048s
	iters: 400, epoch: 6 | loss: 0.0539379
	speed: 0.0602s/iter; left time: 2659.3314s
Epoch: 6 cost time: 28.895756006240845
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.416 Vali Acc: 0.927 Test Loss: 0.416 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1295917
	speed: 0.2918s/iter; left time: 12833.7507s
	iters: 200, epoch: 7 | loss: 0.0045320
	speed: 0.0561s/iter; left time: 2460.6972s
	iters: 300, epoch: 7 | loss: 0.0013395
	speed: 0.0525s/iter; left time: 2296.8671s
	iters: 400, epoch: 7 | loss: 0.0023341
	speed: 0.0580s/iter; left time: 2533.5298s
Epoch: 7 cost time: 26.478018760681152
Epoch: 7, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.220 Vali Acc: 0.954 Test Loss: 0.220 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.9028853
	speed: 0.2339s/iter; left time: 10178.5400s
	iters: 200, epoch: 8 | loss: 0.0769250
	speed: 0.0438s/iter; left time: 1900.5774s
	iters: 300, epoch: 8 | loss: 0.1187709
	speed: 0.0432s/iter; left time: 1871.8611s
	iters: 400, epoch: 8 | loss: 0.0009315
	speed: 0.0490s/iter; left time: 2119.5743s
Epoch: 8 cost time: 21.792662382125854
Epoch: 8, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.241 Vali Acc: 0.961 Test Loss: 0.241 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0248596
	speed: 0.2499s/iter; left time: 10759.3801s
	iters: 200, epoch: 9 | loss: 0.0065196
	speed: 0.0519s/iter; left time: 2227.8705s
	iters: 300, epoch: 9 | loss: 0.0061223
	speed: 0.0510s/iter; left time: 2187.1489s
	iters: 400, epoch: 9 | loss: 0.0421047
	speed: 0.0510s/iter; left time: 2181.5001s
Epoch: 9 cost time: 23.548020362854004
Epoch: 9, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2144255
	speed: 0.2615s/iter; left time: 11136.5795s
	iters: 200, epoch: 10 | loss: 0.0523050
	speed: 0.0487s/iter; left time: 2069.3759s
	iters: 300, epoch: 10 | loss: 0.0006918
	speed: 0.0486s/iter; left time: 2059.3887s
	iters: 400, epoch: 10 | loss: 0.0004893
	speed: 0.0499s/iter; left time: 2110.6184s
Epoch: 10 cost time: 23.153833627700806
Epoch: 10, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.293 Vali Acc: 0.956 Test Loss: 0.293 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4919512
	speed: 0.2612s/iter; left time: 11000.5341s
	iters: 200, epoch: 11 | loss: 0.0083527
	speed: 0.0498s/iter; left time: 2090.4032s
	iters: 300, epoch: 11 | loss: 0.0281463
	speed: 0.0471s/iter; left time: 1973.8382s
	iters: 400, epoch: 11 | loss: 0.0359522
	speed: 0.0465s/iter; left time: 1945.1300s
Epoch: 11 cost time: 23.048100233078003
Epoch: 11, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.282 Vali Acc: 0.955 Test Loss: 0.282 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3921287
	speed: 0.2490s/iter; left time: 10368.4187s
	iters: 200, epoch: 12 | loss: 0.0002629
	speed: 0.0449s/iter; left time: 1867.2919s
	iters: 300, epoch: 12 | loss: 0.2976164
	speed: 0.0442s/iter; left time: 1829.8379s
	iters: 400, epoch: 12 | loss: 0.0052216
	speed: 0.0432s/iter; left time: 1787.8061s
Epoch: 12 cost time: 21.17919945716858
Epoch: 12, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1351132
	speed: 0.2539s/iter; left time: 10455.3757s
	iters: 200, epoch: 13 | loss: 0.0015201
	speed: 0.0491s/iter; left time: 2016.9671s
	iters: 300, epoch: 13 | loss: 0.8428903
	speed: 0.0494s/iter; left time: 2024.9216s
	iters: 400, epoch: 13 | loss: 0.0151444
	speed: 0.0494s/iter; left time: 2017.0887s
Epoch: 13 cost time: 23.787984609603882
Epoch: 13, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.961978273299028
model parameter : 220170
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9253131
	speed: 0.0678s/iter; left time: 3175.2667s
	iters: 200, epoch: 1 | loss: 0.4964792
	speed: 0.0450s/iter; left time: 2102.4038s
	iters: 300, epoch: 1 | loss: 0.1131806
	speed: 0.0459s/iter; left time: 2139.9544s
	iters: 400, epoch: 1 | loss: 0.1396947
	speed: 0.0468s/iter; left time: 2175.1204s
Epoch: 1 cost time: 23.91900134086609
Epoch: 1, Steps: 469 | Train Loss: 0.465 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (inf --> -0.957974).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1043969
	speed: 0.2481s/iter; left time: 11495.4189s
	iters: 200, epoch: 2 | loss: 0.0304850
	speed: 0.0418s/iter; left time: 1931.0650s
	iters: 300, epoch: 2 | loss: 0.0818337
	speed: 0.0416s/iter; left time: 1918.5592s
	iters: 400, epoch: 2 | loss: 0.0025369
	speed: 0.0505s/iter; left time: 2323.9457s
Epoch: 2 cost time: 21.672853708267212
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0076796
	speed: 0.2659s/iter; left time: 12194.1454s
	iters: 200, epoch: 3 | loss: 0.0111302
	speed: 0.0490s/iter; left time: 2244.0074s
	iters: 300, epoch: 3 | loss: 0.0357283
	speed: 0.0487s/iter; left time: 2224.2525s
	iters: 400, epoch: 3 | loss: 0.0088504
	speed: 0.0478s/iter; left time: 2179.7490s
Epoch: 3 cost time: 23.813233852386475
Epoch: 3, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1782975
	speed: 0.2485s/iter; left time: 11280.2158s
	iters: 200, epoch: 4 | loss: 0.0120656
	speed: 0.0447s/iter; left time: 2022.5095s
	iters: 300, epoch: 4 | loss: 0.0097371
	speed: 0.0439s/iter; left time: 1986.2541s
	iters: 400, epoch: 4 | loss: 0.0185466
	speed: 0.0435s/iter; left time: 1960.4952s
Epoch: 4 cost time: 22.220323085784912
Epoch: 4, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8941538
	speed: 0.2948s/iter; left time: 13245.4492s
	iters: 200, epoch: 5 | loss: 0.0005255
	speed: 0.0574s/iter; left time: 2571.0810s
	iters: 300, epoch: 5 | loss: 0.1798044
	speed: 0.0614s/iter; left time: 2746.5947s
	iters: 400, epoch: 5 | loss: 0.0214835
	speed: 0.0541s/iter; left time: 2412.0869s
Epoch: 5 cost time: 27.671722173690796
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.202 Vali Acc: 0.961 Test Loss: 0.202 Test Acc: 0.961
Validation loss decreased (-0.957974 --> -0.960833).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0038456
	speed: 0.2929s/iter; left time: 13019.2762s
	iters: 200, epoch: 6 | loss: 0.0203378
	speed: 0.0558s/iter; left time: 2473.9828s
	iters: 300, epoch: 6 | loss: 0.0093941
	speed: 0.0611s/iter; left time: 2705.1132s
	iters: 400, epoch: 6 | loss: 0.0027088
	speed: 0.0552s/iter; left time: 2435.8895s
Epoch: 6 cost time: 27.50866413116455
Epoch: 6, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0020248
	speed: 0.3017s/iter; left time: 13269.3078s
	iters: 200, epoch: 7 | loss: 0.0000203
	speed: 0.0564s/iter; left time: 2475.1090s
	iters: 300, epoch: 7 | loss: 0.0014349
	speed: 0.0599s/iter; left time: 2621.0262s
	iters: 400, epoch: 7 | loss: 0.0622618
	speed: 0.0563s/iter; left time: 2457.4890s
Epoch: 7 cost time: 27.911818265914917
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.286 Vali Acc: 0.946 Test Loss: 0.286 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0253317
	speed: 0.2919s/iter; left time: 12703.0611s
	iters: 200, epoch: 8 | loss: 0.0018436
	speed: 0.0516s/iter; left time: 2242.3788s
	iters: 300, epoch: 8 | loss: 0.0100105
	speed: 0.0625s/iter; left time: 2706.4742s
	iters: 400, epoch: 8 | loss: 0.0101365
	speed: 0.0607s/iter; left time: 2625.1692s
Epoch: 8 cost time: 27.51204776763916
Epoch: 8, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.225 Vali Acc: 0.967 Test Loss: 0.225 Test Acc: 0.967
Validation loss decreased (-0.960833 --> -0.967122).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0018730
	speed: 0.2907s/iter; left time: 12516.1489s
	iters: 200, epoch: 9 | loss: 0.2766417
	speed: 0.0587s/iter; left time: 2520.5062s
	iters: 300, epoch: 9 | loss: 0.1662353
	speed: 0.0710s/iter; left time: 3043.9491s
	iters: 400, epoch: 9 | loss: 0.0039955
	speed: 0.0701s/iter; left time: 2995.7551s
Epoch: 9 cost time: 31.271482944488525
Epoch: 9, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1588790
	speed: 0.3350s/iter; left time: 14265.6685s
	iters: 200, epoch: 10 | loss: 0.0000143
	speed: 0.0649s/iter; left time: 2757.1759s
	iters: 300, epoch: 10 | loss: 0.2518102
	speed: 0.0708s/iter; left time: 2999.5643s
	iters: 400, epoch: 10 | loss: 0.0002594
	speed: 0.0721s/iter; left time: 3047.7448s
Epoch: 10 cost time: 32.25632405281067
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2319052
	speed: 0.3011s/iter; left time: 12679.4138s
	iters: 200, epoch: 11 | loss: 0.0325673
	speed: 0.0620s/iter; left time: 2604.6171s
	iters: 300, epoch: 11 | loss: 0.0002012
	speed: 0.0589s/iter; left time: 2470.4887s
	iters: 400, epoch: 11 | loss: 0.3233935
	speed: 0.0638s/iter; left time: 2667.2291s
Epoch: 11 cost time: 29.41142988204956
Epoch: 11, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.364 Vali Acc: 0.948 Test Loss: 0.364 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001307
	speed: 0.2809s/iter; left time: 11695.9112s
	iters: 200, epoch: 12 | loss: 0.0001517
	speed: 0.0603s/iter; left time: 2503.9005s
	iters: 300, epoch: 12 | loss: 0.0002637
	speed: 0.0559s/iter; left time: 2317.1322s
	iters: 400, epoch: 12 | loss: 0.0003371
	speed: 0.0620s/iter; left time: 2561.4386s
Epoch: 12 cost time: 28.457776308059692
Epoch: 12, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.312 Vali Acc: 0.951 Test Loss: 0.312 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.5108915
	speed: 0.2767s/iter; left time: 11392.8977s
	iters: 200, epoch: 13 | loss: 0.0001745
	speed: 0.0564s/iter; left time: 2315.9214s
	iters: 300, epoch: 13 | loss: 0.0121761
	speed: 0.0532s/iter; left time: 2181.2220s
	iters: 400, epoch: 13 | loss: 0.0568239
	speed: 0.0464s/iter; left time: 1896.3300s
Epoch: 13 cost time: 23.842544555664062
Epoch: 13, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.323 Vali Acc: 0.951 Test Loss: 0.323 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1109747
	speed: 0.2304s/iter; left time: 9377.4795s
	iters: 200, epoch: 14 | loss: 0.0000045
	speed: 0.0396s/iter; left time: 1607.3620s
	iters: 300, epoch: 14 | loss: 0.0560412
	speed: 0.0547s/iter; left time: 2217.2167s
	iters: 400, epoch: 14 | loss: 0.1630956
	speed: 0.0511s/iter; left time: 2064.9222s
Epoch: 14 cost time: 22.764892101287842
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.243 Vali Acc: 0.961 Test Loss: 0.243 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3135438
	speed: 0.2665s/iter; left time: 10724.4695s
	iters: 200, epoch: 15 | loss: 0.0011078
	speed: 0.0462s/iter; left time: 1853.0270s
	iters: 300, epoch: 15 | loss: 0.0000801
	speed: 0.0494s/iter; left time: 1978.9358s
	iters: 400, epoch: 15 | loss: 0.3693425
	speed: 0.0461s/iter; left time: 1841.7395s
Epoch: 15 cost time: 23.424265146255493
Epoch: 15, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.276 Vali Acc: 0.965 Test Loss: 0.276 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0022644
	speed: 0.2688s/iter; left time: 10687.3513s
	iters: 200, epoch: 16 | loss: 0.0000414
	speed: 0.0540s/iter; left time: 2142.5886s
	iters: 300, epoch: 16 | loss: 0.0014431
	speed: 0.0442s/iter; left time: 1749.6838s
	iters: 400, epoch: 16 | loss: 0.0000140
	speed: 0.0539s/iter; left time: 2125.4658s
Epoch: 16 cost time: 23.579360246658325
Epoch: 16, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.317 Vali Acc: 0.951 Test Loss: 0.317 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0002106
	speed: 0.2636s/iter; left time: 10357.8428s
	iters: 200, epoch: 17 | loss: 0.0411653
	speed: 0.0483s/iter; left time: 1893.2958s
	iters: 300, epoch: 17 | loss: 0.0031514
	speed: 0.0530s/iter; left time: 2070.6371s
	iters: 400, epoch: 17 | loss: 0.0000254
	speed: 0.0531s/iter; left time: 2069.2179s
Epoch: 17 cost time: 24.825230360031128
Epoch: 17, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.228 Vali Acc: 0.969 Test Loss: 0.228 Test Acc: 0.969
Validation loss decreased (-0.967122 --> -0.968837).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000183
	speed: 0.2636s/iter; left time: 10234.3777s
	iters: 200, epoch: 18 | loss: 0.0123313
	speed: 0.0470s/iter; left time: 1820.8527s
	iters: 300, epoch: 18 | loss: 0.0002129
	speed: 0.0423s/iter; left time: 1635.4782s
	iters: 400, epoch: 18 | loss: 0.0013901
	speed: 0.0425s/iter; left time: 1637.9401s
Epoch: 18 cost time: 21.780702829360962
Epoch: 18, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.316 Vali Acc: 0.958 Test Loss: 0.316 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000968
	speed: 0.2381s/iter; left time: 9132.7681s
	iters: 200, epoch: 19 | loss: 0.5599873
	speed: 0.0484s/iter; left time: 1852.1352s
	iters: 300, epoch: 19 | loss: 0.0845153
	speed: 0.0476s/iter; left time: 1815.0846s
	iters: 400, epoch: 19 | loss: 0.0889560
	speed: 0.0521s/iter; left time: 1983.5045s
Epoch: 19 cost time: 23.512808322906494
Epoch: 19, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.260 Vali Acc: 0.967 Test Loss: 0.260 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0013318
	speed: 0.2710s/iter; left time: 10269.7790s
	iters: 200, epoch: 20 | loss: 0.0012284
	speed: 0.0547s/iter; left time: 2068.9847s
	iters: 300, epoch: 20 | loss: 0.3489996
	speed: 0.0571s/iter; left time: 2152.6235s
	iters: 400, epoch: 20 | loss: 0.1040952
	speed: 0.0573s/iter; left time: 2152.3240s
Epoch: 20 cost time: 26.392850399017334
Epoch: 20, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.262 Vali Acc: 0.955 Test Loss: 0.262 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0047647
	speed: 0.2469s/iter; left time: 9237.8708s
	iters: 200, epoch: 21 | loss: 0.4223001
	speed: 0.0446s/iter; left time: 1665.7807s
	iters: 300, epoch: 21 | loss: 0.0107026
	speed: 0.0513s/iter; left time: 1907.6000s
	iters: 400, epoch: 21 | loss: 0.0391320
	speed: 0.0548s/iter; left time: 2033.9586s
Epoch: 21 cost time: 23.46980571746826
Epoch: 21, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
Validation loss decreased (-0.968837 --> -0.969695).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2587993
	speed: 0.2528s/iter; left time: 9341.1004s
	iters: 200, epoch: 22 | loss: 0.0071552
	speed: 0.0460s/iter; left time: 1694.6984s
	iters: 300, epoch: 22 | loss: 0.1305432
	speed: 0.0438s/iter; left time: 1610.1652s
	iters: 400, epoch: 22 | loss: 0.0008227
	speed: 0.0420s/iter; left time: 1541.0405s
Epoch: 22 cost time: 21.20301651954651
Epoch: 22, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.369 Vali Acc: 0.946 Test Loss: 0.369 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0010148
	speed: 0.2504s/iter; left time: 9135.9354s
	iters: 200, epoch: 23 | loss: 0.0002476
	speed: 0.0481s/iter; left time: 1751.7859s
	iters: 300, epoch: 23 | loss: 0.0049917
	speed: 0.0425s/iter; left time: 1540.4385s
	iters: 400, epoch: 23 | loss: 0.1569638
	speed: 0.0478s/iter; left time: 1729.5646s
Epoch: 23 cost time: 21.9316463470459
Epoch: 23, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1230746
	speed: 0.2409s/iter; left time: 8677.1685s
	iters: 200, epoch: 24 | loss: 0.0102667
	speed: 0.0436s/iter; left time: 1566.0844s
	iters: 300, epoch: 24 | loss: 0.0003972
	speed: 0.0472s/iter; left time: 1691.6709s
	iters: 400, epoch: 24 | loss: 0.0006034
	speed: 0.0480s/iter; left time: 1713.7509s
Epoch: 24 cost time: 21.995579719543457
Epoch: 24, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.237 Vali Acc: 0.955 Test Loss: 0.237 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0008166
	speed: 0.2155s/iter; left time: 7660.2641s
	iters: 200, epoch: 25 | loss: 0.0047982
	speed: 0.0389s/iter; left time: 1379.9860s
	iters: 300, epoch: 25 | loss: 0.0007946
	speed: 0.0455s/iter; left time: 1607.6641s
	iters: 400, epoch: 25 | loss: 0.0000868
	speed: 0.0467s/iter; left time: 1647.5320s
Epoch: 25 cost time: 20.60968589782715
Epoch: 25, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.257 Vali Acc: 0.963 Test Loss: 0.257 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.7534057
	speed: 0.2445s/iter; left time: 8574.3884s
	iters: 200, epoch: 26 | loss: 0.2976191
	speed: 0.0410s/iter; left time: 1435.0871s
	iters: 300, epoch: 26 | loss: 0.0033605
	speed: 0.0463s/iter; left time: 1613.3496s
	iters: 400, epoch: 26 | loss: 0.0000896
	speed: 0.0457s/iter; left time: 1587.8903s
Epoch: 26 cost time: 20.972965002059937
Epoch: 26, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.270 Vali Acc: 0.958 Test Loss: 0.270 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.6066177
	speed: 0.2431s/iter; left time: 8411.7796s
	iters: 200, epoch: 27 | loss: 0.4104572
	speed: 0.0428s/iter; left time: 1477.9915s
	iters: 300, epoch: 27 | loss: 0.0001267
	speed: 0.0474s/iter; left time: 1629.8624s
	iters: 400, epoch: 27 | loss: 0.0001850
	speed: 0.0483s/iter; left time: 1656.7488s
Epoch: 27 cost time: 21.96922993659973
Epoch: 27, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.209 Vali Acc: 0.966 Test Loss: 0.209 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0127050
	speed: 0.2356s/iter; left time: 8042.5597s
	iters: 200, epoch: 28 | loss: 0.0010534
	speed: 0.0368s/iter; left time: 1251.5864s
	iters: 300, epoch: 28 | loss: 0.0627489
	speed: 0.0369s/iter; left time: 1251.1928s
	iters: 400, epoch: 28 | loss: 0.0192809
	speed: 0.0407s/iter; left time: 1376.2323s
Epoch: 28 cost time: 18.42257857322693
Epoch: 28, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.257 Vali Acc: 0.956 Test Loss: 0.257 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.4253141
	speed: 0.2270s/iter; left time: 7643.3411s
	iters: 200, epoch: 29 | loss: 0.0001018
	speed: 0.0433s/iter; left time: 1452.3897s
	iters: 300, epoch: 29 | loss: 0.0498134
	speed: 0.0427s/iter; left time: 1428.4932s
	iters: 400, epoch: 29 | loss: 0.0000310
	speed: 0.0468s/iter; left time: 1561.1996s
Epoch: 29 cost time: 20.953025341033936
Epoch: 29, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0017655
	speed: 0.2448s/iter; left time: 8125.9646s
	iters: 200, epoch: 30 | loss: 0.0156964
	speed: 0.0453s/iter; left time: 1500.6131s
	iters: 300, epoch: 30 | loss: 0.0054691
	speed: 0.0497s/iter; left time: 1640.5505s
	iters: 400, epoch: 30 | loss: 0.0035244
	speed: 0.0496s/iter; left time: 1631.2649s
Epoch: 30 cost time: 22.886481046676636
Epoch: 30, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0001494
	speed: 0.2419s/iter; left time: 7917.8496s
	iters: 200, epoch: 31 | loss: 0.0161989
	speed: 0.0501s/iter; left time: 1635.9970s
	iters: 300, epoch: 31 | loss: 0.0020522
	speed: 0.0444s/iter; left time: 1445.1644s
	iters: 400, epoch: 31 | loss: 0.0003171
	speed: 0.0426s/iter; left time: 1380.8460s
Epoch: 31 cost time: 21.308340549468994
Epoch: 31, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.295 Vali Acc: 0.954 Test Loss: 0.295 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9696969696969697
model parameter : 187274
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0922807
	speed: 0.0663s/iter; left time: 3104.7720s
	iters: 200, epoch: 1 | loss: 0.3301176
	speed: 0.0435s/iter; left time: 2031.2153s
	iters: 300, epoch: 1 | loss: 0.2426066
	speed: 0.0419s/iter; left time: 1952.8316s
	iters: 400, epoch: 1 | loss: 0.1791143
	speed: 0.0398s/iter; left time: 1849.8666s
Epoch: 1 cost time: 21.99490213394165
Epoch: 1, Steps: 469 | Train Loss: 0.590 Vali Loss: 0.237 Vali Acc: 0.938 Test Loss: 0.237 Test Acc: 0.938
Validation loss decreased (inf --> -0.937676).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2553043
	speed: 0.2241s/iter; left time: 10382.9599s
	iters: 200, epoch: 2 | loss: 0.0169496
	speed: 0.0406s/iter; left time: 1877.2156s
	iters: 300, epoch: 2 | loss: 0.0511730
	speed: 0.0429s/iter; left time: 1980.5643s
	iters: 400, epoch: 2 | loss: 0.0597969
	speed: 0.0440s/iter; left time: 2025.7246s
Epoch: 2 cost time: 20.727428436279297
Epoch: 2, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
Validation loss decreased (-0.937676 --> -0.955115).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0546523
	speed: 0.2393s/iter; left time: 10972.9599s
	iters: 200, epoch: 3 | loss: 0.0080780
	speed: 0.0418s/iter; left time: 1913.4176s
	iters: 300, epoch: 3 | loss: 0.0421472
	speed: 0.0417s/iter; left time: 1904.6252s
	iters: 400, epoch: 3 | loss: 0.0050460
	speed: 0.0404s/iter; left time: 1841.7547s
Epoch: 3 cost time: 20.341826915740967
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.205 Vali Acc: 0.940 Test Loss: 0.205 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2871408
	speed: 0.2195s/iter; left time: 9966.1202s
	iters: 200, epoch: 4 | loss: 0.2082399
	speed: 0.0393s/iter; left time: 1779.2040s
	iters: 300, epoch: 4 | loss: 0.0405000
	speed: 0.0380s/iter; left time: 1719.3739s
	iters: 400, epoch: 4 | loss: 0.0937929
	speed: 0.0469s/iter; left time: 2113.6236s
Epoch: 4 cost time: 20.835779428482056
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.955115 --> -0.956545).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0027577
	speed: 0.2733s/iter; left time: 12277.2338s
	iters: 200, epoch: 5 | loss: 0.0183102
	speed: 0.0569s/iter; left time: 2548.9856s
	iters: 300, epoch: 5 | loss: 0.0055723
	speed: 0.0494s/iter; left time: 2209.6564s
	iters: 400, epoch: 5 | loss: 0.0280253
	speed: 0.0574s/iter; left time: 2560.9634s
Epoch: 5 cost time: 25.587564945220947
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.956545 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0051023
	speed: 0.2636s/iter; left time: 11717.2596s
	iters: 200, epoch: 6 | loss: 0.0085193
	speed: 0.0444s/iter; left time: 1968.6552s
	iters: 300, epoch: 6 | loss: 0.2851307
	speed: 0.0489s/iter; left time: 2165.6909s
	iters: 400, epoch: 6 | loss: 0.0624069
	speed: 0.0543s/iter; left time: 2398.1158s
Epoch: 6 cost time: 23.55225372314453
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0152829
	speed: 0.2554s/iter; left time: 11236.4104s
	iters: 200, epoch: 7 | loss: 0.0005550
	speed: 0.0440s/iter; left time: 1930.0504s
	iters: 300, epoch: 7 | loss: 0.0054240
	speed: 0.0560s/iter; left time: 2450.8229s
	iters: 400, epoch: 7 | loss: 0.0291952
	speed: 0.0523s/iter; left time: 2286.1701s
Epoch: 7 cost time: 24.458152294158936
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0013995
	speed: 0.2670s/iter; left time: 11618.3348s
	iters: 200, epoch: 8 | loss: 0.0077412
	speed: 0.0469s/iter; left time: 2036.1950s
	iters: 300, epoch: 8 | loss: 0.0372999
	speed: 0.0387s/iter; left time: 1675.9160s
	iters: 400, epoch: 8 | loss: 0.0675336
	speed: 0.0387s/iter; left time: 1673.2020s
Epoch: 8 cost time: 20.65820598602295
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0046073
	speed: 0.2425s/iter; left time: 10438.3524s
	iters: 200, epoch: 9 | loss: 0.0137453
	speed: 0.0510s/iter; left time: 2190.8508s
	iters: 300, epoch: 9 | loss: 0.0050275
	speed: 0.0565s/iter; left time: 2419.6875s
	iters: 400, epoch: 9 | loss: 0.0016766
	speed: 0.0522s/iter; left time: 2231.6282s
Epoch: 9 cost time: 25.020026445388794
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0373414
	speed: 0.2591s/iter; left time: 11031.7468s
	iters: 200, epoch: 10 | loss: 0.0450492
	speed: 0.0507s/iter; left time: 2155.7151s
	iters: 300, epoch: 10 | loss: 0.0004046
	speed: 0.0460s/iter; left time: 1948.8308s
	iters: 400, epoch: 10 | loss: 0.0004617
	speed: 0.0517s/iter; left time: 2187.3565s
Epoch: 10 cost time: 23.03866457939148
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.235 Vali Acc: 0.953 Test Loss: 0.235 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000604
	speed: 0.2533s/iter; left time: 10668.1817s
	iters: 200, epoch: 11 | loss: 0.0001824
	speed: 0.0428s/iter; left time: 1799.2446s
	iters: 300, epoch: 11 | loss: 0.0028753
	speed: 0.0391s/iter; left time: 1640.4652s
	iters: 400, epoch: 11 | loss: 0.0341852
	speed: 0.0399s/iter; left time: 1668.9489s
Epoch: 11 cost time: 19.675913095474243
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0418470
	speed: 0.2396s/iter; left time: 9978.0016s
	iters: 200, epoch: 12 | loss: 0.0006388
	speed: 0.0493s/iter; left time: 2048.5422s
	iters: 300, epoch: 12 | loss: 0.0007175
	speed: 0.0494s/iter; left time: 2045.1910s
	iters: 400, epoch: 12 | loss: 0.0036106
	speed: 0.0484s/iter; left time: 1998.9416s
Epoch: 12 cost time: 23.05884552001953
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0008241
	speed: 0.2418s/iter; left time: 9956.0833s
	iters: 200, epoch: 13 | loss: 0.0162397
	speed: 0.0509s/iter; left time: 2089.5373s
	iters: 300, epoch: 13 | loss: 0.0003379
	speed: 0.0521s/iter; left time: 2136.3043s
	iters: 400, epoch: 13 | loss: 0.1204078
	speed: 0.0553s/iter; left time: 2258.5935s
Epoch: 13 cost time: 23.94955587387085
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.975127).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0004156
	speed: 0.2728s/iter; left time: 11103.6262s
	iters: 200, epoch: 14 | loss: 0.0022162
	speed: 0.0446s/iter; left time: 1811.9422s
	iters: 300, epoch: 14 | loss: 0.0061088
	speed: 0.0424s/iter; left time: 1715.9131s
	iters: 400, epoch: 14 | loss: 0.0004179
	speed: 0.0447s/iter; left time: 1807.2752s
Epoch: 14 cost time: 21.953497409820557
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.961 Test Loss: 0.194 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0008814
	speed: 0.2539s/iter; left time: 10216.7004s
	iters: 200, epoch: 15 | loss: 0.0002933
	speed: 0.0463s/iter; left time: 1856.4794s
	iters: 300, epoch: 15 | loss: 0.0042077
	speed: 0.0431s/iter; left time: 1726.2961s
	iters: 400, epoch: 15 | loss: 0.0024748
	speed: 0.0421s/iter; left time: 1681.0643s
Epoch: 15 cost time: 21.9224591255188
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
Validation loss decreased (-0.975127 --> -0.978272).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0003477
	speed: 0.2477s/iter; left time: 9851.9186s
	iters: 200, epoch: 16 | loss: 0.3881038
	speed: 0.0444s/iter; left time: 1760.9928s
	iters: 300, epoch: 16 | loss: 0.0002813
	speed: 0.0475s/iter; left time: 1878.2228s
	iters: 400, epoch: 16 | loss: 0.0009033
	speed: 0.0467s/iter; left time: 1843.4984s
Epoch: 16 cost time: 21.806994438171387
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.968 Test Loss: 0.216 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0281930
	speed: 0.2217s/iter; left time: 8711.6231s
	iters: 200, epoch: 17 | loss: 0.1132546
	speed: 0.0406s/iter; left time: 1592.3761s
	iters: 300, epoch: 17 | loss: 0.0040569
	speed: 0.0390s/iter; left time: 1525.3961s
	iters: 400, epoch: 17 | loss: 0.0644174
	speed: 0.0438s/iter; left time: 1706.7920s
Epoch: 17 cost time: 19.6847882270813
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0542539
	speed: 0.2197s/iter; left time: 8531.9431s
	iters: 200, epoch: 18 | loss: 0.0344357
	speed: 0.0408s/iter; left time: 1578.8678s
	iters: 300, epoch: 18 | loss: 0.5302749
	speed: 0.0409s/iter; left time: 1577.9546s
	iters: 400, epoch: 18 | loss: 0.0440034
	speed: 0.0478s/iter; left time: 1840.6663s
Epoch: 18 cost time: 21.002161264419556
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0001879
	speed: 0.2535s/iter; left time: 9724.3861s
	iters: 200, epoch: 19 | loss: 0.0085116
	speed: 0.0456s/iter; left time: 1743.7975s
	iters: 300, epoch: 19 | loss: 0.0067594
	speed: 0.0418s/iter; left time: 1595.0208s
	iters: 400, epoch: 19 | loss: 0.0156126
	speed: 0.0389s/iter; left time: 1478.7392s
Epoch: 19 cost time: 20.452054500579834
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0081089
	speed: 0.2165s/iter; left time: 8204.4993s
	iters: 200, epoch: 20 | loss: 0.0071132
	speed: 0.0414s/iter; left time: 1565.3597s
	iters: 300, epoch: 20 | loss: 0.0156676
	speed: 0.0386s/iter; left time: 1454.9554s
	iters: 400, epoch: 20 | loss: 0.0131846
	speed: 0.0419s/iter; left time: 1573.3058s
Epoch: 20 cost time: 20.276195526123047
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0200238
	speed: 0.2318s/iter; left time: 8675.9982s
	iters: 200, epoch: 21 | loss: 0.0020360
	speed: 0.0394s/iter; left time: 1471.4853s
	iters: 300, epoch: 21 | loss: 0.0150560
	speed: 0.0382s/iter; left time: 1422.1133s
	iters: 400, epoch: 21 | loss: 0.0005602
	speed: 0.0425s/iter; left time: 1579.3123s
Epoch: 21 cost time: 19.29191493988037
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000963
	speed: 0.2210s/iter; left time: 8166.6823s
	iters: 200, epoch: 22 | loss: 0.0499707
	speed: 0.0387s/iter; left time: 1425.6069s
	iters: 300, epoch: 22 | loss: 0.0114448
	speed: 0.0377s/iter; left time: 1384.4295s
	iters: 400, epoch: 22 | loss: 0.9438149
	speed: 0.0399s/iter; left time: 1462.7036s
Epoch: 22 cost time: 18.62620782852173
Epoch: 22, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
Validation loss decreased (-0.978272 --> -0.978272).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.5135797
	speed: 0.2225s/iter; left time: 8118.9852s
	iters: 200, epoch: 23 | loss: 0.0000287
	speed: 0.0420s/iter; left time: 1528.7755s
	iters: 300, epoch: 23 | loss: 0.0002513
	speed: 0.0426s/iter; left time: 1545.7572s
	iters: 400, epoch: 23 | loss: 0.0016843
	speed: 0.0429s/iter; left time: 1552.9361s
Epoch: 23 cost time: 20.427205801010132
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
Validation loss decreased (-0.978272 --> -0.984847).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0007642
	speed: 0.2352s/iter; left time: 8469.9329s
	iters: 200, epoch: 24 | loss: 0.0000127
	speed: 0.0415s/iter; left time: 1492.0668s
	iters: 300, epoch: 24 | loss: 0.0088985
	speed: 0.0410s/iter; left time: 1468.5375s
	iters: 400, epoch: 24 | loss: 0.0025496
	speed: 0.0402s/iter; left time: 1436.3003s
Epoch: 24 cost time: 19.976847887039185
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000229
	speed: 0.2265s/iter; left time: 8049.2694s
	iters: 200, epoch: 25 | loss: 0.0000077
	speed: 0.0385s/iter; left time: 1363.1029s
	iters: 300, epoch: 25 | loss: 0.0000098
	speed: 0.0409s/iter; left time: 1444.1131s
	iters: 400, epoch: 25 | loss: 0.0889739
	speed: 0.0364s/iter; left time: 1282.7363s
Epoch: 25 cost time: 18.97173237800598
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0388226
	speed: 0.2553s/iter; left time: 8954.5004s
	iters: 200, epoch: 26 | loss: 0.0187346
	speed: 0.0543s/iter; left time: 1900.0240s
	iters: 300, epoch: 26 | loss: 0.0012068
	speed: 0.0495s/iter; left time: 1726.9259s
	iters: 400, epoch: 26 | loss: 0.0024632
	speed: 0.0522s/iter; left time: 1816.1236s
Epoch: 26 cost time: 24.78183364868164
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.194 Vali Acc: 0.968 Test Loss: 0.194 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0016979
	speed: 0.2766s/iter; left time: 9570.9309s
	iters: 200, epoch: 27 | loss: 0.0052569
	speed: 0.0514s/iter; left time: 1774.6050s
	iters: 300, epoch: 27 | loss: 0.0017068
	speed: 0.0480s/iter; left time: 1650.6274s
	iters: 400, epoch: 27 | loss: 0.0004457
	speed: 0.0544s/iter; left time: 1867.8022s
Epoch: 27 cost time: 24.560229301452637
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.968 Test Loss: 0.202 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3173622
	speed: 0.2801s/iter; left time: 9562.5331s
	iters: 200, epoch: 28 | loss: 0.0000611
	speed: 0.0490s/iter; left time: 1667.1682s
	iters: 300, epoch: 28 | loss: 0.0005244
	speed: 0.0496s/iter; left time: 1681.9046s
	iters: 400, epoch: 28 | loss: 0.0001746
	speed: 0.0475s/iter; left time: 1606.0039s
Epoch: 28 cost time: 24.009501457214355
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0419014
	speed: 0.2809s/iter; left time: 9456.9809s
	iters: 200, epoch: 29 | loss: 0.0002940
	speed: 0.0446s/iter; left time: 1498.0491s
	iters: 300, epoch: 29 | loss: 0.0001430
	speed: 0.0379s/iter; left time: 1269.7182s
	iters: 400, epoch: 29 | loss: 0.0327143
	speed: 0.0399s/iter; left time: 1332.1659s
Epoch: 29 cost time: 20.5001163482666
Epoch: 29, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0272593
	speed: 0.2285s/iter; left time: 7587.8346s
	iters: 200, epoch: 30 | loss: 0.0012736
	speed: 0.0478s/iter; left time: 1581.7954s
	iters: 300, epoch: 30 | loss: 0.0462099
	speed: 0.0501s/iter; left time: 1651.9697s
	iters: 400, epoch: 30 | loss: 0.0010993
	speed: 0.0429s/iter; left time: 1412.1655s
Epoch: 30 cost time: 22.554177284240723
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000560
	speed: 0.2313s/iter; left time: 7571.1123s
	iters: 200, epoch: 31 | loss: 0.0075221
	speed: 0.0430s/iter; left time: 1403.2597s
	iters: 300, epoch: 31 | loss: 0.0000149
	speed: 0.0479s/iter; left time: 1557.2825s
	iters: 400, epoch: 31 | loss: 0.0558399
	speed: 0.0427s/iter; left time: 1384.5744s
Epoch: 31 cost time: 21.288674354553223
Epoch: 31, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0001292
	speed: 0.2445s/iter; left time: 7887.2771s
	iters: 200, epoch: 32 | loss: 0.0280532
	speed: 0.0371s/iter; left time: 1192.1122s
	iters: 300, epoch: 32 | loss: 0.0023622
	speed: 0.0430s/iter; left time: 1378.5103s
	iters: 400, epoch: 32 | loss: 0.0000316
	speed: 0.0387s/iter; left time: 1237.9048s
Epoch: 32 cost time: 19.690171480178833
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1654390
	speed: 0.2371s/iter; left time: 7536.6306s
	iters: 200, epoch: 33 | loss: 0.0368680
	speed: 0.0398s/iter; left time: 1260.0444s
	iters: 300, epoch: 33 | loss: 0.0000179
	speed: 0.0457s/iter; left time: 1442.4415s
	iters: 400, epoch: 33 | loss: 0.0060341
	speed: 0.0439s/iter; left time: 1383.5679s
Epoch: 33 cost time: 21.237635135650635
Epoch: 33, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.971 Test Loss: 0.187 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 110474
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8816277
	speed: 0.0572s/iter; left time: 2678.3160s
	iters: 200, epoch: 1 | loss: 0.3532485
	speed: 0.0361s/iter; left time: 1684.4478s
	iters: 300, epoch: 1 | loss: 0.4275315
	speed: 0.0365s/iter; left time: 1700.5291s
	iters: 400, epoch: 1 | loss: 0.0254070
	speed: 0.0460s/iter; left time: 2137.8832s
Epoch: 1 cost time: 20.796037197113037
Epoch: 1, Steps: 469 | Train Loss: 0.614 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (inf --> -0.937104).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1872891
	speed: 0.2499s/iter; left time: 11576.5056s
	iters: 200, epoch: 2 | loss: 0.0751666
	speed: 0.0446s/iter; left time: 2062.3349s
	iters: 300, epoch: 2 | loss: 0.0543339
	speed: 0.0453s/iter; left time: 2088.1143s
	iters: 400, epoch: 2 | loss: 0.0083020
	speed: 0.0458s/iter; left time: 2107.3303s
Epoch: 2 cost time: 21.45876955986023
Epoch: 2, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.937104 --> -0.958546).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0480838
	speed: 0.2424s/iter; left time: 11117.0604s
	iters: 200, epoch: 3 | loss: 0.0848977
	speed: 0.0421s/iter; left time: 1924.5891s
	iters: 300, epoch: 3 | loss: 0.0069074
	speed: 0.0426s/iter; left time: 1944.1223s
	iters: 400, epoch: 3 | loss: 0.0068004
	speed: 0.0433s/iter; left time: 1971.6446s
Epoch: 3 cost time: 20.234771490097046
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
Validation loss decreased (-0.958546 --> -0.968552).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0170185
	speed: 0.2546s/iter; left time: 11558.1378s
	iters: 200, epoch: 4 | loss: 0.0014252
	speed: 0.0392s/iter; left time: 1774.4473s
	iters: 300, epoch: 4 | loss: 0.0388950
	speed: 0.0386s/iter; left time: 1743.3385s
	iters: 400, epoch: 4 | loss: 0.0053155
	speed: 0.0367s/iter; left time: 1654.8400s
Epoch: 4 cost time: 18.830791473388672
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0005346
	speed: 0.2326s/iter; left time: 10451.6229s
	iters: 200, epoch: 5 | loss: 0.0441876
	speed: 0.0413s/iter; left time: 1850.7218s
	iters: 300, epoch: 5 | loss: 0.0405281
	speed: 0.0386s/iter; left time: 1725.1779s
	iters: 400, epoch: 5 | loss: 0.0659412
	speed: 0.0377s/iter; left time: 1681.6089s
Epoch: 5 cost time: 19.17014789581299
Epoch: 5, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4339046
	speed: 0.2571s/iter; left time: 11431.1846s
	iters: 200, epoch: 6 | loss: 0.2180509
	speed: 0.0438s/iter; left time: 1942.0244s
	iters: 300, epoch: 6 | loss: 0.0296573
	speed: 0.0424s/iter; left time: 1878.4977s
	iters: 400, epoch: 6 | loss: 0.0001677
	speed: 0.0437s/iter; left time: 1930.8253s
Epoch: 6 cost time: 20.967121839523315
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0114927
	speed: 0.2665s/iter; left time: 11720.5636s
	iters: 200, epoch: 7 | loss: 0.0006809
	speed: 0.0435s/iter; left time: 1909.3771s
	iters: 300, epoch: 7 | loss: 0.0003786
	speed: 0.0392s/iter; left time: 1717.3655s
	iters: 400, epoch: 7 | loss: 0.0026629
	speed: 0.0368s/iter; left time: 1605.9774s
Epoch: 7 cost time: 19.673691749572754
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0791348
	speed: 0.2370s/iter; left time: 10314.2633s
	iters: 200, epoch: 8 | loss: 0.0015456
	speed: 0.0393s/iter; left time: 1707.4075s
	iters: 300, epoch: 8 | loss: 0.0430974
	speed: 0.0380s/iter; left time: 1646.1283s
	iters: 400, epoch: 8 | loss: 0.0113274
	speed: 0.0433s/iter; left time: 1869.8819s
Epoch: 8 cost time: 19.39665126800537
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0007930
	speed: 0.2547s/iter; left time: 10964.5613s
	iters: 200, epoch: 9 | loss: 0.0122821
	speed: 0.0434s/iter; left time: 1864.4096s
	iters: 300, epoch: 9 | loss: 0.0302328
	speed: 0.0388s/iter; left time: 1663.7089s
	iters: 400, epoch: 9 | loss: 0.0014612
	speed: 0.0452s/iter; left time: 1933.4874s
Epoch: 9 cost time: 20.744616270065308
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
Validation loss decreased (-0.968552 --> -0.969409).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0086878
	speed: 0.2539s/iter; left time: 10811.6662s
	iters: 200, epoch: 10 | loss: 0.0015721
	speed: 0.0389s/iter; left time: 1652.9878s
	iters: 300, epoch: 10 | loss: 0.0005452
	speed: 0.0405s/iter; left time: 1714.5542s
	iters: 400, epoch: 10 | loss: 0.0247786
	speed: 0.0412s/iter; left time: 1741.2180s
Epoch: 10 cost time: 19.348559379577637
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0971797
	speed: 0.2364s/iter; left time: 9955.4950s
	iters: 200, epoch: 11 | loss: 0.0151251
	speed: 0.0370s/iter; left time: 1552.7491s
	iters: 300, epoch: 11 | loss: 0.3314146
	speed: 0.0372s/iter; left time: 1561.1189s
	iters: 400, epoch: 11 | loss: 0.1168665
	speed: 0.0379s/iter; left time: 1585.5409s
Epoch: 11 cost time: 18.421384572982788
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0085007
	speed: 0.2538s/iter; left time: 10568.4605s
	iters: 200, epoch: 12 | loss: 0.0342607
	speed: 0.0396s/iter; left time: 1645.1949s
	iters: 300, epoch: 12 | loss: 0.0121252
	speed: 0.0406s/iter; left time: 1681.8307s
	iters: 400, epoch: 12 | loss: 0.0006654
	speed: 0.0426s/iter; left time: 1762.2160s
Epoch: 12 cost time: 20.02743887901306
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
Validation loss decreased (-0.969409 --> -0.969981).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1255379
	speed: 0.2587s/iter; left time: 10650.0496s
	iters: 200, epoch: 13 | loss: 0.0112475
	speed: 0.0420s/iter; left time: 1724.7900s
	iters: 300, epoch: 13 | loss: 0.0003932
	speed: 0.0427s/iter; left time: 1749.3763s
	iters: 400, epoch: 13 | loss: 0.0001960
	speed: 0.0420s/iter; left time: 1718.2994s
Epoch: 13 cost time: 20.016765356063843
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0095020
	speed: 0.2462s/iter; left time: 10019.7018s
	iters: 200, epoch: 14 | loss: 0.0091412
	speed: 0.0374s/iter; left time: 1517.1447s
	iters: 300, epoch: 14 | loss: 0.0001195
	speed: 0.0370s/iter; left time: 1497.7444s
	iters: 400, epoch: 14 | loss: 0.4024413
	speed: 0.0393s/iter; left time: 1586.8700s
Epoch: 14 cost time: 18.22977352142334
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0006744
	speed: 0.2472s/iter; left time: 9946.2794s
	iters: 200, epoch: 15 | loss: 0.0021564
	speed: 0.0430s/iter; left time: 1725.6467s
	iters: 300, epoch: 15 | loss: 0.0000413
	speed: 0.0417s/iter; left time: 1668.5269s
	iters: 400, epoch: 15 | loss: 0.0002117
	speed: 0.0442s/iter; left time: 1766.8305s
Epoch: 15 cost time: 20.098933696746826
Epoch: 15, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.949 Test Loss: 0.235 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0008478
	speed: 0.2337s/iter; left time: 9293.8043s
	iters: 200, epoch: 16 | loss: 0.0309195
	speed: 0.0378s/iter; left time: 1499.1483s
	iters: 300, epoch: 16 | loss: 0.0249506
	speed: 0.0420s/iter; left time: 1663.6190s
	iters: 400, epoch: 16 | loss: 0.0003917
	speed: 0.0385s/iter; left time: 1521.2775s
Epoch: 16 cost time: 18.657001733779907
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.969981 --> -0.971982).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0121740
	speed: 0.2610s/iter; left time: 10257.3480s
	iters: 200, epoch: 17 | loss: 0.2458421
	speed: 0.0398s/iter; left time: 1560.8893s
	iters: 300, epoch: 17 | loss: 0.0003177
	speed: 0.0389s/iter; left time: 1520.4346s
	iters: 400, epoch: 17 | loss: 0.0352089
	speed: 0.0377s/iter; left time: 1469.0075s
Epoch: 17 cost time: 18.835012912750244
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.181 Vali Acc: 0.971 Test Loss: 0.181 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0015885
	speed: 0.2393s/iter; left time: 9289.7297s
	iters: 200, epoch: 18 | loss: 0.0011231
	speed: 0.0369s/iter; left time: 1427.7483s
	iters: 300, epoch: 18 | loss: 0.0000301
	speed: 0.0402s/iter; left time: 1552.9603s
	iters: 400, epoch: 18 | loss: 0.0063673
	speed: 0.0428s/iter; left time: 1648.4272s
Epoch: 18 cost time: 18.64716339111328
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0104586
	speed: 0.2533s/iter; left time: 9716.1922s
	iters: 200, epoch: 19 | loss: 0.0009342
	speed: 0.0380s/iter; left time: 1453.7741s
	iters: 300, epoch: 19 | loss: 0.0001718
	speed: 0.0405s/iter; left time: 1544.0936s
	iters: 400, epoch: 19 | loss: 0.2434740
	speed: 0.0374s/iter; left time: 1422.7161s
Epoch: 19 cost time: 19.353177547454834
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0021983
	speed: 0.2675s/iter; left time: 10136.6594s
	iters: 200, epoch: 20 | loss: 0.0008776
	speed: 0.0438s/iter; left time: 1654.3102s
	iters: 300, epoch: 20 | loss: 0.0190328
	speed: 0.0388s/iter; left time: 1464.1954s
	iters: 400, epoch: 20 | loss: 0.0072823
	speed: 0.0386s/iter; left time: 1449.4516s
Epoch: 20 cost time: 19.947747707366943
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.192 Vali Acc: 0.971 Test Loss: 0.192 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0022782
	speed: 0.2827s/iter; left time: 10578.9990s
	iters: 200, epoch: 21 | loss: 0.4477118
	speed: 0.0469s/iter; left time: 1749.2472s
	iters: 300, epoch: 21 | loss: 0.0000559
	speed: 0.0518s/iter; left time: 1927.9994s
	iters: 400, epoch: 21 | loss: 0.0035276
	speed: 0.0502s/iter; left time: 1861.8698s
Epoch: 21 cost time: 22.61170268058777
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0004014
	speed: 0.2850s/iter; left time: 10533.1481s
	iters: 200, epoch: 22 | loss: 0.0000225
	speed: 0.0393s/iter; left time: 1446.9812s
	iters: 300, epoch: 22 | loss: 0.0000135
	speed: 0.0454s/iter; left time: 1667.6780s
	iters: 400, epoch: 22 | loss: 0.1397684
	speed: 0.0428s/iter; left time: 1569.0806s
Epoch: 22 cost time: 21.170875787734985
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.7082322
	speed: 0.3092s/iter; left time: 11280.3068s
	iters: 200, epoch: 23 | loss: 0.0001540
	speed: 0.0472s/iter; left time: 1717.0901s
	iters: 300, epoch: 23 | loss: 0.0000517
	speed: 0.0472s/iter; left time: 1713.4701s
	iters: 400, epoch: 23 | loss: 0.0004620
	speed: 0.0417s/iter; left time: 1510.3133s
Epoch: 23 cost time: 22.777528524398804
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.283 Vali Acc: 0.967 Test Loss: 0.283 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000083
	speed: 0.2745s/iter; left time: 9884.6116s
	iters: 200, epoch: 24 | loss: 0.4001440
	speed: 0.0378s/iter; left time: 1356.7389s
	iters: 300, epoch: 24 | loss: 0.0001898
	speed: 0.0389s/iter; left time: 1394.4604s
	iters: 400, epoch: 24 | loss: 0.0007877
	speed: 0.0381s/iter; left time: 1360.1448s
Epoch: 24 cost time: 19.109227657318115
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.971982 --> -0.976557).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0085295
	speed: 0.2678s/iter; left time: 9518.2464s
	iters: 200, epoch: 25 | loss: 0.0000155
	speed: 0.0348s/iter; left time: 1232.9924s
	iters: 300, epoch: 25 | loss: 0.0027710
	speed: 0.0384s/iter; left time: 1357.9107s
	iters: 400, epoch: 25 | loss: 0.3693488
	speed: 0.0408s/iter; left time: 1438.0165s
Epoch: 25 cost time: 19.077824115753174
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.273 Vali Acc: 0.962 Test Loss: 0.273 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000370
	speed: 0.2614s/iter; left time: 9169.3012s
	iters: 200, epoch: 26 | loss: 0.0197847
	speed: 0.0462s/iter; left time: 1614.4035s
	iters: 300, epoch: 26 | loss: 0.3114756
	speed: 0.0470s/iter; left time: 1638.1471s
	iters: 400, epoch: 26 | loss: 0.0000255
	speed: 0.0426s/iter; left time: 1480.3251s
Epoch: 26 cost time: 22.049474239349365
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0002067
	speed: 0.3013s/iter; left time: 10427.4135s
	iters: 200, epoch: 27 | loss: 0.0001035
	speed: 0.0405s/iter; left time: 1397.8434s
	iters: 300, epoch: 27 | loss: 0.1282008
	speed: 0.0489s/iter; left time: 1682.7379s
	iters: 400, epoch: 27 | loss: 0.0015294
	speed: 0.0466s/iter; left time: 1599.1216s
Epoch: 27 cost time: 22.196666955947876
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.238 Vali Acc: 0.966 Test Loss: 0.238 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0014444
	speed: 0.2988s/iter; left time: 10200.2662s
	iters: 200, epoch: 28 | loss: 0.0002168
	speed: 0.0470s/iter; left time: 1598.4580s
	iters: 300, epoch: 28 | loss: 0.0023800
	speed: 0.0470s/iter; left time: 1595.0408s
	iters: 400, epoch: 28 | loss: 0.3000828
	speed: 0.0421s/iter; left time: 1423.1044s
Epoch: 28 cost time: 22.422311544418335
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.244 Vali Acc: 0.969 Test Loss: 0.244 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000219
	speed: 0.3081s/iter; left time: 10373.3299s
	iters: 200, epoch: 29 | loss: 0.0021452
	speed: 0.0425s/iter; left time: 1427.2191s
	iters: 300, epoch: 29 | loss: 0.0030551
	speed: 0.0423s/iter; left time: 1417.3683s
	iters: 400, epoch: 29 | loss: 0.0680914
	speed: 0.0406s/iter; left time: 1353.5848s
Epoch: 29 cost time: 20.628462076187134
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.965 Test Loss: 0.244 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0008622
	speed: 0.2919s/iter; left time: 9690.2051s
	iters: 200, epoch: 30 | loss: 0.0010316
	speed: 0.0383s/iter; left time: 1268.9533s
	iters: 300, epoch: 30 | loss: 0.0004160
	speed: 0.0396s/iter; left time: 1306.1929s
	iters: 400, epoch: 30 | loss: 0.0022488
	speed: 0.0486s/iter; left time: 1599.1911s
Epoch: 30 cost time: 20.28872776031494
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0008188
	speed: 0.2882s/iter; left time: 9433.2190s
	iters: 200, epoch: 31 | loss: 0.0124491
	speed: 0.0434s/iter; left time: 1417.4102s
	iters: 300, epoch: 31 | loss: 0.0179255
	speed: 0.0460s/iter; left time: 1495.6017s
	iters: 400, epoch: 31 | loss: 0.0003183
	speed: 0.0451s/iter; left time: 1462.9370s
Epoch: 31 cost time: 21.543460369110107
Epoch: 31, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.973 Test Loss: 0.194 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0025457
	speed: 0.2984s/iter; left time: 9628.4824s
	iters: 200, epoch: 32 | loss: 0.0001089
	speed: 0.0482s/iter; left time: 1550.6219s
	iters: 300, epoch: 32 | loss: 0.0000425
	speed: 0.0471s/iter; left time: 1508.9235s
	iters: 400, epoch: 32 | loss: 0.1918829
	speed: 0.0410s/iter; left time: 1311.0652s
Epoch: 32 cost time: 22.02506399154663
Epoch: 32, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0085091
	speed: 0.2765s/iter; left time: 8789.8746s
	iters: 200, epoch: 33 | loss: 0.0115972
	speed: 0.0417s/iter; left time: 1322.5288s
	iters: 300, epoch: 33 | loss: 0.0018555
	speed: 0.0405s/iter; left time: 1278.3389s
	iters: 400, epoch: 33 | loss: 0.0031120
	speed: 0.0440s/iter; left time: 1385.6825s
Epoch: 33 cost time: 21.45697522163391
Epoch: 33, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.246 Vali Acc: 0.969 Test Loss: 0.246 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0019059
	speed: 0.3301s/iter; left time: 10339.1799s
	iters: 200, epoch: 34 | loss: 0.0261686
	speed: 0.0482s/iter; left time: 1506.0481s
	iters: 300, epoch: 34 | loss: 0.0207904
	speed: 0.0476s/iter; left time: 1482.5165s
	iters: 400, epoch: 34 | loss: 0.0072063
	speed: 0.0515s/iter; left time: 1598.1042s
Epoch: 34 cost time: 24.56765365600586
Epoch: 34, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 77450
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8745648
	speed: 0.0735s/iter; left time: 3438.9012s
	iters: 200, epoch: 1 | loss: 0.3654525
	speed: 0.0480s/iter; left time: 2239.5549s
	iters: 300, epoch: 1 | loss: 0.3794599
	speed: 0.0508s/iter; left time: 2365.9396s
	iters: 400, epoch: 1 | loss: 0.3255955
	speed: 0.0507s/iter; left time: 2359.8109s
Epoch: 1 cost time: 25.784746646881104
Epoch: 1, Steps: 469 | Train Loss: 0.634 Vali Loss: 0.339 Vali Acc: 0.895 Test Loss: 0.339 Test Acc: 0.895
Validation loss decreased (inf --> -0.895365).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1548697
	speed: 0.2973s/iter; left time: 13775.9293s
	iters: 200, epoch: 2 | loss: 0.0418038
	speed: 0.0497s/iter; left time: 2298.7205s
	iters: 300, epoch: 2 | loss: 0.0106262
	speed: 0.0503s/iter; left time: 2321.8143s
	iters: 400, epoch: 2 | loss: 0.0357152
	speed: 0.0481s/iter; left time: 2215.0457s
Epoch: 2 cost time: 23.785146474838257
Epoch: 2, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.208 Vali Acc: 0.945 Test Loss: 0.208 Test Acc: 0.945
Validation loss decreased (-0.895365 --> -0.945395).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0032229
	speed: 0.3022s/iter; left time: 13858.1557s
	iters: 200, epoch: 3 | loss: 0.0578695
	speed: 0.0505s/iter; left time: 2311.4227s
	iters: 300, epoch: 3 | loss: 0.0532171
	speed: 0.0480s/iter; left time: 2193.3240s
	iters: 400, epoch: 3 | loss: 0.3542396
	speed: 0.0475s/iter; left time: 2163.8762s
Epoch: 3 cost time: 23.62556743621826
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.945395 --> -0.966551).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0070127
	speed: 0.2890s/iter; left time: 13117.5059s
	iters: 200, epoch: 4 | loss: 0.0016037
	speed: 0.0438s/iter; left time: 1982.7205s
	iters: 300, epoch: 4 | loss: 0.0191347
	speed: 0.0456s/iter; left time: 2060.3480s
	iters: 400, epoch: 4 | loss: 0.0010522
	speed: 0.0440s/iter; left time: 1985.6863s
Epoch: 4 cost time: 21.321897506713867
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0026223
	speed: 0.3172s/iter; left time: 14248.5984s
	iters: 200, epoch: 5 | loss: 0.0144701
	speed: 0.0506s/iter; left time: 2267.4923s
	iters: 300, epoch: 5 | loss: 0.0105559
	speed: 0.0477s/iter; left time: 2133.3199s
	iters: 400, epoch: 5 | loss: 0.0083427
	speed: 0.0487s/iter; left time: 2171.1717s
Epoch: 5 cost time: 24.037294149398804
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0063993
	speed: 0.3088s/iter; left time: 13726.5729s
	iters: 200, epoch: 6 | loss: 0.2061709
	speed: 0.0468s/iter; left time: 2076.7313s
	iters: 300, epoch: 6 | loss: 0.0188962
	speed: 0.0494s/iter; left time: 2186.9911s
	iters: 400, epoch: 6 | loss: 0.0254380
	speed: 0.0473s/iter; left time: 2090.2396s
Epoch: 6 cost time: 22.776610136032104
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.966551 --> -0.969981).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0319669
	speed: 0.2816s/iter; left time: 12387.3481s
	iters: 200, epoch: 7 | loss: 0.0006261
	speed: 0.0433s/iter; left time: 1898.5600s
	iters: 300, epoch: 7 | loss: 0.0011048
	speed: 0.0450s/iter; left time: 1970.3429s
	iters: 400, epoch: 7 | loss: 0.0423764
	speed: 0.0443s/iter; left time: 1936.3430s
Epoch: 7 cost time: 21.371806621551514
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
Validation loss decreased (-0.969981 --> -0.971125).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0039176
	speed: 0.2719s/iter; left time: 11834.3555s
	iters: 200, epoch: 8 | loss: 0.1505086
	speed: 0.0424s/iter; left time: 1842.0420s
	iters: 300, epoch: 8 | loss: 0.0017322
	speed: 0.0448s/iter; left time: 1940.0259s
	iters: 400, epoch: 8 | loss: 0.0061479
	speed: 0.0417s/iter; left time: 1802.2964s
Epoch: 8 cost time: 21.1966609954834
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0014055
	speed: 0.2874s/iter; left time: 12373.4375s
	iters: 200, epoch: 9 | loss: 0.0672190
	speed: 0.0437s/iter; left time: 1877.9335s
	iters: 300, epoch: 9 | loss: 0.0074937
	speed: 0.0482s/iter; left time: 2066.8193s
	iters: 400, epoch: 9 | loss: 0.0658107
	speed: 0.0429s/iter; left time: 1833.1541s
Epoch: 9 cost time: 21.74428629875183
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0009069
	speed: 0.2836s/iter; left time: 12075.3885s
	iters: 200, epoch: 10 | loss: 0.0113430
	speed: 0.0472s/iter; left time: 2004.7255s
	iters: 300, epoch: 10 | loss: 0.0069925
	speed: 0.0459s/iter; left time: 1944.6689s
	iters: 400, epoch: 10 | loss: 0.1736870
	speed: 0.0496s/iter; left time: 2095.1595s
Epoch: 10 cost time: 23.079174518585205
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0196990
	speed: 0.3012s/iter; left time: 12685.7697s
	iters: 200, epoch: 11 | loss: 0.0061576
	speed: 0.0525s/iter; left time: 2207.1153s
	iters: 300, epoch: 11 | loss: 0.0008320
	speed: 0.0481s/iter; left time: 2017.5968s
	iters: 400, epoch: 11 | loss: 0.0080644
	speed: 0.0433s/iter; left time: 1810.4963s
Epoch: 11 cost time: 22.92122530937195
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.960 Test Loss: 0.233 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0041264
	speed: 0.3006s/iter; left time: 12518.9717s
	iters: 200, epoch: 12 | loss: 0.0007549
	speed: 0.0428s/iter; left time: 1779.5703s
	iters: 300, epoch: 12 | loss: 0.0168461
	speed: 0.0460s/iter; left time: 1904.7828s
	iters: 400, epoch: 12 | loss: 0.0001939
	speed: 0.0450s/iter; left time: 1859.8696s
Epoch: 12 cost time: 21.956137657165527
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
Validation loss decreased (-0.971125 --> -0.973984).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0294172
	speed: 0.3034s/iter; left time: 12493.6152s
	iters: 200, epoch: 13 | loss: 0.0006304
	speed: 0.0481s/iter; left time: 1977.2638s
	iters: 300, epoch: 13 | loss: 0.0231213
	speed: 0.0432s/iter; left time: 1771.6702s
	iters: 400, epoch: 13 | loss: 0.0356644
	speed: 0.0521s/iter; left time: 2129.2829s
Epoch: 13 cost time: 22.608334064483643
Epoch: 13, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2149013
	speed: 0.3052s/iter; left time: 12421.6958s
	iters: 200, epoch: 14 | loss: 0.0003014
	speed: 0.0488s/iter; left time: 1980.4060s
	iters: 300, epoch: 14 | loss: 0.0000675
	speed: 0.0493s/iter; left time: 1998.8511s
	iters: 400, epoch: 14 | loss: 0.0055270
	speed: 0.0423s/iter; left time: 1707.3146s
Epoch: 14 cost time: 23.685574531555176
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.182 Vali Acc: 0.966 Test Loss: 0.182 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0021602
	speed: 0.3238s/iter; left time: 13028.6948s
	iters: 200, epoch: 15 | loss: 0.0006882
	speed: 0.0583s/iter; left time: 2340.2249s
	iters: 300, epoch: 15 | loss: 0.2143597
	speed: 0.0548s/iter; left time: 2194.5861s
	iters: 400, epoch: 15 | loss: 0.0117992
	speed: 0.0505s/iter; left time: 2017.5557s
Epoch: 15 cost time: 26.428736209869385
Epoch: 15, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2811961
	speed: 0.3318s/iter; left time: 13195.9896s
	iters: 200, epoch: 16 | loss: 0.2253652
	speed: 0.0573s/iter; left time: 2271.9870s
	iters: 300, epoch: 16 | loss: 0.0012216
	speed: 0.0565s/iter; left time: 2234.5281s
	iters: 400, epoch: 16 | loss: 0.0000111
	speed: 0.0532s/iter; left time: 2097.7245s
Epoch: 16 cost time: 26.5352942943573
Epoch: 16, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0001049
	speed: 0.3460s/iter; left time: 13596.2945s
	iters: 200, epoch: 17 | loss: 0.0001875
	speed: 0.0584s/iter; left time: 2288.3107s
	iters: 300, epoch: 17 | loss: 0.0006605
	speed: 0.0565s/iter; left time: 2207.0544s
	iters: 400, epoch: 17 | loss: 0.0394960
	speed: 0.0490s/iter; left time: 1910.3287s
Epoch: 17 cost time: 26.20240879058838
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0718989
	speed: 0.3289s/iter; left time: 12770.5633s
	iters: 200, epoch: 18 | loss: 0.0003888
	speed: 0.0490s/iter; left time: 1896.7618s
	iters: 300, epoch: 18 | loss: 0.0029610
	speed: 0.0490s/iter; left time: 1893.9312s
	iters: 400, epoch: 18 | loss: 0.0656713
	speed: 0.0482s/iter; left time: 1856.8835s
Epoch: 18 cost time: 23.034897089004517
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0051425
	speed: 0.2936s/iter; left time: 11263.6355s
	iters: 200, epoch: 19 | loss: 0.0011815
	speed: 0.0484s/iter; left time: 1853.5062s
	iters: 300, epoch: 19 | loss: 0.0025894
	speed: 0.0497s/iter; left time: 1896.1721s
	iters: 400, epoch: 19 | loss: 0.0004205
	speed: 0.0528s/iter; left time: 2010.1590s
Epoch: 19 cost time: 24.52558422088623
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0012005
	speed: 0.3306s/iter; left time: 12525.0652s
	iters: 200, epoch: 20 | loss: 0.0000721
	speed: 0.0536s/iter; left time: 2024.1100s
	iters: 300, epoch: 20 | loss: 0.0155151
	speed: 0.0551s/iter; left time: 2075.1695s
	iters: 400, epoch: 20 | loss: 0.1053563
	speed: 0.0556s/iter; left time: 2089.4119s
Epoch: 20 cost time: 26.15344762802124
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.253 Vali Acc: 0.960 Test Loss: 0.253 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0020421
	speed: 0.3410s/iter; left time: 12759.8456s
	iters: 200, epoch: 21 | loss: 0.0257095
	speed: 0.0581s/iter; left time: 2168.5866s
	iters: 300, epoch: 21 | loss: 0.0460550
	speed: 0.0536s/iter; left time: 1996.0931s
	iters: 400, epoch: 21 | loss: 0.0512125
	speed: 0.0551s/iter; left time: 2046.8366s
Epoch: 21 cost time: 26.979793310165405
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0054698
	speed: 0.3232s/iter; left time: 11941.7870s
	iters: 200, epoch: 22 | loss: 0.0885423
	speed: 0.0503s/iter; left time: 1853.1430s
	iters: 300, epoch: 22 | loss: 0.0013855
	speed: 0.0489s/iter; left time: 1798.0667s
	iters: 400, epoch: 22 | loss: 0.0165912
	speed: 0.0491s/iter; left time: 1799.5981s
Epoch: 22 cost time: 23.51120638847351
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.268 Vali Acc: 0.956 Test Loss: 0.268 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9739851343624929
model parameter : 60938
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0741469
	speed: 0.0911s/iter; left time: 4264.8740s
	iters: 200, epoch: 1 | loss: 0.4763716
	speed: 0.0514s/iter; left time: 2399.0847s
	iters: 300, epoch: 1 | loss: 0.5493926
	speed: 0.0506s/iter; left time: 2357.7189s
	iters: 400, epoch: 1 | loss: 0.2298897
	speed: 0.0523s/iter; left time: 2430.6500s
Epoch: 1 cost time: 28.394293308258057
Epoch: 1, Steps: 469 | Train Loss: 0.829 Vali Loss: 0.370 Vali Acc: 0.888 Test Loss: 0.370 Test Acc: 0.888
Validation loss decreased (inf --> -0.888218).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3353250
	speed: 0.3393s/iter; left time: 15718.2947s
	iters: 200, epoch: 2 | loss: 0.3052469
	speed: 0.0510s/iter; left time: 2360.1084s
	iters: 300, epoch: 2 | loss: 0.0648045
	speed: 0.0491s/iter; left time: 2266.2510s
	iters: 400, epoch: 2 | loss: 0.1144806
	speed: 0.0445s/iter; left time: 2047.7304s
Epoch: 2 cost time: 23.677537202835083
Epoch: 2, Steps: 469 | Train Loss: 0.184 Vali Loss: 0.214 Vali Acc: 0.947 Test Loss: 0.214 Test Acc: 0.947
Validation loss decreased (-0.888218 --> -0.946539).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0527486
	speed: 0.3267s/iter; left time: 14981.3664s
	iters: 200, epoch: 3 | loss: 0.1260470
	speed: 0.0510s/iter; left time: 2334.9973s
	iters: 300, epoch: 3 | loss: 0.0247388
	speed: 0.0443s/iter; left time: 2022.2266s
	iters: 400, epoch: 3 | loss: 0.0318903
	speed: 0.0472s/iter; left time: 2148.6673s
Epoch: 3 cost time: 24.014484882354736
Epoch: 3, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.946539 --> -0.955687).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0108859
	speed: 0.3253s/iter; left time: 14768.3953s
	iters: 200, epoch: 4 | loss: 0.0907488
	speed: 0.0530s/iter; left time: 2399.4492s
	iters: 300, epoch: 4 | loss: 0.0696340
	speed: 0.0584s/iter; left time: 2639.0655s
	iters: 400, epoch: 4 | loss: 0.0354236
	speed: 0.0578s/iter; left time: 2608.2323s
Epoch: 4 cost time: 27.018439531326294
Epoch: 4, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
Validation loss decreased (-0.955687 --> -0.961977).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0768120
	speed: 0.3606s/iter; left time: 16200.0452s
	iters: 200, epoch: 5 | loss: 0.0531226
	speed: 0.0561s/iter; left time: 2516.4285s
	iters: 300, epoch: 5 | loss: 0.0098457
	speed: 0.0511s/iter; left time: 2284.8842s
	iters: 400, epoch: 5 | loss: 0.1239427
	speed: 0.0520s/iter; left time: 2320.9201s
Epoch: 5 cost time: 25.790968418121338
Epoch: 5, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.961977 --> -0.962834).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0433336
	speed: 0.3420s/iter; left time: 15205.5131s
	iters: 200, epoch: 6 | loss: 0.0103721
	speed: 0.0450s/iter; left time: 1995.1126s
	iters: 300, epoch: 6 | loss: 0.0391880
	speed: 0.0506s/iter; left time: 2238.3686s
	iters: 400, epoch: 6 | loss: 0.0216257
	speed: 0.0558s/iter; left time: 2465.1262s
Epoch: 6 cost time: 24.656197547912598
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0154968
	speed: 0.3188s/iter; left time: 14022.7719s
	iters: 200, epoch: 7 | loss: 0.0055474
	speed: 0.0447s/iter; left time: 1960.9508s
	iters: 300, epoch: 7 | loss: 0.0028335
	speed: 0.0502s/iter; left time: 2197.4476s
	iters: 400, epoch: 7 | loss: 0.0714861
	speed: 0.0510s/iter; left time: 2228.6042s
Epoch: 7 cost time: 23.44501757621765
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
Validation loss decreased (-0.962834 --> -0.965979).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1190359
	speed: 0.3272s/iter; left time: 14237.3874s
	iters: 200, epoch: 8 | loss: 0.0092743
	speed: 0.0504s/iter; left time: 2186.9725s
	iters: 300, epoch: 8 | loss: 0.0186076
	speed: 0.0448s/iter; left time: 1942.4742s
	iters: 400, epoch: 8 | loss: 0.0045035
	speed: 0.0447s/iter; left time: 1931.9247s
Epoch: 8 cost time: 23.061476230621338
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0172450
	speed: 0.3063s/iter; left time: 13184.5021s
	iters: 200, epoch: 9 | loss: 0.0040600
	speed: 0.0437s/iter; left time: 1876.1633s
	iters: 300, epoch: 9 | loss: 0.3292818
	speed: 0.0493s/iter; left time: 2113.5106s
	iters: 400, epoch: 9 | loss: 0.0699615
	speed: 0.0524s/iter; left time: 2241.3462s
Epoch: 9 cost time: 23.313093423843384
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0145825
	speed: 0.3276s/iter; left time: 13947.5675s
	iters: 200, epoch: 10 | loss: 0.0505574
	speed: 0.0472s/iter; left time: 2005.9681s
	iters: 300, epoch: 10 | loss: 0.0030595
	speed: 0.0493s/iter; left time: 2089.3402s
	iters: 400, epoch: 10 | loss: 0.0029311
	speed: 0.0493s/iter; left time: 2085.9833s
Epoch: 10 cost time: 23.902340173721313
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.965979 --> -0.969695).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0105689
	speed: 0.3144s/iter; left time: 13239.5965s
	iters: 200, epoch: 11 | loss: 0.0116316
	speed: 0.0439s/iter; left time: 1844.7244s
	iters: 300, epoch: 11 | loss: 0.0087629
	speed: 0.0451s/iter; left time: 1889.0246s
	iters: 400, epoch: 11 | loss: 0.0015575
	speed: 0.0545s/iter; left time: 2277.9342s
Epoch: 11 cost time: 22.830902814865112
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0113110
	speed: 0.3419s/iter; left time: 14239.0010s
	iters: 200, epoch: 12 | loss: 0.0014886
	speed: 0.0480s/iter; left time: 1995.2357s
	iters: 300, epoch: 12 | loss: 0.2426359
	speed: 0.0481s/iter; left time: 1993.0060s
	iters: 400, epoch: 12 | loss: 0.0057251
	speed: 0.0554s/iter; left time: 2288.9426s
Epoch: 12 cost time: 24.762194395065308
Epoch: 12, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0131675
	speed: 0.3337s/iter; left time: 13738.8011s
	iters: 200, epoch: 13 | loss: 0.1063050
	speed: 0.0471s/iter; left time: 1932.9714s
	iters: 300, epoch: 13 | loss: 0.0049298
	speed: 0.0480s/iter; left time: 1967.0856s
	iters: 400, epoch: 13 | loss: 0.0268239
	speed: 0.0498s/iter; left time: 2036.3944s
Epoch: 13 cost time: 22.833608627319336
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0020214
	speed: 0.3404s/iter; left time: 13853.8243s
	iters: 200, epoch: 14 | loss: 0.0071832
	speed: 0.0486s/iter; left time: 1971.3989s
	iters: 300, epoch: 14 | loss: 0.0002952
	speed: 0.0523s/iter; left time: 2119.5924s
	iters: 400, epoch: 14 | loss: 0.0077473
	speed: 0.0541s/iter; left time: 2185.3566s
Epoch: 14 cost time: 25.507994413375854
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0027740
	speed: 0.3303s/iter; left time: 13291.0544s
	iters: 200, epoch: 15 | loss: 0.0043760
	speed: 0.0461s/iter; left time: 1852.0614s
	iters: 300, epoch: 15 | loss: 0.0071572
	speed: 0.0475s/iter; left time: 1900.6321s
	iters: 400, epoch: 15 | loss: 0.0268597
	speed: 0.0512s/iter; left time: 2046.2855s
Epoch: 15 cost time: 23.687819004058838
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0006630
	speed: 0.3447s/iter; left time: 13707.4924s
	iters: 200, epoch: 16 | loss: 0.0028468
	speed: 0.0494s/iter; left time: 1959.3767s
	iters: 300, epoch: 16 | loss: 0.0015994
	speed: 0.0506s/iter; left time: 2001.5106s
	iters: 400, epoch: 16 | loss: 0.0010994
	speed: 0.0512s/iter; left time: 2018.9503s
Epoch: 16 cost time: 24.98393750190735
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.187 Vali Acc: 0.966 Test Loss: 0.187 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0008021
	speed: 0.3553s/iter; left time: 13963.8702s
	iters: 200, epoch: 17 | loss: 0.0011264
	speed: 0.0441s/iter; left time: 1728.7109s
	iters: 300, epoch: 17 | loss: 0.0068886
	speed: 0.0458s/iter; left time: 1789.8405s
	iters: 400, epoch: 17 | loss: 0.0031787
	speed: 0.0511s/iter; left time: 1993.9654s
Epoch: 17 cost time: 23.560025691986084
Epoch: 17, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0981170
	speed: 0.3203s/iter; left time: 12438.3171s
	iters: 200, epoch: 18 | loss: 0.0037844
	speed: 0.0489s/iter; left time: 1892.9638s
	iters: 300, epoch: 18 | loss: 0.0084396
	speed: 0.0536s/iter; left time: 2072.0753s
	iters: 400, epoch: 18 | loss: 0.0034783
	speed: 0.0505s/iter; left time: 1945.4839s
Epoch: 18 cost time: 25.061371088027954
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.957 Test Loss: 0.251 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0061118
	speed: 0.3371s/iter; left time: 12931.3361s
	iters: 200, epoch: 19 | loss: 0.0072500
	speed: 0.0483s/iter; left time: 1849.4661s
	iters: 300, epoch: 19 | loss: 0.0106202
	speed: 0.0525s/iter; left time: 2005.2380s
	iters: 400, epoch: 19 | loss: 0.2876706
	speed: 0.0542s/iter; left time: 2063.5797s
Epoch: 19 cost time: 25.333771228790283
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
Validation loss decreased (-0.969695 --> -0.971410).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000624
	speed: 0.3608s/iter; left time: 13669.5170s
	iters: 200, epoch: 20 | loss: 0.0020217
	speed: 0.0530s/iter; left time: 2003.5391s
	iters: 300, epoch: 20 | loss: 0.1531708
	speed: 0.0538s/iter; left time: 2026.3478s
	iters: 400, epoch: 20 | loss: 0.0099227
	speed: 0.0590s/iter; left time: 2217.0507s
Epoch: 20 cost time: 27.103469610214233
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
Validation loss decreased (-0.971410 --> -0.973984).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0019387
	speed: 0.3574s/iter; left time: 13373.9367s
	iters: 200, epoch: 21 | loss: 0.0001368
	speed: 0.0575s/iter; left time: 2144.7935s
	iters: 300, epoch: 21 | loss: 0.0109740
	speed: 0.0525s/iter; left time: 1955.3535s
	iters: 400, epoch: 21 | loss: 0.0699271
	speed: 0.0577s/iter; left time: 2141.2145s
Epoch: 21 cost time: 26.38200044631958
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0006049
	speed: 0.3638s/iter; left time: 13441.4283s
	iters: 200, epoch: 22 | loss: 0.0014830
	speed: 0.0505s/iter; left time: 1859.7385s
	iters: 300, epoch: 22 | loss: 0.0032883
	speed: 0.0499s/iter; left time: 1833.2148s
	iters: 400, epoch: 22 | loss: 0.0113389
	speed: 0.0501s/iter; left time: 1837.7577s
Epoch: 22 cost time: 24.628297567367554
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
Validation loss decreased (-0.973984 --> -0.974270).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0025281
	speed: 0.3414s/iter; left time: 12453.4824s
	iters: 200, epoch: 23 | loss: 0.2052218
	speed: 0.0469s/iter; left time: 1706.4653s
	iters: 300, epoch: 23 | loss: 0.0019297
	speed: 0.0497s/iter; left time: 1803.8219s
	iters: 400, epoch: 23 | loss: 0.7582276
	speed: 0.0499s/iter; left time: 1806.6920s
Epoch: 23 cost time: 23.91160559654236
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0019102
	speed: 0.3432s/iter; left time: 12359.5744s
	iters: 200, epoch: 24 | loss: 0.0033928
	speed: 0.0485s/iter; left time: 1743.2435s
	iters: 300, epoch: 24 | loss: 0.0002449
	speed: 0.0497s/iter; left time: 1780.9683s
	iters: 400, epoch: 24 | loss: 0.0020794
	speed: 0.0513s/iter; left time: 1831.3386s
Epoch: 24 cost time: 24.170645475387573
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0010604
	speed: 0.3463s/iter; left time: 12308.8764s
	iters: 200, epoch: 25 | loss: 0.0038978
	speed: 0.0513s/iter; left time: 1817.7042s
	iters: 300, epoch: 25 | loss: 0.0144037
	speed: 0.0524s/iter; left time: 1852.6001s
	iters: 400, epoch: 25 | loss: 0.0005613
	speed: 0.0530s/iter; left time: 1867.7847s
Epoch: 25 cost time: 25.49491310119629
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0006446
	speed: 0.3612s/iter; left time: 12669.8929s
	iters: 200, epoch: 26 | loss: 0.0305798
	speed: 0.0506s/iter; left time: 1771.1372s
	iters: 300, epoch: 26 | loss: 0.0014521
	speed: 0.0495s/iter; left time: 1726.4206s
	iters: 400, epoch: 26 | loss: 0.0094259
	speed: 0.0486s/iter; left time: 1691.7658s
Epoch: 26 cost time: 24.98639225959778
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0003932
	speed: 0.3354s/iter; left time: 11606.8103s
	iters: 200, epoch: 27 | loss: 0.0032049
	speed: 0.0479s/iter; left time: 1652.7033s
	iters: 300, epoch: 27 | loss: 0.0031868
	speed: 0.0543s/iter; left time: 1867.5275s
	iters: 400, epoch: 27 | loss: 0.0034369
	speed: 0.0443s/iter; left time: 1518.9333s
Epoch: 27 cost time: 24.43350625038147
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1656759
	speed: 0.3373s/iter; left time: 11515.7768s
	iters: 200, epoch: 28 | loss: 0.0152442
	speed: 0.0550s/iter; left time: 1872.4903s
	iters: 300, epoch: 28 | loss: 0.0584920
	speed: 0.0507s/iter; left time: 1719.8720s
	iters: 400, epoch: 28 | loss: 0.0006368
	speed: 0.0456s/iter; left time: 1541.3918s
Epoch: 28 cost time: 24.156307458877563
Epoch: 28, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.192 Vali Acc: 0.968 Test Loss: 0.192 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0003593
	speed: 0.3213s/iter; left time: 10816.2705s
	iters: 200, epoch: 29 | loss: 0.0031200
	speed: 0.0515s/iter; left time: 1728.5913s
	iters: 300, epoch: 29 | loss: 0.0081322
	speed: 0.0551s/iter; left time: 1843.2193s
	iters: 400, epoch: 29 | loss: 0.7561772
	speed: 0.0488s/iter; left time: 1628.1687s
Epoch: 29 cost time: 25.10111141204834
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0002266
	speed: 0.3457s/iter; left time: 11478.3689s
	iters: 200, epoch: 30 | loss: 0.1532856
	speed: 0.0527s/iter; left time: 1743.5103s
	iters: 300, epoch: 30 | loss: 0.1940318
	speed: 0.0568s/iter; left time: 1874.9114s
	iters: 400, epoch: 30 | loss: 0.4488968
	speed: 0.0553s/iter; left time: 1820.5719s
Epoch: 30 cost time: 26.269957542419434
Epoch: 30, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0009953
	speed: 0.3384s/iter; left time: 11075.7711s
	iters: 200, epoch: 31 | loss: 0.0403114
	speed: 0.0542s/iter; left time: 1769.9242s
	iters: 300, epoch: 31 | loss: 0.0380071
	speed: 0.0542s/iter; left time: 1763.3077s
	iters: 400, epoch: 31 | loss: 0.0001610
	speed: 0.0543s/iter; left time: 1760.9381s
Epoch: 31 cost time: 25.758678197860718
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.961 Test Loss: 0.210 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0875957
	speed: 0.3388s/iter; left time: 10930.1700s
	iters: 200, epoch: 32 | loss: 0.0036356
	speed: 0.0473s/iter; left time: 1521.2502s
	iters: 300, epoch: 32 | loss: 0.0166446
	speed: 0.0506s/iter; left time: 1622.9780s
	iters: 400, epoch: 32 | loss: 0.0000938
	speed: 0.0498s/iter; left time: 1590.8575s
Epoch: 32 cost time: 23.90539050102234
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 47306
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1497182
	speed: 0.0776s/iter; left time: 3632.8592s
	iters: 200, epoch: 1 | loss: 1.0377865
	speed: 0.0422s/iter; left time: 1973.0424s
	iters: 300, epoch: 1 | loss: 0.3911108
	speed: 0.0390s/iter; left time: 1818.6566s
	iters: 400, epoch: 1 | loss: 0.3948136
	speed: 0.0447s/iter; left time: 2076.9769s
Epoch: 1 cost time: 23.370280742645264
Epoch: 1, Steps: 469 | Train Loss: 0.849 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (inf --> -0.889076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1882788
	speed: 0.3172s/iter; left time: 14696.9957s
	iters: 200, epoch: 2 | loss: 0.1709425
	speed: 0.0457s/iter; left time: 2110.5036s
	iters: 300, epoch: 2 | loss: 0.1503214
	speed: 0.0451s/iter; left time: 2080.4478s
	iters: 400, epoch: 2 | loss: 0.2540185
	speed: 0.0418s/iter; left time: 1925.2018s
Epoch: 2 cost time: 21.77713179588318
Epoch: 2, Steps: 469 | Train Loss: 0.198 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
Validation loss decreased (-0.889076 --> -0.921667).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0785969
	speed: 0.3237s/iter; left time: 14843.9747s
	iters: 200, epoch: 3 | loss: 0.1075189
	speed: 0.0476s/iter; left time: 2178.3989s
	iters: 300, epoch: 3 | loss: 0.2067572
	speed: 0.0467s/iter; left time: 2133.3684s
	iters: 400, epoch: 3 | loss: 0.0351951
	speed: 0.0529s/iter; left time: 2410.6959s
Epoch: 3 cost time: 23.940773010253906
Epoch: 3, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
Validation loss decreased (-0.921667 --> -0.954258).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0343836
	speed: 0.3174s/iter; left time: 14409.2727s
	iters: 200, epoch: 4 | loss: 0.0317270
	speed: 0.0468s/iter; left time: 2121.7840s
	iters: 300, epoch: 4 | loss: 0.1246549
	speed: 0.0451s/iter; left time: 2040.1715s
	iters: 400, epoch: 4 | loss: 0.0474568
	speed: 0.0449s/iter; left time: 2025.3429s
Epoch: 4 cost time: 22.472233533859253
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0129389
	speed: 0.2953s/iter; left time: 13266.4993s
	iters: 200, epoch: 5 | loss: 0.0097736
	speed: 0.0398s/iter; left time: 1785.4648s
	iters: 300, epoch: 5 | loss: 0.0091280
	speed: 0.0423s/iter; left time: 1891.4056s
	iters: 400, epoch: 5 | loss: 0.0699134
	speed: 0.0485s/iter; left time: 2165.5198s
Epoch: 5 cost time: 21.09794855117798
Epoch: 5, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.179 Vali Acc: 0.961 Test Loss: 0.179 Test Acc: 0.961
Validation loss decreased (-0.954258 --> -0.960547).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0442274
	speed: 0.2976s/iter; left time: 13230.2856s
	iters: 200, epoch: 6 | loss: 0.0068618
	speed: 0.0450s/iter; left time: 1997.4388s
	iters: 300, epoch: 6 | loss: 0.0015713
	speed: 0.0481s/iter; left time: 2128.1124s
	iters: 400, epoch: 6 | loss: 0.0085347
	speed: 0.0502s/iter; left time: 2217.1370s
Epoch: 6 cost time: 23.11899757385254
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.157 Vali Acc: 0.966 Test Loss: 0.157 Test Acc: 0.966
Validation loss decreased (-0.960547 --> -0.965693).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0362389
	speed: 0.3036s/iter; left time: 13352.7576s
	iters: 200, epoch: 7 | loss: 0.0646628
	speed: 0.0410s/iter; left time: 1798.0550s
	iters: 300, epoch: 7 | loss: 0.0112271
	speed: 0.0426s/iter; left time: 1867.0644s
	iters: 400, epoch: 7 | loss: 0.1383221
	speed: 0.0415s/iter; left time: 1811.7409s
Epoch: 7 cost time: 20.300598621368408
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0026720
	speed: 0.3057s/iter; left time: 13305.1410s
	iters: 200, epoch: 8 | loss: 0.0044713
	speed: 0.0470s/iter; left time: 2039.2271s
	iters: 300, epoch: 8 | loss: 0.0186701
	speed: 0.0444s/iter; left time: 1923.7726s
	iters: 400, epoch: 8 | loss: 0.0055318
	speed: 0.0475s/iter; left time: 2053.1233s
Epoch: 8 cost time: 22.75935935974121
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0092649
	speed: 0.3336s/iter; left time: 14360.8637s
	iters: 200, epoch: 9 | loss: 0.6857817
	speed: 0.0510s/iter; left time: 2191.5143s
	iters: 300, epoch: 9 | loss: 0.0275151
	speed: 0.0531s/iter; left time: 2276.4246s
	iters: 400, epoch: 9 | loss: 0.0183360
	speed: 0.0492s/iter; left time: 2103.2314s
Epoch: 9 cost time: 24.152498483657837
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
Validation loss decreased (-0.965693 --> -0.968552).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0061056
	speed: 0.3378s/iter; left time: 14383.2819s
	iters: 200, epoch: 10 | loss: 0.0053406
	speed: 0.0498s/iter; left time: 2115.4629s
	iters: 300, epoch: 10 | loss: 0.0356967
	speed: 0.0446s/iter; left time: 1888.9075s
	iters: 400, epoch: 10 | loss: 0.0004302
	speed: 0.0460s/iter; left time: 1945.5085s
Epoch: 10 cost time: 23.060070991516113
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.970267).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0703583
	speed: 0.3359s/iter; left time: 14146.7583s
	iters: 200, epoch: 11 | loss: 0.0189474
	speed: 0.0467s/iter; left time: 1960.2247s
	iters: 300, epoch: 11 | loss: 0.0772383
	speed: 0.0490s/iter; left time: 2053.5359s
	iters: 400, epoch: 11 | loss: 0.0048069
	speed: 0.0494s/iter; left time: 2065.6470s
Epoch: 11 cost time: 23.949959754943848
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1386463
	speed: 0.3295s/iter; left time: 13719.0501s
	iters: 200, epoch: 12 | loss: 0.0479253
	speed: 0.0490s/iter; left time: 2036.1279s
	iters: 300, epoch: 12 | loss: 0.1613912
	speed: 0.0467s/iter; left time: 1934.3967s
	iters: 400, epoch: 12 | loss: 0.0125280
	speed: 0.0422s/iter; left time: 1742.8843s
Epoch: 12 cost time: 22.860690593719482
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.970553).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0053871
	speed: 0.3210s/iter; left time: 13215.5559s
	iters: 200, epoch: 13 | loss: 0.0006951
	speed: 0.0495s/iter; left time: 2033.1797s
	iters: 300, epoch: 13 | loss: 0.0004700
	speed: 0.0496s/iter; left time: 2032.0110s
	iters: 400, epoch: 13 | loss: 0.0050516
	speed: 0.0486s/iter; left time: 1984.5050s
Epoch: 13 cost time: 24.046501398086548
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.186 Vali Acc: 0.968 Test Loss: 0.186 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1002832
	speed: 0.3317s/iter; left time: 13500.3038s
	iters: 200, epoch: 14 | loss: 0.0012854
	speed: 0.0491s/iter; left time: 1995.5784s
	iters: 300, epoch: 14 | loss: 0.0048015
	speed: 0.0447s/iter; left time: 1811.1040s
	iters: 400, epoch: 14 | loss: 0.0109118
	speed: 0.0472s/iter; left time: 1907.2035s
Epoch: 14 cost time: 22.63099455833435
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.970553 --> -0.977128).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0045274
	speed: 0.3415s/iter; left time: 13738.7143s
	iters: 200, epoch: 15 | loss: 0.0152135
	speed: 0.0458s/iter; left time: 1837.8104s
	iters: 300, epoch: 15 | loss: 0.0046575
	speed: 0.0539s/iter; left time: 2157.1680s
	iters: 400, epoch: 15 | loss: 0.0102835
	speed: 0.0533s/iter; left time: 2130.3170s
Epoch: 15 cost time: 25.091578483581543
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0108445
	speed: 0.3653s/iter; left time: 14526.0895s
	iters: 200, epoch: 16 | loss: 0.0562733
	speed: 0.0527s/iter; left time: 2091.8972s
	iters: 300, epoch: 16 | loss: 0.0186702
	speed: 0.0491s/iter; left time: 1943.6071s
	iters: 400, epoch: 16 | loss: 0.0040125
	speed: 0.0477s/iter; left time: 1881.9410s
Epoch: 16 cost time: 24.26936936378479
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0037914
	speed: 0.3193s/iter; left time: 12546.9333s
	iters: 200, epoch: 17 | loss: 0.0030235
	speed: 0.0483s/iter; left time: 1892.8613s
	iters: 300, epoch: 17 | loss: 0.0470436
	speed: 0.0412s/iter; left time: 1609.9424s
	iters: 400, epoch: 17 | loss: 0.1785237
	speed: 0.0465s/iter; left time: 1813.9932s
Epoch: 17 cost time: 22.478743076324463
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0084351
	speed: 0.3191s/iter; left time: 12391.1269s
	iters: 200, epoch: 18 | loss: 0.0013976
	speed: 0.0446s/iter; left time: 1725.4400s
	iters: 300, epoch: 18 | loss: 0.0005928
	speed: 0.0452s/iter; left time: 1747.5579s
	iters: 400, epoch: 18 | loss: 0.0005933
	speed: 0.0441s/iter; left time: 1697.7131s
Epoch: 18 cost time: 22.29455256462097
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0309503
	speed: 0.3236s/iter; left time: 12414.2476s
	iters: 200, epoch: 19 | loss: 0.0346114
	speed: 0.0519s/iter; left time: 1984.9315s
	iters: 300, epoch: 19 | loss: 0.0001299
	speed: 0.0462s/iter; left time: 1762.2515s
	iters: 400, epoch: 19 | loss: 0.0684175
	speed: 0.0490s/iter; left time: 1863.4744s
Epoch: 19 cost time: 23.70906639099121
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.194 Vali Acc: 0.966 Test Loss: 0.194 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0034372
	speed: 0.3293s/iter; left time: 12476.2662s
	iters: 200, epoch: 20 | loss: 0.0976526
	speed: 0.0424s/iter; left time: 1602.9599s
	iters: 300, epoch: 20 | loss: 0.0057273
	speed: 0.0481s/iter; left time: 1814.2585s
	iters: 400, epoch: 20 | loss: 0.2023981
	speed: 0.0445s/iter; left time: 1673.7107s
Epoch: 20 cost time: 23.005618810653687
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000663
	speed: 0.3170s/iter; left time: 11862.6838s
	iters: 200, epoch: 21 | loss: 0.0012258
	speed: 0.0493s/iter; left time: 1840.2878s
	iters: 300, epoch: 21 | loss: 0.0018140
	speed: 0.0436s/iter; left time: 1621.2622s
	iters: 400, epoch: 21 | loss: 0.0049375
	speed: 0.0511s/iter; left time: 1896.8678s
Epoch: 21 cost time: 23.66281747817993
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.968 Test Loss: 0.202 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0011802
	speed: 0.3246s/iter; left time: 11995.3327s
	iters: 200, epoch: 22 | loss: 0.0001296
	speed: 0.0412s/iter; left time: 1518.6933s
	iters: 300, epoch: 22 | loss: 0.0001240
	speed: 0.0478s/iter; left time: 1757.9145s
	iters: 400, epoch: 22 | loss: 0.0518271
	speed: 0.0448s/iter; left time: 1642.7439s
Epoch: 22 cost time: 22.145079851150513
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0018474
	speed: 0.3174s/iter; left time: 11578.4239s
	iters: 200, epoch: 23 | loss: 0.0230747
	speed: 0.0423s/iter; left time: 1540.7905s
	iters: 300, epoch: 23 | loss: 0.0007781
	speed: 0.0425s/iter; left time: 1543.6586s
	iters: 400, epoch: 23 | loss: 0.0057129
	speed: 0.0421s/iter; left time: 1523.7455s
Epoch: 23 cost time: 20.95167303085327
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.960 Test Loss: 0.213 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0018273
	speed: 0.3153s/iter; left time: 11355.1045s
	iters: 200, epoch: 24 | loss: 0.0209153
	speed: 0.0540s/iter; left time: 1941.1213s
	iters: 300, epoch: 24 | loss: 0.0040718
	speed: 0.0513s/iter; left time: 1838.8812s
	iters: 400, epoch: 24 | loss: 0.0005958
	speed: 0.0481s/iter; left time: 1719.0209s
Epoch: 24 cost time: 25.072285652160645
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 30666
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3279896
	speed: 0.0870s/iter; left time: 4073.9602s
	iters: 200, epoch: 1 | loss: 0.5678725
	speed: 0.0484s/iter; left time: 2258.1662s
	iters: 300, epoch: 1 | loss: 0.4490993
	speed: 0.0532s/iter; left time: 2478.1959s
	iters: 400, epoch: 1 | loss: 0.3621951
	speed: 0.0427s/iter; left time: 1987.0708s
Epoch: 1 cost time: 26.60217046737671
Epoch: 1, Steps: 469 | Train Loss: 0.847 Vali Loss: 0.358 Vali Acc: 0.897 Test Loss: 0.358 Test Acc: 0.897
Validation loss decreased (inf --> -0.897080).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1969914
	speed: 0.3262s/iter; left time: 15112.2830s
	iters: 200, epoch: 2 | loss: 0.1046532
	speed: 0.0456s/iter; left time: 2110.3939s
	iters: 300, epoch: 2 | loss: 0.4866227
	speed: 0.0419s/iter; left time: 1934.7639s
	iters: 400, epoch: 2 | loss: 0.4673994
	speed: 0.0486s/iter; left time: 2236.8552s
Epoch: 2 cost time: 22.061405420303345
Epoch: 2, Steps: 469 | Train Loss: 0.202 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
Validation loss decreased (-0.897080 --> -0.938248).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1712209
	speed: 0.3200s/iter; left time: 14675.1518s
	iters: 200, epoch: 3 | loss: 0.0627167
	speed: 0.0489s/iter; left time: 2238.2848s
	iters: 300, epoch: 3 | loss: 0.0570998
	speed: 0.0467s/iter; left time: 2130.7974s
	iters: 400, epoch: 3 | loss: 0.4199404
	speed: 0.0524s/iter; left time: 2387.1258s
Epoch: 3 cost time: 23.943614959716797
Epoch: 3, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
Validation loss decreased (-0.938248 --> -0.955116).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0240398
	speed: 0.3261s/iter; left time: 14802.2262s
	iters: 200, epoch: 4 | loss: 0.0218718
	speed: 0.0466s/iter; left time: 2110.0495s
	iters: 300, epoch: 4 | loss: 0.0591188
	speed: 0.0450s/iter; left time: 2032.8077s
	iters: 400, epoch: 4 | loss: 0.2536319
	speed: 0.0435s/iter; left time: 1960.4798s
Epoch: 4 cost time: 22.847180366516113
Epoch: 4, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.955116 --> -0.959690).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1730978
	speed: 0.3523s/iter; left time: 15826.2801s
	iters: 200, epoch: 5 | loss: 0.0058762
	speed: 0.0534s/iter; left time: 2392.9343s
	iters: 300, epoch: 5 | loss: 0.3068123
	speed: 0.0516s/iter; left time: 2307.9187s
	iters: 400, epoch: 5 | loss: 0.0692145
	speed: 0.0516s/iter; left time: 2301.2774s
Epoch: 5 cost time: 24.81112837791443
Epoch: 5, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.959690 --> -0.966551).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0478682
	speed: 0.3482s/iter; left time: 15480.8522s
	iters: 200, epoch: 6 | loss: 0.0047903
	speed: 0.0532s/iter; left time: 2360.1416s
	iters: 300, epoch: 6 | loss: 0.0083763
	speed: 0.0535s/iter; left time: 2365.8696s
	iters: 400, epoch: 6 | loss: 0.0135297
	speed: 0.0487s/iter; left time: 2148.2220s
Epoch: 6 cost time: 24.962549448013306
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0198655
	speed: 0.3391s/iter; left time: 14915.7665s
	iters: 200, epoch: 7 | loss: 0.0006683
	speed: 0.0490s/iter; left time: 2148.5007s
	iters: 300, epoch: 7 | loss: 0.1171849
	speed: 0.0464s/iter; left time: 2032.2955s
	iters: 400, epoch: 7 | loss: 0.0662720
	speed: 0.0478s/iter; left time: 2087.6313s
Epoch: 7 cost time: 23.718750715255737
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.966551 --> -0.969124).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008938
	speed: 0.3221s/iter; left time: 14018.6399s
	iters: 200, epoch: 8 | loss: 0.0065286
	speed: 0.0485s/iter; left time: 2103.8760s
	iters: 300, epoch: 8 | loss: 0.0107303
	speed: 0.0492s/iter; left time: 2131.7388s
	iters: 400, epoch: 8 | loss: 0.0056670
	speed: 0.0451s/iter; left time: 1950.3345s
Epoch: 8 cost time: 23.32326054573059
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0041127
	speed: 0.3226s/iter; left time: 13885.6888s
	iters: 200, epoch: 9 | loss: 0.0021985
	speed: 0.0464s/iter; left time: 1993.5415s
	iters: 300, epoch: 9 | loss: 0.0632654
	speed: 0.0478s/iter; left time: 2049.0613s
	iters: 400, epoch: 9 | loss: 0.0408512
	speed: 0.0428s/iter; left time: 1831.4673s
Epoch: 9 cost time: 22.7640643119812
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.193 Vali Acc: 0.966 Test Loss: 0.193 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0298914
	speed: 0.3165s/iter; left time: 13477.4657s
	iters: 200, epoch: 10 | loss: 0.0156541
	speed: 0.0453s/iter; left time: 1922.7489s
	iters: 300, epoch: 10 | loss: 0.2089972
	speed: 0.0503s/iter; left time: 2132.7994s
	iters: 400, epoch: 10 | loss: 0.0003217
	speed: 0.0519s/iter; left time: 2193.8086s
Epoch: 10 cost time: 23.474825382232666
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0075550
	speed: 0.3388s/iter; left time: 14266.4773s
	iters: 200, epoch: 11 | loss: 0.3456643
	speed: 0.0535s/iter; left time: 2248.2665s
	iters: 300, epoch: 11 | loss: 0.0041245
	speed: 0.0500s/iter; left time: 2093.9061s
	iters: 400, epoch: 11 | loss: 0.0019585
	speed: 0.0496s/iter; left time: 2075.8384s
Epoch: 11 cost time: 24.87376070022583
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0125330
	speed: 0.3386s/iter; left time: 14101.9434s
	iters: 200, epoch: 12 | loss: 0.0918657
	speed: 0.0498s/iter; left time: 2070.8339s
	iters: 300, epoch: 12 | loss: 0.0012924
	speed: 0.0507s/iter; left time: 2100.9377s
	iters: 400, epoch: 12 | loss: 0.0197914
	speed: 0.0487s/iter; left time: 2014.3061s
Epoch: 12 cost time: 23.975115299224854
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.964 Test Loss: 0.187 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0088379
	speed: 0.3230s/iter; left time: 13299.2064s
	iters: 200, epoch: 13 | loss: 0.0052636
	speed: 0.0467s/iter; left time: 1917.0755s
	iters: 300, epoch: 13 | loss: 0.1155931
	speed: 0.0465s/iter; left time: 1906.0408s
	iters: 400, epoch: 13 | loss: 0.0006043
	speed: 0.0570s/iter; left time: 2329.2308s
Epoch: 13 cost time: 24.118995904922485
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0003500
	speed: 0.3305s/iter; left time: 13454.5753s
	iters: 200, epoch: 14 | loss: 0.1193862
	speed: 0.0520s/iter; left time: 2109.6465s
	iters: 300, epoch: 14 | loss: 0.0007129
	speed: 0.0509s/iter; left time: 2062.9794s
	iters: 400, epoch: 14 | loss: 0.0220999
	speed: 0.0474s/iter; left time: 1915.0587s
Epoch: 14 cost time: 24.436495780944824
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0042839
	speed: 0.3362s/iter; left time: 13528.3636s
	iters: 200, epoch: 15 | loss: 0.1723595
	speed: 0.0504s/iter; left time: 2022.3404s
	iters: 300, epoch: 15 | loss: 0.0008866
	speed: 0.0495s/iter; left time: 1982.4595s
	iters: 400, epoch: 15 | loss: 0.0060856
	speed: 0.0516s/iter; left time: 2060.0123s
Epoch: 15 cost time: 25.137455463409424
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.971 Test Loss: 0.199 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.971124).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3351874
	speed: 0.3445s/iter; left time: 13699.7521s
	iters: 200, epoch: 16 | loss: 0.0008286
	speed: 0.0477s/iter; left time: 1890.3676s
	iters: 300, epoch: 16 | loss: 0.0016989
	speed: 0.0474s/iter; left time: 1875.7876s
	iters: 400, epoch: 16 | loss: 0.0076879
	speed: 0.0456s/iter; left time: 1798.1849s
Epoch: 16 cost time: 23.278310537338257
Epoch: 16, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0037883
	speed: 0.3080s/iter; left time: 12103.6905s
	iters: 200, epoch: 17 | loss: 0.0476301
	speed: 0.0593s/iter; left time: 2325.0089s
	iters: 300, epoch: 17 | loss: 0.4018962
	speed: 0.0459s/iter; left time: 1792.8133s
	iters: 400, epoch: 17 | loss: 0.0006356
	speed: 0.0478s/iter; left time: 1862.6048s
Epoch: 17 cost time: 23.711788654327393
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.971124 --> -0.973126).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1766739
	speed: 0.3350s/iter; left time: 13006.7371s
	iters: 200, epoch: 18 | loss: 0.0015264
	speed: 0.0466s/iter; left time: 1806.5602s
	iters: 300, epoch: 18 | loss: 0.0036982
	speed: 0.0495s/iter; left time: 1911.6532s
	iters: 400, epoch: 18 | loss: 0.0000710
	speed: 0.0493s/iter; left time: 1900.9205s
Epoch: 18 cost time: 23.5079345703125
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0655202
	speed: 0.3390s/iter; left time: 13001.9551s
	iters: 200, epoch: 19 | loss: 0.0006365
	speed: 0.0463s/iter; left time: 1769.8130s
	iters: 300, epoch: 19 | loss: 0.1379074
	speed: 0.0530s/iter; left time: 2024.2208s
	iters: 400, epoch: 19 | loss: 0.0033873
	speed: 0.0458s/iter; left time: 1742.0322s
Epoch: 19 cost time: 23.486170530319214
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0039252
	speed: 0.3208s/iter; left time: 12156.2265s
	iters: 200, epoch: 20 | loss: 0.0005307
	speed: 0.0403s/iter; left time: 1523.5759s
	iters: 300, epoch: 20 | loss: 0.0053043
	speed: 0.0449s/iter; left time: 1692.9550s
	iters: 400, epoch: 20 | loss: 0.0193943
	speed: 0.0407s/iter; left time: 1530.3911s
Epoch: 20 cost time: 21.260292768478394
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.225 Vali Acc: 0.965 Test Loss: 0.225 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0003477
	speed: 0.3068s/iter; left time: 11479.0903s
	iters: 200, epoch: 21 | loss: 0.0004114
	speed: 0.0480s/iter; left time: 1793.0259s
	iters: 300, epoch: 21 | loss: 0.0301499
	speed: 0.0437s/iter; left time: 1626.5910s
	iters: 400, epoch: 21 | loss: 0.0023640
	speed: 0.0434s/iter; left time: 1611.0690s
Epoch: 21 cost time: 21.698662281036377
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.965 Test Loss: 0.218 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0079542
	speed: 0.2971s/iter; left time: 10977.9690s
	iters: 200, epoch: 22 | loss: 0.0009031
	speed: 0.0460s/iter; left time: 1694.0966s
	iters: 300, epoch: 22 | loss: 0.0023635
	speed: 0.0471s/iter; left time: 1729.3882s
	iters: 400, epoch: 22 | loss: 0.1272135
	speed: 0.0492s/iter; left time: 1802.9945s
Epoch: 22 cost time: 23.012937307357788
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.965 Test Loss: 0.214 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0017383
	speed: 0.2992s/iter; left time: 10917.2610s
	iters: 200, epoch: 23 | loss: 0.0003038
	speed: 0.0453s/iter; left time: 1646.7168s
	iters: 300, epoch: 23 | loss: 0.0002653
	speed: 0.0481s/iter; left time: 1745.6083s
	iters: 400, epoch: 23 | loss: 0.0016021
	speed: 0.0486s/iter; left time: 1757.2176s
Epoch: 23 cost time: 22.812305212020874
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.245 Vali Acc: 0.965 Test Loss: 0.245 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0013660
	speed: 0.3133s/iter; left time: 11281.9557s
	iters: 200, epoch: 24 | loss: 0.0000759
	speed: 0.0442s/iter; left time: 1588.5954s
	iters: 300, epoch: 24 | loss: 0.0029100
	speed: 0.0476s/iter; left time: 1703.5849s
	iters: 400, epoch: 24 | loss: 0.0258581
	speed: 0.0491s/iter; left time: 1753.5447s
Epoch: 24 cost time: 22.394749879837036
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.968 Test Loss: 0.219 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0022394
	speed: 0.3043s/iter; left time: 10815.8649s
	iters: 200, epoch: 25 | loss: 0.0006075
	speed: 0.0508s/iter; left time: 1799.7368s
	iters: 300, epoch: 25 | loss: 0.0017104
	speed: 0.0500s/iter; left time: 1767.5362s
	iters: 400, epoch: 25 | loss: 0.0001642
	speed: 0.0510s/iter; left time: 1796.7565s
Epoch: 25 cost time: 23.456581354141235
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0002249
	speed: 0.3179s/iter; left time: 11149.7168s
	iters: 200, epoch: 26 | loss: 0.0043096
	speed: 0.0536s/iter; left time: 1873.9506s
	iters: 300, epoch: 26 | loss: 0.0016486
	speed: 0.0527s/iter; left time: 1838.8128s
	iters: 400, epoch: 26 | loss: 0.0019382
	speed: 0.0509s/iter; left time: 1769.2782s
Epoch: 26 cost time: 24.44322943687439
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.973126 --> -0.973126).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000559
	speed: 0.3513s/iter; left time: 12156.4873s
	iters: 200, epoch: 27 | loss: 0.0011308
	speed: 0.0452s/iter; left time: 1560.8621s
	iters: 300, epoch: 27 | loss: 0.0009636
	speed: 0.0490s/iter; left time: 1684.6391s
	iters: 400, epoch: 27 | loss: 0.0102995
	speed: 0.0509s/iter; left time: 1746.9885s
Epoch: 27 cost time: 24.00774621963501
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.965 Test Loss: 0.228 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000317
	speed: 0.3324s/iter; left time: 11346.3041s
	iters: 200, epoch: 28 | loss: 0.4307087
	speed: 0.0501s/iter; left time: 1705.8090s
	iters: 300, epoch: 28 | loss: 0.0005529
	speed: 0.0504s/iter; left time: 1710.2693s
	iters: 400, epoch: 28 | loss: 0.0132851
	speed: 0.0488s/iter; left time: 1650.4094s
Epoch: 28 cost time: 24.260927200317383
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0067887
	speed: 0.3379s/iter; left time: 11375.9476s
	iters: 200, epoch: 29 | loss: 0.2476370
	speed: 0.0505s/iter; left time: 1696.0326s
	iters: 300, epoch: 29 | loss: 0.0014977
	speed: 0.0456s/iter; left time: 1526.9717s
	iters: 400, epoch: 29 | loss: 0.0194926
	speed: 0.0478s/iter; left time: 1595.9709s
Epoch: 29 cost time: 24.207348823547363
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0005703
	speed: 0.3128s/iter; left time: 10386.3632s
	iters: 200, epoch: 30 | loss: 0.0004732
	speed: 0.0489s/iter; left time: 1618.3869s
	iters: 300, epoch: 30 | loss: 0.0053787
	speed: 0.0492s/iter; left time: 1623.0289s
	iters: 400, epoch: 30 | loss: 0.0005601
	speed: 0.0461s/iter; left time: 1516.9714s
Epoch: 30 cost time: 23.29775333404541
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0001350
	speed: 0.3228s/iter; left time: 10564.7952s
	iters: 200, epoch: 31 | loss: 0.1768148
	speed: 0.0464s/iter; left time: 1514.4113s
	iters: 300, epoch: 31 | loss: 0.0001142
	speed: 0.0456s/iter; left time: 1483.1991s
	iters: 400, epoch: 31 | loss: 0.0002060
	speed: 0.0426s/iter; left time: 1381.7183s
Epoch: 31 cost time: 22.25779914855957
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.969 Test Loss: 0.215 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0012154
	speed: 0.3420s/iter; left time: 11033.0266s
	iters: 200, epoch: 32 | loss: 0.0001801
	speed: 0.0547s/iter; left time: 1758.3764s
	iters: 300, epoch: 32 | loss: 0.0011418
	speed: 0.0558s/iter; left time: 1790.3376s
	iters: 400, epoch: 32 | loss: 0.0070241
	speed: 0.0491s/iter; left time: 1570.0316s
Epoch: 32 cost time: 26.247869968414307
Epoch: 32, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000462
	speed: 0.3423s/iter; left time: 10884.3290s
	iters: 200, epoch: 33 | loss: 0.0015909
	speed: 0.0450s/iter; left time: 1426.3083s
	iters: 300, epoch: 33 | loss: 0.0101668
	speed: 0.0537s/iter; left time: 1697.0407s
	iters: 400, epoch: 33 | loss: 0.0014298
	speed: 0.0528s/iter; left time: 1661.5871s
Epoch: 33 cost time: 25.450395345687866
Epoch: 33, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0024208
	speed: 0.3530s/iter; left time: 11057.0321s
	iters: 200, epoch: 34 | loss: 0.0177017
	speed: 0.0527s/iter; left time: 1645.7731s
	iters: 300, epoch: 34 | loss: 0.0002079
	speed: 0.0499s/iter; left time: 1553.3178s
	iters: 400, epoch: 34 | loss: 0.0051696
	speed: 0.0489s/iter; left time: 1517.9070s
Epoch: 34 cost time: 23.731987237930298
Epoch: 34, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0001272
	speed: 0.3240s/iter; left time: 9997.1082s
	iters: 200, epoch: 35 | loss: 0.0016173
	speed: 0.0481s/iter; left time: 1478.0295s
	iters: 300, epoch: 35 | loss: 0.0132505
	speed: 0.0500s/iter; left time: 1533.5005s
	iters: 400, epoch: 35 | loss: 0.0005873
	speed: 0.0471s/iter; left time: 1439.1672s
Epoch: 35 cost time: 23.968540906906128
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.207 Vali Acc: 0.970 Test Loss: 0.207 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0622068
	speed: 0.3139s/iter; left time: 9537.9321s
	iters: 200, epoch: 36 | loss: 0.0073807
	speed: 0.0488s/iter; left time: 1477.9703s
	iters: 300, epoch: 36 | loss: 0.0007429
	speed: 0.0490s/iter; left time: 1479.4362s
	iters: 400, epoch: 36 | loss: 0.0019146
	speed: 0.0506s/iter; left time: 1522.9097s
Epoch: 36 cost time: 23.714580535888672
Epoch: 36, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.968 Test Loss: 0.207 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 22346
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5602286
	speed: 0.0688s/iter; left time: 3217.9312s
	iters: 200, epoch: 1 | loss: 0.9276468
	speed: 0.0446s/iter; left time: 2082.4622s
	iters: 300, epoch: 1 | loss: 1.0739169
	speed: 0.0440s/iter; left time: 2052.7484s
	iters: 400, epoch: 1 | loss: 0.6651678
	speed: 0.0456s/iter; left time: 2118.7614s
Epoch: 1 cost time: 23.194106578826904
Epoch: 1, Steps: 469 | Train Loss: 1.050 Vali Loss: 0.526 Vali Acc: 0.835 Test Loss: 0.526 Test Acc: 0.835
Validation loss decreased (inf --> -0.834757).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3495196
	speed: 0.2829s/iter; left time: 13107.6893s
	iters: 200, epoch: 2 | loss: 0.2124502
	speed: 0.0398s/iter; left time: 1838.7409s
	iters: 300, epoch: 2 | loss: 0.2597708
	speed: 0.0386s/iter; left time: 1779.8909s
	iters: 400, epoch: 2 | loss: 0.0886784
	speed: 0.0412s/iter; left time: 1898.2213s
Epoch: 2 cost time: 19.474700927734375
Epoch: 2, Steps: 469 | Train Loss: 0.312 Vali Loss: 0.287 Vali Acc: 0.920 Test Loss: 0.287 Test Acc: 0.920
Validation loss decreased (-0.834757 --> -0.920237).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0522425
	speed: 0.2903s/iter; left time: 13312.0270s
	iters: 200, epoch: 3 | loss: 0.0842630
	speed: 0.0451s/iter; left time: 2063.5443s
	iters: 300, epoch: 3 | loss: 0.0934807
	speed: 0.0509s/iter; left time: 2322.1604s
	iters: 400, epoch: 3 | loss: 0.1018016
	speed: 0.0513s/iter; left time: 2335.9724s
Epoch: 3 cost time: 22.950552940368652
Epoch: 3, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
Validation loss decreased (-0.920237 --> -0.932245).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0683411
	speed: 0.3247s/iter; left time: 14739.5603s
	iters: 200, epoch: 4 | loss: 0.0422560
	speed: 0.0460s/iter; left time: 2085.1329s
	iters: 300, epoch: 4 | loss: 0.1725829
	speed: 0.0465s/iter; left time: 2101.9953s
	iters: 400, epoch: 4 | loss: 0.1318179
	speed: 0.0420s/iter; left time: 1895.0073s
Epoch: 4 cost time: 22.540961027145386
Epoch: 4, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.932245 --> -0.950255).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0745154
	speed: 0.3160s/iter; left time: 14197.2992s
	iters: 200, epoch: 5 | loss: 0.1599199
	speed: 0.0450s/iter; left time: 2017.5345s
	iters: 300, epoch: 5 | loss: 0.4233340
	speed: 0.0500s/iter; left time: 2236.7020s
	iters: 400, epoch: 5 | loss: 0.0566432
	speed: 0.0475s/iter; left time: 2118.1930s
Epoch: 5 cost time: 22.711539030075073
Epoch: 5, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.950255 --> -0.951399).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0113242
	speed: 0.3265s/iter; left time: 14516.2097s
	iters: 200, epoch: 6 | loss: 0.0444087
	speed: 0.0444s/iter; left time: 1967.2346s
	iters: 300, epoch: 6 | loss: 0.0317290
	speed: 0.0484s/iter; left time: 2144.1345s
	iters: 400, epoch: 6 | loss: 0.0030774
	speed: 0.0463s/iter; left time: 2044.9877s
Epoch: 6 cost time: 23.90308165550232
Epoch: 6, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.951399 --> -0.955973).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0978299
	speed: 0.3285s/iter; left time: 14450.8144s
	iters: 200, epoch: 7 | loss: 0.0812192
	speed: 0.0415s/iter; left time: 1819.3231s
	iters: 300, epoch: 7 | loss: 0.0143761
	speed: 0.0432s/iter; left time: 1889.7749s
	iters: 400, epoch: 7 | loss: 0.0600392
	speed: 0.0508s/iter; left time: 2219.8913s
Epoch: 7 cost time: 21.911621809005737
Epoch: 7, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0655443
	speed: 0.3091s/iter; left time: 13452.8512s
	iters: 200, epoch: 8 | loss: 0.0051781
	speed: 0.0431s/iter; left time: 1873.4675s
	iters: 300, epoch: 8 | loss: 0.0105749
	speed: 0.0439s/iter; left time: 1902.4826s
	iters: 400, epoch: 8 | loss: 0.0657382
	speed: 0.0480s/iter; left time: 2075.9417s
Epoch: 8 cost time: 21.95769953727722
Epoch: 8, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.955973 --> -0.962834).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0009751
	speed: 0.2990s/iter; left time: 12872.3936s
	iters: 200, epoch: 9 | loss: 0.0121670
	speed: 0.0446s/iter; left time: 1914.5632s
	iters: 300, epoch: 9 | loss: 0.0031668
	speed: 0.0421s/iter; left time: 1802.4735s
	iters: 400, epoch: 9 | loss: 0.1284934
	speed: 0.0444s/iter; left time: 1897.0206s
Epoch: 9 cost time: 21.866422176361084
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.962834 --> -0.965121).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0113198
	speed: 0.3081s/iter; left time: 13120.6738s
	iters: 200, epoch: 10 | loss: 0.3266753
	speed: 0.0446s/iter; left time: 1894.1944s
	iters: 300, epoch: 10 | loss: 0.1014653
	speed: 0.0487s/iter; left time: 2064.4105s
	iters: 400, epoch: 10 | loss: 0.2575761
	speed: 0.0495s/iter; left time: 2092.4555s
Epoch: 10 cost time: 23.14602041244507
Epoch: 10, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0042009
	speed: 0.3379s/iter; left time: 14227.6445s
	iters: 200, epoch: 11 | loss: 0.0075403
	speed: 0.0475s/iter; left time: 1997.4526s
	iters: 300, epoch: 11 | loss: 0.0832027
	speed: 0.0479s/iter; left time: 2008.8152s
	iters: 400, epoch: 11 | loss: 0.1113794
	speed: 0.0534s/iter; left time: 2232.4507s
Epoch: 11 cost time: 24.281877756118774
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0661479
	speed: 0.3192s/iter; left time: 13290.8932s
	iters: 200, epoch: 12 | loss: 0.0074124
	speed: 0.0494s/iter; left time: 2053.0885s
	iters: 300, epoch: 12 | loss: 0.0693469
	speed: 0.0523s/iter; left time: 2167.7906s
	iters: 400, epoch: 12 | loss: 0.0010167
	speed: 0.0473s/iter; left time: 1954.8840s
Epoch: 12 cost time: 23.869977712631226
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0055250
	speed: 0.3399s/iter; left time: 13996.0691s
	iters: 200, epoch: 13 | loss: 0.1414864
	speed: 0.0474s/iter; left time: 1945.4522s
	iters: 300, epoch: 13 | loss: 0.0498370
	speed: 0.0499s/iter; left time: 2044.7617s
	iters: 400, epoch: 13 | loss: 0.0110438
	speed: 0.0482s/iter; left time: 1970.5260s
Epoch: 13 cost time: 23.818341732025146
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1055068
	speed: 0.3272s/iter; left time: 13317.8317s
	iters: 200, epoch: 14 | loss: 0.1820562
	speed: 0.0511s/iter; left time: 2075.6867s
	iters: 300, epoch: 14 | loss: 0.0317291
	speed: 0.0503s/iter; left time: 2035.7964s
	iters: 400, epoch: 14 | loss: 0.0066849
	speed: 0.0508s/iter; left time: 2054.0842s
Epoch: 14 cost time: 24.51550269126892
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
Validation loss decreased (-0.965121 --> -0.967980).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2850654
	speed: 0.3227s/iter; left time: 12983.3709s
	iters: 200, epoch: 15 | loss: 0.0008565
	speed: 0.0468s/iter; left time: 1878.5661s
	iters: 300, epoch: 15 | loss: 0.0025144
	speed: 0.0482s/iter; left time: 1931.5801s
	iters: 400, epoch: 15 | loss: 0.0598451
	speed: 0.0416s/iter; left time: 1660.3424s
Epoch: 15 cost time: 21.479788303375244
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0602883
	speed: 0.2916s/iter; left time: 11595.3203s
	iters: 200, epoch: 16 | loss: 0.0045337
	speed: 0.0431s/iter; left time: 1708.4244s
	iters: 300, epoch: 16 | loss: 0.0901115
	speed: 0.0459s/iter; left time: 1815.1901s
	iters: 400, epoch: 16 | loss: 0.0037454
	speed: 0.0446s/iter; left time: 1758.7803s
Epoch: 16 cost time: 21.932388067245483
Epoch: 16, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0121311
	speed: 0.2970s/iter; left time: 11671.2719s
	iters: 200, epoch: 17 | loss: 0.0125330
	speed: 0.0461s/iter; left time: 1807.9933s
	iters: 300, epoch: 17 | loss: 0.0064095
	speed: 0.0453s/iter; left time: 1772.1152s
	iters: 400, epoch: 17 | loss: 0.0012040
	speed: 0.0455s/iter; left time: 1773.2999s
Epoch: 17 cost time: 21.432124614715576
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0005260
	speed: 0.2925s/iter; left time: 11358.9168s
	iters: 200, epoch: 18 | loss: 0.0065821
	speed: 0.0434s/iter; left time: 1680.5731s
	iters: 300, epoch: 18 | loss: 0.0020767
	speed: 0.0517s/iter; left time: 1995.9750s
	iters: 400, epoch: 18 | loss: 0.0182869
	speed: 0.0485s/iter; left time: 1868.1875s
Epoch: 18 cost time: 22.91631269454956
Epoch: 18, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.174 Vali Acc: 0.966 Test Loss: 0.174 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0069312
	speed: 0.3152s/iter; left time: 12090.7917s
	iters: 200, epoch: 19 | loss: 0.0227221
	speed: 0.0420s/iter; left time: 1606.1227s
	iters: 300, epoch: 19 | loss: 0.0204021
	speed: 0.0419s/iter; left time: 1599.0245s
	iters: 400, epoch: 19 | loss: 0.0038962
	speed: 0.0484s/iter; left time: 1842.1681s
Epoch: 19 cost time: 22.329697847366333
Epoch: 19, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0456967
	speed: 0.3300s/iter; left time: 12503.4738s
	iters: 200, epoch: 20 | loss: 0.0048150
	speed: 0.0510s/iter; left time: 1927.1474s
	iters: 300, epoch: 20 | loss: 0.0001421
	speed: 0.0472s/iter; left time: 1780.7774s
	iters: 400, epoch: 20 | loss: 0.0052533
	speed: 0.0465s/iter; left time: 1747.9099s
Epoch: 20 cost time: 23.818954467773438
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.182 Vali Acc: 0.961 Test Loss: 0.182 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0109328
	speed: 0.3182s/iter; left time: 11907.7371s
	iters: 200, epoch: 21 | loss: 0.3067360
	speed: 0.0486s/iter; left time: 1814.9707s
	iters: 300, epoch: 21 | loss: 0.9398623
	speed: 0.0436s/iter; left time: 1621.9677s
	iters: 400, epoch: 21 | loss: 0.0033449
	speed: 0.0469s/iter; left time: 1742.0542s
Epoch: 21 cost time: 23.11564326286316
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0578105
	speed: 0.3267s/iter; left time: 12071.2814s
	iters: 200, epoch: 22 | loss: 0.0007140
	speed: 0.0482s/iter; left time: 1776.1673s
	iters: 300, epoch: 22 | loss: 0.0511842
	speed: 0.0493s/iter; left time: 1813.6427s
	iters: 400, epoch: 22 | loss: 0.0015180
	speed: 0.0427s/iter; left time: 1564.8359s
Epoch: 22 cost time: 23.184725999832153
Epoch: 22, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0019024
	speed: 0.3233s/iter; left time: 11795.4832s
	iters: 200, epoch: 23 | loss: 0.0311302
	speed: 0.0379s/iter; left time: 1378.5416s
	iters: 300, epoch: 23 | loss: 0.0056324
	speed: 0.0459s/iter; left time: 1663.9065s
	iters: 400, epoch: 23 | loss: 0.0033409
	speed: 0.0421s/iter; left time: 1521.9702s
Epoch: 23 cost time: 21.728407621383667
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0098274
	speed: 0.3005s/iter; left time: 10822.8476s
	iters: 200, epoch: 24 | loss: 0.0027732
	speed: 0.0377s/iter; left time: 1352.3415s
	iters: 300, epoch: 24 | loss: 0.0001529
	speed: 0.0415s/iter; left time: 1485.8406s
	iters: 400, epoch: 24 | loss: 0.0034293
	speed: 0.0445s/iter; left time: 1589.1947s
Epoch: 24 cost time: 20.279295444488525
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
Validation loss decreased (-0.967980 --> -0.971125).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.3106349
	speed: 0.3051s/iter; left time: 10844.7384s
	iters: 200, epoch: 25 | loss: 0.0033031
	speed: 0.0454s/iter; left time: 1607.4936s
	iters: 300, epoch: 25 | loss: 0.1352173
	speed: 0.0451s/iter; left time: 1595.6888s
	iters: 400, epoch: 25 | loss: 0.0005211
	speed: 0.0481s/iter; left time: 1694.0674s
Epoch: 25 cost time: 22.476069688796997
Epoch: 25, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
Validation loss decreased (-0.971125 --> -0.973984).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0024060
	speed: 0.3152s/iter; left time: 11054.8447s
	iters: 200, epoch: 26 | loss: 0.0057293
	speed: 0.0516s/iter; left time: 1806.2292s
	iters: 300, epoch: 26 | loss: 0.0003028
	speed: 0.0438s/iter; left time: 1528.3082s
	iters: 400, epoch: 26 | loss: 0.0159706
	speed: 0.0480s/iter; left time: 1670.6377s
Epoch: 26 cost time: 23.12976050376892
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0013718
	speed: 0.3104s/iter; left time: 10740.5407s
	iters: 200, epoch: 27 | loss: 0.0064454
	speed: 0.0468s/iter; left time: 1614.3154s
	iters: 300, epoch: 27 | loss: 0.0609246
	speed: 0.0477s/iter; left time: 1639.7554s
	iters: 400, epoch: 27 | loss: 0.0026076
	speed: 0.0483s/iter; left time: 1658.5886s
Epoch: 27 cost time: 23.033416271209717
Epoch: 27, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0004128
	speed: 0.3152s/iter; left time: 10761.0199s
	iters: 200, epoch: 28 | loss: 0.0046764
	speed: 0.0464s/iter; left time: 1578.5887s
	iters: 300, epoch: 28 | loss: 0.1548398
	speed: 0.0431s/iter; left time: 1461.1189s
	iters: 400, epoch: 28 | loss: 0.2580357
	speed: 0.0460s/iter; left time: 1555.5102s
Epoch: 28 cost time: 22.84234356880188
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0006699
	speed: 0.3367s/iter; left time: 11335.6632s
	iters: 200, epoch: 29 | loss: 0.0010077
	speed: 0.0447s/iter; left time: 1502.1315s
	iters: 300, epoch: 29 | loss: 0.0039081
	speed: 0.0464s/iter; left time: 1552.2346s
	iters: 400, epoch: 29 | loss: 0.0120309
	speed: 0.0488s/iter; left time: 1628.3255s
Epoch: 29 cost time: 22.781829595565796
Epoch: 29, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.961 Test Loss: 0.226 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0384812
	speed: 0.3043s/iter; left time: 10104.0556s
	iters: 200, epoch: 30 | loss: 0.1024354
	speed: 0.0466s/iter; left time: 1542.3171s
	iters: 300, epoch: 30 | loss: 0.1195266
	speed: 0.0479s/iter; left time: 1580.0415s
	iters: 400, epoch: 30 | loss: 0.0096406
	speed: 0.0452s/iter; left time: 1488.5587s
Epoch: 30 cost time: 22.599558115005493
Epoch: 30, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0001989
	speed: 0.3222s/iter; left time: 10547.3163s
	iters: 200, epoch: 31 | loss: 0.0844015
	speed: 0.0501s/iter; left time: 1635.6141s
	iters: 300, epoch: 31 | loss: 0.0079188
	speed: 0.0457s/iter; left time: 1486.9203s
	iters: 400, epoch: 31 | loss: 0.0007126
	speed: 0.0414s/iter; left time: 1343.4019s
Epoch: 31 cost time: 21.54525899887085
Epoch: 31, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0477290
	speed: 0.2392s/iter; left time: 7718.4953s
	iters: 200, epoch: 32 | loss: 0.0091806
	speed: 0.0354s/iter; left time: 1137.6596s
	iters: 300, epoch: 32 | loss: 0.0115873
	speed: 0.0301s/iter; left time: 963.5259s
	iters: 400, epoch: 32 | loss: 0.0003888
	speed: 0.0348s/iter; left time: 1112.1553s
Epoch: 32 cost time: 17.421589851379395
Epoch: 32, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.973984 --> -0.976557).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0482252
	speed: 0.2506s/iter; left time: 7966.4153s
	iters: 200, epoch: 33 | loss: 0.0001341
	speed: 0.0413s/iter; left time: 1310.4551s
	iters: 300, epoch: 33 | loss: 0.0149824
	speed: 0.0469s/iter; left time: 1482.0959s
	iters: 400, epoch: 33 | loss: 0.1435891
	speed: 0.0439s/iter; left time: 1383.8163s
Epoch: 33 cost time: 20.91983699798584
Epoch: 33, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0243847
	speed: 0.2488s/iter; left time: 7794.7769s
	iters: 200, epoch: 34 | loss: 0.0004639
	speed: 0.0381s/iter; left time: 1190.1517s
	iters: 300, epoch: 34 | loss: 0.0058610
	speed: 0.0463s/iter; left time: 1441.9528s
	iters: 400, epoch: 34 | loss: 0.0023430
	speed: 0.0396s/iter; left time: 1230.0490s
Epoch: 34 cost time: 19.899245738983154
Epoch: 34, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0003757
	speed: 0.2946s/iter; left time: 9088.8627s
	iters: 200, epoch: 35 | loss: 0.0002220
	speed: 0.0427s/iter; left time: 1313.8453s
	iters: 300, epoch: 35 | loss: 0.2765378
	speed: 0.0463s/iter; left time: 1419.6852s
	iters: 400, epoch: 35 | loss: 0.0048713
	speed: 0.0442s/iter; left time: 1351.4350s
Epoch: 35 cost time: 21.916322231292725
Epoch: 35, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.169 Vali Acc: 0.966 Test Loss: 0.169 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0004491
	speed: 0.3185s/iter; left time: 9677.6242s
	iters: 200, epoch: 36 | loss: 0.0101974
	speed: 0.0463s/iter; left time: 1402.0476s
	iters: 300, epoch: 36 | loss: 0.0058313
	speed: 0.0477s/iter; left time: 1441.3413s
	iters: 400, epoch: 36 | loss: 0.0061703
	speed: 0.0429s/iter; left time: 1289.8496s
Epoch: 36 cost time: 22.43734049797058
Epoch: 36, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0008346
	speed: 0.3197s/iter; left time: 9565.3467s
	iters: 200, epoch: 37 | loss: 0.0003186
	speed: 0.0442s/iter; left time: 1317.9278s
	iters: 300, epoch: 37 | loss: 0.0008742
	speed: 0.0446s/iter; left time: 1324.0661s
	iters: 400, epoch: 37 | loss: 0.0032695
	speed: 0.0419s/iter; left time: 1240.5954s
Epoch: 37 cost time: 22.106298446655273
Epoch: 37, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0009324
	speed: 0.3026s/iter; left time: 8910.3940s
	iters: 200, epoch: 38 | loss: 0.0827339
	speed: 0.0431s/iter; left time: 1263.8426s
	iters: 300, epoch: 38 | loss: 0.0078803
	speed: 0.0429s/iter; left time: 1255.0069s
	iters: 400, epoch: 38 | loss: 0.0646716
	speed: 0.0459s/iter; left time: 1338.5371s
Epoch: 38 cost time: 21.33977746963501
Epoch: 38, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0045553
	speed: 0.3085s/iter; left time: 8940.2259s
	iters: 200, epoch: 39 | loss: 0.0071972
	speed: 0.0447s/iter; left time: 1290.8429s
	iters: 300, epoch: 39 | loss: 0.1131489
	speed: 0.0444s/iter; left time: 1278.4406s
	iters: 400, epoch: 39 | loss: 0.0115133
	speed: 0.0469s/iter; left time: 1344.0426s
Epoch: 39 cost time: 21.852322816848755
Epoch: 39, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0873074
	speed: 0.3156s/iter; left time: 8996.7949s
	iters: 200, epoch: 40 | loss: 0.0003199
	speed: 0.0464s/iter; left time: 1318.5477s
	iters: 300, epoch: 40 | loss: 0.0008263
	speed: 0.0486s/iter; left time: 1376.1615s
	iters: 400, epoch: 40 | loss: 0.0227514
	speed: 0.0433s/iter; left time: 1220.8945s
Epoch: 40 cost time: 23.465787172317505
Epoch: 40, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0589700
	speed: 0.3065s/iter; left time: 8594.2388s
	iters: 200, epoch: 41 | loss: 0.0789271
	speed: 0.0453s/iter; left time: 1265.1700s
	iters: 300, epoch: 41 | loss: 0.0075805
	speed: 0.0429s/iter; left time: 1194.5160s
	iters: 400, epoch: 41 | loss: 0.0100187
	speed: 0.0423s/iter; left time: 1173.4363s
Epoch: 41 cost time: 21.600586652755737
Epoch: 41, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0037943
	speed: 0.2654s/iter; left time: 7317.4300s
	iters: 200, epoch: 42 | loss: 0.0003634
	speed: 0.0551s/iter; left time: 1513.1109s
	iters: 300, epoch: 42 | loss: 0.0054879
	speed: 0.0430s/iter; left time: 1176.9245s
	iters: 400, epoch: 42 | loss: 0.0254926
	speed: 0.0408s/iter; left time: 1112.5995s
Epoch: 42 cost time: 21.832051753997803
Epoch: 42, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 21866
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7072742
	speed: 0.0789s/iter; left time: 3694.6888s
	iters: 200, epoch: 1 | loss: 0.8532196
	speed: 0.0468s/iter; left time: 2184.5449s
	iters: 300, epoch: 1 | loss: 0.9823834
	speed: 0.0470s/iter; left time: 2192.0715s
	iters: 400, epoch: 1 | loss: 0.6472687
	speed: 0.0448s/iter; left time: 2084.7932s
Epoch: 1 cost time: 25.179603576660156
Epoch: 1, Steps: 469 | Train Loss: 1.107 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
Validation loss decreased (inf --> -0.848194).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4032071
	speed: 0.3038s/iter; left time: 14075.0123s
	iters: 200, epoch: 2 | loss: 0.4427537
	speed: 0.0501s/iter; left time: 2315.7577s
	iters: 300, epoch: 2 | loss: 0.1469141
	speed: 0.0423s/iter; left time: 1953.3581s
	iters: 400, epoch: 2 | loss: 0.1065987
	speed: 0.0465s/iter; left time: 2142.2609s
Epoch: 2 cost time: 21.938303470611572
Epoch: 2, Steps: 469 | Train Loss: 0.333 Vali Loss: 0.306 Vali Acc: 0.923 Test Loss: 0.306 Test Acc: 0.923
Validation loss decreased (-0.848194 --> -0.923096).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0630275
	speed: 0.2864s/iter; left time: 13136.4536s
	iters: 200, epoch: 3 | loss: 0.2623314
	speed: 0.0412s/iter; left time: 1885.8866s
	iters: 300, epoch: 3 | loss: 0.3821111
	speed: 0.0403s/iter; left time: 1840.7044s
	iters: 400, epoch: 3 | loss: 0.1042129
	speed: 0.0366s/iter; left time: 1669.2741s
Epoch: 3 cost time: 19.497782707214355
Epoch: 3, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.923096 --> -0.950255).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1030448
	speed: 0.2950s/iter; left time: 13390.8348s
	iters: 200, epoch: 4 | loss: 0.0845518
	speed: 0.0396s/iter; left time: 1795.7662s
	iters: 300, epoch: 4 | loss: 0.0700793
	speed: 0.0422s/iter; left time: 1908.3128s
	iters: 400, epoch: 4 | loss: 0.0722294
	speed: 0.0428s/iter; left time: 1931.7404s
Epoch: 4 cost time: 21.134032249450684
Epoch: 4, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.950255 --> -0.952257).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0640055
	speed: 0.3098s/iter; left time: 13917.9593s
	iters: 200, epoch: 5 | loss: 0.0336814
	speed: 0.0437s/iter; left time: 1957.5451s
	iters: 300, epoch: 5 | loss: 0.1474489
	speed: 0.0515s/iter; left time: 2304.1459s
	iters: 400, epoch: 5 | loss: 0.0179266
	speed: 0.0484s/iter; left time: 2160.6236s
Epoch: 5 cost time: 22.58603835105896
Epoch: 5, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.952257 --> -0.957974).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0095998
	speed: 0.2972s/iter; left time: 13211.4607s
	iters: 200, epoch: 6 | loss: 0.0244915
	speed: 0.0486s/iter; left time: 2153.5150s
	iters: 300, epoch: 6 | loss: 0.0198171
	speed: 0.0490s/iter; left time: 2166.4103s
	iters: 400, epoch: 6 | loss: 0.0854837
	speed: 0.0493s/iter; left time: 2175.8267s
Epoch: 6 cost time: 22.506337642669678
Epoch: 6, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.957974 --> -0.958546).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0540312
	speed: 0.3123s/iter; left time: 13735.4246s
	iters: 200, epoch: 7 | loss: 0.5978920
	speed: 0.0432s/iter; left time: 1895.3583s
	iters: 300, epoch: 7 | loss: 0.6822965
	speed: 0.0408s/iter; left time: 1787.4531s
	iters: 400, epoch: 7 | loss: 0.0652714
	speed: 0.0439s/iter; left time: 1919.3948s
Epoch: 7 cost time: 21.468742847442627
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6638733
	speed: 0.2956s/iter; left time: 12864.4855s
	iters: 200, epoch: 8 | loss: 0.1574510
	speed: 0.0424s/iter; left time: 1840.2815s
	iters: 300, epoch: 8 | loss: 0.1178081
	speed: 0.0481s/iter; left time: 2084.5190s
	iters: 400, epoch: 8 | loss: 0.1471339
	speed: 0.0508s/iter; left time: 2196.2428s
Epoch: 8 cost time: 22.351269483566284
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
Validation loss decreased (-0.958546 --> -0.965693).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0241821
	speed: 0.3285s/iter; left time: 14140.7794s
	iters: 200, epoch: 9 | loss: 0.0023315
	speed: 0.0479s/iter; left time: 2055.2057s
	iters: 300, epoch: 9 | loss: 0.0025927
	speed: 0.0447s/iter; left time: 1916.8909s
	iters: 400, epoch: 9 | loss: 0.0027505
	speed: 0.0419s/iter; left time: 1791.0182s
Epoch: 9 cost time: 21.952796936035156
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0179714
	speed: 0.2933s/iter; left time: 12486.9864s
	iters: 200, epoch: 10 | loss: 0.0187592
	speed: 0.0469s/iter; left time: 1992.5490s
	iters: 300, epoch: 10 | loss: 0.0036312
	speed: 0.0443s/iter; left time: 1877.5663s
	iters: 400, epoch: 10 | loss: 0.0354071
	speed: 0.0425s/iter; left time: 1796.1162s
Epoch: 10 cost time: 22.188887119293213
Epoch: 10, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0031745
	speed: 0.2985s/iter; left time: 12568.7858s
	iters: 200, epoch: 11 | loss: 0.0457528
	speed: 0.0514s/iter; left time: 2158.3546s
	iters: 300, epoch: 11 | loss: 0.0096604
	speed: 0.0417s/iter; left time: 1749.5292s
	iters: 400, epoch: 11 | loss: 0.0549786
	speed: 0.0451s/iter; left time: 1885.4821s
Epoch: 11 cost time: 22.491390466690063
Epoch: 11, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.965693 --> -0.969981).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1079404
	speed: 0.3106s/iter; left time: 12935.4335s
	iters: 200, epoch: 12 | loss: 0.0139727
	speed: 0.0458s/iter; left time: 1904.4258s
	iters: 300, epoch: 12 | loss: 0.0204595
	speed: 0.0406s/iter; left time: 1683.1941s
	iters: 400, epoch: 12 | loss: 0.0119369
	speed: 0.0492s/iter; left time: 2032.9734s
Epoch: 12 cost time: 22.44452691078186
Epoch: 12, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2783074
	speed: 0.3053s/iter; left time: 12571.9443s
	iters: 200, epoch: 13 | loss: 0.0060134
	speed: 0.0475s/iter; left time: 1951.0790s
	iters: 300, epoch: 13 | loss: 0.0086925
	speed: 0.0510s/iter; left time: 2090.9594s
	iters: 400, epoch: 13 | loss: 0.0892348
	speed: 0.0447s/iter; left time: 1826.6567s
Epoch: 13 cost time: 22.69446110725403
Epoch: 13, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0405940
	speed: 0.2944s/iter; left time: 11984.7518s
	iters: 200, epoch: 14 | loss: 0.0108864
	speed: 0.0443s/iter; left time: 1799.6306s
	iters: 300, epoch: 14 | loss: 0.0198162
	speed: 0.0486s/iter; left time: 1969.0862s
	iters: 400, epoch: 14 | loss: 0.0511126
	speed: 0.0412s/iter; left time: 1664.8358s
Epoch: 14 cost time: 21.583985805511475
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0033148
	speed: 0.3057s/iter; left time: 12300.8945s
	iters: 200, epoch: 15 | loss: 0.0200060
	speed: 0.0446s/iter; left time: 1789.0925s
	iters: 300, epoch: 15 | loss: 0.0030414
	speed: 0.0435s/iter; left time: 1742.8488s
	iters: 400, epoch: 15 | loss: 0.0048235
	speed: 0.0409s/iter; left time: 1634.0705s
Epoch: 15 cost time: 21.46265697479248
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0242877
	speed: 0.3298s/iter; left time: 13113.7644s
	iters: 200, epoch: 16 | loss: 0.0089864
	speed: 0.0431s/iter; left time: 1709.6550s
	iters: 300, epoch: 16 | loss: 0.0007764
	speed: 0.0476s/iter; left time: 1884.6337s
	iters: 400, epoch: 16 | loss: 0.5045823
	speed: 0.0500s/iter; left time: 1973.2997s
Epoch: 16 cost time: 22.854706287384033
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.181 Vali Acc: 0.968 Test Loss: 0.181 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0154178
	speed: 0.3030s/iter; left time: 11907.9305s
	iters: 200, epoch: 17 | loss: 0.1078220
	speed: 0.0411s/iter; left time: 1610.2538s
	iters: 300, epoch: 17 | loss: 0.0030082
	speed: 0.0450s/iter; left time: 1760.1070s
	iters: 400, epoch: 17 | loss: 0.0038393
	speed: 0.0419s/iter; left time: 1635.2096s
Epoch: 17 cost time: 21.311987161636353
Epoch: 17, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.966 Test Loss: 0.195 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0529375
	speed: 0.3134s/iter; left time: 12168.5127s
	iters: 200, epoch: 18 | loss: 0.0421074
	speed: 0.0405s/iter; left time: 1569.6089s
	iters: 300, epoch: 18 | loss: 0.1778422
	speed: 0.0448s/iter; left time: 1730.6906s
	iters: 400, epoch: 18 | loss: 0.0220628
	speed: 0.0395s/iter; left time: 1522.7771s
Epoch: 18 cost time: 20.74928069114685
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.966 Test Loss: 0.199 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0511383
	speed: 0.3028s/iter; left time: 11613.4003s
	iters: 200, epoch: 19 | loss: 0.1274399
	speed: 0.0443s/iter; left time: 1696.0050s
	iters: 300, epoch: 19 | loss: 0.0023286
	speed: 0.0441s/iter; left time: 1681.4946s
	iters: 400, epoch: 19 | loss: 0.0162795
	speed: 0.0423s/iter; left time: 1610.2562s
Epoch: 19 cost time: 22.029176712036133
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.178 Vali Acc: 0.968 Test Loss: 0.178 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0021896
	speed: 0.3149s/iter; left time: 11931.0832s
	iters: 200, epoch: 20 | loss: 0.0025663
	speed: 0.0448s/iter; left time: 1691.3123s
	iters: 300, epoch: 20 | loss: 0.0019433
	speed: 0.0453s/iter; left time: 1706.9043s
	iters: 400, epoch: 20 | loss: 0.0021978
	speed: 0.0422s/iter; left time: 1586.1413s
Epoch: 20 cost time: 21.906150102615356
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0037897
	speed: 0.3075s/iter; left time: 11508.8002s
	iters: 200, epoch: 21 | loss: 0.0015933
	speed: 0.0381s/iter; left time: 1422.9154s
	iters: 300, epoch: 21 | loss: 0.0017971
	speed: 0.0418s/iter; left time: 1556.5448s
	iters: 400, epoch: 21 | loss: 0.0039375
	speed: 0.0418s/iter; left time: 1550.1737s
Epoch: 21 cost time: 20.30202031135559
Epoch: 21, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
Validation loss decreased (-0.969981 --> -0.971697).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1619288
	speed: 0.3034s/iter; left time: 11210.2937s
	iters: 200, epoch: 22 | loss: 0.0019997
	speed: 0.0380s/iter; left time: 1400.2177s
	iters: 300, epoch: 22 | loss: 0.0014868
	speed: 0.0442s/iter; left time: 1624.0988s
	iters: 400, epoch: 22 | loss: 0.0041878
	speed: 0.0486s/iter; left time: 1780.3235s
Epoch: 22 cost time: 21.28295922279358
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.971697 --> -0.972268).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0011446
	speed: 0.3011s/iter; left time: 10984.7536s
	iters: 200, epoch: 23 | loss: 0.0320469
	speed: 0.0442s/iter; left time: 1606.7929s
	iters: 300, epoch: 23 | loss: 0.0009813
	speed: 0.0473s/iter; left time: 1714.7819s
	iters: 400, epoch: 23 | loss: 0.0475365
	speed: 0.0477s/iter; left time: 1726.1834s
Epoch: 23 cost time: 22.361795663833618
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0011213
	speed: 0.2999s/iter; left time: 10801.0770s
	iters: 200, epoch: 24 | loss: 0.1478004
	speed: 0.0452s/iter; left time: 1624.8470s
	iters: 300, epoch: 24 | loss: 0.3578474
	speed: 0.0425s/iter; left time: 1520.5194s
	iters: 400, epoch: 24 | loss: 0.0002708
	speed: 0.0463s/iter; left time: 1653.7645s
Epoch: 24 cost time: 22.146966695785522
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0027297
	speed: 0.2811s/iter; left time: 9992.8995s
	iters: 200, epoch: 25 | loss: 0.0015603
	speed: 0.0407s/iter; left time: 1444.0079s
	iters: 300, epoch: 25 | loss: 0.0130890
	speed: 0.0421s/iter; left time: 1486.7564s
	iters: 400, epoch: 25 | loss: 0.0822577
	speed: 0.0466s/iter; left time: 1643.1661s
Epoch: 25 cost time: 20.68934965133667
Epoch: 25, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.968 Test Loss: 0.172 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.3490528
	speed: 0.3131s/iter; left time: 10983.8255s
	iters: 200, epoch: 26 | loss: 0.0023166
	speed: 0.0473s/iter; left time: 1656.0690s
	iters: 300, epoch: 26 | loss: 0.0068175
	speed: 0.0472s/iter; left time: 1647.0531s
	iters: 400, epoch: 26 | loss: 0.0004061
	speed: 0.0479s/iter; left time: 1665.4913s
Epoch: 26 cost time: 22.50015687942505
Epoch: 26, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.972268 --> -0.972554).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0182729
	speed: 0.3357s/iter; left time: 11618.5556s
	iters: 200, epoch: 27 | loss: 0.0077416
	speed: 0.0539s/iter; left time: 1861.0549s
	iters: 300, epoch: 27 | loss: 0.2021876
	speed: 0.0499s/iter; left time: 1717.6678s
	iters: 400, epoch: 27 | loss: 0.0147613
	speed: 0.0571s/iter; left time: 1957.2915s
Epoch: 27 cost time: 26.07336115837097
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0094782
	speed: 0.4004s/iter; left time: 13667.1670s
	iters: 200, epoch: 28 | loss: 0.0065366
	speed: 0.0654s/iter; left time: 2226.1486s
	iters: 300, epoch: 28 | loss: 0.0073176
	speed: 0.0654s/iter; left time: 2219.0828s
	iters: 400, epoch: 28 | loss: 0.0330968
	speed: 0.0578s/iter; left time: 1955.4583s
Epoch: 28 cost time: 31.131319761276245
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0014549
	speed: 0.3987s/iter; left time: 13423.1499s
	iters: 200, epoch: 29 | loss: 0.0103021
	speed: 0.0575s/iter; left time: 1929.1289s
	iters: 300, epoch: 29 | loss: 0.0305776
	speed: 0.0661s/iter; left time: 2213.7964s
	iters: 400, epoch: 29 | loss: 0.0003076
	speed: 0.0645s/iter; left time: 2153.2840s
Epoch: 29 cost time: 29.662155389785767
Epoch: 29, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.1174634
	speed: 0.3938s/iter; left time: 13074.5083s
	iters: 200, epoch: 30 | loss: 0.0172904
	speed: 0.0573s/iter; left time: 1897.1543s
	iters: 300, epoch: 30 | loss: 0.0002583
	speed: 0.0633s/iter; left time: 2088.4749s
	iters: 400, epoch: 30 | loss: 0.0034353
	speed: 0.0597s/iter; left time: 1963.6251s
Epoch: 30 cost time: 30.13090944290161
Epoch: 30, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0143002
	speed: 0.3937s/iter; left time: 12887.4150s
	iters: 200, epoch: 31 | loss: 0.0144450
	speed: 0.0661s/iter; left time: 2157.0523s
	iters: 300, epoch: 31 | loss: 0.0007611
	speed: 0.0536s/iter; left time: 1743.6011s
	iters: 400, epoch: 31 | loss: 0.0097461
	speed: 0.0662s/iter; left time: 2145.8449s
Epoch: 31 cost time: 30.10943293571472
Epoch: 31, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0013488
	speed: 0.3831s/iter; left time: 12358.5229s
	iters: 200, epoch: 32 | loss: 0.0019553
	speed: 0.0593s/iter; left time: 1907.1543s
	iters: 300, epoch: 32 | loss: 0.0012105
	speed: 0.0608s/iter; left time: 1949.6257s
	iters: 400, epoch: 32 | loss: 0.0561645
	speed: 0.0550s/iter; left time: 1758.9354s
Epoch: 32 cost time: 28.45044445991516
Epoch: 32, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0007823
	speed: 0.3741s/iter; left time: 11894.6274s
	iters: 200, epoch: 33 | loss: 0.0018557
	speed: 0.0529s/iter; left time: 1676.7621s
	iters: 300, epoch: 33 | loss: 0.0032741
	speed: 0.0624s/iter; left time: 1972.0327s
	iters: 400, epoch: 33 | loss: 0.0017260
	speed: 0.0512s/iter; left time: 1613.2569s
Epoch: 33 cost time: 27.037160873413086
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0023229
	speed: 0.3704s/iter; left time: 11602.5026s
	iters: 200, epoch: 34 | loss: 0.0019149
	speed: 0.0478s/iter; left time: 1491.3640s
	iters: 300, epoch: 34 | loss: 0.0000932
	speed: 0.0539s/iter; left time: 1676.1639s
	iters: 400, epoch: 34 | loss: 0.0012841
	speed: 0.0440s/iter; left time: 1365.1980s
Epoch: 34 cost time: 23.462515592575073
Epoch: 34, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
Validation loss decreased (-0.972554 --> -0.973126).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.1229023
	speed: 0.3078s/iter; left time: 9496.7146s
	iters: 200, epoch: 35 | loss: 0.0281503
	speed: 0.0470s/iter; left time: 1446.1585s
	iters: 300, epoch: 35 | loss: 0.0006198
	speed: 0.0509s/iter; left time: 1561.0382s
	iters: 400, epoch: 35 | loss: 0.0021825
	speed: 0.0446s/iter; left time: 1361.2735s
Epoch: 35 cost time: 22.959283113479614
Epoch: 35, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.971 Test Loss: 0.183 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0032958
	speed: 0.2971s/iter; left time: 9027.0022s
	iters: 200, epoch: 36 | loss: 0.0121042
	speed: 0.0404s/iter; left time: 1223.6018s
	iters: 300, epoch: 36 | loss: 0.0006298
	speed: 0.0407s/iter; left time: 1229.8598s
	iters: 400, epoch: 36 | loss: 0.0024745
	speed: 0.0488s/iter; left time: 1466.8012s
Epoch: 36 cost time: 21.345956563949585
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0002042
	speed: 0.3103s/iter; left time: 9283.4578s
	iters: 200, epoch: 37 | loss: 0.0969810
	speed: 0.0476s/iter; left time: 1418.2226s
	iters: 300, epoch: 37 | loss: 0.0021953
	speed: 0.0490s/iter; left time: 1455.5005s
	iters: 400, epoch: 37 | loss: 0.0001484
	speed: 0.0448s/iter; left time: 1325.7063s
Epoch: 37 cost time: 22.867680072784424
Epoch: 37, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.966 Test Loss: 0.207 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0005894
	speed: 0.3201s/iter; left time: 9427.1399s
	iters: 200, epoch: 38 | loss: 0.0014626
	speed: 0.0484s/iter; left time: 1421.5231s
	iters: 300, epoch: 38 | loss: 0.0002270
	speed: 0.0448s/iter; left time: 1309.9049s
	iters: 400, epoch: 38 | loss: 0.0690613
	speed: 0.0448s/iter; left time: 1305.6547s
Epoch: 38 cost time: 22.424057245254517
Epoch: 38, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0002051
	speed: 0.3076s/iter; left time: 8913.7628s
	iters: 200, epoch: 39 | loss: 0.0002945
	speed: 0.0483s/iter; left time: 1395.0355s
	iters: 300, epoch: 39 | loss: 0.0041161
	speed: 0.0471s/iter; left time: 1355.1743s
	iters: 400, epoch: 39 | loss: 0.0321011
	speed: 0.0503s/iter; left time: 1441.6530s
Epoch: 39 cost time: 23.8436861038208
Epoch: 39, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.192 Vali Acc: 0.971 Test Loss: 0.192 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0017612
	speed: 0.3269s/iter; left time: 9319.6370s
	iters: 200, epoch: 40 | loss: 0.0098308
	speed: 0.0491s/iter; left time: 1395.8259s
	iters: 300, epoch: 40 | loss: 0.0019030
	speed: 0.0533s/iter; left time: 1509.6648s
	iters: 400, epoch: 40 | loss: 0.0038124
	speed: 0.0461s/iter; left time: 1300.1661s
Epoch: 40 cost time: 23.594069957733154
Epoch: 40, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0980544
	speed: 0.3293s/iter; left time: 9235.1735s
	iters: 200, epoch: 41 | loss: 0.0017447
	speed: 0.0533s/iter; left time: 1490.4301s
	iters: 300, epoch: 41 | loss: 0.0008134
	speed: 0.0453s/iter; left time: 1261.5964s
	iters: 400, epoch: 41 | loss: 0.0034751
	speed: 0.0489s/iter; left time: 1355.7257s
Epoch: 41 cost time: 23.565250873565674
Epoch: 41, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.2133245
	speed: 0.3254s/iter; left time: 8973.0878s
	iters: 200, epoch: 42 | loss: 0.0000710
	speed: 0.0544s/iter; left time: 1494.6691s
	iters: 300, epoch: 42 | loss: 0.0256208
	speed: 0.0495s/iter; left time: 1354.9206s
	iters: 400, epoch: 42 | loss: 0.2545535
	speed: 0.0496s/iter; left time: 1354.0349s
Epoch: 42 cost time: 24.056752920150757
Epoch: 42, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.973126 --> -0.974841).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0003448
	speed: 0.3410s/iter; left time: 9240.7696s
	iters: 200, epoch: 43 | loss: 0.0005539
	speed: 0.0445s/iter; left time: 1202.2458s
	iters: 300, epoch: 43 | loss: 0.0017154
	speed: 0.0478s/iter; left time: 1286.4608s
	iters: 400, epoch: 43 | loss: 0.0228380
	speed: 0.0476s/iter; left time: 1275.9636s
Epoch: 43 cost time: 23.31619429588318
Epoch: 43, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0018752
	speed: 0.3202s/iter; left time: 8527.2701s
	iters: 200, epoch: 44 | loss: 0.0004686
	speed: 0.0464s/iter; left time: 1232.2722s
	iters: 300, epoch: 44 | loss: 0.0001559
	speed: 0.0476s/iter; left time: 1257.2394s
	iters: 400, epoch: 44 | loss: 0.0882013
	speed: 0.0514s/iter; left time: 1352.3204s
Epoch: 44 cost time: 23.41531753540039
Epoch: 44, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0169471
	speed: 0.3437s/iter; left time: 8993.4989s
	iters: 200, epoch: 45 | loss: 0.0020518
	speed: 0.0438s/iter; left time: 1140.7325s
	iters: 300, epoch: 45 | loss: 0.0002395
	speed: 0.0421s/iter; left time: 1092.4992s
	iters: 400, epoch: 45 | loss: 0.0021057
	speed: 0.0449s/iter; left time: 1160.9570s
Epoch: 45 cost time: 22.573845386505127
Epoch: 45, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0009624
	speed: 0.3165s/iter; left time: 8133.8533s
	iters: 200, epoch: 46 | loss: 0.0004957
	speed: 0.0441s/iter; left time: 1129.9354s
	iters: 300, epoch: 46 | loss: 0.0094512
	speed: 0.0485s/iter; left time: 1237.7355s
	iters: 400, epoch: 46 | loss: 0.0025251
	speed: 0.0531s/iter; left time: 1348.4547s
Epoch: 46 cost time: 23.642083168029785
Epoch: 46, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.0016304
	speed: 0.3244s/iter; left time: 8184.4975s
	iters: 200, epoch: 47 | loss: 0.0014877
	speed: 0.0483s/iter; left time: 1213.0169s
	iters: 300, epoch: 47 | loss: 0.0224834
	speed: 0.0517s/iter; left time: 1293.9801s
	iters: 400, epoch: 47 | loss: 0.0049008
	speed: 0.0519s/iter; left time: 1293.2280s
Epoch: 47 cost time: 23.75105309486389
Epoch: 47, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 0.0073843
	speed: 0.3188s/iter; left time: 7892.0297s
	iters: 200, epoch: 48 | loss: 0.0099722
	speed: 0.0561s/iter; left time: 1384.0175s
	iters: 300, epoch: 48 | loss: 0.0021156
	speed: 0.0506s/iter; left time: 1242.1649s
	iters: 400, epoch: 48 | loss: 0.0004483
	speed: 0.0483s/iter; left time: 1181.6327s
Epoch: 48 cost time: 23.993480920791626
Epoch: 48, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 0.0054627
	speed: 0.3253s/iter; left time: 7902.2765s
	iters: 200, epoch: 49 | loss: 0.0034059
	speed: 0.0506s/iter; left time: 1224.4539s
	iters: 300, epoch: 49 | loss: 0.0004226
	speed: 0.0489s/iter; left time: 1177.2440s
	iters: 400, epoch: 49 | loss: 0.0000985
	speed: 0.0485s/iter; left time: 1162.5085s
Epoch: 49 cost time: 23.77030897140503
Epoch: 49, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.0008062
	speed: 0.3330s/iter; left time: 7933.0336s
	iters: 200, epoch: 50 | loss: 0.0034030
	speed: 0.0524s/iter; left time: 1243.4769s
	iters: 300, epoch: 50 | loss: 0.0865829
	speed: 0.0453s/iter; left time: 1069.2477s
	iters: 400, epoch: 50 | loss: 0.0002621
	speed: 0.0498s/iter; left time: 1172.0349s
Epoch: 50 cost time: 23.612294912338257
Epoch: 50, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 0.0042693
	speed: 0.3266s/iter; left time: 7627.1603s
	iters: 200, epoch: 51 | loss: 0.0046354
	speed: 0.0501s/iter; left time: 1164.1482s
	iters: 300, epoch: 51 | loss: 0.0045842
	speed: 0.0452s/iter; left time: 1046.8721s
	iters: 400, epoch: 51 | loss: 0.0002369
	speed: 0.0432s/iter; left time: 995.9103s
Epoch: 51 cost time: 23.14159607887268
Epoch: 51, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 0.0011522
	speed: 0.3113s/iter; left time: 7123.8214s
	iters: 200, epoch: 52 | loss: 0.0019394
	speed: 0.0541s/iter; left time: 1232.8605s
	iters: 300, epoch: 52 | loss: 0.0027726
	speed: 0.0423s/iter; left time: 959.5937s
	iters: 400, epoch: 52 | loss: 0.0013228
	speed: 0.0498s/iter; left time: 1125.2882s
Epoch: 52 cost time: 23.96457862854004
Epoch: 52, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 13418
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5505229
	speed: 0.0748s/iter; left time: 3502.9400s
	iters: 200, epoch: 1 | loss: 1.1246021
	speed: 0.0389s/iter; left time: 1814.9860s
	iters: 300, epoch: 1 | loss: 0.7921714
	speed: 0.0440s/iter; left time: 2048.4197s
	iters: 400, epoch: 1 | loss: 0.3514814
	speed: 0.0477s/iter; left time: 2220.2665s
Epoch: 1 cost time: 24.32089877128601
Epoch: 1, Steps: 469 | Train Loss: 1.165 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
Validation loss decreased (inf --> -0.828468).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2692750
	speed: 0.3503s/iter; left time: 16228.9947s
	iters: 200, epoch: 2 | loss: 0.4677896
	speed: 0.0508s/iter; left time: 2348.2173s
	iters: 300, epoch: 2 | loss: 0.1749818
	speed: 0.0545s/iter; left time: 2512.7349s
	iters: 400, epoch: 2 | loss: 0.1030599
	speed: 0.0566s/iter; left time: 2605.1852s
Epoch: 2 cost time: 25.64821195602417
Epoch: 2, Steps: 469 | Train Loss: 0.366 Vali Loss: 0.327 Vali Acc: 0.915 Test Loss: 0.327 Test Acc: 0.915
Validation loss decreased (-0.828468 --> -0.915091).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2230220
	speed: 0.3512s/iter; left time: 16108.7778s
	iters: 200, epoch: 3 | loss: 0.9507122
	speed: 0.0523s/iter; left time: 2395.5193s
	iters: 300, epoch: 3 | loss: 0.2155402
	speed: 0.0475s/iter; left time: 2168.4188s
	iters: 400, epoch: 3 | loss: 0.0579202
	speed: 0.0505s/iter; left time: 2300.8730s
Epoch: 3 cost time: 24.527891159057617
Epoch: 3, Steps: 469 | Train Loss: 0.203 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.915091 --> -0.932816).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0374730
	speed: 0.3560s/iter; left time: 16160.0865s
	iters: 200, epoch: 4 | loss: 0.0512758
	speed: 0.0506s/iter; left time: 2289.8174s
	iters: 300, epoch: 4 | loss: 0.4571864
	speed: 0.0495s/iter; left time: 2235.1676s
	iters: 400, epoch: 4 | loss: 0.0401308
	speed: 0.0506s/iter; left time: 2280.0502s
Epoch: 4 cost time: 25.322829723358154
Epoch: 4, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.932816 --> -0.953686).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2023832
	speed: 0.3345s/iter; left time: 15028.9779s
	iters: 200, epoch: 5 | loss: 0.0865270
	speed: 0.0508s/iter; left time: 2277.9694s
	iters: 300, epoch: 5 | loss: 0.0207801
	speed: 0.0497s/iter; left time: 2221.1569s
	iters: 400, epoch: 5 | loss: 0.0341736
	speed: 0.0522s/iter; left time: 2328.4421s
Epoch: 5 cost time: 24.529129028320312
Epoch: 5, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2950757
	speed: 0.3277s/iter; left time: 14567.0231s
	iters: 200, epoch: 6 | loss: 0.0203114
	speed: 0.0481s/iter; left time: 2132.0399s
	iters: 300, epoch: 6 | loss: 0.0671432
	speed: 0.0534s/iter; left time: 2364.0135s
	iters: 400, epoch: 6 | loss: 0.0170468
	speed: 0.0527s/iter; left time: 2325.8048s
Epoch: 6 cost time: 25.0250563621521
Epoch: 6, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
Validation loss decreased (-0.953686 --> -0.960547).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0260579
	speed: 0.3367s/iter; left time: 14810.3761s
	iters: 200, epoch: 7 | loss: 0.1282564
	speed: 0.0455s/iter; left time: 1997.2275s
	iters: 300, epoch: 7 | loss: 0.0048830
	speed: 0.0464s/iter; left time: 2031.0295s
	iters: 400, epoch: 7 | loss: 0.0203074
	speed: 0.0437s/iter; left time: 1910.3141s
Epoch: 7 cost time: 22.150559186935425
Epoch: 7, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.960547 --> -0.961977).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0216562
	speed: 0.3243s/iter; left time: 14111.4198s
	iters: 200, epoch: 8 | loss: 0.0645279
	speed: 0.0477s/iter; left time: 2071.0890s
	iters: 300, epoch: 8 | loss: 0.0432328
	speed: 0.0485s/iter; left time: 2102.2296s
	iters: 400, epoch: 8 | loss: 0.1256139
	speed: 0.0483s/iter; left time: 2086.9878s
Epoch: 8 cost time: 23.86483597755432
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.961977 --> -0.965407).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0315839
	speed: 0.3262s/iter; left time: 14044.3580s
	iters: 200, epoch: 9 | loss: 0.0143683
	speed: 0.0471s/iter; left time: 2024.4383s
	iters: 300, epoch: 9 | loss: 0.3412908
	speed: 0.0483s/iter; left time: 2069.9437s
	iters: 400, epoch: 9 | loss: 0.0337649
	speed: 0.0443s/iter; left time: 1892.2799s
Epoch: 9 cost time: 22.808995246887207
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0436635
	speed: 0.2956s/iter; left time: 12585.3771s
	iters: 200, epoch: 10 | loss: 0.0178989
	speed: 0.0447s/iter; left time: 1897.1222s
	iters: 300, epoch: 10 | loss: 0.0220541
	speed: 0.0448s/iter; left time: 1900.2706s
	iters: 400, epoch: 10 | loss: 0.0118814
	speed: 0.0434s/iter; left time: 1836.2858s
Epoch: 10 cost time: 21.290739059448242
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.965407 --> -0.966837).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0013585
	speed: 0.3075s/iter; left time: 12949.9937s
	iters: 200, epoch: 11 | loss: 0.0178156
	speed: 0.0482s/iter; left time: 2023.2470s
	iters: 300, epoch: 11 | loss: 0.0054295
	speed: 0.0443s/iter; left time: 1856.7672s
	iters: 400, epoch: 11 | loss: 0.3426111
	speed: 0.0521s/iter; left time: 2178.9647s
Epoch: 11 cost time: 23.317545175552368
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0099308
	speed: 0.3108s/iter; left time: 12942.2113s
	iters: 200, epoch: 12 | loss: 0.0073956
	speed: 0.0475s/iter; left time: 1972.5143s
	iters: 300, epoch: 12 | loss: 0.0456517
	speed: 0.0484s/iter; left time: 2004.0434s
	iters: 400, epoch: 12 | loss: 0.0064076
	speed: 0.0551s/iter; left time: 2277.9908s
Epoch: 12 cost time: 23.894598722457886
Epoch: 12, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0223438
	speed: 0.3183s/iter; left time: 13107.0338s
	iters: 200, epoch: 13 | loss: 0.0019698
	speed: 0.0455s/iter; left time: 1868.3833s
	iters: 300, epoch: 13 | loss: 0.1697114
	speed: 0.0545s/iter; left time: 2233.4778s
	iters: 400, epoch: 13 | loss: 0.0035567
	speed: 0.0604s/iter; left time: 2466.8437s
Epoch: 13 cost time: 25.624052047729492
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0080602
	speed: 0.3622s/iter; left time: 14741.7575s
	iters: 200, epoch: 14 | loss: 0.0100262
	speed: 0.0546s/iter; left time: 2218.3766s
	iters: 300, epoch: 14 | loss: 0.0073896
	speed: 0.0541s/iter; left time: 2190.7748s
	iters: 400, epoch: 14 | loss: 0.0481784
	speed: 0.0565s/iter; left time: 2283.7593s
Epoch: 14 cost time: 26.9692862033844
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0924009
	speed: 0.3664s/iter; left time: 14741.3050s
	iters: 200, epoch: 15 | loss: 0.0015601
	speed: 0.0512s/iter; left time: 2053.4097s
	iters: 300, epoch: 15 | loss: 0.0719456
	speed: 0.0575s/iter; left time: 2302.8828s
	iters: 400, epoch: 15 | loss: 0.0693704
	speed: 0.0561s/iter; left time: 2239.3671s
Epoch: 15 cost time: 26.517658948898315
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.2665560
	speed: 0.3443s/iter; left time: 13690.5911s
	iters: 200, epoch: 16 | loss: 0.0259688
	speed: 0.0496s/iter; left time: 1967.1221s
	iters: 300, epoch: 16 | loss: 0.0058197
	speed: 0.0526s/iter; left time: 2080.4423s
	iters: 400, epoch: 16 | loss: 0.0307866
	speed: 0.0555s/iter; left time: 2190.1440s
Epoch: 16 cost time: 25.926361083984375
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0131664
	speed: 0.3430s/iter; left time: 13478.1581s
	iters: 200, epoch: 17 | loss: 0.0690544
	speed: 0.0512s/iter; left time: 2005.1679s
	iters: 300, epoch: 17 | loss: 0.0006606
	speed: 0.0521s/iter; left time: 2038.0687s
	iters: 400, epoch: 17 | loss: 0.0585113
	speed: 0.0515s/iter; left time: 2007.3099s
Epoch: 17 cost time: 24.784034490585327
Epoch: 17, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.969124).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0030227
	speed: 0.3431s/iter; left time: 13319.9850s
	iters: 200, epoch: 18 | loss: 0.0008161
	speed: 0.0500s/iter; left time: 1934.5330s
	iters: 300, epoch: 18 | loss: 0.2238161
	speed: 0.0530s/iter; left time: 2045.5734s
	iters: 400, epoch: 18 | loss: 0.0001895
	speed: 0.0568s/iter; left time: 2187.4109s
Epoch: 18 cost time: 25.7046217918396
Epoch: 18, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0121471
	speed: 0.3164s/iter; left time: 12137.3033s
	iters: 200, epoch: 19 | loss: 0.0090083
	speed: 0.0515s/iter; left time: 1970.5289s
	iters: 300, epoch: 19 | loss: 0.0004154
	speed: 0.0457s/iter; left time: 1743.0104s
	iters: 400, epoch: 19 | loss: 0.0014067
	speed: 0.0484s/iter; left time: 1842.4404s
Epoch: 19 cost time: 23.38120126724243
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.970267).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0046227
	speed: 0.3246s/iter; left time: 12298.1257s
	iters: 200, epoch: 20 | loss: 0.0294177
	speed: 0.0510s/iter; left time: 1929.0546s
	iters: 300, epoch: 20 | loss: 0.0065910
	speed: 0.0545s/iter; left time: 2054.9514s
	iters: 400, epoch: 20 | loss: 0.1262987
	speed: 0.0640s/iter; left time: 2406.0095s
Epoch: 20 cost time: 26.16095471382141
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0123971
	speed: 0.3706s/iter; left time: 13868.9239s
	iters: 200, epoch: 21 | loss: 0.0213621
	speed: 0.0494s/iter; left time: 1844.6347s
	iters: 300, epoch: 21 | loss: 0.0521594
	speed: 0.0572s/iter; left time: 2127.2670s
	iters: 400, epoch: 21 | loss: 0.0478552
	speed: 0.0523s/iter; left time: 1940.0371s
Epoch: 21 cost time: 26.290539503097534
Epoch: 21, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.970267 --> -0.971696).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0002959
	speed: 0.3410s/iter; left time: 12602.3921s
	iters: 200, epoch: 22 | loss: 0.0067084
	speed: 0.0576s/iter; left time: 2122.2904s
	iters: 300, epoch: 22 | loss: 0.0016873
	speed: 0.0532s/iter; left time: 1954.4646s
	iters: 400, epoch: 22 | loss: 0.0046318
	speed: 0.0562s/iter; left time: 2060.4912s
Epoch: 22 cost time: 26.03623104095459
Epoch: 22, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0064594
	speed: 0.3468s/iter; left time: 12651.0208s
	iters: 200, epoch: 23 | loss: 0.0157583
	speed: 0.0532s/iter; left time: 1935.5352s
	iters: 300, epoch: 23 | loss: 0.0024525
	speed: 0.0517s/iter; left time: 1876.1927s
	iters: 400, epoch: 23 | loss: 0.0027445
	speed: 0.0554s/iter; left time: 2004.5305s
Epoch: 23 cost time: 25.585856199264526
Epoch: 23, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0024349
	speed: 0.3409s/iter; left time: 12278.1146s
	iters: 200, epoch: 24 | loss: 0.1432509
	speed: 0.0465s/iter; left time: 1669.5257s
	iters: 300, epoch: 24 | loss: 0.1176998
	speed: 0.0491s/iter; left time: 1757.0681s
	iters: 400, epoch: 24 | loss: 0.0388986
	speed: 0.0492s/iter; left time: 1758.7599s
Epoch: 24 cost time: 23.06415605545044
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0208812
	speed: 0.3156s/iter; left time: 11217.3203s
	iters: 200, epoch: 25 | loss: 0.0077302
	speed: 0.0433s/iter; left time: 1533.8292s
	iters: 300, epoch: 25 | loss: 0.0039956
	speed: 0.0512s/iter; left time: 1808.5114s
	iters: 400, epoch: 25 | loss: 0.0265591
	speed: 0.0525s/iter; left time: 1852.0586s
Epoch: 25 cost time: 23.856969356536865
Epoch: 25, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0052041
	speed: 0.3490s/iter; left time: 12243.1699s
	iters: 200, epoch: 26 | loss: 0.2531964
	speed: 0.0450s/iter; left time: 1574.7888s
	iters: 300, epoch: 26 | loss: 0.1617960
	speed: 0.0546s/iter; left time: 1903.1065s
	iters: 400, epoch: 26 | loss: 0.0087201
	speed: 0.0527s/iter; left time: 1831.3530s
Epoch: 26 cost time: 25.018731355667114
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2821820
	speed: 0.3168s/iter; left time: 10963.3609s
	iters: 200, epoch: 27 | loss: 0.0002002
	speed: 0.0455s/iter; left time: 1569.3908s
	iters: 300, epoch: 27 | loss: 0.0241295
	speed: 0.0533s/iter; left time: 1833.3782s
	iters: 400, epoch: 27 | loss: 0.0213206
	speed: 0.0491s/iter; left time: 1686.1752s
Epoch: 27 cost time: 25.268046379089355
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.971696 --> -0.972268).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0079738
	speed: 0.3277s/iter; left time: 11188.6090s
	iters: 200, epoch: 28 | loss: 0.0394084
	speed: 0.0621s/iter; left time: 2113.2958s
	iters: 300, epoch: 28 | loss: 0.0340569
	speed: 0.0620s/iter; left time: 2103.5416s
	iters: 400, epoch: 28 | loss: 0.0060229
	speed: 0.0560s/iter; left time: 1895.5501s
Epoch: 28 cost time: 27.441226959228516
Epoch: 28, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0033705
	speed: 0.3375s/iter; left time: 11363.9583s
	iters: 200, epoch: 29 | loss: 0.0021801
	speed: 0.0542s/iter; left time: 1820.3196s
	iters: 300, epoch: 29 | loss: 0.0646759
	speed: 0.0517s/iter; left time: 1730.0834s
	iters: 400, epoch: 29 | loss: 0.0050649
	speed: 0.0510s/iter; left time: 1700.4169s
Epoch: 29 cost time: 25.439783811569214
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.972268 --> -0.973412).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0002177
	speed: 0.3418s/iter; left time: 11347.5107s
	iters: 200, epoch: 30 | loss: 0.1436817
	speed: 0.0596s/iter; left time: 1972.7467s
	iters: 300, epoch: 30 | loss: 0.0000283
	speed: 0.0637s/iter; left time: 2103.4783s
	iters: 400, epoch: 30 | loss: 0.0425087
	speed: 0.0669s/iter; left time: 2199.5043s
Epoch: 30 cost time: 29.677228450775146
Epoch: 30, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0008922
	speed: 0.3823s/iter; left time: 12512.3310s
	iters: 200, epoch: 31 | loss: 0.0144592
	speed: 0.0561s/iter; left time: 1830.9384s
	iters: 300, epoch: 31 | loss: 0.0047623
	speed: 0.0588s/iter; left time: 1914.1900s
	iters: 400, epoch: 31 | loss: 0.1878563
	speed: 0.0639s/iter; left time: 2072.0894s
Epoch: 31 cost time: 29.27744746208191
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0002953
	speed: 0.3968s/iter; left time: 12802.8524s
	iters: 200, epoch: 32 | loss: 0.0058828
	speed: 0.0550s/iter; left time: 1770.1975s
	iters: 300, epoch: 32 | loss: 0.0222740
	speed: 0.0614s/iter; left time: 1967.2983s
	iters: 400, epoch: 32 | loss: 0.0040807
	speed: 0.0578s/iter; left time: 1847.5603s
Epoch: 32 cost time: 28.86295986175537
Epoch: 32, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0082951
	speed: 0.3457s/iter; left time: 10991.0874s
	iters: 200, epoch: 33 | loss: 0.0209971
	speed: 0.0476s/iter; left time: 1509.3706s
	iters: 300, epoch: 33 | loss: 0.0036328
	speed: 0.0477s/iter; left time: 1506.9018s
	iters: 400, epoch: 33 | loss: 0.0016989
	speed: 0.0533s/iter; left time: 1678.9120s
Epoch: 33 cost time: 24.20204997062683
Epoch: 33, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0015018
	speed: 0.3215s/iter; left time: 10071.9621s
	iters: 200, epoch: 34 | loss: 0.0093416
	speed: 0.0554s/iter; left time: 1730.3304s
	iters: 300, epoch: 34 | loss: 0.0509423
	speed: 0.0510s/iter; left time: 1588.7198s
	iters: 400, epoch: 34 | loss: 0.0511726
	speed: 0.0513s/iter; left time: 1592.7781s
Epoch: 34 cost time: 24.888874292373657
Epoch: 34, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000545
	speed: 0.3067s/iter; left time: 9464.1248s
	iters: 200, epoch: 35 | loss: 0.0020772
	speed: 0.0438s/iter; left time: 1345.7201s
	iters: 300, epoch: 35 | loss: 0.1775373
	speed: 0.0417s/iter; left time: 1278.0859s
	iters: 400, epoch: 35 | loss: 0.0009742
	speed: 0.0470s/iter; left time: 1437.3779s
Epoch: 35 cost time: 21.40946340560913
Epoch: 35, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0086190
	speed: 0.3067s/iter; left time: 9320.0071s
	iters: 200, epoch: 36 | loss: 0.0636687
	speed: 0.0513s/iter; left time: 1552.4017s
	iters: 300, epoch: 36 | loss: 0.0291035
	speed: 0.0488s/iter; left time: 1473.9041s
	iters: 400, epoch: 36 | loss: 0.0052067
	speed: 0.0464s/iter; left time: 1394.8961s
Epoch: 36 cost time: 23.526116132736206
Epoch: 36, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.966 Test Loss: 0.169 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0007943
	speed: 0.3086s/iter; left time: 9233.8048s
	iters: 200, epoch: 37 | loss: 0.0050545
	speed: 0.0475s/iter; left time: 1416.6524s
	iters: 300, epoch: 37 | loss: 0.0002579
	speed: 0.0417s/iter; left time: 1238.4879s
	iters: 400, epoch: 37 | loss: 0.0194079
	speed: 0.0470s/iter; left time: 1392.0588s
Epoch: 37 cost time: 22.230698347091675
Epoch: 37, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.173 Vali Acc: 0.966 Test Loss: 0.173 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0058426
	speed: 0.3202s/iter; left time: 9429.8460s
	iters: 200, epoch: 38 | loss: 0.0080892
	speed: 0.0453s/iter; left time: 1329.5790s
	iters: 300, epoch: 38 | loss: 0.0000666
	speed: 0.0484s/iter; left time: 1414.6679s
	iters: 400, epoch: 38 | loss: 0.0001762
	speed: 0.0486s/iter; left time: 1416.6420s
Epoch: 38 cost time: 22.14915370941162
Epoch: 38, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0087821
	speed: 0.3089s/iter; left time: 8952.1383s
	iters: 200, epoch: 39 | loss: 0.0104377
	speed: 0.0398s/iter; left time: 1149.0878s
	iters: 300, epoch: 39 | loss: 0.0016862
	speed: 0.0491s/iter; left time: 1411.9949s
	iters: 400, epoch: 39 | loss: 0.1363879
	speed: 0.0439s/iter; left time: 1259.9617s
Epoch: 39 cost time: 22.081589460372925
Epoch: 39, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9734133790737565
model parameter : 9194
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7020756
	speed: 0.0651s/iter; left time: 3047.3716s
	iters: 200, epoch: 1 | loss: 0.0614372
	speed: 0.0375s/iter; left time: 1751.9761s
	iters: 300, epoch: 1 | loss: 0.1347442
	speed: 0.0383s/iter; left time: 1785.8604s
	iters: 400, epoch: 1 | loss: 0.0278563
	speed: 0.0358s/iter; left time: 1664.1200s
Epoch: 1 cost time: 20.299859523773193
Epoch: 1, Steps: 469 | Train Loss: 0.450 Vali Loss: 0.304 Vali Acc: 0.918 Test Loss: 0.304 Test Acc: 0.918
Validation loss decreased (inf --> -0.918236).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0756091
	speed: 0.2912s/iter; left time: 13490.6653s
	iters: 200, epoch: 2 | loss: 0.0158016
	speed: 0.0387s/iter; left time: 1788.8638s
	iters: 300, epoch: 2 | loss: 0.0405624
	speed: 0.0374s/iter; left time: 1724.5201s
	iters: 400, epoch: 2 | loss: 0.0820281
	speed: 0.0352s/iter; left time: 1621.4194s
Epoch: 2 cost time: 18.406975507736206
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.918236 --> -0.951113).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1069307
	speed: 0.2974s/iter; left time: 13638.5621s
	iters: 200, epoch: 3 | loss: 0.0258242
	speed: 0.0360s/iter; left time: 1647.1407s
	iters: 300, epoch: 3 | loss: 0.0007714
	speed: 0.0373s/iter; left time: 1701.5258s
	iters: 400, epoch: 3 | loss: 0.0084227
	speed: 0.0379s/iter; left time: 1726.3280s
Epoch: 3 cost time: 18.184513568878174
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
Validation loss decreased (-0.951113 --> -0.961690).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0019432
	speed: 0.2749s/iter; left time: 12478.0111s
	iters: 200, epoch: 4 | loss: 0.0109239
	speed: 0.0390s/iter; left time: 1766.5682s
	iters: 300, epoch: 4 | loss: 0.0006780
	speed: 0.0405s/iter; left time: 1828.7055s
	iters: 400, epoch: 4 | loss: 0.0039581
	speed: 0.0351s/iter; left time: 1582.7911s
Epoch: 4 cost time: 17.9994375705719
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.954 Test Loss: 0.276 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0747353
	speed: 0.2772s/iter; left time: 12454.9199s
	iters: 200, epoch: 5 | loss: 0.0232060
	speed: 0.0372s/iter; left time: 1668.0345s
	iters: 300, epoch: 5 | loss: 0.0005806
	speed: 0.0367s/iter; left time: 1640.1252s
	iters: 400, epoch: 5 | loss: 0.0056287
	speed: 0.0385s/iter; left time: 1718.0290s
Epoch: 5 cost time: 18.077024221420288
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0005670
	speed: 0.3010s/iter; left time: 13382.2088s
	iters: 200, epoch: 6 | loss: 0.0294535
	speed: 0.0425s/iter; left time: 1887.2402s
	iters: 300, epoch: 6 | loss: 0.0795819
	speed: 0.0422s/iter; left time: 1867.1408s
	iters: 400, epoch: 6 | loss: 0.0014101
	speed: 0.0444s/iter; left time: 1959.4074s
Epoch: 6 cost time: 21.025437355041504
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.237 Vali Acc: 0.964 Test Loss: 0.237 Test Acc: 0.964
Validation loss decreased (-0.961690 --> -0.964263).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0194753
	speed: 0.3040s/iter; left time: 13372.1138s
	iters: 200, epoch: 7 | loss: 0.0092164
	speed: 0.0381s/iter; left time: 1671.8938s
	iters: 300, epoch: 7 | loss: 0.0023953
	speed: 0.0394s/iter; left time: 1723.6582s
	iters: 400, epoch: 7 | loss: 0.1862600
	speed: 0.0398s/iter; left time: 1738.0270s
Epoch: 7 cost time: 18.949793338775635
Epoch: 7, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
Validation loss decreased (-0.964263 --> -0.969409).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3908975
	speed: 0.2827s/iter; left time: 12300.6860s
	iters: 200, epoch: 8 | loss: 0.0015668
	speed: 0.0353s/iter; left time: 1531.0270s
	iters: 300, epoch: 8 | loss: 0.0256059
	speed: 0.0245s/iter; left time: 1063.3273s
	iters: 400, epoch: 8 | loss: 0.0566999
	speed: 0.0348s/iter; left time: 1504.5802s
Epoch: 8 cost time: 15.5311119556427
Epoch: 8, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.320 Vali Acc: 0.940 Test Loss: 0.320 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1219744
	speed: 0.2504s/iter; left time: 10781.4322s
	iters: 200, epoch: 9 | loss: 0.0240584
	speed: 0.0319s/iter; left time: 1369.7793s
	iters: 300, epoch: 9 | loss: 0.0011418
	speed: 0.0360s/iter; left time: 1543.7150s
	iters: 400, epoch: 9 | loss: 0.0000017
	speed: 0.0321s/iter; left time: 1371.7553s
Epoch: 9 cost time: 16.07818102836609
Epoch: 9, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.251 Vali Acc: 0.959 Test Loss: 0.251 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2424334
	speed: 0.2890s/iter; left time: 12305.0023s
	iters: 200, epoch: 10 | loss: 0.0015133
	speed: 0.0378s/iter; left time: 1604.5431s
	iters: 300, epoch: 10 | loss: 0.0016440
	speed: 0.0371s/iter; left time: 1570.6100s
	iters: 400, epoch: 10 | loss: 0.9875918
	speed: 0.0384s/iter; left time: 1624.7520s
Epoch: 10 cost time: 18.839922666549683
Epoch: 10, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3195207
	speed: 0.2909s/iter; left time: 12250.6626s
	iters: 200, epoch: 11 | loss: 0.0025495
	speed: 0.0352s/iter; left time: 1479.5316s
	iters: 300, epoch: 11 | loss: 0.1482336
	speed: 0.0334s/iter; left time: 1401.4223s
	iters: 400, epoch: 11 | loss: 0.0000636
	speed: 0.0397s/iter; left time: 1660.3186s
Epoch: 11 cost time: 17.774583101272583
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.243 Vali Acc: 0.966 Test Loss: 0.243 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0066122
	speed: 0.2709s/iter; left time: 11281.1729s
	iters: 200, epoch: 12 | loss: 0.0338878
	speed: 0.0310s/iter; left time: 1286.7065s
	iters: 300, epoch: 12 | loss: 0.4139055
	speed: 0.0395s/iter; left time: 1638.7548s
	iters: 400, epoch: 12 | loss: 0.1744205
	speed: 0.0327s/iter; left time: 1350.9451s
Epoch: 12 cost time: 17.334824562072754
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.318 Vali Acc: 0.959 Test Loss: 0.318 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0001914
	speed: 0.2557s/iter; left time: 10527.8127s
	iters: 200, epoch: 13 | loss: 0.0089183
	speed: 0.0395s/iter; left time: 1622.7244s
	iters: 300, epoch: 13 | loss: 0.0451196
	speed: 0.0358s/iter; left time: 1467.1908s
	iters: 400, epoch: 13 | loss: 0.0018639
	speed: 0.0361s/iter; left time: 1474.3109s
Epoch: 13 cost time: 17.53918433189392
Epoch: 13, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0171342
	speed: 0.3004s/iter; left time: 12226.9171s
	iters: 200, epoch: 14 | loss: 0.0000826
	speed: 0.0398s/iter; left time: 1615.8080s
	iters: 300, epoch: 14 | loss: 0.0031778
	speed: 0.0390s/iter; left time: 1579.3459s
	iters: 400, epoch: 14 | loss: 0.0000462
	speed: 0.0350s/iter; left time: 1414.9846s
Epoch: 14 cost time: 18.868760585784912
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.331 Vali Acc: 0.964 Test Loss: 0.331 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000647
	speed: 0.3059s/iter; left time: 12309.5105s
	iters: 200, epoch: 15 | loss: 0.4089362
	speed: 0.0489s/iter; left time: 1961.4593s
	iters: 300, epoch: 15 | loss: 0.0003596
	speed: 0.0442s/iter; left time: 1769.2114s
	iters: 400, epoch: 15 | loss: 0.0005347
	speed: 0.0458s/iter; left time: 1830.9797s
Epoch: 15 cost time: 22.00702428817749
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.316 Vali Acc: 0.961 Test Loss: 0.316 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0385844
	speed: 0.3125s/iter; left time: 12427.8648s
	iters: 200, epoch: 16 | loss: 0.0000053
	speed: 0.0424s/iter; left time: 1680.7167s
	iters: 300, epoch: 16 | loss: 0.0005066
	speed: 0.0416s/iter; left time: 1645.6296s
	iters: 400, epoch: 16 | loss: 0.0001442
	speed: 0.0382s/iter; left time: 1507.4399s
Epoch: 16 cost time: 20.171147346496582
Epoch: 16, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.290 Vali Acc: 0.966 Test Loss: 0.290 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0004427
	speed: 0.2985s/iter; left time: 11730.7962s
	iters: 200, epoch: 17 | loss: 0.0000357
	speed: 0.0415s/iter; left time: 1625.1995s
	iters: 300, epoch: 17 | loss: 0.0000750
	speed: 0.0401s/iter; left time: 1568.7542s
	iters: 400, epoch: 17 | loss: 0.0003401
	speed: 0.0375s/iter; left time: 1463.8438s
Epoch: 17 cost time: 18.925115823745728
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.247 Vali Acc: 0.965 Test Loss: 0.247 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9694110920526015
model parameter : 153482
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4847258
	speed: 0.0706s/iter; left time: 3302.7572s
	iters: 200, epoch: 1 | loss: 0.4064354
	speed: 0.0365s/iter; left time: 1705.0916s
	iters: 300, epoch: 1 | loss: 0.1001690
	speed: 0.0370s/iter; left time: 1723.7704s
	iters: 400, epoch: 1 | loss: 0.0505720
	speed: 0.0383s/iter; left time: 1779.9803s
Epoch: 1 cost time: 20.98723793029785
Epoch: 1, Steps: 469 | Train Loss: 0.464 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
Validation loss decreased (inf --> -0.943108).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0222469
	speed: 0.3153s/iter; left time: 14606.2145s
	iters: 200, epoch: 2 | loss: 0.0295710
	speed: 0.0399s/iter; left time: 1843.3176s
	iters: 300, epoch: 2 | loss: 0.0478070
	speed: 0.0422s/iter; left time: 1947.0888s
	iters: 400, epoch: 2 | loss: 0.0960727
	speed: 0.0360s/iter; left time: 1658.9555s
Epoch: 2 cost time: 19.698683738708496
Epoch: 2, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.943108 --> -0.946253).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0059232
	speed: 0.3029s/iter; left time: 13891.9037s
	iters: 200, epoch: 3 | loss: 0.1084449
	speed: 0.0393s/iter; left time: 1800.4177s
	iters: 300, epoch: 3 | loss: 0.0066299
	speed: 0.0432s/iter; left time: 1973.8040s
	iters: 400, epoch: 3 | loss: 0.0015149
	speed: 0.0361s/iter; left time: 1646.2897s
Epoch: 3 cost time: 19.64255714416504
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.289 Vali Acc: 0.929 Test Loss: 0.289 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0283583
	speed: 0.2956s/iter; left time: 13418.3476s
	iters: 200, epoch: 4 | loss: 0.0810005
	speed: 0.0339s/iter; left time: 1537.7301s
	iters: 300, epoch: 4 | loss: 0.0754821
	speed: 0.0315s/iter; left time: 1424.3682s
	iters: 400, epoch: 4 | loss: 0.2537939
	speed: 0.0345s/iter; left time: 1556.3542s
Epoch: 4 cost time: 16.59811568260193
Epoch: 4, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.243 Vali Acc: 0.945 Test Loss: 0.243 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0003484
	speed: 0.2784s/iter; left time: 12509.0292s
	iters: 200, epoch: 5 | loss: 0.0216829
	speed: 0.0352s/iter; left time: 1577.4191s
	iters: 300, epoch: 5 | loss: 0.0196549
	speed: 0.0359s/iter; left time: 1606.8560s
	iters: 400, epoch: 5 | loss: 0.0047773
	speed: 0.0335s/iter; left time: 1494.8698s
Epoch: 5 cost time: 16.476542234420776
Epoch: 5, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.283 Vali Acc: 0.947 Test Loss: 0.283 Test Acc: 0.947
Validation loss decreased (-0.946253 --> -0.946538).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0257326
	speed: 0.2899s/iter; left time: 12885.5853s
	iters: 200, epoch: 6 | loss: 0.0005887
	speed: 0.0379s/iter; left time: 1681.4073s
	iters: 300, epoch: 6 | loss: 0.0133608
	speed: 0.0318s/iter; left time: 1407.4826s
	iters: 400, epoch: 6 | loss: 0.0405146
	speed: 0.0354s/iter; left time: 1563.9015s
Epoch: 6 cost time: 18.03906011581421
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
Validation loss decreased (-0.946538 --> -0.959689).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0064142
	speed: 0.2977s/iter; left time: 13095.4242s
	iters: 200, epoch: 7 | loss: 0.0025971
	speed: 0.0339s/iter; left time: 1489.2517s
	iters: 300, epoch: 7 | loss: 0.2968229
	speed: 0.0319s/iter; left time: 1397.8233s
	iters: 400, epoch: 7 | loss: 0.0472010
	speed: 0.0324s/iter; left time: 1415.6945s
Epoch: 7 cost time: 16.042654037475586
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0008591
	speed: 0.2750s/iter; left time: 11969.0190s
	iters: 200, epoch: 8 | loss: 0.6132253
	speed: 0.0365s/iter; left time: 1586.7889s
	iters: 300, epoch: 8 | loss: 0.0011414
	speed: 0.0342s/iter; left time: 1480.2188s
	iters: 400, epoch: 8 | loss: 0.0156748
	speed: 0.0333s/iter; left time: 1439.2807s
Epoch: 8 cost time: 17.803457260131836
Epoch: 8, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.327 Vali Acc: 0.955 Test Loss: 0.327 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000169
	speed: 0.2717s/iter; left time: 11694.6061s
	iters: 200, epoch: 9 | loss: 0.0005229
	speed: 0.0352s/iter; left time: 1513.2723s
	iters: 300, epoch: 9 | loss: 0.0013371
	speed: 0.0354s/iter; left time: 1518.5827s
	iters: 400, epoch: 9 | loss: 0.0000447
	speed: 0.0307s/iter; left time: 1310.3077s
Epoch: 9 cost time: 16.381444692611694
Epoch: 9, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.333 Vali Acc: 0.959 Test Loss: 0.333 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000442
	speed: 0.2747s/iter; left time: 11698.5706s
	iters: 200, epoch: 10 | loss: 0.0031600
	speed: 0.0442s/iter; left time: 1878.7388s
	iters: 300, epoch: 10 | loss: 0.0000086
	speed: 0.0334s/iter; left time: 1413.7537s
	iters: 400, epoch: 10 | loss: 0.0063983
	speed: 0.0428s/iter; left time: 1809.2759s
Epoch: 10 cost time: 18.805999517440796
Epoch: 10, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
Validation loss decreased (-0.959689 --> -0.970553).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2406680
	speed: 0.2893s/iter; left time: 12180.9389s
	iters: 200, epoch: 11 | loss: 0.0011237
	speed: 0.0385s/iter; left time: 1615.8139s
	iters: 300, epoch: 11 | loss: 0.0014383
	speed: 0.0364s/iter; left time: 1526.4517s
	iters: 400, epoch: 11 | loss: 0.1764620
	speed: 0.0381s/iter; left time: 1591.4569s
Epoch: 11 cost time: 18.04627275466919
Epoch: 11, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.255 Vali Acc: 0.962 Test Loss: 0.255 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1191671
	speed: 0.3072s/iter; left time: 12790.5634s
	iters: 200, epoch: 12 | loss: 0.0191517
	speed: 0.0423s/iter; left time: 1756.9079s
	iters: 300, epoch: 12 | loss: 0.0001216
	speed: 0.0396s/iter; left time: 1639.2890s
	iters: 400, epoch: 12 | loss: 0.0000946
	speed: 0.0366s/iter; left time: 1512.9978s
Epoch: 12 cost time: 19.424140214920044
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.350 Vali Acc: 0.955 Test Loss: 0.350 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0063888
	speed: 0.3180s/iter; left time: 13092.5620s
	iters: 200, epoch: 13 | loss: 0.1444016
	speed: 0.0371s/iter; left time: 1523.4549s
	iters: 300, epoch: 13 | loss: 0.0012863
	speed: 0.0402s/iter; left time: 1645.6789s
	iters: 400, epoch: 13 | loss: 0.0107710
	speed: 0.0381s/iter; left time: 1557.8038s
Epoch: 13 cost time: 18.260125398635864
Epoch: 13, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.257 Vali Acc: 0.968 Test Loss: 0.257 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0001563
	speed: 0.3077s/iter; left time: 12522.7574s
	iters: 200, epoch: 14 | loss: 0.0001010
	speed: 0.0370s/iter; left time: 1500.3952s
	iters: 300, epoch: 14 | loss: 0.0002873
	speed: 0.0381s/iter; left time: 1541.9012s
	iters: 400, epoch: 14 | loss: 0.0110187
	speed: 0.0386s/iter; left time: 1559.7444s
Epoch: 14 cost time: 19.09877347946167
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.343 Vali Acc: 0.956 Test Loss: 0.343 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0180019
	speed: 0.2991s/iter; left time: 12033.9265s
	iters: 200, epoch: 15 | loss: 0.0003898
	speed: 0.0407s/iter; left time: 1633.6288s
	iters: 300, epoch: 15 | loss: 0.0000509
	speed: 0.0420s/iter; left time: 1682.0619s
	iters: 400, epoch: 15 | loss: 0.0049551
	speed: 0.0377s/iter; left time: 1503.8913s
Epoch: 15 cost time: 19.179205894470215
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.273 Vali Acc: 0.962 Test Loss: 0.273 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0182397
	speed: 0.3089s/iter; left time: 12282.9759s
	iters: 200, epoch: 16 | loss: 0.2713032
	speed: 0.0387s/iter; left time: 1535.3896s
	iters: 300, epoch: 16 | loss: 0.0000410
	speed: 0.0387s/iter; left time: 1532.2556s
	iters: 400, epoch: 16 | loss: 0.0453164
	speed: 0.0392s/iter; left time: 1547.8947s
Epoch: 16 cost time: 18.452388286590576
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.302 Vali Acc: 0.956 Test Loss: 0.302 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1228591
	speed: 0.2998s/iter; left time: 11780.5387s
	iters: 200, epoch: 17 | loss: 0.1724450
	speed: 0.0331s/iter; left time: 1297.6377s
	iters: 300, epoch: 17 | loss: 0.0891666
	speed: 0.0360s/iter; left time: 1407.3276s
	iters: 400, epoch: 17 | loss: 0.0001263
	speed: 0.0313s/iter; left time: 1220.3961s
Epoch: 17 cost time: 17.589478492736816
Epoch: 17, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.480 Vali Acc: 0.933 Test Loss: 0.480 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0002589
	speed: 0.2766s/iter; left time: 10738.4751s
	iters: 200, epoch: 18 | loss: 0.2017513
	speed: 0.0384s/iter; left time: 1485.6781s
	iters: 300, epoch: 18 | loss: 0.0779819
	speed: 0.0391s/iter; left time: 1511.3695s
	iters: 400, epoch: 18 | loss: 0.0000182
	speed: 0.0426s/iter; left time: 1641.8229s
Epoch: 18 cost time: 19.788087129592896
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.301 Vali Acc: 0.967 Test Loss: 0.301 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.3464960
	speed: 0.3029s/iter; left time: 11618.7505s
	iters: 200, epoch: 19 | loss: 0.0037447
	speed: 0.0384s/iter; left time: 1470.0986s
	iters: 300, epoch: 19 | loss: 0.0326448
	speed: 0.0386s/iter; left time: 1473.1685s
	iters: 400, epoch: 19 | loss: 0.1911149
	speed: 0.0406s/iter; left time: 1545.6052s
Epoch: 19 cost time: 19.226075649261475
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.372 Vali Acc: 0.955 Test Loss: 0.372 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000027
	speed: 0.2866s/iter; left time: 10859.2989s
	iters: 200, epoch: 20 | loss: 0.0004877
	speed: 0.0338s/iter; left time: 1278.1558s
	iters: 300, epoch: 20 | loss: 0.0369173
	speed: 0.0312s/iter; left time: 1175.1320s
	iters: 400, epoch: 20 | loss: 0.0000021
	speed: 0.0334s/iter; left time: 1256.5414s
Epoch: 20 cost time: 16.13465118408203
Epoch: 20, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.288 Vali Acc: 0.967 Test Loss: 0.288 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9705546026300743
model parameter : 120586
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9727073
	speed: 0.0564s/iter; left time: 2639.6902s
	iters: 200, epoch: 1 | loss: 0.7126679
	speed: 0.0368s/iter; left time: 1719.8369s
	iters: 300, epoch: 1 | loss: 0.1700164
	speed: 0.0360s/iter; left time: 1675.4993s
	iters: 400, epoch: 1 | loss: 0.1422750
	speed: 0.0354s/iter; left time: 1645.8264s
Epoch: 1 cost time: 18.898054838180542
Epoch: 1, Steps: 469 | Train Loss: 0.487 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (inf --> -0.937105).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0546388
	speed: 0.2742s/iter; left time: 12703.4102s
	iters: 200, epoch: 2 | loss: 0.0261208
	speed: 0.0343s/iter; left time: 1586.2965s
	iters: 300, epoch: 2 | loss: 0.0853733
	speed: 0.0354s/iter; left time: 1633.0283s
	iters: 400, epoch: 2 | loss: 0.1487695
	speed: 0.0351s/iter; left time: 1614.7254s
Epoch: 2 cost time: 17.18648648262024
Epoch: 2, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
Validation loss decreased (-0.937105 --> -0.960547).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0113883
	speed: 0.3006s/iter; left time: 13785.6166s
	iters: 200, epoch: 3 | loss: 0.0206705
	speed: 0.0431s/iter; left time: 1972.9333s
	iters: 300, epoch: 3 | loss: 0.0151764
	speed: 0.0398s/iter; left time: 1817.3423s
	iters: 400, epoch: 3 | loss: 0.0712389
	speed: 0.0373s/iter; left time: 1698.8225s
Epoch: 3 cost time: 19.53848648071289
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.268 Vali Acc: 0.946 Test Loss: 0.268 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1228517
	speed: 0.3225s/iter; left time: 14640.6466s
	iters: 200, epoch: 4 | loss: 0.0019800
	speed: 0.0408s/iter; left time: 1846.2755s
	iters: 300, epoch: 4 | loss: 0.1257784
	speed: 0.0416s/iter; left time: 1878.5034s
	iters: 400, epoch: 4 | loss: 0.1941957
	speed: 0.0486s/iter; left time: 2190.2659s
Epoch: 4 cost time: 21.176109790802002
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2598317
	speed: 0.3179s/iter; left time: 14280.2528s
	iters: 200, epoch: 5 | loss: 0.0151281
	speed: 0.0388s/iter; left time: 1740.7012s
	iters: 300, epoch: 5 | loss: 0.0177842
	speed: 0.0434s/iter; left time: 1941.8849s
	iters: 400, epoch: 5 | loss: 0.0301158
	speed: 0.0383s/iter; left time: 1709.8270s
Epoch: 5 cost time: 19.74595808982849
Epoch: 5, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.265 Vali Acc: 0.953 Test Loss: 0.265 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0077315
	speed: 0.2999s/iter; left time: 13331.4855s
	iters: 200, epoch: 6 | loss: 0.0157125
	speed: 0.0394s/iter; left time: 1748.8031s
	iters: 300, epoch: 6 | loss: 0.0054792
	speed: 0.0431s/iter; left time: 1905.6244s
	iters: 400, epoch: 6 | loss: 0.5213048
	speed: 0.0376s/iter; left time: 1659.8002s
Epoch: 6 cost time: 19.102928400039673
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0008125
	speed: 0.2845s/iter; left time: 12516.0047s
	iters: 200, epoch: 7 | loss: 0.0002131
	speed: 0.0392s/iter; left time: 1719.8249s
	iters: 300, epoch: 7 | loss: 0.0005293
	speed: 0.0347s/iter; left time: 1520.4411s
	iters: 400, epoch: 7 | loss: 0.8180196
	speed: 0.0407s/iter; left time: 1777.1765s
Epoch: 7 cost time: 18.208375215530396
Epoch: 7, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.284 Vali Acc: 0.961 Test Loss: 0.284 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0055556
	speed: 0.3342s/iter; left time: 14543.0406s
	iters: 200, epoch: 8 | loss: 0.0001820
	speed: 0.0345s/iter; left time: 1496.6882s
	iters: 300, epoch: 8 | loss: 0.0198450
	speed: 0.0362s/iter; left time: 1566.1407s
	iters: 400, epoch: 8 | loss: 0.0638747
	speed: 0.0343s/iter; left time: 1482.4326s
Epoch: 8 cost time: 17.539758682250977
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.960547 --> -0.970267).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1536454
	speed: 0.2866s/iter; left time: 12339.2989s
	iters: 200, epoch: 9 | loss: 0.3495271
	speed: 0.0313s/iter; left time: 1344.1506s
	iters: 300, epoch: 9 | loss: 0.4534007
	speed: 0.0352s/iter; left time: 1507.6023s
	iters: 400, epoch: 9 | loss: 0.0010013
	speed: 0.0355s/iter; left time: 1517.0134s
Epoch: 9 cost time: 17.53578805923462
Epoch: 9, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.314 Vali Acc: 0.963 Test Loss: 0.314 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0004053
	speed: 0.2764s/iter; left time: 11769.0378s
	iters: 200, epoch: 10 | loss: 0.0000024
	speed: 0.0318s/iter; left time: 1351.8983s
	iters: 300, epoch: 10 | loss: 0.1611327
	speed: 0.0333s/iter; left time: 1413.0764s
	iters: 400, epoch: 10 | loss: 0.5813206
	speed: 0.0339s/iter; left time: 1433.3682s
Epoch: 10 cost time: 15.618280410766602
Epoch: 10, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.378 Vali Acc: 0.943 Test Loss: 0.378 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3699825
	speed: 0.2819s/iter; left time: 11872.8973s
	iters: 200, epoch: 11 | loss: 0.0028152
	speed: 0.0377s/iter; left time: 1585.2666s
	iters: 300, epoch: 11 | loss: 0.2515634
	speed: 0.0403s/iter; left time: 1690.1269s
	iters: 400, epoch: 11 | loss: 0.1074403
	speed: 0.0341s/iter; left time: 1424.2572s
Epoch: 11 cost time: 17.71521759033203
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.215 Vali Acc: 0.971 Test Loss: 0.215 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.971124).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0231387
	speed: 0.2647s/iter; left time: 11024.2393s
	iters: 200, epoch: 12 | loss: 0.1111867
	speed: 0.0408s/iter; left time: 1693.0655s
	iters: 300, epoch: 12 | loss: 0.0003127
	speed: 0.0298s/iter; left time: 1236.8814s
	iters: 400, epoch: 12 | loss: 0.1549687
	speed: 0.0333s/iter; left time: 1375.7362s
Epoch: 12 cost time: 16.089476823806763
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.307 Vali Acc: 0.965 Test Loss: 0.307 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3620938
	speed: 0.2967s/iter; left time: 12216.3285s
	iters: 200, epoch: 13 | loss: 0.0619898
	speed: 0.0368s/iter; left time: 1513.5312s
	iters: 300, epoch: 13 | loss: 0.0852240
	speed: 0.0375s/iter; left time: 1535.6409s
	iters: 400, epoch: 13 | loss: 0.0002017
	speed: 0.0369s/iter; left time: 1508.4353s
Epoch: 13 cost time: 18.42496132850647
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.266 Vali Acc: 0.967 Test Loss: 0.266 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000707
	speed: 0.2895s/iter; left time: 11782.7399s
	iters: 200, epoch: 14 | loss: 0.0011708
	speed: 0.0391s/iter; left time: 1587.3768s
	iters: 300, epoch: 14 | loss: 0.3323746
	speed: 0.0376s/iter; left time: 1523.0382s
	iters: 400, epoch: 14 | loss: 0.0003246
	speed: 0.0330s/iter; left time: 1331.6056s
Epoch: 14 cost time: 17.69180202484131
Epoch: 14, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.330 Vali Acc: 0.962 Test Loss: 0.330 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0011373
	speed: 0.3081s/iter; left time: 12395.6951s
	iters: 200, epoch: 15 | loss: 0.0004864
	speed: 0.0389s/iter; left time: 1559.8645s
	iters: 300, epoch: 15 | loss: 0.0003638
	speed: 0.0365s/iter; left time: 1460.4674s
	iters: 400, epoch: 15 | loss: 0.0000056
	speed: 0.0268s/iter; left time: 1071.7794s
Epoch: 15 cost time: 17.344168186187744
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.269 Vali Acc: 0.960 Test Loss: 0.269 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0122855
	speed: 0.3157s/iter; left time: 12553.9517s
	iters: 200, epoch: 16 | loss: 0.0021004
	speed: 0.0399s/iter; left time: 1583.2458s
	iters: 300, epoch: 16 | loss: 0.0000056
	speed: 0.0415s/iter; left time: 1641.9356s
	iters: 400, epoch: 16 | loss: 0.0018624
	speed: 0.0409s/iter; left time: 1614.3850s
Epoch: 16 cost time: 20.757341623306274
Epoch: 16, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.271 Vali Acc: 0.965 Test Loss: 0.271 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000708
	speed: 0.3102s/iter; left time: 12188.0302s
	iters: 200, epoch: 17 | loss: 0.0011418
	speed: 0.0389s/iter; left time: 1526.0172s
	iters: 300, epoch: 17 | loss: 0.0083284
	speed: 0.0412s/iter; left time: 1612.7180s
	iters: 400, epoch: 17 | loss: 0.0002607
	speed: 0.0402s/iter; left time: 1567.0381s
Epoch: 17 cost time: 19.39571523666382
Epoch: 17, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.255 Vali Acc: 0.957 Test Loss: 0.255 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0049208
	speed: 0.3214s/iter; left time: 12477.7518s
	iters: 200, epoch: 18 | loss: 0.2820072
	speed: 0.0367s/iter; left time: 1420.9178s
	iters: 300, epoch: 18 | loss: 0.0000011
	speed: 0.0399s/iter; left time: 1542.8243s
	iters: 400, epoch: 18 | loss: 0.0018586
	speed: 0.0334s/iter; left time: 1285.6395s
Epoch: 18 cost time: 18.011728286743164
Epoch: 18, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.310 Vali Acc: 0.957 Test Loss: 0.310 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0006923
	speed: 0.3133s/iter; left time: 12016.0137s
	iters: 200, epoch: 19 | loss: 0.0000151
	speed: 0.0410s/iter; left time: 1568.8924s
	iters: 300, epoch: 19 | loss: 0.0022075
	speed: 0.0391s/iter; left time: 1490.1583s
	iters: 400, epoch: 19 | loss: 0.1146704
	speed: 0.0464s/iter; left time: 1766.2108s
Epoch: 19 cost time: 20.309709787368774
Epoch: 19, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.243 Vali Acc: 0.965 Test Loss: 0.243 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1187164
	speed: 0.3525s/iter; left time: 13356.8830s
	iters: 200, epoch: 20 | loss: 0.0001064
	speed: 0.0474s/iter; left time: 1790.6744s
	iters: 300, epoch: 20 | loss: 0.0010205
	speed: 0.0504s/iter; left time: 1898.0334s
	iters: 400, epoch: 20 | loss: 0.0004106
	speed: 0.0449s/iter; left time: 1687.6941s
Epoch: 20 cost time: 22.970918893814087
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.268 Vali Acc: 0.970 Test Loss: 0.268 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1342829
	speed: 0.3670s/iter; left time: 13735.1579s
	iters: 200, epoch: 21 | loss: 0.0268716
	speed: 0.0494s/iter; left time: 1843.3162s
	iters: 300, epoch: 21 | loss: 0.0025922
	speed: 0.0468s/iter; left time: 1740.3805s
	iters: 400, epoch: 21 | loss: 0.0000024
	speed: 0.0463s/iter; left time: 1719.9849s
Epoch: 21 cost time: 23.04121232032776
Epoch: 21, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.293 Vali Acc: 0.960 Test Loss: 0.293 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9711263579188107
model parameter : 104138
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5981209
	speed: 0.0778s/iter; left time: 3639.9991s
	iters: 200, epoch: 1 | loss: 0.3919711
	speed: 0.0360s/iter; left time: 1683.0839s
	iters: 300, epoch: 1 | loss: 0.2572897
	speed: 0.0377s/iter; left time: 1756.0247s
	iters: 400, epoch: 1 | loss: 0.2030886
	speed: 0.0464s/iter; left time: 2159.9387s
Epoch: 1 cost time: 22.7704439163208
Epoch: 1, Steps: 469 | Train Loss: 0.605 Vali Loss: 0.315 Vali Acc: 0.915 Test Loss: 0.315 Test Acc: 0.915
Validation loss decreased (inf --> -0.914519).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1512862
	speed: 0.3286s/iter; left time: 15222.8220s
	iters: 200, epoch: 2 | loss: 0.1537339
	speed: 0.0397s/iter; left time: 1836.2116s
	iters: 300, epoch: 2 | loss: 0.1353248
	speed: 0.0370s/iter; left time: 1708.8826s
	iters: 400, epoch: 2 | loss: 0.0207970
	speed: 0.0371s/iter; left time: 1708.2051s
Epoch: 2 cost time: 19.411772966384888
Epoch: 2, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.241 Vali Acc: 0.932 Test Loss: 0.241 Test Acc: 0.932
Validation loss decreased (-0.914519 --> -0.932245).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0679619
	speed: 0.3136s/iter; left time: 14383.7304s
	iters: 200, epoch: 3 | loss: 0.5191221
	speed: 0.0335s/iter; left time: 1534.1294s
	iters: 300, epoch: 3 | loss: 0.0042181
	speed: 0.0336s/iter; left time: 1534.4296s
	iters: 400, epoch: 3 | loss: 0.0219303
	speed: 0.0382s/iter; left time: 1739.7047s
Epoch: 3 cost time: 17.364280462265015
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
Validation loss decreased (-0.932245 --> -0.953972).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0148234
	speed: 0.2873s/iter; left time: 13043.1098s
	iters: 200, epoch: 4 | loss: 0.0136685
	speed: 0.0339s/iter; left time: 1534.1570s
	iters: 300, epoch: 4 | loss: 0.0089353
	speed: 0.0384s/iter; left time: 1734.2706s
	iters: 400, epoch: 4 | loss: 0.0422238
	speed: 0.0363s/iter; left time: 1635.0009s
Epoch: 4 cost time: 17.41750144958496
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
Validation loss decreased (-0.953972 --> -0.969409).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0046930
	speed: 0.2726s/iter; left time: 12244.7144s
	iters: 200, epoch: 5 | loss: 0.0108071
	speed: 0.0335s/iter; left time: 1500.1670s
	iters: 300, epoch: 5 | loss: 0.0259065
	speed: 0.0278s/iter; left time: 1243.2882s
	iters: 400, epoch: 5 | loss: 0.1461360
	speed: 0.0319s/iter; left time: 1425.5136s
Epoch: 5 cost time: 15.787287712097168
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0594658
	speed: 0.2674s/iter; left time: 11887.8216s
	iters: 200, epoch: 6 | loss: 0.0813940
	speed: 0.0303s/iter; left time: 1343.1548s
	iters: 300, epoch: 6 | loss: 0.0074808
	speed: 0.0298s/iter; left time: 1318.3003s
	iters: 400, epoch: 6 | loss: 0.0169442
	speed: 0.0309s/iter; left time: 1365.5519s
Epoch: 6 cost time: 15.453248023986816
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.969409 --> -0.970553).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0024897
	speed: 0.2792s/iter; left time: 12282.4584s
	iters: 200, epoch: 7 | loss: 0.0054661
	speed: 0.0372s/iter; left time: 1632.0767s
	iters: 300, epoch: 7 | loss: 0.0115334
	speed: 0.0427s/iter; left time: 1870.0162s
	iters: 400, epoch: 7 | loss: 0.0015516
	speed: 0.0381s/iter; left time: 1665.6453s
Epoch: 7 cost time: 18.64476704597473
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0140716
	speed: 0.2871s/iter; left time: 12495.0086s
	iters: 200, epoch: 8 | loss: 0.1155672
	speed: 0.0357s/iter; left time: 1548.6921s
	iters: 300, epoch: 8 | loss: 0.0032440
	speed: 0.0388s/iter; left time: 1680.0310s
	iters: 400, epoch: 8 | loss: 0.0161797
	speed: 0.0428s/iter; left time: 1849.3742s
Epoch: 8 cost time: 18.777936220169067
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0082976
	speed: 0.2939s/iter; left time: 12651.6047s
	iters: 200, epoch: 9 | loss: 0.0059755
	speed: 0.0392s/iter; left time: 1683.7235s
	iters: 300, epoch: 9 | loss: 0.0013739
	speed: 0.0408s/iter; left time: 1749.2656s
	iters: 400, epoch: 9 | loss: 0.0002493
	speed: 0.0450s/iter; left time: 1921.9388s
Epoch: 9 cost time: 19.378169775009155
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0349134
	speed: 0.3053s/iter; left time: 12997.7107s
	iters: 200, epoch: 10 | loss: 0.0043984
	speed: 0.0385s/iter; left time: 1635.3825s
	iters: 300, epoch: 10 | loss: 0.0000999
	speed: 0.0379s/iter; left time: 1606.5462s
	iters: 400, epoch: 10 | loss: 0.0570589
	speed: 0.0352s/iter; left time: 1489.2834s
Epoch: 10 cost time: 17.78356170654297
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.961 Test Loss: 0.260 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000776
	speed: 0.3074s/iter; left time: 12945.7315s
	iters: 200, epoch: 11 | loss: 0.0141148
	speed: 0.0394s/iter; left time: 1657.0807s
	iters: 300, epoch: 11 | loss: 0.0050901
	speed: 0.0362s/iter; left time: 1517.6887s
	iters: 400, epoch: 11 | loss: 0.0030902
	speed: 0.0353s/iter; left time: 1474.8345s
Epoch: 11 cost time: 17.875747203826904
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.213 Vali Acc: 0.968 Test Loss: 0.213 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4475495
	speed: 0.2896s/iter; left time: 12058.8816s
	iters: 200, epoch: 12 | loss: 0.0007566
	speed: 0.0407s/iter; left time: 1692.7223s
	iters: 300, epoch: 12 | loss: 0.0094917
	speed: 0.0417s/iter; left time: 1726.6358s
	iters: 400, epoch: 12 | loss: 0.0000540
	speed: 0.0432s/iter; left time: 1787.1409s
Epoch: 12 cost time: 19.985955476760864
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.256 Vali Acc: 0.961 Test Loss: 0.256 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0147128
	speed: 0.3052s/iter; left time: 12564.6227s
	iters: 200, epoch: 13 | loss: 0.0001510
	speed: 0.0434s/iter; left time: 1781.2809s
	iters: 300, epoch: 13 | loss: 0.1382827
	speed: 0.0445s/iter; left time: 1824.4318s
	iters: 400, epoch: 13 | loss: 0.0045340
	speed: 0.0432s/iter; left time: 1765.6722s
Epoch: 13 cost time: 20.396089553833008
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0018071
	speed: 0.3285s/iter; left time: 13370.4075s
	iters: 200, epoch: 14 | loss: 0.1229548
	speed: 0.0378s/iter; left time: 1535.5462s
	iters: 300, epoch: 14 | loss: 0.0090066
	speed: 0.0403s/iter; left time: 1632.8467s
	iters: 400, epoch: 14 | loss: 0.1168831
	speed: 0.0409s/iter; left time: 1653.8235s
Epoch: 14 cost time: 19.704234838485718
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.964 Test Loss: 0.225 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0231997
	speed: 0.3183s/iter; left time: 12808.5567s
	iters: 200, epoch: 15 | loss: 0.3283623
	speed: 0.0416s/iter; left time: 1671.1928s
	iters: 300, epoch: 15 | loss: 0.0011812
	speed: 0.0384s/iter; left time: 1537.2859s
	iters: 400, epoch: 15 | loss: 0.0112881
	speed: 0.0367s/iter; left time: 1464.1026s
Epoch: 15 cost time: 18.969356536865234
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.968 Test Loss: 0.238 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3731243
	speed: 0.2418s/iter; left time: 9616.8947s
	iters: 200, epoch: 16 | loss: 0.0050101
	speed: 0.0311s/iter; left time: 1232.0850s
	iters: 300, epoch: 16 | loss: 0.0002117
	speed: 0.0323s/iter; left time: 1277.0705s
	iters: 400, epoch: 16 | loss: 0.4793887
	speed: 0.0322s/iter; left time: 1270.1959s
Epoch: 16 cost time: 16.03012728691101
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.970553 --> -0.974555).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0005645
	speed: 0.2770s/iter; left time: 10884.1826s
	iters: 200, epoch: 17 | loss: 0.0000385
	speed: 0.0326s/iter; left time: 1277.9252s
	iters: 300, epoch: 17 | loss: 0.0066082
	speed: 0.0353s/iter; left time: 1378.3581s
	iters: 400, epoch: 17 | loss: 0.0004442
	speed: 0.0357s/iter; left time: 1390.9486s
Epoch: 17 cost time: 17.34235143661499
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.965 Test Loss: 0.270 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2156805
	speed: 0.2889s/iter; left time: 11218.1561s
	iters: 200, epoch: 18 | loss: 0.0003395
	speed: 0.0382s/iter; left time: 1479.8792s
	iters: 300, epoch: 18 | loss: 0.0315328
	speed: 0.0333s/iter; left time: 1287.5836s
	iters: 400, epoch: 18 | loss: 0.0004003
	speed: 0.0361s/iter; left time: 1389.9997s
Epoch: 18 cost time: 17.730085372924805
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0027438
	speed: 0.2818s/iter; left time: 10808.0868s
	iters: 200, epoch: 19 | loss: 0.0044605
	speed: 0.0344s/iter; left time: 1316.0138s
	iters: 300, epoch: 19 | loss: 0.0025971
	speed: 0.0368s/iter; left time: 1403.1958s
	iters: 400, epoch: 19 | loss: 0.0366879
	speed: 0.0356s/iter; left time: 1354.8161s
Epoch: 19 cost time: 16.993908405303955
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.191 Vali Acc: 0.971 Test Loss: 0.191 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0025870
	speed: 0.3053s/iter; left time: 11566.6871s
	iters: 200, epoch: 20 | loss: 0.0107640
	speed: 0.0387s/iter; left time: 1460.8847s
	iters: 300, epoch: 20 | loss: 0.2491359
	speed: 0.0371s/iter; left time: 1398.2546s
	iters: 400, epoch: 20 | loss: 0.0500945
	speed: 0.0384s/iter; left time: 1444.4153s
Epoch: 20 cost time: 18.709818840026855
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.219 Vali Acc: 0.965 Test Loss: 0.219 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0001374
	speed: 0.2842s/iter; left time: 10633.9245s
	iters: 200, epoch: 21 | loss: 0.0001214
	speed: 0.0379s/iter; left time: 1415.1382s
	iters: 300, epoch: 21 | loss: 0.0003899
	speed: 0.0409s/iter; left time: 1523.1952s
	iters: 400, epoch: 21 | loss: 0.0188607
	speed: 0.0345s/iter; left time: 1279.4636s
Epoch: 21 cost time: 18.584253072738647
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.971 Test Loss: 0.206 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0101524
	speed: 0.2881s/iter; left time: 10647.5114s
	iters: 200, epoch: 22 | loss: 0.0007457
	speed: 0.0382s/iter; left time: 1408.2914s
	iters: 300, epoch: 22 | loss: 0.0000074
	speed: 0.0328s/iter; left time: 1205.0517s
	iters: 400, epoch: 22 | loss: 0.0003322
	speed: 0.0346s/iter; left time: 1268.3100s
Epoch: 22 cost time: 18.112899780273438
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.971 Test Loss: 0.217 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0012061
	speed: 0.2989s/iter; left time: 10905.8538s
	iters: 200, epoch: 23 | loss: 0.0000147
	speed: 0.0383s/iter; left time: 1393.3206s
	iters: 300, epoch: 23 | loss: 0.0017770
	speed: 0.0355s/iter; left time: 1287.1262s
	iters: 400, epoch: 23 | loss: 0.0772460
	speed: 0.0382s/iter; left time: 1382.1222s
Epoch: 23 cost time: 18.802668809890747
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.251 Vali Acc: 0.962 Test Loss: 0.251 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0001949
	speed: 0.3222s/iter; left time: 11605.2124s
	iters: 200, epoch: 24 | loss: 0.0012818
	speed: 0.0369s/iter; left time: 1325.8894s
	iters: 300, epoch: 24 | loss: 0.0007357
	speed: 0.0348s/iter; left time: 1246.8114s
	iters: 400, epoch: 24 | loss: 0.0000842
	speed: 0.0344s/iter; left time: 1226.8973s
Epoch: 24 cost time: 17.634917497634888
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0068519
	speed: 0.3243s/iter; left time: 11527.4805s
	iters: 200, epoch: 25 | loss: 0.0000594
	speed: 0.0386s/iter; left time: 1368.3084s
	iters: 300, epoch: 25 | loss: 0.0959550
	speed: 0.0431s/iter; left time: 1521.6460s
	iters: 400, epoch: 25 | loss: 0.0209417
	speed: 0.0366s/iter; left time: 1290.7844s
Epoch: 25 cost time: 19.108871936798096
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.962 Test Loss: 0.225 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0335665
	speed: 0.3096s/iter; left time: 10859.3280s
	iters: 200, epoch: 26 | loss: 0.0000594
	speed: 0.0391s/iter; left time: 1368.7161s
	iters: 300, epoch: 26 | loss: 0.0002626
	speed: 0.0380s/iter; left time: 1323.9098s
	iters: 400, epoch: 26 | loss: 0.0001404
	speed: 0.0363s/iter; left time: 1261.3609s
Epoch: 26 cost time: 19.056947469711304
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 60490
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9990545
	speed: 0.0759s/iter; left time: 3554.4180s
	iters: 200, epoch: 1 | loss: 0.4428137
	speed: 0.0360s/iter; left time: 1680.3553s
	iters: 300, epoch: 1 | loss: 0.1416934
	speed: 0.0393s/iter; left time: 1830.3705s
	iters: 400, epoch: 1 | loss: 0.1795794
	speed: 0.0419s/iter; left time: 1949.3609s
Epoch: 1 cost time: 22.153733253479004
Epoch: 1, Steps: 469 | Train Loss: 0.641 Vali Loss: 0.298 Vali Acc: 0.915 Test Loss: 0.298 Test Acc: 0.915
Validation loss decreased (inf --> -0.915091).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0243410
	speed: 0.3189s/iter; left time: 14776.8730s
	iters: 200, epoch: 2 | loss: 0.1824777
	speed: 0.0415s/iter; left time: 1918.1988s
	iters: 300, epoch: 2 | loss: 0.3669177
	speed: 0.0375s/iter; left time: 1731.8097s
	iters: 400, epoch: 2 | loss: 0.1367743
	speed: 0.0422s/iter; left time: 1944.2139s
Epoch: 2 cost time: 19.983030796051025
Epoch: 2, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
Validation loss decreased (-0.915091 --> -0.948826).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0134099
	speed: 0.3045s/iter; left time: 13966.1838s
	iters: 200, epoch: 3 | loss: 0.0443083
	speed: 0.0392s/iter; left time: 1792.8781s
	iters: 300, epoch: 3 | loss: 0.0062813
	speed: 0.0415s/iter; left time: 1896.4993s
	iters: 400, epoch: 3 | loss: 0.0411429
	speed: 0.0352s/iter; left time: 1602.8371s
Epoch: 3 cost time: 18.986634492874146
Epoch: 3, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
Validation loss decreased (-0.948826 --> -0.966551).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0126277
	speed: 0.2977s/iter; left time: 13515.6937s
	iters: 200, epoch: 4 | loss: 0.0029772
	speed: 0.0424s/iter; left time: 1919.9963s
	iters: 300, epoch: 4 | loss: 0.0274767
	speed: 0.0367s/iter; left time: 1657.0393s
	iters: 400, epoch: 4 | loss: 0.0360686
	speed: 0.0357s/iter; left time: 1610.6279s
Epoch: 4 cost time: 18.131675720214844
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.165 Vali Acc: 0.966 Test Loss: 0.165 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0456371
	speed: 0.2753s/iter; left time: 12366.1500s
	iters: 200, epoch: 5 | loss: 0.0099954
	speed: 0.0331s/iter; left time: 1484.5489s
	iters: 300, epoch: 5 | loss: 0.0076248
	speed: 0.0487s/iter; left time: 2180.0874s
	iters: 400, epoch: 5 | loss: 0.0177220
	speed: 0.0429s/iter; left time: 1913.4738s
Epoch: 5 cost time: 19.122790098190308
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.248 Vali Acc: 0.954 Test Loss: 0.248 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4832497
	speed: 0.2845s/iter; left time: 12648.2992s
	iters: 200, epoch: 6 | loss: 0.0038659
	speed: 0.0347s/iter; left time: 1539.2800s
	iters: 300, epoch: 6 | loss: 0.0041028
	speed: 0.0380s/iter; left time: 1683.2582s
	iters: 400, epoch: 6 | loss: 0.0088634
	speed: 0.0346s/iter; left time: 1528.2770s
Epoch: 6 cost time: 17.30958580970764
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.966551 --> -0.971411).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0149959
	speed: 0.3184s/iter; left time: 14003.6831s
	iters: 200, epoch: 7 | loss: 0.0020127
	speed: 0.0335s/iter; left time: 1468.8141s
	iters: 300, epoch: 7 | loss: 0.0077811
	speed: 0.0312s/iter; left time: 1365.5079s
	iters: 400, epoch: 7 | loss: 0.0563498
	speed: 0.0336s/iter; left time: 1465.7107s
Epoch: 7 cost time: 17.0966477394104
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0022075
	speed: 0.2884s/iter; left time: 12549.0796s
	iters: 200, epoch: 8 | loss: 0.0102913
	speed: 0.0370s/iter; left time: 1605.3981s
	iters: 300, epoch: 8 | loss: 0.0033125
	speed: 0.0354s/iter; left time: 1532.6472s
	iters: 400, epoch: 8 | loss: 0.0064847
	speed: 0.0372s/iter; left time: 1607.3014s
Epoch: 8 cost time: 17.872520685195923
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0014797
	speed: 0.3235s/iter; left time: 13924.8274s
	iters: 200, epoch: 9 | loss: 0.0215044
	speed: 0.0399s/iter; left time: 1713.8801s
	iters: 300, epoch: 9 | loss: 0.0442069
	speed: 0.0412s/iter; left time: 1766.2747s
	iters: 400, epoch: 9 | loss: 0.0732344
	speed: 0.0413s/iter; left time: 1765.0645s
Epoch: 9 cost time: 19.678316593170166
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.963 Test Loss: 0.215 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0014594
	speed: 0.2898s/iter; left time: 12338.0121s
	iters: 200, epoch: 10 | loss: 0.0019945
	speed: 0.0318s/iter; left time: 1350.6809s
	iters: 300, epoch: 10 | loss: 0.0024757
	speed: 0.0396s/iter; left time: 1677.9849s
	iters: 400, epoch: 10 | loss: 0.7095857
	speed: 0.0463s/iter; left time: 1956.1183s
Epoch: 10 cost time: 18.472153902053833
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0529538
	speed: 0.3042s/iter; left time: 12809.8457s
	iters: 200, epoch: 11 | loss: 0.0137297
	speed: 0.0354s/iter; left time: 1488.0144s
	iters: 300, epoch: 11 | loss: 0.0020765
	speed: 0.0376s/iter; left time: 1577.8348s
	iters: 400, epoch: 11 | loss: 0.0205743
	speed: 0.0339s/iter; left time: 1417.4344s
Epoch: 11 cost time: 17.556721448898315
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.238 Vali Acc: 0.954 Test Loss: 0.238 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0231415
	speed: 0.2909s/iter; left time: 12114.9050s
	iters: 200, epoch: 12 | loss: 0.0029811
	speed: 0.0300s/iter; left time: 1244.6419s
	iters: 300, epoch: 12 | loss: 0.0010582
	speed: 0.0457s/iter; left time: 1892.5094s
	iters: 400, epoch: 12 | loss: 0.0068159
	speed: 0.0355s/iter; left time: 1467.2305s
Epoch: 12 cost time: 18.117016792297363
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.971 Test Loss: 0.196 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0259161
	speed: 0.2969s/iter; left time: 12224.9901s
	iters: 200, epoch: 13 | loss: 0.0023950
	speed: 0.0384s/iter; left time: 1576.1468s
	iters: 300, epoch: 13 | loss: 0.0008504
	speed: 0.0361s/iter; left time: 1480.5210s
	iters: 400, epoch: 13 | loss: 0.0628182
	speed: 0.0369s/iter; left time: 1506.7052s
Epoch: 13 cost time: 17.986310243606567
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.971411 --> -0.976557).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0088698
	speed: 0.2948s/iter; left time: 12001.3896s
	iters: 200, epoch: 14 | loss: 0.0006976
	speed: 0.0344s/iter; left time: 1398.3766s
	iters: 300, epoch: 14 | loss: 0.0011475
	speed: 0.0330s/iter; left time: 1334.7068s
	iters: 400, epoch: 14 | loss: 0.2024509
	speed: 0.0389s/iter; left time: 1573.3924s
Epoch: 14 cost time: 17.47599458694458
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0006208
	speed: 0.2897s/iter; left time: 11656.2544s
	iters: 200, epoch: 15 | loss: 0.0090554
	speed: 0.0299s/iter; left time: 1201.1743s
	iters: 300, epoch: 15 | loss: 0.0257417
	speed: 0.0314s/iter; left time: 1257.0603s
	iters: 400, epoch: 15 | loss: 0.0003718
	speed: 0.0340s/iter; left time: 1357.1676s
Epoch: 15 cost time: 15.800239086151123
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.969 Test Loss: 0.236 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0318651
	speed: 0.2749s/iter; left time: 10932.2331s
	iters: 200, epoch: 16 | loss: 0.0265403
	speed: 0.0326s/iter; left time: 1291.6798s
	iters: 300, epoch: 16 | loss: 0.0001145
	speed: 0.0300s/iter; left time: 1185.4586s
	iters: 400, epoch: 16 | loss: 0.0000262
	speed: 0.0303s/iter; left time: 1196.1642s
Epoch: 16 cost time: 15.808051824569702
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977986).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0183649
	speed: 0.2946s/iter; left time: 11576.0049s
	iters: 200, epoch: 17 | loss: 0.0005798
	speed: 0.0339s/iter; left time: 1326.8706s
	iters: 300, epoch: 17 | loss: 0.0185802
	speed: 0.0389s/iter; left time: 1520.3780s
	iters: 400, epoch: 17 | loss: 0.0001896
	speed: 0.0322s/iter; left time: 1254.5246s
Epoch: 17 cost time: 16.934507608413696
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.968 Test Loss: 0.212 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0011980
	speed: 0.2857s/iter; left time: 11092.7161s
	iters: 200, epoch: 18 | loss: 0.0057989
	speed: 0.0351s/iter; left time: 1358.7908s
	iters: 300, epoch: 18 | loss: 0.0019897
	speed: 0.0422s/iter; left time: 1628.9645s
	iters: 400, epoch: 18 | loss: 0.0003519
	speed: 0.0331s/iter; left time: 1275.4520s
Epoch: 18 cost time: 18.11107563972473
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0024391
	speed: 0.2797s/iter; left time: 10728.3804s
	iters: 200, epoch: 19 | loss: 0.2155810
	speed: 0.0385s/iter; left time: 1473.0301s
	iters: 300, epoch: 19 | loss: 0.0057811
	speed: 0.0389s/iter; left time: 1482.8754s
	iters: 400, epoch: 19 | loss: 0.0000327
	speed: 0.0387s/iter; left time: 1474.6547s
Epoch: 19 cost time: 19.042314767837524
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.229 Vali Acc: 0.965 Test Loss: 0.229 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0340089
	speed: 0.2955s/iter; left time: 11197.2572s
	iters: 200, epoch: 20 | loss: 0.0958873
	speed: 0.0330s/iter; left time: 1248.7145s
	iters: 300, epoch: 20 | loss: 0.0000154
	speed: 0.0336s/iter; left time: 1267.8013s
	iters: 400, epoch: 20 | loss: 0.0982178
	speed: 0.0344s/iter; left time: 1292.7256s
Epoch: 20 cost time: 17.96665930747986
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.235 Vali Acc: 0.966 Test Loss: 0.235 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0020196
	speed: 0.2823s/iter; left time: 10563.3059s
	iters: 200, epoch: 21 | loss: 0.0000587
	speed: 0.0295s/iter; left time: 1100.9484s
	iters: 300, epoch: 21 | loss: 0.0001061
	speed: 0.0352s/iter; left time: 1309.1211s
	iters: 400, epoch: 21 | loss: 0.0040454
	speed: 0.0318s/iter; left time: 1179.0373s
Epoch: 21 cost time: 16.370119333267212
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.263 Vali Acc: 0.968 Test Loss: 0.263 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0002073
	speed: 0.3249s/iter; left time: 12004.6120s
	iters: 200, epoch: 22 | loss: 0.3467659
	speed: 0.0399s/iter; left time: 1471.5359s
	iters: 300, epoch: 22 | loss: 0.0001954
	speed: 0.0383s/iter; left time: 1407.3339s
	iters: 400, epoch: 22 | loss: 0.0005823
	speed: 0.0361s/iter; left time: 1322.3803s
Epoch: 22 cost time: 19.29077982902527
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.969 Test Loss: 0.201 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0068429
	speed: 0.2901s/iter; left time: 10583.9549s
	iters: 200, epoch: 23 | loss: 0.0002467
	speed: 0.0410s/iter; left time: 1491.8771s
	iters: 300, epoch: 23 | loss: 0.0054570
	speed: 0.0356s/iter; left time: 1289.9540s
	iters: 400, epoch: 23 | loss: 0.3535296
	speed: 0.0384s/iter; left time: 1389.0548s
Epoch: 23 cost time: 18.559787034988403
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.253 Vali Acc: 0.967 Test Loss: 0.253 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0357836
	speed: 0.2878s/iter; left time: 10363.4718s
	iters: 200, epoch: 24 | loss: 0.0333818
	speed: 0.0414s/iter; left time: 1487.1221s
	iters: 300, epoch: 24 | loss: 0.0000155
	speed: 0.0384s/iter; left time: 1374.2856s
	iters: 400, epoch: 24 | loss: 0.0000571
	speed: 0.0393s/iter; left time: 1401.9750s
Epoch: 24 cost time: 18.80520462989807
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.974 Test Loss: 0.201 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0006462
	speed: 0.3269s/iter; left time: 11618.3770s
	iters: 200, epoch: 25 | loss: 0.0060459
	speed: 0.0464s/iter; left time: 1643.1708s
	iters: 300, epoch: 25 | loss: 0.0002251
	speed: 0.0479s/iter; left time: 1693.2939s
	iters: 400, epoch: 25 | loss: 0.3069819
	speed: 0.0423s/iter; left time: 1492.2677s
Epoch: 25 cost time: 21.375539302825928
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0007318
	speed: 0.3199s/iter; left time: 11219.6767s
	iters: 200, epoch: 26 | loss: 0.0000234
	speed: 0.0414s/iter; left time: 1447.2562s
	iters: 300, epoch: 26 | loss: 0.0001926
	speed: 0.0429s/iter; left time: 1495.3214s
	iters: 400, epoch: 26 | loss: 0.0778570
	speed: 0.0410s/iter; left time: 1424.4133s
Epoch: 26 cost time: 20.079238414764404
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.968 Test Loss: 0.233 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 43978
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7626613
	speed: 0.0712s/iter; left time: 3334.0641s
	iters: 200, epoch: 1 | loss: 0.3762192
	speed: 0.0331s/iter; left time: 1546.8994s
	iters: 300, epoch: 1 | loss: 0.1038052
	speed: 0.0330s/iter; left time: 1537.3948s
	iters: 400, epoch: 1 | loss: 0.1655704
	speed: 0.0393s/iter; left time: 1827.0001s
Epoch: 1 cost time: 20.053957223892212
Epoch: 1, Steps: 469 | Train Loss: 0.638 Vali Loss: 0.311 Vali Acc: 0.916 Test Loss: 0.311 Test Acc: 0.916
Validation loss decreased (inf --> -0.916235).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1850306
	speed: 0.2689s/iter; left time: 12458.8876s
	iters: 200, epoch: 2 | loss: 0.0813866
	speed: 0.0359s/iter; left time: 1660.1772s
	iters: 300, epoch: 2 | loss: 0.2360429
	speed: 0.0324s/iter; left time: 1496.3415s
	iters: 400, epoch: 2 | loss: 0.0440196
	speed: 0.0321s/iter; left time: 1475.8726s
Epoch: 2 cost time: 16.425792455673218
Epoch: 2, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
Validation loss decreased (-0.916235 --> -0.942822).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0659384
	speed: 0.2695s/iter; left time: 12362.3121s
	iters: 200, epoch: 3 | loss: 0.0511121
	speed: 0.0366s/iter; left time: 1673.7420s
	iters: 300, epoch: 3 | loss: 0.0248890
	speed: 0.0317s/iter; left time: 1448.0260s
	iters: 400, epoch: 3 | loss: 0.0358387
	speed: 0.0342s/iter; left time: 1557.3566s
Epoch: 3 cost time: 16.20983576774597
Epoch: 3, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
Validation loss decreased (-0.942822 --> -0.961405).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0105872
	speed: 0.2830s/iter; left time: 12846.7523s
	iters: 200, epoch: 4 | loss: 0.0429581
	speed: 0.0368s/iter; left time: 1668.3934s
	iters: 300, epoch: 4 | loss: 0.1079685
	speed: 0.0334s/iter; left time: 1511.3465s
	iters: 400, epoch: 4 | loss: 0.0030495
	speed: 0.0309s/iter; left time: 1392.1380s
Epoch: 4 cost time: 15.76950454711914
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0108465
	speed: 0.2350s/iter; left time: 10558.6034s
	iters: 200, epoch: 5 | loss: 0.0096885
	speed: 0.0298s/iter; left time: 1334.0544s
	iters: 300, epoch: 5 | loss: 0.0113198
	speed: 0.0273s/iter; left time: 1220.6735s
	iters: 400, epoch: 5 | loss: 0.0037366
	speed: 0.0310s/iter; left time: 1382.3111s
Epoch: 5 cost time: 14.319993019104004
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
Validation loss decreased (-0.961405 --> -0.963978).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1348644
	speed: 0.2485s/iter; left time: 11047.2651s
	iters: 200, epoch: 6 | loss: 0.0054503
	speed: 0.0285s/iter; left time: 1263.0233s
	iters: 300, epoch: 6 | loss: 0.0133264
	speed: 0.0342s/iter; left time: 1512.8869s
	iters: 400, epoch: 6 | loss: 0.0098412
	speed: 0.0365s/iter; left time: 1613.3406s
Epoch: 6 cost time: 15.919263124465942
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0744746
	speed: 0.2402s/iter; left time: 10567.6222s
	iters: 200, epoch: 7 | loss: 0.0009780
	speed: 0.0287s/iter; left time: 1258.5788s
	iters: 300, epoch: 7 | loss: 0.0004520
	speed: 0.0324s/iter; left time: 1417.7618s
	iters: 400, epoch: 7 | loss: 0.0904401
	speed: 0.0307s/iter; left time: 1340.2040s
Epoch: 7 cost time: 14.884134531021118
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.192 Vali Acc: 0.965 Test Loss: 0.192 Test Acc: 0.965
Validation loss decreased (-0.963978 --> -0.965121).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0176185
	speed: 0.2570s/iter; left time: 11184.5085s
	iters: 200, epoch: 8 | loss: 0.0013182
	speed: 0.0340s/iter; left time: 1474.1425s
	iters: 300, epoch: 8 | loss: 0.0005231
	speed: 0.0339s/iter; left time: 1467.1727s
	iters: 400, epoch: 8 | loss: 0.0025774
	speed: 0.0322s/iter; left time: 1389.9021s
Epoch: 8 cost time: 16.817856311798096
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
Validation loss decreased (-0.965121 --> -0.968266).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3072934
	speed: 0.2653s/iter; left time: 11422.5440s
	iters: 200, epoch: 9 | loss: 0.0001642
	speed: 0.0364s/iter; left time: 1564.7126s
	iters: 300, epoch: 9 | loss: 0.0642651
	speed: 0.0355s/iter; left time: 1521.8219s
	iters: 400, epoch: 9 | loss: 0.0041136
	speed: 0.0339s/iter; left time: 1449.0484s
Epoch: 9 cost time: 17.387104272842407
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.244 Vali Acc: 0.961 Test Loss: 0.244 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2200101
	speed: 0.2692s/iter; left time: 11461.5708s
	iters: 200, epoch: 10 | loss: 0.0026558
	speed: 0.0414s/iter; left time: 1760.1758s
	iters: 300, epoch: 10 | loss: 0.0806635
	speed: 0.0373s/iter; left time: 1580.8539s
	iters: 400, epoch: 10 | loss: 0.1118221
	speed: 0.0336s/iter; left time: 1421.5103s
Epoch: 10 cost time: 18.181451320648193
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.964 Test Loss: 0.217 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2726701
	speed: 0.2748s/iter; left time: 11570.9523s
	iters: 200, epoch: 11 | loss: 0.4220337
	speed: 0.0316s/iter; left time: 1326.8530s
	iters: 300, epoch: 11 | loss: 0.0152566
	speed: 0.0344s/iter; left time: 1442.2770s
	iters: 400, epoch: 11 | loss: 0.0283914
	speed: 0.0335s/iter; left time: 1399.0958s
Epoch: 11 cost time: 16.339598655700684
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.968266 --> -0.973412).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0621579
	speed: 0.2598s/iter; left time: 10817.1566s
	iters: 200, epoch: 12 | loss: 0.0188908
	speed: 0.0322s/iter; left time: 1338.2407s
	iters: 300, epoch: 12 | loss: 0.0000776
	speed: 0.0310s/iter; left time: 1283.4621s
	iters: 400, epoch: 12 | loss: 0.0005555
	speed: 0.0328s/iter; left time: 1355.4076s
Epoch: 12 cost time: 16.159390687942505
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.965 Test Loss: 0.222 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001067
	speed: 0.2695s/iter; left time: 11096.6463s
	iters: 200, epoch: 13 | loss: 0.0019823
	speed: 0.0318s/iter; left time: 1307.3467s
	iters: 300, epoch: 13 | loss: 0.0081825
	speed: 0.0300s/iter; left time: 1230.3935s
	iters: 400, epoch: 13 | loss: 0.0003807
	speed: 0.0369s/iter; left time: 1506.5096s
Epoch: 13 cost time: 16.822765827178955
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
Validation loss decreased (-0.973412 --> -0.975699).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0007691
	speed: 0.2653s/iter; left time: 10798.4611s
	iters: 200, epoch: 14 | loss: 0.0005822
	speed: 0.0352s/iter; left time: 1427.9985s
	iters: 300, epoch: 14 | loss: 0.0024697
	speed: 0.0329s/iter; left time: 1333.0102s
	iters: 400, epoch: 14 | loss: 0.0003562
	speed: 0.0355s/iter; left time: 1432.9540s
Epoch: 14 cost time: 16.745716094970703
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0346810
	speed: 0.2776s/iter; left time: 11168.3857s
	iters: 200, epoch: 15 | loss: 0.0008866
	speed: 0.0299s/iter; left time: 1200.0557s
	iters: 300, epoch: 15 | loss: 0.0943315
	speed: 0.0338s/iter; left time: 1353.8387s
	iters: 400, epoch: 15 | loss: 0.0011829
	speed: 0.0307s/iter; left time: 1226.0140s
Epoch: 15 cost time: 15.98109483718872
Epoch: 15, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0029888
	speed: 0.2617s/iter; left time: 10407.4601s
	iters: 200, epoch: 16 | loss: 0.0906671
	speed: 0.0320s/iter; left time: 1270.8771s
	iters: 300, epoch: 16 | loss: 0.0000608
	speed: 0.0330s/iter; left time: 1306.8306s
	iters: 400, epoch: 16 | loss: 0.0008332
	speed: 0.0290s/iter; left time: 1146.4870s
Epoch: 16 cost time: 16.140464305877686
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0128310
	speed: 0.2672s/iter; left time: 10498.7858s
	iters: 200, epoch: 17 | loss: 0.2321830
	speed: 0.0372s/iter; left time: 1458.0382s
	iters: 300, epoch: 17 | loss: 0.0006807
	speed: 0.0341s/iter; left time: 1333.3819s
	iters: 400, epoch: 17 | loss: 0.0025542
	speed: 0.0362s/iter; left time: 1411.5332s
Epoch: 17 cost time: 17.163516521453857
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0007952
	speed: 0.2551s/iter; left time: 9906.6712s
	iters: 200, epoch: 18 | loss: 0.0007963
	speed: 0.0282s/iter; left time: 1093.9793s
	iters: 300, epoch: 18 | loss: 0.0183083
	speed: 0.0332s/iter; left time: 1281.6796s
	iters: 400, epoch: 18 | loss: 0.0306665
	speed: 0.0274s/iter; left time: 1054.2952s
Epoch: 18 cost time: 15.012873888015747
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977700).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001080
	speed: 0.2632s/iter; left time: 10096.6213s
	iters: 200, epoch: 19 | loss: 0.0554013
	speed: 0.0347s/iter; left time: 1329.2632s
	iters: 300, epoch: 19 | loss: 0.0000383
	speed: 0.0348s/iter; left time: 1329.7419s
	iters: 400, epoch: 19 | loss: 0.0000316
	speed: 0.0338s/iter; left time: 1287.7788s
Epoch: 19 cost time: 17.12176537513733
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.971 Test Loss: 0.209 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0095920
	speed: 0.2631s/iter; left time: 9968.5405s
	iters: 200, epoch: 20 | loss: 0.2069665
	speed: 0.0343s/iter; left time: 1295.8692s
	iters: 300, epoch: 20 | loss: 0.0009160
	speed: 0.0355s/iter; left time: 1336.8317s
	iters: 400, epoch: 20 | loss: 0.0003408
	speed: 0.0325s/iter; left time: 1221.7399s
Epoch: 20 cost time: 16.355909824371338
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1138938
	speed: 0.2445s/iter; left time: 9151.0063s
	iters: 200, epoch: 21 | loss: 0.0013449
	speed: 0.0315s/iter; left time: 1176.4354s
	iters: 300, epoch: 21 | loss: 0.0569269
	speed: 0.0332s/iter; left time: 1235.3771s
	iters: 400, epoch: 21 | loss: 0.0127126
	speed: 0.0353s/iter; left time: 1309.6780s
Epoch: 21 cost time: 16.497050285339355
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.973 Test Loss: 0.193 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0006568
	speed: 0.2505s/iter; left time: 9256.0110s
	iters: 200, epoch: 22 | loss: 0.0000567
	speed: 0.0333s/iter; left time: 1225.8160s
	iters: 300, epoch: 22 | loss: 0.0006166
	speed: 0.0325s/iter; left time: 1192.8372s
	iters: 400, epoch: 22 | loss: 0.0360423
	speed: 0.0353s/iter; left time: 1294.7171s
Epoch: 22 cost time: 16.87935757637024
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0982342
	speed: 0.2874s/iter; left time: 10484.5955s
	iters: 200, epoch: 23 | loss: 0.0047667
	speed: 0.0325s/iter; left time: 1183.0983s
	iters: 300, epoch: 23 | loss: 0.0046487
	speed: 0.0358s/iter; left time: 1297.5594s
	iters: 400, epoch: 23 | loss: 0.0000452
	speed: 0.0344s/iter; left time: 1244.3936s
Epoch: 23 cost time: 17.081661701202393
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.979 Test Loss: 0.150 Test Acc: 0.979
Validation loss decreased (-0.977700 --> -0.979129).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000038
	speed: 0.2807s/iter; left time: 10110.3825s
	iters: 200, epoch: 24 | loss: 0.0009769
	speed: 0.0321s/iter; left time: 1152.6900s
	iters: 300, epoch: 24 | loss: 0.0221446
	speed: 0.0323s/iter; left time: 1155.2379s
	iters: 400, epoch: 24 | loss: 0.0401024
	speed: 0.0281s/iter; left time: 1004.7265s
Epoch: 24 cost time: 14.723331451416016
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0004824
	speed: 0.2431s/iter; left time: 8639.2552s
	iters: 200, epoch: 25 | loss: 0.0047270
	speed: 0.0259s/iter; left time: 918.3812s
	iters: 300, epoch: 25 | loss: 0.0006724
	speed: 0.0302s/iter; left time: 1067.5042s
	iters: 400, epoch: 25 | loss: 0.0000224
	speed: 0.0309s/iter; left time: 1090.1951s
Epoch: 25 cost time: 14.647262573242188
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.976 Test Loss: 0.198 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0010486
	speed: 0.2373s/iter; left time: 8323.6192s
	iters: 200, epoch: 26 | loss: 0.0000853
	speed: 0.0291s/iter; left time: 1016.1415s
	iters: 300, epoch: 26 | loss: 0.0002101
	speed: 0.0290s/iter; left time: 1011.3072s
	iters: 400, epoch: 26 | loss: 0.8739559
	speed: 0.0239s/iter; left time: 832.8043s
Epoch: 26 cost time: 13.566419124603271
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.978 Test Loss: 0.208 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000968
	speed: 0.2236s/iter; left time: 7739.5066s
	iters: 200, epoch: 27 | loss: 0.0000540
	speed: 0.0255s/iter; left time: 880.7698s
	iters: 300, epoch: 27 | loss: 0.0000716
	speed: 0.0291s/iter; left time: 1002.9624s
	iters: 400, epoch: 27 | loss: 0.0000078
	speed: 0.0370s/iter; left time: 1270.7389s
Epoch: 27 cost time: 14.782278776168823
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.260 Vali Acc: 0.967 Test Loss: 0.260 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0075123
	speed: 0.2160s/iter; left time: 7372.5922s
	iters: 200, epoch: 28 | loss: 0.0006792
	speed: 0.0261s/iter; left time: 887.4114s
	iters: 300, epoch: 28 | loss: 0.0008869
	speed: 0.0224s/iter; left time: 760.1974s
	iters: 400, epoch: 28 | loss: 0.0000244
	speed: 0.0273s/iter; left time: 923.0288s
Epoch: 28 cost time: 13.4866943359375
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.965 Test Loss: 0.231 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0034323
	speed: 0.2966s/iter; left time: 9986.4545s
	iters: 200, epoch: 29 | loss: 0.0006342
	speed: 0.0475s/iter; left time: 1593.8430s
	iters: 300, epoch: 29 | loss: 0.0008744
	speed: 0.0424s/iter; left time: 1419.5712s
	iters: 400, epoch: 29 | loss: 0.0001872
	speed: 0.0400s/iter; left time: 1336.3592s
Epoch: 29 cost time: 20.783873319625854
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.263 Vali Acc: 0.963 Test Loss: 0.263 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0002712
	speed: 0.2980s/iter; left time: 9895.1878s
	iters: 200, epoch: 30 | loss: 0.0018647
	speed: 0.0386s/iter; left time: 1277.8692s
	iters: 300, epoch: 30 | loss: 0.0064642
	speed: 0.0449s/iter; left time: 1483.2977s
	iters: 400, epoch: 30 | loss: 0.0125352
	speed: 0.0443s/iter; left time: 1456.3250s
Epoch: 30 cost time: 20.419254064559937
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.969 Test Loss: 0.214 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0089231
	speed: 0.3151s/iter; left time: 10313.6215s
	iters: 200, epoch: 31 | loss: 0.0000145
	speed: 0.0345s/iter; left time: 1125.4182s
	iters: 300, epoch: 31 | loss: 0.0097507
	speed: 0.0344s/iter; left time: 1119.0182s
	iters: 400, epoch: 31 | loss: 0.0000219
	speed: 0.0388s/iter; left time: 1258.1224s
Epoch: 31 cost time: 17.811638832092285
Epoch: 31, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.253 Vali Acc: 0.968 Test Loss: 0.253 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0001074
	speed: 0.3016s/iter; left time: 9728.7894s
	iters: 200, epoch: 32 | loss: 0.0000009
	speed: 0.0367s/iter; left time: 1181.9316s
	iters: 300, epoch: 32 | loss: 0.0009916
	speed: 0.0386s/iter; left time: 1236.8016s
	iters: 400, epoch: 32 | loss: 0.3254386
	speed: 0.0353s/iter; left time: 1128.9733s
Epoch: 32 cost time: 17.49210500717163
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0005367
	speed: 0.2916s/iter; left time: 9271.5911s
	iters: 200, epoch: 33 | loss: 0.0001063
	speed: 0.0384s/iter; left time: 1215.4955s
	iters: 300, epoch: 33 | loss: 0.0115288
	speed: 0.0342s/iter; left time: 1081.4226s
	iters: 400, epoch: 33 | loss: 0.0000034
	speed: 0.0372s/iter; left time: 1172.2023s
Epoch: 33 cost time: 18.44661021232605
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 35722
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5441746
	speed: 0.0749s/iter; left time: 3507.4209s
	iters: 200, epoch: 1 | loss: 0.5245224
	speed: 0.0386s/iter; left time: 1801.8534s
	iters: 300, epoch: 1 | loss: 0.6229608
	speed: 0.0349s/iter; left time: 1624.3782s
	iters: 400, epoch: 1 | loss: 0.2491352
	speed: 0.0389s/iter; left time: 1807.9812s
Epoch: 1 cost time: 21.60411810874939
Epoch: 1, Steps: 469 | Train Loss: 0.844 Vali Loss: 0.393 Vali Acc: 0.890 Test Loss: 0.393 Test Acc: 0.890
Validation loss decreased (inf --> -0.889933).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3199231
	speed: 0.2957s/iter; left time: 13699.9765s
	iters: 200, epoch: 2 | loss: 0.2922282
	speed: 0.0389s/iter; left time: 1800.0636s
	iters: 300, epoch: 2 | loss: 0.3712669
	speed: 0.0381s/iter; left time: 1756.9868s
	iters: 400, epoch: 2 | loss: 0.0670322
	speed: 0.0433s/iter; left time: 1992.6902s
Epoch: 2 cost time: 19.71851873397827
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.272 Vali Acc: 0.932 Test Loss: 0.272 Test Acc: 0.932
Validation loss decreased (-0.889933 --> -0.931958).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1632774
	speed: 0.2922s/iter; left time: 13402.6342s
	iters: 200, epoch: 3 | loss: 0.0447689
	speed: 0.0409s/iter; left time: 1871.9424s
	iters: 300, epoch: 3 | loss: 0.1876279
	speed: 0.0391s/iter; left time: 1786.0160s
	iters: 400, epoch: 3 | loss: 0.0205469
	speed: 0.0365s/iter; left time: 1661.6534s
Epoch: 3 cost time: 19.45295262336731
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
Validation loss decreased (-0.931958 --> -0.946253).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0586880
	speed: 0.2980s/iter; left time: 13528.8793s
	iters: 200, epoch: 4 | loss: 0.2173668
	speed: 0.0360s/iter; left time: 1629.1190s
	iters: 300, epoch: 4 | loss: 0.0855709
	speed: 0.0336s/iter; left time: 1516.6688s
	iters: 400, epoch: 4 | loss: 0.0132272
	speed: 0.0337s/iter; left time: 1517.8048s
Epoch: 4 cost time: 17.502981901168823
Epoch: 4, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
Validation loss decreased (-0.946253 --> -0.962262).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0326331
	speed: 0.2777s/iter; left time: 12473.9715s
	iters: 200, epoch: 5 | loss: 0.0332111
	speed: 0.0328s/iter; left time: 1469.0132s
	iters: 300, epoch: 5 | loss: 0.0096642
	speed: 0.0339s/iter; left time: 1515.4993s
	iters: 400, epoch: 5 | loss: 0.0362830
	speed: 0.0314s/iter; left time: 1402.1554s
Epoch: 5 cost time: 16.240073919296265
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0204551
	speed: 0.2762s/iter; left time: 12279.9567s
	iters: 200, epoch: 6 | loss: 0.0189452
	speed: 0.0380s/iter; left time: 1687.3904s
	iters: 300, epoch: 6 | loss: 0.1154437
	speed: 0.0343s/iter; left time: 1518.9528s
	iters: 400, epoch: 6 | loss: 0.0180449
	speed: 0.0402s/iter; left time: 1775.3219s
Epoch: 6 cost time: 17.684860706329346
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.962262 --> -0.962548).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0144003
	speed: 0.2840s/iter; left time: 12493.4206s
	iters: 200, epoch: 7 | loss: 0.0069710
	speed: 0.0337s/iter; left time: 1478.6983s
	iters: 300, epoch: 7 | loss: 0.1928840
	speed: 0.0396s/iter; left time: 1735.7724s
	iters: 400, epoch: 7 | loss: 0.1066644
	speed: 0.0348s/iter; left time: 1518.3036s
Epoch: 7 cost time: 17.652493000030518
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.191 Vali Acc: 0.961 Test Loss: 0.191 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0835483
	speed: 0.3106s/iter; left time: 13514.7409s
	iters: 200, epoch: 8 | loss: 0.0032565
	speed: 0.0407s/iter; left time: 1766.5599s
	iters: 300, epoch: 8 | loss: 0.0200734
	speed: 0.0395s/iter; left time: 1709.1323s
	iters: 400, epoch: 8 | loss: 0.0382227
	speed: 0.0388s/iter; left time: 1675.3676s
Epoch: 8 cost time: 19.50107479095459
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
Validation loss decreased (-0.962548 --> -0.970553).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0096490
	speed: 0.2893s/iter; left time: 12455.3787s
	iters: 200, epoch: 9 | loss: 0.0062392
	speed: 0.0432s/iter; left time: 1853.8489s
	iters: 300, epoch: 9 | loss: 0.0055142
	speed: 0.0431s/iter; left time: 1846.6629s
	iters: 400, epoch: 9 | loss: 0.0068450
	speed: 0.0398s/iter; left time: 1703.3111s
Epoch: 9 cost time: 19.984097480773926
Epoch: 9, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0940166
	speed: 0.3088s/iter; left time: 13149.9131s
	iters: 200, epoch: 10 | loss: 0.0016970
	speed: 0.0431s/iter; left time: 1831.6722s
	iters: 300, epoch: 10 | loss: 0.0019688
	speed: 0.0436s/iter; left time: 1847.6394s
	iters: 400, epoch: 10 | loss: 0.0062615
	speed: 0.0384s/iter; left time: 1622.0715s
Epoch: 10 cost time: 19.762080430984497
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0049643
	speed: 0.2623s/iter; left time: 11043.9210s
	iters: 200, epoch: 11 | loss: 0.1165512
	speed: 0.0333s/iter; left time: 1397.5542s
	iters: 300, epoch: 11 | loss: 0.0096105
	speed: 0.0393s/iter; left time: 1645.8542s
	iters: 400, epoch: 11 | loss: 0.0172965
	speed: 0.0345s/iter; left time: 1442.7665s
Epoch: 11 cost time: 17.547701835632324
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1856754
	speed: 0.2760s/iter; left time: 11494.6578s
	iters: 200, epoch: 12 | loss: 0.0015791
	speed: 0.0277s/iter; left time: 1150.2706s
	iters: 300, epoch: 12 | loss: 0.0362738
	speed: 0.0313s/iter; left time: 1297.1816s
	iters: 400, epoch: 12 | loss: 0.0438503
	speed: 0.0283s/iter; left time: 1170.9624s
Epoch: 12 cost time: 15.302819013595581
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1260188
	speed: 0.2592s/iter; left time: 10671.9375s
	iters: 200, epoch: 13 | loss: 0.1760328
	speed: 0.0295s/iter; left time: 1213.4045s
	iters: 300, epoch: 13 | loss: 0.0065560
	speed: 0.0289s/iter; left time: 1183.5514s
	iters: 400, epoch: 13 | loss: 0.0029408
	speed: 0.0333s/iter; left time: 1359.8603s
Epoch: 13 cost time: 14.94260859489441
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
Validation loss decreased (-0.970553 --> -0.970839).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0322309
	speed: 0.2503s/iter; left time: 10187.1548s
	iters: 200, epoch: 14 | loss: 0.0026628
	speed: 0.0290s/iter; left time: 1178.2497s
	iters: 300, epoch: 14 | loss: 0.4697720
	speed: 0.0331s/iter; left time: 1338.7176s
	iters: 400, epoch: 14 | loss: 0.0044318
	speed: 0.0335s/iter; left time: 1353.9930s
Epoch: 14 cost time: 15.198601961135864
Epoch: 14, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.973126).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0026694
	speed: 0.2767s/iter; left time: 11131.7142s
	iters: 200, epoch: 15 | loss: 0.0474675
	speed: 0.0322s/iter; left time: 1293.5184s
	iters: 300, epoch: 15 | loss: 0.0079720
	speed: 0.0388s/iter; left time: 1551.7389s
	iters: 400, epoch: 15 | loss: 0.0256845
	speed: 0.0332s/iter; left time: 1325.3715s
Epoch: 15 cost time: 16.94692087173462
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.194 Vali Acc: 0.969 Test Loss: 0.194 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0045309
	speed: 0.2899s/iter; left time: 11527.8196s
	iters: 200, epoch: 16 | loss: 0.1449632
	speed: 0.0294s/iter; left time: 1165.3133s
	iters: 300, epoch: 16 | loss: 0.0096636
	speed: 0.0296s/iter; left time: 1170.6305s
	iters: 400, epoch: 16 | loss: 0.0012953
	speed: 0.0327s/iter; left time: 1290.1214s
Epoch: 16 cost time: 15.569890975952148
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0447935
	speed: 0.2813s/iter; left time: 11054.3393s
	iters: 200, epoch: 17 | loss: 0.0091363
	speed: 0.0371s/iter; left time: 1453.8933s
	iters: 300, epoch: 17 | loss: 0.0011251
	speed: 0.0351s/iter; left time: 1371.2778s
	iters: 400, epoch: 17 | loss: 0.0025256
	speed: 0.0305s/iter; left time: 1191.2929s
Epoch: 17 cost time: 16.666434288024902
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0845373
	speed: 0.2751s/iter; left time: 10683.0826s
	iters: 200, epoch: 18 | loss: 0.0319940
	speed: 0.0410s/iter; left time: 1586.8657s
	iters: 300, epoch: 18 | loss: 0.0021496
	speed: 0.0375s/iter; left time: 1447.2870s
	iters: 400, epoch: 18 | loss: 0.0013301
	speed: 0.0343s/iter; left time: 1322.2954s
Epoch: 18 cost time: 17.796136617660522
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.242 Vali Acc: 0.961 Test Loss: 0.242 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0002707
	speed: 0.3025s/iter; left time: 11603.0604s
	iters: 200, epoch: 19 | loss: 0.0020566
	speed: 0.0342s/iter; left time: 1309.2882s
	iters: 300, epoch: 19 | loss: 0.0039573
	speed: 0.0404s/iter; left time: 1543.2177s
	iters: 400, epoch: 19 | loss: 0.0639074
	speed: 0.0379s/iter; left time: 1442.9112s
Epoch: 19 cost time: 18.23831820487976
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.968 Test Loss: 0.208 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0170641
	speed: 0.2790s/iter; left time: 10571.2549s
	iters: 200, epoch: 20 | loss: 0.0031002
	speed: 0.0330s/iter; left time: 1246.1926s
	iters: 300, epoch: 20 | loss: 0.0131779
	speed: 0.0379s/iter; left time: 1428.4704s
	iters: 400, epoch: 20 | loss: 0.0368087
	speed: 0.0369s/iter; left time: 1387.6573s
Epoch: 20 cost time: 17.14251947402954
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0231637
	speed: 0.2917s/iter; left time: 10916.7265s
	iters: 200, epoch: 21 | loss: 0.0141155
	speed: 0.0369s/iter; left time: 1375.5192s
	iters: 300, epoch: 21 | loss: 0.0055229
	speed: 0.0322s/iter; left time: 1197.0096s
	iters: 400, epoch: 21 | loss: 0.0006106
	speed: 0.0335s/iter; left time: 1242.3081s
Epoch: 21 cost time: 16.565287351608276
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0017298
	speed: 0.2618s/iter; left time: 9672.8231s
	iters: 200, epoch: 22 | loss: 0.0030159
	speed: 0.0350s/iter; left time: 1290.8984s
	iters: 300, epoch: 22 | loss: 0.0003893
	speed: 0.0363s/iter; left time: 1334.5662s
	iters: 400, epoch: 22 | loss: 0.0023290
	speed: 0.0380s/iter; left time: 1393.0905s
Epoch: 22 cost time: 18.234241247177124
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.962 Test Loss: 0.229 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0033874
	speed: 0.2854s/iter; left time: 10410.4681s
	iters: 200, epoch: 23 | loss: 0.0046669
	speed: 0.0301s/iter; left time: 1094.5506s
	iters: 300, epoch: 23 | loss: 0.2018006
	speed: 0.0352s/iter; left time: 1275.7709s
	iters: 400, epoch: 23 | loss: 0.0500814
	speed: 0.0375s/iter; left time: 1355.3860s
Epoch: 23 cost time: 16.794939279556274
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0092082
	speed: 0.2726s/iter; left time: 9817.0215s
	iters: 200, epoch: 24 | loss: 0.0047077
	speed: 0.0330s/iter; left time: 1186.1647s
	iters: 300, epoch: 24 | loss: 0.0025987
	speed: 0.0371s/iter; left time: 1327.7678s
	iters: 400, epoch: 24 | loss: 0.0000974
	speed: 0.0339s/iter; left time: 1211.7475s
Epoch: 24 cost time: 16.90772008895874
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 26282
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3629735
	speed: 0.0687s/iter; left time: 3213.2089s
	iters: 200, epoch: 1 | loss: 0.6832163
	speed: 0.0347s/iter; left time: 1621.6723s
	iters: 300, epoch: 1 | loss: 0.5706733
	speed: 0.0379s/iter; left time: 1765.1047s
	iters: 400, epoch: 1 | loss: 0.1844083
	speed: 0.0385s/iter; left time: 1791.2003s
Epoch: 1 cost time: 20.705045223236084
Epoch: 1, Steps: 469 | Train Loss: 0.890 Vali Loss: 0.396 Vali Acc: 0.897 Test Loss: 0.396 Test Acc: 0.897
Validation loss decreased (inf --> -0.896508).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3147600
	speed: 0.2658s/iter; left time: 12313.3427s
	iters: 200, epoch: 2 | loss: 0.4212593
	speed: 0.0274s/iter; left time: 1266.9945s
	iters: 300, epoch: 2 | loss: 0.1130206
	speed: 0.0286s/iter; left time: 1321.1379s
	iters: 400, epoch: 2 | loss: 0.1823149
	speed: 0.0344s/iter; left time: 1581.7288s
Epoch: 2 cost time: 14.98684811592102
Epoch: 2, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.896508 --> -0.929671).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0870744
	speed: 0.2672s/iter; left time: 12253.5342s
	iters: 200, epoch: 3 | loss: 0.0226180
	speed: 0.0302s/iter; left time: 1381.3274s
	iters: 300, epoch: 3 | loss: 0.0977082
	speed: 0.0294s/iter; left time: 1344.4863s
	iters: 400, epoch: 3 | loss: 0.0234549
	speed: 0.0361s/iter; left time: 1644.2131s
Epoch: 3 cost time: 16.345752239227295
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.228 Vali Acc: 0.949 Test Loss: 0.228 Test Acc: 0.949
Validation loss decreased (-0.929671 --> -0.948540).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2580805
	speed: 0.2796s/iter; left time: 12692.3901s
	iters: 200, epoch: 4 | loss: 0.0383783
	speed: 0.0356s/iter; left time: 1613.0575s
	iters: 300, epoch: 4 | loss: 0.0595778
	speed: 0.0416s/iter; left time: 1879.1172s
	iters: 400, epoch: 4 | loss: 0.3040758
	speed: 0.0397s/iter; left time: 1790.0623s
Epoch: 4 cost time: 18.854480028152466
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.201 Vali Acc: 0.954 Test Loss: 0.201 Test Acc: 0.954
Validation loss decreased (-0.948540 --> -0.954258).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0714740
	speed: 0.3258s/iter; left time: 14636.2698s
	iters: 200, epoch: 5 | loss: 0.0084193
	speed: 0.0395s/iter; left time: 1769.8288s
	iters: 300, epoch: 5 | loss: 0.0131805
	speed: 0.0410s/iter; left time: 1832.5366s
	iters: 400, epoch: 5 | loss: 0.0442924
	speed: 0.0373s/iter; left time: 1663.6245s
Epoch: 5 cost time: 19.507346153259277
Epoch: 5, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.954258 --> -0.956831).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0114414
	speed: 0.3053s/iter; left time: 13573.7311s
	iters: 200, epoch: 6 | loss: 0.0499630
	speed: 0.0376s/iter; left time: 1669.4236s
	iters: 300, epoch: 6 | loss: 0.1685407
	speed: 0.0386s/iter; left time: 1707.8263s
	iters: 400, epoch: 6 | loss: 0.0095199
	speed: 0.0397s/iter; left time: 1752.9075s
Epoch: 6 cost time: 18.95984387397766
Epoch: 6, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.956831 --> -0.958832).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0255124
	speed: 0.3350s/iter; left time: 14737.4860s
	iters: 200, epoch: 7 | loss: 0.0128179
	speed: 0.0367s/iter; left time: 1611.5696s
	iters: 300, epoch: 7 | loss: 0.0023188
	speed: 0.0345s/iter; left time: 1508.4927s
	iters: 400, epoch: 7 | loss: 0.0445993
	speed: 0.0389s/iter; left time: 1701.4277s
Epoch: 7 cost time: 17.983499765396118
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
Validation loss decreased (-0.958832 --> -0.963120).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0024505
	speed: 0.3229s/iter; left time: 14051.9689s
	iters: 200, epoch: 8 | loss: 0.1469526
	speed: 0.0383s/iter; left time: 1661.6073s
	iters: 300, epoch: 8 | loss: 0.0110397
	speed: 0.0447s/iter; left time: 1936.9860s
	iters: 400, epoch: 8 | loss: 0.0461483
	speed: 0.0381s/iter; left time: 1647.4480s
Epoch: 8 cost time: 19.584022283554077
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
Validation loss decreased (-0.963120 --> -0.963691).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3204985
	speed: 0.3414s/iter; left time: 14698.0099s
	iters: 200, epoch: 9 | loss: 0.0760065
	speed: 0.0383s/iter; left time: 1645.2169s
	iters: 300, epoch: 9 | loss: 0.0031909
	speed: 0.0430s/iter; left time: 1844.4260s
	iters: 400, epoch: 9 | loss: 0.0748990
	speed: 0.0376s/iter; left time: 1608.0616s
Epoch: 9 cost time: 19.80475425720215
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.963691 --> -0.970267).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0298504
	speed: 0.3075s/iter; left time: 13094.5976s
	iters: 200, epoch: 10 | loss: 0.1179933
	speed: 0.0408s/iter; left time: 1731.5722s
	iters: 300, epoch: 10 | loss: 0.0016090
	speed: 0.0339s/iter; left time: 1437.0276s
	iters: 400, epoch: 10 | loss: 0.0108702
	speed: 0.0319s/iter; left time: 1349.4978s
Epoch: 10 cost time: 18.829086780548096
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.198 Vali Acc: 0.965 Test Loss: 0.198 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2473781
	speed: 0.2993s/iter; left time: 12605.6841s
	iters: 200, epoch: 11 | loss: 0.0829412
	speed: 0.0386s/iter; left time: 1620.9032s
	iters: 300, epoch: 11 | loss: 0.0200487
	speed: 0.0365s/iter; left time: 1530.3638s
	iters: 400, epoch: 11 | loss: 0.0044643
	speed: 0.0365s/iter; left time: 1526.6727s
Epoch: 11 cost time: 18.96757435798645
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0016724
	speed: 0.3055s/iter; left time: 12722.7319s
	iters: 200, epoch: 12 | loss: 0.2168895
	speed: 0.0321s/iter; left time: 1334.8581s
	iters: 300, epoch: 12 | loss: 0.0002705
	speed: 0.0361s/iter; left time: 1494.8992s
	iters: 400, epoch: 12 | loss: 0.0062774
	speed: 0.0312s/iter; left time: 1288.0339s
Epoch: 12 cost time: 16.94916296005249
Epoch: 12, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0950102
	speed: 0.2877s/iter; left time: 11845.0004s
	iters: 200, epoch: 13 | loss: 0.0006454
	speed: 0.0371s/iter; left time: 1525.5956s
	iters: 300, epoch: 13 | loss: 0.0009012
	speed: 0.0357s/iter; left time: 1462.2566s
	iters: 400, epoch: 13 | loss: 0.0465942
	speed: 0.0349s/iter; left time: 1427.1036s
Epoch: 13 cost time: 19.190007209777832
Epoch: 13, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.198 Vali Acc: 0.962 Test Loss: 0.198 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0003336
	speed: 0.3026s/iter; left time: 12317.4598s
	iters: 200, epoch: 14 | loss: 0.0986409
	speed: 0.0393s/iter; left time: 1595.0748s
	iters: 300, epoch: 14 | loss: 0.0894192
	speed: 0.0421s/iter; left time: 1705.5528s
	iters: 400, epoch: 14 | loss: 0.0133679
	speed: 0.0360s/iter; left time: 1454.2079s
Epoch: 14 cost time: 20.130793571472168
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0324583
	speed: 0.3349s/iter; left time: 13476.1909s
	iters: 200, epoch: 15 | loss: 0.0509589
	speed: 0.0403s/iter; left time: 1616.2697s
	iters: 300, epoch: 15 | loss: 0.0004728
	speed: 0.0387s/iter; left time: 1548.6950s
	iters: 400, epoch: 15 | loss: 0.1574169
	speed: 0.0384s/iter; left time: 1533.3225s
Epoch: 15 cost time: 20.18045473098755
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.200 Vali Acc: 0.966 Test Loss: 0.200 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0102560
	speed: 0.3443s/iter; left time: 13689.7822s
	iters: 200, epoch: 16 | loss: 0.0070455
	speed: 0.0446s/iter; left time: 1768.0335s
	iters: 300, epoch: 16 | loss: 0.0016802
	speed: 0.0428s/iter; left time: 1694.5747s
	iters: 400, epoch: 16 | loss: 0.0025982
	speed: 0.0388s/iter; left time: 1532.3085s
Epoch: 16 cost time: 21.40448546409607
Epoch: 16, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.970839).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0037603
	speed: 0.3333s/iter; left time: 13096.1930s
	iters: 200, epoch: 17 | loss: 0.0015079
	speed: 0.0417s/iter; left time: 1633.2831s
	iters: 300, epoch: 17 | loss: 0.0269900
	speed: 0.0402s/iter; left time: 1571.9020s
	iters: 400, epoch: 17 | loss: 0.0021541
	speed: 0.0435s/iter; left time: 1697.5001s
Epoch: 17 cost time: 19.408905744552612
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.973126).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0040491
	speed: 0.3314s/iter; left time: 12867.2659s
	iters: 200, epoch: 18 | loss: 0.0070558
	speed: 0.0398s/iter; left time: 1541.4562s
	iters: 300, epoch: 18 | loss: 0.0151859
	speed: 0.0393s/iter; left time: 1517.2200s
	iters: 400, epoch: 18 | loss: 0.0001660
	speed: 0.0408s/iter; left time: 1570.1950s
Epoch: 18 cost time: 19.947633266448975
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0018372
	speed: 0.3319s/iter; left time: 12730.0098s
	iters: 200, epoch: 19 | loss: 0.0273510
	speed: 0.0432s/iter; left time: 1654.5265s
	iters: 300, epoch: 19 | loss: 0.0038331
	speed: 0.0392s/iter; left time: 1495.1958s
	iters: 400, epoch: 19 | loss: 0.0104631
	speed: 0.0421s/iter; left time: 1600.3857s
Epoch: 19 cost time: 20.880996465682983
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.969 Test Loss: 0.210 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0054409
	speed: 0.3223s/iter; left time: 12211.7626s
	iters: 200, epoch: 20 | loss: 0.0039591
	speed: 0.0379s/iter; left time: 1432.9722s
	iters: 300, epoch: 20 | loss: 0.0002836
	speed: 0.0407s/iter; left time: 1533.8948s
	iters: 400, epoch: 20 | loss: 0.0000518
	speed: 0.0349s/iter; left time: 1312.4962s
Epoch: 20 cost time: 19.09146499633789
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0010010
	speed: 0.3376s/iter; left time: 12634.2637s
	iters: 200, epoch: 21 | loss: 0.0068197
	speed: 0.0394s/iter; left time: 1471.7868s
	iters: 300, epoch: 21 | loss: 0.0053636
	speed: 0.0345s/iter; left time: 1283.5733s
	iters: 400, epoch: 21 | loss: 0.1547854
	speed: 0.0341s/iter; left time: 1264.8026s
Epoch: 21 cost time: 18.215247869491577
Epoch: 21, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.964 Test Loss: 0.180 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1782461
	speed: 0.3182s/iter; left time: 11759.1759s
	iters: 200, epoch: 22 | loss: 0.0003916
	speed: 0.0424s/iter; left time: 1561.9764s
	iters: 300, epoch: 22 | loss: 0.0050576
	speed: 0.0362s/iter; left time: 1330.1405s
	iters: 400, epoch: 22 | loss: 0.0031579
	speed: 0.0329s/iter; left time: 1205.5792s
Epoch: 22 cost time: 18.663334131240845
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.966 Test Loss: 0.195 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1954407
	speed: 0.3224s/iter; left time: 11761.4497s
	iters: 200, epoch: 23 | loss: 0.2143461
	speed: 0.0398s/iter; left time: 1448.1760s
	iters: 300, epoch: 23 | loss: 0.0118914
	speed: 0.0400s/iter; left time: 1451.7174s
	iters: 400, epoch: 23 | loss: 0.0003472
	speed: 0.0343s/iter; left time: 1241.9995s
Epoch: 23 cost time: 19.10549306869507
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.235 Vali Acc: 0.961 Test Loss: 0.235 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0136471
	speed: 0.2996s/iter; left time: 10791.3229s
	iters: 200, epoch: 24 | loss: 0.0256894
	speed: 0.0323s/iter; left time: 1158.7309s
	iters: 300, epoch: 24 | loss: 0.0001902
	speed: 0.0393s/iter; left time: 1408.0823s
	iters: 400, epoch: 24 | loss: 0.0055773
	speed: 0.0453s/iter; left time: 1616.7298s
Epoch: 24 cost time: 17.833035469055176
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.961 Test Loss: 0.202 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0003808
	speed: 0.3078s/iter; left time: 10940.4850s
	iters: 200, epoch: 25 | loss: 0.0397711
	speed: 0.0411s/iter; left time: 1455.9514s
	iters: 300, epoch: 25 | loss: 0.0100264
	speed: 0.0362s/iter; left time: 1279.5207s
	iters: 400, epoch: 25 | loss: 0.0051014
	speed: 0.0396s/iter; left time: 1394.3724s
Epoch: 25 cost time: 19.07089614868164
Epoch: 25, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.215 Vali Acc: 0.966 Test Loss: 0.215 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0091277
	speed: 0.3164s/iter; left time: 11097.3160s
	iters: 200, epoch: 26 | loss: 0.0003400
	speed: 0.0386s/iter; left time: 1349.9851s
	iters: 300, epoch: 26 | loss: 0.0024179
	speed: 0.0342s/iter; left time: 1193.5782s
	iters: 400, epoch: 26 | loss: 0.0010871
	speed: 0.0359s/iter; left time: 1249.9130s
Epoch: 26 cost time: 18.425756216049194
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.211 Vali Acc: 0.966 Test Loss: 0.211 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0210483
	speed: 0.3314s/iter; left time: 11468.9120s
	iters: 200, epoch: 27 | loss: 0.0001313
	speed: 0.0403s/iter; left time: 1391.9683s
	iters: 300, epoch: 27 | loss: 0.0017097
	speed: 0.0396s/iter; left time: 1361.2821s
	iters: 400, epoch: 27 | loss: 0.0535735
	speed: 0.0408s/iter; left time: 1398.5084s
Epoch: 27 cost time: 19.065255880355835
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.970 Test Loss: 0.202 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 17962
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0813816
	speed: 0.0724s/iter; left time: 3387.2017s
	iters: 200, epoch: 1 | loss: 0.7123999
	speed: 0.0365s/iter; left time: 1702.8511s
	iters: 300, epoch: 1 | loss: 0.5142835
	speed: 0.0311s/iter; left time: 1448.8393s
	iters: 400, epoch: 1 | loss: 0.3067075
	speed: 0.0349s/iter; left time: 1623.3223s
Epoch: 1 cost time: 20.153584480285645
Epoch: 1, Steps: 469 | Train Loss: 0.874 Vali Loss: 0.427 Vali Acc: 0.880 Test Loss: 0.427 Test Acc: 0.880
Validation loss decreased (inf --> -0.879641).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2921787
	speed: 0.3051s/iter; left time: 14137.7258s
	iters: 200, epoch: 2 | loss: 0.1249948
	speed: 0.0380s/iter; left time: 1756.4834s
	iters: 300, epoch: 2 | loss: 0.1205108
	speed: 0.0360s/iter; left time: 1661.1940s
	iters: 400, epoch: 2 | loss: 0.1170020
	speed: 0.0355s/iter; left time: 1635.1350s
Epoch: 2 cost time: 17.34392476081848
Epoch: 2, Steps: 469 | Train Loss: 0.232 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
Validation loss decreased (-0.879641 --> -0.939677).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2097315
	speed: 0.2647s/iter; left time: 12139.8891s
	iters: 200, epoch: 3 | loss: 0.1140932
	speed: 0.0343s/iter; left time: 1571.5737s
	iters: 300, epoch: 3 | loss: 0.1225254
	speed: 0.0344s/iter; left time: 1573.0564s
	iters: 400, epoch: 3 | loss: 0.0833528
	speed: 0.0377s/iter; left time: 1717.7462s
Epoch: 3 cost time: 17.34182834625244
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
Validation loss decreased (-0.939677 --> -0.953114).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0174969
	speed: 0.2678s/iter; left time: 12155.1031s
	iters: 200, epoch: 4 | loss: 0.1602940
	speed: 0.0333s/iter; left time: 1506.2831s
	iters: 300, epoch: 4 | loss: 0.1688334
	speed: 0.0330s/iter; left time: 1490.8996s
	iters: 400, epoch: 4 | loss: 0.0416210
	speed: 0.0374s/iter; left time: 1687.0843s
Epoch: 4 cost time: 16.768728494644165
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2240645
	speed: 0.2796s/iter; left time: 12559.7578s
	iters: 200, epoch: 5 | loss: 0.0654578
	speed: 0.0316s/iter; left time: 1417.3565s
	iters: 300, epoch: 5 | loss: 0.0767883
	speed: 0.0351s/iter; left time: 1570.6850s
	iters: 400, epoch: 5 | loss: 0.0022430
	speed: 0.0318s/iter; left time: 1418.3160s
Epoch: 5 cost time: 16.575196027755737
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.953114 --> -0.958832).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0458451
	speed: 0.2855s/iter; left time: 12690.9247s
	iters: 200, epoch: 6 | loss: 0.0371091
	speed: 0.0414s/iter; left time: 1838.4416s
	iters: 300, epoch: 6 | loss: 0.0315418
	speed: 0.0378s/iter; left time: 1670.8269s
	iters: 400, epoch: 6 | loss: 0.0181485
	speed: 0.0424s/iter; left time: 1872.5856s
Epoch: 6 cost time: 19.762514352798462
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
Validation loss decreased (-0.958832 --> -0.964264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0050279
	speed: 0.2964s/iter; left time: 13039.4023s
	iters: 200, epoch: 7 | loss: 0.0302114
	speed: 0.0369s/iter; left time: 1618.6197s
	iters: 300, epoch: 7 | loss: 0.0037892
	speed: 0.0379s/iter; left time: 1659.3275s
	iters: 400, epoch: 7 | loss: 0.0299906
	speed: 0.0395s/iter; left time: 1724.2180s
Epoch: 7 cost time: 18.097367525100708
Epoch: 7, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0121780
	speed: 0.3105s/iter; left time: 13512.4910s
	iters: 200, epoch: 8 | loss: 0.0556995
	speed: 0.0330s/iter; left time: 1432.4555s
	iters: 300, epoch: 8 | loss: 0.0191032
	speed: 0.0345s/iter; left time: 1495.1625s
	iters: 400, epoch: 8 | loss: 0.0055384
	speed: 0.0317s/iter; left time: 1370.0831s
Epoch: 8 cost time: 16.75734043121338
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
Validation loss decreased (-0.964264 --> -0.965121).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0517154
	speed: 0.3091s/iter; left time: 13307.7186s
	iters: 200, epoch: 9 | loss: 0.0060532
	speed: 0.0421s/iter; left time: 1806.2206s
	iters: 300, epoch: 9 | loss: 0.0068981
	speed: 0.0362s/iter; left time: 1551.7435s
	iters: 400, epoch: 9 | loss: 0.0032051
	speed: 0.0400s/iter; left time: 1710.7922s
Epoch: 9 cost time: 19.779780626296997
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0050520
	speed: 0.3296s/iter; left time: 14034.4550s
	iters: 200, epoch: 10 | loss: 0.0189456
	speed: 0.0367s/iter; left time: 1558.6722s
	iters: 300, epoch: 10 | loss: 0.0049227
	speed: 0.0362s/iter; left time: 1534.7932s
	iters: 400, epoch: 10 | loss: 0.0021138
	speed: 0.0417s/iter; left time: 1761.8618s
Epoch: 10 cost time: 19.870031356811523
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.965121 --> -0.972268).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0040318
	speed: 0.3459s/iter; left time: 14564.7139s
	iters: 200, epoch: 11 | loss: 0.1038110
	speed: 0.0374s/iter; left time: 1572.8342s
	iters: 300, epoch: 11 | loss: 0.0032763
	speed: 0.0428s/iter; left time: 1794.1592s
	iters: 400, epoch: 11 | loss: 0.0044203
	speed: 0.0417s/iter; left time: 1742.6524s
Epoch: 11 cost time: 20.33939003944397
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
Validation loss decreased (-0.972268 --> -0.974269).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0060651
	speed: 0.3398s/iter; left time: 14149.3872s
	iters: 200, epoch: 12 | loss: 0.0537441
	speed: 0.0361s/iter; left time: 1499.1293s
	iters: 300, epoch: 12 | loss: 0.0047734
	speed: 0.0353s/iter; left time: 1462.5800s
	iters: 400, epoch: 12 | loss: 0.2397366
	speed: 0.0340s/iter; left time: 1405.1274s
Epoch: 12 cost time: 19.0531325340271
Epoch: 12, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.971 Test Loss: 0.181 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0831058
	speed: 0.2791s/iter; left time: 11491.4901s
	iters: 200, epoch: 13 | loss: 0.0009044
	speed: 0.0389s/iter; left time: 1596.6227s
	iters: 300, epoch: 13 | loss: 0.1333187
	speed: 0.0463s/iter; left time: 1897.0366s
	iters: 400, epoch: 13 | loss: 0.2853910
	speed: 0.0392s/iter; left time: 1603.3154s
Epoch: 13 cost time: 19.089611291885376
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0419880
	speed: 0.2850s/iter; left time: 11602.0451s
	iters: 200, epoch: 14 | loss: 0.0126192
	speed: 0.0384s/iter; left time: 1560.7131s
	iters: 300, epoch: 14 | loss: 0.0855849
	speed: 0.0397s/iter; left time: 1609.6676s
	iters: 400, epoch: 14 | loss: 0.0601012
	speed: 0.0392s/iter; left time: 1584.7720s
Epoch: 14 cost time: 18.374418258666992
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0337902
	speed: 0.3053s/iter; left time: 12282.4818s
	iters: 200, epoch: 15 | loss: 0.0007409
	speed: 0.0425s/iter; left time: 1707.3057s
	iters: 300, epoch: 15 | loss: 0.0132523
	speed: 0.0413s/iter; left time: 1651.9912s
	iters: 400, epoch: 15 | loss: 0.0015609
	speed: 0.0407s/iter; left time: 1626.2956s
Epoch: 15 cost time: 20.187224864959717
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0012782
	speed: 0.3012s/iter; left time: 11976.7575s
	iters: 200, epoch: 16 | loss: 0.1834313
	speed: 0.0405s/iter; left time: 1607.5652s
	iters: 300, epoch: 16 | loss: 0.0329445
	speed: 0.0384s/iter; left time: 1520.4111s
	iters: 400, epoch: 16 | loss: 0.0163999
	speed: 0.0447s/iter; left time: 1765.3397s
Epoch: 16 cost time: 20.36336040496826
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.968 Test Loss: 0.211 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0006683
	speed: 0.3478s/iter; left time: 13666.4940s
	iters: 200, epoch: 17 | loss: 0.0050087
	speed: 0.0408s/iter; left time: 1599.6180s
	iters: 300, epoch: 17 | loss: 0.0028829
	speed: 0.0433s/iter; left time: 1692.2364s
	iters: 400, epoch: 17 | loss: 0.0019857
	speed: 0.0401s/iter; left time: 1562.4072s
Epoch: 17 cost time: 20.493597984313965
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.199 Vali Acc: 0.973 Test Loss: 0.199 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0009734
	speed: 0.3293s/iter; left time: 12786.7855s
	iters: 200, epoch: 18 | loss: 0.0411378
	speed: 0.0485s/iter; left time: 1879.8387s
	iters: 300, epoch: 18 | loss: 0.0013729
	speed: 0.0418s/iter; left time: 1613.7592s
	iters: 400, epoch: 18 | loss: 0.0059808
	speed: 0.0456s/iter; left time: 1757.7088s
Epoch: 18 cost time: 21.425570011138916
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0243201
	speed: 0.3238s/iter; left time: 12421.2326s
	iters: 200, epoch: 19 | loss: 0.0002740
	speed: 0.0355s/iter; left time: 1358.4949s
	iters: 300, epoch: 19 | loss: 0.0003273
	speed: 0.0370s/iter; left time: 1410.0043s
	iters: 400, epoch: 19 | loss: 0.0019518
	speed: 0.0330s/iter; left time: 1254.2913s
Epoch: 19 cost time: 17.51824641227722
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0007273
	speed: 0.3371s/iter; left time: 12771.4642s
	iters: 200, epoch: 20 | loss: 0.0900596
	speed: 0.0356s/iter; left time: 1345.1259s
	iters: 300, epoch: 20 | loss: 0.0096951
	speed: 0.0375s/iter; left time: 1412.5825s
	iters: 400, epoch: 20 | loss: 0.0071294
	speed: 0.0340s/iter; left time: 1279.5520s
Epoch: 20 cost time: 17.67098569869995
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.968 Test Loss: 0.223 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0007149
	speed: 0.3133s/iter; left time: 11724.6565s
	iters: 200, epoch: 21 | loss: 0.0032417
	speed: 0.0361s/iter; left time: 1346.5781s
	iters: 300, epoch: 21 | loss: 0.0002720
	speed: 0.0306s/iter; left time: 1140.3460s
	iters: 400, epoch: 21 | loss: 0.0019530
	speed: 0.0411s/iter; left time: 1525.3982s
Epoch: 21 cost time: 17.545210361480713
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.270 Vali Acc: 0.965 Test Loss: 0.270 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 13802
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7482861
	speed: 0.0791s/iter; left time: 3700.5784s
	iters: 200, epoch: 1 | loss: 0.9352710
	speed: 0.0337s/iter; left time: 1575.8920s
	iters: 300, epoch: 1 | loss: 0.8374382
	speed: 0.0369s/iter; left time: 1720.6645s
	iters: 400, epoch: 1 | loss: 0.5041507
	speed: 0.0378s/iter; left time: 1757.4371s
Epoch: 1 cost time: 21.626934051513672
Epoch: 1, Steps: 469 | Train Loss: 1.124 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
Validation loss decreased (inf --> -0.834186).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4076965
	speed: 0.2999s/iter; left time: 13897.2725s
	iters: 200, epoch: 2 | loss: 0.5075470
	speed: 0.0354s/iter; left time: 1636.7719s
	iters: 300, epoch: 2 | loss: 0.1456062
	speed: 0.0325s/iter; left time: 1498.3382s
	iters: 400, epoch: 2 | loss: 0.2953767
	speed: 0.0313s/iter; left time: 1439.2387s
Epoch: 2 cost time: 16.643452882766724
Epoch: 2, Steps: 469 | Train Loss: 0.337 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
Validation loss decreased (-0.834186 --> -0.911089).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0995401
	speed: 0.2629s/iter; left time: 12055.4833s
	iters: 200, epoch: 3 | loss: 0.0864369
	speed: 0.0374s/iter; left time: 1713.5391s
	iters: 300, epoch: 3 | loss: 0.2210695
	speed: 0.0375s/iter; left time: 1714.6150s
	iters: 400, epoch: 3 | loss: 0.2235753
	speed: 0.0429s/iter; left time: 1956.8045s
Epoch: 3 cost time: 18.068758249282837
Epoch: 3, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
Validation loss decreased (-0.911089 --> -0.936533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2571999
	speed: 0.2806s/iter; left time: 12737.1512s
	iters: 200, epoch: 4 | loss: 0.0251538
	speed: 0.0339s/iter; left time: 1535.3368s
	iters: 300, epoch: 4 | loss: 0.0384532
	speed: 0.0378s/iter; left time: 1706.4435s
	iters: 400, epoch: 4 | loss: 0.1793864
	speed: 0.0357s/iter; left time: 1611.0414s
Epoch: 4 cost time: 17.962678909301758
Epoch: 4, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.936533 --> -0.951971).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0513500
	speed: 0.2898s/iter; left time: 13021.1135s
	iters: 200, epoch: 5 | loss: 0.1245074
	speed: 0.0404s/iter; left time: 1812.4505s
	iters: 300, epoch: 5 | loss: 0.0601531
	speed: 0.0338s/iter; left time: 1512.6835s
	iters: 400, epoch: 5 | loss: 0.2162791
	speed: 0.0333s/iter; left time: 1486.5703s
Epoch: 5 cost time: 17.60214614868164
Epoch: 5, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
Validation loss decreased (-0.951971 --> -0.953114).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2117061
	speed: 0.2737s/iter; left time: 12165.9383s
	iters: 200, epoch: 6 | loss: 0.0614547
	speed: 0.0435s/iter; left time: 1931.6023s
	iters: 300, epoch: 6 | loss: 0.0344354
	speed: 0.0383s/iter; left time: 1694.6968s
	iters: 400, epoch: 6 | loss: 0.0230615
	speed: 0.0394s/iter; left time: 1739.8031s
Epoch: 6 cost time: 19.455878257751465
Epoch: 6, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.207 Vali Acc: 0.953 Test Loss: 0.207 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1508655
	speed: 0.2813s/iter; left time: 12372.0560s
	iters: 200, epoch: 7 | loss: 0.0333446
	speed: 0.0336s/iter; left time: 1476.1151s
	iters: 300, epoch: 7 | loss: 0.2876891
	speed: 0.0372s/iter; left time: 1629.8713s
	iters: 400, epoch: 7 | loss: 0.0533607
	speed: 0.0352s/iter; left time: 1537.9732s
Epoch: 7 cost time: 17.550199031829834
Epoch: 7, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
Validation loss decreased (-0.953114 --> -0.964835).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1588088
	speed: 0.2783s/iter; left time: 12112.8744s
	iters: 200, epoch: 8 | loss: 0.0147304
	speed: 0.0332s/iter; left time: 1442.1399s
	iters: 300, epoch: 8 | loss: 0.0041749
	speed: 0.0371s/iter; left time: 1606.8808s
	iters: 400, epoch: 8 | loss: 0.0681137
	speed: 0.0349s/iter; left time: 1506.9654s
Epoch: 8 cost time: 17.452959775924683
Epoch: 8, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0687385
	speed: 0.2765s/iter; left time: 11902.7138s
	iters: 200, epoch: 9 | loss: 0.0176094
	speed: 0.0344s/iter; left time: 1478.9364s
	iters: 300, epoch: 9 | loss: 0.1770040
	speed: 0.0388s/iter; left time: 1661.7615s
	iters: 400, epoch: 9 | loss: 0.0188001
	speed: 0.0370s/iter; left time: 1583.7360s
Epoch: 9 cost time: 17.652257919311523
Epoch: 9, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0610405
	speed: 0.2822s/iter; left time: 12017.0062s
	iters: 200, epoch: 10 | loss: 0.0020858
	speed: 0.0345s/iter; left time: 1464.2292s
	iters: 300, epoch: 10 | loss: 0.0116370
	speed: 0.0329s/iter; left time: 1394.0834s
	iters: 400, epoch: 10 | loss: 0.1776709
	speed: 0.0330s/iter; left time: 1397.2346s
Epoch: 10 cost time: 16.669846057891846
Epoch: 10, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0200386
	speed: 0.2941s/iter; left time: 12383.0923s
	iters: 200, epoch: 11 | loss: 0.0085612
	speed: 0.0376s/iter; left time: 1577.6303s
	iters: 300, epoch: 11 | loss: 0.0990693
	speed: 0.0410s/iter; left time: 1718.6820s
	iters: 400, epoch: 11 | loss: 0.0208129
	speed: 0.0348s/iter; left time: 1455.9609s
Epoch: 11 cost time: 18.154176473617554
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0024316
	speed: 0.2727s/iter; left time: 11354.8611s
	iters: 200, epoch: 12 | loss: 0.0043842
	speed: 0.0373s/iter; left time: 1551.5159s
	iters: 300, epoch: 12 | loss: 0.0060430
	speed: 0.0339s/iter; left time: 1405.7574s
	iters: 400, epoch: 12 | loss: 0.0042217
	speed: 0.0320s/iter; left time: 1323.5853s
Epoch: 12 cost time: 17.074373960494995
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.173 Vali Acc: 0.961 Test Loss: 0.173 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0390589
	speed: 0.2759s/iter; left time: 11358.3470s
	iters: 200, epoch: 13 | loss: 0.1746162
	speed: 0.0334s/iter; left time: 1373.7273s
	iters: 300, epoch: 13 | loss: 0.0198645
	speed: 0.0337s/iter; left time: 1381.3681s
	iters: 400, epoch: 13 | loss: 0.0139590
	speed: 0.0377s/iter; left time: 1540.9764s
Epoch: 13 cost time: 17.378840684890747
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.210 Vali Acc: 0.961 Test Loss: 0.210 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0219094
	speed: 0.2673s/iter; left time: 10878.9186s
	iters: 200, epoch: 14 | loss: 0.1461078
	speed: 0.0347s/iter; left time: 1409.2089s
	iters: 300, epoch: 14 | loss: 0.0052045
	speed: 0.0364s/iter; left time: 1474.6317s
	iters: 400, epoch: 14 | loss: 0.1132669
	speed: 0.0377s/iter; left time: 1522.1536s
Epoch: 14 cost time: 17.53685212135315
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0144799
	speed: 0.2679s/iter; left time: 10778.3120s
	iters: 200, epoch: 15 | loss: 0.0756308
	speed: 0.0303s/iter; left time: 1217.1756s
	iters: 300, epoch: 15 | loss: 0.0043680
	speed: 0.0313s/iter; left time: 1252.2149s
	iters: 400, epoch: 15 | loss: 0.0786177
	speed: 0.0357s/iter; left time: 1425.1460s
Epoch: 15 cost time: 16.64163899421692
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.216 Vali Acc: 0.966 Test Loss: 0.216 Test Acc: 0.966
Validation loss decreased (-0.964835 --> -0.965693).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0094433
	speed: 0.2930s/iter; left time: 11651.6552s
	iters: 200, epoch: 16 | loss: 0.4212707
	speed: 0.0336s/iter; left time: 1332.0891s
	iters: 300, epoch: 16 | loss: 0.0144791
	speed: 0.0315s/iter; left time: 1244.8729s
	iters: 400, epoch: 16 | loss: 0.0455696
	speed: 0.0345s/iter; left time: 1361.2137s
Epoch: 16 cost time: 16.777633905410767
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.967122).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0307210
	speed: 0.2682s/iter; left time: 10539.4696s
	iters: 200, epoch: 17 | loss: 0.0065281
	speed: 0.0339s/iter; left time: 1327.4077s
	iters: 300, epoch: 17 | loss: 0.0622061
	speed: 0.0378s/iter; left time: 1478.1384s
	iters: 400, epoch: 17 | loss: 0.0335569
	speed: 0.0368s/iter; left time: 1434.1921s
Epoch: 17 cost time: 18.0180881023407
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
Validation loss decreased (-0.967122 --> -0.968837).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0033043
	speed: 0.3153s/iter; left time: 12241.0384s
	iters: 200, epoch: 18 | loss: 0.0362612
	speed: 0.0372s/iter; left time: 1440.8703s
	iters: 300, epoch: 18 | loss: 0.0224116
	speed: 0.0399s/iter; left time: 1542.7517s
	iters: 400, epoch: 18 | loss: 0.0247808
	speed: 0.0382s/iter; left time: 1472.8671s
Epoch: 18 cost time: 18.942997932434082
Epoch: 18, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.187 Vali Acc: 0.966 Test Loss: 0.187 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0041967
	speed: 0.2887s/iter; left time: 11072.9219s
	iters: 200, epoch: 19 | loss: 0.0253912
	speed: 0.0366s/iter; left time: 1398.8148s
	iters: 300, epoch: 19 | loss: 0.1758138
	speed: 0.0396s/iter; left time: 1509.2588s
	iters: 400, epoch: 19 | loss: 0.0018781
	speed: 0.0384s/iter; left time: 1462.2589s
Epoch: 19 cost time: 18.374584674835205
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0006831
	speed: 0.2849s/iter; left time: 10795.3506s
	iters: 200, epoch: 20 | loss: 0.0659318
	speed: 0.0353s/iter; left time: 1333.0346s
	iters: 300, epoch: 20 | loss: 0.0013640
	speed: 0.0357s/iter; left time: 1347.0846s
	iters: 400, epoch: 20 | loss: 0.0333852
	speed: 0.0353s/iter; left time: 1327.9705s
Epoch: 20 cost time: 17.271528244018555
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
Validation loss decreased (-0.968837 --> -0.969123).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0207590
	speed: 0.2762s/iter; left time: 10336.5687s
	iters: 200, epoch: 21 | loss: 0.0031936
	speed: 0.0359s/iter; left time: 1338.3162s
	iters: 300, epoch: 21 | loss: 0.0228017
	speed: 0.0342s/iter; left time: 1271.9926s
	iters: 400, epoch: 21 | loss: 0.0020797
	speed: 0.0306s/iter; left time: 1137.7029s
Epoch: 21 cost time: 16.40256428718567
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0025362
	speed: 0.2692s/iter; left time: 9946.3900s
	iters: 200, epoch: 22 | loss: 0.0202224
	speed: 0.0275s/iter; left time: 1012.4589s
	iters: 300, epoch: 22 | loss: 0.0036260
	speed: 0.0308s/iter; left time: 1130.6132s
	iters: 400, epoch: 22 | loss: 0.2493559
	speed: 0.0304s/iter; left time: 1113.0842s
Epoch: 22 cost time: 15.072713375091553
Epoch: 22, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0083774
	speed: 0.2670s/iter; left time: 9739.5944s
	iters: 200, epoch: 23 | loss: 0.0186405
	speed: 0.0351s/iter; left time: 1278.5494s
	iters: 300, epoch: 23 | loss: 0.0050242
	speed: 0.0400s/iter; left time: 1450.7454s
	iters: 400, epoch: 23 | loss: 0.0330585
	speed: 0.0402s/iter; left time: 1453.8373s
Epoch: 23 cost time: 18.937378644943237
Epoch: 23, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0156247
	speed: 0.2930s/iter; left time: 10550.8836s
	iters: 200, epoch: 24 | loss: 0.0141952
	speed: 0.0332s/iter; left time: 1193.8663s
	iters: 300, epoch: 24 | loss: 0.1766429
	speed: 0.0332s/iter; left time: 1188.4571s
	iters: 400, epoch: 24 | loss: 0.0099972
	speed: 0.0351s/iter; left time: 1252.6400s
Epoch: 24 cost time: 17.030582427978516
Epoch: 24, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0042318
	speed: 0.2904s/iter; left time: 10320.5402s
	iters: 200, epoch: 25 | loss: 0.0011542
	speed: 0.0310s/iter; left time: 1099.8310s
	iters: 300, epoch: 25 | loss: 0.0025229
	speed: 0.0333s/iter; left time: 1175.9390s
	iters: 400, epoch: 25 | loss: 0.0003317
	speed: 0.0301s/iter; left time: 1060.3570s
Epoch: 25 cost time: 15.936492204666138
Epoch: 25, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.968 Test Loss: 0.202 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0009968
	speed: 0.2832s/iter; left time: 9932.1165s
	iters: 200, epoch: 26 | loss: 0.0287605
	speed: 0.0316s/iter; left time: 1104.8093s
	iters: 300, epoch: 26 | loss: 0.0037308
	speed: 0.0317s/iter; left time: 1106.0236s
	iters: 400, epoch: 26 | loss: 0.0245665
	speed: 0.0316s/iter; left time: 1097.9249s
Epoch: 26 cost time: 15.681470394134521
Epoch: 26, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.969123 --> -0.969981).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0039606
	speed: 0.2910s/iter; left time: 10071.2310s
	iters: 200, epoch: 27 | loss: 0.0073957
	speed: 0.0317s/iter; left time: 1093.3451s
	iters: 300, epoch: 27 | loss: 0.0323633
	speed: 0.0358s/iter; left time: 1230.3722s
	iters: 400, epoch: 27 | loss: 0.0940374
	speed: 0.0332s/iter; left time: 1137.6607s
Epoch: 27 cost time: 17.566566228866577
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0042572
	speed: 0.2936s/iter; left time: 10023.2137s
	iters: 200, epoch: 28 | loss: 0.2064383
	speed: 0.0377s/iter; left time: 1283.2491s
	iters: 300, epoch: 28 | loss: 0.0032853
	speed: 0.0408s/iter; left time: 1386.0106s
	iters: 400, epoch: 28 | loss: 0.0001008
	speed: 0.0390s/iter; left time: 1318.4966s
Epoch: 28 cost time: 19.06688380241394
Epoch: 28, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.1424449
	speed: 0.3384s/iter; left time: 11393.3362s
	iters: 200, epoch: 29 | loss: 0.0008054
	speed: 0.0409s/iter; left time: 1372.1532s
	iters: 300, epoch: 29 | loss: 0.0027190
	speed: 0.0442s/iter; left time: 1479.0947s
	iters: 400, epoch: 29 | loss: 0.0041649
	speed: 0.0349s/iter; left time: 1164.0499s
Epoch: 29 cost time: 20.239667654037476
Epoch: 29, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0045828
	speed: 0.3228s/iter; left time: 10716.7748s
	iters: 200, epoch: 30 | loss: 0.0002580
	speed: 0.0407s/iter; left time: 1346.2642s
	iters: 300, epoch: 30 | loss: 0.0003566
	speed: 0.0419s/iter; left time: 1383.5230s
	iters: 400, epoch: 30 | loss: 0.0361163
	speed: 0.0398s/iter; left time: 1309.4890s
Epoch: 30 cost time: 20.1086688041687
Epoch: 30, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
Validation loss decreased (-0.969981 --> -0.971125).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0289749
	speed: 0.3165s/iter; left time: 10359.5955s
	iters: 200, epoch: 31 | loss: 0.0016836
	speed: 0.0408s/iter; left time: 1332.9466s
	iters: 300, epoch: 31 | loss: 0.0010796
	speed: 0.0375s/iter; left time: 1219.1340s
	iters: 400, epoch: 31 | loss: 0.0028131
	speed: 0.0398s/iter; left time: 1292.0488s
Epoch: 31 cost time: 19.124106407165527
Epoch: 31, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0016216
	speed: 0.2852s/iter; left time: 9202.2343s
	iters: 200, epoch: 32 | loss: 0.0099002
	speed: 0.0385s/iter; left time: 1239.3795s
	iters: 300, epoch: 32 | loss: 0.0004264
	speed: 0.0369s/iter; left time: 1182.2690s
	iters: 400, epoch: 32 | loss: 0.0017395
	speed: 0.0385s/iter; left time: 1230.9162s
Epoch: 32 cost time: 18.215290546417236
Epoch: 32, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.965 Test Loss: 0.201 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.4121825
	speed: 0.2767s/iter; left time: 8797.7927s
	iters: 200, epoch: 33 | loss: 0.0013663
	speed: 0.0363s/iter; left time: 1151.9825s
	iters: 300, epoch: 33 | loss: 0.0273102
	speed: 0.0396s/iter; left time: 1249.6439s
	iters: 400, epoch: 33 | loss: 0.0008131
	speed: 0.0375s/iter; left time: 1180.5692s
Epoch: 33 cost time: 18.10372304916382
Epoch: 33, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.962 Test Loss: 0.208 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0136779
	speed: 0.2983s/iter; left time: 9343.5927s
	iters: 200, epoch: 34 | loss: 0.0155213
	speed: 0.0354s/iter; left time: 1105.9083s
	iters: 300, epoch: 34 | loss: 0.0225548
	speed: 0.0435s/iter; left time: 1355.0456s
	iters: 400, epoch: 34 | loss: 0.2535714
	speed: 0.0404s/iter; left time: 1254.5900s
Epoch: 34 cost time: 18.99666976928711
Epoch: 34, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000216
	speed: 0.2769s/iter; left time: 8544.9050s
	iters: 200, epoch: 35 | loss: 0.0137144
	speed: 0.0323s/iter; left time: 993.4361s
	iters: 300, epoch: 35 | loss: 0.0157422
	speed: 0.0305s/iter; left time: 935.5114s
	iters: 400, epoch: 35 | loss: 0.0278611
	speed: 0.0318s/iter; left time: 970.2757s
Epoch: 35 cost time: 16.263471126556396
Epoch: 35, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0001513
	speed: 0.2820s/iter; left time: 8569.9912s
	iters: 200, epoch: 36 | loss: 0.0096988
	speed: 0.0370s/iter; left time: 1120.5500s
	iters: 300, epoch: 36 | loss: 0.0205880
	speed: 0.0374s/iter; left time: 1127.9999s
	iters: 400, epoch: 36 | loss: 0.0018333
	speed: 0.0362s/iter; left time: 1089.3402s
Epoch: 36 cost time: 18.15895128250122
Epoch: 36, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0122486
	speed: 0.2748s/iter; left time: 8222.6793s
	iters: 200, epoch: 37 | loss: 0.0009745
	speed: 0.0359s/iter; left time: 1071.6738s
	iters: 300, epoch: 37 | loss: 0.2190613
	speed: 0.0363s/iter; left time: 1078.5222s
	iters: 400, epoch: 37 | loss: 0.1170654
	speed: 0.0367s/iter; left time: 1086.3741s
Epoch: 37 cost time: 17.546451807022095
Epoch: 37, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0012791
	speed: 0.2759s/iter; left time: 8123.6321s
	iters: 200, epoch: 38 | loss: 0.0146557
	speed: 0.0319s/iter; left time: 936.3694s
	iters: 300, epoch: 38 | loss: 0.0010394
	speed: 0.0392s/iter; left time: 1146.9941s
	iters: 400, epoch: 38 | loss: 0.0539045
	speed: 0.0322s/iter; left time: 937.5972s
Epoch: 38 cost time: 16.59879446029663
Epoch: 38, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0015319
	speed: 0.2756s/iter; left time: 7987.9774s
	iters: 200, epoch: 39 | loss: 0.0298435
	speed: 0.0339s/iter; left time: 978.2467s
	iters: 300, epoch: 39 | loss: 0.0044657
	speed: 0.0364s/iter; left time: 1048.4795s
	iters: 400, epoch: 39 | loss: 0.2740053
	speed: 0.0378s/iter; left time: 1084.0464s
Epoch: 39 cost time: 17.11010432243347
Epoch: 39, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0209447
	speed: 0.2650s/iter; left time: 7555.5631s
	iters: 200, epoch: 40 | loss: 0.0006956
	speed: 0.0324s/iter; left time: 921.6765s
	iters: 300, epoch: 40 | loss: 0.0077195
	speed: 0.0339s/iter; left time: 960.0535s
	iters: 400, epoch: 40 | loss: 0.0010107
	speed: 0.0367s/iter; left time: 1036.3593s
Epoch: 40 cost time: 17.62864327430725
Epoch: 40, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.971125 --> -0.971696).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0024656
	speed: 0.2894s/iter; left time: 8115.1961s
	iters: 200, epoch: 41 | loss: 0.0348583
	speed: 0.0387s/iter; left time: 1082.0819s
	iters: 300, epoch: 41 | loss: 0.1069865
	speed: 0.0376s/iter; left time: 1046.5763s
	iters: 400, epoch: 41 | loss: 0.0081712
	speed: 0.0393s/iter; left time: 1089.7361s
Epoch: 41 cost time: 18.802501916885376
Epoch: 41, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.196 Vali Acc: 0.971 Test Loss: 0.196 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0013159
	speed: 0.2842s/iter; left time: 7835.8597s
	iters: 200, epoch: 42 | loss: 0.0015069
	speed: 0.0365s/iter; left time: 1002.4163s
	iters: 300, epoch: 42 | loss: 0.0010347
	speed: 0.0329s/iter; left time: 900.6168s
	iters: 400, epoch: 42 | loss: 0.0211677
	speed: 0.0378s/iter; left time: 1032.0354s
Epoch: 42 cost time: 17.839956998825073
Epoch: 42, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
Validation loss decreased (-0.971696 --> -0.973697).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0004686
	speed: 0.2717s/iter; left time: 7363.5566s
	iters: 200, epoch: 43 | loss: 0.2220337
	speed: 0.0361s/iter; left time: 975.6048s
	iters: 300, epoch: 43 | loss: 0.0065152
	speed: 0.0357s/iter; left time: 960.8484s
	iters: 400, epoch: 43 | loss: 0.0003224
	speed: 0.0336s/iter; left time: 901.7556s
Epoch: 43 cost time: 17.192946434020996
Epoch: 43, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0305986
	speed: 0.2943s/iter; left time: 7837.7458s
	iters: 200, epoch: 44 | loss: 0.0348989
	speed: 0.0384s/iter; left time: 1020.1983s
	iters: 300, epoch: 44 | loss: 0.0092510
	speed: 0.0391s/iter; left time: 1032.8365s
	iters: 400, epoch: 44 | loss: 0.0495496
	speed: 0.0336s/iter; left time: 884.7144s
Epoch: 44 cost time: 18.338098526000977
Epoch: 44, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.971 Test Loss: 0.200 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0003165
	speed: 0.2819s/iter; left time: 7375.8934s
	iters: 200, epoch: 45 | loss: 0.0117819
	speed: 0.0376s/iter; left time: 978.9681s
	iters: 300, epoch: 45 | loss: 0.0214608
	speed: 0.0395s/iter; left time: 1025.7535s
	iters: 400, epoch: 45 | loss: 0.0010836
	speed: 0.0354s/iter; left time: 914.3722s
Epoch: 45 cost time: 18.27531409263611
Epoch: 45, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.969 Test Loss: 0.210 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0002511
	speed: 0.2714s/iter; left time: 6974.6063s
	iters: 200, epoch: 46 | loss: 0.0022418
	speed: 0.0305s/iter; left time: 781.6648s
	iters: 300, epoch: 46 | loss: 0.0149325
	speed: 0.0339s/iter; left time: 864.3105s
	iters: 400, epoch: 46 | loss: 0.0007876
	speed: 0.0321s/iter; left time: 815.3598s
Epoch: 46 cost time: 16.81769037246704
Epoch: 46, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.0251951
	speed: 0.2896s/iter; left time: 7306.2095s
	iters: 200, epoch: 47 | loss: 0.0178384
	speed: 0.0358s/iter; left time: 900.1618s
	iters: 300, epoch: 47 | loss: 0.0001165
	speed: 0.0342s/iter; left time: 856.2198s
	iters: 400, epoch: 47 | loss: 0.0055629
	speed: 0.0379s/iter; left time: 944.4571s
Epoch: 47 cost time: 17.72518491744995
Epoch: 47, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 0.0003047
	speed: 0.2594s/iter; left time: 6421.8270s
	iters: 200, epoch: 48 | loss: 0.0441451
	speed: 0.0330s/iter; left time: 813.3414s
	iters: 300, epoch: 48 | loss: 0.0026958
	speed: 0.0325s/iter; left time: 797.1359s
	iters: 400, epoch: 48 | loss: 0.0004578
	speed: 0.0340s/iter; left time: 831.7396s
Epoch: 48 cost time: 16.026360511779785
Epoch: 48, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 0.0064420
	speed: 0.2602s/iter; left time: 6319.3574s
	iters: 200, epoch: 49 | loss: 0.0122310
	speed: 0.0316s/iter; left time: 764.0540s
	iters: 300, epoch: 49 | loss: 0.0160272
	speed: 0.0299s/iter; left time: 720.1531s
	iters: 400, epoch: 49 | loss: 0.0024148
	speed: 0.0368s/iter; left time: 882.7665s
Epoch: 49 cost time: 16.30025315284729
Epoch: 49, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.238 Vali Acc: 0.965 Test Loss: 0.238 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.0013054
	speed: 0.2610s/iter; left time: 6217.1942s
	iters: 200, epoch: 50 | loss: 0.0054445
	speed: 0.0341s/iter; left time: 809.2263s
	iters: 300, epoch: 50 | loss: 0.0009838
	speed: 0.0367s/iter; left time: 866.2676s
	iters: 400, epoch: 50 | loss: 0.0012273
	speed: 0.0357s/iter; left time: 839.9886s
Epoch: 50 cost time: 16.521177053451538
Epoch: 50, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 0.0011986
	speed: 0.2607s/iter; left time: 6087.0741s
	iters: 200, epoch: 51 | loss: 0.0006231
	speed: 0.0363s/iter; left time: 844.4703s
	iters: 300, epoch: 51 | loss: 0.0016123
	speed: 0.0328s/iter; left time: 759.1598s
	iters: 400, epoch: 51 | loss: 0.0001235
	speed: 0.0374s/iter; left time: 862.6241s
Epoch: 51 cost time: 17.034722566604614
Epoch: 51, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 0.0011992
	speed: 0.2509s/iter; left time: 5740.9884s
	iters: 200, epoch: 52 | loss: 0.0009145
	speed: 0.0306s/iter; left time: 697.2455s
	iters: 300, epoch: 52 | loss: 0.0001030
	speed: 0.0301s/iter; left time: 683.7510s
	iters: 400, epoch: 52 | loss: 0.0004465
	speed: 0.0304s/iter; left time: 685.3643s
Epoch: 52 cost time: 15.737092018127441
Epoch: 52, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9736992567181246
model parameter : 12250
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8005778
	speed: 0.0663s/iter; left time: 3103.1335s
	iters: 200, epoch: 1 | loss: 1.0091943
	speed: 0.0367s/iter; left time: 1714.7756s
	iters: 300, epoch: 1 | loss: 0.6963601
	speed: 0.0321s/iter; left time: 1496.5870s
	iters: 400, epoch: 1 | loss: 0.4807281
	speed: 0.0328s/iter; left time: 1524.3201s
Epoch: 1 cost time: 19.590467929840088
Epoch: 1, Steps: 469 | Train Loss: 1.190 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
Validation loss decreased (inf --> -0.825037).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4234228
	speed: 0.3014s/iter; left time: 13965.8487s
	iters: 200, epoch: 2 | loss: 0.4405910
	speed: 0.0372s/iter; left time: 1720.7311s
	iters: 300, epoch: 2 | loss: 0.2634336
	speed: 0.0352s/iter; left time: 1622.3228s
	iters: 400, epoch: 2 | loss: 0.1963537
	speed: 0.0330s/iter; left time: 1518.9705s
Epoch: 2 cost time: 17.669007778167725
Epoch: 2, Steps: 469 | Train Loss: 0.369 Vali Loss: 0.365 Vali Acc: 0.895 Test Loss: 0.365 Test Acc: 0.895
Validation loss decreased (-0.825037 --> -0.894507).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1908261
	speed: 0.2787s/iter; left time: 12780.4774s
	iters: 200, epoch: 3 | loss: 0.2834408
	speed: 0.0410s/iter; left time: 1876.3375s
	iters: 300, epoch: 3 | loss: 0.2270536
	speed: 0.0416s/iter; left time: 1900.9212s
	iters: 400, epoch: 3 | loss: 0.3095730
	speed: 0.0402s/iter; left time: 1832.7316s
Epoch: 3 cost time: 19.15297222137451
Epoch: 3, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
Validation loss decreased (-0.894507 --> -0.937390).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0369640
	speed: 0.2741s/iter; left time: 12444.0018s
	iters: 200, epoch: 4 | loss: 0.0950841
	speed: 0.0363s/iter; left time: 1645.9131s
	iters: 300, epoch: 4 | loss: 0.1301889
	speed: 0.0381s/iter; left time: 1721.4011s
	iters: 400, epoch: 4 | loss: 0.0341496
	speed: 0.0377s/iter; left time: 1697.9591s
Epoch: 4 cost time: 16.975462436676025
Epoch: 4, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
Validation loss decreased (-0.937390 --> -0.943108).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3276678
	speed: 0.2500s/iter; left time: 11229.3174s
	iters: 200, epoch: 5 | loss: 0.1148648
	speed: 0.0330s/iter; left time: 1480.6141s
	iters: 300, epoch: 5 | loss: 0.0588726
	speed: 0.0372s/iter; left time: 1663.5015s
	iters: 400, epoch: 5 | loss: 0.0289786
	speed: 0.0353s/iter; left time: 1576.1449s
Epoch: 5 cost time: 17.55532670021057
Epoch: 5, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.943108 --> -0.951684).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2765388
	speed: 0.2611s/iter; left time: 11608.9717s
	iters: 200, epoch: 6 | loss: 0.0467105
	speed: 0.0275s/iter; left time: 1220.1266s
	iters: 300, epoch: 6 | loss: 0.0584246
	speed: 0.0294s/iter; left time: 1300.3834s
	iters: 400, epoch: 6 | loss: 0.0829203
	speed: 0.0302s/iter; left time: 1333.0658s
Epoch: 6 cost time: 13.989602088928223
Epoch: 6, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.951684 --> -0.956259).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0228601
	speed: 0.2453s/iter; left time: 10790.2991s
	iters: 200, epoch: 7 | loss: 0.0683276
	speed: 0.0279s/iter; left time: 1222.6993s
	iters: 300, epoch: 7 | loss: 0.0250636
	speed: 0.0314s/iter; left time: 1376.8267s
	iters: 400, epoch: 7 | loss: 0.0487523
	speed: 0.0251s/iter; left time: 1095.6917s
Epoch: 7 cost time: 14.059158325195312
Epoch: 7, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0882939
	speed: 0.2455s/iter; left time: 10685.7705s
	iters: 200, epoch: 8 | loss: 0.0083524
	speed: 0.0382s/iter; left time: 1658.3333s
	iters: 300, epoch: 8 | loss: 0.0038689
	speed: 0.0332s/iter; left time: 1438.2198s
	iters: 400, epoch: 8 | loss: 0.0404841
	speed: 0.0305s/iter; left time: 1317.3495s
Epoch: 8 cost time: 16.520848989486694
Epoch: 8, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
Validation loss decreased (-0.956259 --> -0.963692).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0602296
	speed: 0.2510s/iter; left time: 10804.4799s
	iters: 200, epoch: 9 | loss: 0.0123732
	speed: 0.0353s/iter; left time: 1516.1548s
	iters: 300, epoch: 9 | loss: 0.0114586
	speed: 0.0331s/iter; left time: 1418.4233s
	iters: 400, epoch: 9 | loss: 0.0317960
	speed: 0.0368s/iter; left time: 1572.6682s
Epoch: 9 cost time: 16.750762224197388
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0334281
	speed: 0.2560s/iter; left time: 10902.5350s
	iters: 200, epoch: 10 | loss: 0.0261890
	speed: 0.0346s/iter; left time: 1471.0931s
	iters: 300, epoch: 10 | loss: 0.1445067
	speed: 0.0258s/iter; left time: 1093.4318s
	iters: 400, epoch: 10 | loss: 0.0153730
	speed: 0.0352s/iter; left time: 1489.7595s
Epoch: 10 cost time: 15.9447500705719
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.217 Vali Acc: 0.955 Test Loss: 0.217 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0127647
	speed: 0.2915s/iter; left time: 12273.4166s
	iters: 200, epoch: 11 | loss: 0.0309600
	speed: 0.0357s/iter; left time: 1499.5698s
	iters: 300, epoch: 11 | loss: 0.0161139
	speed: 0.0319s/iter; left time: 1337.3582s
	iters: 400, epoch: 11 | loss: 0.0041744
	speed: 0.0346s/iter; left time: 1445.8523s
Epoch: 11 cost time: 16.748966693878174
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0059964
	speed: 0.2974s/iter; left time: 12386.0158s
	iters: 200, epoch: 12 | loss: 0.0019646
	speed: 0.0387s/iter; left time: 1608.3509s
	iters: 300, epoch: 12 | loss: 0.0153238
	speed: 0.0314s/iter; left time: 1303.1168s
	iters: 400, epoch: 12 | loss: 0.0236505
	speed: 0.0324s/iter; left time: 1341.2752s
Epoch: 12 cost time: 17.34764528274536
Epoch: 12, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0150920
	speed: 0.2644s/iter; left time: 10884.9317s
	iters: 200, epoch: 13 | loss: 0.0116398
	speed: 0.0356s/iter; left time: 1461.8858s
	iters: 300, epoch: 13 | loss: 0.0009646
	speed: 0.0400s/iter; left time: 1637.7257s
	iters: 400, epoch: 13 | loss: 0.0486236
	speed: 0.0380s/iter; left time: 1553.7162s
Epoch: 13 cost time: 18.281301259994507
Epoch: 13, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
Validation loss decreased (-0.963692 --> -0.969124).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0029725
	speed: 0.2755s/iter; left time: 11215.0753s
	iters: 200, epoch: 14 | loss: 0.0047595
	speed: 0.0359s/iter; left time: 1459.0559s
	iters: 300, epoch: 14 | loss: 0.0085139
	speed: 0.0307s/iter; left time: 1242.1156s
	iters: 400, epoch: 14 | loss: 0.0197330
	speed: 0.0378s/iter; left time: 1526.2219s
Epoch: 14 cost time: 17.044764518737793
Epoch: 14, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0019151
	speed: 0.2848s/iter; left time: 11459.6175s
	iters: 200, epoch: 15 | loss: 0.0276962
	speed: 0.0351s/iter; left time: 1408.7227s
	iters: 300, epoch: 15 | loss: 0.0117781
	speed: 0.0349s/iter; left time: 1398.7187s
	iters: 400, epoch: 15 | loss: 0.0384431
	speed: 0.0372s/iter; left time: 1484.7497s
Epoch: 15 cost time: 17.144979000091553
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0143484
	speed: 0.2701s/iter; left time: 10739.9014s
	iters: 200, epoch: 16 | loss: 0.0218076
	speed: 0.0331s/iter; left time: 1311.6728s
	iters: 300, epoch: 16 | loss: 0.0033461
	speed: 0.0282s/iter; left time: 1116.1335s
	iters: 400, epoch: 16 | loss: 0.0174545
	speed: 0.0328s/iter; left time: 1294.8519s
Epoch: 16 cost time: 15.153385877609253
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
Validation loss decreased (-0.969124 --> -0.969410).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0682050
	speed: 0.2820s/iter; left time: 11082.2971s
	iters: 200, epoch: 17 | loss: 0.0234408
	speed: 0.0322s/iter; left time: 1261.7303s
	iters: 300, epoch: 17 | loss: 0.0013439
	speed: 0.0314s/iter; left time: 1227.0827s
	iters: 400, epoch: 17 | loss: 0.0026701
	speed: 0.0280s/iter; left time: 1091.9522s
Epoch: 17 cost time: 15.624627590179443
Epoch: 17, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0238949
	speed: 0.2717s/iter; left time: 10548.9540s
	iters: 200, epoch: 18 | loss: 0.0116321
	speed: 0.0369s/iter; left time: 1430.0241s
	iters: 300, epoch: 18 | loss: 0.0560652
	speed: 0.0332s/iter; left time: 1280.5775s
	iters: 400, epoch: 18 | loss: 0.0175912
	speed: 0.0321s/iter; left time: 1238.2511s
Epoch: 18 cost time: 16.371422052383423
Epoch: 18, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.192 Vali Acc: 0.964 Test Loss: 0.192 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0114797
	speed: 0.2721s/iter; left time: 10436.6529s
	iters: 200, epoch: 19 | loss: 0.0361089
	speed: 0.0315s/iter; left time: 1204.5105s
	iters: 300, epoch: 19 | loss: 0.4589314
	speed: 0.0312s/iter; left time: 1188.9902s
	iters: 400, epoch: 19 | loss: 0.0759762
	speed: 0.0324s/iter; left time: 1231.5951s
Epoch: 19 cost time: 16.44022512435913
Epoch: 19, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003473
	speed: 0.2757s/iter; left time: 10447.8708s
	iters: 200, epoch: 20 | loss: 0.0885686
	speed: 0.0429s/iter; left time: 1621.2028s
	iters: 300, epoch: 20 | loss: 0.0157036
	speed: 0.0347s/iter; left time: 1309.6718s
	iters: 400, epoch: 20 | loss: 0.0164601
	speed: 0.0299s/iter; left time: 1125.7710s
Epoch: 20 cost time: 17.05427074432373
Epoch: 20, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0012415
	speed: 0.2583s/iter; left time: 9666.5878s
	iters: 200, epoch: 21 | loss: 0.0076275
	speed: 0.0397s/iter; left time: 1481.2286s
	iters: 300, epoch: 21 | loss: 0.0181811
	speed: 0.0367s/iter; left time: 1367.0069s
	iters: 400, epoch: 21 | loss: 0.0046626
	speed: 0.0316s/iter; left time: 1173.9447s
Epoch: 21 cost time: 17.350860357284546
Epoch: 21, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0567518
	speed: 0.2678s/iter; left time: 9895.1713s
	iters: 200, epoch: 22 | loss: 0.0651766
	speed: 0.0386s/iter; left time: 1423.9937s
	iters: 300, epoch: 22 | loss: 0.0011110
	speed: 0.0444s/iter; left time: 1633.2475s
	iters: 400, epoch: 22 | loss: 0.0009445
	speed: 0.0402s/iter; left time: 1472.9096s
Epoch: 22 cost time: 19.530006408691406
Epoch: 22, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0384414
	speed: 0.3082s/iter; left time: 11243.2820s
	iters: 200, epoch: 23 | loss: 0.0024540
	speed: 0.0378s/iter; left time: 1376.1530s
	iters: 300, epoch: 23 | loss: 0.0010931
	speed: 0.0346s/iter; left time: 1256.0866s
	iters: 400, epoch: 23 | loss: 0.1125856
	speed: 0.0411s/iter; left time: 1485.3355s
Epoch: 23 cost time: 19.562506675720215
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0006097
	speed: 0.3132s/iter; left time: 11278.2400s
	iters: 200, epoch: 24 | loss: 0.0078403
	speed: 0.0409s/iter; left time: 1468.9702s
	iters: 300, epoch: 24 | loss: 0.0056775
	speed: 0.0385s/iter; left time: 1380.6185s
	iters: 400, epoch: 24 | loss: 0.0494626
	speed: 0.0375s/iter; left time: 1337.6821s
Epoch: 24 cost time: 18.589990854263306
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0104425
	speed: 0.3283s/iter; left time: 11670.3958s
	iters: 200, epoch: 25 | loss: 0.0003093
	speed: 0.0404s/iter; left time: 1433.4536s
	iters: 300, epoch: 25 | loss: 0.0049930
	speed: 0.0355s/iter; left time: 1253.8247s
	iters: 400, epoch: 25 | loss: 0.0046569
	speed: 0.0402s/iter; left time: 1416.5248s
Epoch: 25 cost time: 19.477129697799683
Epoch: 25, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.971125).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1566014
	speed: 0.3172s/iter; left time: 11126.1361s
	iters: 200, epoch: 26 | loss: 0.1673906
	speed: 0.0420s/iter; left time: 1468.3005s
	iters: 300, epoch: 26 | loss: 0.0184077
	speed: 0.0393s/iter; left time: 1370.9623s
	iters: 400, epoch: 26 | loss: 0.0292339
	speed: 0.0355s/iter; left time: 1234.2639s
Epoch: 26 cost time: 19.29539728164673
Epoch: 26, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0221079
	speed: 0.3124s/iter; left time: 10809.7630s
	iters: 200, epoch: 27 | loss: 0.0080181
	speed: 0.0342s/iter; left time: 1180.4066s
	iters: 300, epoch: 27 | loss: 0.0769761
	speed: 0.0349s/iter; left time: 1199.4668s
	iters: 400, epoch: 27 | loss: 0.0530456
	speed: 0.0358s/iter; left time: 1229.7455s
Epoch: 27 cost time: 17.513094186782837
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0019143
	speed: 0.2971s/iter; left time: 10143.9577s
	iters: 200, epoch: 28 | loss: 0.0004724
	speed: 0.0370s/iter; left time: 1260.9571s
	iters: 300, epoch: 28 | loss: 0.3510452
	speed: 0.0367s/iter; left time: 1246.6520s
	iters: 400, epoch: 28 | loss: 0.0044417
	speed: 0.0430s/iter; left time: 1453.8421s
Epoch: 28 cost time: 19.198352336883545
Epoch: 28, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0152323
	speed: 0.3230s/iter; left time: 10875.8655s
	iters: 200, epoch: 29 | loss: 0.0116401
	speed: 0.0358s/iter; left time: 1202.8340s
	iters: 300, epoch: 29 | loss: 0.0089782
	speed: 0.0409s/iter; left time: 1369.5733s
	iters: 400, epoch: 29 | loss: 0.0562769
	speed: 0.0458s/iter; left time: 1527.1245s
Epoch: 29 cost time: 20.124995946884155
Epoch: 29, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.966 Test Loss: 0.210 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0049207
	speed: 0.2903s/iter; left time: 9637.8516s
	iters: 200, epoch: 30 | loss: 0.0476898
	speed: 0.0344s/iter; left time: 1138.6362s
	iters: 300, epoch: 30 | loss: 0.0006579
	speed: 0.0426s/iter; left time: 1407.3692s
	iters: 400, epoch: 30 | loss: 0.0447690
	speed: 0.0435s/iter; left time: 1429.7239s
Epoch: 30 cost time: 19.032793760299683
Epoch: 30, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.971 Test Loss: 0.205 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0005693
	speed: 0.3424s/iter; left time: 11207.5228s
	iters: 200, epoch: 31 | loss: 0.3840660
	speed: 0.0374s/iter; left time: 1220.0201s
	iters: 300, epoch: 31 | loss: 0.0150423
	speed: 0.0439s/iter; left time: 1427.1919s
	iters: 400, epoch: 31 | loss: 0.0003851
	speed: 0.0388s/iter; left time: 1259.1430s
Epoch: 31 cost time: 20.426312923431396
Epoch: 31, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0017896
	speed: 0.3267s/iter; left time: 10539.2944s
	iters: 200, epoch: 32 | loss: 0.0112966
	speed: 0.0404s/iter; left time: 1299.9199s
	iters: 300, epoch: 32 | loss: 0.0006222
	speed: 0.0326s/iter; left time: 1044.6774s
	iters: 400, epoch: 32 | loss: 0.0037704
	speed: 0.0348s/iter; left time: 1111.5417s
Epoch: 32 cost time: 18.059804439544678
Epoch: 32, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.971125 --> -0.972554).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0002869
	speed: 0.3259s/iter; left time: 10361.1687s
	iters: 200, epoch: 33 | loss: 0.2244184
	speed: 0.0501s/iter; left time: 1586.8665s
	iters: 300, epoch: 33 | loss: 0.0014625
	speed: 0.0490s/iter; left time: 1547.5106s
	iters: 400, epoch: 33 | loss: 0.0508383
	speed: 0.0472s/iter; left time: 1486.1616s
Epoch: 33 cost time: 23.724390029907227
Epoch: 33, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0016070
	speed: 0.3519s/iter; left time: 11024.0920s
	iters: 200, epoch: 34 | loss: 0.0005954
	speed: 0.0492s/iter; left time: 1537.4489s
	iters: 300, epoch: 34 | loss: 0.0638065
	speed: 0.0493s/iter; left time: 1535.3848s
	iters: 400, epoch: 34 | loss: 0.0472638
	speed: 0.0484s/iter; left time: 1501.2102s
Epoch: 34 cost time: 23.753427028656006
Epoch: 34, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0030301
	speed: 0.3875s/iter; left time: 11955.3573s
	iters: 200, epoch: 35 | loss: 0.0030579
	speed: 0.0531s/iter; left time: 1633.9148s
	iters: 300, epoch: 35 | loss: 0.0842364
	speed: 0.0518s/iter; left time: 1588.9701s
	iters: 400, epoch: 35 | loss: 0.0010415
	speed: 0.0385s/iter; left time: 1175.3337s
Epoch: 35 cost time: 23.10589027404785
Epoch: 35, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0013444
	speed: 0.3422s/iter; left time: 10397.0535s
	iters: 200, epoch: 36 | loss: 0.0010321
	speed: 0.0461s/iter; left time: 1395.3352s
	iters: 300, epoch: 36 | loss: 0.0001823
	speed: 0.0445s/iter; left time: 1344.2967s
	iters: 400, epoch: 36 | loss: 0.5622833
	speed: 0.0446s/iter; left time: 1342.9405s
Epoch: 36 cost time: 22.09891438484192
Epoch: 36, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000599
	speed: 0.3692s/iter; left time: 11045.9855s
	iters: 200, epoch: 37 | loss: 0.0017862
	speed: 0.0481s/iter; left time: 1435.4137s
	iters: 300, epoch: 37 | loss: 0.0027848
	speed: 0.0491s/iter; left time: 1459.5469s
	iters: 400, epoch: 37 | loss: 0.2510961
	speed: 0.0481s/iter; left time: 1425.8149s
Epoch: 37 cost time: 24.509057760238647
Epoch: 37, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0023415
	speed: 0.4204s/iter; left time: 12380.6789s
	iters: 200, epoch: 38 | loss: 0.0017134
	speed: 0.0507s/iter; left time: 1487.8246s
	iters: 300, epoch: 38 | loss: 0.0022591
	speed: 0.0549s/iter; left time: 1604.6044s
	iters: 400, epoch: 38 | loss: 0.0004340
	speed: 0.0504s/iter; left time: 1469.3563s
Epoch: 38 cost time: 24.55911350250244
Epoch: 38, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0009047
	speed: 0.3812s/iter; left time: 11046.8487s
	iters: 200, epoch: 39 | loss: 0.0016996
	speed: 0.0368s/iter; left time: 1061.7246s
	iters: 300, epoch: 39 | loss: 0.0016211
	speed: 0.0415s/iter; left time: 1193.0260s
	iters: 400, epoch: 39 | loss: 0.0025910
	speed: 0.0438s/iter; left time: 1257.0419s
Epoch: 39 cost time: 20.186405897140503
Epoch: 39, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0049593
	speed: 0.3664s/iter; left time: 10447.3196s
	iters: 200, epoch: 40 | loss: 0.3725369
	speed: 0.0389s/iter; left time: 1105.7345s
	iters: 300, epoch: 40 | loss: 0.0155708
	speed: 0.0406s/iter; left time: 1149.7841s
	iters: 400, epoch: 40 | loss: 0.0017159
	speed: 0.0427s/iter; left time: 1204.7815s
Epoch: 40 cost time: 19.522839069366455
Epoch: 40, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.968 Test Loss: 0.194 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0144007
	speed: 0.3680s/iter; left time: 10319.2913s
	iters: 200, epoch: 41 | loss: 0.0005195
	speed: 0.0442s/iter; left time: 1236.2866s
	iters: 300, epoch: 41 | loss: 0.0008954
	speed: 0.0409s/iter; left time: 1138.7857s
	iters: 400, epoch: 41 | loss: 0.0005165
	speed: 0.0354s/iter; left time: 982.0858s
Epoch: 41 cost time: 19.12529230117798
Epoch: 41, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0003126
	speed: 0.3522s/iter; left time: 9710.1212s
	iters: 200, epoch: 42 | loss: 0.0053075
	speed: 0.0437s/iter; left time: 1200.6576s
	iters: 300, epoch: 42 | loss: 0.0022393
	speed: 0.0356s/iter; left time: 974.5995s
	iters: 400, epoch: 42 | loss: 0.0473975
	speed: 0.0429s/iter; left time: 1170.9734s
Epoch: 42 cost time: 20.74926495552063
Epoch: 42, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9725557461406518
model parameter : 8026
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7120959
	speed: 0.0773s/iter; left time: 3619.1308s
	iters: 200, epoch: 1 | loss: 1.2493006
	speed: 0.0487s/iter; left time: 2275.8544s
	iters: 300, epoch: 1 | loss: 0.6498595
	speed: 0.0439s/iter; left time: 2044.4322s
	iters: 400, epoch: 1 | loss: 0.9282884
	speed: 0.0461s/iter; left time: 2144.0720s
Epoch: 1 cost time: 24.637165784835815
Epoch: 1, Steps: 469 | Train Loss: 1.167 Vali Loss: 0.591 Vali Acc: 0.834 Test Loss: 0.591 Test Acc: 0.834
Validation loss decreased (inf --> -0.833613).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5580917
	speed: 0.3269s/iter; left time: 15144.1771s
	iters: 200, epoch: 2 | loss: 0.1240275
	speed: 0.0462s/iter; left time: 2133.6323s
	iters: 300, epoch: 2 | loss: 0.2910956
	speed: 0.0544s/iter; left time: 2510.0390s
	iters: 400, epoch: 2 | loss: 0.4035572
	speed: 0.0491s/iter; left time: 2261.9206s
Epoch: 2 cost time: 24.004820823669434
Epoch: 2, Steps: 469 | Train Loss: 0.386 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.833613 --> -0.902512).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2573256
	speed: 0.3794s/iter; left time: 17401.4567s
	iters: 200, epoch: 3 | loss: 0.1240405
	speed: 0.0400s/iter; left time: 1832.6989s
	iters: 300, epoch: 3 | loss: 0.1819571
	speed: 0.0370s/iter; left time: 1688.3050s
	iters: 400, epoch: 3 | loss: 0.1949659
	speed: 0.0422s/iter; left time: 1921.7472s
Epoch: 3 cost time: 20.093588829040527
Epoch: 3, Steps: 469 | Train Loss: 0.219 Vali Loss: 0.289 Vali Acc: 0.916 Test Loss: 0.289 Test Acc: 0.916
Validation loss decreased (-0.902512 --> -0.915949).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0557195
	speed: 0.3687s/iter; left time: 16737.9933s
	iters: 200, epoch: 4 | loss: 0.2689321
	speed: 0.0497s/iter; left time: 2252.3902s
	iters: 300, epoch: 4 | loss: 0.1410625
	speed: 0.0527s/iter; left time: 2382.8712s
	iters: 400, epoch: 4 | loss: 0.1772114
	speed: 0.0429s/iter; left time: 1935.1792s
Epoch: 4 cost time: 24.24034309387207
Epoch: 4, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.244 Vali Acc: 0.939 Test Loss: 0.244 Test Acc: 0.939
Validation loss decreased (-0.915949 --> -0.939391).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0679476
	speed: 0.3906s/iter; left time: 17546.8569s
	iters: 200, epoch: 5 | loss: 0.3712561
	speed: 0.0509s/iter; left time: 2282.6896s
	iters: 300, epoch: 5 | loss: 0.0339575
	speed: 0.0474s/iter; left time: 2119.3627s
	iters: 400, epoch: 5 | loss: 0.0666692
	speed: 0.0454s/iter; left time: 2027.3183s
Epoch: 5 cost time: 23.994996070861816
Epoch: 5, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.205 Vali Acc: 0.953 Test Loss: 0.205 Test Acc: 0.953
Validation loss decreased (-0.939391 --> -0.952828).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2336254
	speed: 0.3692s/iter; left time: 16411.3912s
	iters: 200, epoch: 6 | loss: 0.0524449
	speed: 0.0494s/iter; left time: 2192.5808s
	iters: 300, epoch: 6 | loss: 0.0922689
	speed: 0.0541s/iter; left time: 2394.8281s
	iters: 400, epoch: 6 | loss: 0.0468482
	speed: 0.0577s/iter; left time: 2549.3036s
Epoch: 6 cost time: 25.353482246398926
Epoch: 6, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.952828 --> -0.956545).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1161306
	speed: 0.3535s/iter; left time: 15547.4140s
	iters: 200, epoch: 7 | loss: 0.0352788
	speed: 0.0478s/iter; left time: 2098.4436s
	iters: 300, epoch: 7 | loss: 0.2114790
	speed: 0.0497s/iter; left time: 2177.8990s
	iters: 400, epoch: 7 | loss: 0.0583073
	speed: 0.0497s/iter; left time: 2171.7118s
Epoch: 7 cost time: 24.087551593780518
Epoch: 7, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.956545 --> -0.958832).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0589140
	speed: 0.3574s/iter; left time: 15551.3472s
	iters: 200, epoch: 8 | loss: 0.0196813
	speed: 0.0377s/iter; left time: 1638.3081s
	iters: 300, epoch: 8 | loss: 0.0100276
	speed: 0.0395s/iter; left time: 1710.7525s
	iters: 400, epoch: 8 | loss: 0.0137731
	speed: 0.0373s/iter; left time: 1610.3555s
Epoch: 8 cost time: 18.869951009750366
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
Validation loss decreased (-0.958832 --> -0.960261).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0419000
	speed: 0.3404s/iter; left time: 14652.8945s
	iters: 200, epoch: 9 | loss: 0.0506467
	speed: 0.0426s/iter; left time: 1831.0662s
	iters: 300, epoch: 9 | loss: 0.1378078
	speed: 0.0422s/iter; left time: 1809.7450s
	iters: 400, epoch: 9 | loss: 0.0916688
	speed: 0.0414s/iter; left time: 1769.6861s
Epoch: 9 cost time: 20.156811714172363
Epoch: 9, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.960261 --> -0.966837).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0706145
	speed: 0.3246s/iter; left time: 13821.2303s
	iters: 200, epoch: 10 | loss: 0.0376407
	speed: 0.0319s/iter; left time: 1354.8380s
	iters: 300, epoch: 10 | loss: 0.0355379
	speed: 0.0387s/iter; left time: 1639.9466s
	iters: 400, epoch: 10 | loss: 0.0113007
	speed: 0.0395s/iter; left time: 1669.8286s
Epoch: 10 cost time: 18.746516227722168
Epoch: 10, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0098395
	speed: 0.3203s/iter; left time: 13490.0798s
	iters: 200, epoch: 11 | loss: 0.0187976
	speed: 0.0403s/iter; left time: 1692.6499s
	iters: 300, epoch: 11 | loss: 0.0288147
	speed: 0.0431s/iter; left time: 1808.2813s
	iters: 400, epoch: 11 | loss: 0.0150747
	speed: 0.0375s/iter; left time: 1569.9289s
Epoch: 11 cost time: 20.023985147476196
Epoch: 11, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0022697
	speed: 0.3039s/iter; left time: 12654.6963s
	iters: 200, epoch: 12 | loss: 0.0495403
	speed: 0.0380s/iter; left time: 1578.9588s
	iters: 300, epoch: 12 | loss: 0.0350967
	speed: 0.0377s/iter; left time: 1562.5376s
	iters: 400, epoch: 12 | loss: 0.0007239
	speed: 0.0462s/iter; left time: 1908.1296s
Epoch: 12 cost time: 20.044376134872437
Epoch: 12, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0233081
	speed: 0.3533s/iter; left time: 14546.2438s
	iters: 200, epoch: 13 | loss: 0.0203272
	speed: 0.0442s/iter; left time: 1815.3613s
	iters: 300, epoch: 13 | loss: 0.0100212
	speed: 0.0472s/iter; left time: 1933.9599s
	iters: 400, epoch: 13 | loss: 0.1713356
	speed: 0.0459s/iter; left time: 1877.4135s
Epoch: 13 cost time: 22.507813215255737
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0068746
	speed: 0.3440s/iter; left time: 14004.0512s
	iters: 200, epoch: 14 | loss: 0.1235908
	speed: 0.0461s/iter; left time: 1872.3762s
	iters: 300, epoch: 14 | loss: 0.2544923
	speed: 0.0449s/iter; left time: 1820.5401s
	iters: 400, epoch: 14 | loss: 0.0484704
	speed: 0.0471s/iter; left time: 1903.9017s
Epoch: 14 cost time: 22.115065574645996
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0031443
	speed: 0.3588s/iter; left time: 14436.5021s
	iters: 200, epoch: 15 | loss: 0.0019906
	speed: 0.0449s/iter; left time: 1801.4288s
	iters: 300, epoch: 15 | loss: 0.0157571
	speed: 0.0434s/iter; left time: 1739.2652s
	iters: 400, epoch: 15 | loss: 0.0101299
	speed: 0.0441s/iter; left time: 1760.8335s
Epoch: 15 cost time: 21.38346266746521
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0799802
	speed: 0.3648s/iter; left time: 14508.0590s
	iters: 200, epoch: 16 | loss: 0.0265618
	speed: 0.0465s/iter; left time: 1843.9351s
	iters: 300, epoch: 16 | loss: 0.0140262
	speed: 0.0462s/iter; left time: 1827.0688s
	iters: 400, epoch: 16 | loss: 0.0107871
	speed: 0.0464s/iter; left time: 1832.9585s
Epoch: 16 cost time: 23.065579891204834
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.968552).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0371612
	speed: 0.3665s/iter; left time: 14400.4819s
	iters: 200, epoch: 17 | loss: 0.1286416
	speed: 0.0499s/iter; left time: 1954.2710s
	iters: 300, epoch: 17 | loss: 0.0942887
	speed: 0.0529s/iter; left time: 2069.5867s
	iters: 400, epoch: 17 | loss: 0.0434597
	speed: 0.0516s/iter; left time: 2013.7368s
Epoch: 17 cost time: 24.509358167648315
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
Validation loss decreased (-0.968552 --> -0.969124).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0856495
	speed: 0.3694s/iter; left time: 14341.2087s
	iters: 200, epoch: 18 | loss: 0.0421335
	speed: 0.0471s/iter; left time: 1824.2795s
	iters: 300, epoch: 18 | loss: 0.0315535
	speed: 0.0519s/iter; left time: 2004.1030s
	iters: 400, epoch: 18 | loss: 0.0912649
	speed: 0.0559s/iter; left time: 2155.1921s
Epoch: 18 cost time: 24.397002458572388
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0110625
	speed: 0.3873s/iter; left time: 14856.5844s
	iters: 200, epoch: 19 | loss: 0.0021809
	speed: 0.0480s/iter; left time: 1837.6403s
	iters: 300, epoch: 19 | loss: 0.0108582
	speed: 0.0469s/iter; left time: 1789.5504s
	iters: 400, epoch: 19 | loss: 0.0798798
	speed: 0.0487s/iter; left time: 1852.9778s
Epoch: 19 cost time: 23.434211492538452
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0006150
	speed: 0.3908s/iter; left time: 14806.8406s
	iters: 200, epoch: 20 | loss: 0.0358598
	speed: 0.0408s/iter; left time: 1541.5766s
	iters: 300, epoch: 20 | loss: 0.0848192
	speed: 0.0395s/iter; left time: 1487.1695s
	iters: 400, epoch: 20 | loss: 0.0004193
	speed: 0.0404s/iter; left time: 1520.4668s
Epoch: 20 cost time: 19.389816284179688
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1147082
	speed: 0.3166s/iter; left time: 11848.5510s
	iters: 200, epoch: 21 | loss: 0.0090982
	speed: 0.0393s/iter; left time: 1467.1261s
	iters: 300, epoch: 21 | loss: 0.0044924
	speed: 0.0457s/iter; left time: 1701.5045s
	iters: 400, epoch: 21 | loss: 0.0139043
	speed: 0.0425s/iter; left time: 1578.1655s
Epoch: 21 cost time: 20.15416979789734
Epoch: 21, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.969981).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0067641
	speed: 0.3204s/iter; left time: 11839.4565s
	iters: 200, epoch: 22 | loss: 0.0019168
	speed: 0.0393s/iter; left time: 1446.5545s
	iters: 300, epoch: 22 | loss: 0.0007062
	speed: 0.0358s/iter; left time: 1314.2515s
	iters: 400, epoch: 22 | loss: 0.0422959
	speed: 0.0357s/iter; left time: 1309.5290s
Epoch: 22 cost time: 18.59481906890869
Epoch: 22, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0009232
	speed: 0.3151s/iter; left time: 11496.0252s
	iters: 200, epoch: 23 | loss: 0.0000603
	speed: 0.0403s/iter; left time: 1465.7412s
	iters: 300, epoch: 23 | loss: 0.0007479
	speed: 0.0365s/iter; left time: 1325.4069s
	iters: 400, epoch: 23 | loss: 0.0651359
	speed: 0.0432s/iter; left time: 1563.6723s
Epoch: 23 cost time: 20.540342330932617
Epoch: 23, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.202 Vali Acc: 0.966 Test Loss: 0.202 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0016480
	speed: 0.3228s/iter; left time: 11623.7376s
	iters: 200, epoch: 24 | loss: 0.0890044
	speed: 0.0495s/iter; left time: 1778.3534s
	iters: 300, epoch: 24 | loss: 0.0036337
	speed: 0.0368s/iter; left time: 1316.2197s
	iters: 400, epoch: 24 | loss: 0.0232830
	speed: 0.0440s/iter; left time: 1569.7991s
Epoch: 24 cost time: 20.562188863754272
Epoch: 24, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.969981 --> -0.970267).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0016431
	speed: 0.3100s/iter; left time: 11019.7485s
	iters: 200, epoch: 25 | loss: 0.0183727
	speed: 0.0410s/iter; left time: 1454.7255s
	iters: 300, epoch: 25 | loss: 0.0037056
	speed: 0.0328s/iter; left time: 1158.6741s
	iters: 400, epoch: 25 | loss: 0.0647272
	speed: 0.0446s/iter; left time: 1572.6924s
Epoch: 25 cost time: 20.913857221603394
Epoch: 25, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0014747
	speed: 0.3594s/iter; left time: 12606.4838s
	iters: 200, epoch: 26 | loss: 0.0493264
	speed: 0.0376s/iter; left time: 1316.4056s
	iters: 300, epoch: 26 | loss: 0.0076337
	speed: 0.0353s/iter; left time: 1230.4747s
	iters: 400, epoch: 26 | loss: 0.0114351
	speed: 0.0311s/iter; left time: 1082.3596s
Epoch: 26 cost time: 17.772704362869263
Epoch: 26, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0004570
	speed: 0.3511s/iter; left time: 12150.0019s
	iters: 200, epoch: 27 | loss: 0.0093500
	speed: 0.0442s/iter; left time: 1526.5199s
	iters: 300, epoch: 27 | loss: 0.0044137
	speed: 0.0414s/iter; left time: 1424.4222s
	iters: 400, epoch: 27 | loss: 0.0163601
	speed: 0.0454s/iter; left time: 1557.4245s
Epoch: 27 cost time: 21.927529096603394
Epoch: 27, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.970553).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0121264
	speed: 0.3544s/iter; left time: 12098.0295s
	iters: 200, epoch: 28 | loss: 0.0470185
	speed: 0.0389s/iter; left time: 1322.4749s
	iters: 300, epoch: 28 | loss: 0.0648996
	speed: 0.0423s/iter; left time: 1435.5045s
	iters: 400, epoch: 28 | loss: 0.0011049
	speed: 0.0410s/iter; left time: 1386.8214s
Epoch: 28 cost time: 20.477041244506836
Epoch: 28, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0089721
	speed: 0.3648s/iter; left time: 12281.1180s
	iters: 200, epoch: 29 | loss: 0.0127240
	speed: 0.0480s/iter; left time: 1611.5777s
	iters: 300, epoch: 29 | loss: 0.0008408
	speed: 0.0503s/iter; left time: 1684.4236s
	iters: 400, epoch: 29 | loss: 0.0018259
	speed: 0.0421s/iter; left time: 1403.2648s
Epoch: 29 cost time: 23.03592300415039
Epoch: 29, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
Validation loss decreased (-0.970553 --> -0.971125).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0006909
	speed: 0.3749s/iter; left time: 12448.2337s
	iters: 200, epoch: 30 | loss: 0.0005451
	speed: 0.0497s/iter; left time: 1645.4640s
	iters: 300, epoch: 30 | loss: 0.0176438
	speed: 0.0488s/iter; left time: 1610.7503s
	iters: 400, epoch: 30 | loss: 0.0583382
	speed: 0.0440s/iter; left time: 1448.8126s
Epoch: 30 cost time: 22.9850594997406
Epoch: 30, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0094836
	speed: 0.3672s/iter; left time: 12018.4212s
	iters: 200, epoch: 31 | loss: 0.0086198
	speed: 0.0473s/iter; left time: 1544.8586s
	iters: 300, epoch: 31 | loss: 0.0011970
	speed: 0.0457s/iter; left time: 1487.5703s
	iters: 400, epoch: 31 | loss: 0.0009941
	speed: 0.0423s/iter; left time: 1371.5244s
Epoch: 31 cost time: 23.06462812423706
Epoch: 31, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0225564
	speed: 0.3299s/iter; left time: 10643.4629s
	iters: 200, epoch: 32 | loss: 0.0008972
	speed: 0.0347s/iter; left time: 1115.3629s
	iters: 300, epoch: 32 | loss: 0.0017412
	speed: 0.0381s/iter; left time: 1221.8585s
	iters: 400, epoch: 32 | loss: 0.0103794
	speed: 0.0391s/iter; left time: 1250.8301s
Epoch: 32 cost time: 19.364038228988647
Epoch: 32, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.971125 --> -0.971982).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0070325
	speed: 0.3290s/iter; left time: 10459.6846s
	iters: 200, epoch: 33 | loss: 0.0021248
	speed: 0.0458s/iter; left time: 1453.0461s
	iters: 300, epoch: 33 | loss: 0.0004385
	speed: 0.0415s/iter; left time: 1312.3587s
	iters: 400, epoch: 33 | loss: 0.0098316
	speed: 0.0380s/iter; left time: 1196.3410s
Epoch: 33 cost time: 20.39746904373169
Epoch: 33, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.961 Test Loss: 0.214 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0034537
	speed: 0.3011s/iter; left time: 9430.7272s
	iters: 200, epoch: 34 | loss: 0.0648460
	speed: 0.0328s/iter; left time: 1023.9930s
	iters: 300, epoch: 34 | loss: 0.0278898
	speed: 0.0350s/iter; left time: 1089.0773s
	iters: 400, epoch: 34 | loss: 0.1346056
	speed: 0.0388s/iter; left time: 1202.1841s
Epoch: 34 cost time: 17.11227011680603
Epoch: 34, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0218820
	speed: 0.3381s/iter; left time: 10431.1829s
	iters: 200, epoch: 35 | loss: 0.0080341
	speed: 0.0285s/iter; left time: 876.3542s
	iters: 300, epoch: 35 | loss: 0.0017753
	speed: 0.0362s/iter; left time: 1109.3428s
	iters: 400, epoch: 35 | loss: 0.0245008
	speed: 0.0357s/iter; left time: 1091.8933s
Epoch: 35 cost time: 17.748591661453247
Epoch: 35, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0368380
	speed: 0.3110s/iter; left time: 9450.4666s
	iters: 200, epoch: 36 | loss: 0.0254838
	speed: 0.0466s/iter; left time: 1412.4996s
	iters: 300, epoch: 36 | loss: 0.0021884
	speed: 0.0392s/iter; left time: 1182.6020s
	iters: 400, epoch: 36 | loss: 0.0171322
	speed: 0.0389s/iter; left time: 1171.3768s
Epoch: 36 cost time: 20.240912675857544
Epoch: 36, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0633245
	speed: 0.2979s/iter; left time: 8911.8758s
	iters: 200, epoch: 37 | loss: 0.0508034
	speed: 0.0344s/iter; left time: 1026.1574s
	iters: 300, epoch: 37 | loss: 0.0006998
	speed: 0.0471s/iter; left time: 1401.1120s
	iters: 400, epoch: 37 | loss: 0.0005515
	speed: 0.0410s/iter; left time: 1214.1777s
Epoch: 37 cost time: 19.77175211906433
Epoch: 37, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.969 Test Loss: 0.219 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0040295
	speed: 0.3210s/iter; left time: 9453.7052s
	iters: 200, epoch: 38 | loss: 0.0024047
	speed: 0.0449s/iter; left time: 1318.0823s
	iters: 300, epoch: 38 | loss: 0.0008968
	speed: 0.0431s/iter; left time: 1259.8456s
	iters: 400, epoch: 38 | loss: 0.0170220
	speed: 0.0453s/iter; left time: 1321.5435s
Epoch: 38 cost time: 21.64268183708191
Epoch: 38, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0129495
	speed: 0.3845s/iter; left time: 11141.4954s
	iters: 200, epoch: 39 | loss: 0.2000407
	speed: 0.0470s/iter; left time: 1358.3645s
	iters: 300, epoch: 39 | loss: 0.0032559
	speed: 0.0414s/iter; left time: 1192.2739s
	iters: 400, epoch: 39 | loss: 0.0326272
	speed: 0.0444s/iter; left time: 1273.2972s
Epoch: 39 cost time: 21.81523871421814
Epoch: 39, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0012705
	speed: 0.3776s/iter; left time: 10764.5757s
	iters: 200, epoch: 40 | loss: 0.3408889
	speed: 0.0386s/iter; left time: 1095.4995s
	iters: 300, epoch: 40 | loss: 0.0155833
	speed: 0.0411s/iter; left time: 1163.7408s
	iters: 400, epoch: 40 | loss: 0.0149983
	speed: 0.0461s/iter; left time: 1300.9068s
Epoch: 40 cost time: 20.800792455673218
Epoch: 40, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0012854
	speed: 0.3712s/iter; left time: 10408.1049s
	iters: 200, epoch: 41 | loss: 0.0007945
	speed: 0.0443s/iter; left time: 1238.4164s
	iters: 300, epoch: 41 | loss: 0.0018074
	speed: 0.0408s/iter; left time: 1136.0247s
	iters: 400, epoch: 41 | loss: 0.1301731
	speed: 0.0426s/iter; left time: 1182.2875s
Epoch: 41 cost time: 21.638148069381714
Epoch: 41, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0262100
	speed: 0.3501s/iter; left time: 9652.2612s
	iters: 200, epoch: 42 | loss: 0.1217285
	speed: 0.0476s/iter; left time: 1308.6407s
	iters: 300, epoch: 42 | loss: 0.0107654
	speed: 0.0430s/iter; left time: 1176.6362s
	iters: 400, epoch: 42 | loss: 0.0792391
	speed: 0.0416s/iter; left time: 1134.6135s
Epoch: 42 cost time: 21.717134952545166
Epoch: 42, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_PatchTST_UEA_ftM_sl8_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 5914
model size : 0.34MB
