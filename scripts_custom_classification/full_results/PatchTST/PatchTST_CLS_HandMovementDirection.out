Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4808883666992188
Epoch: 1, Steps: 10 | Train Loss: 1.551 Vali Loss: 1.355 Vali Acc: 0.392 Test Loss: 1.355 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.6090452671051025
Epoch: 2, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.420 Vali Acc: 0.392 Test Loss: 1.420 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.773000955581665
Epoch: 3, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.581 Vali Acc: 0.419 Test Loss: 1.581 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418903).  Saving model ...
Epoch: 4 cost time: 1.5927021503448486
Epoch: 4, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.590 Vali Acc: 0.473 Test Loss: 1.590 Test Acc: 0.473
Validation loss decreased (-0.418903 --> -0.472957).  Saving model ...
Epoch: 5 cost time: 1.532397985458374
Epoch: 5, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.675 Vali Acc: 0.514 Test Loss: 1.675 Test Acc: 0.514
Validation loss decreased (-0.472957 --> -0.513497).  Saving model ...
Epoch: 6 cost time: 2.0767862796783447
Epoch: 6, Steps: 10 | Train Loss: 0.167 Vali Loss: 2.192 Vali Acc: 0.459 Test Loss: 2.192 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7485604286193848
Epoch: 7, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.235 Vali Acc: 0.527 Test Loss: 2.235 Test Acc: 0.527
Validation loss decreased (-0.513497 --> -0.527005).  Saving model ...
Epoch: 8 cost time: 2.3584160804748535
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.988 Vali Acc: 0.500 Test Loss: 2.988 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9562180042266846
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.527 Vali Acc: 0.514 Test Loss: 2.527 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1075282096862793
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.012 Vali Acc: 0.500 Test Loss: 3.012 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4129672050476074
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.078 Vali Acc: 0.446 Test Loss: 3.078 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1016807556152344
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.405 Vali Acc: 0.500 Test Loss: 3.405 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7191402912139893
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.433 Vali Acc: 0.500 Test Loss: 3.433 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.555563449859619
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.386 Vali Acc: 0.459 Test Loss: 3.386 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1030566692352295
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.396 Vali Acc: 0.473 Test Loss: 3.396 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0250301361083984
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.632 Vali Acc: 0.446 Test Loss: 3.632 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3934762477874756
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.538 Vali Acc: 0.473 Test Loss: 3.538 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 808580
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9024837017059326
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.376 Vali Acc: 0.324 Test Loss: 1.376 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.9316301345825195
Epoch: 2, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.324311 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.966418981552124
Epoch: 3, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.243 Vali Acc: 0.446 Test Loss: 1.243 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8918533325195312
Epoch: 4, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 0.8976490497589111
Epoch: 5, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9038753509521484
Epoch: 6, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.550 Vali Acc: 0.459 Test Loss: 1.550 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0195002555847168
Epoch: 7, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.641 Vali Acc: 0.554 Test Loss: 1.641 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554038).  Saving model ...
Epoch: 8 cost time: 1.168776035308838
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.772 Vali Acc: 0.473 Test Loss: 1.772 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9014797210693359
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.924 Vali Acc: 0.473 Test Loss: 1.924 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9874053001403809
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.989 Vali Acc: 0.486 Test Loss: 1.989 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0944643020629883
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.023 Vali Acc: 0.486 Test Loss: 2.023 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3788695335388184
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.019 Vali Acc: 0.500 Test Loss: 2.019 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9857285022735596
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.044 Vali Acc: 0.500 Test Loss: 2.044 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1912755966186523
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.062 Vali Acc: 0.500 Test Loss: 2.062 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9314467906951904
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.065 Vali Acc: 0.500 Test Loss: 2.065 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0806536674499512
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.060 Vali Acc: 0.500 Test Loss: 2.060 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4191093444824219
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.060 Vali Acc: 0.514 Test Loss: 2.060 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 605060
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.810162305831909
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9882595539093018
Epoch: 2, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.243229 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.5139245986938477
Epoch: 3, Steps: 10 | Train Loss: 0.804 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9028739929199219
Epoch: 4, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.1260664463043213
Epoch: 5, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.412782907485962
Epoch: 6, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.309 Vali Acc: 0.541 Test Loss: 1.309 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9316971302032471
Epoch: 7, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.335 Vali Acc: 0.581 Test Loss: 1.335 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 8 cost time: 1.348022222518921
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.492 Vali Acc: 0.554 Test Loss: 1.492 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.038987159729004
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.538 Vali Acc: 0.554 Test Loss: 1.538 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7367515563964844
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.642 Vali Acc: 0.541 Test Loss: 1.642 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8094010353088379
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.640 Vali Acc: 0.500 Test Loss: 1.640 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7768311500549316
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.785 Vali Acc: 0.541 Test Loss: 1.785 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7787091732025146
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.687 Vali Acc: 0.554 Test Loss: 1.687 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6242959499359131
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.651 Vali Acc: 0.514 Test Loss: 1.651 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7290115356445312
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.541 Test Loss: 1.693 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8268070220947266
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.527 Test Loss: 1.761 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7910020351409912
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.527 Test Loss: 1.770 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 534660
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7577574253082275
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.405 Vali Acc: 0.230 Test Loss: 1.405 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.8767738342285156
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.254 Vali Acc: 0.419 Test Loss: 1.254 Test Acc: 0.419
Validation loss decreased (-0.229716 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0582818984985352
Epoch: 3, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.8774960041046143
Epoch: 4, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2159883975982666
Epoch: 5, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.216 Vali Acc: 0.459 Test Loss: 1.216 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0501270294189453
Epoch: 6, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.213 Vali Acc: 0.541 Test Loss: 1.213 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 7 cost time: 0.9793851375579834
Epoch: 7, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.288 Vali Acc: 0.554 Test Loss: 1.288 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 8 cost time: 0.87908935546875
Epoch: 8, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.446 Vali Acc: 0.500 Test Loss: 1.446 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8574144840240479
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.549 Vali Acc: 0.486 Test Loss: 1.549 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.085928201675415
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.579 Vali Acc: 0.541 Test Loss: 1.579 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1381475925445557
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.670 Vali Acc: 0.541 Test Loss: 1.670 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9149613380432129
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.639 Vali Acc: 0.541 Test Loss: 1.639 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8666822910308838
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.644 Vali Acc: 0.595 Test Loss: 1.644 Test Acc: 0.595
Validation loss decreased (-0.554041 --> -0.594578).  Saving model ...
Epoch: 14 cost time: 0.8011815547943115
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.742 Vali Acc: 0.581 Test Loss: 1.742 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8340728282928467
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.763 Vali Acc: 0.568 Test Loss: 1.763 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8928992748260498
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.768 Vali Acc: 0.568 Test Loss: 1.768 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8055765628814697
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.792 Vali Acc: 0.568 Test Loss: 1.792 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7649500370025635
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.798 Vali Acc: 0.568 Test Loss: 1.798 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.809528112411499
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.802 Vali Acc: 0.568 Test Loss: 1.802 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9851016998291016
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.807 Vali Acc: 0.568 Test Loss: 1.807 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0546793937683105
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.554 Test Loss: 1.814 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9482343196868896
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.554 Test Loss: 1.837 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0991127490997314
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.851 Vali Acc: 0.541 Test Loss: 1.851 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 505220
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.093242883682251
Epoch: 1, Steps: 10 | Train Loss: 1.562 Vali Loss: 1.419 Vali Acc: 0.324 Test Loss: 1.419 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.4389429092407227
Epoch: 2, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.287 Vali Acc: 0.405 Test Loss: 1.287 Test Acc: 0.405
Validation loss decreased (-0.324310 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.4234592914581299
Epoch: 3, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.214 Vali Acc: 0.432 Test Loss: 1.214 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.2935893535614014
Epoch: 4, Steps: 10 | Train Loss: 0.734 Vali Loss: 1.166 Vali Acc: 0.473 Test Loss: 1.166 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.5292632579803467
Epoch: 5, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2985475063323975
Epoch: 6, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.237 Vali Acc: 0.473 Test Loss: 1.237 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4618537425994873
Epoch: 7, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.4491839408874512
Epoch: 8, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.306 Vali Acc: 0.514 Test Loss: 1.306 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513500).  Saving model ...
Epoch: 9 cost time: 1.3608615398406982
Epoch: 9, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.397 Vali Acc: 0.500 Test Loss: 1.397 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3008348941802979
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.411 Vali Acc: 0.514 Test Loss: 1.411 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.417910099029541
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.467 Vali Acc: 0.486 Test Loss: 1.467 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2159631252288818
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2422764301300049
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.599 Vali Acc: 0.514 Test Loss: 1.599 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.389134407043457
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.612 Vali Acc: 0.541 Test Loss: 1.612 Test Acc: 0.541
Validation loss decreased (-0.513500 --> -0.540524).  Saving model ...
Epoch: 15 cost time: 1.371225357055664
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.635 Vali Acc: 0.514 Test Loss: 1.635 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2823481559753418
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.670 Vali Acc: 0.514 Test Loss: 1.670 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3684256076812744
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.705 Vali Acc: 0.527 Test Loss: 1.705 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.400068759918213
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.712 Vali Acc: 0.514 Test Loss: 1.712 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4115684032440186
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.765 Vali Acc: 0.541 Test Loss: 1.765 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5835838317871094
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.773 Vali Acc: 0.541 Test Loss: 1.773 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.323660135269165
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.765 Vali Acc: 0.527 Test Loss: 1.765 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4714443683624268
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.779 Vali Acc: 0.541 Test Loss: 1.779 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1964538097381592
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.800 Vali Acc: 0.541 Test Loss: 1.800 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2393193244934082
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.802 Vali Acc: 0.541 Test Loss: 1.802 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 471940
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0421667098999023
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.386 Vali Acc: 0.351 Test Loss: 1.386 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 1.1747171878814697
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.304 Vali Acc: 0.378 Test Loss: 1.304 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.2528297901153564
Epoch: 3, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.237 Vali Acc: 0.446 Test Loss: 1.237 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.4170830249786377
Epoch: 4, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.2162671089172363
Epoch: 5, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.3135936260223389
Epoch: 6, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.355095624923706
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1660170555114746
Epoch: 8, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.177 Vali Acc: 0.608 Test Loss: 1.177 Test Acc: 0.608
Validation loss decreased (-0.527016 --> -0.608096).  Saving model ...
Epoch: 9 cost time: 1.277172327041626
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.215 Vali Acc: 0.554 Test Loss: 1.215 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.323836326599121
Epoch: 10, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.234 Vali Acc: 0.568 Test Loss: 1.234 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2916102409362793
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.303 Vali Acc: 0.581 Test Loss: 1.303 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4950804710388184
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.300 Vali Acc: 0.595 Test Loss: 1.300 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3732938766479492
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.372 Vali Acc: 0.568 Test Loss: 1.372 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.477402687072754
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.387 Vali Acc: 0.581 Test Loss: 1.387 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3002197742462158
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.431 Vali Acc: 0.595 Test Loss: 1.431 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2869374752044678
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.478 Vali Acc: 0.581 Test Loss: 1.478 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4235198497772217
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.501 Vali Acc: 0.581 Test Loss: 1.501 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2211966514587402
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.517 Vali Acc: 0.581 Test Loss: 1.517 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 459140
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9858498573303223
Epoch: 1, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.409 Vali Acc: 0.338 Test Loss: 1.409 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.2879133224487305
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.322 Vali Acc: 0.365 Test Loss: 1.322 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.259277582168579
Epoch: 3, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.277714490890503
Epoch: 4, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.189 Vali Acc: 0.459 Test Loss: 1.189 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.429877519607544
Epoch: 5, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.237342357635498
Epoch: 6, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.3728923797607422
Epoch: 7, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.155 Vali Acc: 0.486 Test Loss: 1.155 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2701196670532227
Epoch: 8, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.3340797424316406
Epoch: 9, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.298590898513794
Epoch: 10, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3356044292449951
Epoch: 11, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.352 Vali Acc: 0.514 Test Loss: 1.352 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2679939270019531
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3614387512207031
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.437 Vali Acc: 0.486 Test Loss: 1.437 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2229275703430176
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.539 Vali Acc: 0.500 Test Loss: 1.539 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3122341632843018
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.531 Vali Acc: 0.541 Test Loss: 1.531 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2793307304382324
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.568 Vali Acc: 0.554 Test Loss: 1.568 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3905413150787354
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.608 Vali Acc: 0.541 Test Loss: 1.608 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.320410966873169
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.636 Vali Acc: 0.514 Test Loss: 1.636 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 451460
model size : 4.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7779855728149414
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
Validation loss decreased (inf --> -0.472961).  Saving model ...
Epoch: 2 cost time: 1.8861818313598633
Epoch: 2, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.500 Vali Acc: 0.419 Test Loss: 1.500 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.914693832397461
Epoch: 3, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.642 Vali Acc: 0.432 Test Loss: 1.642 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.068934202194214
Epoch: 4, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.718 Vali Acc: 0.405 Test Loss: 1.718 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1862809658050537
Epoch: 5, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.849 Vali Acc: 0.446 Test Loss: 1.849 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0726025104522705
Epoch: 6, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.960 Vali Acc: 0.514 Test Loss: 1.960 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513494).  Saving model ...
Epoch: 7 cost time: 1.982003927230835
Epoch: 7, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.297 Vali Acc: 0.419 Test Loss: 3.297 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9943699836730957
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 2.322 Vali Acc: 0.527 Test Loss: 2.322 Test Acc: 0.527
Validation loss decreased (-0.513494 --> -0.527004).  Saving model ...
Epoch: 9 cost time: 1.9786863327026367
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.145 Vali Acc: 0.459 Test Loss: 3.145 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.038076639175415
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.592 Vali Acc: 0.527 Test Loss: 3.592 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.287430763244629
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.231 Vali Acc: 0.459 Test Loss: 3.231 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.53586745262146
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.687 Vali Acc: 0.541 Test Loss: 3.687 Test Acc: 0.541
Validation loss decreased (-0.527004 --> -0.540504).  Saving model ...
Epoch: 13 cost time: 2.2861135005950928
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.866 Vali Acc: 0.419 Test Loss: 3.866 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.457035779953003
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.030 Vali Acc: 0.459 Test Loss: 4.030 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2684826850891113
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.464 Vali Acc: 0.419 Test Loss: 4.464 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5154526233673096
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.656 Vali Acc: 0.446 Test Loss: 4.656 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2360916137695312
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.409 Vali Acc: 0.459 Test Loss: 4.409 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4302978515625
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.596 Vali Acc: 0.459 Test Loss: 4.596 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1774346828460693
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.195 Vali Acc: 0.473 Test Loss: 5.195 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.41145658493042
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.305 Vali Acc: 0.500 Test Loss: 5.305 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1465275287628174
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.950 Vali Acc: 0.514 Test Loss: 5.950 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4009339809417725
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.951 Vali Acc: 0.473 Test Loss: 5.951 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 709892
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9084718227386475
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.242 Vali Acc: 0.459 Test Loss: 1.242 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 1.8984129428863525
Epoch: 2, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.284 Vali Acc: 0.459 Test Loss: 1.284 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.12866473197937
Epoch: 3, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.6145930290222168
Epoch: 4, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.336 Vali Acc: 0.419 Test Loss: 1.336 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.937553882598877
Epoch: 5, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.660 Vali Acc: 0.473 Test Loss: 1.660 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7316629886627197
Epoch: 6, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.645 Vali Acc: 0.459 Test Loss: 1.645 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.035200595855713
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.883 Vali Acc: 0.500 Test Loss: 1.883 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.791163682937622
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.877 Vali Acc: 0.514 Test Loss: 1.877 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513495).  Saving model ...
Epoch: 9 cost time: 2.036515951156616
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.910 Vali Acc: 0.527 Test Loss: 1.910 Test Acc: 0.527
Validation loss decreased (-0.513495 --> -0.527008).  Saving model ...
Epoch: 10 cost time: 2.0215659141540527
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.974 Vali Acc: 0.541 Test Loss: 1.974 Test Acc: 0.541
Validation loss decreased (-0.527008 --> -0.540521).  Saving model ...
Epoch: 11 cost time: 2.0064034461975098
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.997 Vali Acc: 0.527 Test Loss: 1.997 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9800944328308105
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.027 Vali Acc: 0.514 Test Loss: 2.027 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7086906433105469
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.047 Vali Acc: 0.500 Test Loss: 2.047 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6450707912445068
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.091 Vali Acc: 0.500 Test Loss: 2.091 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5165441036224365
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.076 Vali Acc: 0.514 Test Loss: 2.076 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6884384155273438
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.076 Vali Acc: 0.500 Test Loss: 2.076 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5575554370880127
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.089 Vali Acc: 0.473 Test Loss: 2.089 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5788354873657227
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.082 Vali Acc: 0.500 Test Loss: 2.082 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.083137273788452
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.500 Test Loss: 2.088 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6478512287139893
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.500 Test Loss: 2.092 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 506372
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0909347534179688
Epoch: 1, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.298 Vali Acc: 0.365 Test Loss: 1.298 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 2.0352187156677246
Epoch: 2, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.194 Vali Acc: 0.405 Test Loss: 1.194 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.5373446941375732
Epoch: 3, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.491149663925171
Epoch: 4, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.251 Vali Acc: 0.527 Test Loss: 1.251 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.7574286460876465
Epoch: 5, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.330 Vali Acc: 0.473 Test Loss: 1.330 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3427989482879639
Epoch: 6, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.272 Vali Acc: 0.486 Test Loss: 1.272 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6934714317321777
Epoch: 7, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.415 Vali Acc: 0.500 Test Loss: 1.415 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8293697834014893
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.292 Vali Acc: 0.459 Test Loss: 1.292 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4953758716583252
Epoch: 9, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.389 Vali Acc: 0.541 Test Loss: 1.389 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 10 cost time: 1.9354324340820312
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.494 Vali Acc: 0.581 Test Loss: 1.494 Test Acc: 0.581
Validation loss decreased (-0.540527 --> -0.581066).  Saving model ...
Epoch: 11 cost time: 1.5101001262664795
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.620 Vali Acc: 0.581 Test Loss: 1.620 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.830136775970459
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.619 Vali Acc: 0.554 Test Loss: 1.619 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8960962295532227
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.667 Vali Acc: 0.568 Test Loss: 1.667 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5485243797302246
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.694 Vali Acc: 0.541 Test Loss: 1.694 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.97343111038208
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.700 Vali Acc: 0.541 Test Loss: 1.700 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4907124042510986
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.697 Vali Acc: 0.541 Test Loss: 1.697 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4166765213012695
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.703 Vali Acc: 0.541 Test Loss: 1.703 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4241364002227783
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.714 Vali Acc: 0.541 Test Loss: 1.714 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3271429538726807
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.554 Test Loss: 1.734 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4347312450408936
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.554 Test Loss: 1.739 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 435972
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.163728952407837
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.341 Vali Acc: 0.351 Test Loss: 1.341 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.111947774887085
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.225 Vali Acc: 0.473 Test Loss: 1.225 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 2.483135461807251
Epoch: 3, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 2.2470970153808594
Epoch: 4, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.298 Vali Acc: 0.405 Test Loss: 1.298 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.350740432739258
Epoch: 5, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.184 Vali Acc: 0.554 Test Loss: 1.184 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.376958131790161
Epoch: 6, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.301 Vali Acc: 0.554 Test Loss: 1.301 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.325136184692383
Epoch: 7, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.39054799079895
Epoch: 8, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.421 Vali Acc: 0.541 Test Loss: 1.421 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1312761306762695
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.467 Vali Acc: 0.554 Test Loss: 1.467 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.399766683578491
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.598 Vali Acc: 0.527 Test Loss: 1.598 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9001829624176025
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.636 Vali Acc: 0.554 Test Loss: 1.636 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4646315574645996
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.635 Vali Acc: 0.554 Test Loss: 1.635 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1738314628601074
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.678 Vali Acc: 0.568 Test Loss: 1.678 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567551).  Saving model ...
Epoch: 14 cost time: 2.203341484069824
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.713 Vali Acc: 0.568 Test Loss: 1.713 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.384282112121582
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.715 Vali Acc: 0.581 Test Loss: 1.715 Test Acc: 0.581
Validation loss decreased (-0.567551 --> -0.581064).  Saving model ...
Epoch: 16 cost time: 1.9010894298553467
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.708 Vali Acc: 0.568 Test Loss: 1.708 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3709611892700195
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.742 Vali Acc: 0.581 Test Loss: 1.742 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0177741050720215
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.778 Vali Acc: 0.568 Test Loss: 1.778 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.408723831176758
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.554 Test Loss: 1.799 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9023559093475342
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.815 Vali Acc: 0.568 Test Loss: 1.815 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.181678533554077
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.824 Vali Acc: 0.554 Test Loss: 1.824 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.230419158935547
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.837 Vali Acc: 0.581 Test Loss: 1.837 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.17250657081604
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.851 Vali Acc: 0.568 Test Loss: 1.851 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2823750972747803
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.856 Vali Acc: 0.554 Test Loss: 1.856 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.6584763526916504
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.877 Vali Acc: 0.568 Test Loss: 1.877 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 406532
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7601318359375
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.289 Vali Acc: 0.392 Test Loss: 1.289 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.510802745819092
Epoch: 2, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
Validation loss decreased (-0.391879 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 2.5916755199432373
Epoch: 3, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594584).  Saving model ...
Epoch: 4 cost time: 2.7585372924804688
Epoch: 4, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.064 Vali Acc: 0.527 Test Loss: 1.064 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7047336101531982
Epoch: 5, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.048 Vali Acc: 0.500 Test Loss: 1.048 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.827446460723877
Epoch: 6, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7210757732391357
Epoch: 7, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.131 Vali Acc: 0.568 Test Loss: 1.131 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.894106864929199
Epoch: 8, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.878249168395996
Epoch: 9, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6996631622314453
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.928915023803711
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9090192317962646
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.396 Vali Acc: 0.554 Test Loss: 1.396 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.609375476837158
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.467 Vali Acc: 0.554 Test Loss: 1.467 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 373252
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.129420042037964
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.382 Vali Acc: 0.284 Test Loss: 1.382 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.2315781116485596
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.301 Vali Acc: 0.432 Test Loss: 1.301 Test Acc: 0.432
Validation loss decreased (-0.283770 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 2.654280662536621
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.226 Vali Acc: 0.486 Test Loss: 1.226 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.441319465637207
Epoch: 4, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.222 Vali Acc: 0.459 Test Loss: 1.222 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5334057807922363
Epoch: 5, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 2.7802963256835938
Epoch: 6, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.713144063949585
Epoch: 7, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 2.461167097091675
Epoch: 8, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.340791940689087
Epoch: 9, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.103 Vali Acc: 0.581 Test Loss: 1.103 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3886258602142334
Epoch: 10, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.154 Vali Acc: 0.581 Test Loss: 1.154 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4319965839385986
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.207 Vali Acc: 0.568 Test Loss: 1.207 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4307661056518555
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5952558517456055
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.229 Vali Acc: 0.568 Test Loss: 1.229 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.219499349594116
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.293 Vali Acc: 0.581 Test Loss: 1.293 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4748265743255615
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.374 Vali Acc: 0.581 Test Loss: 1.374 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4555792808532715
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.366 Vali Acc: 0.595 Test Loss: 1.366 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594581).  Saving model ...
Epoch: 17 cost time: 2.4617114067077637
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.399 Vali Acc: 0.595 Test Loss: 1.399 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4070160388946533
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.413 Vali Acc: 0.608 Test Loss: 1.413 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608094).  Saving model ...
Epoch: 19 cost time: 2.3145925998687744
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.429 Vali Acc: 0.608 Test Loss: 1.429 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2596795558929443
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.448 Vali Acc: 0.581 Test Loss: 1.448 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.289219856262207
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.455 Vali Acc: 0.595 Test Loss: 1.455 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3215525150299072
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.454 Vali Acc: 0.595 Test Loss: 1.454 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2789134979248047
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.465 Vali Acc: 0.595 Test Loss: 1.465 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3653838634490967
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.464 Vali Acc: 0.595 Test Loss: 1.464 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.414055347442627
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.482 Vali Acc: 0.595 Test Loss: 1.482 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3513236045837402
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.501 Vali Acc: 0.595 Test Loss: 1.501 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.199575662612915
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.536 Vali Acc: 0.581 Test Loss: 1.536 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.1523303985595703
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.557 Vali Acc: 0.581 Test Loss: 1.557 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 360452
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.096428871154785
Epoch: 1, Steps: 10 | Train Loss: 1.582 Vali Loss: 1.358 Vali Acc: 0.351 Test Loss: 1.358 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.2699270248413086
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.280 Vali Acc: 0.459 Test Loss: 1.280 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 2.25353741645813
Epoch: 3, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 2.39152193069458
Epoch: 4, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.137 Vali Acc: 0.581 Test Loss: 1.137 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 2.168534517288208
Epoch: 5, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.348238706588745
Epoch: 6, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.071 Vali Acc: 0.595 Test Loss: 1.071 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 2.4581093788146973
Epoch: 7, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.392007350921631
Epoch: 8, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3526358604431152
Epoch: 9, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.141 Vali Acc: 0.554 Test Loss: 1.141 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1671555042266846
Epoch: 10, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.229 Vali Acc: 0.541 Test Loss: 1.229 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3472251892089844
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.263 Vali Acc: 0.541 Test Loss: 1.263 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2896125316619873
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.344 Vali Acc: 0.595 Test Loss: 1.344 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.237694263458252
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.444 Vali Acc: 0.554 Test Loss: 1.444 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1153197288513184
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.472 Vali Acc: 0.581 Test Loss: 1.472 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.288111686706543
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.510 Vali Acc: 0.581 Test Loss: 1.510 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.449012041091919
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.533 Vali Acc: 0.581 Test Loss: 1.533 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 352772
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.890995979309082
Epoch: 1, Steps: 10 | Train Loss: 1.589 Vali Loss: 1.482 Vali Acc: 0.284 Test Loss: 1.482 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 2.8799901008605957
Epoch: 2, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.315 Vali Acc: 0.459 Test Loss: 1.315 Test Acc: 0.459
Validation loss decreased (-0.283769 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 2.8905062675476074
Epoch: 3, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.510 Vali Acc: 0.486 Test Loss: 1.510 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486471).  Saving model ...
Epoch: 4 cost time: 2.960623264312744
Epoch: 4, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.626 Vali Acc: 0.446 Test Loss: 1.626 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0452678203582764
Epoch: 5, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.703 Vali Acc: 0.514 Test Loss: 1.703 Test Acc: 0.514
Validation loss decreased (-0.486471 --> -0.513496).  Saving model ...
Epoch: 6 cost time: 2.896613597869873
Epoch: 6, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.899 Vali Acc: 0.541 Test Loss: 1.899 Test Acc: 0.541
Validation loss decreased (-0.513496 --> -0.540522).  Saving model ...
Epoch: 7 cost time: 2.873922348022461
Epoch: 7, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.894 Vali Acc: 0.473 Test Loss: 1.894 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9793436527252197
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.338 Vali Acc: 0.500 Test Loss: 2.338 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8763720989227295
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.949 Vali Acc: 0.446 Test Loss: 3.949 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8270936012268066
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.027 Vali Acc: 0.486 Test Loss: 3.027 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.635427713394165
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.874 Vali Acc: 0.459 Test Loss: 3.874 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8182475566864014
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.497 Vali Acc: 0.568 Test Loss: 3.497 Test Acc: 0.568
Validation loss decreased (-0.540522 --> -0.567533).  Saving model ...
Epoch: 13 cost time: 2.748290538787842
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.687 Vali Acc: 0.541 Test Loss: 3.687 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6765544414520264
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.645 Vali Acc: 0.446 Test Loss: 3.645 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.578876256942749
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.967 Vali Acc: 0.541 Test Loss: 3.967 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7549166679382324
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.840 Vali Acc: 0.527 Test Loss: 4.840 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.877164840698242
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.873 Vali Acc: 0.486 Test Loss: 4.873 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.78423810005188
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.766 Vali Acc: 0.459 Test Loss: 4.766 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9043099880218506
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.296 Vali Acc: 0.514 Test Loss: 5.296 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8372278213500977
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.752 Vali Acc: 0.419 Test Loss: 4.752 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.073817253112793
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.423 Vali Acc: 0.486 Test Loss: 4.423 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8026978969573975
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 5.081 Vali Acc: 0.541 Test Loss: 5.081 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 660548
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.298773527145386
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.256 Vali Acc: 0.459 Test Loss: 1.256 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 2.6399006843566895
Epoch: 2, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 2.5314364433288574
Epoch: 3, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.460867166519165
Epoch: 4, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 2.5067331790924072
Epoch: 5, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8744146823883057
Epoch: 6, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6495790481567383
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.771 Vali Acc: 0.500 Test Loss: 1.771 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7615933418273926
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.668 Vali Acc: 0.500 Test Loss: 1.668 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.727818012237549
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.847 Vali Acc: 0.581 Test Loss: 1.847 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581063).  Saving model ...
Epoch: 10 cost time: 2.6439476013183594
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.874 Vali Acc: 0.568 Test Loss: 1.874 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7287418842315674
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.991 Vali Acc: 0.541 Test Loss: 1.991 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7941677570343018
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.130 Vali Acc: 0.500 Test Loss: 2.130 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.927086591720581
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.197 Vali Acc: 0.473 Test Loss: 2.197 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9169890880584717
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.118 Vali Acc: 0.514 Test Loss: 2.118 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8843657970428467
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.080 Vali Acc: 0.500 Test Loss: 2.080 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7195093631744385
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.091 Vali Acc: 0.514 Test Loss: 2.091 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3983707427978516
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.085 Vali Acc: 0.527 Test Loss: 2.085 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5732858180999756
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.527 Test Loss: 2.092 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3550403118133545
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.108 Vali Acc: 0.527 Test Loss: 2.108 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 457028
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.893751621246338
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.420 Vali Acc: 0.324 Test Loss: 1.420 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 2.6874282360076904
Epoch: 2, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.262 Vali Acc: 0.459 Test Loss: 1.262 Test Acc: 0.459
Validation loss decreased (-0.324310 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 2.9849984645843506
Epoch: 3, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 3.022472381591797
Epoch: 4, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.039954900741577
Epoch: 5, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8530685901641846
Epoch: 6, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.265 Vali Acc: 0.595 Test Loss: 1.265 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594582).  Saving model ...
Epoch: 7 cost time: 3.1313209533691406
Epoch: 7, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.221 Vali Acc: 0.581 Test Loss: 1.221 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.130345582962036
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.340 Vali Acc: 0.581 Test Loss: 1.340 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.704771041870117
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.532 Vali Acc: 0.581 Test Loss: 1.532 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0160694122314453
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.526 Vali Acc: 0.527 Test Loss: 1.526 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0412042140960693
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.522 Vali Acc: 0.554 Test Loss: 1.522 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.130650758743286
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.539 Vali Acc: 0.581 Test Loss: 1.539 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.771221876144409
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.570 Vali Acc: 0.568 Test Loss: 1.570 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.079604148864746
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.624 Vali Acc: 0.581 Test Loss: 1.624 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.898801803588867
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.643 Vali Acc: 0.581 Test Loss: 1.643 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0955193042755127
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.644 Vali Acc: 0.581 Test Loss: 1.644 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 386628
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.592226028442383
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.356 Vali Acc: 0.324 Test Loss: 1.356 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.684002161026001
Epoch: 2, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 2.4654598236083984
Epoch: 3, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 2.5826213359832764
Epoch: 4, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.177 Vali Acc: 0.405 Test Loss: 1.177 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8808183670043945
Epoch: 5, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.197 Vali Acc: 0.473 Test Loss: 1.197 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.6667399406433105
Epoch: 6, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.238 Vali Acc: 0.514 Test Loss: 1.238 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 2.8687212467193604
Epoch: 7, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.378 Vali Acc: 0.500 Test Loss: 1.378 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5829782485961914
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.362 Vali Acc: 0.473 Test Loss: 1.362 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9441213607788086
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.422 Vali Acc: 0.514 Test Loss: 1.422 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1222524642944336
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.566 Vali Acc: 0.541 Test Loss: 1.566 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540525).  Saving model ...
Epoch: 11 cost time: 2.5660862922668457
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.577 Vali Acc: 0.541 Test Loss: 1.577 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8853490352630615
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.563 Vali Acc: 0.554 Test Loss: 1.563 Test Acc: 0.554
Validation loss decreased (-0.540525 --> -0.554038).  Saving model ...
Epoch: 13 cost time: 2.424830913543701
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.603 Vali Acc: 0.527 Test Loss: 1.603 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1288702487945557
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.662 Vali Acc: 0.541 Test Loss: 1.662 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.983686923980713
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.650 Vali Acc: 0.527 Test Loss: 1.650 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8580851554870605
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.648 Vali Acc: 0.514 Test Loss: 1.648 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.094573974609375
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.675 Vali Acc: 0.514 Test Loss: 1.675 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.568772554397583
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.527 Test Loss: 1.684 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.342893600463867
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.527 Test Loss: 1.696 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6195449829101562
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.714 Vali Acc: 0.541 Test Loss: 1.714 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.541269302368164
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.727 Vali Acc: 0.527 Test Loss: 1.727 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3619706630706787
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.742 Vali Acc: 0.527 Test Loss: 1.742 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 357188
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7810089588165283
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.443 Vali Acc: 0.230 Test Loss: 1.443 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 2.2427000999450684
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.257 Vali Acc: 0.405 Test Loss: 1.257 Test Acc: 0.405
Validation loss decreased (-0.229715 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 2.53169584274292
Epoch: 3, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.389047861099243
Epoch: 4, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 2.565544366836548
Epoch: 5, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3178956508636475
Epoch: 6, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 2.606497049331665
Epoch: 7, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.152 Vali Acc: 0.568 Test Loss: 1.152 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6529643535614014
Epoch: 8, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.181 Vali Acc: 0.568 Test Loss: 1.181 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.405287504196167
Epoch: 9, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.311 Vali Acc: 0.554 Test Loss: 1.311 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.512319326400757
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.342 Vali Acc: 0.541 Test Loss: 1.342 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.866987943649292
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.455 Vali Acc: 0.541 Test Loss: 1.455 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5721263885498047
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.463 Vali Acc: 0.541 Test Loss: 1.463 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8203184604644775
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.511 Vali Acc: 0.541 Test Loss: 1.511 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5370352268218994
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.535 Vali Acc: 0.554 Test Loss: 1.535 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9436304569244385
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.566 Vali Acc: 0.554 Test Loss: 1.566 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.687425136566162
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.600 Vali Acc: 0.554 Test Loss: 1.600 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 323908
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.594290733337402
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.477 Vali Acc: 0.324 Test Loss: 1.477 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 2.2901833057403564
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.353 Vali Acc: 0.419 Test Loss: 1.353 Test Acc: 0.419
Validation loss decreased (-0.324310 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 2.3238625526428223
Epoch: 3, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
Validation loss decreased (-0.418905 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 2.0035712718963623
Epoch: 4, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.0991086959838867
Epoch: 5, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 2.42657732963562
Epoch: 6, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 2.1310126781463623
Epoch: 7, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 2.4789340496063232
Epoch: 8, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.441965103149414
Epoch: 9, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.152 Vali Acc: 0.568 Test Loss: 1.152 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6704323291778564
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5883092880249023
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.221665620803833
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.281 Vali Acc: 0.541 Test Loss: 1.281 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.560062885284424
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.274 Vali Acc: 0.568 Test Loss: 1.274 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6153080463409424
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.328 Vali Acc: 0.595 Test Loss: 1.328 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594581).  Saving model ...
Epoch: 15 cost time: 2.5952982902526855
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.403 Vali Acc: 0.581 Test Loss: 1.403 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.414358377456665
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.406 Vali Acc: 0.581 Test Loss: 1.406 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.259458541870117
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.434 Vali Acc: 0.568 Test Loss: 1.434 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.183419942855835
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.424 Vali Acc: 0.568 Test Loss: 1.424 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.215512275695801
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.434 Vali Acc: 0.554 Test Loss: 1.434 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2086727619171143
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.460 Vali Acc: 0.568 Test Loss: 1.460 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7054591178894043
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.476 Vali Acc: 0.568 Test Loss: 1.476 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5621535778045654
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.488 Vali Acc: 0.568 Test Loss: 1.488 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.6582086086273193
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.498 Vali Acc: 0.568 Test Loss: 1.498 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.462367296218872
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.514 Vali Acc: 0.568 Test Loss: 1.514 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 311108
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9246132373809814
Epoch: 1, Steps: 10 | Train Loss: 1.562 Vali Loss: 1.469 Vali Acc: 0.324 Test Loss: 1.469 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 2.1165525913238525
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.316 Vali Acc: 0.351 Test Loss: 1.316 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.3906216621398926
Epoch: 3, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.9839203357696533
Epoch: 4, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 2.66123366355896
Epoch: 5, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.170 Vali Acc: 0.459 Test Loss: 1.170 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2328224182128906
Epoch: 6, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.198 Vali Acc: 0.459 Test Loss: 1.198 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5102503299713135
Epoch: 7, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.4193379878997803
Epoch: 8, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 2.6607532501220703
Epoch: 9, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7172133922576904
Epoch: 10, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.335 Vali Acc: 0.486 Test Loss: 1.335 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2927584648132324
Epoch: 11, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.375 Vali Acc: 0.514 Test Loss: 1.375 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.664185047149658
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.426 Vali Acc: 0.486 Test Loss: 1.426 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.513787031173706
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.514 Vali Acc: 0.473 Test Loss: 1.514 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.751268148422241
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.592 Vali Acc: 0.514 Test Loss: 1.592 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6150407791137695
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.615 Vali Acc: 0.527 Test Loss: 1.615 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527011).  Saving model ...
Epoch: 16 cost time: 2.558957099914551
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.646 Vali Acc: 0.541 Test Loss: 1.646 Test Acc: 0.541
Validation loss decreased (-0.527011 --> -0.540524).  Saving model ...
Epoch: 17 cost time: 2.7779929637908936
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.634 Vali Acc: 0.541 Test Loss: 1.634 Test Acc: 0.541
Validation loss decreased (-0.540524 --> -0.540524).  Saving model ...
Epoch: 18 cost time: 2.7170767784118652
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.663 Vali Acc: 0.541 Test Loss: 1.663 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9171900749206543
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.714 Vali Acc: 0.514 Test Loss: 1.714 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5405006408691406
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.738 Vali Acc: 0.541 Test Loss: 1.738 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0009772777557373
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.747 Vali Acc: 0.541 Test Loss: 1.747 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.272374153137207
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.771 Vali Acc: 0.568 Test Loss: 1.771 Test Acc: 0.568
Validation loss decreased (-0.540524 --> -0.567550).  Saving model ...
Epoch: 23 cost time: 2.4591805934906006
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.792 Vali Acc: 0.595 Test Loss: 1.792 Test Acc: 0.595
Validation loss decreased (-0.567550 --> -0.594577).  Saving model ...
Epoch: 24 cost time: 2.7063941955566406
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.828 Vali Acc: 0.554 Test Loss: 1.828 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1130292415618896
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.855 Vali Acc: 0.554 Test Loss: 1.855 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5432040691375732
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.877 Vali Acc: 0.554 Test Loss: 1.877 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0802035331726074
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.887 Vali Acc: 0.541 Test Loss: 1.887 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.545504093170166
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.906 Vali Acc: 0.541 Test Loss: 1.906 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.302520990371704
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.931 Vali Acc: 0.541 Test Loss: 1.931 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7970211505889893
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.953 Vali Acc: 0.541 Test Loss: 1.953 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.573335886001587
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.953 Vali Acc: 0.541 Test Loss: 1.953 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.4361026287078857
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.951 Vali Acc: 0.527 Test Loss: 1.951 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.806900978088379
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.978 Vali Acc: 0.527 Test Loss: 1.978 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm128_nh16_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 303428
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.114385366439819
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.335 Vali Acc: 0.338 Test Loss: 1.335 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 3.240941047668457
Epoch: 2, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.231 Vali Acc: 0.527 Test Loss: 1.231 Test Acc: 0.527
Validation loss decreased (-0.337824 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 3.2863004207611084
Epoch: 3, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.303 Vali Acc: 0.473 Test Loss: 1.303 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3257319927215576
Epoch: 4, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.358 Vali Acc: 0.459 Test Loss: 1.358 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0007283687591553
Epoch: 5, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.315 Vali Acc: 0.514 Test Loss: 1.315 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.433509588241577
Epoch: 6, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.733 Vali Acc: 0.459 Test Loss: 1.733 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2618913650512695
Epoch: 7, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.190 Vali Acc: 0.486 Test Loss: 2.190 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.008833408355713
Epoch: 8, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.843 Vali Acc: 0.514 Test Loss: 1.843 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0248186588287354
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.140 Vali Acc: 0.473 Test Loss: 2.140 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.9854557514190674
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.111 Vali Acc: 0.527 Test Loss: 2.111 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.362889528274536
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.306 Vali Acc: 0.514 Test Loss: 2.306 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1438450813293457
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.394 Vali Acc: 0.432 Test Loss: 2.394 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 355524
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.714277029037476
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.289 Vali Acc: 0.392 Test Loss: 1.289 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.7807910442352295
Epoch: 2, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 2.656712293624878
Epoch: 3, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 2.491597890853882
Epoch: 4, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.112 Vali Acc: 0.473 Test Loss: 1.112 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.665548801422119
Epoch: 5, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.983612298965454
Epoch: 6, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8819332122802734
Epoch: 7, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8877861499786377
Epoch: 8, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.337 Vali Acc: 0.486 Test Loss: 1.337 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.075608015060425
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.444 Vali Acc: 0.554 Test Loss: 1.444 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554040).  Saving model ...
Epoch: 10 cost time: 2.986642599105835
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.493 Vali Acc: 0.514 Test Loss: 1.493 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9470787048339844
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.573 Vali Acc: 0.514 Test Loss: 1.573 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.834233522415161
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.704 Vali Acc: 0.541 Test Loss: 1.704 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1474485397338867
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.643 Vali Acc: 0.500 Test Loss: 1.643 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.910242795944214
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.656 Vali Acc: 0.514 Test Loss: 1.656 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.736212968826294
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.690 Vali Acc: 0.500 Test Loss: 1.690 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.868081569671631
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.702 Vali Acc: 0.500 Test Loss: 1.702 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0489578247070312
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.708 Vali Acc: 0.500 Test Loss: 1.708 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.883387327194214
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.500 Test Loss: 1.724 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.4506828784942627
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.744 Vali Acc: 0.486 Test Loss: 1.744 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 253764
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.247663497924805
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.364 Vali Acc: 0.324 Test Loss: 1.364 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.313474655151367
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.274 Vali Acc: 0.405 Test Loss: 1.274 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 2.130441665649414
Epoch: 3, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.5309717655181885
Epoch: 4, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 2.507957935333252
Epoch: 5, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5954654216766357
Epoch: 6, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 2.432997941970825
Epoch: 7, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.645108699798584
Epoch: 8, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6779098510742188
Epoch: 9, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.304 Vali Acc: 0.554 Test Loss: 1.304 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.676194429397583
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6634902954101562
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.365 Vali Acc: 0.541 Test Loss: 1.365 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.589801788330078
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.419 Vali Acc: 0.541 Test Loss: 1.419 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.442007303237915
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.462 Vali Acc: 0.541 Test Loss: 1.462 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3634583950042725
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.483 Vali Acc: 0.527 Test Loss: 1.483 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4993815422058105
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.526 Vali Acc: 0.554 Test Loss: 1.526 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.397629737854004
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.547 Vali Acc: 0.554 Test Loss: 1.547 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 218564
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.415558815002441
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.409 Vali Acc: 0.311 Test Loss: 1.409 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.391852617263794
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.369 Vali Acc: 0.338 Test Loss: 1.369 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.5360381603240967
Epoch: 3, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.214 Vali Acc: 0.432 Test Loss: 1.214 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 2.249607563018799
Epoch: 4, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 2.309340715408325
Epoch: 5, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 2.2677390575408936
Epoch: 6, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.135 Vali Acc: 0.486 Test Loss: 1.135 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6551263332366943
Epoch: 7, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.7771146297454834
Epoch: 8, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.213 Vali Acc: 0.459 Test Loss: 1.213 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7860469818115234
Epoch: 9, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 2.7679708003997803
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.60624098777771
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.284 Vali Acc: 0.514 Test Loss: 1.284 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6161980628967285
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.358 Vali Acc: 0.514 Test Loss: 1.358 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.511472463607788
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6396749019622803
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.403 Vali Acc: 0.554 Test Loss: 1.403 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554040).  Saving model ...
Epoch: 15 cost time: 2.755744695663452
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.433 Vali Acc: 0.568 Test Loss: 1.433 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567553).  Saving model ...
Epoch: 16 cost time: 2.5641398429870605
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.420 Vali Acc: 0.514 Test Loss: 1.420 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6390085220336914
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.443 Vali Acc: 0.514 Test Loss: 1.443 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7747554779052734
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5238611698150635
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.501 Vali Acc: 0.541 Test Loss: 1.501 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.7091071605682373
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.293700933456421
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5851850509643555
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.548 Vali Acc: 0.527 Test Loss: 1.548 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4522485733032227
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.551 Vali Acc: 0.527 Test Loss: 1.551 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.373897075653076
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.567 Vali Acc: 0.527 Test Loss: 1.567 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.420933485031128
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.567 Vali Acc: 0.554 Test Loss: 1.567 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 203844
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.236130475997925
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.390 Vali Acc: 0.257 Test Loss: 1.390 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.349277973175049
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.305 Vali Acc: 0.392 Test Loss: 1.305 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.2834525108337402
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.5846035480499268
Epoch: 4, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 2.4785103797912598
Epoch: 5, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 2.5110855102539062
Epoch: 6, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.430030345916748
Epoch: 7, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.150 Vali Acc: 0.554 Test Loss: 1.150 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 2.4504408836364746
Epoch: 8, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.694352865219116
Epoch: 9, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.212108850479126
Epoch: 10, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.206 Vali Acc: 0.581 Test Loss: 1.206 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 2.3819549083709717
Epoch: 11, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.232 Vali Acc: 0.568 Test Loss: 1.232 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.248903512954712
Epoch: 12, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.294 Vali Acc: 0.568 Test Loss: 1.294 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.507699728012085
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.313 Vali Acc: 0.568 Test Loss: 1.313 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.338961601257324
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.352 Vali Acc: 0.554 Test Loss: 1.352 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1460843086242676
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.452 Vali Acc: 0.568 Test Loss: 1.452 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.429323196411133
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.429 Vali Acc: 0.568 Test Loss: 1.429 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3877885341644287
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.457 Vali Acc: 0.568 Test Loss: 1.457 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3944735527038574
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.500 Vali Acc: 0.554 Test Loss: 1.500 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2052602767944336
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.505 Vali Acc: 0.568 Test Loss: 1.505 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.299877882003784
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.535 Vali Acc: 0.568 Test Loss: 1.535 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 187204
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.595100164413452
Epoch: 1, Steps: 10 | Train Loss: 1.563 Vali Loss: 1.380 Vali Acc: 0.257 Test Loss: 1.380 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.1263301372528076
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.312 Vali Acc: 0.338 Test Loss: 1.312 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.199472427368164
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.269 Vali Acc: 0.392 Test Loss: 1.269 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.212756633758545
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.224 Vali Acc: 0.432 Test Loss: 1.224 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.1522152423858643
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.166 Vali Acc: 0.432 Test Loss: 1.166 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432421).  Saving model ...
Epoch: 6 cost time: 1.2845370769500732
Epoch: 6, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.150 Vali Acc: 0.419 Test Loss: 1.150 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1486341953277588
Epoch: 7, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.169 Vali Acc: 0.446 Test Loss: 1.169 Test Acc: 0.446
Validation loss decreased (-0.432421 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 1.3766427040100098
Epoch: 8, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.141 Vali Acc: 0.459 Test Loss: 1.141 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 9 cost time: 1.3625164031982422
Epoch: 9, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.145 Vali Acc: 0.432 Test Loss: 1.145 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3353838920593262
Epoch: 10, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.147 Vali Acc: 0.459 Test Loss: 1.147 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3560259342193604
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.3425655364990234
Epoch: 12, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3400681018829346
Epoch: 13, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3139338493347168
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.270 Vali Acc: 0.527 Test Loss: 1.270 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 15 cost time: 1.195049524307251
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.269 Vali Acc: 0.541 Test Loss: 1.269 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540528).  Saving model ...
Epoch: 16 cost time: 1.252305269241333
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.312 Vali Acc: 0.486 Test Loss: 1.312 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2602803707122803
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.353 Vali Acc: 0.473 Test Loss: 1.353 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3026385307312012
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.349 Vali Acc: 0.514 Test Loss: 1.349 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3445346355438232
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.406 Vali Acc: 0.527 Test Loss: 1.406 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3080968856811523
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.413 Vali Acc: 0.514 Test Loss: 1.413 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2858827114105225
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.386 Vali Acc: 0.514 Test Loss: 1.386 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4021940231323242
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.447 Vali Acc: 0.514 Test Loss: 1.447 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.250810146331787
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.455 Vali Acc: 0.541 Test Loss: 1.455 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2978274822235107
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3312146663665771
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 180804
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.142514228820801
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.443 Vali Acc: 0.230 Test Loss: 1.443 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.3093781471252441
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (-0.229715 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.243272304534912
Epoch: 3, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.317 Vali Acc: 0.419 Test Loss: 1.317 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.233060598373413
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.281548023223877
Epoch: 5, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.2692348957061768
Epoch: 6, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.1794722080230713
Epoch: 7, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.256345272064209
Epoch: 8, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.172 Vali Acc: 0.541 Test Loss: 1.172 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.3650736808776855
Epoch: 9, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2218055725097656
Epoch: 10, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.239372730255127
Epoch: 11, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3824784755706787
Epoch: 12, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3556993007659912
Epoch: 13, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.242 Vali Acc: 0.541 Test Loss: 1.242 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2529168128967285
Epoch: 14, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.280 Vali Acc: 0.527 Test Loss: 1.280 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2250986099243164
Epoch: 15, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3608169555664062
Epoch: 16, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2326345443725586
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.408 Vali Acc: 0.473 Test Loss: 1.408 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2755744457244873
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.439 Vali Acc: 0.541 Test Loss: 1.439 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 176964
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.453659772872925
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 2.460649013519287
Epoch: 2, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.228 Vali Acc: 0.514 Test Loss: 1.228 Test Acc: 0.514
Validation loss decreased (-0.297284 --> -0.513501).  Saving model ...
Epoch: 3 cost time: 2.439668893814087
Epoch: 3, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.386 Vali Acc: 0.486 Test Loss: 1.386 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5667994022369385
Epoch: 4, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.783 Vali Acc: 0.419 Test Loss: 1.783 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6659250259399414
Epoch: 5, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.353 Vali Acc: 0.486 Test Loss: 1.353 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5206470489501953
Epoch: 6, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.563 Vali Acc: 0.405 Test Loss: 1.563 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6661322116851807
Epoch: 7, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.572 Vali Acc: 0.473 Test Loss: 1.572 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9592416286468506
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.858 Vali Acc: 0.541 Test Loss: 1.858 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540522).  Saving model ...
Epoch: 9 cost time: 3.1762776374816895
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.944 Vali Acc: 0.500 Test Loss: 1.944 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8300535678863525
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.040 Vali Acc: 0.541 Test Loss: 2.040 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2726409435272217
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.091 Vali Acc: 0.527 Test Loss: 2.091 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.792867660522461
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.157 Vali Acc: 0.500 Test Loss: 2.157 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.032285213470459
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.207 Vali Acc: 0.514 Test Loss: 2.207 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.74822735786438
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.207 Vali Acc: 0.527 Test Loss: 2.207 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.9974215030670166
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.180 Vali Acc: 0.514 Test Loss: 2.180 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7932088375091553
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.169 Vali Acc: 0.486 Test Loss: 2.169 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.568772077560425
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.181 Vali Acc: 0.486 Test Loss: 2.181 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7465147972106934
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.189 Vali Acc: 0.500 Test Loss: 2.189 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 305988
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.721816539764404
Epoch: 1, Steps: 10 | Train Loss: 1.577 Vali Loss: 1.315 Vali Acc: 0.392 Test Loss: 1.315 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.9099340438842773
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 3.074962854385376
Epoch: 3, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 3.0207815170288086
Epoch: 4, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1822452545166016
Epoch: 5, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.235 Vali Acc: 0.446 Test Loss: 1.235 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.200100898742676
Epoch: 6, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.319 Vali Acc: 0.541 Test Loss: 1.319 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540527).  Saving model ...
Epoch: 7 cost time: 3.25404953956604
Epoch: 7, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.314 Vali Acc: 0.473 Test Loss: 1.314 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.291354179382324
Epoch: 8, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.400 Vali Acc: 0.541 Test Loss: 1.400 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.188920736312866
Epoch: 9, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.459 Vali Acc: 0.541 Test Loss: 1.459 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3378281593322754
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.524 Vali Acc: 0.486 Test Loss: 1.524 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0307679176330566
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.529 Vali Acc: 0.527 Test Loss: 1.529 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.28962779045105
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.632 Vali Acc: 0.554 Test Loss: 1.632 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554038).  Saving model ...
Epoch: 13 cost time: 2.9303853511810303
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.639 Vali Acc: 0.514 Test Loss: 1.639 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.709623336791992
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.647 Vali Acc: 0.541 Test Loss: 1.647 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5646185874938965
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.683 Vali Acc: 0.527 Test Loss: 1.683 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3367831707000732
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.670 Vali Acc: 0.527 Test Loss: 1.670 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.364649772644043
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.675 Vali Acc: 0.527 Test Loss: 1.675 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6923129558563232
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.701 Vali Acc: 0.527 Test Loss: 1.701 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.623335599899292
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.712 Vali Acc: 0.541 Test Loss: 1.712 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9038326740264893
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.527 Test Loss: 1.724 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.640244722366333
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.742 Vali Acc: 0.541 Test Loss: 1.742 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.747986078262329
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.756 Vali Acc: 0.514 Test Loss: 1.756 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 204228
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.57183051109314
Epoch: 1, Steps: 10 | Train Loss: 1.576 Vali Loss: 1.477 Vali Acc: 0.176 Test Loss: 1.477 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 2.9024088382720947
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.355 Vali Acc: 0.324 Test Loss: 1.355 Test Acc: 0.324
Validation loss decreased (-0.175661 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 2.4453418254852295
Epoch: 3, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.268 Vali Acc: 0.432 Test Loss: 1.268 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 3.0118680000305176
Epoch: 4, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.6372392177581787
Epoch: 5, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.210 Vali Acc: 0.446 Test Loss: 1.210 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.833890199661255
Epoch: 6, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.8407912254333496
Epoch: 7, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.8052122592926025
Epoch: 8, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.216 Vali Acc: 0.527 Test Loss: 1.216 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 3.0407063961029053
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 2.6955466270446777
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.298 Vali Acc: 0.541 Test Loss: 1.298 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0840156078338623
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.356 Vali Acc: 0.527 Test Loss: 1.356 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7854502201080322
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.356 Vali Acc: 0.527 Test Loss: 1.356 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.74869704246521
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.437 Vali Acc: 0.514 Test Loss: 1.437 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4705004692077637
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.510 Vali Acc: 0.486 Test Loss: 1.510 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3881237506866455
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.504 Vali Acc: 0.514 Test Loss: 1.504 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5022194385528564
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.510 Vali Acc: 0.486 Test Loss: 1.510 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4686901569366455
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.528 Vali Acc: 0.514 Test Loss: 1.528 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4733552932739258
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5761728286743164
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 169028
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.262802839279175
Epoch: 1, Steps: 10 | Train Loss: 1.540 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.8782713413238525
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.374 Vali Acc: 0.338 Test Loss: 1.374 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.7514617443084717
Epoch: 3, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 2.6911849975585938
Epoch: 4, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.199 Vali Acc: 0.459 Test Loss: 1.199 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.8602991104125977
Epoch: 5, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.181 Vali Acc: 0.459 Test Loss: 1.181 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 2.7205798625946045
Epoch: 6, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.134 Vali Acc: 0.554 Test Loss: 1.134 Test Acc: 0.554
Validation loss decreased (-0.459448 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 2.868586540222168
Epoch: 7, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.187 Vali Acc: 0.459 Test Loss: 1.187 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8548531532287598
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8456482887268066
Epoch: 9, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9900012016296387
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.210 Vali Acc: 0.514 Test Loss: 1.210 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4856369495391846
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.346 Vali Acc: 0.541 Test Loss: 1.346 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9360814094543457
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.309 Vali Acc: 0.554 Test Loss: 1.309 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7805142402648926
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.384 Vali Acc: 0.568 Test Loss: 1.384 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567554).  Saving model ...
Epoch: 14 cost time: 2.640468120574951
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.408 Vali Acc: 0.581 Test Loss: 1.408 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 15 cost time: 2.984724521636963
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.425 Vali Acc: 0.554 Test Loss: 1.425 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.72831130027771
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.408 Vali Acc: 0.568 Test Loss: 1.408 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9162683486938477
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.432 Vali Acc: 0.581 Test Loss: 1.432 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8400282859802246
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.477 Vali Acc: 0.595 Test Loss: 1.477 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594580).  Saving model ...
Epoch: 19 cost time: 2.7326931953430176
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.513 Vali Acc: 0.581 Test Loss: 1.513 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.82509183883667
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.520 Vali Acc: 0.581 Test Loss: 1.520 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.612431526184082
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.528 Vali Acc: 0.568 Test Loss: 1.528 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.984340190887451
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.547 Vali Acc: 0.568 Test Loss: 1.547 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.508928060531616
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.560 Vali Acc: 0.568 Test Loss: 1.560 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3285810947418213
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.571 Vali Acc: 0.568 Test Loss: 1.571 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1136677265167236
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.587 Vali Acc: 0.581 Test Loss: 1.587 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.463212251663208
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.600 Vali Acc: 0.581 Test Loss: 1.600 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.480985403060913
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.621 Vali Acc: 0.568 Test Loss: 1.621 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.70048189163208
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.568 Test Loss: 1.631 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 154308
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.155154466629028
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.516 Vali Acc: 0.189 Test Loss: 1.516 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 2.9041073322296143
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.354 Vali Acc: 0.351 Test Loss: 1.354 Test Acc: 0.351
Validation loss decreased (-0.189174 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.9282758235931396
Epoch: 3, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.247 Vali Acc: 0.392 Test Loss: 1.247 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.636413812637329
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.196 Vali Acc: 0.486 Test Loss: 1.196 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 2.892282009124756
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.7277700901031494
Epoch: 6, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.110 Vali Acc: 0.473 Test Loss: 1.110 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7008707523345947
Epoch: 7, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.69950008392334
Epoch: 8, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.083 Vali Acc: 0.527 Test Loss: 1.083 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 2.415097713470459
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 2.497235059738159
Epoch: 10, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 2.6076388359069824
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.092 Vali Acc: 0.595 Test Loss: 1.092 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 2.472507953643799
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.178 Vali Acc: 0.581 Test Loss: 1.178 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.066941261291504
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.200 Vali Acc: 0.568 Test Loss: 1.200 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6421542167663574
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3742599487304688
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.278 Vali Acc: 0.568 Test Loss: 1.278 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.243279218673706
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.338 Vali Acc: 0.554 Test Loss: 1.338 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.313917875289917
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.411 Vali Acc: 0.541 Test Loss: 1.411 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.14373779296875
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.418 Vali Acc: 0.568 Test Loss: 1.418 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9499797821044922
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.438 Vali Acc: 0.568 Test Loss: 1.438 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0756328105926514
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.441 Vali Acc: 0.568 Test Loss: 1.441 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0730509757995605
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.448 Vali Acc: 0.581 Test Loss: 1.448 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 137668
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2777538299560547
Epoch: 1, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.374 Vali Acc: 0.324 Test Loss: 1.374 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.3694450855255127
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.337 Vali Acc: 0.324 Test Loss: 1.337 Test Acc: 0.324
Validation loss decreased (-0.324311 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.3053064346313477
Epoch: 3, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.266 Vali Acc: 0.405 Test Loss: 1.266 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.3293828964233398
Epoch: 4, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.223 Vali Acc: 0.419 Test Loss: 1.223 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 1.3582513332366943
Epoch: 5, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
Validation loss decreased (-0.418907 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.3984220027923584
Epoch: 6, Steps: 10 | Train Loss: 0.811 Vali Loss: 1.172 Vali Acc: 0.473 Test Loss: 1.172 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3003380298614502
Epoch: 7, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.338416337966919
Epoch: 8, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.181 Vali Acc: 0.527 Test Loss: 1.181 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.2850184440612793
Epoch: 9, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.3032240867614746
Epoch: 10, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.373298168182373
Epoch: 11, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3830907344818115
Epoch: 12, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.211 Vali Acc: 0.541 Test Loss: 1.211 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1960272789001465
Epoch: 13, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 14 cost time: 1.3285982608795166
Epoch: 14, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3326563835144043
Epoch: 15, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.310 Vali Acc: 0.554 Test Loss: 1.310 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2093117237091064
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.383 Vali Acc: 0.568 Test Loss: 1.383 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567554).  Saving model ...
Epoch: 17 cost time: 1.2925212383270264
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.397 Vali Acc: 0.554 Test Loss: 1.397 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2583088874816895
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.416 Vali Acc: 0.554 Test Loss: 1.416 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3636894226074219
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.465 Vali Acc: 0.527 Test Loss: 1.465 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2823519706726074
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.493 Vali Acc: 0.541 Test Loss: 1.493 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.35323166847229
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.309330940246582
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2519760131835938
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.600 Vali Acc: 0.527 Test Loss: 1.600 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.273219108581543
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.615 Vali Acc: 0.514 Test Loss: 1.615 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2167820930480957
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.639 Vali Acc: 0.541 Test Loss: 1.639 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.243971824645996
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.673 Vali Acc: 0.527 Test Loss: 1.673 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 131268
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1553401947021484
Epoch: 1, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.338 Vali Acc: 0.419 Test Loss: 1.338 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.334686517715454
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.302 Vali Acc: 0.432 Test Loss: 1.302 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.3647863864898682
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.252 Vali Acc: 0.514 Test Loss: 1.252 Test Acc: 0.514
Validation loss decreased (-0.432419 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.2990691661834717
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.3655426502227783
Epoch: 5, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3735160827636719
Epoch: 6, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3479032516479492
Epoch: 7, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.3664276599884033
Epoch: 8, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.3055963516235352
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.3576741218566895
Epoch: 10, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3463222980499268
Epoch: 11, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3539979457855225
Epoch: 12, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.163 Vali Acc: 0.581 Test Loss: 1.163 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2929658889770508
Epoch: 13, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2881391048431396
Epoch: 14, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2221593856811523
Epoch: 15, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.202 Vali Acc: 0.581 Test Loss: 1.202 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2857201099395752
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2016892433166504
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.300 Vali Acc: 0.527 Test Loss: 1.300 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3197393417358398
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.275763750076294
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.341 Vali Acc: 0.568 Test Loss: 1.341 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 127428
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.097129821777344
Epoch: 1, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 3.4728903770446777
Epoch: 2, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.266 Vali Acc: 0.432 Test Loss: 1.266 Test Acc: 0.432
Validation loss decreased (-0.297283 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 3.3388376235961914
Epoch: 3, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.454 Vali Acc: 0.432 Test Loss: 1.454 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.608891248703003
Epoch: 4, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 3.4777867794036865
Epoch: 5, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.285 Vali Acc: 0.527 Test Loss: 1.285 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4335408210754395
Epoch: 6, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.414 Vali Acc: 0.541 Test Loss: 1.414 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.535705327987671
Epoch: 7, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.803 Vali Acc: 0.500 Test Loss: 1.803 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.771458387374878
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.737 Vali Acc: 0.527 Test Loss: 1.737 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5179738998413086
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.785 Vali Acc: 0.446 Test Loss: 1.785 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5559165477752686
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.299 Vali Acc: 0.486 Test Loss: 2.299 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5403621196746826
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.036 Vali Acc: 0.514 Test Loss: 2.036 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.7110776901245117
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.144 Vali Acc: 0.541 Test Loss: 2.144 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.562746047973633
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.070 Vali Acc: 0.514 Test Loss: 2.070 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1185295581817627
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.078 Vali Acc: 0.473 Test Loss: 2.078 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 281220
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.250311613082886
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.365 Vali Acc: 0.324 Test Loss: 1.365 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.7359025478363037
Epoch: 2, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.295 Vali Acc: 0.459 Test Loss: 1.295 Test Acc: 0.459
Validation loss decreased (-0.324311 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 2.657482624053955
Epoch: 3, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 2.6305596828460693
Epoch: 4, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.533418655395508
Epoch: 5, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.272 Vali Acc: 0.446 Test Loss: 1.272 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.599538803100586
Epoch: 6, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.191 Vali Acc: 0.554 Test Loss: 1.191 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 2.6848626136779785
Epoch: 7, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.827810764312744
Epoch: 8, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.300 Vali Acc: 0.527 Test Loss: 1.300 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.568455934524536
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.397 Vali Acc: 0.541 Test Loss: 1.397 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6492183208465576
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.405 Vali Acc: 0.514 Test Loss: 1.405 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.624655246734619
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.514 Vali Acc: 0.514 Test Loss: 1.514 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6972811222076416
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7483692169189453
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.567 Vali Acc: 0.514 Test Loss: 1.567 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5609958171844482
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.599 Vali Acc: 0.514 Test Loss: 1.599 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.760908603668213
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.629 Vali Acc: 0.514 Test Loss: 1.629 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9131581783294678
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.659 Vali Acc: 0.527 Test Loss: 1.659 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 179460
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.168342590332031
Epoch: 1, Steps: 10 | Train Loss: 1.517 Vali Loss: 1.351 Vali Acc: 0.324 Test Loss: 1.351 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.3074777126312256
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.294 Vali Acc: 0.405 Test Loss: 1.294 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 2.212156295776367
Epoch: 3, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.189 Vali Acc: 0.486 Test Loss: 1.189 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.404714584350586
Epoch: 4, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.207282304763794
Epoch: 5, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 2.6593546867370605
Epoch: 6, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 3.18595290184021
Epoch: 7, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 2.8856968879699707
Epoch: 8, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.235 Vali Acc: 0.541 Test Loss: 1.235 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.138965129852295
Epoch: 9, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.292 Vali Acc: 0.541 Test Loss: 1.292 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9249656200408936
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.217 Vali Acc: 0.541 Test Loss: 1.217 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0911664962768555
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.451 Vali Acc: 0.541 Test Loss: 1.451 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5429129600524902
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5823681354522705
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.103876829147339
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.519 Vali Acc: 0.554 Test Loss: 1.519 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554039).  Saving model ...
Epoch: 15 cost time: 2.120403289794922
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.481 Vali Acc: 0.527 Test Loss: 1.481 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9204802513122559
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.486 Vali Acc: 0.541 Test Loss: 1.486 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.274322986602783
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.528 Vali Acc: 0.568 Test Loss: 1.528 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567552).  Saving model ...
Epoch: 18 cost time: 2.317289113998413
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.548 Vali Acc: 0.541 Test Loss: 1.548 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5832631587982178
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.546 Vali Acc: 0.527 Test Loss: 1.546 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4018471240997314
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.576 Vali Acc: 0.581 Test Loss: 1.576 Test Acc: 0.581
Validation loss decreased (-0.567552 --> -0.581065).  Saving model ...
Epoch: 21 cost time: 2.7977147102355957
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.580 Vali Acc: 0.554 Test Loss: 1.580 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6836142539978027
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.599 Vali Acc: 0.541 Test Loss: 1.599 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.675699234008789
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.604 Vali Acc: 0.541 Test Loss: 1.604 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.474119186401367
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.617 Vali Acc: 0.541 Test Loss: 1.617 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.603890895843506
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.617 Vali Acc: 0.568 Test Loss: 1.617 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4626028537750244
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.642 Vali Acc: 0.554 Test Loss: 1.642 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.636218547821045
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.652 Vali Acc: 0.541 Test Loss: 1.652 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5851612091064453
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.670 Vali Acc: 0.554 Test Loss: 1.670 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.456254482269287
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.680 Vali Acc: 0.554 Test Loss: 1.680 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.4405035972595215
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.690 Vali Acc: 0.541 Test Loss: 1.690 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 144260
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.237695217132568
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.472 Vali Acc: 0.230 Test Loss: 1.472 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 2.3982529640197754
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.308 Vali Acc: 0.405 Test Loss: 1.308 Test Acc: 0.405
Validation loss decreased (-0.229715 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 2.232651472091675
Epoch: 3, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 2.5506155490875244
Epoch: 4, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 2.0512335300445557
Epoch: 5, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.9760973453521729
Epoch: 6, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.8532671928405762
Epoch: 7, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.116 Vali Acc: 0.554 Test Loss: 1.116 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 2.033688545227051
Epoch: 8, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7763681411743164
Epoch: 9, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.196 Vali Acc: 0.541 Test Loss: 1.196 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2107596397399902
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.386298894882202
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.270 Vali Acc: 0.554 Test Loss: 1.270 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6496853828430176
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.314 Vali Acc: 0.554 Test Loss: 1.314 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3479652404785156
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2281816005706787
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.397 Vali Acc: 0.554 Test Loss: 1.397 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.49056077003479
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.444 Vali Acc: 0.541 Test Loss: 1.444 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5581512451171875
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.469 Vali Acc: 0.554 Test Loss: 1.469 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.201568603515625
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 129540
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.35515832901001
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.397 Vali Acc: 0.297 Test Loss: 1.397 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.340709924697876
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.349 Vali Acc: 0.338 Test Loss: 1.349 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.9381942749023438
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.269 Vali Acc: 0.419 Test Loss: 1.269 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 2.1700096130371094
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.2140607833862305
Epoch: 5, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.183 Vali Acc: 0.459 Test Loss: 1.183 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 2.025724411010742
Epoch: 6, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 2.329802989959717
Epoch: 7, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 2.1196770668029785
Epoch: 8, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7566924095153809
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1617560386657715
Epoch: 10, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3894670009613037
Epoch: 11, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.872180461883545
Epoch: 12, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.392289876937866
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.281 Vali Acc: 0.527 Test Loss: 1.281 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.41424560546875
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.343 Vali Acc: 0.527 Test Loss: 1.343 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4587562084198
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.387 Vali Acc: 0.554 Test Loss: 1.387 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554040).  Saving model ...
Epoch: 16 cost time: 2.774611234664917
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.412 Vali Acc: 0.541 Test Loss: 1.412 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.615271806716919
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.419 Vali Acc: 0.541 Test Loss: 1.419 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.572627305984497
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.436 Vali Acc: 0.554 Test Loss: 1.436 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.581162691116333
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.468 Vali Acc: 0.541 Test Loss: 1.468 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2190160751342773
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.477 Vali Acc: 0.554 Test Loss: 1.477 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1211299896240234
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.498 Vali Acc: 0.541 Test Loss: 1.498 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.306476593017578
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.521 Vali Acc: 0.541 Test Loss: 1.521 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4773688316345215
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.546 Vali Acc: 0.541 Test Loss: 1.546 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3718109130859375
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.556 Vali Acc: 0.541 Test Loss: 1.556 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5896341800689697
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.576 Vali Acc: 0.541 Test Loss: 1.576 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 112900
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.035810708999634
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.488 Vali Acc: 0.311 Test Loss: 1.488 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.2983148097991943
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.375 Vali Acc: 0.365 Test Loss: 1.375 Test Acc: 0.365
Validation loss decreased (-0.310796 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.3854963779449463
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.279 Vali Acc: 0.459 Test Loss: 1.279 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.146240234375
Epoch: 4, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.3679802417755127
Epoch: 5, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.339076280593872
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.176 Vali Acc: 0.486 Test Loss: 1.176 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4355275630950928
Epoch: 7, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.172717809677124
Epoch: 8, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3542814254760742
Epoch: 9, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.138 Vali Acc: 0.554 Test Loss: 1.138 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.2716364860534668
Epoch: 10, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3324851989746094
Epoch: 11, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.162 Vali Acc: 0.554 Test Loss: 1.162 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2277441024780273
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.193 Vali Acc: 0.554 Test Loss: 1.193 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4470546245574951
Epoch: 13, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.168 Vali Acc: 0.595 Test Loss: 1.168 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 1.2681267261505127
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.228 Vali Acc: 0.608 Test Loss: 1.228 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 15 cost time: 1.3504791259765625
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.325 Vali Acc: 0.554 Test Loss: 1.325 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.398834228515625
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.267 Vali Acc: 0.608 Test Loss: 1.267 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3568756580352783
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.290 Vali Acc: 0.622 Test Loss: 1.290 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621609).  Saving model ...
Epoch: 18 cost time: 1.275420904159546
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.331 Vali Acc: 0.608 Test Loss: 1.331 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3500580787658691
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.362 Vali Acc: 0.595 Test Loss: 1.362 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3076837062835693
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.383 Vali Acc: 0.608 Test Loss: 1.383 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4487078189849854
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.436 Vali Acc: 0.581 Test Loss: 1.436 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.383409023284912
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.447 Vali Acc: 0.568 Test Loss: 1.447 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2165758609771729
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.453 Vali Acc: 0.581 Test Loss: 1.453 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.278632402420044
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.468 Vali Acc: 0.581 Test Loss: 1.468 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4511568546295166
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.482 Vali Acc: 0.595 Test Loss: 1.482 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3764336109161377
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.518 Vali Acc: 0.595 Test Loss: 1.518 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2046396732330322
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.527 Vali Acc: 0.595 Test Loss: 1.527 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 106500
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0586447715759277
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.500 Vali Acc: 0.216 Test Loss: 1.500 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 1.3650164604187012
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.417 Vali Acc: 0.284 Test Loss: 1.417 Test Acc: 0.284
Validation loss decreased (-0.216201 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.1749420166015625
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.342 Vali Acc: 0.351 Test Loss: 1.342 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.3392589092254639
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.278 Vali Acc: 0.419 Test Loss: 1.278 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.3543214797973633
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.249 Vali Acc: 0.405 Test Loss: 1.249 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3059747219085693
Epoch: 6, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.229 Vali Acc: 0.419 Test Loss: 1.229 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 7 cost time: 1.2136809825897217
Epoch: 7, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.197 Vali Acc: 0.432 Test Loss: 1.197 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 1.3135275840759277
Epoch: 8, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.186 Vali Acc: 0.446 Test Loss: 1.186 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.0480232238769531
Epoch: 9, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.183 Vali Acc: 0.446 Test Loss: 1.183 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 1.2656452655792236
Epoch: 10, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.193 Vali Acc: 0.432 Test Loss: 1.193 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1930489540100098
Epoch: 11, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.225 Vali Acc: 0.419 Test Loss: 1.225 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.382413387298584
Epoch: 12, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 13 cost time: 1.290001392364502
Epoch: 13, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.247 Vali Acc: 0.459 Test Loss: 1.247 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3456873893737793
Epoch: 14, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.306 Vali Acc: 0.459 Test Loss: 1.306 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.294126272201538
Epoch: 15, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.334 Vali Acc: 0.459 Test Loss: 1.334 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.326906681060791
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.337 Vali Acc: 0.514 Test Loss: 1.337 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513500).  Saving model ...
Epoch: 17 cost time: 1.4277942180633545
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.374 Vali Acc: 0.486 Test Loss: 1.374 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.241870641708374
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.423 Vali Acc: 0.486 Test Loss: 1.423 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4938528537750244
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.479 Vali Acc: 0.500 Test Loss: 1.479 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.390291452407837
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.491 Vali Acc: 0.527 Test Loss: 1.491 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527012).  Saving model ...
Epoch: 21 cost time: 1.3184938430786133
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3362526893615723
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3717658519744873
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.557 Vali Acc: 0.486 Test Loss: 1.557 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.233781337738037
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.598 Vali Acc: 0.486 Test Loss: 1.598 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3804473876953125
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.612 Vali Acc: 0.486 Test Loss: 1.612 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.401984691619873
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.618 Vali Acc: 0.500 Test Loss: 1.618 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2921068668365479
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.645 Vali Acc: 0.514 Test Loss: 1.645 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3768353462219238
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.658 Vali Acc: 0.514 Test Loss: 1.658 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3679242134094238
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.665 Vali Acc: 0.500 Test Loss: 1.665 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3398094177246094
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.692 Vali Acc: 0.500 Test Loss: 1.692 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm64_nh16_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 102660
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.265164852142334
Epoch: 1, Steps: 10 | Train Loss: 1.575 Vali Loss: 1.327 Vali Acc: 0.365 Test Loss: 1.327 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.5821967124938965
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.259 Vali Acc: 0.392 Test Loss: 1.259 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.417875051498413
Epoch: 3, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
Validation loss decreased (-0.391879 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.4617297649383545
Epoch: 4, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4141201972961426
Epoch: 5, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.257 Vali Acc: 0.446 Test Loss: 1.257 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5251479148864746
Epoch: 6, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.304 Vali Acc: 0.473 Test Loss: 1.304 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.454878330230713
Epoch: 7, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.343 Vali Acc: 0.514 Test Loss: 1.343 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5638179779052734
Epoch: 8, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.344 Vali Acc: 0.486 Test Loss: 1.344 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.325892448425293
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.528 Vali Acc: 0.486 Test Loss: 1.528 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5933730602264404
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.593 Vali Acc: 0.459 Test Loss: 1.593 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6314024925231934
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.588 Vali Acc: 0.419 Test Loss: 1.588 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.304272174835205
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.638 Vali Acc: 0.527 Test Loss: 1.638 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527011).  Saving model ...
Epoch: 13 cost time: 1.4136192798614502
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.795 Vali Acc: 0.486 Test Loss: 1.795 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5812056064605713
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.760 Vali Acc: 0.459 Test Loss: 1.760 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3388307094573975
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.776 Vali Acc: 0.459 Test Loss: 1.776 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3478336334228516
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.459 Test Loss: 1.795 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4746553897857666
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.814 Vali Acc: 0.459 Test Loss: 1.814 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4177601337432861
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.813 Vali Acc: 0.459 Test Loss: 1.813 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6145825386047363
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.817 Vali Acc: 0.473 Test Loss: 1.817 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.64591383934021
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.825 Vali Acc: 0.473 Test Loss: 1.825 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6256749629974365
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.473 Test Loss: 1.841 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7292535305023193
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.845 Vali Acc: 0.486 Test Loss: 1.845 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 165860
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.02178168296814
Epoch: 1, Steps: 10 | Train Loss: 1.582 Vali Loss: 1.360 Vali Acc: 0.230 Test Loss: 1.360 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.826568841934204
Epoch: 2, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.349 Vali Acc: 0.311 Test Loss: 1.349 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.3645577430725098
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.224 Vali Acc: 0.446 Test Loss: 1.224 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 2.0091567039489746
Epoch: 4, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.225 Vali Acc: 0.459 Test Loss: 1.225 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.939502477645874
Epoch: 5, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.208 Vali Acc: 0.432 Test Loss: 1.208 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.829974889755249
Epoch: 6, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.198 Vali Acc: 0.459 Test Loss: 1.198 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.5598933696746826
Epoch: 7, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.206 Vali Acc: 0.486 Test Loss: 1.206 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.5857760906219482
Epoch: 8, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8688957691192627
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7238805294036865
Epoch: 10, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.279 Vali Acc: 0.486 Test Loss: 1.279 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4427070617675781
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.295 Vali Acc: 0.514 Test Loss: 1.295 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 12 cost time: 1.703986406326294
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.431 Vali Acc: 0.446 Test Loss: 1.431 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.794921875
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.484 Vali Acc: 0.514 Test Loss: 1.484 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.92417311668396
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.473 Vali Acc: 0.473 Test Loss: 1.473 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9134516716003418
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.477 Vali Acc: 0.514 Test Loss: 1.477 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8909003734588623
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.534 Vali Acc: 0.459 Test Loss: 1.534 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9129283428192139
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.567 Vali Acc: 0.486 Test Loss: 1.567 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.830918312072754
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.577 Vali Acc: 0.473 Test Loss: 1.577 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.981400489807129
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.609 Vali Acc: 0.486 Test Loss: 1.609 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9397518634796143
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.630 Vali Acc: 0.486 Test Loss: 1.630 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0702242851257324
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.639 Vali Acc: 0.486 Test Loss: 1.639 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 114980
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.641998291015625
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.364 Vali Acc: 0.338 Test Loss: 1.364 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.5339462757110596
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.7371182441711426
Epoch: 3, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.405392 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.8496508598327637
Epoch: 4, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.170 Vali Acc: 0.541 Test Loss: 1.170 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 2.041494131088257
Epoch: 5, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.189 Vali Acc: 0.473 Test Loss: 1.189 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8905389308929443
Epoch: 6, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7214455604553223
Epoch: 7, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.9668776988983154
Epoch: 8, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.787412405014038
Epoch: 9, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.932227611541748
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.135 Vali Acc: 0.554 Test Loss: 1.135 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.012831449508667
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8459043502807617
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9808707237243652
Epoch: 13, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 14 cost time: 1.8663420677185059
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.277 Vali Acc: 0.581 Test Loss: 1.277 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9866745471954346
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.379 Vali Acc: 0.541 Test Loss: 1.379 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.094230890274048
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.347 Vali Acc: 0.527 Test Loss: 1.347 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.901129961013794
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.374 Vali Acc: 0.527 Test Loss: 1.374 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.002716302871704
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.410 Vali Acc: 0.541 Test Loss: 1.410 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.09881591796875
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.409 Vali Acc: 0.554 Test Loss: 1.409 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7988216876983643
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.436 Vali Acc: 0.554 Test Loss: 1.436 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.034243106842041
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.477 Vali Acc: 0.541 Test Loss: 1.477 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7802884578704834
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.498 Vali Acc: 0.554 Test Loss: 1.498 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.94813871383667
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.515 Vali Acc: 0.554 Test Loss: 1.515 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 97380
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.886995792388916
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.489 Vali Acc: 0.257 Test Loss: 1.489 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.1077497005462646
Epoch: 2, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.414 Vali Acc: 0.297 Test Loss: 1.414 Test Acc: 0.297
Validation loss decreased (-0.256742 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 1.0449903011322021
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.327 Vali Acc: 0.392 Test Loss: 1.327 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.101672887802124
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.1626536846160889
Epoch: 5, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.248 Vali Acc: 0.514 Test Loss: 1.248 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.157466173171997
Epoch: 6, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1176180839538574
Epoch: 7, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0225930213928223
Epoch: 8, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.1020407676696777
Epoch: 9, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0303678512573242
Epoch: 10, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0585784912109375
Epoch: 11, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0714504718780518
Epoch: 12, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9933147430419922
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0865178108215332
Epoch: 14, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0095477104187012
Epoch: 15, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9829647541046143
Epoch: 16, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.263 Vali Acc: 0.527 Test Loss: 1.263 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1660940647125244
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.308 Vali Acc: 0.541 Test Loss: 1.308 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1350736618041992
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.329 Vali Acc: 0.527 Test Loss: 1.329 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 90020
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9421331882476807
Epoch: 1, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.488 Vali Acc: 0.284 Test Loss: 1.488 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.1748762130737305
Epoch: 2, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.415 Vali Acc: 0.338 Test Loss: 1.415 Test Acc: 0.338
Validation loss decreased (-0.283769 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.072070837020874
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.362 Vali Acc: 0.365 Test Loss: 1.362 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.3194479942321777
Epoch: 4, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.306 Vali Acc: 0.405 Test Loss: 1.306 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.1440839767456055
Epoch: 5, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.231 Vali Acc: 0.527 Test Loss: 1.231 Test Acc: 0.527
Validation loss decreased (-0.405392 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.1063706874847412
Epoch: 6, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.0357987880706787
Epoch: 7, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0758919715881348
Epoch: 8, Steps: 10 | Train Loss: 0.763 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.084580421447754
Epoch: 9, Steps: 10 | Train Loss: 0.638 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.026646375656128
Epoch: 10, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.132 Vali Acc: 0.568 Test Loss: 1.132 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1872766017913818
Epoch: 11, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.126 Vali Acc: 0.581 Test Loss: 1.126 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2174201011657715
Epoch: 12, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.140 Vali Acc: 0.581 Test Loss: 1.140 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1126127243041992
Epoch: 13, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.142 Vali Acc: 0.554 Test Loss: 1.142 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1479671001434326
Epoch: 14, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.155 Vali Acc: 0.568 Test Loss: 1.155 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1157352924346924
Epoch: 15, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.141 Vali Acc: 0.568 Test Loss: 1.141 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1238601207733154
Epoch: 16, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9973371028900146
Epoch: 17, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.187 Vali Acc: 0.568 Test Loss: 1.187 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1240723133087158
Epoch: 18, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2315287590026855
Epoch: 19, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 81700
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2870092391967773
Epoch: 1, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.491 Vali Acc: 0.135 Test Loss: 1.491 Test Acc: 0.135
Validation loss decreased (inf --> -0.135120).  Saving model ...
Epoch: 2 cost time: 1.1924819946289062
Epoch: 2, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.449 Vali Acc: 0.176 Test Loss: 1.449 Test Acc: 0.176
Validation loss decreased (-0.135120 --> -0.175661).  Saving model ...
Epoch: 3 cost time: 1.1690332889556885
Epoch: 3, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (-0.175661 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 1.161741018295288
Epoch: 4, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.337 Vali Acc: 0.338 Test Loss: 1.337 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 1.1327757835388184
Epoch: 5, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.280 Vali Acc: 0.432 Test Loss: 1.280 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.1027097702026367
Epoch: 6, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.2172303199768066
Epoch: 7, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.221 Vali Acc: 0.432 Test Loss: 1.221 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2472991943359375
Epoch: 8, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.199 Vali Acc: 0.432 Test Loss: 1.199 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0906245708465576
Epoch: 9, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.271862268447876
Epoch: 10, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 1.12919020652771
Epoch: 11, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.1308233737945557
Epoch: 12, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 1.168872356414795
Epoch: 13, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.175177812576294
Epoch: 14, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.181 Vali Acc: 0.446 Test Loss: 1.181 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1137773990631104
Epoch: 15, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.202 Vali Acc: 0.446 Test Loss: 1.202 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1523628234863281
Epoch: 16, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1114871501922607
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2386200428009033
Epoch: 18, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2815425395965576
Epoch: 19, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2061867713928223
Epoch: 20, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.235 Vali Acc: 0.514 Test Loss: 1.235 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.247950553894043
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.238 Vali Acc: 0.514 Test Loss: 1.238 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1746785640716553
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.305 Vali Acc: 0.514 Test Loss: 1.305 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 78500
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9763197898864746
Epoch: 1, Steps: 10 | Train Loss: 1.541 Vali Loss: 1.408 Vali Acc: 0.230 Test Loss: 1.408 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.2366046905517578
Epoch: 2, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.374 Vali Acc: 0.297 Test Loss: 1.374 Test Acc: 0.297
Validation loss decreased (-0.229716 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.0779783725738525
Epoch: 3, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.329 Vali Acc: 0.338 Test Loss: 1.329 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 1.1433334350585938
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.288 Vali Acc: 0.378 Test Loss: 1.288 Test Acc: 0.378
Validation loss decreased (-0.337825 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.2065250873565674
Epoch: 5, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.250 Vali Acc: 0.419 Test Loss: 1.250 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.1979482173919678
Epoch: 6, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.220 Vali Acc: 0.473 Test Loss: 1.220 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.0389230251312256
Epoch: 7, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.1278152465820312
Epoch: 8, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.169 Vali Acc: 0.486 Test Loss: 1.169 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1058320999145508
Epoch: 9, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.166069507598877
Epoch: 10, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2328271865844727
Epoch: 11, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.146 Vali Acc: 0.473 Test Loss: 1.146 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2347073554992676
Epoch: 12, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2635116577148438
Epoch: 13, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.165 Vali Acc: 0.473 Test Loss: 1.165 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2510628700256348
Epoch: 14, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.177 Vali Acc: 0.459 Test Loss: 1.177 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2184937000274658
Epoch: 15, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.1558184623718262
Epoch: 16, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 1.1363716125488281
Epoch: 17, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.216 Vali Acc: 0.541 Test Loss: 1.216 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2045464515686035
Epoch: 18, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.252 Vali Acc: 0.541 Test Loss: 1.252 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1368324756622314
Epoch: 19, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.274 Vali Acc: 0.514 Test Loss: 1.274 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.233285903930664
Epoch: 20, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.314 Vali Acc: 0.527 Test Loss: 1.314 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0504701137542725
Epoch: 21, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.345 Vali Acc: 0.514 Test Loss: 1.345 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1990387439727783
Epoch: 22, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2742857933044434
Epoch: 23, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.423 Vali Acc: 0.541 Test Loss: 1.423 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2336411476135254
Epoch: 24, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2381093502044678
Epoch: 25, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.496 Vali Acc: 0.527 Test Loss: 1.496 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.294355869293213
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.518 Vali Acc: 0.514 Test Loss: 1.518 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 76580
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3884758949279785
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.397 Vali Acc: 0.351 Test Loss: 1.397 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 1.6207926273345947
Epoch: 2, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.351337 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.730881690979004
Epoch: 3, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.7350239753723145
Epoch: 4, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.258 Vali Acc: 0.419 Test Loss: 1.258 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6862924098968506
Epoch: 5, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.6933660507202148
Epoch: 6, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.253 Vali Acc: 0.473 Test Loss: 1.253 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.672118902206421
Epoch: 7, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.306 Vali Acc: 0.554 Test Loss: 1.306 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554041).  Saving model ...
Epoch: 8 cost time: 1.6739287376403809
Epoch: 8, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.536 Vali Acc: 0.527 Test Loss: 1.536 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7671163082122803
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.523 Vali Acc: 0.486 Test Loss: 1.523 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.516528606414795
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.622 Vali Acc: 0.486 Test Loss: 1.622 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6501588821411133
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.631 Vali Acc: 0.446 Test Loss: 1.631 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8064978122711182
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.693 Vali Acc: 0.486 Test Loss: 1.693 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7458245754241943
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.702 Vali Acc: 0.514 Test Loss: 1.702 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.77213716506958
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.702 Vali Acc: 0.486 Test Loss: 1.702 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5794928073883057
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.746 Vali Acc: 0.459 Test Loss: 1.746 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7484095096588135
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.459 Test Loss: 1.748 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.781480073928833
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.764 Vali Acc: 0.473 Test Loss: 1.764 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 140900
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.290653705596924
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.425 Vali Acc: 0.297 Test Loss: 1.425 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.283257484436035
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.440 Vali Acc: 0.324 Test Loss: 1.440 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 2.565385103225708
Epoch: 3, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.249 Vali Acc: 0.392 Test Loss: 1.249 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.273545265197754
Epoch: 4, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.282 Vali Acc: 0.486 Test Loss: 1.282 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 2.566150665283203
Epoch: 5, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 2.411823034286499
Epoch: 6, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5148329734802246
Epoch: 7, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2478115558624268
Epoch: 8, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 2.5420353412628174
Epoch: 9, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.366788625717163
Epoch: 10, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.548044204711914
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6736631393432617
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.358 Vali Acc: 0.527 Test Loss: 1.358 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5608572959899902
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.469 Vali Acc: 0.527 Test Loss: 1.469 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.248223304748535
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.471 Vali Acc: 0.541 Test Loss: 1.471 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540526).  Saving model ...
Epoch: 15 cost time: 2.3659706115722656
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3265140056610107
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.557 Vali Acc: 0.554 Test Loss: 1.557 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554038).  Saving model ...
Epoch: 17 cost time: 2.347569465637207
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.603 Vali Acc: 0.568 Test Loss: 1.603 Test Acc: 0.568
Validation loss decreased (-0.554038 --> -0.567552).  Saving model ...
Epoch: 18 cost time: 2.392831325531006
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.592 Vali Acc: 0.541 Test Loss: 1.592 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4287266731262207
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.588 Vali Acc: 0.527 Test Loss: 1.588 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.420060157775879
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.604 Vali Acc: 0.527 Test Loss: 1.604 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5267691612243652
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.620 Vali Acc: 0.527 Test Loss: 1.620 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5434725284576416
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.644 Vali Acc: 0.554 Test Loss: 1.644 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3959641456604004
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.648 Vali Acc: 0.527 Test Loss: 1.648 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.429567337036133
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.664 Vali Acc: 0.568 Test Loss: 1.664 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1463444232940674
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.554 Test Loss: 1.682 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.071798324584961
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.701 Vali Acc: 0.541 Test Loss: 1.701 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9753358364105225
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.718 Vali Acc: 0.554 Test Loss: 1.718 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 90020
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.072444438934326
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.351 Vali Acc: 0.432 Test Loss: 1.351 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 2.2215046882629395
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.291 Vali Acc: 0.405 Test Loss: 1.291 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.08587646484375
Epoch: 3, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.247 Vali Acc: 0.473 Test Loss: 1.247 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 2.1578333377838135
Epoch: 4, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.204918384552002
Epoch: 5, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 2.197295665740967
Epoch: 6, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.961014986038208
Epoch: 7, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.9876937866210938
Epoch: 8, Steps: 10 | Train Loss: 0.497 Vali Loss: 1.086 Vali Acc: 0.554 Test Loss: 1.086 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 2.047733783721924
Epoch: 9, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9802546501159668
Epoch: 10, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.024160861968994
Epoch: 11, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.149914503097534
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1778972148895264
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2535011768341064
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.312 Vali Acc: 0.568 Test Loss: 1.312 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567554).  Saving model ...
Epoch: 15 cost time: 2.0953688621520996
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.347 Vali Acc: 0.581 Test Loss: 1.347 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581068).  Saving model ...
Epoch: 16 cost time: 2.248354196548462
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.293 Vali Acc: 0.568 Test Loss: 1.293 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1095497608184814
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.315 Vali Acc: 0.568 Test Loss: 1.315 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9818634986877441
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.353 Vali Acc: 0.568 Test Loss: 1.353 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9934735298156738
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.349 Vali Acc: 0.581 Test Loss: 1.349 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0050110816955566
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.367 Vali Acc: 0.608 Test Loss: 1.367 Test Acc: 0.608
Validation loss decreased (-0.581068 --> -0.608094).  Saving model ...
Epoch: 21 cost time: 1.9831371307373047
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.403 Vali Acc: 0.581 Test Loss: 1.403 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.008028984069824
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.437 Vali Acc: 0.568 Test Loss: 1.437 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0762810707092285
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.428 Vali Acc: 0.581 Test Loss: 1.428 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8851981163024902
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.432 Vali Acc: 0.568 Test Loss: 1.432 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.139712333679199
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.456 Vali Acc: 0.568 Test Loss: 1.456 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.05710768699646
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.479 Vali Acc: 0.568 Test Loss: 1.479 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1934075355529785
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.476 Vali Acc: 0.595 Test Loss: 1.476 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9958529472351074
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.486 Vali Acc: 0.595 Test Loss: 1.486 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1152584552764893
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.507 Vali Acc: 0.581 Test Loss: 1.507 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8872292041778564
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.524 Vali Acc: 0.581 Test Loss: 1.524 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 72420
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.070969581604004
Epoch: 1, Steps: 10 | Train Loss: 1.519 Vali Loss: 1.444 Vali Acc: 0.297 Test Loss: 1.444 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.170060634613037
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.361 Vali Acc: 0.297 Test Loss: 1.361 Test Acc: 0.297
Validation loss decreased (-0.297283 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.1989309787750244
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.293 Vali Acc: 0.419 Test Loss: 1.293 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.2568190097808838
Epoch: 4, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.235 Vali Acc: 0.514 Test Loss: 1.235 Test Acc: 0.514
Validation loss decreased (-0.418906 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.2518506050109863
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.222 Vali Acc: 0.446 Test Loss: 1.222 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1697006225585938
Epoch: 6, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.281834363937378
Epoch: 7, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.196711778640747
Epoch: 8, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.2253661155700684
Epoch: 9, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.1564664840698242
Epoch: 10, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.3504791259765625
Epoch: 11, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.1809189319610596
Epoch: 12, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1009893417358398
Epoch: 13, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2224345207214355
Epoch: 14, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.146 Vali Acc: 0.568 Test Loss: 1.146 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 1.1191651821136475
Epoch: 15, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.171 Vali Acc: 0.568 Test Loss: 1.171 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2868244647979736
Epoch: 16, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2117798328399658
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.240 Vali Acc: 0.568 Test Loss: 1.240 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2982895374298096
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.251831293106079
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.295 Vali Acc: 0.541 Test Loss: 1.295 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.190181016921997
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.331 Vali Acc: 0.527 Test Loss: 1.331 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.168919563293457
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.337 Vali Acc: 0.554 Test Loss: 1.337 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.172403335571289
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.328 Vali Acc: 0.554 Test Loss: 1.328 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1270561218261719
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.355 Vali Acc: 0.541 Test Loss: 1.355 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2275168895721436
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.364 Vali Acc: 0.568 Test Loss: 1.364 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 65060
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.70023775100708
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.297 Vali Acc: 0.405 Test Loss: 1.297 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.193847894668579
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.284 Vali Acc: 0.419 Test Loss: 1.284 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.2293334007263184
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.261 Vali Acc: 0.378 Test Loss: 1.261 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.174790382385254
Epoch: 4, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.140244483947754
Epoch: 5, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
Validation loss decreased (-0.445934 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 1.0660417079925537
Epoch: 6, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1667931079864502
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2301607131958008
Epoch: 8, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0907189846038818
Epoch: 9, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.128690242767334
Epoch: 10, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.2003710269927979
Epoch: 11, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.1845440864562988
Epoch: 12, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.126 Vali Acc: 0.581 Test Loss: 1.126 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.1830871105194092
Epoch: 13, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2355031967163086
Epoch: 14, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.186 Vali Acc: 0.554 Test Loss: 1.186 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2426445484161377
Epoch: 15, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1482124328613281
Epoch: 16, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.198 Vali Acc: 0.595 Test Loss: 1.198 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 17 cost time: 1.2674500942230225
Epoch: 17, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.205 Vali Acc: 0.581 Test Loss: 1.205 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.121321201324463
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.210 Vali Acc: 0.568 Test Loss: 1.210 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1587331295013428
Epoch: 19, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.258 Vali Acc: 0.554 Test Loss: 1.258 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.100956678390503
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.289 Vali Acc: 0.554 Test Loss: 1.289 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.022343635559082
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2075042724609375
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.319 Vali Acc: 0.581 Test Loss: 1.319 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1257781982421875
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.332 Vali Acc: 0.554 Test Loss: 1.332 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1515681743621826
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1465561389923096
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0513379573822021
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.347 Vali Acc: 0.541 Test Loss: 1.347 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 56740
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.071073055267334
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.402 Vali Acc: 0.297 Test Loss: 1.402 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.202388048171997
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.374 Vali Acc: 0.338 Test Loss: 1.374 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.2250497341156006
Epoch: 3, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.353 Vali Acc: 0.365 Test Loss: 1.353 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.1423923969268799
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.2252593040466309
Epoch: 5, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.291 Vali Acc: 0.432 Test Loss: 1.291 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.1688988208770752
Epoch: 6, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.2129473686218262
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1624641418457031
Epoch: 8, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.2520689964294434
Epoch: 9, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.1078319549560547
Epoch: 10, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2431278228759766
Epoch: 11, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1721222400665283
Epoch: 12, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.1715128421783447
Epoch: 13, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1238152980804443
Epoch: 14, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 1.0623371601104736
Epoch: 15, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.20269775390625
Epoch: 16, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1630241870880127
Epoch: 17, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.171 Vali Acc: 0.527 Test Loss: 1.171 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.257434368133545
Epoch: 18, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2000463008880615
Epoch: 19, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.219719648361206
Epoch: 20, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1824588775634766
Epoch: 21, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.243 Vali Acc: 0.527 Test Loss: 1.243 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.240457534790039
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.226 Vali Acc: 0.486 Test Loss: 1.226 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1640162467956543
Epoch: 23, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.252 Vali Acc: 0.514 Test Loss: 1.252 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0688161849975586
Epoch: 24, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.280 Vali Acc: 0.514 Test Loss: 1.280 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 53540
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8985867500305176
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.402 Vali Acc: 0.311 Test Loss: 1.402 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.1449322700500488
Epoch: 2, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.380 Vali Acc: 0.338 Test Loss: 1.380 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.207137107849121
Epoch: 3, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.353 Vali Acc: 0.324 Test Loss: 1.353 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.233905553817749
Epoch: 4, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.318 Vali Acc: 0.378 Test Loss: 1.318 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.1937367916107178
Epoch: 5, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.283 Vali Acc: 0.392 Test Loss: 1.283 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.1263973712921143
Epoch: 6, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.240 Vali Acc: 0.419 Test Loss: 1.240 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418907).  Saving model ...
Epoch: 7 cost time: 1.202714204788208
Epoch: 7, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.208 Vali Acc: 0.405 Test Loss: 1.208 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1755049228668213
Epoch: 8, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.184 Vali Acc: 0.446 Test Loss: 1.184 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.2111308574676514
Epoch: 9, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.169 Vali Acc: 0.446 Test Loss: 1.169 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 1.1077189445495605
Epoch: 10, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.154 Vali Acc: 0.473 Test Loss: 1.154 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 1.1009199619293213
Epoch: 11, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.154 Vali Acc: 0.419 Test Loss: 1.154 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1855099201202393
Epoch: 12, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.141 Vali Acc: 0.446 Test Loss: 1.141 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2035138607025146
Epoch: 13, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.135 Vali Acc: 0.446 Test Loss: 1.135 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2273335456848145
Epoch: 14, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.147 Vali Acc: 0.446 Test Loss: 1.147 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1323864459991455
Epoch: 15, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.156 Vali Acc: 0.459 Test Loss: 1.156 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0437383651733398
Epoch: 16, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.160 Vali Acc: 0.459 Test Loss: 1.160 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1910758018493652
Epoch: 17, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.0183658599853516
Epoch: 18, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1369295120239258
Epoch: 19, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.192 Vali Acc: 0.459 Test Loss: 1.192 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0758824348449707
Epoch: 20, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.056119680404663
Epoch: 21, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.131112813949585
Epoch: 22, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.211 Vali Acc: 0.514 Test Loss: 1.211 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 23 cost time: 0.9809818267822266
Epoch: 23, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.247 Vali Acc: 0.473 Test Loss: 1.247 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.204319953918457
Epoch: 24, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.277 Vali Acc: 0.514 Test Loss: 1.277 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1456305980682373
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.292 Vali Acc: 0.486 Test Loss: 1.292 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.189380407333374
Epoch: 26, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 27 cost time: 1.0957627296447754
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.331 Vali Acc: 0.500 Test Loss: 1.331 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9962372779846191
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.374 Vali Acc: 0.500 Test Loss: 1.374 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1401641368865967
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.397 Vali Acc: 0.500 Test Loss: 1.397 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1490652561187744
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.051877498626709
Epoch: 31, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.406 Vali Acc: 0.500 Test Loss: 1.406 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0291593074798584
Epoch: 32, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.418 Vali Acc: 0.514 Test Loss: 1.418 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1727185249328613
Epoch: 33, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.082843542098999
Epoch: 34, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.481 Vali Acc: 0.514 Test Loss: 1.481 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1552975177764893
Epoch: 35, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.504 Vali Acc: 0.486 Test Loss: 1.504 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1075832843780518
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.515 Vali Acc: 0.486 Test Loss: 1.515 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 51620
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.790437936782837
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.564 Vali Acc: 0.162 Test Loss: 1.564 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 2.2292912006378174
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.344 Vali Acc: 0.378 Test Loss: 1.344 Test Acc: 0.378
Validation loss decreased (-0.162147 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 2.222938299179077
Epoch: 3, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.373 Vali Acc: 0.378 Test Loss: 1.373 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2406163215637207
Epoch: 4, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.252 Vali Acc: 0.459 Test Loss: 1.252 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.2732114791870117
Epoch: 5, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.559 Vali Acc: 0.419 Test Loss: 1.559 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1732099056243896
Epoch: 6, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.240 Vali Acc: 0.473 Test Loss: 1.240 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 2.3237946033477783
Epoch: 7, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.333 Vali Acc: 0.473 Test Loss: 1.333 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3155782222747803
Epoch: 8, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.514 Vali Acc: 0.527 Test Loss: 1.514 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527012).  Saving model ...
Epoch: 9 cost time: 2.3582327365875244
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.549 Vali Acc: 0.473 Test Loss: 1.549 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.289909601211548
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.557 Vali Acc: 0.527 Test Loss: 1.557 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5104405879974365
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.765 Vali Acc: 0.459 Test Loss: 1.765 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.291097402572632
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.658 Vali Acc: 0.459 Test Loss: 1.658 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3271191120147705
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.794 Vali Acc: 0.500 Test Loss: 1.794 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.194549798965454
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.754 Vali Acc: 0.473 Test Loss: 1.754 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.243999719619751
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.748 Vali Acc: 0.459 Test Loss: 1.748 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3009085655212402
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.805 Vali Acc: 0.459 Test Loss: 1.805 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2277040481567383
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.844 Vali Acc: 0.459 Test Loss: 1.844 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0297794342041016
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.473 Test Loss: 1.846 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 128420
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6128666400909424
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.368 Vali Acc: 0.351 Test Loss: 1.368 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.8488502502441406
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.292 Vali Acc: 0.378 Test Loss: 1.292 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.8440735340118408
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
Validation loss decreased (-0.378365 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 2.0183298587799072
Epoch: 4, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.996079444885254
Epoch: 5, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.153 Vali Acc: 0.459 Test Loss: 1.153 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0525307655334473
Epoch: 6, Steps: 10 | Train Loss: 0.627 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.8788731098175049
Epoch: 7, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.181 Vali Acc: 0.473 Test Loss: 1.181 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.030484199523926
Epoch: 8, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.827815055847168
Epoch: 9, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.967682123184204
Epoch: 10, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9935529232025146
Epoch: 11, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.359 Vali Acc: 0.473 Test Loss: 1.359 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0021941661834717
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.332 Vali Acc: 0.514 Test Loss: 1.332 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.044189929962158
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.385 Vali Acc: 0.459 Test Loss: 1.385 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.092557191848755
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.382 Vali Acc: 0.514 Test Loss: 1.382 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9502067565917969
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.430 Vali Acc: 0.486 Test Loss: 1.430 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.945321798324585
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.510 Vali Acc: 0.486 Test Loss: 1.510 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9584424495697021
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.966684103012085
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 77540
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5742075443267822
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.354 Vali Acc: 0.378 Test Loss: 1.354 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.3276612758636475
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.300 Vali Acc: 0.432 Test Loss: 1.300 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.7974951267242432
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.811540126800537
Epoch: 4, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.235 Vali Acc: 0.405 Test Loss: 1.235 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8519001007080078
Epoch: 5, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.9646124839782715
Epoch: 6, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.167 Vali Acc: 0.459 Test Loss: 1.167 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6930599212646484
Epoch: 7, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.145 Vali Acc: 0.446 Test Loss: 1.145 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6661360263824463
Epoch: 8, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.115 Vali Acc: 0.473 Test Loss: 1.115 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6664061546325684
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.138 Vali Acc: 0.459 Test Loss: 1.138 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.558805227279663
Epoch: 10, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6994214057922363
Epoch: 11, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6814813613891602
Epoch: 12, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.196 Vali Acc: 0.541 Test Loss: 1.196 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5462501049041748
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.247 Vali Acc: 0.527 Test Loss: 1.247 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9704577922821045
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.259 Vali Acc: 0.514 Test Loss: 1.259 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7894353866577148
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.319 Vali Acc: 0.527 Test Loss: 1.319 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 59940
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.014214038848877
Epoch: 1, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.435 Vali Acc: 0.270 Test Loss: 1.435 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0863478183746338
Epoch: 2, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.419 Vali Acc: 0.324 Test Loss: 1.419 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.0439205169677734
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.315 Vali Acc: 0.446 Test Loss: 1.315 Test Acc: 0.446
Validation loss decreased (-0.324310 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.128262996673584
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.284 Vali Acc: 0.419 Test Loss: 1.284 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0463943481445312
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.222 Vali Acc: 0.459 Test Loss: 1.222 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.1205182075500488
Epoch: 6, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.204 Vali Acc: 0.446 Test Loss: 1.204 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0467262268066406
Epoch: 7, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.0349171161651611
Epoch: 8, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.1034221649169922
Epoch: 9, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2378177642822266
Epoch: 10, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 1.1599230766296387
Epoch: 11, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2211523056030273
Epoch: 12, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.175 Vali Acc: 0.486 Test Loss: 1.175 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0486984252929688
Epoch: 13, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.171 Vali Acc: 0.568 Test Loss: 1.171 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1567487716674805
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.169 Vali Acc: 0.581 Test Loss: 1.169 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 15 cost time: 1.1358866691589355
Epoch: 15, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.115056037902832
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.239 Vali Acc: 0.581 Test Loss: 1.239 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.121321201324463
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.242 Vali Acc: 0.581 Test Loss: 1.242 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1743190288543701
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.264 Vali Acc: 0.541 Test Loss: 1.264 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1825931072235107
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.279 Vali Acc: 0.568 Test Loss: 1.279 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2135756015777588
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.289 Vali Acc: 0.595 Test Loss: 1.289 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 21 cost time: 1.1510381698608398
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.289 Vali Acc: 0.554 Test Loss: 1.289 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2196259498596191
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.312 Vali Acc: 0.568 Test Loss: 1.312 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0931148529052734
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.332 Vali Acc: 0.568 Test Loss: 1.332 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1725926399230957
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.363 Vali Acc: 0.581 Test Loss: 1.363 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1114685535430908
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.379 Vali Acc: 0.568 Test Loss: 1.379 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9894871711730957
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.368 Vali Acc: 0.568 Test Loss: 1.368 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2100450992584229
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.390 Vali Acc: 0.568 Test Loss: 1.390 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.169940710067749
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.399 Vali Acc: 0.568 Test Loss: 1.399 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2275176048278809
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.400 Vali Acc: 0.568 Test Loss: 1.400 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1039955615997314
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.412 Vali Acc: 0.554 Test Loss: 1.412 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 52580
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9187521934509277
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.471 Vali Acc: 0.257 Test Loss: 1.471 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.3004515171051025
Epoch: 2, Steps: 10 | Train Loss: 1.551 Vali Loss: 1.431 Vali Acc: 0.243 Test Loss: 1.431 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.110511302947998
Epoch: 3, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.363 Vali Acc: 0.257 Test Loss: 1.363 Test Acc: 0.257
Validation loss decreased (-0.256742 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 1.1249783039093018
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.302 Vali Acc: 0.365 Test Loss: 1.302 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.9775199890136719
Epoch: 5, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.255 Vali Acc: 0.432 Test Loss: 1.255 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.1779375076293945
Epoch: 6, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.220 Vali Acc: 0.446 Test Loss: 1.220 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 1.1138148307800293
Epoch: 7, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.0683903694152832
Epoch: 8, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.119948148727417
Epoch: 9, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.1812787055969238
Epoch: 10, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.141 Vali Acc: 0.541 Test Loss: 1.141 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.0208120346069336
Epoch: 11, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 1.039893388748169
Epoch: 12, Steps: 10 | Train Loss: 0.498 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.113633394241333
Epoch: 13, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.137 Vali Acc: 0.554 Test Loss: 1.137 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0848777294158936
Epoch: 14, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1982896327972412
Epoch: 15, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.150 Vali Acc: 0.568 Test Loss: 1.150 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 1.1851160526275635
Epoch: 16, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.156 Vali Acc: 0.581 Test Loss: 1.156 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 1.1168644428253174
Epoch: 17, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.157 Vali Acc: 0.622 Test Loss: 1.157 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621610).  Saving model ...
Epoch: 18 cost time: 1.171140432357788
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.198 Vali Acc: 0.595 Test Loss: 1.198 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1670112609863281
Epoch: 19, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.242 Vali Acc: 0.581 Test Loss: 1.242 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1998307704925537
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.261 Vali Acc: 0.595 Test Loss: 1.261 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.207862377166748
Epoch: 21, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.286 Vali Acc: 0.595 Test Loss: 1.286 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0343947410583496
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.301 Vali Acc: 0.554 Test Loss: 1.301 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2101569175720215
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.348 Vali Acc: 0.568 Test Loss: 1.348 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1058313846588135
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.356 Vali Acc: 0.568 Test Loss: 1.356 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0922460556030273
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.346 Vali Acc: 0.581 Test Loss: 1.346 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2128009796142578
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.287736415863037
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.371 Vali Acc: 0.568 Test Loss: 1.371 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 44260
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.154621124267578
Epoch: 1, Steps: 10 | Train Loss: 1.555 Vali Loss: 1.448 Vali Acc: 0.311 Test Loss: 1.448 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.0928504467010498
Epoch: 2, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.426 Vali Acc: 0.270 Test Loss: 1.426 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1515400409698486
Epoch: 3, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.374 Vali Acc: 0.284 Test Loss: 1.374 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9923112392425537
Epoch: 4, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.343 Vali Acc: 0.324 Test Loss: 1.343 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.0069305896759033
Epoch: 5, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.308 Vali Acc: 0.365 Test Loss: 1.308 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 1.1045188903808594
Epoch: 6, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.278 Vali Acc: 0.419 Test Loss: 1.278 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.9887595176696777
Epoch: 7, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.247 Vali Acc: 0.473 Test Loss: 1.247 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.054659366607666
Epoch: 8, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0746135711669922
Epoch: 9, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1296660900115967
Epoch: 10, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.098689317703247
Epoch: 11, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.0378577709197998
Epoch: 12, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 13 cost time: 1.1293389797210693
Epoch: 13, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.137 Vali Acc: 0.486 Test Loss: 1.137 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.070042610168457
Epoch: 14, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 1.2097578048706055
Epoch: 15, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 1.0292365550994873
Epoch: 16, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.172156810760498
Epoch: 17, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 1.2674436569213867
Epoch: 18, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1006102561950684
Epoch: 19, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1911911964416504
Epoch: 20, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1628575325012207
Epoch: 21, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.174 Vali Acc: 0.568 Test Loss: 1.174 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 22 cost time: 1.2085728645324707
Epoch: 22, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.187 Vali Acc: 0.527 Test Loss: 1.187 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2274949550628662
Epoch: 23, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.193 Vali Acc: 0.527 Test Loss: 1.193 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.203779697418213
Epoch: 24, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.211 Vali Acc: 0.568 Test Loss: 1.211 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2500460147857666
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.223 Vali Acc: 0.554 Test Loss: 1.223 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.276961088180542
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.257 Vali Acc: 0.554 Test Loss: 1.257 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2049763202667236
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1255221366882324
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.300 Vali Acc: 0.554 Test Loss: 1.300 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1202070713043213
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.299 Vali Acc: 0.554 Test Loss: 1.299 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.065171480178833
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.309 Vali Acc: 0.554 Test Loss: 1.309 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9171981811523438
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.311 Vali Acc: 0.554 Test Loss: 1.311 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 41060
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0173463821411133
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.400 Vali Acc: 0.257 Test Loss: 1.400 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0089237689971924
Epoch: 2, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.361 Vali Acc: 0.324 Test Loss: 1.361 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.9563701152801514
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.314 Vali Acc: 0.419 Test Loss: 1.314 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.047297716140747
Epoch: 4, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.271 Vali Acc: 0.446 Test Loss: 1.271 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.0257816314697266
Epoch: 5, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.9407541751861572
Epoch: 6, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.049091100692749
Epoch: 7, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.039656400680542
Epoch: 8, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.9232213497161865
Epoch: 9, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.112501621246338
Epoch: 10, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 1.073422908782959
Epoch: 11, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0453124046325684
Epoch: 12, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.211829423904419
Epoch: 13, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0393009185791016
Epoch: 14, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.020353078842163
Epoch: 15, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.148 Vali Acc: 0.568 Test Loss: 1.148 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 1.0328319072723389
Epoch: 16, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.170 Vali Acc: 0.541 Test Loss: 1.170 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0511438846588135
Epoch: 17, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0812344551086426
Epoch: 18, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0512402057647705
Epoch: 19, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.199 Vali Acc: 0.568 Test Loss: 1.199 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9585676193237305
Epoch: 20, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.240 Vali Acc: 0.581 Test Loss: 1.240 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 21 cost time: 1.0248034000396729
Epoch: 21, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.274 Vali Acc: 0.568 Test Loss: 1.274 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9968476295471191
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.280 Vali Acc: 0.568 Test Loss: 1.280 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.108187198638916
Epoch: 23, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.295 Vali Acc: 0.568 Test Loss: 1.295 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.018923044204712
Epoch: 24, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.324 Vali Acc: 0.568 Test Loss: 1.324 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0925202369689941
Epoch: 25, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0605041980743408
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.376 Vali Acc: 0.568 Test Loss: 1.376 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1069841384887695
Epoch: 27, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.407 Vali Acc: 0.554 Test Loss: 1.407 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.018357515335083
Epoch: 28, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.441 Vali Acc: 0.554 Test Loss: 1.441 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0860717296600342
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.448 Vali Acc: 0.541 Test Loss: 1.448 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1074309349060059
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.472 Vali Acc: 0.554 Test Loss: 1.472 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm32_nh4_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 39140
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.229214668273926
Epoch: 1, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.455 Vali Acc: 0.189 Test Loss: 1.455 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.2663109302520752
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.378 Vali Acc: 0.230 Test Loss: 1.378 Test Acc: 0.230
Validation loss decreased (-0.189175 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 1.333240032196045
Epoch: 3, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
Validation loss decreased (-0.229716 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.2646377086639404
Epoch: 4, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.250 Vali Acc: 0.446 Test Loss: 1.250 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.3114962577819824
Epoch: 5, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2323386669158936
Epoch: 6, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1352238655090332
Epoch: 7, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.3809242248535156
Epoch: 8, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.3683266639709473
Epoch: 9, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3077573776245117
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.291 Vali Acc: 0.473 Test Loss: 1.291 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3953044414520264
Epoch: 11, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.318 Vali Acc: 0.527 Test Loss: 1.318 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4183826446533203
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.390 Vali Acc: 0.486 Test Loss: 1.390 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.349031925201416
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.423 Vali Acc: 0.486 Test Loss: 1.423 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.476947546005249
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.403 Vali Acc: 0.459 Test Loss: 1.403 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3930020332336426
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.432 Vali Acc: 0.486 Test Loss: 1.432 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4163463115692139
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.506 Vali Acc: 0.486 Test Loss: 1.506 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.337040662765503
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.539 Vali Acc: 0.486 Test Loss: 1.539 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3492300510406494
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.546 Vali Acc: 0.486 Test Loss: 1.546 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 80244
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8720664978027344
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.1280255317687988
Epoch: 2, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.379 Vali Acc: 0.351 Test Loss: 1.379 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.2467641830444336
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.275 Vali Acc: 0.446 Test Loss: 1.275 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.9764003753662109
Epoch: 4, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.0941369533538818
Epoch: 5, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.193 Vali Acc: 0.432 Test Loss: 1.193 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2239279747009277
Epoch: 6, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.161 Vali Acc: 0.459 Test Loss: 1.161 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0708301067352295
Epoch: 7, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1143476963043213
Epoch: 8, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.2203047275543213
Epoch: 9, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.092 Vali Acc: 0.446 Test Loss: 1.092 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2970013618469238
Epoch: 10, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.085 Vali Acc: 0.486 Test Loss: 1.085 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0600574016571045
Epoch: 11, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.1832201480865479
Epoch: 12, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.091 Vali Acc: 0.527 Test Loss: 1.091 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.2383406162261963
Epoch: 13, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.096 Vali Acc: 0.486 Test Loss: 1.096 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2757568359375
Epoch: 14, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2803056240081787
Epoch: 15, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1991515159606934
Epoch: 16, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 1.2334237098693848
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.195 Vali Acc: 0.568 Test Loss: 1.195 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 18 cost time: 1.2263598442077637
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.265 Vali Acc: 0.527 Test Loss: 1.265 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.261573076248169
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.256 Vali Acc: 0.554 Test Loss: 1.256 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2336559295654297
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.279 Vali Acc: 0.514 Test Loss: 1.279 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2791292667388916
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.325 Vali Acc: 0.527 Test Loss: 1.325 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2302613258361816
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.355 Vali Acc: 0.514 Test Loss: 1.355 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3002519607543945
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.341 Vali Acc: 0.541 Test Loss: 1.341 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2666263580322266
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.335 Vali Acc: 0.527 Test Loss: 1.335 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1799676418304443
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3114843368530273
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.371 Vali Acc: 0.541 Test Loss: 1.371 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3994786739349365
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.385 Vali Acc: 0.554 Test Loss: 1.385 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 54804
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8776633739471436
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.566 Vali Acc: 0.284 Test Loss: 1.566 Test Acc: 0.284
Validation loss decreased (inf --> -0.283768).  Saving model ...
Epoch: 2 cost time: 1.1239712238311768
Epoch: 2, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.477 Vali Acc: 0.243 Test Loss: 1.477 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0562596321105957
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.399 Vali Acc: 0.311 Test Loss: 1.399 Test Acc: 0.311
Validation loss decreased (-0.283768 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.0992560386657715
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.370 Vali Acc: 0.351 Test Loss: 1.370 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.2411255836486816
Epoch: 5, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.355 Vali Acc: 0.378 Test Loss: 1.355 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.2136225700378418
Epoch: 6, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 1.293100357055664
Epoch: 7, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.260 Vali Acc: 0.446 Test Loss: 1.260 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.0880835056304932
Epoch: 8, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.241 Vali Acc: 0.419 Test Loss: 1.241 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1502022743225098
Epoch: 9, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.211 Vali Acc: 0.446 Test Loss: 1.211 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 1.153942584991455
Epoch: 10, Steps: 10 | Train Loss: 0.665 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1515834331512451
Epoch: 11, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 1.2169060707092285
Epoch: 12, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.189 Vali Acc: 0.459 Test Loss: 1.189 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.142418622970581
Epoch: 13, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1736986637115479
Epoch: 14, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 15 cost time: 1.142756700515747
Epoch: 15, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0855276584625244
Epoch: 16, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 17 cost time: 1.127234697341919
Epoch: 17, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9960591793060303
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.268 Vali Acc: 0.486 Test Loss: 1.268 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1369223594665527
Epoch: 19, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.268 Vali Acc: 0.486 Test Loss: 1.268 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0694215297698975
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.304 Vali Acc: 0.500 Test Loss: 1.304 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 21 cost time: 1.2314953804016113
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.315 Vali Acc: 0.486 Test Loss: 1.315 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2850074768066406
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.307 Vali Acc: 0.473 Test Loss: 1.307 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2585053443908691
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.331 Vali Acc: 0.473 Test Loss: 1.331 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2537472248077393
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.382 Vali Acc: 0.473 Test Loss: 1.382 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2354929447174072
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.357 Vali Acc: 0.473 Test Loss: 1.357 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.22878098487854
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.372 Vali Acc: 0.473 Test Loss: 1.372 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1665053367614746
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.382 Vali Acc: 0.486 Test Loss: 1.382 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1056842803955078
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.427 Vali Acc: 0.486 Test Loss: 1.427 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2768559455871582
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.449 Vali Acc: 0.459 Test Loss: 1.449 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.222315788269043
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.448 Vali Acc: 0.473 Test Loss: 1.448 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 46004
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8398799896240234
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.365 Vali Acc: 0.392 Test Loss: 1.365 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.2049214839935303
Epoch: 2, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.307 Vali Acc: 0.432 Test Loss: 1.307 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.2151446342468262
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.263 Vali Acc: 0.473 Test Loss: 1.263 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.1199374198913574
Epoch: 4, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.155102252960205
Epoch: 5, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.240 Vali Acc: 0.514 Test Loss: 1.240 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.1778438091278076
Epoch: 6, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0488626956939697
Epoch: 7, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.1601643562316895
Epoch: 8, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1174304485321045
Epoch: 9, Steps: 10 | Train Loss: 0.762 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0776216983795166
Epoch: 10, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.092653751373291
Epoch: 11, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.123 Vali Acc: 0.527 Test Loss: 1.123 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2201061248779297
Epoch: 12, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.240443229675293
Epoch: 13, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.123 Vali Acc: 0.568 Test Loss: 1.123 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 1.0266637802124023
Epoch: 14, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.119 Vali Acc: 0.568 Test Loss: 1.119 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 1.1688604354858398
Epoch: 15, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1785662174224854
Epoch: 16, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1050002574920654
Epoch: 17, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 18 cost time: 1.0686702728271484
Epoch: 18, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.185 Vali Acc: 0.568 Test Loss: 1.185 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.273176908493042
Epoch: 19, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.188 Vali Acc: 0.595 Test Loss: 1.188 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 20 cost time: 1.0628652572631836
Epoch: 20, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.221 Vali Acc: 0.568 Test Loss: 1.221 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1860458850860596
Epoch: 21, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.240 Vali Acc: 0.541 Test Loss: 1.240 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.349259853363037
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.260 Vali Acc: 0.541 Test Loss: 1.260 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1180927753448486
Epoch: 23, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.302 Vali Acc: 0.527 Test Loss: 1.302 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1902949810028076
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.289 Vali Acc: 0.541 Test Loss: 1.289 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.173158884048462
Epoch: 25, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.274 Vali Acc: 0.541 Test Loss: 1.274 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1129677295684814
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.309 Vali Acc: 0.581 Test Loss: 1.309 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2109653949737549
Epoch: 27, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.322 Vali Acc: 0.568 Test Loss: 1.322 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1929824352264404
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.335 Vali Acc: 0.514 Test Loss: 1.335 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0210685729980469
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.364 Vali Acc: 0.514 Test Loss: 1.364 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 42324
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7793471813201904
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.507 Vali Acc: 0.176 Test Loss: 1.507 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.0624010562896729
Epoch: 2, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.473 Vali Acc: 0.243 Test Loss: 1.473 Test Acc: 0.243
Validation loss decreased (-0.175661 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.9840705394744873
Epoch: 3, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 1.0821943283081055
Epoch: 4, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.402 Vali Acc: 0.338 Test Loss: 1.402 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 1.1844696998596191
Epoch: 5, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.369 Vali Acc: 0.378 Test Loss: 1.369 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.0311787128448486
Epoch: 6, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.345 Vali Acc: 0.392 Test Loss: 1.345 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391878).  Saving model ...
Epoch: 7 cost time: 1.0867063999176025
Epoch: 7, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.322 Vali Acc: 0.378 Test Loss: 1.322 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0974674224853516
Epoch: 8, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.302 Vali Acc: 0.351 Test Loss: 1.302 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1641619205474854
Epoch: 9, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.293 Vali Acc: 0.351 Test Loss: 1.293 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1682419776916504
Epoch: 10, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.272 Vali Acc: 0.378 Test Loss: 1.272 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1033031940460205
Epoch: 11, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.248 Vali Acc: 0.392 Test Loss: 1.248 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 12 cost time: 1.1510603427886963
Epoch: 12, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.225 Vali Acc: 0.392 Test Loss: 1.225 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391880).  Saving model ...
Epoch: 13 cost time: 1.0915791988372803
Epoch: 13, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.214 Vali Acc: 0.378 Test Loss: 1.214 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0639739036560059
Epoch: 14, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.216 Vali Acc: 0.392 Test Loss: 1.216 Test Acc: 0.392
Validation loss decreased (-0.391880 --> -0.391880).  Saving model ...
Epoch: 15 cost time: 1.1299140453338623
Epoch: 15, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.214 Vali Acc: 0.405 Test Loss: 1.214 Test Acc: 0.405
Validation loss decreased (-0.391880 --> -0.405393).  Saving model ...
Epoch: 16 cost time: 1.0926034450531006
Epoch: 16, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.219 Vali Acc: 0.392 Test Loss: 1.219 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.167341709136963
Epoch: 17, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.205 Vali Acc: 0.405 Test Loss: 1.205 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 18 cost time: 1.1929149627685547
Epoch: 18, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.224 Vali Acc: 0.432 Test Loss: 1.224 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 19 cost time: 1.0787222385406494
Epoch: 19, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.238 Vali Acc: 0.419 Test Loss: 1.238 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1390342712402344
Epoch: 20, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.235 Vali Acc: 0.419 Test Loss: 1.235 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1240875720977783
Epoch: 21, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.247 Vali Acc: 0.419 Test Loss: 1.247 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0971040725708008
Epoch: 22, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.246 Vali Acc: 0.432 Test Loss: 1.246 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0338962078094482
Epoch: 23, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.295 Vali Acc: 0.446 Test Loss: 1.295 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 24 cost time: 1.2613916397094727
Epoch: 24, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1721065044403076
Epoch: 25, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.302 Vali Acc: 0.432 Test Loss: 1.302 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2073445320129395
Epoch: 26, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.356 Vali Acc: 0.486 Test Loss: 1.356 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486473).  Saving model ...
Epoch: 27 cost time: 1.1844933032989502
Epoch: 27, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.365 Vali Acc: 0.459 Test Loss: 1.365 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1587462425231934
Epoch: 28, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.364 Vali Acc: 0.459 Test Loss: 1.364 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.159208059310913
Epoch: 29, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.378 Vali Acc: 0.473 Test Loss: 1.378 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.135117530822754
Epoch: 30, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.392 Vali Acc: 0.473 Test Loss: 1.392 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2378487586975098
Epoch: 31, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.416 Vali Acc: 0.446 Test Loss: 1.416 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.262535572052002
Epoch: 32, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.436 Vali Acc: 0.473 Test Loss: 1.436 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1492128372192383
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.450 Vali Acc: 0.446 Test Loss: 1.450 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0772006511688232
Epoch: 34, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.455 Vali Acc: 0.446 Test Loss: 1.455 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2709577083587646
Epoch: 35, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.468 Vali Acc: 0.446 Test Loss: 1.468 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2169253826141357
Epoch: 36, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.492 Vali Acc: 0.432 Test Loss: 1.492 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 38164
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.088360071182251
Epoch: 1, Steps: 10 | Train Loss: 1.576 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.1525492668151855
Epoch: 2, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.1393241882324219
Epoch: 3, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.392 Vali Acc: 0.324 Test Loss: 1.392 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.0845115184783936
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.365 Vali Acc: 0.351 Test Loss: 1.365 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.0744285583496094
Epoch: 5, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.331 Vali Acc: 0.392 Test Loss: 1.331 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.100691795349121
Epoch: 6, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.292 Vali Acc: 0.432 Test Loss: 1.292 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.0242063999176025
Epoch: 7, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.260 Vali Acc: 0.459 Test Loss: 1.260 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.0235741138458252
Epoch: 8, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.067093849182129
Epoch: 9, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 1.0690622329711914
Epoch: 10, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.0560529232025146
Epoch: 11, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.0442402362823486
Epoch: 12, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.1865754127502441
Epoch: 13, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.143589973449707
Epoch: 14, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 1.0570838451385498
Epoch: 15, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.116 Vali Acc: 0.554 Test Loss: 1.116 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 1.0704960823059082
Epoch: 16, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 17 cost time: 1.0307717323303223
Epoch: 17, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.126 Vali Acc: 0.527 Test Loss: 1.126 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0250561237335205
Epoch: 18, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1118900775909424
Epoch: 19, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9894447326660156
Epoch: 20, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0748848915100098
Epoch: 21, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0145597457885742
Epoch: 22, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.049316167831421
Epoch: 23, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9632358551025391
Epoch: 24, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.136 Vali Acc: 0.486 Test Loss: 1.136 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.079604148864746
Epoch: 25, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1115343570709229
Epoch: 26, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.187 Vali Acc: 0.514 Test Loss: 1.187 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 36564
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8861629962921143
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.418 Vali Acc: 0.297 Test Loss: 1.418 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.3486409187316895
Epoch: 2, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.401 Vali Acc: 0.324 Test Loss: 1.401 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.1674399375915527
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.385 Vali Acc: 0.365 Test Loss: 1.385 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.0482299327850342
Epoch: 4, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.365 Vali Acc: 0.378 Test Loss: 1.365 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.2316129207611084
Epoch: 5, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.339 Vali Acc: 0.392 Test Loss: 1.339 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391878).  Saving model ...
Epoch: 6 cost time: 1.0650403499603271
Epoch: 6, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.322 Vali Acc: 0.419 Test Loss: 1.322 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 1.241990566253662
Epoch: 7, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.293 Vali Acc: 0.432 Test Loss: 1.293 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 8 cost time: 1.0766537189483643
Epoch: 8, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.1116313934326172
Epoch: 9, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.259 Vali Acc: 0.473 Test Loss: 1.259 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1524584293365479
Epoch: 10, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.245 Vali Acc: 0.473 Test Loss: 1.245 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.126650333404541
Epoch: 11, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2287778854370117
Epoch: 12, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.211 Vali Acc: 0.432 Test Loss: 1.211 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1282825469970703
Epoch: 13, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.109682559967041
Epoch: 14, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.177 Vali Acc: 0.486 Test Loss: 1.177 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 15 cost time: 1.2028212547302246
Epoch: 15, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.064857006072998
Epoch: 16, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.1478469371795654
Epoch: 17, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1938281059265137
Epoch: 18, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.0694739818572998
Epoch: 19, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2149410247802734
Epoch: 20, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.188 Vali Acc: 0.473 Test Loss: 1.188 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0934514999389648
Epoch: 21, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1294879913330078
Epoch: 22, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.229 Vali Acc: 0.459 Test Loss: 1.229 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0342822074890137
Epoch: 23, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.236 Vali Acc: 0.486 Test Loss: 1.236 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1779046058654785
Epoch: 24, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.245 Vali Acc: 0.419 Test Loss: 1.245 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.192119836807251
Epoch: 25, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.134824514389038
Epoch: 26, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1875579357147217
Epoch: 27, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.290 Vali Acc: 0.419 Test Loss: 1.290 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0317389965057373
Epoch: 28, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.316 Vali Acc: 0.432 Test Loss: 1.316 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 35604
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.224297523498535
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.5267503261566162
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.356 Vali Acc: 0.324 Test Loss: 1.356 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.5742967128753662
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.298 Vali Acc: 0.378 Test Loss: 1.298 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.3852081298828125
Epoch: 4, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.193 Vali Acc: 0.527 Test Loss: 1.193 Test Acc: 0.527
Validation loss decreased (-0.378365 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.6151461601257324
Epoch: 5, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.206 Vali Acc: 0.432 Test Loss: 1.206 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4172658920288086
Epoch: 6, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3374943733215332
Epoch: 7, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.4292066097259521
Epoch: 8, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4940776824951172
Epoch: 9, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5843138694763184
Epoch: 10, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.262 Vali Acc: 0.541 Test Loss: 1.262 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5545601844787598
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.313 Vali Acc: 0.500 Test Loss: 1.313 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.78458571434021
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.340 Vali Acc: 0.514 Test Loss: 1.340 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5493803024291992
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4950296878814697
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.484 Vali Acc: 0.486 Test Loss: 1.484 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6814703941345215
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5474565029144287
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.509 Vali Acc: 0.500 Test Loss: 1.509 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6366922855377197
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 67572
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2428066730499268
Epoch: 1, Steps: 10 | Train Loss: 1.517 Vali Loss: 1.434 Vali Acc: 0.216 Test Loss: 1.434 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.11541748046875
Epoch: 2, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.407 Vali Acc: 0.216 Test Loss: 1.407 Test Acc: 0.216
Validation loss decreased (-0.216202 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 1.1974236965179443
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.345 Vali Acc: 0.311 Test Loss: 1.345 Test Acc: 0.311
Validation loss decreased (-0.216202 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.0390431880950928
Epoch: 4, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.274 Vali Acc: 0.432 Test Loss: 1.274 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.0163872241973877
Epoch: 5, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.2164223194122314
Epoch: 6, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.206 Vali Acc: 0.473 Test Loss: 1.206 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.1058447360992432
Epoch: 7, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.1702182292938232
Epoch: 8, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1879422664642334
Epoch: 9, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2436959743499756
Epoch: 10, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.171 Vali Acc: 0.527 Test Loss: 1.171 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 1.1161751747131348
Epoch: 11, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.184 Vali Acc: 0.446 Test Loss: 1.184 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2439284324645996
Epoch: 12, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1537013053894043
Epoch: 13, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2982783317565918
Epoch: 14, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1400566101074219
Epoch: 15, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.163334846496582
Epoch: 16, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2139461040496826
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.223928451538086
Epoch: 18, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.283 Vali Acc: 0.486 Test Loss: 1.283 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2454020977020264
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.298 Vali Acc: 0.473 Test Loss: 1.298 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3452165126800537
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 42132
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9495458602905273
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.387 Vali Acc: 0.257 Test Loss: 1.387 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0823733806610107
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (-0.256743 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.303708791732788
Epoch: 3, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.302 Vali Acc: 0.405 Test Loss: 1.302 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.2448899745941162
Epoch: 4, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.256 Vali Acc: 0.419 Test Loss: 1.256 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.1550512313842773
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.234 Vali Acc: 0.446 Test Loss: 1.234 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.238572597503662
Epoch: 6, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.209 Vali Acc: 0.446 Test Loss: 1.209 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 1.1606032848358154
Epoch: 7, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.169 Vali Acc: 0.419 Test Loss: 1.169 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.254354476928711
Epoch: 8, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.175 Vali Acc: 0.432 Test Loss: 1.175 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2299926280975342
Epoch: 9, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.1573376655578613
Epoch: 10, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.2696654796600342
Epoch: 11, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.134 Vali Acc: 0.486 Test Loss: 1.134 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.280653953552246
Epoch: 12, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2246358394622803
Epoch: 13, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0871360301971436
Epoch: 14, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.137 Vali Acc: 0.473 Test Loss: 1.137 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2087626457214355
Epoch: 15, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 16 cost time: 1.1486115455627441
Epoch: 16, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1682252883911133
Epoch: 17, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.191011905670166
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.211 Vali Acc: 0.527 Test Loss: 1.211 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.154897689819336
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.260007619857788
Epoch: 20, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.183063268661499
Epoch: 21, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1419904232025146
Epoch: 22, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.302 Vali Acc: 0.541 Test Loss: 1.302 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1449720859527588
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.309 Vali Acc: 0.541 Test Loss: 1.309 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2015860080718994
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.334 Vali Acc: 0.541 Test Loss: 1.334 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1409752368927002
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 33332
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.857969045639038
Epoch: 1, Steps: 10 | Train Loss: 1.576 Vali Loss: 1.409 Vali Acc: 0.311 Test Loss: 1.409 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.1949028968811035
Epoch: 2, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.395 Vali Acc: 0.351 Test Loss: 1.395 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 1.1035468578338623
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.364 Vali Acc: 0.378 Test Loss: 1.364 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.1280314922332764
Epoch: 4, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.319 Vali Acc: 0.392 Test Loss: 1.319 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.249587059020996
Epoch: 5, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.274 Vali Acc: 0.351 Test Loss: 1.274 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1183295249938965
Epoch: 6, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.237 Vali Acc: 0.392 Test Loss: 1.237 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391880).  Saving model ...
Epoch: 7 cost time: 1.1291041374206543
Epoch: 7, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.198 Vali Acc: 0.405 Test Loss: 1.198 Test Acc: 0.405
Validation loss decreased (-0.391880 --> -0.405393).  Saving model ...
Epoch: 8 cost time: 1.2397360801696777
Epoch: 8, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.184 Vali Acc: 0.432 Test Loss: 1.184 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432421).  Saving model ...
Epoch: 9 cost time: 1.0949139595031738
Epoch: 9, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.154 Vali Acc: 0.473 Test Loss: 1.154 Test Acc: 0.473
Validation loss decreased (-0.432421 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.3166465759277344
Epoch: 10, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.121 Vali Acc: 0.473 Test Loss: 1.121 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 11 cost time: 1.1904652118682861
Epoch: 11, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.0803003311157227
Epoch: 12, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.3151991367340088
Epoch: 13, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.1188013553619385
Epoch: 14, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.106 Vali Acc: 0.514 Test Loss: 1.106 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2167587280273438
Epoch: 15, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 16 cost time: 1.173539161682129
Epoch: 16, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1839351654052734
Epoch: 17, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.114896297454834
Epoch: 18, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.089 Vali Acc: 0.514 Test Loss: 1.089 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2231431007385254
Epoch: 19, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2134225368499756
Epoch: 20, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0368146896362305
Epoch: 21, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 22 cost time: 1.2149991989135742
Epoch: 22, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0585179328918457
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.184835433959961
Epoch: 24, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1714484691619873
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1433804035186768
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1248695850372314
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.183 Vali Acc: 0.541 Test Loss: 1.183 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1615443229675293
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1830439567565918
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1900036334991455
Epoch: 30, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.229 Vali Acc: 0.527 Test Loss: 1.229 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2489025592803955
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.236 Vali Acc: 0.541 Test Loss: 1.236 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 29652
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.060783624649048
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.537 Vali Acc: 0.203 Test Loss: 1.537 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 1.1147010326385498
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.484 Vali Acc: 0.230 Test Loss: 1.484 Test Acc: 0.230
Validation loss decreased (-0.202687 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 1.1154379844665527
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.430 Vali Acc: 0.257 Test Loss: 1.430 Test Acc: 0.257
Validation loss decreased (-0.229715 --> -0.256742).  Saving model ...
Epoch: 4 cost time: 1.1946287155151367
Epoch: 4, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1625757217407227
Epoch: 5, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.345 Vali Acc: 0.338 Test Loss: 1.345 Test Acc: 0.338
Validation loss decreased (-0.256742 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 1.1949360370635986
Epoch: 6, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.326 Vali Acc: 0.365 Test Loss: 1.326 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 1.2200303077697754
Epoch: 7, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.286 Vali Acc: 0.378 Test Loss: 1.286 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378366).  Saving model ...
Epoch: 8 cost time: 1.0969617366790771
Epoch: 8, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.256 Vali Acc: 0.419 Test Loss: 1.256 Test Acc: 0.419
Validation loss decreased (-0.378366 --> -0.418906).  Saving model ...
Epoch: 9 cost time: 1.2856109142303467
Epoch: 9, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.266 Vali Acc: 0.392 Test Loss: 1.266 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0718176364898682
Epoch: 10, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.234 Vali Acc: 0.419 Test Loss: 1.234 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 11 cost time: 1.0999794006347656
Epoch: 11, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.191 Vali Acc: 0.432 Test Loss: 1.191 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432421).  Saving model ...
Epoch: 12 cost time: 1.102078914642334
Epoch: 12, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.160 Vali Acc: 0.432 Test Loss: 1.160 Test Acc: 0.432
Validation loss decreased (-0.432421 --> -0.432421).  Saving model ...
Epoch: 13 cost time: 1.0574841499328613
Epoch: 13, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
Validation loss decreased (-0.432421 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.0544123649597168
Epoch: 14, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.1626136302947998
Epoch: 15, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 1.1553707122802734
Epoch: 16, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.027906894683838
Epoch: 17, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.290750503540039
Epoch: 18, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1622364521026611
Epoch: 19, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 20 cost time: 1.2135682106018066
Epoch: 20, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 21 cost time: 1.1697046756744385
Epoch: 21, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1701085567474365
Epoch: 22, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2533786296844482
Epoch: 23, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 24 cost time: 1.1125168800354004
Epoch: 24, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2491910457611084
Epoch: 25, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2037293910980225
Epoch: 26, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2484333515167236
Epoch: 27, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.190 Vali Acc: 0.568 Test Loss: 1.190 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 28 cost time: 1.238677978515625
Epoch: 28, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.192 Vali Acc: 0.581 Test Loss: 1.192 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 29 cost time: 1.27182936668396
Epoch: 29, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.236 Vali Acc: 0.568 Test Loss: 1.236 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.202225923538208
Epoch: 30, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.249 Vali Acc: 0.554 Test Loss: 1.249 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.197335958480835
Epoch: 31, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.227 Vali Acc: 0.554 Test Loss: 1.227 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1271986961364746
Epoch: 32, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.251 Vali Acc: 0.554 Test Loss: 1.251 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2397136688232422
Epoch: 33, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.275 Vali Acc: 0.541 Test Loss: 1.275 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2057273387908936
Epoch: 34, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.287 Vali Acc: 0.541 Test Loss: 1.287 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2774467468261719
Epoch: 35, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.275 Vali Acc: 0.541 Test Loss: 1.275 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1295692920684814
Epoch: 36, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.278 Vali Acc: 0.554 Test Loss: 1.278 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.30232572555542
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.311 Vali Acc: 0.568 Test Loss: 1.311 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2628955841064453
Epoch: 38, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.322 Vali Acc: 0.568 Test Loss: 1.322 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 25492
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.961329221725464
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.486 Vali Acc: 0.203 Test Loss: 1.486 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.297900915145874
Epoch: 2, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.461 Vali Acc: 0.230 Test Loss: 1.461 Test Acc: 0.230
Validation loss decreased (-0.202688 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 1.179034948348999
Epoch: 3, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.421 Vali Acc: 0.216 Test Loss: 1.421 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.160526990890503
Epoch: 4, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.385 Vali Acc: 0.270 Test Loss: 1.385 Test Acc: 0.270
Validation loss decreased (-0.229715 --> -0.270256).  Saving model ...
Epoch: 5 cost time: 1.149850845336914
Epoch: 5, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.351 Vali Acc: 0.338 Test Loss: 1.351 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 1.2475578784942627
Epoch: 6, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.316 Vali Acc: 0.419 Test Loss: 1.316 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 1.153205394744873
Epoch: 7, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.299 Vali Acc: 0.432 Test Loss: 1.299 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 8 cost time: 1.1525521278381348
Epoch: 8, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 1.2320175170898438
Epoch: 9, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.227 Vali Acc: 0.473 Test Loss: 1.227 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.149820327758789
Epoch: 10, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2846603393554688
Epoch: 11, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.202 Vali Acc: 0.459 Test Loss: 1.202 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1454229354858398
Epoch: 12, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.1991212368011475
Epoch: 13, Steps: 10 | Train Loss: 0.816 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 14 cost time: 1.2149157524108887
Epoch: 14, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.125 Vali Acc: 0.527 Test Loss: 1.125 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1974248886108398
Epoch: 15, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2206027507781982
Epoch: 16, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2946279048919678
Epoch: 17, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 18 cost time: 1.1734116077423096
Epoch: 18, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 19 cost time: 1.363462209701538
Epoch: 19, Steps: 10 | Train Loss: 0.498 Vali Loss: 1.094 Vali Acc: 0.541 Test Loss: 1.094 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2537882328033447
Epoch: 20, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 21 cost time: 1.1854510307312012
Epoch: 21, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4077811241149902
Epoch: 22, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1882717609405518
Epoch: 23, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.104 Vali Acc: 0.568 Test Loss: 1.104 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2483720779418945
Epoch: 24, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2241787910461426
Epoch: 25, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2908155918121338
Epoch: 26, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3579726219177246
Epoch: 27, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2272202968597412
Epoch: 28, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.125 Vali Acc: 0.541 Test Loss: 1.125 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.097560167312622
Epoch: 29, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1751339435577393
Epoch: 30, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 23892
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9592504501342773
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.411 Vali Acc: 0.284 Test Loss: 1.411 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.0324623584747314
Epoch: 2, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0351343154907227
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.225111722946167
Epoch: 4, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.392 Vali Acc: 0.230 Test Loss: 1.392 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.051513671875
Epoch: 5, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 6 cost time: 1.0051732063293457
Epoch: 6, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.367 Vali Acc: 0.324 Test Loss: 1.367 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 7 cost time: 1.1740381717681885
Epoch: 7, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.355 Vali Acc: 0.311 Test Loss: 1.355 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0311906337738037
Epoch: 8, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.325 Vali Acc: 0.311 Test Loss: 1.325 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9640250205993652
Epoch: 9, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.315 Vali Acc: 0.351 Test Loss: 1.315 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 10 cost time: 1.232844352722168
Epoch: 10, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.298 Vali Acc: 0.351 Test Loss: 1.298 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 11 cost time: 1.0733447074890137
Epoch: 11, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.273 Vali Acc: 0.351 Test Loss: 1.273 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351339).  Saving model ...
Epoch: 12 cost time: 1.0160455703735352
Epoch: 12, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.274 Vali Acc: 0.378 Test Loss: 1.274 Test Acc: 0.378
Validation loss decreased (-0.351339 --> -0.378366).  Saving model ...
Epoch: 13 cost time: 1.1180169582366943
Epoch: 13, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.266 Vali Acc: 0.392 Test Loss: 1.266 Test Acc: 0.392
Validation loss decreased (-0.378366 --> -0.391879).  Saving model ...
Epoch: 14 cost time: 1.0028562545776367
Epoch: 14, Steps: 10 | Train Loss: 0.804 Vali Loss: 1.253 Vali Acc: 0.378 Test Loss: 1.253 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1493055820465088
Epoch: 15, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.240 Vali Acc: 0.378 Test Loss: 1.240 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1444168090820312
Epoch: 16, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.247 Vali Acc: 0.419 Test Loss: 1.247 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 17 cost time: 0.9205365180969238
Epoch: 17, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 18 cost time: 1.0826480388641357
Epoch: 18, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 19 cost time: 1.1394801139831543
Epoch: 19, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1459083557128906
Epoch: 20, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1424331665039062
Epoch: 21, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.261 Vali Acc: 0.419 Test Loss: 1.261 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.16090726852417
Epoch: 22, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1287586688995361
Epoch: 23, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.292 Vali Acc: 0.419 Test Loss: 1.292 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0608868598937988
Epoch: 24, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.303 Vali Acc: 0.432 Test Loss: 1.303 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.089026689529419
Epoch: 25, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.320 Vali Acc: 0.446 Test Loss: 1.320 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0353693962097168
Epoch: 26, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.334 Vali Acc: 0.446 Test Loss: 1.334 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1956336498260498
Epoch: 27, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.351 Vali Acc: 0.446 Test Loss: 1.351 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1428298950195312
Epoch: 28, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.375 Vali Acc: 0.432 Test Loss: 1.375 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 22932
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8901102542877197
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.407 Vali Acc: 0.297 Test Loss: 1.407 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.867771863937378
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.358 Vali Acc: 0.311 Test Loss: 1.358 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.8888156414031982
Epoch: 3, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.275 Vali Acc: 0.419 Test Loss: 1.275 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.9412248134613037
Epoch: 4, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.797706127166748
Epoch: 5, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.9340994358062744
Epoch: 6, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.807617425918579
Epoch: 7, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.167 Vali Acc: 0.473 Test Loss: 1.167 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7177069187164307
Epoch: 8, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7868354320526123
Epoch: 9, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 1.7569000720977783
Epoch: 10, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8611876964569092
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.374 Vali Acc: 0.486 Test Loss: 1.374 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7338318824768066
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.314 Vali Acc: 0.473 Test Loss: 1.314 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.034771203994751
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.414 Vali Acc: 0.500 Test Loss: 1.414 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8568150997161865
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.397 Vali Acc: 0.514 Test Loss: 1.397 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.762937068939209
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8461902141571045
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.495 Vali Acc: 0.486 Test Loss: 1.495 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7761597633361816
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.506 Vali Acc: 0.459 Test Loss: 1.506 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9634294509887695
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.514 Vali Acc: 0.473 Test Loss: 1.514 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7935969829559326
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.545 Vali Acc: 0.432 Test Loss: 1.545 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 61236
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.775520086288452
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.461 Vali Acc: 0.257 Test Loss: 1.461 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.0313665866851807
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.490 Vali Acc: 0.243 Test Loss: 1.490 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1389117240905762
Epoch: 3, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.402 Vali Acc: 0.324 Test Loss: 1.402 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.0975337028503418
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.359 Vali Acc: 0.432 Test Loss: 1.359 Test Acc: 0.432
Validation loss decreased (-0.324310 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.0905187129974365
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.06675124168396
Epoch: 6, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.301 Vali Acc: 0.392 Test Loss: 1.301 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1068294048309326
Epoch: 7, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.243 Vali Acc: 0.486 Test Loss: 1.243 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0736563205718994
Epoch: 8, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1509513854980469
Epoch: 9, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1377031803131104
Epoch: 10, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.195 Vali Acc: 0.459 Test Loss: 1.195 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1451749801635742
Epoch: 11, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.1231281757354736
Epoch: 12, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1632564067840576
Epoch: 13, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.206 Vali Acc: 0.486 Test Loss: 1.206 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2332098484039307
Epoch: 14, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.235 Vali Acc: 0.514 Test Loss: 1.235 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 15 cost time: 1.1571102142333984
Epoch: 15, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.240 Vali Acc: 0.541 Test Loss: 1.240 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540528).  Saving model ...
Epoch: 16 cost time: 1.1643121242523193
Epoch: 16, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.283 Vali Acc: 0.486 Test Loss: 1.283 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1810972690582275
Epoch: 17, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3540971279144287
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2661550045013428
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.371 Vali Acc: 0.459 Test Loss: 1.371 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1935317516326904
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.377 Vali Acc: 0.514 Test Loss: 1.377 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2323262691497803
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.392 Vali Acc: 0.541 Test Loss: 1.392 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1120986938476562
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.446 Vali Acc: 0.527 Test Loss: 1.446 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1553704738616943
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.427 Vali Acc: 0.514 Test Loss: 1.427 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1565933227539062
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1023175716400146
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.458 Vali Acc: 0.527 Test Loss: 1.458 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 35796
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.011981248855591
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.437 Vali Acc: 0.230 Test Loss: 1.437 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.0468733310699463
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (-0.229715 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.11814546585083
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.388 Vali Acc: 0.311 Test Loss: 1.388 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.9818153381347656
Epoch: 4, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.338 Vali Acc: 0.351 Test Loss: 1.338 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.9815237522125244
Epoch: 5, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.341 Vali Acc: 0.392 Test Loss: 1.341 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391878).  Saving model ...
Epoch: 6 cost time: 1.0610780715942383
Epoch: 6, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.297 Vali Acc: 0.432 Test Loss: 1.297 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432419).  Saving model ...
Epoch: 7 cost time: 1.0331761837005615
Epoch: 7, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.252 Vali Acc: 0.459 Test Loss: 1.252 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.055534839630127
Epoch: 8, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 1.0706007480621338
Epoch: 9, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 0.98679518699646
Epoch: 10, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 1.1033411026000977
Epoch: 11, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.184112548828125
Epoch: 12, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1913022994995117
Epoch: 13, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.035691738128662
Epoch: 14, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1265389919281006
Epoch: 15, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9851298332214355
Epoch: 16, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0627708435058594
Epoch: 17, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0886154174804688
Epoch: 18, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0262272357940674
Epoch: 19, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.270 Vali Acc: 0.486 Test Loss: 1.270 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0551214218139648
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.262 Vali Acc: 0.473 Test Loss: 1.262 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.171226978302002
Epoch: 21, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 26996
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.160764455795288
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.451 Vali Acc: 0.216 Test Loss: 1.451 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.0276715755462646
Epoch: 2, Steps: 10 | Train Loss: 1.528 Vali Loss: 1.443 Vali Acc: 0.230 Test Loss: 1.443 Test Acc: 0.230
Validation loss decreased (-0.216202 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 0.9946045875549316
Epoch: 3, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.412 Vali Acc: 0.257 Test Loss: 1.412 Test Acc: 0.257
Validation loss decreased (-0.229715 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 1.1167972087860107
Epoch: 4, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.375 Vali Acc: 0.284 Test Loss: 1.375 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 1.0332090854644775
Epoch: 5, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.310 Vali Acc: 0.351 Test Loss: 1.310 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.0509390830993652
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.299 Vali Acc: 0.378 Test Loss: 1.299 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 1.0238378047943115
Epoch: 7, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.252 Vali Acc: 0.446 Test Loss: 1.252 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 0.9383189678192139
Epoch: 8, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.194 Vali Acc: 0.446 Test Loss: 1.194 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.031090497970581
Epoch: 9, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.175 Vali Acc: 0.446 Test Loss: 1.175 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 1.1542446613311768
Epoch: 10, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.159 Vali Acc: 0.486 Test Loss: 1.159 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 1.086411476135254
Epoch: 11, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.137 Vali Acc: 0.459 Test Loss: 1.137 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0901243686676025
Epoch: 12, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 1.091322660446167
Epoch: 13, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.087 Vali Acc: 0.527 Test Loss: 1.087 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.1310648918151855
Epoch: 14, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.083 Vali Acc: 0.486 Test Loss: 1.083 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1370506286621094
Epoch: 15, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 1.1151330471038818
Epoch: 16, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.078 Vali Acc: 0.486 Test Loss: 1.078 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.056776523590088
Epoch: 17, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.054 Vali Acc: 0.554 Test Loss: 1.054 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 18 cost time: 1.1607387065887451
Epoch: 18, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.088 Vali Acc: 0.527 Test Loss: 1.088 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0949251651763916
Epoch: 19, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.075 Vali Acc: 0.554 Test Loss: 1.075 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0592143535614014
Epoch: 20, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1612348556518555
Epoch: 21, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.123124361038208
Epoch: 22, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1387722492218018
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.120 Vali Acc: 0.554 Test Loss: 1.120 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0475375652313232
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567556).  Saving model ...
Epoch: 25 cost time: 1.137589931488037
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.155 Vali Acc: 0.568 Test Loss: 1.155 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0406224727630615
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.171 Vali Acc: 0.554 Test Loss: 1.171 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1003401279449463
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.178 Vali Acc: 0.568 Test Loss: 1.178 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8907067775726318
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.054443120956421
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.191 Vali Acc: 0.568 Test Loss: 1.191 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.064772129058838
Epoch: 30, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0400784015655518
Epoch: 31, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.225 Vali Acc: 0.554 Test Loss: 1.225 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.025026798248291
Epoch: 32, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.240 Vali Acc: 0.554 Test Loss: 1.240 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.055130958557129
Epoch: 33, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.246 Vali Acc: 0.554 Test Loss: 1.246 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9912009239196777
Epoch: 34, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 23316
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.645036220550537
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.395 Vali Acc: 0.230 Test Loss: 1.395 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.9284272193908691
Epoch: 2, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
Validation loss decreased (-0.229716 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.1785051822662354
Epoch: 3, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.362 Vali Acc: 0.311 Test Loss: 1.362 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.1493113040924072
Epoch: 4, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.331 Vali Acc: 0.392 Test Loss: 1.331 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.1319670677185059
Epoch: 5, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.309 Vali Acc: 0.419 Test Loss: 1.309 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.0349586009979248
Epoch: 6, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.282 Vali Acc: 0.392 Test Loss: 1.282 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2369437217712402
Epoch: 7, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.250 Vali Acc: 0.378 Test Loss: 1.250 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9845156669616699
Epoch: 8, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.223 Vali Acc: 0.432 Test Loss: 1.223 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 1.2599477767944336
Epoch: 9, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 1.0775599479675293
Epoch: 10, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 1.096900224685669
Epoch: 11, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 1.087491750717163
Epoch: 12, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 1.1115293502807617
Epoch: 13, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.2174797058105469
Epoch: 14, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.135 Vali Acc: 0.473 Test Loss: 1.135 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2530784606933594
Epoch: 15, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.117 Vali Acc: 0.459 Test Loss: 1.117 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.193831443786621
Epoch: 16, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.108 Vali Acc: 0.473 Test Loss: 1.108 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0883147716522217
Epoch: 17, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.115 Vali Acc: 0.419 Test Loss: 1.115 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1526389122009277
Epoch: 18, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.136 Vali Acc: 0.432 Test Loss: 1.136 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0914697647094727
Epoch: 19, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 1.199218511581421
Epoch: 20, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 21 cost time: 1.1529252529144287
Epoch: 21, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1614775657653809
Epoch: 22, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 23 cost time: 1.1580803394317627
Epoch: 23, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.160 Vali Acc: 0.527 Test Loss: 1.160 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 24 cost time: 1.1209156513214111
Epoch: 24, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1736953258514404
Epoch: 25, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0673151016235352
Epoch: 26, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0991644859313965
Epoch: 27, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2697582244873047
Epoch: 28, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.210 Vali Acc: 0.527 Test Loss: 1.210 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1089842319488525
Epoch: 29, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0727100372314453
Epoch: 30, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.232 Vali Acc: 0.527 Test Loss: 1.232 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0459129810333252
Epoch: 31, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.237 Vali Acc: 0.554 Test Loss: 1.237 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 32 cost time: 1.1191234588623047
Epoch: 32, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.265 Vali Acc: 0.514 Test Loss: 1.265 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1843912601470947
Epoch: 33, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.282 Vali Acc: 0.527 Test Loss: 1.282 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1281986236572266
Epoch: 34, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.286 Vali Acc: 0.541 Test Loss: 1.286 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1416089534759521
Epoch: 35, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.260 Vali Acc: 0.554 Test Loss: 1.260 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.126129388809204
Epoch: 36, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.304 Vali Acc: 0.514 Test Loss: 1.304 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1242468357086182
Epoch: 37, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.314 Vali Acc: 0.514 Test Loss: 1.314 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1474368572235107
Epoch: 38, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1820659637451172
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.331 Vali Acc: 0.541 Test Loss: 1.331 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0321955680847168
Epoch: 40, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.344 Vali Acc: 0.527 Test Loss: 1.344 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3043088912963867
Epoch: 41, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.375 Vali Acc: 0.514 Test Loss: 1.375 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 19156
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8582797050476074
Epoch: 1, Steps: 10 | Train Loss: 1.575 Vali Loss: 1.710 Vali Acc: 0.149 Test Loss: 1.710 Test Acc: 0.149
Validation loss decreased (inf --> -0.148632).  Saving model ...
Epoch: 2 cost time: 0.9853720664978027
Epoch: 2, Steps: 10 | Train Loss: 1.585 Vali Loss: 1.652 Vali Acc: 0.176 Test Loss: 1.652 Test Acc: 0.176
Validation loss decreased (-0.148632 --> -0.175659).  Saving model ...
Epoch: 3 cost time: 1.186743974685669
Epoch: 3, Steps: 10 | Train Loss: 1.536 Vali Loss: 1.588 Vali Acc: 0.230 Test Loss: 1.588 Test Acc: 0.230
Validation loss decreased (-0.175659 --> -0.229714).  Saving model ...
Epoch: 4 cost time: 1.0236823558807373
Epoch: 4, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.523 Vali Acc: 0.216 Test Loss: 1.523 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.185823678970337
Epoch: 5, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
Validation loss decreased (-0.229714 --> -0.243228).  Saving model ...
Epoch: 6 cost time: 1.0592100620269775
Epoch: 6, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
Validation loss decreased (-0.243228 --> -0.270256).  Saving model ...
Epoch: 7 cost time: 1.1115000247955322
Epoch: 7, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297283).  Saving model ...
Epoch: 8 cost time: 1.1133427619934082
Epoch: 8, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.387 Vali Acc: 0.338 Test Loss: 1.387 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 9 cost time: 0.9479632377624512
Epoch: 9, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.345 Vali Acc: 0.351 Test Loss: 1.345 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 10 cost time: 1.0394237041473389
Epoch: 10, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.318 Vali Acc: 0.419 Test Loss: 1.318 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 11 cost time: 1.031972885131836
Epoch: 11, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.292 Vali Acc: 0.419 Test Loss: 1.292 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 12 cost time: 1.1318140029907227
Epoch: 12, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.275 Vali Acc: 0.432 Test Loss: 1.275 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 13 cost time: 1.2155098915100098
Epoch: 13, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 14 cost time: 1.066190481185913
Epoch: 14, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.256 Vali Acc: 0.446 Test Loss: 1.256 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2788522243499756
Epoch: 15, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.121516466140747
Epoch: 16, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.236 Vali Acc: 0.446 Test Loss: 1.236 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0666890144348145
Epoch: 17, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.247 Vali Acc: 0.432 Test Loss: 1.247 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9971351623535156
Epoch: 18, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.249 Vali Acc: 0.446 Test Loss: 1.249 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0882253646850586
Epoch: 19, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 20 cost time: 1.257063627243042
Epoch: 20, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.211 Vali Acc: 0.432 Test Loss: 1.211 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2341580390930176
Epoch: 21, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.137298345565796
Epoch: 22, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.226 Vali Acc: 0.419 Test Loss: 1.226 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.216538906097412
Epoch: 23, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.221 Vali Acc: 0.446 Test Loss: 1.221 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.223823070526123
Epoch: 24, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 25 cost time: 1.0446162223815918
Epoch: 25, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0358355045318604
Epoch: 26, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2125697135925293
Epoch: 27, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.275 Vali Acc: 0.446 Test Loss: 1.275 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.18452787399292
Epoch: 28, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.271 Vali Acc: 0.473 Test Loss: 1.271 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1654739379882812
Epoch: 29, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.289 Vali Acc: 0.473 Test Loss: 1.289 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1539692878723145
Epoch: 30, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.284 Vali Acc: 0.473 Test Loss: 1.284 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1807453632354736
Epoch: 31, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.293 Vali Acc: 0.459 Test Loss: 1.293 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.229609489440918
Epoch: 32, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.316 Vali Acc: 0.446 Test Loss: 1.316 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1870183944702148
Epoch: 33, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.339 Vali Acc: 0.446 Test Loss: 1.339 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2120263576507568
Epoch: 34, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.341 Vali Acc: 0.459 Test Loss: 1.341 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 17556
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9434967041015625
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.441 Vali Acc: 0.419 Test Loss: 1.441 Test Acc: 0.419
Validation loss decreased (inf --> -0.418905).  Saving model ...
Epoch: 2 cost time: 1.1367175579071045
Epoch: 2, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.431 Vali Acc: 0.351 Test Loss: 1.431 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2180063724517822
Epoch: 3, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.421 Vali Acc: 0.297 Test Loss: 1.421 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1745507717132568
Epoch: 4, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0326108932495117
Epoch: 5, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.391 Vali Acc: 0.311 Test Loss: 1.391 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1082665920257568
Epoch: 6, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.374 Vali Acc: 0.311 Test Loss: 1.374 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0378179550170898
Epoch: 7, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.350 Vali Acc: 0.338 Test Loss: 1.350 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.242715835571289
Epoch: 8, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.323 Vali Acc: 0.365 Test Loss: 1.323 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.200103521347046
Epoch: 9, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9923393726348877
Epoch: 10, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.282 Vali Acc: 0.365 Test Loss: 1.282 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1222236156463623
Epoch: 11, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.264 Vali Acc: 0.365 Test Loss: 1.264 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el3_dm16_nh4_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 16596
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.111133575439453
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.465 Vali Acc: 0.297 Test Loss: 1.465 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.7436833381652832
Epoch: 2, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.544 Vali Acc: 0.419 Test Loss: 1.544 Test Acc: 0.419
Validation loss decreased (-0.297283 --> -0.418903).  Saving model ...
Epoch: 3 cost time: 1.8897078037261963
Epoch: 3, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.798 Vali Acc: 0.446 Test Loss: 1.798 Test Acc: 0.446
Validation loss decreased (-0.418903 --> -0.445928).  Saving model ...
Epoch: 4 cost time: 1.8003928661346436
Epoch: 4, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.910 Vali Acc: 0.419 Test Loss: 1.910 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9134697914123535
Epoch: 5, Steps: 10 | Train Loss: 0.120 Vali Loss: 2.148 Vali Acc: 0.405 Test Loss: 2.148 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.993396282196045
Epoch: 6, Steps: 10 | Train Loss: 0.066 Vali Loss: 2.145 Vali Acc: 0.554 Test Loss: 2.145 Test Acc: 0.554
Validation loss decreased (-0.445928 --> -0.554033).  Saving model ...
Epoch: 7 cost time: 1.9334185123443604
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.396 Vali Acc: 0.500 Test Loss: 2.396 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0866076946258545
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.650 Vali Acc: 0.459 Test Loss: 2.650 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9263553619384766
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.040 Vali Acc: 0.446 Test Loss: 3.040 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9199340343475342
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.476 Vali Acc: 0.514 Test Loss: 3.476 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.090993881225586
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.643 Vali Acc: 0.432 Test Loss: 3.643 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.037294864654541
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.864 Vali Acc: 0.486 Test Loss: 3.864 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.234917163848877
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.467 Vali Acc: 0.459 Test Loss: 4.467 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.157459020614624
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.764 Vali Acc: 0.486 Test Loss: 3.764 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.064671277999878
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.975 Vali Acc: 0.486 Test Loss: 4.975 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0765955448150635
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.338 Vali Acc: 0.365 Test Loss: 5.338 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 676100
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9065494537353516
Epoch: 1, Steps: 10 | Train Loss: 1.599 Vali Loss: 1.519 Vali Acc: 0.270 Test Loss: 1.519 Test Acc: 0.270
Validation loss decreased (inf --> -0.270255).  Saving model ...
Epoch: 2 cost time: 1.3259251117706299
Epoch: 2, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.422 Vali Acc: 0.446 Test Loss: 1.422 Test Acc: 0.446
Validation loss decreased (-0.270255 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 1.396996021270752
Epoch: 3, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
Validation loss decreased (-0.445932 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 1.4714808464050293
Epoch: 4, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.283 Vali Acc: 0.446 Test Loss: 1.283 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.350013256072998
Epoch: 5, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.417 Vali Acc: 0.500 Test Loss: 1.417 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3345966339111328
Epoch: 6, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.658 Vali Acc: 0.527 Test Loss: 1.658 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.435286283493042
Epoch: 7, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3303189277648926
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.658 Vali Acc: 0.514 Test Loss: 1.658 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3540124893188477
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.227 Vali Acc: 0.473 Test Loss: 2.227 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4584243297576904
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.017 Vali Acc: 0.459 Test Loss: 2.017 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6035058498382568
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.033 Vali Acc: 0.486 Test Loss: 2.033 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4156699180603027
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.062 Vali Acc: 0.514 Test Loss: 2.062 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3861308097839355
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.097 Vali Acc: 0.514 Test Loss: 2.097 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 472580
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.136072874069214
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.390 Vali Acc: 0.297 Test Loss: 1.390 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.3008756637573242
Epoch: 2, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
Validation loss decreased (-0.297283 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.2825450897216797
Epoch: 3, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.344308614730835
Epoch: 4, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.291428565979004
Epoch: 5, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.317 Vali Acc: 0.486 Test Loss: 1.317 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3312504291534424
Epoch: 6, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.271 Vali Acc: 0.527 Test Loss: 1.271 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 7 cost time: 1.3287110328674316
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.337 Vali Acc: 0.541 Test Loss: 1.337 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540527).  Saving model ...
Epoch: 8 cost time: 1.385422706604004
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.556 Vali Acc: 0.527 Test Loss: 1.556 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.377431869506836
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.510 Vali Acc: 0.568 Test Loss: 1.510 Test Acc: 0.568
Validation loss decreased (-0.540527 --> -0.567552).  Saving model ...
Epoch: 10 cost time: 1.3374712467193604
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.637 Vali Acc: 0.568 Test Loss: 1.637 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3521795272827148
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.716 Vali Acc: 0.541 Test Loss: 1.716 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2862937450408936
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.843 Vali Acc: 0.554 Test Loss: 1.843 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2621450424194336
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.759 Vali Acc: 0.527 Test Loss: 1.759 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2061786651611328
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.774 Vali Acc: 0.514 Test Loss: 1.774 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4667491912841797
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.813 Vali Acc: 0.541 Test Loss: 1.813 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2318577766418457
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.797 Vali Acc: 0.541 Test Loss: 1.797 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2035582065582275
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.527 Test Loss: 1.787 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.344440221786499
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.527 Test Loss: 1.799 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3951435089111328
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.527 Test Loss: 1.816 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 402180
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9403035640716553
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.468 Vali Acc: 0.230 Test Loss: 1.468 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.2661712169647217
Epoch: 2, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.314 Vali Acc: 0.365 Test Loss: 1.314 Test Acc: 0.365
Validation loss decreased (-0.229715 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.3208038806915283
Epoch: 3, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.281 Vali Acc: 0.432 Test Loss: 1.281 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.537428617477417
Epoch: 4, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.235 Vali Acc: 0.446 Test Loss: 1.235 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.355513572692871
Epoch: 5, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.300 Vali Acc: 0.514 Test Loss: 1.300 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.3229529857635498
Epoch: 6, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.276 Vali Acc: 0.486 Test Loss: 1.276 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3916192054748535
Epoch: 7, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.490 Vali Acc: 0.446 Test Loss: 1.490 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.277437448501587
Epoch: 8, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.502 Vali Acc: 0.541 Test Loss: 1.502 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540526).  Saving model ...
Epoch: 9 cost time: 1.2366015911102295
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.606 Vali Acc: 0.500 Test Loss: 1.606 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4465689659118652
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.652 Vali Acc: 0.500 Test Loss: 1.652 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3471457958221436
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.661 Vali Acc: 0.581 Test Loss: 1.661 Test Acc: 0.581
Validation loss decreased (-0.540526 --> -0.581064).  Saving model ...
Epoch: 12 cost time: 1.3446033000946045
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.673 Vali Acc: 0.541 Test Loss: 1.673 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3036456108093262
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.720 Vali Acc: 0.541 Test Loss: 1.720 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3159773349761963
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.734 Vali Acc: 0.541 Test Loss: 1.734 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3115918636322021
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.744 Vali Acc: 0.554 Test Loss: 1.744 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.335965633392334
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.756 Vali Acc: 0.527 Test Loss: 1.756 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2397422790527344
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.765 Vali Acc: 0.554 Test Loss: 1.765 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.10886812210083
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.766 Vali Acc: 0.541 Test Loss: 1.766 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3177447319030762
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.796 Vali Acc: 0.541 Test Loss: 1.796 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.40557861328125
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.554 Test Loss: 1.808 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2937750816345215
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.812 Vali Acc: 0.541 Test Loss: 1.812 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 372740
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9113337993621826
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.455 Vali Acc: 0.284 Test Loss: 1.455 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.4540996551513672
Epoch: 2, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.294 Vali Acc: 0.392 Test Loss: 1.294 Test Acc: 0.392
Validation loss decreased (-0.283769 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.245873212814331
Epoch: 3, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2166352272033691
Epoch: 4, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.181 Vali Acc: 0.459 Test Loss: 1.181 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4780893325805664
Epoch: 5, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.2606348991394043
Epoch: 6, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.263115406036377
Epoch: 7, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3899693489074707
Epoch: 8, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.235 Vali Acc: 0.514 Test Loss: 1.235 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3483867645263672
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2299251556396484
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.342 Vali Acc: 0.527 Test Loss: 1.342 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4309444427490234
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.428 Vali Acc: 0.568 Test Loss: 1.428 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567553).  Saving model ...
Epoch: 12 cost time: 1.264533519744873
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.516 Vali Acc: 0.554 Test Loss: 1.516 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2151463031768799
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.518 Vali Acc: 0.527 Test Loss: 1.518 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5038261413574219
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.522 Vali Acc: 0.554 Test Loss: 1.522 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.377079725265503
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.573 Vali Acc: 0.554 Test Loss: 1.573 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3119451999664307
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.609 Vali Acc: 0.527 Test Loss: 1.609 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.208888292312622
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.607 Vali Acc: 0.568 Test Loss: 1.607 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0664494037628174
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.621 Vali Acc: 0.568 Test Loss: 1.621 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1057801246643066
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.640 Vali Acc: 0.554 Test Loss: 1.640 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.250312089920044
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.648 Vali Acc: 0.554 Test Loss: 1.648 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2068779468536377
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.660 Vali Acc: 0.568 Test Loss: 1.660 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 339460
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8079700469970703
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.419 Vali Acc: 0.257 Test Loss: 1.419 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.346470832824707
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.292 Vali Acc: 0.446 Test Loss: 1.292 Test Acc: 0.446
Validation loss decreased (-0.256743 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.2259438037872314
Epoch: 3, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2618129253387451
Epoch: 4, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.137 Vali Acc: 0.486 Test Loss: 1.137 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2204248905181885
Epoch: 5, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.1369783878326416
Epoch: 6, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.1594221591949463
Epoch: 7, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.1867311000823975
Epoch: 8, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.135 Vali Acc: 0.608 Test Loss: 1.135 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.1012239456176758
Epoch: 9, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.154 Vali Acc: 0.581 Test Loss: 1.154 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2570161819458008
Epoch: 10, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.207 Vali Acc: 0.595 Test Loss: 1.207 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1738784313201904
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.219999074935913
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.361 Vali Acc: 0.635 Test Loss: 1.361 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635122).  Saving model ...
Epoch: 13 cost time: 1.255600929260254
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.372 Vali Acc: 0.541 Test Loss: 1.372 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3488283157348633
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.429 Vali Acc: 0.568 Test Loss: 1.429 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2966501712799072
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.441 Vali Acc: 0.581 Test Loss: 1.441 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1721446514129639
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.438 Vali Acc: 0.581 Test Loss: 1.438 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2763068675994873
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.456 Vali Acc: 0.581 Test Loss: 1.456 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1645514965057373
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.471 Vali Acc: 0.554 Test Loss: 1.471 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2025413513183594
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.503 Vali Acc: 0.541 Test Loss: 1.503 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.354792833328247
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.524 Vali Acc: 0.527 Test Loss: 1.524 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2003273963928223
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.544 Vali Acc: 0.568 Test Loss: 1.544 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1505162715911865
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.536 Vali Acc: 0.554 Test Loss: 1.536 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 326660
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.906508207321167
Epoch: 1, Steps: 10 | Train Loss: 1.559 Vali Loss: 1.447 Vali Acc: 0.216 Test Loss: 1.447 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.1725568771362305
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (-0.216202 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.2506017684936523
Epoch: 3, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.257 Vali Acc: 0.446 Test Loss: 1.257 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.1701710224151611
Epoch: 4, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.231 Vali Acc: 0.446 Test Loss: 1.231 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.2232778072357178
Epoch: 5, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1453964710235596
Epoch: 6, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.197 Vali Acc: 0.459 Test Loss: 1.197 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.2239408493041992
Epoch: 7, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.265 Vali Acc: 0.432 Test Loss: 1.265 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1572740077972412
Epoch: 8, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.2073321342468262
Epoch: 9, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.290 Vali Acc: 0.554 Test Loss: 1.290 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 1.1568603515625
Epoch: 10, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1815037727355957
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.345 Vali Acc: 0.568 Test Loss: 1.345 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567554).  Saving model ...
Epoch: 12 cost time: 1.0976414680480957
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.392 Vali Acc: 0.554 Test Loss: 1.392 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0965206623077393
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.444 Vali Acc: 0.554 Test Loss: 1.444 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.151214361190796
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.509 Vali Acc: 0.541 Test Loss: 1.509 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.178107500076294
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.549 Vali Acc: 0.568 Test Loss: 1.549 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2899107933044434
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.605 Vali Acc: 0.595 Test Loss: 1.605 Test Acc: 0.595
Validation loss decreased (-0.567554 --> -0.594579).  Saving model ...
Epoch: 17 cost time: 1.2922782897949219
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.666 Vali Acc: 0.541 Test Loss: 1.666 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1136806011199951
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.671 Vali Acc: 0.541 Test Loss: 1.671 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2185609340667725
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.689 Vali Acc: 0.554 Test Loss: 1.689 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1605603694915771
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.720 Vali Acc: 0.541 Test Loss: 1.720 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1444528102874756
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.743 Vali Acc: 0.554 Test Loss: 1.743 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.272386074066162
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.740 Vali Acc: 0.554 Test Loss: 1.740 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.123575210571289
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.761 Vali Acc: 0.541 Test Loss: 1.761 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.257624864578247
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.776 Vali Acc: 0.554 Test Loss: 1.776 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.250288486480713
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.779 Vali Acc: 0.554 Test Loss: 1.779 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1787374019622803
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.799 Vali Acc: 0.554 Test Loss: 1.799 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 318980
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7177767753601074
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.310 Vali Acc: 0.419 Test Loss: 1.310 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.7955427169799805
Epoch: 2, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.118 Vali Acc: 0.473 Test Loss: 1.118 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472962).  Saving model ...
Epoch: 3 cost time: 1.6619770526885986
Epoch: 3, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.442 Vali Acc: 0.459 Test Loss: 1.442 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8408408164978027
Epoch: 4, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.766 Vali Acc: 0.500 Test Loss: 1.766 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 1.646951675415039
Epoch: 5, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.907 Vali Acc: 0.554 Test Loss: 1.907 Test Acc: 0.554
Validation loss decreased (-0.499982 --> -0.554035).  Saving model ...
Epoch: 6 cost time: 1.6705169677734375
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.964 Vali Acc: 0.473 Test Loss: 1.964 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.762138843536377
Epoch: 7, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.018 Vali Acc: 0.514 Test Loss: 3.018 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8487427234649658
Epoch: 8, Steps: 10 | Train Loss: 0.140 Vali Loss: 2.889 Vali Acc: 0.459 Test Loss: 2.889 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7549357414245605
Epoch: 9, Steps: 10 | Train Loss: 0.090 Vali Loss: 2.548 Vali Acc: 0.473 Test Loss: 2.548 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7709875106811523
Epoch: 10, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.859 Vali Acc: 0.486 Test Loss: 3.859 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.836735725402832
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.588 Vali Acc: 0.419 Test Loss: 3.588 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8531243801116943
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.602 Vali Acc: 0.432 Test Loss: 3.602 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6931111812591553
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.300 Vali Acc: 0.405 Test Loss: 4.300 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.738957166671753
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.540 Vali Acc: 0.446 Test Loss: 3.540 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.559464931488037
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.205 Vali Acc: 0.459 Test Loss: 5.205 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 610308
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.515676498413086
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.270 Vali Acc: 0.473 Test Loss: 1.270 Test Acc: 0.473
Validation loss decreased (inf --> -0.472960).  Saving model ...
Epoch: 2 cost time: 1.6034090518951416
Epoch: 2, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.231 Vali Acc: 0.527 Test Loss: 1.231 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 1.4168453216552734
Epoch: 3, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.165 Vali Acc: 0.486 Test Loss: 1.165 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5841374397277832
Epoch: 4, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6646900177001953
Epoch: 5, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.551 Vali Acc: 0.486 Test Loss: 1.551 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6235191822052002
Epoch: 6, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.659 Vali Acc: 0.527 Test Loss: 1.659 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6041109561920166
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.493 Vali Acc: 0.500 Test Loss: 1.493 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4487571716308594
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.904 Vali Acc: 0.432 Test Loss: 1.904 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.716116189956665
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.777 Vali Acc: 0.514 Test Loss: 1.777 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.665602207183838
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.808 Vali Acc: 0.500 Test Loss: 1.808 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4607601165771484
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.940 Vali Acc: 0.527 Test Loss: 1.940 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4686496257781982
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.110 Vali Acc: 0.514 Test Loss: 2.110 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 406788
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.224231004714966
Epoch: 1, Steps: 10 | Train Loss: 1.528 Vali Loss: 1.333 Vali Acc: 0.338 Test Loss: 1.333 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 1.4353716373443604
Epoch: 2, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.192 Vali Acc: 0.459 Test Loss: 1.192 Test Acc: 0.459
Validation loss decreased (-0.337825 --> -0.459448).  Saving model ...
Epoch: 3 cost time: 1.5155847072601318
Epoch: 3, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.171 Vali Acc: 0.473 Test Loss: 1.171 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.9434812068939209
Epoch: 4, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.125 Vali Acc: 0.459 Test Loss: 1.125 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1851189136505127
Epoch: 5, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.166 Vali Acc: 0.568 Test Loss: 1.166 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.2693002223968506
Epoch: 6, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.151 Vali Acc: 0.554 Test Loss: 1.151 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2878165245056152
Epoch: 7, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.244 Vali Acc: 0.554 Test Loss: 1.244 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2127618789672852
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.342 Vali Acc: 0.554 Test Loss: 1.342 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3865597248077393
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.558 Vali Acc: 0.514 Test Loss: 1.558 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1164557933807373
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.509 Vali Acc: 0.527 Test Loss: 1.509 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2587883472442627
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.614 Vali Acc: 0.554 Test Loss: 1.614 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2225449085235596
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.649 Vali Acc: 0.541 Test Loss: 1.649 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3874545097351074
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.634 Vali Acc: 0.554 Test Loss: 1.634 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.402977705001831
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.653 Vali Acc: 0.541 Test Loss: 1.653 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6803088188171387
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.527 Test Loss: 1.662 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 336388
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.122807264328003
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.427 Vali Acc: 0.311 Test Loss: 1.427 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.2900495529174805
Epoch: 2, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.236 Vali Acc: 0.473 Test Loss: 1.236 Test Acc: 0.473
Validation loss decreased (-0.310797 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.0311920642852783
Epoch: 3, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.383129596710205
Epoch: 4, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.190 Vali Acc: 0.473 Test Loss: 1.190 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1662580966949463
Epoch: 5, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.212 Vali Acc: 0.459 Test Loss: 1.212 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5797498226165771
Epoch: 6, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.379641056060791
Epoch: 7, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.463 Vali Acc: 0.514 Test Loss: 1.463 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513499).  Saving model ...
Epoch: 8 cost time: 1.4779610633850098
Epoch: 8, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.395 Vali Acc: 0.514 Test Loss: 1.395 Test Acc: 0.514
Validation loss decreased (-0.513499 --> -0.513500).  Saving model ...
Epoch: 9 cost time: 1.3634302616119385
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.570 Vali Acc: 0.514 Test Loss: 1.570 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2418017387390137
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.567 Vali Acc: 0.554 Test Loss: 1.567 Test Acc: 0.554
Validation loss decreased (-0.513500 --> -0.554038).  Saving model ...
Epoch: 11 cost time: 1.382727861404419
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.568 Vali Acc: 0.568 Test Loss: 1.568 Test Acc: 0.568
Validation loss decreased (-0.554038 --> -0.567552).  Saving model ...
Epoch: 12 cost time: 1.2746326923370361
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.654 Vali Acc: 0.581 Test Loss: 1.654 Test Acc: 0.581
Validation loss decreased (-0.567552 --> -0.581065).  Saving model ...
Epoch: 13 cost time: 1.4109065532684326
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.639 Vali Acc: 0.568 Test Loss: 1.639 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3856043815612793
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.694 Vali Acc: 0.541 Test Loss: 1.694 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4428446292877197
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.715 Vali Acc: 0.554 Test Loss: 1.715 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4038441181182861
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.527 Test Loss: 1.720 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4709994792938232
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.738 Vali Acc: 0.568 Test Loss: 1.738 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4815921783447266
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.764 Vali Acc: 0.541 Test Loss: 1.764 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.304231882095337
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.783 Vali Acc: 0.568 Test Loss: 1.783 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3780956268310547
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.793 Vali Acc: 0.554 Test Loss: 1.793 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2942631244659424
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.568 Test Loss: 1.808 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3035986423492432
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.812 Vali Acc: 0.541 Test Loss: 1.812 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 306948
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9376800060272217
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.377 Vali Acc: 0.297 Test Loss: 1.377 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.2106008529663086
Epoch: 2, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.282 Vali Acc: 0.432 Test Loss: 1.282 Test Acc: 0.432
Validation loss decreased (-0.297284 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.3097560405731201
Epoch: 3, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 1.5087425708770752
Epoch: 4, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.159 Vali Acc: 0.486 Test Loss: 1.159 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4295692443847656
Epoch: 5, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.1237342357635498
Epoch: 6, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2813196182250977
Epoch: 7, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.186 Vali Acc: 0.568 Test Loss: 1.186 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.2560644149780273
Epoch: 8, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0944652557373047
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.284 Vali Acc: 0.541 Test Loss: 1.284 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2259914875030518
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.406 Vali Acc: 0.514 Test Loss: 1.406 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3789067268371582
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.379 Vali Acc: 0.541 Test Loss: 1.379 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3910572528839111
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.407 Vali Acc: 0.568 Test Loss: 1.407 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4112098217010498
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.495 Vali Acc: 0.568 Test Loss: 1.495 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3430960178375244
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.511 Vali Acc: 0.568 Test Loss: 1.511 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4726111888885498
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.524 Vali Acc: 0.568 Test Loss: 1.524 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.454392910003662
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.574 Vali Acc: 0.541 Test Loss: 1.574 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4470276832580566
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.556 Vali Acc: 0.541 Test Loss: 1.556 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 273668
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1550865173339844
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.462 Vali Acc: 0.297 Test Loss: 1.462 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.0746493339538574
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.320 Vali Acc: 0.392 Test Loss: 1.320 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.2474489212036133
Epoch: 3, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.3647716045379639
Epoch: 4, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.355276107788086
Epoch: 5, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.103 Vali Acc: 0.514 Test Loss: 1.103 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2800235748291016
Epoch: 6, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.338557481765747
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.116 Vali Acc: 0.581 Test Loss: 1.116 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 1.3481011390686035
Epoch: 8, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.261821985244751
Epoch: 9, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.162240743637085
Epoch: 10, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.224 Vali Acc: 0.554 Test Loss: 1.224 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2883546352386475
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.259 Vali Acc: 0.568 Test Loss: 1.259 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2445297241210938
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2443904876708984
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.290 Vali Acc: 0.554 Test Loss: 1.290 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2075870037078857
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.275 Vali Acc: 0.608 Test Loss: 1.275 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608095).  Saving model ...
Epoch: 15 cost time: 1.2740228176116943
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.327 Vali Acc: 0.581 Test Loss: 1.327 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3450219631195068
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.382 Vali Acc: 0.568 Test Loss: 1.382 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1393625736236572
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.417 Vali Acc: 0.581 Test Loss: 1.417 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3135318756103516
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.445 Vali Acc: 0.554 Test Loss: 1.445 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1535263061523438
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.470 Vali Acc: 0.568 Test Loss: 1.470 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.060676097869873
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.476 Vali Acc: 0.595 Test Loss: 1.476 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.401655912399292
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.489 Vali Acc: 0.595 Test Loss: 1.489 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9792532920837402
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.492 Vali Acc: 0.595 Test Loss: 1.492 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1703977584838867
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.508 Vali Acc: 0.595 Test Loss: 1.508 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2897849082946777
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.536 Vali Acc: 0.568 Test Loss: 1.536 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 260868
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9169235229492188
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.377 Vali Acc: 0.365 Test Loss: 1.377 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.3700909614562988
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.302 Vali Acc: 0.378 Test Loss: 1.302 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.1151068210601807
Epoch: 3, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.234 Vali Acc: 0.405 Test Loss: 1.234 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.9275896549224854
Epoch: 4, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.189 Vali Acc: 0.473 Test Loss: 1.189 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.1078484058380127
Epoch: 5, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1944737434387207
Epoch: 6, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.9924211502075195
Epoch: 7, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.167 Vali Acc: 0.581 Test Loss: 1.167 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 8 cost time: 1.02775239944458
Epoch: 8, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.203 Vali Acc: 0.568 Test Loss: 1.203 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1114511489868164
Epoch: 9, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.188 Vali Acc: 0.541 Test Loss: 1.188 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.346170425415039
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.313 Vali Acc: 0.514 Test Loss: 1.313 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2920565605163574
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.307 Vali Acc: 0.554 Test Loss: 1.307 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2106468677520752
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.362 Vali Acc: 0.568 Test Loss: 1.362 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4142472743988037
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.453 Vali Acc: 0.541 Test Loss: 1.453 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1276066303253174
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.540 Vali Acc: 0.581 Test Loss: 1.540 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2584686279296875
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.546 Vali Acc: 0.568 Test Loss: 1.546 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1538527011871338
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.566 Vali Acc: 0.554 Test Loss: 1.566 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0210387706756592
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.587 Vali Acc: 0.541 Test Loss: 1.587 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 253188
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2528977394104004
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.465 Vali Acc: 0.284 Test Loss: 1.465 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.6431388854980469
Epoch: 2, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.282 Vali Acc: 0.459 Test Loss: 1.282 Test Acc: 0.459
Validation loss decreased (-0.283769 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.7120471000671387
Epoch: 3, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.755 Vali Acc: 0.446 Test Loss: 1.755 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5864825248718262
Epoch: 4, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.746 Vali Acc: 0.432 Test Loss: 1.746 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4627256393432617
Epoch: 5, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.796 Vali Acc: 0.527 Test Loss: 1.796 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527009).  Saving model ...
Epoch: 6 cost time: 1.5687029361724854
Epoch: 6, Steps: 10 | Train Loss: 0.119 Vali Loss: 2.435 Vali Acc: 0.473 Test Loss: 2.435 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4617424011230469
Epoch: 7, Steps: 10 | Train Loss: 0.101 Vali Loss: 2.510 Vali Acc: 0.459 Test Loss: 2.510 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5047082901000977
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.317 Vali Acc: 0.514 Test Loss: 2.317 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5232255458831787
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.656 Vali Acc: 0.514 Test Loss: 2.656 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3993027210235596
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.064 Vali Acc: 0.486 Test Loss: 3.064 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5538506507873535
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.156 Vali Acc: 0.446 Test Loss: 4.156 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6763505935668945
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.380 Vali Acc: 0.514 Test Loss: 3.380 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5864317417144775
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.586 Vali Acc: 0.486 Test Loss: 3.586 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.799722671508789
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.575 Vali Acc: 0.459 Test Loss: 4.575 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4580888748168945
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.175 Vali Acc: 0.527 Test Loss: 4.175 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 577412
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1412370204925537
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.455 Vali Acc: 0.392 Test Loss: 1.455 Test Acc: 0.392
Validation loss decreased (inf --> -0.391877).  Saving model ...
Epoch: 2 cost time: 1.3741607666015625
Epoch: 2, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.290 Vali Acc: 0.405 Test Loss: 1.290 Test Acc: 0.405
Validation loss decreased (-0.391877 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.3201861381530762
Epoch: 3, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.319 Vali Acc: 0.459 Test Loss: 1.319 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 1.2858142852783203
Epoch: 4, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.443 Vali Acc: 0.405 Test Loss: 1.443 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3673288822174072
Epoch: 5, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.373 Vali Acc: 0.486 Test Loss: 1.373 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486473).  Saving model ...
Epoch: 6 cost time: 1.3208072185516357
Epoch: 6, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.395 Vali Acc: 0.514 Test Loss: 1.395 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513500).  Saving model ...
Epoch: 7 cost time: 1.3204941749572754
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.857 Vali Acc: 0.514 Test Loss: 1.857 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4641294479370117
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.993 Vali Acc: 0.514 Test Loss: 1.993 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.485896348953247
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.109 Vali Acc: 0.486 Test Loss: 2.109 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4825537204742432
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.102 Vali Acc: 0.541 Test Loss: 2.102 Test Acc: 0.541
Validation loss decreased (-0.513500 --> -0.540520).  Saving model ...
Epoch: 11 cost time: 1.2732644081115723
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.098 Vali Acc: 0.527 Test Loss: 2.098 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.358856439590454
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.214 Vali Acc: 0.500 Test Loss: 2.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3151822090148926
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.601 Vali Acc: 0.473 Test Loss: 2.601 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.561800241470337
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.490 Vali Acc: 0.514 Test Loss: 2.490 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4256541728973389
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.510 Vali Acc: 0.527 Test Loss: 2.510 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5791983604431152
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.584 Vali Acc: 0.486 Test Loss: 2.584 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.306656837463379
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.501 Vali Acc: 0.473 Test Loss: 2.501 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6841754913330078
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.469 Vali Acc: 0.473 Test Loss: 2.469 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5661678314208984
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.483 Vali Acc: 0.500 Test Loss: 2.483 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6353309154510498
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.493 Vali Acc: 0.500 Test Loss: 2.493 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 373892
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2062175273895264
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.365 Vali Acc: 0.257 Test Loss: 1.365 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.3412225246429443
Epoch: 2, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.235 Vali Acc: 0.432 Test Loss: 1.235 Test Acc: 0.432
Validation loss decreased (-0.256743 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.320159912109375
Epoch: 3, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540530).  Saving model ...
Epoch: 4 cost time: 1.3622965812683105
Epoch: 4, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.186 Vali Acc: 0.541 Test Loss: 1.186 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.512990951538086
Epoch: 5, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3846113681793213
Epoch: 6, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.288 Vali Acc: 0.527 Test Loss: 1.288 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4167122840881348
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.481 Vali Acc: 0.541 Test Loss: 1.481 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3807144165039062
Epoch: 8, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.545 Vali Acc: 0.554 Test Loss: 1.545 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554039).  Saving model ...
Epoch: 9 cost time: 1.508305311203003
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.646 Vali Acc: 0.541 Test Loss: 1.646 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4418139457702637
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.755 Vali Acc: 0.581 Test Loss: 1.755 Test Acc: 0.581
Validation loss decreased (-0.554039 --> -0.581064).  Saving model ...
Epoch: 11 cost time: 1.422703504562378
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.686 Vali Acc: 0.541 Test Loss: 1.686 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4682209491729736
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.805 Vali Acc: 0.554 Test Loss: 1.805 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4473686218261719
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.714 Vali Acc: 0.568 Test Loss: 1.714 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3586812019348145
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.703 Vali Acc: 0.595 Test Loss: 1.703 Test Acc: 0.595
Validation loss decreased (-0.581064 --> -0.594578).  Saving model ...
Epoch: 15 cost time: 1.4721722602844238
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.700 Vali Acc: 0.595 Test Loss: 1.700 Test Acc: 0.595
Validation loss decreased (-0.594578 --> -0.594578).  Saving model ...
Epoch: 16 cost time: 1.4034039974212646
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.735 Vali Acc: 0.581 Test Loss: 1.735 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3777670860290527
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.744 Vali Acc: 0.581 Test Loss: 1.744 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4465179443359375
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.751 Vali Acc: 0.581 Test Loss: 1.751 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5291681289672852
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.756 Vali Acc: 0.568 Test Loss: 1.756 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3575987815856934
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.568 Test Loss: 1.776 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5180704593658447
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.568 Test Loss: 1.790 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5791995525360107
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.581 Test Loss: 1.794 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4642302989959717
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.806 Vali Acc: 0.568 Test Loss: 1.806 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.525214672088623
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.554 Test Loss: 1.802 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3214008808135986
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.568 Test Loss: 1.794 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 303492
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.932591676712036
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.435 Vali Acc: 0.257 Test Loss: 1.435 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.4486680030822754
Epoch: 2, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.236 Vali Acc: 0.446 Test Loss: 1.236 Test Acc: 0.446
Validation loss decreased (-0.256742 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 1.5666663646697998
Epoch: 3, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.197 Vali Acc: 0.365 Test Loss: 1.197 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.502591848373413
Epoch: 4, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.163 Vali Acc: 0.446 Test Loss: 1.163 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.2852447032928467
Epoch: 5, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.210 Vali Acc: 0.473 Test Loss: 1.210 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.5957767963409424
Epoch: 6, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.269 Vali Acc: 0.514 Test Loss: 1.269 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.4030652046203613
Epoch: 7, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.341 Vali Acc: 0.459 Test Loss: 1.341 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5037431716918945
Epoch: 8, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.408 Vali Acc: 0.554 Test Loss: 1.408 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554040).  Saving model ...
Epoch: 9 cost time: 1.460252046585083
Epoch: 9, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3743886947631836
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.598 Vali Acc: 0.527 Test Loss: 1.598 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5632481575012207
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.593 Vali Acc: 0.486 Test Loss: 1.593 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4336533546447754
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.697 Vali Acc: 0.527 Test Loss: 1.697 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5672829151153564
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.646 Vali Acc: 0.500 Test Loss: 1.646 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5566883087158203
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.663 Vali Acc: 0.514 Test Loss: 1.663 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5900111198425293
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.700 Vali Acc: 0.500 Test Loss: 1.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.702411413192749
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.744 Vali Acc: 0.527 Test Loss: 1.744 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7536730766296387
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.755 Vali Acc: 0.527 Test Loss: 1.755 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7506966590881348
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.747 Vali Acc: 0.527 Test Loss: 1.747 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 274052
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1024303436279297
Epoch: 1, Steps: 10 | Train Loss: 1.557 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.7561650276184082
Epoch: 2, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.299 Vali Acc: 0.324 Test Loss: 1.299 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.2953181266784668
Epoch: 3, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
Validation loss decreased (-0.324311 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 1.3610436916351318
Epoch: 4, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.134 Vali Acc: 0.486 Test Loss: 1.134 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5273709297180176
Epoch: 5, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.116 Vali Acc: 0.486 Test Loss: 1.116 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.305253505706787
Epoch: 6, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3682358264923096
Epoch: 7, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.157 Vali Acc: 0.581 Test Loss: 1.157 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 1.3958749771118164
Epoch: 8, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2748570442199707
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.235 Vali Acc: 0.541 Test Loss: 1.235 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.722815990447998
Epoch: 10, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.349 Vali Acc: 0.568 Test Loss: 1.349 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3190717697143555
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.415 Vali Acc: 0.554 Test Loss: 1.415 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.321197748184204
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.462 Vali Acc: 0.527 Test Loss: 1.462 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3324213027954102
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.450 Vali Acc: 0.527 Test Loss: 1.450 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3044812679290771
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.468 Vali Acc: 0.554 Test Loss: 1.468 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3667452335357666
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.531 Vali Acc: 0.568 Test Loss: 1.531 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3353629112243652
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.549 Vali Acc: 0.554 Test Loss: 1.549 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4625358581542969
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.539 Vali Acc: 0.554 Test Loss: 1.539 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 240772
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7854504585266113
Epoch: 1, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.359680414199829
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.332 Vali Acc: 0.378 Test Loss: 1.332 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.188889980316162
Epoch: 3, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.232 Vali Acc: 0.405 Test Loss: 1.232 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.2810239791870117
Epoch: 4, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
Validation loss decreased (-0.405393 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.1752173900604248
Epoch: 5, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 1.165302038192749
Epoch: 6, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.216956377029419
Epoch: 7, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.138 Vali Acc: 0.554 Test Loss: 1.138 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2630794048309326
Epoch: 8, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.29477858543396
Epoch: 9, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3744628429412842
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.148 Vali Acc: 0.568 Test Loss: 1.148 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3925631046295166
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.261 Vali Acc: 0.554 Test Loss: 1.261 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3033268451690674
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.305 Vali Acc: 0.554 Test Loss: 1.305 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7608835697174072
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.316 Vali Acc: 0.541 Test Loss: 1.316 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4997906684875488
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.330 Vali Acc: 0.568 Test Loss: 1.330 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6755492687225342
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.389 Vali Acc: 0.568 Test Loss: 1.389 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5193703174591064
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.401 Vali Acc: 0.581 Test Loss: 1.401 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.78896164894104
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.439 Vali Acc: 0.568 Test Loss: 1.439 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.471750259399414
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.465 Vali Acc: 0.581 Test Loss: 1.465 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 227972
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.106696128845215
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.466 Vali Acc: 0.257 Test Loss: 1.466 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.5019361972808838
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.403 Vali Acc: 0.324 Test Loss: 1.403 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.2796070575714111
Epoch: 3, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.5090000629425049
Epoch: 4, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.220 Vali Acc: 0.405 Test Loss: 1.220 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.3226289749145508
Epoch: 5, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.166 Vali Acc: 0.446 Test Loss: 1.166 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.5982718467712402
Epoch: 6, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.198 Vali Acc: 0.432 Test Loss: 1.198 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3553242683410645
Epoch: 7, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.5275874137878418
Epoch: 8, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4717872142791748
Epoch: 9, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.247 Vali Acc: 0.514 Test Loss: 1.247 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 1.4906210899353027
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.341 Vali Acc: 0.514 Test Loss: 1.341 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7417802810668945
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.329 Vali Acc: 0.514 Test Loss: 1.329 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3142220973968506
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.354 Vali Acc: 0.527 Test Loss: 1.354 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527013).  Saving model ...
Epoch: 13 cost time: 1.5563228130340576
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.393651008605957
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.462 Vali Acc: 0.527 Test Loss: 1.462 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5988543033599854
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.555 Vali Acc: 0.554 Test Loss: 1.555 Test Acc: 0.554
Validation loss decreased (-0.527013 --> -0.554039).  Saving model ...
Epoch: 16 cost time: 1.4654569625854492
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.583 Vali Acc: 0.554 Test Loss: 1.583 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5841915607452393
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.599 Vali Acc: 0.541 Test Loss: 1.599 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3188433647155762
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.614 Vali Acc: 0.527 Test Loss: 1.614 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5060851573944092
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.643 Vali Acc: 0.514 Test Loss: 1.643 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1992518901824951
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.671 Vali Acc: 0.486 Test Loss: 1.671 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.446531057357788
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.714 Vali Acc: 0.514 Test Loss: 1.714 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.262000322341919
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.751 Vali Acc: 0.514 Test Loss: 1.751 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2670633792877197
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.769 Vali Acc: 0.527 Test Loss: 1.769 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.325209379196167
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.752 Vali Acc: 0.527 Test Loss: 1.752 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2018282413482666
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.755 Vali Acc: 0.527 Test Loss: 1.755 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm128_nh16_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 220292
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4862372875213623
Epoch: 1, Steps: 10 | Train Loss: 1.523 Vali Loss: 1.390 Vali Acc: 0.392 Test Loss: 1.390 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.8271217346191406
Epoch: 2, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.349 Vali Acc: 0.419 Test Loss: 1.349 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.9755825996398926
Epoch: 3, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.323 Vali Acc: 0.527 Test Loss: 1.323 Test Acc: 0.527
Validation loss decreased (-0.418905 --> -0.527014).  Saving model ...
Epoch: 4 cost time: 1.6143934726715088
Epoch: 4, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.096336603164673
Epoch: 5, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.326 Vali Acc: 0.595 Test Loss: 1.326 Test Acc: 0.595
Validation loss decreased (-0.527014 --> -0.594581).  Saving model ...
Epoch: 6 cost time: 2.032459259033203
Epoch: 6, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.792 Vali Acc: 0.486 Test Loss: 1.792 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7966804504394531
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.738 Vali Acc: 0.514 Test Loss: 1.738 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9895596504211426
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.820 Vali Acc: 0.459 Test Loss: 1.820 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9343323707580566
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.013 Vali Acc: 0.446 Test Loss: 2.013 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7292912006378174
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.933 Vali Acc: 0.473 Test Loss: 1.933 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0427324771881104
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.930 Vali Acc: 0.459 Test Loss: 1.930 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.758849859237671
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.092 Vali Acc: 0.473 Test Loss: 2.092 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7381830215454102
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.013 Vali Acc: 0.473 Test Loss: 2.013 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9313862323760986
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.010 Vali Acc: 0.459 Test Loss: 2.010 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8020124435424805
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.035 Vali Acc: 0.486 Test Loss: 2.035 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 305540
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.596944570541382
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.480 Vali Acc: 0.162 Test Loss: 1.480 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 1.6576249599456787
Epoch: 2, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.360 Vali Acc: 0.284 Test Loss: 1.360 Test Acc: 0.284
Validation loss decreased (-0.162147 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.3084511756896973
Epoch: 3, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.251 Vali Acc: 0.419 Test Loss: 1.251 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.5325562953948975
Epoch: 4, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.274 Vali Acc: 0.473 Test Loss: 1.274 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.6535613536834717
Epoch: 5, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.325 Vali Acc: 0.486 Test Loss: 1.325 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486473).  Saving model ...
Epoch: 6 cost time: 1.505443811416626
Epoch: 6, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7673711776733398
Epoch: 7, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.259 Vali Acc: 0.486 Test Loss: 1.259 Test Acc: 0.486
Validation loss decreased (-0.486473 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.5595769882202148
Epoch: 8, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.467 Vali Acc: 0.473 Test Loss: 1.467 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4703807830810547
Epoch: 9, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.472 Vali Acc: 0.500 Test Loss: 1.472 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 1.7175679206848145
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
Validation loss decreased (-0.499985 --> -0.527011).  Saving model ...
Epoch: 11 cost time: 1.4941058158874512
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.574 Vali Acc: 0.514 Test Loss: 1.574 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4296693801879883
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.679 Vali Acc: 0.514 Test Loss: 1.679 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6243410110473633
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.737 Vali Acc: 0.486 Test Loss: 1.737 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.362588882446289
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.761 Vali Acc: 0.500 Test Loss: 1.761 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5966792106628418
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.758 Vali Acc: 0.514 Test Loss: 1.758 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8536555767059326
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.766 Vali Acc: 0.500 Test Loss: 1.766 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6875720024108887
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.747 Vali Acc: 0.500 Test Loss: 1.747 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.531646728515625
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.756 Vali Acc: 0.500 Test Loss: 1.756 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6429181098937988
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.514 Test Loss: 1.779 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6633310317993164
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.783 Vali Acc: 0.514 Test Loss: 1.783 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 203780
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1862123012542725
Epoch: 1, Steps: 10 | Train Loss: 1.569 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.3367412090301514
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.300 Vali Acc: 0.351 Test Loss: 1.300 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.3361625671386719
Epoch: 3, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.483447551727295
Epoch: 4, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.4735724925994873
Epoch: 5, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.3833539485931396
Epoch: 6, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.218 Vali Acc: 0.446 Test Loss: 1.218 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5358140468597412
Epoch: 7, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.5934600830078125
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.210 Vali Acc: 0.486 Test Loss: 1.210 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3395249843597412
Epoch: 9, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.3154575824737549
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.317 Vali Acc: 0.514 Test Loss: 1.317 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6043107509613037
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.379 Vali Acc: 0.541 Test Loss: 1.379 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5737364292144775
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.427 Vali Acc: 0.500 Test Loss: 1.427 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4166858196258545
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.462 Vali Acc: 0.486 Test Loss: 1.462 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4389936923980713
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.449 Vali Acc: 0.514 Test Loss: 1.449 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5537242889404297
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.491 Vali Acc: 0.514 Test Loss: 1.491 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.309065341949463
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.293806552886963
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.548 Vali Acc: 0.514 Test Loss: 1.548 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.523751974105835
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4437620639801025
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.605 Vali Acc: 0.514 Test Loss: 1.605 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 168580
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.052400588989258
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.3232839107513428
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.318 Vali Acc: 0.338 Test Loss: 1.318 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.3962230682373047
Epoch: 3, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.3161180019378662
Epoch: 4, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.3693950176239014
Epoch: 5, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.3089673519134521
Epoch: 6, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5399303436279297
Epoch: 7, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.3400092124938965
Epoch: 8, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.50498628616333
Epoch: 9, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4949243068695068
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3693857192993164
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4493663311004639
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.345 Vali Acc: 0.514 Test Loss: 1.345 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3409302234649658
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.366 Vali Acc: 0.514 Test Loss: 1.366 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5118775367736816
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5673744678497314
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.429 Vali Acc: 0.541 Test Loss: 1.429 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540526).  Saving model ...
Epoch: 16 cost time: 1.279517412185669
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.472 Vali Acc: 0.568 Test Loss: 1.472 Test Acc: 0.568
Validation loss decreased (-0.540526 --> -0.567553).  Saving model ...
Epoch: 17 cost time: 1.3629982471466064
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.454 Vali Acc: 0.541 Test Loss: 1.454 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.59254789352417
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7635629177093506
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.503 Vali Acc: 0.514 Test Loss: 1.503 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4809279441833496
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.521 Vali Acc: 0.541 Test Loss: 1.521 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3827733993530273
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.542 Vali Acc: 0.514 Test Loss: 1.542 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3103971481323242
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.548 Vali Acc: 0.514 Test Loss: 1.548 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5021696090698242
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.576 Vali Acc: 0.554 Test Loss: 1.576 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4542162418365479
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.588 Vali Acc: 0.527 Test Loss: 1.588 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4499711990356445
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.596 Vali Acc: 0.500 Test Loss: 1.596 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.410215139389038
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.600 Vali Acc: 0.527 Test Loss: 1.600 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 153860
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.124636650085449
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.392 Vali Acc: 0.324 Test Loss: 1.392 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.442627191543579
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.284 Vali Acc: 0.473 Test Loss: 1.284 Test Acc: 0.473
Validation loss decreased (-0.324310 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.4258122444152832
Epoch: 3, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.219 Vali Acc: 0.459 Test Loss: 1.219 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2943716049194336
Epoch: 4, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.2786540985107422
Epoch: 5, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.459656000137329
Epoch: 6, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.4298062324523926
Epoch: 7, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3943161964416504
Epoch: 8, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.3098912239074707
Epoch: 9, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.4918508529663086
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.146 Vali Acc: 0.568 Test Loss: 1.146 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3615131378173828
Epoch: 11, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.224 Vali Acc: 0.608 Test Loss: 1.224 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608096).  Saving model ...
Epoch: 12 cost time: 1.3293085098266602
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.205 Vali Acc: 0.554 Test Loss: 1.205 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3496489524841309
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3140368461608887
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.315 Vali Acc: 0.568 Test Loss: 1.315 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3829987049102783
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3167357444763184
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.398 Vali Acc: 0.568 Test Loss: 1.398 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9087896347045898
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.405 Vali Acc: 0.581 Test Loss: 1.405 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2406589984893799
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.420 Vali Acc: 0.581 Test Loss: 1.420 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4130101203918457
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.521385908126831
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.456 Vali Acc: 0.581 Test Loss: 1.456 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2667062282562256
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.493 Vali Acc: 0.581 Test Loss: 1.493 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 137220
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.873854637145996
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.9993479251861572
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.411 Vali Acc: 0.230 Test Loss: 1.411 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9829256534576416
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.350 Vali Acc: 0.351 Test Loss: 1.350 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.9493563175201416
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.251 Vali Acc: 0.405 Test Loss: 1.251 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 0.982607364654541
Epoch: 5, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.238 Vali Acc: 0.473 Test Loss: 1.238 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.9160401821136475
Epoch: 6, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.029297113418579
Epoch: 7, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.149 Vali Acc: 0.541 Test Loss: 1.149 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.0255327224731445
Epoch: 8, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.0003471374511719
Epoch: 9, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.149 Vali Acc: 0.581 Test Loss: 1.149 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 0.8927621841430664
Epoch: 10, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.132 Vali Acc: 0.554 Test Loss: 1.132 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0794413089752197
Epoch: 11, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0516009330749512
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9455101490020752
Epoch: 13, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.233 Vali Acc: 0.541 Test Loss: 1.233 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1550440788269043
Epoch: 14, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.261 Vali Acc: 0.527 Test Loss: 1.261 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9239068031311035
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.266 Vali Acc: 0.514 Test Loss: 1.266 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9284296035766602
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.333 Vali Acc: 0.554 Test Loss: 1.333 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9560344219207764
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.315 Vali Acc: 0.554 Test Loss: 1.315 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.024961233139038
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.329 Vali Acc: 0.554 Test Loss: 1.329 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0556755065917969
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.396 Vali Acc: 0.554 Test Loss: 1.396 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 130820
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.748687505722046
Epoch: 1, Steps: 10 | Train Loss: 1.516 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.0529227256774902
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.435 Vali Acc: 0.284 Test Loss: 1.435 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 1.0750763416290283
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.364 Vali Acc: 0.338 Test Loss: 1.364 Test Acc: 0.338
Validation loss decreased (-0.283769 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.014733076095581
Epoch: 4, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.311 Vali Acc: 0.405 Test Loss: 1.311 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.9825084209442139
Epoch: 5, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.9988198280334473
Epoch: 6, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.01023530960083
Epoch: 7, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.220 Vali Acc: 0.419 Test Loss: 1.220 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0625061988830566
Epoch: 8, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.226 Vali Acc: 0.419 Test Loss: 1.226 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1404945850372314
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.257 Vali Acc: 0.432 Test Loss: 1.257 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.023329734802246
Epoch: 10, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.049339771270752
Epoch: 11, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.264 Vali Acc: 0.486 Test Loss: 1.264 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0582315921783447
Epoch: 12, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.284 Vali Acc: 0.446 Test Loss: 1.284 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0385632514953613
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.301 Vali Acc: 0.473 Test Loss: 1.301 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.993344783782959
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.400 Vali Acc: 0.473 Test Loss: 1.400 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0872910022735596
Epoch: 15, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.414 Vali Acc: 0.473 Test Loss: 1.414 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9840307235717773
Epoch: 16, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.467 Vali Acc: 0.459 Test Loss: 1.467 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9952549934387207
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.529 Vali Acc: 0.446 Test Loss: 1.529 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9103538990020752
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.563 Vali Acc: 0.446 Test Loss: 1.563 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9623150825500488
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.551 Vali Acc: 0.432 Test Loss: 1.551 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9645066261291504
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.573 Vali Acc: 0.459 Test Loss: 1.573 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 126980
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.489227533340454
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.5565555095672607
Epoch: 2, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.232 Vali Acc: 0.554 Test Loss: 1.232 Test Acc: 0.554
Validation loss decreased (-0.243229 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 1.7012238502502441
Epoch: 3, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.315 Vali Acc: 0.486 Test Loss: 1.315 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5935611724853516
Epoch: 4, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.628 Vali Acc: 0.324 Test Loss: 1.628 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2650747299194336
Epoch: 5, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.367 Vali Acc: 0.486 Test Loss: 1.367 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3689393997192383
Epoch: 6, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.396 Vali Acc: 0.541 Test Loss: 1.396 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.699963092803955
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.545 Vali Acc: 0.554 Test Loss: 1.545 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.573876142501831
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.796 Vali Acc: 0.527 Test Loss: 1.796 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5379104614257812
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.206 Vali Acc: 0.473 Test Loss: 2.206 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6993014812469482
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.334 Vali Acc: 0.541 Test Loss: 2.334 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5208587646484375
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.483 Vali Acc: 0.419 Test Loss: 2.483 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6015944480895996
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.328 Vali Acc: 0.527 Test Loss: 2.328 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 272516
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1900086402893066
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.356 Vali Acc: 0.405 Test Loss: 1.356 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.3556270599365234
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.297 Vali Acc: 0.392 Test Loss: 1.297 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5602917671203613
Epoch: 3, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.2742531299591064
Epoch: 4, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.5244548320770264
Epoch: 5, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.5788207054138184
Epoch: 6, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.278 Vali Acc: 0.432 Test Loss: 1.278 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.322002649307251
Epoch: 7, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.267 Vali Acc: 0.541 Test Loss: 1.267 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 1.4306180477142334
Epoch: 8, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.324 Vali Acc: 0.554 Test Loss: 1.324 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 9 cost time: 1.7007238864898682
Epoch: 9, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.624 Vali Acc: 0.568 Test Loss: 1.624 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567551).  Saving model ...
Epoch: 10 cost time: 1.2209091186523438
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.517 Vali Acc: 0.541 Test Loss: 1.517 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5683276653289795
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.609 Vali Acc: 0.527 Test Loss: 1.609 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3313572406768799
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.638 Vali Acc: 0.527 Test Loss: 1.638 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9573466777801514
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.690 Vali Acc: 0.527 Test Loss: 1.690 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6291508674621582
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.697 Vali Acc: 0.527 Test Loss: 1.697 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3813371658325195
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.709 Vali Acc: 0.514 Test Loss: 1.709 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2996456623077393
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.733 Vali Acc: 0.527 Test Loss: 1.733 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6910400390625
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.742 Vali Acc: 0.500 Test Loss: 1.742 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.210782766342163
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.753 Vali Acc: 0.514 Test Loss: 1.753 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2975711822509766
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.772 Vali Acc: 0.527 Test Loss: 1.772 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 170756
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3180527687072754
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.461 Vali Acc: 0.230 Test Loss: 1.461 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.2264368534088135
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.366 Vali Acc: 0.378 Test Loss: 1.366 Test Acc: 0.378
Validation loss decreased (-0.229715 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.3172767162322998
Epoch: 3, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.252 Vali Acc: 0.459 Test Loss: 1.252 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.2885329723358154
Epoch: 4, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.177 Vali Acc: 0.473 Test Loss: 1.177 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.2900364398956299
Epoch: 5, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.2874822616577148
Epoch: 6, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.197 Vali Acc: 0.568 Test Loss: 1.197 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 1.5427303314208984
Epoch: 7, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.193169355392456
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4511611461639404
Epoch: 9, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.206 Vali Acc: 0.581 Test Loss: 1.206 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 1.6174964904785156
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.320 Vali Acc: 0.527 Test Loss: 1.320 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2576494216918945
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.349 Vali Acc: 0.541 Test Loss: 1.349 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6054725646972656
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.362 Vali Acc: 0.541 Test Loss: 1.362 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.235041856765747
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.377 Vali Acc: 0.568 Test Loss: 1.377 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0854511260986328
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.428 Vali Acc: 0.581 Test Loss: 1.428 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5168354511260986
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.454 Vali Acc: 0.554 Test Loss: 1.454 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2525544166564941
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2749814987182617
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.488 Vali Acc: 0.541 Test Loss: 1.488 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.571664810180664
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.509 Vali Acc: 0.527 Test Loss: 1.509 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1174461841583252
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.535 Vali Acc: 0.568 Test Loss: 1.535 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 135556
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1072838306427
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.386 Vali Acc: 0.297 Test Loss: 1.386 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.5763466358184814
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.339 Vali Acc: 0.432 Test Loss: 1.339 Test Acc: 0.432
Validation loss decreased (-0.297283 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.1257164478302002
Epoch: 3, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.213 Vali Acc: 0.459 Test Loss: 1.213 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.2969465255737305
Epoch: 4, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.185 Vali Acc: 0.459 Test Loss: 1.185 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.42362642288208
Epoch: 5, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.138 Vali Acc: 0.486 Test Loss: 1.138 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.0745763778686523
Epoch: 6, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.555959701538086
Epoch: 7, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.5626108646392822
Epoch: 8, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.1580793857574463
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.206 Vali Acc: 0.514 Test Loss: 1.206 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.548567295074463
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.260 Vali Acc: 0.541 Test Loss: 1.260 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4954767227172852
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.253 Vali Acc: 0.541 Test Loss: 1.253 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2634460926055908
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.324 Vali Acc: 0.581 Test Loss: 1.324 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581068).  Saving model ...
Epoch: 13 cost time: 1.3539578914642334
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.367 Vali Acc: 0.541 Test Loss: 1.367 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0674693584442139
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.429 Vali Acc: 0.541 Test Loss: 1.429 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1686549186706543
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.472 Vali Acc: 0.554 Test Loss: 1.472 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3584599494934082
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.481 Vali Acc: 0.527 Test Loss: 1.481 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1023197174072266
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.497 Vali Acc: 0.527 Test Loss: 1.497 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1416680812835693
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.503 Vali Acc: 0.568 Test Loss: 1.503 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3581671714782715
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.521 Vali Acc: 0.554 Test Loss: 1.521 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2328543663024902
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.533 Vali Acc: 0.568 Test Loss: 1.533 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4361703395843506
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.561 Vali Acc: 0.568 Test Loss: 1.561 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5853326320648193
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.576 Vali Acc: 0.568 Test Loss: 1.576 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 120836
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.035946846008301
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.534 Vali Acc: 0.230 Test Loss: 1.534 Test Acc: 0.230
Validation loss decreased (inf --> -0.229714).  Saving model ...
Epoch: 2 cost time: 1.4163317680358887
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
Validation loss decreased (-0.229714 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.1731736660003662
Epoch: 3, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.283 Vali Acc: 0.459 Test Loss: 1.283 Test Acc: 0.459
Validation loss decreased (-0.270256 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.22147536277771
Epoch: 4, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.226 Vali Acc: 0.419 Test Loss: 1.226 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5756092071533203
Epoch: 5, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.165 Vali Acc: 0.486 Test Loss: 1.165 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.4026801586151123
Epoch: 6, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.3236424922943115
Epoch: 7, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.329573392868042
Epoch: 8, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1697251796722412
Epoch: 9, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.167 Vali Acc: 0.581 Test Loss: 1.167 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 1.2007184028625488
Epoch: 10, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2890799045562744
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.175 Vali Acc: 0.568 Test Loss: 1.175 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3596441745758057
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.290 Vali Acc: 0.514 Test Loss: 1.290 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4887068271636963
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.248 Vali Acc: 0.554 Test Loss: 1.248 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2713963985443115
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.338 Vali Acc: 0.581 Test Loss: 1.338 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.198286771774292
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.369 Vali Acc: 0.541 Test Loss: 1.369 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3124611377716064
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.400 Vali Acc: 0.568 Test Loss: 1.400 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3136398792266846
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.429 Vali Acc: 0.554 Test Loss: 1.429 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2319464683532715
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.463 Vali Acc: 0.554 Test Loss: 1.463 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3537523746490479
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.494 Vali Acc: 0.554 Test Loss: 1.494 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 104196
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9560747146606445
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.519 Vali Acc: 0.162 Test Loss: 1.519 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 1.1573336124420166
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.467 Vali Acc: 0.257 Test Loss: 1.467 Test Acc: 0.257
Validation loss decreased (-0.162147 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 1.0137133598327637
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.403 Vali Acc: 0.324 Test Loss: 1.403 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.0319395065307617
Epoch: 4, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.346 Vali Acc: 0.378 Test Loss: 1.346 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.0603697299957275
Epoch: 5, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.317 Vali Acc: 0.419 Test Loss: 1.317 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.0882654190063477
Epoch: 6, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.288 Vali Acc: 0.432 Test Loss: 1.288 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.0881659984588623
Epoch: 7, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.248 Vali Acc: 0.446 Test Loss: 1.248 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.0563106536865234
Epoch: 8, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.248 Vali Acc: 0.473 Test Loss: 1.248 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 1.0236408710479736
Epoch: 9, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.226 Vali Acc: 0.486 Test Loss: 1.226 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 1.163564920425415
Epoch: 10, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.239 Vali Acc: 0.527 Test Loss: 1.239 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 0.9533336162567139
Epoch: 11, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.251 Vali Acc: 0.514 Test Loss: 1.251 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0415315628051758
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.266 Vali Acc: 0.541 Test Loss: 1.266 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 13 cost time: 1.0253968238830566
Epoch: 13, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.277 Vali Acc: 0.554 Test Loss: 1.277 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 14 cost time: 1.0618865489959717
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.281 Vali Acc: 0.581 Test Loss: 1.281 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581068).  Saving model ...
Epoch: 15 cost time: 1.015354871749878
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.365 Vali Acc: 0.554 Test Loss: 1.365 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1356875896453857
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.370 Vali Acc: 0.581 Test Loss: 1.370 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0547211170196533
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.412 Vali Acc: 0.595 Test Loss: 1.412 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594580).  Saving model ...
Epoch: 18 cost time: 1.0106785297393799
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.446 Vali Acc: 0.568 Test Loss: 1.446 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1654512882232666
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.486 Vali Acc: 0.595 Test Loss: 1.486 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1389234066009521
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.504 Vali Acc: 0.595 Test Loss: 1.504 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.035064458847046
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.499 Vali Acc: 0.581 Test Loss: 1.499 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.091325283050537
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.558 Vali Acc: 0.527 Test Loss: 1.558 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.090881109237671
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.574 Vali Acc: 0.527 Test Loss: 1.574 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0166277885437012
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.562 Vali Acc: 0.595 Test Loss: 1.562 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0728025436401367
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.562 Vali Acc: 0.622 Test Loss: 1.562 Test Acc: 0.622
Validation loss decreased (-0.594580 --> -0.621606).  Saving model ...
Epoch: 26 cost time: 1.0803186893463135
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.591 Vali Acc: 0.595 Test Loss: 1.591 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0170845985412598
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.606 Vali Acc: 0.595 Test Loss: 1.606 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.043083906173706
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.617 Vali Acc: 0.595 Test Loss: 1.617 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1127994060516357
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.642 Vali Acc: 0.595 Test Loss: 1.642 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0656273365020752
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.668 Vali Acc: 0.608 Test Loss: 1.668 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0549695491790771
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.694 Vali Acc: 0.595 Test Loss: 1.694 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1696696281433105
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.696 Vali Acc: 0.581 Test Loss: 1.696 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.189995288848877
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.729 Vali Acc: 0.595 Test Loss: 1.729 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.16691255569458
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.741 Vali Acc: 0.608 Test Loss: 1.741 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1025660037994385
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.754 Vali Acc: 0.608 Test Loss: 1.754 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 97796
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9553534984588623
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.622 Vali Acc: 0.243 Test Loss: 1.622 Test Acc: 0.243
Validation loss decreased (inf --> -0.243227).  Saving model ...
Epoch: 2 cost time: 0.8749220371246338
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.478 Vali Acc: 0.324 Test Loss: 1.478 Test Acc: 0.324
Validation loss decreased (-0.243227 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.0829720497131348
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.381 Vali Acc: 0.378 Test Loss: 1.381 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.9478223323822021
Epoch: 4, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.334 Vali Acc: 0.378 Test Loss: 1.334 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.946343183517456
Epoch: 5, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.94930100440979
Epoch: 6, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.251 Vali Acc: 0.419 Test Loss: 1.251 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.926055908203125
Epoch: 7, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.226 Vali Acc: 0.446 Test Loss: 1.226 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.8868978023529053
Epoch: 8, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.226 Vali Acc: 0.459 Test Loss: 1.226 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 0.9416971206665039
Epoch: 9, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.205 Vali Acc: 0.446 Test Loss: 1.205 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9682965278625488
Epoch: 10, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 0.8361766338348389
Epoch: 11, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 12 cost time: 0.9981222152709961
Epoch: 12, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.252 Vali Acc: 0.459 Test Loss: 1.252 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9049949645996094
Epoch: 13, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2823874950408936
Epoch: 14, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.257 Vali Acc: 0.514 Test Loss: 1.257 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 15 cost time: 1.0017030239105225
Epoch: 15, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0364725589752197
Epoch: 16, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.338 Vali Acc: 0.486 Test Loss: 1.338 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1566705703735352
Epoch: 17, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.388 Vali Acc: 0.486 Test Loss: 1.388 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0913023948669434
Epoch: 18, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.433 Vali Acc: 0.500 Test Loss: 1.433 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.070735216140747
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.467 Vali Acc: 0.486 Test Loss: 1.467 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0012595653533936
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.512 Vali Acc: 0.486 Test Loss: 1.512 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.086695671081543
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0912575721740723
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.547 Vali Acc: 0.500 Test Loss: 1.547 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.157871961593628
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.566 Vali Acc: 0.514 Test Loss: 1.566 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0451641082763672
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.602 Vali Acc: 0.514 Test Loss: 1.602 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 93956
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.01737904548645
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.279 Vali Acc: 0.459 Test Loss: 1.279 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 1.8803508281707764
Epoch: 2, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.351 Vali Acc: 0.419 Test Loss: 1.351 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.764714241027832
Epoch: 3, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.313 Vali Acc: 0.486 Test Loss: 1.313 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 1.9985084533691406
Epoch: 4, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.247 Vali Acc: 0.514 Test Loss: 1.247 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.7615699768066406
Epoch: 5, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.376 Vali Acc: 0.459 Test Loss: 1.376 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1210227012634277
Epoch: 6, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.465 Vali Acc: 0.486 Test Loss: 1.465 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8686141967773438
Epoch: 7, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.638 Vali Acc: 0.500 Test Loss: 1.638 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8556358814239502
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.637 Vali Acc: 0.527 Test Loss: 1.637 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527011).  Saving model ...
Epoch: 9 cost time: 1.9061741828918457
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.873 Vali Acc: 0.500 Test Loss: 1.873 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0087521076202393
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.265 Vali Acc: 0.446 Test Loss: 2.265 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.143117904663086
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.055 Vali Acc: 0.500 Test Loss: 2.055 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.119065523147583
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.685 Vali Acc: 0.459 Test Loss: 2.685 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.996358871459961
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.194 Vali Acc: 0.514 Test Loss: 2.194 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.179229259490967
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.366 Vali Acc: 0.446 Test Loss: 3.366 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.225877285003662
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.359 Vali Acc: 0.486 Test Loss: 2.359 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.264000415802002
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.148 Vali Acc: 0.405 Test Loss: 3.148 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.018620252609253
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.649 Vali Acc: 0.500 Test Loss: 2.649 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.116809368133545
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.817 Vali Acc: 0.486 Test Loss: 2.817 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 256004
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.243943691253662
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.385 Vali Acc: 0.392 Test Loss: 1.385 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.6414821147918701
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.278 Vali Acc: 0.419 Test Loss: 1.278 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.654179334640503
Epoch: 3, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.7323448657989502
Epoch: 4, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 1.7573816776275635
Epoch: 5, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.315 Vali Acc: 0.446 Test Loss: 1.315 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7281928062438965
Epoch: 6, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.267 Vali Acc: 0.514 Test Loss: 1.267 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4814825057983398
Epoch: 7, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.383 Vali Acc: 0.486 Test Loss: 1.383 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6086304187774658
Epoch: 8, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.403 Vali Acc: 0.486 Test Loss: 1.403 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.825028657913208
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.502 Vali Acc: 0.473 Test Loss: 1.502 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6025195121765137
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.512 Vali Acc: 0.527 Test Loss: 1.512 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6066510677337646
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.607 Vali Acc: 0.486 Test Loss: 1.607 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7247014045715332
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.717 Vali Acc: 0.486 Test Loss: 1.717 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8059933185577393
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.752 Vali Acc: 0.473 Test Loss: 1.752 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7645106315612793
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.731 Vali Acc: 0.486 Test Loss: 1.731 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 154244
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.123466968536377
Epoch: 1, Steps: 10 | Train Loss: 1.546 Vali Loss: 1.405 Vali Acc: 0.284 Test Loss: 1.405 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.2750818729400635
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.317 Vali Acc: 0.365 Test Loss: 1.317 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.4863712787628174
Epoch: 3, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.364852 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.5933411121368408
Epoch: 4, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.488224983215332
Epoch: 5, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.132 Vali Acc: 0.554 Test Loss: 1.132 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.5679843425750732
Epoch: 6, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7129888534545898
Epoch: 7, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6197502613067627
Epoch: 8, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.706639289855957
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7187161445617676
Epoch: 10, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.313 Vali Acc: 0.514 Test Loss: 1.313 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.579859733581543
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.307 Vali Acc: 0.527 Test Loss: 1.307 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4845428466796875
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.388 Vali Acc: 0.554 Test Loss: 1.388 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6540966033935547
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6152215003967285
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.474 Vali Acc: 0.514 Test Loss: 1.474 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5728917121887207
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.494 Vali Acc: 0.541 Test Loss: 1.494 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 119044
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3592777252197266
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.366 Vali Acc: 0.284 Test Loss: 1.366 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.4188449382781982
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.4895992279052734
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
Validation loss decreased (-0.405392 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.3388571739196777
Epoch: 4, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.141 Vali Acc: 0.486 Test Loss: 1.141 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5170142650604248
Epoch: 5, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.316343069076538
Epoch: 6, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.2873859405517578
Epoch: 7, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5828444957733154
Epoch: 8, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5333552360534668
Epoch: 9, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5550642013549805
Epoch: 10, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.228 Vali Acc: 0.541 Test Loss: 1.228 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4588038921356201
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.258 Vali Acc: 0.514 Test Loss: 1.258 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5408720970153809
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 13 cost time: 1.4354641437530518
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.369 Vali Acc: 0.554 Test Loss: 1.369 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5432138442993164
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.390 Vali Acc: 0.541 Test Loss: 1.390 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5076749324798584
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.372 Vali Acc: 0.554 Test Loss: 1.372 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8888094425201416
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.431 Vali Acc: 0.568 Test Loss: 1.431 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567553).  Saving model ...
Epoch: 17 cost time: 1.624220609664917
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.441 Vali Acc: 0.568 Test Loss: 1.441 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7853076457977295
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.453 Vali Acc: 0.541 Test Loss: 1.453 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6984694004058838
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.493 Vali Acc: 0.554 Test Loss: 1.493 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8624341487884521
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.537 Vali Acc: 0.554 Test Loss: 1.537 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7725741863250732
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.521 Vali Acc: 0.527 Test Loss: 1.521 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8444795608520508
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.542 Vali Acc: 0.554 Test Loss: 1.542 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.654118299484253
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.558 Vali Acc: 0.554 Test Loss: 1.558 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.081524610519409
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.558 Vali Acc: 0.554 Test Loss: 1.558 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7763328552246094
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.581 Vali Acc: 0.554 Test Loss: 1.581 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.882702350616455
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.598 Vali Acc: 0.527 Test Loss: 1.598 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 104324
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.259355306625366
Epoch: 1, Steps: 10 | Train Loss: 1.546 Vali Loss: 1.455 Vali Acc: 0.311 Test Loss: 1.455 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.6795625686645508
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.358 Vali Acc: 0.365 Test Loss: 1.358 Test Acc: 0.365
Validation loss decreased (-0.310796 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.535118818283081
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.242 Vali Acc: 0.419 Test Loss: 1.242 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.7231063842773438
Epoch: 4, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.189 Vali Acc: 0.405 Test Loss: 1.189 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4245266914367676
Epoch: 5, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.162 Vali Acc: 0.459 Test Loss: 1.162 Test Acc: 0.459
Validation loss decreased (-0.418907 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.779813289642334
Epoch: 6, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.126 Vali Acc: 0.459 Test Loss: 1.126 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 1.6363821029663086
Epoch: 7, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
Validation loss decreased (-0.459448 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.764033317565918
Epoch: 8, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6258118152618408
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.698570966720581
Epoch: 10, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6719517707824707
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.152 Vali Acc: 0.541 Test Loss: 1.152 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.534360408782959
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.233 Vali Acc: 0.554 Test Loss: 1.233 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8125805854797363
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.212 Vali Acc: 0.541 Test Loss: 1.212 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5440046787261963
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.293 Vali Acc: 0.554 Test Loss: 1.293 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.820554494857788
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.264 Vali Acc: 0.568 Test Loss: 1.264 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5425667762756348
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.290 Vali Acc: 0.595 Test Loss: 1.290 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 1.539508581161499
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.369 Vali Acc: 0.554 Test Loss: 1.369 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4603471755981445
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.397 Vali Acc: 0.568 Test Loss: 1.397 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6533012390136719
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.368 Vali Acc: 0.581 Test Loss: 1.368 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4484446048736572
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.387 Vali Acc: 0.568 Test Loss: 1.387 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4511075019836426
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.439 Vali Acc: 0.554 Test Loss: 1.439 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4579405784606934
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.454 Vali Acc: 0.541 Test Loss: 1.454 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6127352714538574
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.457 Vali Acc: 0.581 Test Loss: 1.457 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5681641101837158
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.501 Vali Acc: 0.554 Test Loss: 1.501 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.735182285308838
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.531 Vali Acc: 0.554 Test Loss: 1.531 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6016044616699219
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.513 Vali Acc: 0.568 Test Loss: 1.513 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 87684
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.064701795578003
Epoch: 1, Steps: 10 | Train Loss: 1.553 Vali Loss: 1.466 Vali Acc: 0.257 Test Loss: 1.466 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.997157096862793
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.411 Vali Acc: 0.311 Test Loss: 1.411 Test Acc: 0.311
Validation loss decreased (-0.256742 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.080679178237915
Epoch: 3, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.353 Vali Acc: 0.338 Test Loss: 1.353 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.0805320739746094
Epoch: 4, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.288 Vali Acc: 0.351 Test Loss: 1.288 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.0535573959350586
Epoch: 5, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.248 Vali Acc: 0.419 Test Loss: 1.248 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.9529836177825928
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.221 Vali Acc: 0.432 Test Loss: 1.221 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.0304875373840332
Epoch: 7, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.9418110847473145
Epoch: 8, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.118156909942627
Epoch: 9, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.236 Vali Acc: 0.446 Test Loss: 1.236 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9506754875183105
Epoch: 10, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.971104621887207
Epoch: 11, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.293 Vali Acc: 0.514 Test Loss: 1.293 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8307366371154785
Epoch: 12, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.270 Vali Acc: 0.554 Test Loss: 1.270 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554041).  Saving model ...
Epoch: 13 cost time: 0.8522970676422119
Epoch: 13, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.283 Vali Acc: 0.527 Test Loss: 1.283 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0119678974151611
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.327 Vali Acc: 0.554 Test Loss: 1.327 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0207529067993164
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.323 Vali Acc: 0.541 Test Loss: 1.323 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.993804931640625
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.390 Vali Acc: 0.514 Test Loss: 1.390 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0273182392120361
Epoch: 17, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.401 Vali Acc: 0.527 Test Loss: 1.401 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0397047996520996
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.436 Vali Acc: 0.541 Test Loss: 1.436 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9584894180297852
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.455 Vali Acc: 0.554 Test Loss: 1.455 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0519182682037354
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.464 Vali Acc: 0.541 Test Loss: 1.464 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0232048034667969
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.530 Vali Acc: 0.541 Test Loss: 1.530 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.053586483001709
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.571 Vali Acc: 0.541 Test Loss: 1.571 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 81284
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.961045265197754
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.0196595191955566
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.377 Vali Acc: 0.311 Test Loss: 1.377 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.0659353733062744
Epoch: 3, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.303 Vali Acc: 0.378 Test Loss: 1.303 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.0447793006896973
Epoch: 4, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.246 Vali Acc: 0.405 Test Loss: 1.246 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.1360514163970947
Epoch: 5, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.173163652420044
Epoch: 6, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.9944169521331787
Epoch: 7, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.9938545227050781
Epoch: 8, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.141 Vali Acc: 0.486 Test Loss: 1.141 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0638787746429443
Epoch: 9, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.117861032485962
Epoch: 10, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.132 Vali Acc: 0.459 Test Loss: 1.132 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9422614574432373
Epoch: 11, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.156 Vali Acc: 0.459 Test Loss: 1.156 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1380577087402344
Epoch: 12, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.0349376201629639
Epoch: 13, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.161 Vali Acc: 0.473 Test Loss: 1.161 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0346128940582275
Epoch: 14, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0634675025939941
Epoch: 15, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.228 Vali Acc: 0.514 Test Loss: 1.228 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1367254257202148
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0613772869110107
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.305 Vali Acc: 0.514 Test Loss: 1.305 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0362060070037842
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0232036113739014
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.334 Vali Acc: 0.514 Test Loss: 1.334 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0943171977996826
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.344 Vali Acc: 0.514 Test Loss: 1.344 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.057910442352295
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0723435878753662
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.401 Vali Acc: 0.514 Test Loss: 1.401 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm64_nh16_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 77444
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.876160144805908
Epoch: 1, Steps: 10 | Train Loss: 1.547 Vali Loss: 1.402 Vali Acc: 0.297 Test Loss: 1.402 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.330355167388916
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.247 Vali Acc: 0.405 Test Loss: 1.247 Test Acc: 0.405
Validation loss decreased (-0.297283 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.2659780979156494
Epoch: 3, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.3172719478607178
Epoch: 4, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.321 Vali Acc: 0.405 Test Loss: 1.321 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2363660335540771
Epoch: 5, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.171 Vali Acc: 0.554 Test Loss: 1.171 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 1.149129867553711
Epoch: 6, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.448 Vali Acc: 0.473 Test Loss: 1.448 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2021591663360596
Epoch: 7, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.248 Vali Acc: 0.527 Test Loss: 1.248 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1416378021240234
Epoch: 8, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1541566848754883
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.376 Vali Acc: 0.514 Test Loss: 1.376 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.138472080230713
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.503 Vali Acc: 0.514 Test Loss: 1.503 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1899187564849854
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.592 Vali Acc: 0.459 Test Loss: 1.592 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0994970798492432
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.614 Vali Acc: 0.541 Test Loss: 1.614 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1347155570983887
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.560 Vali Acc: 0.541 Test Loss: 1.560 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.240492582321167
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.609 Vali Acc: 0.500 Test Loss: 1.609 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1937134265899658
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.628 Vali Acc: 0.514 Test Loss: 1.628 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 144836
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4392731189727783
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.411 Vali Acc: 0.311 Test Loss: 1.411 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.3688054084777832
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.314 Vali Acc: 0.351 Test Loss: 1.314 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.4707114696502686
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.301 Vali Acc: 0.419 Test Loss: 1.301 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.4963407516479492
Epoch: 4, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.226 Vali Acc: 0.392 Test Loss: 1.226 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5080983638763428
Epoch: 5, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.5885584354400635
Epoch: 6, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.180 Vali Acc: 0.459 Test Loss: 1.180 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6477746963500977
Epoch: 7, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.222 Vali Acc: 0.446 Test Loss: 1.222 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.573188304901123
Epoch: 8, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.5175583362579346
Epoch: 9, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.250 Vali Acc: 0.473 Test Loss: 1.250 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.470273494720459
Epoch: 10, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.262 Vali Acc: 0.473 Test Loss: 1.262 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1065597534179688
Epoch: 11, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.318 Vali Acc: 0.459 Test Loss: 1.318 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4416577816009521
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4506516456604004
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.389 Vali Acc: 0.486 Test Loss: 1.389 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5231316089630127
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.455 Vali Acc: 0.473 Test Loss: 1.455 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5105562210083008
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.514 Vali Acc: 0.486 Test Loss: 1.514 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6205015182495117
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5372898578643799
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.514 Vali Acc: 0.514 Test Loss: 1.514 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6060807704925537
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.525 Vali Acc: 0.459 Test Loss: 1.525 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 93956
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5429134368896484
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.380 Vali Acc: 0.284 Test Loss: 1.380 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.5323486328125
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.320 Vali Acc: 0.392 Test Loss: 1.320 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.7142620086669922
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.296 Vali Acc: 0.432 Test Loss: 1.296 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.574571132659912
Epoch: 4, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.475745439529419
Epoch: 5, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.195 Vali Acc: 0.473 Test Loss: 1.195 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3787286281585693
Epoch: 6, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.178 Vali Acc: 0.446 Test Loss: 1.178 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6032662391662598
Epoch: 7, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.3528199195861816
Epoch: 8, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.365992784500122
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.631162405014038
Epoch: 10, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.194 Vali Acc: 0.473 Test Loss: 1.194 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.459317684173584
Epoch: 11, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.190 Vali Acc: 0.541 Test Loss: 1.190 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 1.6104457378387451
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.241 Vali Acc: 0.554 Test Loss: 1.241 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 1.779951810836792
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4015882015228271
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.282 Vali Acc: 0.554 Test Loss: 1.282 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6186025142669678
Epoch: 15, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.362 Vali Acc: 0.527 Test Loss: 1.362 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6922130584716797
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.433 Vali Acc: 0.581 Test Loss: 1.433 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581067).  Saving model ...
Epoch: 17 cost time: 1.4836292266845703
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5380711555480957
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.464 Vali Acc: 0.581 Test Loss: 1.464 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6487388610839844
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.493 Vali Acc: 0.581 Test Loss: 1.493 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.525944471359253
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.510 Vali Acc: 0.568 Test Loss: 1.510 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6409876346588135
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.524 Vali Acc: 0.568 Test Loss: 1.524 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6972696781158447
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.558 Vali Acc: 0.568 Test Loss: 1.558 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.655493974685669
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.566 Vali Acc: 0.581 Test Loss: 1.566 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6227054595947266
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.580 Vali Acc: 0.568 Test Loss: 1.580 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5796687602996826
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.583 Vali Acc: 0.554 Test Loss: 1.583 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.509486436843872
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.603 Vali Acc: 0.581 Test Loss: 1.603 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 76356
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8502163887023926
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.424 Vali Acc: 0.257 Test Loss: 1.424 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.9268319606781006
Epoch: 2, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.389 Vali Acc: 0.324 Test Loss: 1.389 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 0.937636137008667
Epoch: 3, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.344 Vali Acc: 0.378 Test Loss: 1.344 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.909865140914917
Epoch: 4, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.260 Vali Acc: 0.378 Test Loss: 1.260 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 1.0716972351074219
Epoch: 5, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.275 Vali Acc: 0.324 Test Loss: 1.275 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8547482490539551
Epoch: 6, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.199 Vali Acc: 0.392 Test Loss: 1.199 Test Acc: 0.392
Validation loss decreased (-0.378366 --> -0.391880).  Saving model ...
Epoch: 7 cost time: 1.0332388877868652
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.177 Vali Acc: 0.405 Test Loss: 1.177 Test Acc: 0.405
Validation loss decreased (-0.391880 --> -0.405394).  Saving model ...
Epoch: 8 cost time: 0.9193751811981201
Epoch: 8, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.173 Vali Acc: 0.446 Test Loss: 1.173 Test Acc: 0.446
Validation loss decreased (-0.405394 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 0.8869221210479736
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.169 Vali Acc: 0.432 Test Loss: 1.169 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0475225448608398
Epoch: 10, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.169 Vali Acc: 0.419 Test Loss: 1.169 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.047008752822876
Epoch: 11, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 1.001915693283081
Epoch: 12, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 0.9064486026763916
Epoch: 13, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1254386901855469
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.240 Vali Acc: 0.473 Test Loss: 1.240 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0631921291351318
Epoch: 15, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527014).  Saving model ...
Epoch: 16 cost time: 1.0352704524993896
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.304 Vali Acc: 0.500 Test Loss: 1.304 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1725201606750488
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.327 Vali Acc: 0.486 Test Loss: 1.327 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1483261585235596
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0112144947052002
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9386634826660156
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.382 Vali Acc: 0.486 Test Loss: 1.382 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0188453197479248
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0355117321014404
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.414 Vali Acc: 0.514 Test Loss: 1.414 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9455630779266357
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.417 Vali Acc: 0.500 Test Loss: 1.417 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0178234577178955
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.404 Vali Acc: 0.514 Test Loss: 1.404 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.985771656036377
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.421 Vali Acc: 0.514 Test Loss: 1.421 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 68996
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0049028396606445
Epoch: 1, Steps: 10 | Train Loss: 1.581 Vali Loss: 1.508 Vali Acc: 0.216 Test Loss: 1.508 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 1.101013422012329
Epoch: 2, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.445 Vali Acc: 0.230 Test Loss: 1.445 Test Acc: 0.230
Validation loss decreased (-0.216201 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 0.9553120136260986
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.383 Vali Acc: 0.243 Test Loss: 1.383 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 1.1474218368530273
Epoch: 4, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.330 Vali Acc: 0.284 Test Loss: 1.330 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 0.9547910690307617
Epoch: 5, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.302 Vali Acc: 0.311 Test Loss: 1.302 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310798).  Saving model ...
Epoch: 6 cost time: 0.9848968982696533
Epoch: 6, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.248 Vali Acc: 0.378 Test Loss: 1.248 Test Acc: 0.378
Validation loss decreased (-0.310798 --> -0.378366).  Saving model ...
Epoch: 7 cost time: 1.0475232601165771
Epoch: 7, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
Validation loss decreased (-0.378366 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.0040314197540283
Epoch: 8, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.189 Vali Acc: 0.446 Test Loss: 1.189 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1153790950775146
Epoch: 9, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 0.9567251205444336
Epoch: 10, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.152 Vali Acc: 0.459 Test Loss: 1.152 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0363166332244873
Epoch: 11, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 1.0656192302703857
Epoch: 12, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.173 Vali Acc: 0.473 Test Loss: 1.173 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0854668617248535
Epoch: 13, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0807175636291504
Epoch: 14, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.011997938156128
Epoch: 15, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 16 cost time: 1.1659271717071533
Epoch: 16, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 17 cost time: 1.120248556137085
Epoch: 17, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 18 cost time: 1.1678454875946045
Epoch: 18, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 19 cost time: 1.0376520156860352
Epoch: 19, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.263 Vali Acc: 0.568 Test Loss: 1.263 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 20 cost time: 1.0822861194610596
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.272 Vali Acc: 0.568 Test Loss: 1.272 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9693970680236816
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.292 Vali Acc: 0.568 Test Loss: 1.292 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0980989933013916
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.322 Vali Acc: 0.554 Test Loss: 1.322 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9842870235443115
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.321 Vali Acc: 0.568 Test Loss: 1.321 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1359965801239014
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.379 Vali Acc: 0.554 Test Loss: 1.379 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1534028053283691
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.412 Vali Acc: 0.554 Test Loss: 1.412 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.951444149017334
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.418 Vali Acc: 0.581 Test Loss: 1.418 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581067).  Saving model ...
Epoch: 27 cost time: 1.1054317951202393
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0591330528259277
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.460 Vali Acc: 0.568 Test Loss: 1.460 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0751774311065674
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.460 Vali Acc: 0.568 Test Loss: 1.460 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9863588809967041
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.474 Vali Acc: 0.568 Test Loss: 1.474 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9873948097229004
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.485 Vali Acc: 0.568 Test Loss: 1.485 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0958285331726074
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.492 Vali Acc: 0.568 Test Loss: 1.492 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.984837532043457
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.506 Vali Acc: 0.568 Test Loss: 1.506 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9724302291870117
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.512 Vali Acc: 0.568 Test Loss: 1.512 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0870535373687744
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.535 Vali Acc: 0.554 Test Loss: 1.535 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0116009712219238
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.550 Vali Acc: 0.554 Test Loss: 1.550 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 60676
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.760497570037842
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.525 Vali Acc: 0.243 Test Loss: 1.525 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 0.9405801296234131
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.478 Vali Acc: 0.257 Test Loss: 1.478 Test Acc: 0.257
Validation loss decreased (-0.243228 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 0.8850774765014648
Epoch: 3, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.443 Vali Acc: 0.257 Test Loss: 1.443 Test Acc: 0.257
Validation loss decreased (-0.256742 --> -0.256742).  Saving model ...
Epoch: 4 cost time: 1.0111064910888672
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.417 Vali Acc: 0.311 Test Loss: 1.417 Test Acc: 0.311
Validation loss decreased (-0.256742 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 1.0561392307281494
Epoch: 5, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 0.8628635406494141
Epoch: 6, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.288 Vali Acc: 0.446 Test Loss: 1.288 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 0.99857497215271
Epoch: 7, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.271 Vali Acc: 0.432 Test Loss: 1.271 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9546787738800049
Epoch: 8, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 1.0881073474884033
Epoch: 9, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 0.9726507663726807
Epoch: 10, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.030810832977295
Epoch: 11, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.165 Vali Acc: 0.473 Test Loss: 1.165 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8931093215942383
Epoch: 12, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 13 cost time: 0.9693951606750488
Epoch: 13, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0341529846191406
Epoch: 14, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 15 cost time: 0.8979532718658447
Epoch: 15, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 16 cost time: 0.9835474491119385
Epoch: 16, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 0.9878778457641602
Epoch: 17, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 18 cost time: 1.0650715827941895
Epoch: 18, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.191 Vali Acc: 0.527 Test Loss: 1.191 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8502092361450195
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.190 Vali Acc: 0.568 Test Loss: 1.190 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 20 cost time: 0.9139182567596436
Epoch: 20, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0973618030548096
Epoch: 21, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.247 Vali Acc: 0.568 Test Loss: 1.247 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.123607873916626
Epoch: 22, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.265 Vali Acc: 0.568 Test Loss: 1.265 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8911557197570801
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.295 Vali Acc: 0.568 Test Loss: 1.295 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9978270530700684
Epoch: 24, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.310 Vali Acc: 0.541 Test Loss: 1.310 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9540109634399414
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.329 Vali Acc: 0.514 Test Loss: 1.329 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0713138580322266
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.360 Vali Acc: 0.541 Test Loss: 1.360 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8801078796386719
Epoch: 27, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.360 Vali Acc: 0.541 Test Loss: 1.360 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0248935222625732
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.379 Vali Acc: 0.554 Test Loss: 1.379 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9119505882263184
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.374 Vali Acc: 0.568 Test Loss: 1.374 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 57476
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6244752407073975
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.469 Vali Acc: 0.203 Test Loss: 1.469 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.8475284576416016
Epoch: 2, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (-0.202688 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.9319906234741211
Epoch: 3, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.396 Vali Acc: 0.297 Test Loss: 1.396 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 0.9074270725250244
Epoch: 4, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.366 Vali Acc: 0.351 Test Loss: 1.366 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.9780912399291992
Epoch: 5, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 0.8232555389404297
Epoch: 6, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.287 Vali Acc: 0.459 Test Loss: 1.287 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.9876606464385986
Epoch: 7, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.270 Vali Acc: 0.514 Test Loss: 1.270 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 0.9909348487854004
Epoch: 8, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.924248218536377
Epoch: 9, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.222 Vali Acc: 0.527 Test Loss: 1.222 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 0.9725487232208252
Epoch: 10, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0263187885284424
Epoch: 11, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.920142412185669
Epoch: 12, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8379952907562256
Epoch: 13, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.242 Vali Acc: 0.527 Test Loss: 1.242 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9643733501434326
Epoch: 14, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.269 Vali Acc: 0.514 Test Loss: 1.269 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8262362480163574
Epoch: 15, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9992501735687256
Epoch: 16, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.285 Vali Acc: 0.473 Test Loss: 1.285 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9948334693908691
Epoch: 17, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.283 Vali Acc: 0.486 Test Loss: 1.283 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.003347635269165
Epoch: 18, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8969268798828125
Epoch: 19, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 55556
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.178838014602661
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.1529858112335205
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.229 Vali Acc: 0.419 Test Loss: 1.229 Test Acc: 0.419
Validation loss decreased (-0.243229 --> -0.418907).  Saving model ...
Epoch: 3 cost time: 1.1709725856781006
Epoch: 3, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
Validation loss decreased (-0.418907 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.2101049423217773
Epoch: 4, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.2707860469818115
Epoch: 5, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3312344551086426
Epoch: 6, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4426054954528809
Epoch: 7, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.240 Vali Acc: 0.446 Test Loss: 1.240 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.276916742324829
Epoch: 8, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3710477352142334
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.474 Vali Acc: 0.486 Test Loss: 1.474 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.175590991973877
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.616 Vali Acc: 0.446 Test Loss: 1.616 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2443130016326904
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.675 Vali Acc: 0.554 Test Loss: 1.675 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554037).  Saving model ...
Epoch: 12 cost time: 1.4653899669647217
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.735 Vali Acc: 0.486 Test Loss: 1.735 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2876169681549072
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.747 Vali Acc: 0.514 Test Loss: 1.747 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2629961967468262
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.886 Vali Acc: 0.527 Test Loss: 1.886 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2742393016815186
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.874 Vali Acc: 0.514 Test Loss: 1.874 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3684968948364258
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.928 Vali Acc: 0.486 Test Loss: 1.928 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2186729907989502
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.909 Vali Acc: 0.514 Test Loss: 1.909 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.251577377319336
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.894 Vali Acc: 0.527 Test Loss: 1.894 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1752851009368896
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.881 Vali Acc: 0.527 Test Loss: 1.881 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0825929641723633
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.879 Vali Acc: 0.541 Test Loss: 1.879 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2869281768798828
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.888 Vali Acc: 0.527 Test Loss: 1.888 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 128196
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7271058559417725
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.421 Vali Acc: 0.311 Test Loss: 1.421 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.2333991527557373
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.327 Vali Acc: 0.378 Test Loss: 1.327 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.2992730140686035
Epoch: 3, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.293 Vali Acc: 0.392 Test Loss: 1.293 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.5176951885223389
Epoch: 4, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.4333224296569824
Epoch: 5, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.217 Vali Acc: 0.446 Test Loss: 1.217 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4131417274475098
Epoch: 6, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.191 Vali Acc: 0.419 Test Loss: 1.191 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1138856410980225
Epoch: 7, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.220 Vali Acc: 0.473 Test Loss: 1.220 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.1844077110290527
Epoch: 8, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.3777165412902832
Epoch: 9, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.205 Vali Acc: 0.459 Test Loss: 1.205 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4117045402526855
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.251 Vali Acc: 0.486 Test Loss: 1.251 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1731598377227783
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.332 Vali Acc: 0.459 Test Loss: 1.332 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.239048957824707
Epoch: 12, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.383 Vali Acc: 0.473 Test Loss: 1.383 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7711474895477295
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.464 Vali Acc: 0.459 Test Loss: 1.464 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.757397174835205
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.455 Vali Acc: 0.459 Test Loss: 1.455 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7799808979034424
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.495 Vali Acc: 0.473 Test Loss: 1.495 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.790710210800171
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.558 Vali Acc: 0.514 Test Loss: 1.558 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7533681392669678
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.540 Vali Acc: 0.486 Test Loss: 1.540 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7997605800628662
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.542 Vali Acc: 0.473 Test Loss: 1.542 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 77316
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1117682456970215
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.416 Vali Acc: 0.203 Test Loss: 1.416 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.3197598457336426
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.327 Vali Acc: 0.338 Test Loss: 1.327 Test Acc: 0.338
Validation loss decreased (-0.202689 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.6143474578857422
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.312 Vali Acc: 0.324 Test Loss: 1.312 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3908607959747314
Epoch: 4, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (-0.337825 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2720847129821777
Epoch: 5, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.3152706623077393
Epoch: 6, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3596606254577637
Epoch: 7, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.3393957614898682
Epoch: 8, Steps: 10 | Train Loss: 0.483 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2725028991699219
Epoch: 9, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.601196527481079
Epoch: 10, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.164 Vali Acc: 0.541 Test Loss: 1.164 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4477903842926025
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.764007568359375
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.828357219696045
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.193 Vali Acc: 0.568 Test Loss: 1.193 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 1.668515682220459
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.257 Vali Acc: 0.554 Test Loss: 1.257 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7780036926269531
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.307 Vali Acc: 0.554 Test Loss: 1.307 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7830417156219482
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.352 Vali Acc: 0.541 Test Loss: 1.352 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7209734916687012
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.343 Vali Acc: 0.554 Test Loss: 1.343 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.703796625137329
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.424 Vali Acc: 0.554 Test Loss: 1.424 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6039564609527588
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.419 Vali Acc: 0.554 Test Loss: 1.419 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8063721656799316
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.419 Vali Acc: 0.568 Test Loss: 1.419 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.797530174255371
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.450 Vali Acc: 0.568 Test Loss: 1.450 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7487573623657227
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.489 Vali Acc: 0.568 Test Loss: 1.489 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8295016288757324
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.491 Vali Acc: 0.568 Test Loss: 1.491 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 59716
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.877892255783081
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.481 Vali Acc: 0.243 Test Loss: 1.481 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 1.0132582187652588
Epoch: 2, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
Validation loss decreased (-0.243228 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.9730794429779053
Epoch: 3, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.345 Vali Acc: 0.378 Test Loss: 1.345 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.084153413772583
Epoch: 4, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.313 Vali Acc: 0.419 Test Loss: 1.313 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.9413084983825684
Epoch: 5, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.0528647899627686
Epoch: 6, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.0482814311981201
Epoch: 7, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.234 Vali Acc: 0.473 Test Loss: 1.234 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9749374389648438
Epoch: 8, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.9669680595397949
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 0.9676079750061035
Epoch: 10, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.184 Vali Acc: 0.595 Test Loss: 1.184 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594583).  Saving model ...
Epoch: 11 cost time: 0.9633548259735107
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.164 Vali Acc: 0.541 Test Loss: 1.164 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9883909225463867
Epoch: 12, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.186 Vali Acc: 0.554 Test Loss: 1.186 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9406707286834717
Epoch: 13, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9621188640594482
Epoch: 14, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0084426403045654
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.277 Vali Acc: 0.527 Test Loss: 1.277 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1627509593963623
Epoch: 16, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.331 Vali Acc: 0.541 Test Loss: 1.331 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9999558925628662
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.331 Vali Acc: 0.527 Test Loss: 1.331 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0489089488983154
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.352 Vali Acc: 0.541 Test Loss: 1.352 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1063339710235596
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.371 Vali Acc: 0.541 Test Loss: 1.371 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1135966777801514
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.398 Vali Acc: 0.514 Test Loss: 1.398 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 52356
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9969470500946045
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.382 Vali Acc: 0.311 Test Loss: 1.382 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0586330890655518
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.352 Vali Acc: 0.338 Test Loss: 1.352 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.1060113906860352
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.329 Vali Acc: 0.405 Test Loss: 1.329 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.2020094394683838
Epoch: 4, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.279 Vali Acc: 0.486 Test Loss: 1.279 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.0354928970336914
Epoch: 5, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.229 Vali Acc: 0.527 Test Loss: 1.229 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.1168859004974365
Epoch: 6, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.230879545211792
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0353734493255615
Epoch: 8, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1214628219604492
Epoch: 9, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.037973165512085
Epoch: 10, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1213836669921875
Epoch: 11, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1902685165405273
Epoch: 12, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.04935622215271
Epoch: 13, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 14 cost time: 1.0517199039459229
Epoch: 14, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2010319232940674
Epoch: 15, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1026995182037354
Epoch: 16, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0014712810516357
Epoch: 17, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.213 Vali Acc: 0.514 Test Loss: 1.213 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1230802536010742
Epoch: 18, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.276 Vali Acc: 0.514 Test Loss: 1.276 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.024529218673706
Epoch: 19, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0645558834075928
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.266 Vali Acc: 0.554 Test Loss: 1.266 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1890389919281006
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.275 Vali Acc: 0.527 Test Loss: 1.275 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1427044868469238
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.327 Vali Acc: 0.541 Test Loss: 1.327 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0172057151794434
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.335 Vali Acc: 0.527 Test Loss: 1.335 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 44036
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.020643711090088
Epoch: 1, Steps: 10 | Train Loss: 1.535 Vali Loss: 1.472 Vali Acc: 0.311 Test Loss: 1.472 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.0282907485961914
Epoch: 2, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.451 Vali Acc: 0.324 Test Loss: 1.451 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.152782917022705
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.416 Vali Acc: 0.378 Test Loss: 1.416 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378364).  Saving model ...
Epoch: 4 cost time: 1.0481016635894775
Epoch: 4, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.388 Vali Acc: 0.419 Test Loss: 1.388 Test Acc: 0.419
Validation loss decreased (-0.378364 --> -0.418905).  Saving model ...
Epoch: 5 cost time: 1.2651796340942383
Epoch: 5, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.344 Vali Acc: 0.419 Test Loss: 1.344 Test Acc: 0.419
Validation loss decreased (-0.418905 --> -0.418905).  Saving model ...
Epoch: 6 cost time: 1.106555461883545
Epoch: 6, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.284 Vali Acc: 0.446 Test Loss: 1.284 Test Acc: 0.446
Validation loss decreased (-0.418905 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.1731867790222168
Epoch: 7, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.251 Vali Acc: 0.473 Test Loss: 1.251 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.0204896926879883
Epoch: 8, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.224 Vali Acc: 0.446 Test Loss: 1.224 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0210585594177246
Epoch: 9, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.201 Vali Acc: 0.459 Test Loss: 1.201 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2053592205047607
Epoch: 10, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.187 Vali Acc: 0.446 Test Loss: 1.187 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1249706745147705
Epoch: 11, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 1.0748910903930664
Epoch: 12, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.105808973312378
Epoch: 13, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.152 Vali Acc: 0.473 Test Loss: 1.152 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0953848361968994
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2255253791809082
Epoch: 15, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.095 Vali Acc: 0.446 Test Loss: 1.095 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.081407070159912
Epoch: 16, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 1.1206655502319336
Epoch: 17, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0808498859405518
Epoch: 18, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.175 Vali Acc: 0.446 Test Loss: 1.175 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1658339500427246
Epoch: 19, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.147 Vali Acc: 0.473 Test Loss: 1.147 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9509472846984863
Epoch: 20, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.175 Vali Acc: 0.459 Test Loss: 1.175 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0662841796875
Epoch: 21, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.105781078338623
Epoch: 22, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.911344051361084
Epoch: 23, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.221 Vali Acc: 0.514 Test Loss: 1.221 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513501).  Saving model ...
Epoch: 24 cost time: 0.9673573970794678
Epoch: 24, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.240 Vali Acc: 0.486 Test Loss: 1.240 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9824469089508057
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.274 Vali Acc: 0.486 Test Loss: 1.274 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0538532733917236
Epoch: 26, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.992603063583374
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9803028106689453
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9255251884460449
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 30 cost time: 1.0231797695159912
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.316 Vali Acc: 0.514 Test Loss: 1.316 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9866669178009033
Epoch: 31, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.343 Vali Acc: 0.514 Test Loss: 1.343 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.980046272277832
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9470169544219971
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.390 Vali Acc: 0.486 Test Loss: 1.390 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.047318935394287
Epoch: 34, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.395 Vali Acc: 0.473 Test Loss: 1.395 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0939736366271973
Epoch: 35, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.402 Vali Acc: 0.473 Test Loss: 1.402 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1293530464172363
Epoch: 36, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.153886318206787
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.444 Vali Acc: 0.473 Test Loss: 1.444 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1357543468475342
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.454 Vali Acc: 0.459 Test Loss: 1.454 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1065983772277832
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.440 Vali Acc: 0.486 Test Loss: 1.440 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 40836
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7805583477020264
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.389 Vali Acc: 0.284 Test Loss: 1.389 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.0277671813964844
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.363 Vali Acc: 0.311 Test Loss: 1.363 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.0677990913391113
Epoch: 3, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.323 Vali Acc: 0.392 Test Loss: 1.323 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0937070846557617
Epoch: 4, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.130309820175171
Epoch: 5, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.237 Vali Acc: 0.527 Test Loss: 1.237 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.056326150894165
Epoch: 6, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.017806053161621
Epoch: 7, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1096501350402832
Epoch: 8, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1335997581481934
Epoch: 9, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.180356740951538
Epoch: 10, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1022155284881592
Epoch: 11, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.162 Vali Acc: 0.459 Test Loss: 1.162 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.207129955291748
Epoch: 12, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.160 Vali Acc: 0.446 Test Loss: 1.160 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0627131462097168
Epoch: 13, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.171 Vali Acc: 0.446 Test Loss: 1.171 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.174912929534912
Epoch: 14, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.156 Vali Acc: 0.459 Test Loss: 1.156 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0580792427062988
Epoch: 15, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.162 Vali Acc: 0.486 Test Loss: 1.162 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 38916
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.447042465209961
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.406 Vali Acc: 0.284 Test Loss: 1.406 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.0822951793670654
Epoch: 2, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.945324182510376
Epoch: 3, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.250 Vali Acc: 0.392 Test Loss: 1.250 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.091261625289917
Epoch: 4, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.167 Vali Acc: 0.446 Test Loss: 1.167 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 2.0482046604156494
Epoch: 5, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.0607731342315674
Epoch: 6, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1256141662597656
Epoch: 7, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 2.0043294429779053
Epoch: 8, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.311 Vali Acc: 0.541 Test Loss: 1.311 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1533405780792236
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.354 Vali Acc: 0.473 Test Loss: 1.354 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9331178665161133
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.455 Vali Acc: 0.514 Test Loss: 1.455 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0601344108581543
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.609 Vali Acc: 0.514 Test Loss: 1.609 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.139254570007324
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.533 Vali Acc: 0.473 Test Loss: 1.533 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7089574337005615
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.625 Vali Acc: 0.514 Test Loss: 1.625 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9915995597839355
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.620 Vali Acc: 0.500 Test Loss: 1.620 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8537118434906006
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.627 Vali Acc: 0.473 Test Loss: 1.627 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.977220058441162
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.661 Vali Acc: 0.486 Test Loss: 1.661 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9731934070587158
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.673 Vali Acc: 0.459 Test Loss: 1.673 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 119876
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2166659832000732
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.421 Vali Acc: 0.284 Test Loss: 1.421 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.4527361392974854
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.373 Vali Acc: 0.338 Test Loss: 1.373 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.6084582805633545
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.6069719791412354
Epoch: 4, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.6932306289672852
Epoch: 5, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.268 Vali Acc: 0.365 Test Loss: 1.268 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5746915340423584
Epoch: 6, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.260 Vali Acc: 0.378 Test Loss: 1.260 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7563731670379639
Epoch: 7, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.278 Vali Acc: 0.419 Test Loss: 1.278 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.657508373260498
Epoch: 8, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.300 Vali Acc: 0.446 Test Loss: 1.300 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 1.7548134326934814
Epoch: 9, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.7685105800628662
Epoch: 10, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.357 Vali Acc: 0.486 Test Loss: 1.357 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6857080459594727
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.370 Vali Acc: 0.473 Test Loss: 1.370 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9277119636535645
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.473 Vali Acc: 0.459 Test Loss: 1.473 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.909355878829956
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.523 Vali Acc: 0.486 Test Loss: 1.523 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7103257179260254
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.501 Vali Acc: 0.473 Test Loss: 1.501 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7207605838775635
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.530 Vali Acc: 0.486 Test Loss: 1.530 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8978607654571533
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.558 Vali Acc: 0.486 Test Loss: 1.558 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6636953353881836
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.592 Vali Acc: 0.473 Test Loss: 1.592 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7338650226593018
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.607 Vali Acc: 0.473 Test Loss: 1.607 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.819859504699707
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.654 Vali Acc: 0.486 Test Loss: 1.654 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 68996
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.265406608581543
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.467 Vali Acc: 0.216 Test Loss: 1.467 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.6094729900360107
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.7027792930603027
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.340 Vali Acc: 0.297 Test Loss: 1.340 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.5539624691009521
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.338 Vali Acc: 0.365 Test Loss: 1.338 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.5299973487854004
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.269 Vali Acc: 0.419 Test Loss: 1.269 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.7502954006195068
Epoch: 6, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.257 Vali Acc: 0.446 Test Loss: 1.257 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.550309181213379
Epoch: 7, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.7888641357421875
Epoch: 8, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.251 Vali Acc: 0.473 Test Loss: 1.251 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7499699592590332
Epoch: 9, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.240 Vali Acc: 0.514 Test Loss: 1.240 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 1.5437078475952148
Epoch: 10, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8355660438537598
Epoch: 11, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.249 Vali Acc: 0.514 Test Loss: 1.249 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7083535194396973
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.302 Vali Acc: 0.486 Test Loss: 1.302 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.781773328781128
Epoch: 13, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.321 Vali Acc: 0.554 Test Loss: 1.321 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554041).  Saving model ...
Epoch: 14 cost time: 1.829958438873291
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.398 Vali Acc: 0.500 Test Loss: 1.398 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3374223709106445
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.415 Vali Acc: 0.554 Test Loss: 1.415 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5400676727294922
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.438 Vali Acc: 0.514 Test Loss: 1.438 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8050203323364258
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.498 Vali Acc: 0.514 Test Loss: 1.498 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5935242176055908
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.491 Vali Acc: 0.541 Test Loss: 1.491 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.382462978363037
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.509 Vali Acc: 0.527 Test Loss: 1.509 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5866923332214355
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.522 Vali Acc: 0.541 Test Loss: 1.522 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6629695892333984
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.556 Vali Acc: 0.527 Test Loss: 1.556 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.581129550933838
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5860319137573242
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.617 Vali Acc: 0.541 Test Loss: 1.617 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 51396
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.095794200897217
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.409 Vali Acc: 0.257 Test Loss: 1.409 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.9858269691467285
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.410 Vali Acc: 0.216 Test Loss: 1.410 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.97347092628479
Epoch: 3, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.373 Vali Acc: 0.270 Test Loss: 1.373 Test Acc: 0.270
Validation loss decreased (-0.256743 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 1.0367977619171143
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.279 Vali Acc: 0.338 Test Loss: 1.279 Test Acc: 0.338
Validation loss decreased (-0.270257 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 1.1262004375457764
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.337825 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.240424394607544
Epoch: 6, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.1074633598327637
Epoch: 7, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1641819477081299
Epoch: 8, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.0594189167022705
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.11865234375
Epoch: 10, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.101 Vali Acc: 0.514 Test Loss: 1.101 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0476033687591553
Epoch: 11, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.107 Vali Acc: 0.527 Test Loss: 1.107 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0116281509399414
Epoch: 12, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0941522121429443
Epoch: 13, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.128 Vali Acc: 0.568 Test Loss: 1.128 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 0.9776933193206787
Epoch: 14, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.121 Vali Acc: 0.568 Test Loss: 1.121 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 1.077625036239624
Epoch: 15, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0250275135040283
Epoch: 16, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0208656787872314
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1195428371429443
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.223 Vali Acc: 0.568 Test Loss: 1.223 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1367859840393066
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.236 Vali Acc: 0.541 Test Loss: 1.236 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1255912780761719
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.273 Vali Acc: 0.554 Test Loss: 1.273 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1514222621917725
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.279 Vali Acc: 0.554 Test Loss: 1.279 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.043353796005249
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.288 Vali Acc: 0.541 Test Loss: 1.288 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9741504192352295
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.305 Vali Acc: 0.541 Test Loss: 1.305 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9621720314025879
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.311 Vali Acc: 0.541 Test Loss: 1.311 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44036
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9514105319976807
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.573 Vali Acc: 0.122 Test Loss: 1.573 Test Acc: 0.122
Validation loss decreased (inf --> -0.121606).  Saving model ...
Epoch: 2 cost time: 0.9822583198547363
Epoch: 2, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.533 Vali Acc: 0.230 Test Loss: 1.533 Test Acc: 0.230
Validation loss decreased (-0.121606 --> -0.229714).  Saving model ...
Epoch: 3 cost time: 1.2098937034606934
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.466 Vali Acc: 0.311 Test Loss: 1.466 Test Acc: 0.311
Validation loss decreased (-0.229714 --> -0.310796).  Saving model ...
Epoch: 4 cost time: 1.090343952178955
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.431 Vali Acc: 0.311 Test Loss: 1.431 Test Acc: 0.311
Validation loss decreased (-0.310796 --> -0.310796).  Saving model ...
Epoch: 5 cost time: 1.0474417209625244
Epoch: 5, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.370 Vali Acc: 0.405 Test Loss: 1.370 Test Acc: 0.405
Validation loss decreased (-0.310796 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 1.0030901432037354
Epoch: 6, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.328 Vali Acc: 0.446 Test Loss: 1.328 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.1349680423736572
Epoch: 7, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.306 Vali Acc: 0.459 Test Loss: 1.306 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459446).  Saving model ...
Epoch: 8 cost time: 1.0534322261810303
Epoch: 8, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.271 Vali Acc: 0.514 Test Loss: 1.271 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 1.119368314743042
Epoch: 9, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.269 Vali Acc: 0.486 Test Loss: 1.269 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1159698963165283
Epoch: 10, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.227 Vali Acc: 0.473 Test Loss: 1.227 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.03648042678833
Epoch: 11, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1420533657073975
Epoch: 12, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1146254539489746
Epoch: 13, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0608181953430176
Epoch: 14, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.242 Vali Acc: 0.514 Test Loss: 1.242 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 15 cost time: 1.0882067680358887
Epoch: 15, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.241 Vali Acc: 0.527 Test Loss: 1.241 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 16 cost time: 1.0748670101165771
Epoch: 16, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1419460773468018
Epoch: 17, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0233149528503418
Epoch: 18, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.306 Vali Acc: 0.527 Test Loss: 1.306 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.964529275894165
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.308 Vali Acc: 0.514 Test Loss: 1.308 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0070562362670898
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.307 Vali Acc: 0.527 Test Loss: 1.307 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9725027084350586
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.369 Vali Acc: 0.541 Test Loss: 1.369 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 22 cost time: 0.9503216743469238
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.393 Vali Acc: 0.541 Test Loss: 1.393 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.164304256439209
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.425 Vali Acc: 0.527 Test Loss: 1.425 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.13346266746521
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.407 Vali Acc: 0.541 Test Loss: 1.407 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9552137851715088
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.420 Vali Acc: 0.554 Test Loss: 1.420 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 26 cost time: 0.977247953414917
Epoch: 26, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.443 Vali Acc: 0.568 Test Loss: 1.443 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567553).  Saving model ...
Epoch: 27 cost time: 1.0654892921447754
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.474 Vali Acc: 0.568 Test Loss: 1.474 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0354242324829102
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.466 Vali Acc: 0.568 Test Loss: 1.466 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9001326560974121
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.462 Vali Acc: 0.568 Test Loss: 1.462 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.981436014175415
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.478 Vali Acc: 0.568 Test Loss: 1.478 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9039318561553955
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.483 Vali Acc: 0.541 Test Loss: 1.483 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0295453071594238
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8958840370178223
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.529 Vali Acc: 0.527 Test Loss: 1.529 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.070481777191162
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.544 Vali Acc: 0.554 Test Loss: 1.544 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0709664821624756
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.550 Vali Acc: 0.554 Test Loss: 1.550 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0335958003997803
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.558 Vali Acc: 0.554 Test Loss: 1.558 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 35716
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9624338150024414
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.549 Vali Acc: 0.203 Test Loss: 1.549 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 1.0661797523498535
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.453 Vali Acc: 0.257 Test Loss: 1.453 Test Acc: 0.257
Validation loss decreased (-0.202687 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 1.014580249786377
Epoch: 3, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.390 Vali Acc: 0.297 Test Loss: 1.390 Test Acc: 0.297
Validation loss decreased (-0.256742 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 0.9533636569976807
Epoch: 4, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.356 Vali Acc: 0.338 Test Loss: 1.356 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 1.09023118019104
Epoch: 5, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.0712890625
Epoch: 6, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.290 Vali Acc: 0.432 Test Loss: 1.290 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 0.9882180690765381
Epoch: 7, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.263 Vali Acc: 0.446 Test Loss: 1.263 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.1242120265960693
Epoch: 8, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.231 Vali Acc: 0.432 Test Loss: 1.231 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0729377269744873
Epoch: 9, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.221 Vali Acc: 0.432 Test Loss: 1.221 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0102834701538086
Epoch: 10, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.212 Vali Acc: 0.459 Test Loss: 1.212 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 11 cost time: 0.967149019241333
Epoch: 11, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.180 Vali Acc: 0.473 Test Loss: 1.180 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 0.9984769821166992
Epoch: 12, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 1.0211632251739502
Epoch: 13, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.179 Vali Acc: 0.473 Test Loss: 1.179 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9157733917236328
Epoch: 14, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0231413841247559
Epoch: 15, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0936176776885986
Epoch: 16, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.191 Vali Acc: 0.527 Test Loss: 1.191 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 17 cost time: 1.082155704498291
Epoch: 17, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.041050672531128
Epoch: 18, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9647560119628906
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9939525127410889
Epoch: 20, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.250 Vali Acc: 0.527 Test Loss: 1.250 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9945042133331299
Epoch: 21, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.306 Vali Acc: 0.514 Test Loss: 1.306 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9723539352416992
Epoch: 22, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.288 Vali Acc: 0.527 Test Loss: 1.288 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0004146099090576
Epoch: 23, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.299 Vali Acc: 0.554 Test Loss: 1.299 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554041).  Saving model ...
Epoch: 24 cost time: 0.9428086280822754
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.321 Vali Acc: 0.541 Test Loss: 1.321 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0817573070526123
Epoch: 25, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.378 Vali Acc: 0.514 Test Loss: 1.378 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.10213041305542
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.397 Vali Acc: 0.486 Test Loss: 1.397 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0817549228668213
Epoch: 27, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.404 Vali Acc: 0.514 Test Loss: 1.404 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0888125896453857
Epoch: 28, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.414 Vali Acc: 0.500 Test Loss: 1.414 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0682024955749512
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1533257961273193
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.452 Vali Acc: 0.486 Test Loss: 1.452 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.148789644241333
Epoch: 31, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.468 Vali Acc: 0.500 Test Loss: 1.468 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1820459365844727
Epoch: 32, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.485 Vali Acc: 0.514 Test Loss: 1.485 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0514485836029053
Epoch: 33, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.489 Vali Acc: 0.527 Test Loss: 1.489 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 32516
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1895854473114014
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.375 Vali Acc: 0.338 Test Loss: 1.375 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0322775840759277
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.356 Vali Acc: 0.365 Test Loss: 1.356 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.0600690841674805
Epoch: 3, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.316 Vali Acc: 0.392 Test Loss: 1.316 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.027327060699463
Epoch: 4, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.279 Vali Acc: 0.446 Test Loss: 1.279 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.0125706195831299
Epoch: 5, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.1549084186553955
Epoch: 6, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.214 Vali Acc: 0.527 Test Loss: 1.214 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.0757310390472412
Epoch: 7, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0539486408233643
Epoch: 8, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.054034948348999
Epoch: 9, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.2406423091888428
Epoch: 10, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.2068345546722412
Epoch: 11, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.118 Vali Acc: 0.581 Test Loss: 1.118 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 1.0948176383972168
Epoch: 12, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.114 Vali Acc: 0.595 Test Loss: 1.114 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 1.1370856761932373
Epoch: 13, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.103 Vali Acc: 0.595 Test Loss: 1.103 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 1.1160459518432617
Epoch: 14, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0484604835510254
Epoch: 15, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9757754802703857
Epoch: 16, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9731483459472656
Epoch: 17, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.154 Vali Acc: 0.581 Test Loss: 1.154 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.027933120727539
Epoch: 18, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.183 Vali Acc: 0.568 Test Loss: 1.183 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0364651679992676
Epoch: 19, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0208392143249512
Epoch: 20, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.206 Vali Acc: 0.568 Test Loss: 1.206 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0255300998687744
Epoch: 21, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.94313645362854
Epoch: 22, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.250 Vali Acc: 0.554 Test Loss: 1.250 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0011205673217773
Epoch: 23, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.264 Vali Acc: 0.554 Test Loss: 1.264 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm32_nh4_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 30596
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.228846549987793
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.388 Vali Acc: 0.324 Test Loss: 1.388 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.3127961158752441
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.270134449005127
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.247 Vali Acc: 0.459 Test Loss: 1.247 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.217881441116333
Epoch: 4, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.356569766998291
Epoch: 5, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.176 Vali Acc: 0.432 Test Loss: 1.176 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3831748962402344
Epoch: 6, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.4139604568481445
Epoch: 7, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 1.3693878650665283
Epoch: 8, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.421449899673462
Epoch: 9, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5233509540557861
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3956575393676758
Epoch: 11, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.322 Vali Acc: 0.554 Test Loss: 1.322 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3260228633880615
Epoch: 12, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.301 Vali Acc: 0.514 Test Loss: 1.301 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4390392303466797
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.318 Vali Acc: 0.527 Test Loss: 1.318 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.371920108795166
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.353 Vali Acc: 0.514 Test Loss: 1.353 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1388263702392578
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.378 Vali Acc: 0.514 Test Loss: 1.378 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2377963066101074
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.406 Vali Acc: 0.541 Test Loss: 1.406 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2148857116699219
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.423 Vali Acc: 0.554 Test Loss: 1.423 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 70628
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9661855697631836
Epoch: 1, Steps: 10 | Train Loss: 1.531 Vali Loss: 1.408 Vali Acc: 0.284 Test Loss: 1.408 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8959424495697021
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.403 Vali Acc: 0.284 Test Loss: 1.403 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.0793509483337402
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.322 Vali Acc: 0.392 Test Loss: 1.322 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0764131546020508
Epoch: 4, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.242 Vali Acc: 0.446 Test Loss: 1.242 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.0305750370025635
Epoch: 5, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.0548679828643799
Epoch: 6, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.050264835357666
Epoch: 7, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.0226333141326904
Epoch: 8, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.0523221492767334
Epoch: 9, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.141 Vali Acc: 0.541 Test Loss: 1.141 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0371956825256348
Epoch: 10, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594583).  Saving model ...
Epoch: 11 cost time: 1.0631659030914307
Epoch: 11, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.140 Vali Acc: 0.595 Test Loss: 1.140 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.025855302810669
Epoch: 12, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1135127544403076
Epoch: 13, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.136 Vali Acc: 0.554 Test Loss: 1.136 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0761475563049316
Epoch: 14, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1326873302459717
Epoch: 15, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1104562282562256
Epoch: 16, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.248 Vali Acc: 0.541 Test Loss: 1.248 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1496047973632812
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.276 Vali Acc: 0.514 Test Loss: 1.276 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.158501148223877
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.274 Vali Acc: 0.541 Test Loss: 1.274 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1054112911224365
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.283 Vali Acc: 0.541 Test Loss: 1.283 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.17820143699646
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.298 Vali Acc: 0.568 Test Loss: 1.298 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 45188
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.036430597305298
Epoch: 1, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.338 Vali Acc: 0.257 Test Loss: 1.338 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0032100677490234
Epoch: 2, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.316 Vali Acc: 0.311 Test Loss: 1.316 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310798).  Saving model ...
Epoch: 3 cost time: 1.0200886726379395
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.277 Vali Acc: 0.392 Test Loss: 1.277 Test Acc: 0.392
Validation loss decreased (-0.310798 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0701277256011963
Epoch: 4, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9742064476013184
Epoch: 5, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.1073970794677734
Epoch: 6, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.187 Vali Acc: 0.514 Test Loss: 1.187 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0805654525756836
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0889599323272705
Epoch: 8, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.141 Vali Acc: 0.527 Test Loss: 1.141 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.0045533180236816
Epoch: 9, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.0072145462036133
Epoch: 10, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0294559001922607
Epoch: 11, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0291223526000977
Epoch: 12, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.115 Vali Acc: 0.486 Test Loss: 1.115 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9804327487945557
Epoch: 13, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0658576488494873
Epoch: 14, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0506467819213867
Epoch: 15, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0183792114257812
Epoch: 16, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0758240222930908
Epoch: 17, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.024569034576416
Epoch: 18, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.253 Vali Acc: 0.554 Test Loss: 1.253 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 19 cost time: 1.0035247802734375
Epoch: 19, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9609315395355225
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.282 Vali Acc: 0.541 Test Loss: 1.282 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9203474521636963
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.032571792602539
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8831400871276855
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8130643367767334
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.350 Vali Acc: 0.527 Test Loss: 1.350 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0175817012786865
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.378 Vali Acc: 0.554 Test Loss: 1.378 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1299726963043213
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.399 Vali Acc: 0.514 Test Loss: 1.399 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0306639671325684
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.422 Vali Acc: 0.541 Test Loss: 1.422 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9673500061035156
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.451 Vali Acc: 0.568 Test Loss: 1.451 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567553).  Saving model ...
Epoch: 29 cost time: 1.051689863204956
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.460 Vali Acc: 0.541 Test Loss: 1.460 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9989922046661377
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.446 Vali Acc: 0.541 Test Loss: 1.446 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.144646406173706
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.467 Vali Acc: 0.568 Test Loss: 1.467 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9894664287567139
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.486 Vali Acc: 0.554 Test Loss: 1.486 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1507055759429932
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.499 Vali Acc: 0.581 Test Loss: 1.499 Test Acc: 0.581
Validation loss decreased (-0.567553 --> -0.581066).  Saving model ...
Epoch: 34 cost time: 1.0860052108764648
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.481 Vali Acc: 0.554 Test Loss: 1.481 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0229296684265137
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.476 Vali Acc: 0.568 Test Loss: 1.476 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.119483232498169
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.491 Vali Acc: 0.568 Test Loss: 1.491 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0992240905761719
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.510 Vali Acc: 0.581 Test Loss: 1.510 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.020688772201538
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.526 Vali Acc: 0.568 Test Loss: 1.526 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9957187175750732
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.545 Vali Acc: 0.554 Test Loss: 1.545 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.023986577987671
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.562 Vali Acc: 0.554 Test Loss: 1.562 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1312406063079834
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.568 Vali Acc: 0.568 Test Loss: 1.568 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9928715229034424
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.577 Vali Acc: 0.581 Test Loss: 1.577 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0751268863677979
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.583 Vali Acc: 0.581 Test Loss: 1.583 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 36388
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.825728178024292
Epoch: 1, Steps: 10 | Train Loss: 1.559 Vali Loss: 1.477 Vali Acc: 0.189 Test Loss: 1.477 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 0.8863332271575928
Epoch: 2, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.449 Vali Acc: 0.243 Test Loss: 1.449 Test Acc: 0.243
Validation loss decreased (-0.189174 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.9164073467254639
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.412 Vali Acc: 0.324 Test Loss: 1.412 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 0.9816250801086426
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.370 Vali Acc: 0.351 Test Loss: 1.370 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.9200966358184814
Epoch: 5, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.334 Vali Acc: 0.378 Test Loss: 1.334 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.0924108028411865
Epoch: 6, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.290 Vali Acc: 0.378 Test Loss: 1.290 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 1.0715761184692383
Epoch: 7, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.251 Vali Acc: 0.392 Test Loss: 1.251 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 8 cost time: 0.9687652587890625
Epoch: 8, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.230 Vali Acc: 0.392 Test Loss: 1.230 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391880).  Saving model ...
Epoch: 9 cost time: 1.1921041011810303
Epoch: 9, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.199 Vali Acc: 0.405 Test Loss: 1.199 Test Acc: 0.405
Validation loss decreased (-0.391880 --> -0.405393).  Saving model ...
Epoch: 10 cost time: 1.0991644859313965
Epoch: 10, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.172 Vali Acc: 0.432 Test Loss: 1.172 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432421).  Saving model ...
Epoch: 11 cost time: 1.1349420547485352
Epoch: 11, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.169 Vali Acc: 0.459 Test Loss: 1.169 Test Acc: 0.459
Validation loss decreased (-0.432421 --> -0.459448).  Saving model ...
Epoch: 12 cost time: 1.0244967937469482
Epoch: 12, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.165 Vali Acc: 0.446 Test Loss: 1.165 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0387599468231201
Epoch: 13, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.155 Vali Acc: 0.473 Test Loss: 1.155 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 14 cost time: 1.067336082458496
Epoch: 14, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.169 Vali Acc: 0.473 Test Loss: 1.169 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0617036819458008
Epoch: 15, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 16 cost time: 1.1160619258880615
Epoch: 16, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 17 cost time: 1.0029077529907227
Epoch: 17, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0133650302886963
Epoch: 18, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9955744743347168
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0114624500274658
Epoch: 20, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9937641620635986
Epoch: 21, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0076985359191895
Epoch: 22, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.11057710647583
Epoch: 23, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.261 Vali Acc: 0.473 Test Loss: 1.261 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1254603862762451
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.286 Vali Acc: 0.486 Test Loss: 1.286 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0145349502563477
Epoch: 25, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9631969928741455
Epoch: 26, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.329 Vali Acc: 0.459 Test Loss: 1.329 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 32708
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8005197048187256
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.477 Vali Acc: 0.176 Test Loss: 1.477 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.0854806900024414
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.459 Vali Acc: 0.189 Test Loss: 1.459 Test Acc: 0.189
Validation loss decreased (-0.175661 --> -0.189175).  Saving model ...
Epoch: 3 cost time: 1.1586334705352783
Epoch: 3, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (-0.189175 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 1.0830507278442383
Epoch: 4, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.398 Vali Acc: 0.311 Test Loss: 1.398 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 1.0840444564819336
Epoch: 5, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.382 Vali Acc: 0.338 Test Loss: 1.382 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 1.0014455318450928
Epoch: 6, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.352 Vali Acc: 0.311 Test Loss: 1.352 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0034964084625244
Epoch: 7, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.337 Vali Acc: 0.324 Test Loss: 1.337 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1880097389221191
Epoch: 8, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.320 Vali Acc: 0.351 Test Loss: 1.320 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 9 cost time: 1.104863166809082
Epoch: 9, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.296 Vali Acc: 0.378 Test Loss: 1.296 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 10 cost time: 1.059321403503418
Epoch: 10, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.274 Vali Acc: 0.392 Test Loss: 1.274 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 11 cost time: 1.1397037506103516
Epoch: 11, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 12 cost time: 1.1002681255340576
Epoch: 12, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 13 cost time: 1.1181704998016357
Epoch: 13, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.0805354118347168
Epoch: 14, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1244966983795166
Epoch: 15, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.0687754154205322
Epoch: 16, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1280949115753174
Epoch: 17, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.215 Vali Acc: 0.459 Test Loss: 1.215 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0083568096160889
Epoch: 18, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0676491260528564
Epoch: 19, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.230 Vali Acc: 0.486 Test Loss: 1.230 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.014805555343628
Epoch: 20, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0453181266784668
Epoch: 21, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9343817234039307
Epoch: 22, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0181312561035156
Epoch: 23, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.259 Vali Acc: 0.514 Test Loss: 1.259 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1743502616882324
Epoch: 24, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.258 Vali Acc: 0.514 Test Loss: 1.258 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1624047756195068
Epoch: 25, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.288 Vali Acc: 0.527 Test Loss: 1.288 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527014).  Saving model ...
Epoch: 26 cost time: 1.100433111190796
Epoch: 26, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.320 Vali Acc: 0.527 Test Loss: 1.320 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0629260540008545
Epoch: 27, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.314 Vali Acc: 0.541 Test Loss: 1.314 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540527).  Saving model ...
Epoch: 28 cost time: 1.0895051956176758
Epoch: 28, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.336 Vali Acc: 0.541 Test Loss: 1.336 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1999168395996094
Epoch: 29, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.369 Vali Acc: 0.541 Test Loss: 1.369 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.116725206375122
Epoch: 30, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.358 Vali Acc: 0.527 Test Loss: 1.358 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.055765151977539
Epoch: 31, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.345 Vali Acc: 0.514 Test Loss: 1.345 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.964324951171875
Epoch: 32, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.371 Vali Acc: 0.541 Test Loss: 1.371 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0235426425933838
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.413 Vali Acc: 0.541 Test Loss: 1.413 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0208511352539062
Epoch: 34, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.431 Vali Acc: 0.514 Test Loss: 1.431 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9926607608795166
Epoch: 35, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0564119815826416
Epoch: 36, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.428 Vali Acc: 0.541 Test Loss: 1.428 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1662497520446777
Epoch: 37, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.452 Vali Acc: 0.554 Test Loss: 1.452 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 38 cost time: 1.0752747058868408
Epoch: 38, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.455 Vali Acc: 0.554 Test Loss: 1.455 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.138981580734253
Epoch: 39, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.466 Vali Acc: 0.541 Test Loss: 1.466 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0434796810150146
Epoch: 40, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.473 Vali Acc: 0.554 Test Loss: 1.473 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.101743459701538
Epoch: 41, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.510 Vali Acc: 0.527 Test Loss: 1.510 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0994787216186523
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.537 Vali Acc: 0.554 Test Loss: 1.537 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.120901107788086
Epoch: 43, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.526 Vali Acc: 0.554 Test Loss: 1.526 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.044039249420166
Epoch: 44, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.520 Vali Acc: 0.568 Test Loss: 1.520 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567552).  Saving model ...
Epoch: 45 cost time: 1.04496169090271
Epoch: 45, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.524 Vali Acc: 0.568 Test Loss: 1.524 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9891350269317627
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.547 Vali Acc: 0.568 Test Loss: 1.547 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9865539073944092
Epoch: 47, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.566 Vali Acc: 0.568 Test Loss: 1.566 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0600650310516357
Epoch: 48, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.587 Vali Acc: 0.581 Test Loss: 1.587 Test Acc: 0.581
Validation loss decreased (-0.567552 --> -0.581065).  Saving model ...
Epoch: 49 cost time: 0.9242303371429443
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.597 Vali Acc: 0.581 Test Loss: 1.597 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1077446937561035
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.591 Vali Acc: 0.581 Test Loss: 1.591 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9651913642883301
Epoch: 51, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.605 Vali Acc: 0.581 Test Loss: 1.605 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9421398639678955
Epoch: 52, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.631 Vali Acc: 0.554 Test Loss: 1.631 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.0409269332885742
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.645 Vali Acc: 0.568 Test Loss: 1.645 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.02044677734375
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.657 Vali Acc: 0.568 Test Loss: 1.657 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0530283451080322
Epoch: 55, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.658 Vali Acc: 0.581 Test Loss: 1.658 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9587366580963135
Epoch: 56, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.665 Vali Acc: 0.581 Test Loss: 1.665 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.1031787395477295
Epoch: 57, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.683 Vali Acc: 0.568 Test Loss: 1.683 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9342713356018066
Epoch: 58, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.675 Vali Acc: 0.568 Test Loss: 1.675 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 28548
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6246156692504883
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.384 Vali Acc: 0.311 Test Loss: 1.384 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.023169994354248
Epoch: 2, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.371 Vali Acc: 0.324 Test Loss: 1.371 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.9864826202392578
Epoch: 3, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.9584519863128662
Epoch: 4, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.325 Vali Acc: 0.365 Test Loss: 1.325 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.9789085388183594
Epoch: 5, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.288 Vali Acc: 0.378 Test Loss: 1.288 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 0.9299135208129883
Epoch: 6, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.258 Vali Acc: 0.419 Test Loss: 1.258 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.9407672882080078
Epoch: 7, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 0.9807007312774658
Epoch: 8, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.9586730003356934
Epoch: 9, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.951831579208374
Epoch: 10, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8985605239868164
Epoch: 11, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0315735340118408
Epoch: 12, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9885292053222656
Epoch: 13, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 1.0693027973175049
Epoch: 14, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.110 Vali Acc: 0.514 Test Loss: 1.110 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.0028188228607178
Epoch: 15, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 0.9690918922424316
Epoch: 16, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9167397022247314
Epoch: 17, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.093 Vali Acc: 0.486 Test Loss: 1.093 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0987331867218018
Epoch: 18, Steps: 10 | Train Loss: 0.509 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9817886352539062
Epoch: 19, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 20 cost time: 1.0558664798736572
Epoch: 20, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 21 cost time: 1.0422344207763672
Epoch: 21, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.008324146270752
Epoch: 22, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9208285808563232
Epoch: 23, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0081672668457031
Epoch: 24, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.101 Vali Acc: 0.514 Test Loss: 1.101 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0254437923431396
Epoch: 25, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.096 Vali Acc: 0.514 Test Loss: 1.096 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0173964500427246
Epoch: 26, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.097 Vali Acc: 0.514 Test Loss: 1.097 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0063772201538086
Epoch: 27, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.123 Vali Acc: 0.527 Test Loss: 1.123 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0155222415924072
Epoch: 28, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0685675144195557
Epoch: 29, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9204907417297363
Epoch: 30, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 26948
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9920146465301514
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.434 Vali Acc: 0.284 Test Loss: 1.434 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.0043456554412842
Epoch: 2, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.423 Vali Acc: 0.297 Test Loss: 1.423 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.9810848236083984
Epoch: 3, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.405 Vali Acc: 0.311 Test Loss: 1.405 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.8780779838562012
Epoch: 4, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.396 Vali Acc: 0.324 Test Loss: 1.396 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 1.0099899768829346
Epoch: 5, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.372 Vali Acc: 0.365 Test Loss: 1.372 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 6 cost time: 0.9570713043212891
Epoch: 6, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.345 Vali Acc: 0.338 Test Loss: 1.345 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9492909908294678
Epoch: 7, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.323 Vali Acc: 0.338 Test Loss: 1.323 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.148559331893921
Epoch: 8, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.311 Vali Acc: 0.351 Test Loss: 1.311 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9508473873138428
Epoch: 9, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.280 Vali Acc: 0.351 Test Loss: 1.280 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1053359508514404
Epoch: 10, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.267 Vali Acc: 0.365 Test Loss: 1.267 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 11 cost time: 1.0216789245605469
Epoch: 11, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.238 Vali Acc: 0.432 Test Loss: 1.238 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 1.0188713073730469
Epoch: 12, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.224 Vali Acc: 0.432 Test Loss: 1.224 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 13 cost time: 1.021336555480957
Epoch: 13, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.220 Vali Acc: 0.473 Test Loss: 1.220 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 14 cost time: 0.9902670383453369
Epoch: 14, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.213 Vali Acc: 0.514 Test Loss: 1.213 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513501).  Saving model ...
Epoch: 15 cost time: 0.9439795017242432
Epoch: 15, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.209 Vali Acc: 0.514 Test Loss: 1.209 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 16 cost time: 1.052417516708374
Epoch: 16, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0393266677856445
Epoch: 17, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.172 Vali Acc: 0.473 Test Loss: 1.172 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0678067207336426
Epoch: 18, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.167 Vali Acc: 0.473 Test Loss: 1.167 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0851528644561768
Epoch: 19, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0854377746582031
Epoch: 20, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1169426441192627
Epoch: 21, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.176 Vali Acc: 0.486 Test Loss: 1.176 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.981299638748169
Epoch: 22, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.170 Vali Acc: 0.514 Test Loss: 1.170 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 23 cost time: 1.0253362655639648
Epoch: 23, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 24 cost time: 1.0216119289398193
Epoch: 24, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9382674694061279
Epoch: 25, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0755693912506104
Epoch: 26, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.209 Vali Acc: 0.527 Test Loss: 1.209 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 27 cost time: 1.0265896320343018
Epoch: 27, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.216 Vali Acc: 0.527 Test Loss: 1.216 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9340956211090088
Epoch: 28, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.216 Vali Acc: 0.554 Test Loss: 1.216 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 29 cost time: 0.9864046573638916
Epoch: 29, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9454495906829834
Epoch: 30, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.831024169921875
Epoch: 31, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9734385013580322
Epoch: 32, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.246 Vali Acc: 0.527 Test Loss: 1.246 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0091619491577148
Epoch: 33, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0590615272521973
Epoch: 34, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.304 Vali Acc: 0.486 Test Loss: 1.304 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.960047721862793
Epoch: 35, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.306 Vali Acc: 0.473 Test Loss: 1.306 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0317845344543457
Epoch: 36, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.329 Vali Acc: 0.486 Test Loss: 1.329 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.929492712020874
Epoch: 37, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.021456003189087
Epoch: 38, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.375 Vali Acc: 0.473 Test Loss: 1.375 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 25988
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.257035255432129
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.419 Vali Acc: 0.297 Test Loss: 1.419 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.2322969436645508
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.361 Vali Acc: 0.338 Test Loss: 1.361 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.358846664428711
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.4268975257873535
Epoch: 4, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.315 Vali Acc: 0.378 Test Loss: 1.315 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3137881755828857
Epoch: 5, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.289039134979248
Epoch: 6, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.193 Vali Acc: 0.419 Test Loss: 1.193 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.058499813079834
Epoch: 7, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.155 Vali Acc: 0.446 Test Loss: 1.155 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2867376804351807
Epoch: 8, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.2663688659667969
Epoch: 9, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.254 Vali Acc: 0.459 Test Loss: 1.254 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0827367305755615
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3321287631988525
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.326 Vali Acc: 0.459 Test Loss: 1.326 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2312233448028564
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.429 Vali Acc: 0.446 Test Loss: 1.429 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2995853424072266
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.464 Vali Acc: 0.446 Test Loss: 1.464 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.32124662399292
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.503 Vali Acc: 0.432 Test Loss: 1.503 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.43123197555542
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.534 Vali Acc: 0.446 Test Loss: 1.534 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3265318870544434
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.564 Vali Acc: 0.459 Test Loss: 1.564 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3168976306915283
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.574 Vali Acc: 0.446 Test Loss: 1.574 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3638341426849365
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.596 Vali Acc: 0.432 Test Loss: 1.596 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 62180
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6951863765716553
Epoch: 1, Steps: 10 | Train Loss: 1.568 Vali Loss: 1.522 Vali Acc: 0.243 Test Loss: 1.522 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 1.0470623970031738
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (-0.243228 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.9992861747741699
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.359 Vali Acc: 0.378 Test Loss: 1.359 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.0644330978393555
Epoch: 4, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.298 Vali Acc: 0.446 Test Loss: 1.298 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.9815630912780762
Epoch: 5, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.0649731159210205
Epoch: 6, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.9096686840057373
Epoch: 7, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0296807289123535
Epoch: 8, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0226342678070068
Epoch: 9, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.146 Vali Acc: 0.473 Test Loss: 1.146 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0295984745025635
Epoch: 10, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.9269537925720215
Epoch: 11, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9961495399475098
Epoch: 12, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.137 Vali Acc: 0.486 Test Loss: 1.137 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.023913860321045
Epoch: 13, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 0.9940547943115234
Epoch: 14, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9618089199066162
Epoch: 15, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.149 Vali Acc: 0.568 Test Loss: 1.149 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0127966403961182
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0012218952178955
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 1.0171027183532715
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.996741533279419
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.198 Vali Acc: 0.554 Test Loss: 1.198 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0745203495025635
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9757974147796631
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.249 Vali Acc: 0.541 Test Loss: 1.249 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.970325231552124
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.266 Vali Acc: 0.568 Test Loss: 1.266 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.98189377784729
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.275 Vali Acc: 0.554 Test Loss: 1.275 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9811127185821533
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.274 Vali Acc: 0.568 Test Loss: 1.274 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9178280830383301
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.282 Vali Acc: 0.595 Test Loss: 1.282 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0439035892486572
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.310 Vali Acc: 0.568 Test Loss: 1.310 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.003880262374878
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.336 Vali Acc: 0.568 Test Loss: 1.336 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 36740
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.57974910736084
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.480 Vali Acc: 0.230 Test Loss: 1.480 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.08109712600708
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.455 Vali Acc: 0.216 Test Loss: 1.455 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.076146125793457
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.411 Vali Acc: 0.311 Test Loss: 1.411 Test Acc: 0.311
Validation loss decreased (-0.229715 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.079563856124878
Epoch: 4, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.382 Vali Acc: 0.324 Test Loss: 1.382 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 0.9569711685180664
Epoch: 5, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.328 Vali Acc: 0.378 Test Loss: 1.328 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.0362639427185059
Epoch: 6, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.283 Vali Acc: 0.419 Test Loss: 1.283 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.9693880081176758
Epoch: 7, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.264 Vali Acc: 0.459 Test Loss: 1.264 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.006119728088379
Epoch: 8, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.258 Vali Acc: 0.459 Test Loss: 1.258 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 1.0479192733764648
Epoch: 9, Steps: 10 | Train Loss: 0.723 Vali Loss: 1.217 Vali Acc: 0.446 Test Loss: 1.217 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9815032482147217
Epoch: 10, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.225 Vali Acc: 0.432 Test Loss: 1.225 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0502586364746094
Epoch: 11, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 1.0078086853027344
Epoch: 12, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.225 Vali Acc: 0.459 Test Loss: 1.225 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9800810813903809
Epoch: 13, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.0099925994873047
Epoch: 14, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.215 Vali Acc: 0.459 Test Loss: 1.215 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9480686187744141
Epoch: 15, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0221593379974365
Epoch: 16, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9726462364196777
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.275 Vali Acc: 0.446 Test Loss: 1.275 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9435131549835205
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.298 Vali Acc: 0.473 Test Loss: 1.298 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9731764793395996
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.303 Vali Acc: 0.446 Test Loss: 1.303 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0443766117095947
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.327 Vali Acc: 0.486 Test Loss: 1.327 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9800171852111816
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513500).  Saving model ...
Epoch: 22 cost time: 0.9429547786712646
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.364 Vali Acc: 0.459 Test Loss: 1.364 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9216136932373047
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.370 Vali Acc: 0.486 Test Loss: 1.370 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7784280776977539
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8782367706298828
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.420 Vali Acc: 0.500 Test Loss: 1.420 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9014971256256104
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.430 Vali Acc: 0.486 Test Loss: 1.430 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8464870452880859
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.898590087890625
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.492 Vali Acc: 0.486 Test Loss: 1.492 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8180246353149414
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.493 Vali Acc: 0.500 Test Loss: 1.493 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0314784049987793
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.508 Vali Acc: 0.500 Test Loss: 1.508 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8221089839935303
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 27940
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.849621534347534
Epoch: 1, Steps: 10 | Train Loss: 1.577 Vali Loss: 1.393 Vali Acc: 0.297 Test Loss: 1.393 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.0275375843048096
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.366 Vali Acc: 0.324 Test Loss: 1.366 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.0095584392547607
Epoch: 3, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.334 Vali Acc: 0.365 Test Loss: 1.334 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.0344910621643066
Epoch: 4, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.294 Vali Acc: 0.446 Test Loss: 1.294 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.9255368709564209
Epoch: 5, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.0639307498931885
Epoch: 6, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.216 Vali Acc: 0.446 Test Loss: 1.216 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.8887910842895508
Epoch: 7, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.9999008178710938
Epoch: 8, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.0446181297302246
Epoch: 9, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.135 Vali Acc: 0.459 Test Loss: 1.135 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9413108825683594
Epoch: 10, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0041379928588867
Epoch: 11, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9351000785827637
Epoch: 12, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.932314395904541
Epoch: 13, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.081 Vali Acc: 0.514 Test Loss: 1.081 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0599775314331055
Epoch: 14, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.082 Vali Acc: 0.568 Test Loss: 1.082 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 1.0209271907806396
Epoch: 15, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0418920516967773
Epoch: 16, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.082 Vali Acc: 0.473 Test Loss: 1.082 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9739184379577637
Epoch: 17, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.955242395401001
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9580802917480469
Epoch: 19, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.947594165802002
Epoch: 20, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9749255180358887
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9846906661987305
Epoch: 22, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0275371074676514
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9357101917266846
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.201 Vali Acc: 0.554 Test Loss: 1.201 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 24260
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8165969848632812
Epoch: 1, Steps: 10 | Train Loss: 1.564 Vali Loss: 1.460 Vali Acc: 0.216 Test Loss: 1.460 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.9794533252716064
Epoch: 2, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.472 Vali Acc: 0.257 Test Loss: 1.472 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 1.0034890174865723
Epoch: 3, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.459 Vali Acc: 0.243 Test Loss: 1.459 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0989937782287598
Epoch: 4, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.446 Vali Acc: 0.284 Test Loss: 1.446 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283769).  Saving model ...
Epoch: 5 cost time: 0.98514723777771
Epoch: 5, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.406 Vali Acc: 0.351 Test Loss: 1.406 Test Acc: 0.351
Validation loss decreased (-0.283769 --> -0.351337).  Saving model ...
Epoch: 6 cost time: 0.9589240550994873
Epoch: 6, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.391 Vali Acc: 0.324 Test Loss: 1.391 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.895423173904419
Epoch: 7, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.348 Vali Acc: 0.405 Test Loss: 1.348 Test Acc: 0.405
Validation loss decreased (-0.351337 --> -0.405392).  Saving model ...
Epoch: 8 cost time: 0.9402410984039307
Epoch: 8, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.311 Vali Acc: 0.432 Test Loss: 1.311 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 9 cost time: 0.9444029331207275
Epoch: 9, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 10 cost time: 0.939070463180542
Epoch: 10, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.271 Vali Acc: 0.459 Test Loss: 1.271 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 11 cost time: 0.9291794300079346
Epoch: 11, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.265 Vali Acc: 0.419 Test Loss: 1.265 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0177052021026611
Epoch: 12, Steps: 10 | Train Loss: 0.807 Vali Loss: 1.241 Vali Acc: 0.405 Test Loss: 1.241 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9618391990661621
Epoch: 13, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.222 Vali Acc: 0.459 Test Loss: 1.222 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 14 cost time: 0.8918721675872803
Epoch: 14, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.0993523597717285
Epoch: 15, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.9345684051513672
Epoch: 16, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.194 Vali Acc: 0.473 Test Loss: 1.194 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.070347547531128
Epoch: 17, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.024463176727295
Epoch: 18, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.986457347869873
Epoch: 19, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.187 Vali Acc: 0.527 Test Loss: 1.187 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 20 cost time: 0.9594616889953613
Epoch: 20, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.209 Vali Acc: 0.514 Test Loss: 1.209 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9293501377105713
Epoch: 21, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9747545719146729
Epoch: 22, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9638204574584961
Epoch: 23, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.223 Vali Acc: 0.527 Test Loss: 1.223 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0038466453552246
Epoch: 24, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.233 Vali Acc: 0.541 Test Loss: 1.233 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 25 cost time: 0.9636149406433105
Epoch: 25, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0249273777008057
Epoch: 26, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.260 Vali Acc: 0.527 Test Loss: 1.260 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.029815912246704
Epoch: 27, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.282 Vali Acc: 0.527 Test Loss: 1.282 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.094459056854248
Epoch: 28, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.275 Vali Acc: 0.527 Test Loss: 1.275 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9068465232849121
Epoch: 29, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.282 Vali Acc: 0.527 Test Loss: 1.282 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9284980297088623
Epoch: 30, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.303 Vali Acc: 0.527 Test Loss: 1.303 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.006627082824707
Epoch: 31, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.319 Vali Acc: 0.527 Test Loss: 1.319 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1399946212768555
Epoch: 32, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0323405265808105
Epoch: 33, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.396 Vali Acc: 0.527 Test Loss: 1.396 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0319643020629883
Epoch: 34, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 20100
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.020742416381836
Epoch: 1, Steps: 10 | Train Loss: 1.555 Vali Loss: 1.455 Vali Acc: 0.311 Test Loss: 1.455 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 0.9901022911071777
Epoch: 2, Steps: 10 | Train Loss: 1.561 Vali Loss: 1.428 Vali Acc: 0.338 Test Loss: 1.428 Test Acc: 0.338
Validation loss decreased (-0.310796 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.07206130027771
Epoch: 3, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.411 Vali Acc: 0.311 Test Loss: 1.411 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0377368927001953
Epoch: 4, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.375 Vali Acc: 0.324 Test Loss: 1.375 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9971048831939697
Epoch: 5, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.345 Vali Acc: 0.338 Test Loss: 1.345 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 0.8796019554138184
Epoch: 6, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.306 Vali Acc: 0.405 Test Loss: 1.306 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 0.9679720401763916
Epoch: 7, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.290 Vali Acc: 0.365 Test Loss: 1.290 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9386875629425049
Epoch: 8, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.261 Vali Acc: 0.365 Test Loss: 1.261 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8559362888336182
Epoch: 9, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 10 cost time: 0.8924140930175781
Epoch: 10, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.206 Vali Acc: 0.432 Test Loss: 1.206 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 11 cost time: 0.8869643211364746
Epoch: 11, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.203 Vali Acc: 0.459 Test Loss: 1.203 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 12 cost time: 1.0565788745880127
Epoch: 12, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.188 Vali Acc: 0.459 Test Loss: 1.188 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 13 cost time: 0.981036901473999
Epoch: 13, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 14 cost time: 0.9605875015258789
Epoch: 14, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.176 Vali Acc: 0.459 Test Loss: 1.176 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9335925579071045
Epoch: 15, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.159 Vali Acc: 0.473 Test Loss: 1.159 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 16 cost time: 0.8260571956634521
Epoch: 16, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 1.0105350017547607
Epoch: 17, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.169 Vali Acc: 0.419 Test Loss: 1.169 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9233443737030029
Epoch: 18, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.166 Vali Acc: 0.446 Test Loss: 1.166 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0618412494659424
Epoch: 19, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.158 Vali Acc: 0.446 Test Loss: 1.158 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9350879192352295
Epoch: 20, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0519788265228271
Epoch: 21, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0975408554077148
Epoch: 22, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.163 Vali Acc: 0.486 Test Loss: 1.163 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0256519317626953
Epoch: 23, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.101393222808838
Epoch: 24, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0198390483856201
Epoch: 25, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.194 Vali Acc: 0.473 Test Loss: 1.194 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0971317291259766
Epoch: 26, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 18500
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9995150566101074
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.445 Vali Acc: 0.243 Test Loss: 1.445 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9771976470947266
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.444 Vali Acc: 0.230 Test Loss: 1.444 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0900723934173584
Epoch: 3, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.421 Vali Acc: 0.284 Test Loss: 1.421 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.0001113414764404
Epoch: 4, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.401 Vali Acc: 0.297 Test Loss: 1.401 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 0.9852731227874756
Epoch: 5, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.380 Vali Acc: 0.297 Test Loss: 1.380 Test Acc: 0.297
Validation loss decreased (-0.297283 --> -0.297284).  Saving model ...
Epoch: 6 cost time: 0.9523372650146484
Epoch: 6, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.360 Vali Acc: 0.297 Test Loss: 1.360 Test Acc: 0.297
Validation loss decreased (-0.297284 --> -0.297284).  Saving model ...
Epoch: 7 cost time: 0.9865882396697998
Epoch: 7, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.346 Vali Acc: 0.324 Test Loss: 1.346 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 8 cost time: 0.9491915702819824
Epoch: 8, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337825).  Saving model ...
Epoch: 9 cost time: 1.0150880813598633
Epoch: 9, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.313 Vali Acc: 0.392 Test Loss: 1.313 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 10 cost time: 0.8494234085083008
Epoch: 10, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.302 Vali Acc: 0.419 Test Loss: 1.302 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 11 cost time: 1.0565593242645264
Epoch: 11, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.292 Vali Acc: 0.405 Test Loss: 1.292 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8946034908294678
Epoch: 12, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.284 Vali Acc: 0.405 Test Loss: 1.284 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0814306735992432
Epoch: 13, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 14 cost time: 1.005141019821167
Epoch: 14, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.259 Vali Acc: 0.473 Test Loss: 1.259 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 15 cost time: 1.026677131652832
Epoch: 15, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.250 Vali Acc: 0.446 Test Loss: 1.250 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9104833602905273
Epoch: 16, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.935171365737915
Epoch: 17, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.229 Vali Acc: 0.446 Test Loss: 1.229 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9118876457214355
Epoch: 18, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 19 cost time: 0.9332702159881592
Epoch: 19, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0062799453735352
Epoch: 20, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0298089981079102
Epoch: 21, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9474756717681885
Epoch: 22, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0198230743408203
Epoch: 23, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.219 Vali Acc: 0.459 Test Loss: 1.219 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9452414512634277
Epoch: 24, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.220 Vali Acc: 0.473 Test Loss: 1.220 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0934317111968994
Epoch: 25, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.236 Vali Acc: 0.473 Test Loss: 1.236 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1317853927612305
Epoch: 26, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0767688751220703
Epoch: 27, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.274 Vali Acc: 0.473 Test Loss: 1.274 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.074289083480835
Epoch: 28, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.293 Vali Acc: 0.473 Test Loss: 1.293 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 17540
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.37893009185791
Epoch: 1, Steps: 10 | Train Loss: 1.626 Vali Loss: 1.415 Vali Acc: 0.230 Test Loss: 1.415 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.6604535579681396
Epoch: 2, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.442 Vali Acc: 0.351 Test Loss: 1.442 Test Acc: 0.351
Validation loss decreased (-0.229716 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 1.2984671592712402
Epoch: 3, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
Validation loss decreased (-0.351337 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.624988317489624
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.372 Vali Acc: 0.432 Test Loss: 1.372 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4844591617584229
Epoch: 5, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.136 Vali Acc: 0.527 Test Loss: 1.136 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.430305004119873
Epoch: 6, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.207 Vali Acc: 0.459 Test Loss: 1.207 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6660566329956055
Epoch: 7, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.559248447418213
Epoch: 8, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4547278881072998
Epoch: 9, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4675092697143555
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4140381813049316
Epoch: 11, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.252 Vali Acc: 0.514 Test Loss: 1.252 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.605703592300415
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4796168804168701
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.274 Vali Acc: 0.541 Test Loss: 1.274 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 14 cost time: 1.5322299003601074
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.337 Vali Acc: 0.500 Test Loss: 1.337 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7114367485046387
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4728975296020508
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.393 Vali Acc: 0.514 Test Loss: 1.393 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7895703315734863
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.426 Vali Acc: 0.527 Test Loss: 1.426 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7618441581726074
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8694446086883545
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.486 Vali Acc: 0.514 Test Loss: 1.486 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7316219806671143
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.501 Vali Acc: 0.514 Test Loss: 1.501 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3799283504486084
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.516 Vali Acc: 0.500 Test Loss: 1.516 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5102760791778564
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.528 Vali Acc: 0.500 Test Loss: 1.528 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6788392066955566
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 57956
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.732844829559326
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.9255211353302002
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.321 Vali Acc: 0.446 Test Loss: 1.321 Test Acc: 0.446
Validation loss decreased (-0.297283 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.9292621612548828
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.291 Vali Acc: 0.446 Test Loss: 1.291 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.937549352645874
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.257 Vali Acc: 0.446 Test Loss: 1.257 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.8340842723846436
Epoch: 5, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.213 Vali Acc: 0.432 Test Loss: 1.213 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8483202457427979
Epoch: 6, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.9923803806304932
Epoch: 7, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.167 Vali Acc: 0.446 Test Loss: 1.167 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.971306562423706
Epoch: 8, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.149 Vali Acc: 0.459 Test Loss: 1.149 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9065258502960205
Epoch: 9, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.163 Vali Acc: 0.459 Test Loss: 1.163 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8844499588012695
Epoch: 10, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 0.9663369655609131
Epoch: 11, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.129 Vali Acc: 0.486 Test Loss: 1.129 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.992664098739624
Epoch: 12, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9678966999053955
Epoch: 13, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.0452616214752197
Epoch: 14, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 15 cost time: 1.0009453296661377
Epoch: 15, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9185941219329834
Epoch: 16, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0514860153198242
Epoch: 17, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9610600471496582
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.221 Vali Acc: 0.514 Test Loss: 1.221 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9462740421295166
Epoch: 19, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.264 Vali Acc: 0.514 Test Loss: 1.264 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9094963073730469
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.266 Vali Acc: 0.486 Test Loss: 1.266 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9690005779266357
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.295 Vali Acc: 0.541 Test Loss: 1.295 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 22 cost time: 0.9354357719421387
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.295 Vali Acc: 0.541 Test Loss: 1.295 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9213035106658936
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.304 Vali Acc: 0.514 Test Loss: 1.304 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9604494571685791
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8940339088439941
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.032825231552124
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.353 Vali Acc: 0.514 Test Loss: 1.353 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0310962200164795
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.376 Vali Acc: 0.514 Test Loss: 1.376 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9831278324127197
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.379 Vali Acc: 0.514 Test Loss: 1.379 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9534530639648438
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.391 Vali Acc: 0.514 Test Loss: 1.391 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0857470035552979
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.398 Vali Acc: 0.541 Test Loss: 1.398 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.997638463973999
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.401 Vali Acc: 0.541 Test Loss: 1.401 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 32516
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5723915100097656
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.420 Vali Acc: 0.284 Test Loss: 1.420 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9390971660614014
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.415 Vali Acc: 0.311 Test Loss: 1.415 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.8647315502166748
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.413 Vali Acc: 0.324 Test Loss: 1.413 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 0.911973237991333
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.376 Vali Acc: 0.270 Test Loss: 1.376 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0659399032592773
Epoch: 5, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.343 Vali Acc: 0.324 Test Loss: 1.343 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 6 cost time: 0.946807861328125
Epoch: 6, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.351 Vali Acc: 0.405 Test Loss: 1.351 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 0.9199879169464111
Epoch: 7, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.299 Vali Acc: 0.446 Test Loss: 1.299 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 0.9866492748260498
Epoch: 8, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.269 Vali Acc: 0.419 Test Loss: 1.269 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9612493515014648
Epoch: 9, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.299 Vali Acc: 0.446 Test Loss: 1.299 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 10 cost time: 0.9440498352050781
Epoch: 10, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.250 Vali Acc: 0.432 Test Loss: 1.250 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9991333484649658
Epoch: 11, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.262 Vali Acc: 0.446 Test Loss: 1.262 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 12 cost time: 0.8982253074645996
Epoch: 12, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.268 Vali Acc: 0.405 Test Loss: 1.268 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0019469261169434
Epoch: 13, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0078513622283936
Epoch: 14, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.263 Vali Acc: 0.446 Test Loss: 1.263 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.055431604385376
Epoch: 15, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.292 Vali Acc: 0.473 Test Loss: 1.292 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 16 cost time: 0.9885857105255127
Epoch: 16, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.262 Vali Acc: 0.459 Test Loss: 1.262 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.005418062210083
Epoch: 17, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.277 Vali Acc: 0.473 Test Loss: 1.277 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 18 cost time: 0.9336714744567871
Epoch: 18, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.314 Vali Acc: 0.486 Test Loss: 1.314 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486473).  Saving model ...
Epoch: 19 cost time: 1.0476200580596924
Epoch: 19, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.339 Vali Acc: 0.459 Test Loss: 1.339 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1673023700714111
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499986).  Saving model ...
Epoch: 21 cost time: 1.047299861907959
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.391 Vali Acc: 0.473 Test Loss: 1.391 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9293758869171143
Epoch: 22, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9652564525604248
Epoch: 23, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.390 Vali Acc: 0.473 Test Loss: 1.390 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.048673152923584
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.425 Vali Acc: 0.486 Test Loss: 1.425 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9490575790405273
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9227628707885742
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.455 Vali Acc: 0.473 Test Loss: 1.455 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0299015045166016
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.476 Vali Acc: 0.473 Test Loss: 1.476 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.083139419555664
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.493 Vali Acc: 0.459 Test Loss: 1.493 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0428309440612793
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.524 Vali Acc: 0.473 Test Loss: 1.524 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9882361888885498
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.524 Vali Acc: 0.486 Test Loss: 1.524 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 23716
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5209121704101562
Epoch: 1, Steps: 10 | Train Loss: 1.536 Vali Loss: 1.388 Vali Acc: 0.284 Test Loss: 1.388 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9402370452880859
Epoch: 2, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.381 Vali Acc: 0.297 Test Loss: 1.381 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 1.1110002994537354
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.367 Vali Acc: 0.392 Test Loss: 1.367 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 0.8589932918548584
Epoch: 4, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.335 Vali Acc: 0.365 Test Loss: 1.335 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9668369293212891
Epoch: 5, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.276 Vali Acc: 0.392 Test Loss: 1.276 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.9308881759643555
Epoch: 6, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.264 Vali Acc: 0.378 Test Loss: 1.264 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9498960971832275
Epoch: 7, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.235 Vali Acc: 0.432 Test Loss: 1.235 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 1.0258564949035645
Epoch: 8, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.212 Vali Acc: 0.419 Test Loss: 1.212 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.968353271484375
Epoch: 9, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.184 Vali Acc: 0.446 Test Loss: 1.184 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 1.0926177501678467
Epoch: 10, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 0.98907470703125
Epoch: 11, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.143 Vali Acc: 0.473 Test Loss: 1.143 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0052134990692139
Epoch: 12, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.015101671218872
Epoch: 13, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.128 Vali Acc: 0.486 Test Loss: 1.128 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.025378704071045
Epoch: 14, Steps: 10 | Train Loss: 0.482 Vali Loss: 1.136 Vali Acc: 0.486 Test Loss: 1.136 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.028505563735962
Epoch: 15, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.129 Vali Acc: 0.514 Test Loss: 1.129 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 0.9884307384490967
Epoch: 16, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.008678913116455
Epoch: 17, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 18 cost time: 0.9499208927154541
Epoch: 18, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9636788368225098
Epoch: 19, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.162 Vali Acc: 0.541 Test Loss: 1.162 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9796552658081055
Epoch: 20, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.137 Vali Acc: 0.554 Test Loss: 1.137 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 21 cost time: 1.0114831924438477
Epoch: 21, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.150 Vali Acc: 0.568 Test Loss: 1.150 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 22 cost time: 1.0010347366333008
Epoch: 22, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.181 Vali Acc: 0.541 Test Loss: 1.181 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9572165012359619
Epoch: 23, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.187 Vali Acc: 0.527 Test Loss: 1.187 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9432275295257568
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.201 Vali Acc: 0.554 Test Loss: 1.201 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.015681266784668
Epoch: 25, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.224 Vali Acc: 0.527 Test Loss: 1.224 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9617328643798828
Epoch: 26, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9492158889770508
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.253 Vali Acc: 0.541 Test Loss: 1.253 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1627860069274902
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.280 Vali Acc: 0.541 Test Loss: 1.280 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9672062397003174
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.288 Vali Acc: 0.541 Test Loss: 1.288 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9802775382995605
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.300 Vali Acc: 0.541 Test Loss: 1.300 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9589951038360596
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.318 Vali Acc: 0.568 Test Loss: 1.318 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 20036
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5322585105895996
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.489 Vali Acc: 0.257 Test Loss: 1.489 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.9171483516693115
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.445 Vali Acc: 0.284 Test Loss: 1.445 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 0.9233958721160889
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.419 Vali Acc: 0.311 Test Loss: 1.419 Test Acc: 0.311
Validation loss decreased (-0.283769 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.8370718955993652
Epoch: 4, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.397 Vali Acc: 0.297 Test Loss: 1.397 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8520193099975586
Epoch: 5, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.372 Vali Acc: 0.324 Test Loss: 1.372 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 6 cost time: 0.8332173824310303
Epoch: 6, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.351 Vali Acc: 0.338 Test Loss: 1.351 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 7 cost time: 0.8274011611938477
Epoch: 7, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.325 Vali Acc: 0.351 Test Loss: 1.325 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 8 cost time: 0.841951847076416
Epoch: 8, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.304 Vali Acc: 0.392 Test Loss: 1.304 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 0.9741971492767334
Epoch: 9, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.275 Vali Acc: 0.405 Test Loss: 1.275 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 10 cost time: 0.8362953662872314
Epoch: 10, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 11 cost time: 0.8824796676635742
Epoch: 11, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.247 Vali Acc: 0.432 Test Loss: 1.247 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 0.9074699878692627
Epoch: 12, Steps: 10 | Train Loss: 0.771 Vali Loss: 1.232 Vali Acc: 0.459 Test Loss: 1.232 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 13 cost time: 0.8595616817474365
Epoch: 13, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.9460954666137695
Epoch: 14, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.7919800281524658
Epoch: 15, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8912465572357178
Epoch: 16, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9637777805328369
Epoch: 17, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 18 cost time: 0.8648791313171387
Epoch: 18, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8846633434295654
Epoch: 19, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8851807117462158
Epoch: 20, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9722695350646973
Epoch: 21, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9458577632904053
Epoch: 22, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.243 Vali Acc: 0.486 Test Loss: 1.243 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9060149192810059
Epoch: 23, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.265 Vali Acc: 0.486 Test Loss: 1.265 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.950413703918457
Epoch: 24, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.276 Vali Acc: 0.486 Test Loss: 1.276 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9481246471405029
Epoch: 25, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.289 Vali Acc: 0.514 Test Loss: 1.289 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9526777267456055
Epoch: 26, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8712935447692871
Epoch: 27, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.328 Vali Acc: 0.486 Test Loss: 1.328 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 15876
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5412521362304688
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.480 Vali Acc: 0.230 Test Loss: 1.480 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.8880689144134521
Epoch: 2, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.482 Vali Acc: 0.216 Test Loss: 1.482 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9021787643432617
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.467 Vali Acc: 0.230 Test Loss: 1.467 Test Acc: 0.230
Validation loss decreased (-0.229715 --> -0.229715).  Saving model ...
Epoch: 4 cost time: 0.8671705722808838
Epoch: 4, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.448 Vali Acc: 0.230 Test Loss: 1.448 Test Acc: 0.230
Validation loss decreased (-0.229715 --> -0.229715).  Saving model ...
Epoch: 5 cost time: 0.901165246963501
Epoch: 5, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.419 Vali Acc: 0.297 Test Loss: 1.419 Test Acc: 0.297
Validation loss decreased (-0.229715 --> -0.297283).  Saving model ...
Epoch: 6 cost time: 0.9504311084747314
Epoch: 6, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.389 Vali Acc: 0.351 Test Loss: 1.389 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351337).  Saving model ...
Epoch: 7 cost time: 0.8789191246032715
Epoch: 7, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.361 Vali Acc: 0.419 Test Loss: 1.361 Test Acc: 0.419
Validation loss decreased (-0.351337 --> -0.418905).  Saving model ...
Epoch: 8 cost time: 0.9308371543884277
Epoch: 8, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.340 Vali Acc: 0.392 Test Loss: 1.340 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8548276424407959
Epoch: 9, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.308 Vali Acc: 0.419 Test Loss: 1.308 Test Acc: 0.419
Validation loss decreased (-0.418905 --> -0.418906).  Saving model ...
Epoch: 10 cost time: 0.945101261138916
Epoch: 10, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.280 Vali Acc: 0.419 Test Loss: 1.280 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 11 cost time: 0.9949061870574951
Epoch: 11, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.262 Vali Acc: 0.473 Test Loss: 1.262 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 12 cost time: 1.0573322772979736
Epoch: 12, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.243 Vali Acc: 0.473 Test Loss: 1.243 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 13 cost time: 0.9585452079772949
Epoch: 13, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.0085675716400146
Epoch: 14, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2214386463165283
Epoch: 15, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9798996448516846
Epoch: 16, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.225 Vali Acc: 0.459 Test Loss: 1.225 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9348104000091553
Epoch: 17, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1988401412963867
Epoch: 18, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9168739318847656
Epoch: 19, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 20 cost time: 1.0151915550231934
Epoch: 20, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9422163963317871
Epoch: 21, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.203 Vali Acc: 0.459 Test Loss: 1.203 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9514517784118652
Epoch: 22, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.210 Vali Acc: 0.486 Test Loss: 1.210 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3124585151672363
Epoch: 23, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9304587841033936
Epoch: 24, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.027618169784546
Epoch: 25, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.229 Vali Acc: 0.486 Test Loss: 1.229 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.948685884475708
Epoch: 26, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.934962272644043
Epoch: 27, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9464781284332275
Epoch: 28, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2582597732543945
Epoch: 29, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 14276
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.607114791870117
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.468 Vali Acc: 0.203 Test Loss: 1.468 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.9097638130187988
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.449 Vali Acc: 0.257 Test Loss: 1.449 Test Acc: 0.257
Validation loss decreased (-0.202688 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 0.9665987491607666
Epoch: 3, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.440 Vali Acc: 0.243 Test Loss: 1.440 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9437625408172607
Epoch: 4, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
Validation loss decreased (-0.256742 --> -0.270256).  Saving model ...
Epoch: 5 cost time: 0.9005086421966553
Epoch: 5, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.405 Vali Acc: 0.284 Test Loss: 1.405 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 6 cost time: 0.8948984146118164
Epoch: 6, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.373 Vali Acc: 0.284 Test Loss: 1.373 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 7 cost time: 0.8968639373779297
Epoch: 7, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.348 Vali Acc: 0.324 Test Loss: 1.348 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 8 cost time: 0.9952390193939209
Epoch: 8, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.320 Vali Acc: 0.351 Test Loss: 1.320 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 9 cost time: 1.0272572040557861
Epoch: 9, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.322 Vali Acc: 0.392 Test Loss: 1.322 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 10 cost time: 1.0161406993865967
Epoch: 10, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.300 Vali Acc: 0.392 Test Loss: 1.300 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 11 cost time: 0.9009122848510742
Epoch: 11, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.268 Vali Acc: 0.392 Test Loss: 1.268 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 12 cost time: 0.9268927574157715
Epoch: 12, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 13 cost time: 0.797382116317749
Epoch: 13, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8904438018798828
Epoch: 14, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.226 Vali Acc: 0.446 Test Loss: 1.226 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8718488216400146
Epoch: 15, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.219 Vali Acc: 0.432 Test Loss: 1.219 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9619140625
Epoch: 16, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.213 Vali Acc: 0.446 Test Loss: 1.213 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8002209663391113
Epoch: 17, Steps: 10 | Train Loss: 0.638 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 18 cost time: 0.8856992721557617
Epoch: 18, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.203 Vali Acc: 0.473 Test Loss: 1.203 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.813342809677124
Epoch: 19, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 20 cost time: 1.0287163257598877
Epoch: 20, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.194 Vali Acc: 0.459 Test Loss: 1.194 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.916182279586792
Epoch: 21, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9343607425689697
Epoch: 22, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 23 cost time: 0.9301149845123291
Epoch: 23, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9496090412139893
Epoch: 24, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9132604598999023
Epoch: 25, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9734542369842529
Epoch: 26, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.016211748123169
Epoch: 27, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0464866161346436
Epoch: 28, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.168081283569336
Epoch: 29, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.248 Vali Acc: 0.514 Test Loss: 1.248 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9405548572540283
Epoch: 30, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.256 Vali Acc: 0.514 Test Loss: 1.256 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9811255931854248
Epoch: 31, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.262 Vali Acc: 0.514 Test Loss: 1.262 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9117774963378906
Epoch: 32, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el2_dm16_nh4_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 13316
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.061647891998291
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.586 Vali Acc: 0.203 Test Loss: 1.586 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 1.1918604373931885
Epoch: 2, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.327 Vali Acc: 0.446 Test Loss: 1.327 Test Acc: 0.446
Validation loss decreased (-0.202687 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.262610673904419
Epoch: 3, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.617 Vali Acc: 0.473 Test Loss: 1.617 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472957).  Saving model ...
Epoch: 4 cost time: 1.3411765098571777
Epoch: 4, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.486 Vali Acc: 0.500 Test Loss: 1.486 Test Acc: 0.500
Validation loss decreased (-0.472957 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 1.117699146270752
Epoch: 5, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.676 Vali Acc: 0.527 Test Loss: 1.676 Test Acc: 0.527
Validation loss decreased (-0.499985 --> -0.527010).  Saving model ...
Epoch: 6 cost time: 1.1423571109771729
Epoch: 6, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.979 Vali Acc: 0.554 Test Loss: 1.979 Test Acc: 0.554
Validation loss decreased (-0.527010 --> -0.554034).  Saving model ...
Epoch: 7 cost time: 1.1682891845703125
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.039 Vali Acc: 0.500 Test Loss: 2.039 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2925078868865967
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.725 Vali Acc: 0.514 Test Loss: 2.725 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2610442638397217
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.505 Vali Acc: 0.541 Test Loss: 2.505 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3429102897644043
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.636 Vali Acc: 0.554 Test Loss: 2.636 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2677578926086426
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.301 Vali Acc: 0.405 Test Loss: 3.301 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3419849872589111
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.641 Vali Acc: 0.527 Test Loss: 3.641 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2200381755828857
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.256 Vali Acc: 0.459 Test Loss: 3.256 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2783043384552002
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.690 Vali Acc: 0.527 Test Loss: 3.690 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3930895328521729
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.786 Vali Acc: 0.419 Test Loss: 3.786 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2265410423278809
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.586 Vali Acc: 0.500 Test Loss: 4.586 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 543620
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.663118839263916
Epoch: 1, Steps: 10 | Train Loss: 1.536 Vali Loss: 1.303 Vali Acc: 0.324 Test Loss: 1.303 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.9575662612915039
Epoch: 2, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.249 Vali Acc: 0.419 Test Loss: 1.249 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9741511344909668
Epoch: 3, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.364 Vali Acc: 0.459 Test Loss: 1.364 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 0.9052960872650146
Epoch: 4, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.9258847236633301
Epoch: 5, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.529 Vali Acc: 0.459 Test Loss: 1.529 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9712979793548584
Epoch: 6, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.490 Vali Acc: 0.500 Test Loss: 1.490 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9729526042938232
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.498 Vali Acc: 0.514 Test Loss: 1.498 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513499).  Saving model ...
Epoch: 8 cost time: 0.92156982421875
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.721 Vali Acc: 0.554 Test Loss: 1.721 Test Acc: 0.554
Validation loss decreased (-0.513499 --> -0.554037).  Saving model ...
Epoch: 9 cost time: 0.8881604671478271
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.855 Vali Acc: 0.527 Test Loss: 1.855 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8971490859985352
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.884 Vali Acc: 0.541 Test Loss: 1.884 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9228768348693848
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.099 Vali Acc: 0.514 Test Loss: 2.099 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0103754997253418
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.088 Vali Acc: 0.514 Test Loss: 2.088 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.090308427810669
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.049 Vali Acc: 0.554 Test Loss: 2.049 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0140314102172852
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.981 Vali Acc: 0.568 Test Loss: 1.981 Test Acc: 0.568
Validation loss decreased (-0.554037 --> -0.567548).  Saving model ...
Epoch: 15 cost time: 0.894578218460083
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.015 Vali Acc: 0.541 Test Loss: 2.015 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1475236415863037
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.044 Vali Acc: 0.500 Test Loss: 2.044 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0837643146514893
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.037 Vali Acc: 0.514 Test Loss: 2.037 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9851899147033691
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.033 Vali Acc: 0.514 Test Loss: 2.033 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0198116302490234
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.043 Vali Acc: 0.527 Test Loss: 2.043 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0512287616729736
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.063 Vali Acc: 0.514 Test Loss: 2.063 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9407720565795898
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.076 Vali Acc: 0.527 Test Loss: 2.076 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0091822147369385
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9787759780883789
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.071 Vali Acc: 0.500 Test Loss: 2.071 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0435211658477783
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 340100
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.07788348197937
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.297 Vali Acc: 0.419 Test Loss: 1.297 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 0.8837387561798096
Epoch: 2, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.9738290309906006
Epoch: 3, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 0.9182465076446533
Epoch: 4, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8284680843353271
Epoch: 5, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.228 Vali Acc: 0.514 Test Loss: 1.228 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9407749176025391
Epoch: 6, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.239 Vali Acc: 0.554 Test Loss: 1.239 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.8784708976745605
Epoch: 7, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.393 Vali Acc: 0.527 Test Loss: 1.393 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8466153144836426
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.403 Vali Acc: 0.554 Test Loss: 1.403 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8926382064819336
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.387 Vali Acc: 0.554 Test Loss: 1.387 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.882307767868042
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9760360717773438
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.571 Vali Acc: 0.554 Test Loss: 1.571 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0313644409179688
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.685 Vali Acc: 0.527 Test Loss: 1.685 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8863184452056885
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.708 Vali Acc: 0.581 Test Loss: 1.708 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581064).  Saving model ...
Epoch: 14 cost time: 0.87465500831604
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.679 Vali Acc: 0.541 Test Loss: 1.679 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9165081977844238
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.666 Vali Acc: 0.514 Test Loss: 1.666 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0062687397003174
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.665 Vali Acc: 0.514 Test Loss: 1.665 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8692123889923096
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.668 Vali Acc: 0.541 Test Loss: 1.668 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0385868549346924
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.541 Test Loss: 1.689 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0248427391052246
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.707 Vali Acc: 0.554 Test Loss: 1.707 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.045325756072998
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.554 Test Loss: 1.730 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9957542419433594
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.541 Test Loss: 1.737 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0652570724487305
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.541 Test Loss: 1.744 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.000960111618042
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.527 Test Loss: 1.750 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 269700
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7176387310028076
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.355 Vali Acc: 0.311 Test Loss: 1.355 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9775583744049072
Epoch: 2, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.0829763412475586
Epoch: 3, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.183 Vali Acc: 0.446 Test Loss: 1.183 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9981412887573242
Epoch: 4, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.199 Vali Acc: 0.459 Test Loss: 1.199 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.0825815200805664
Epoch: 5, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.287 Vali Acc: 0.473 Test Loss: 1.287 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.11220383644104
Epoch: 6, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.9776360988616943
Epoch: 7, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.333 Vali Acc: 0.527 Test Loss: 1.333 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527014).  Saving model ...
Epoch: 8 cost time: 0.963496208190918
Epoch: 8, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.493 Vali Acc: 0.554 Test Loss: 1.493 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554039).  Saving model ...
Epoch: 9 cost time: 0.986203670501709
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.556 Vali Acc: 0.459 Test Loss: 1.556 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0160620212554932
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.569 Vali Acc: 0.541 Test Loss: 1.569 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0422282218933105
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.602 Vali Acc: 0.527 Test Loss: 1.602 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9231586456298828
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.650 Vali Acc: 0.541 Test Loss: 1.650 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1340501308441162
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.674 Vali Acc: 0.500 Test Loss: 1.674 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9915196895599365
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.645 Vali Acc: 0.500 Test Loss: 1.645 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0476315021514893
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.641 Vali Acc: 0.514 Test Loss: 1.641 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9915502071380615
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.681 Vali Acc: 0.527 Test Loss: 1.681 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9295554161071777
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.711 Vali Acc: 0.500 Test Loss: 1.711 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9601337909698486
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.736 Vali Acc: 0.500 Test Loss: 1.736 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 240260
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2693543434143066
Epoch: 1, Steps: 10 | Train Loss: 1.536 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.0994465351104736
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.319 Vali Acc: 0.405 Test Loss: 1.319 Test Acc: 0.405
Validation loss decreased (-0.297283 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.0495867729187012
Epoch: 3, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.0131161212921143
Epoch: 4, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.161 Vali Acc: 0.568 Test Loss: 1.161 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 1.0336754322052002
Epoch: 5, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.155 Vali Acc: 0.486 Test Loss: 1.155 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0835340023040771
Epoch: 6, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.154 Vali Acc: 0.554 Test Loss: 1.154 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.093461036682129
Epoch: 7, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.015066385269165
Epoch: 8, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.250 Vali Acc: 0.581 Test Loss: 1.250 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 1.0814058780670166
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.284 Vali Acc: 0.541 Test Loss: 1.284 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1072189807891846
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.366 Vali Acc: 0.527 Test Loss: 1.366 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0862550735473633
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.378 Vali Acc: 0.541 Test Loss: 1.378 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9502654075622559
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.397 Vali Acc: 0.581 Test Loss: 1.397 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0192811489105225
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.459 Vali Acc: 0.568 Test Loss: 1.459 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9470908641815186
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.483 Vali Acc: 0.595 Test Loss: 1.483 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594580).  Saving model ...
Epoch: 15 cost time: 1.1119294166564941
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.501 Vali Acc: 0.581 Test Loss: 1.501 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9127027988433838
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.494 Vali Acc: 0.608 Test Loss: 1.494 Test Acc: 0.608
Validation loss decreased (-0.594580 --> -0.608093).  Saving model ...
Epoch: 17 cost time: 0.9564146995544434
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.515 Vali Acc: 0.595 Test Loss: 1.515 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1145977973937988
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.561 Vali Acc: 0.568 Test Loss: 1.561 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9206786155700684
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.591 Vali Acc: 0.568 Test Loss: 1.591 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8946173191070557
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.605 Vali Acc: 0.581 Test Loss: 1.605 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1246700286865234
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.615 Vali Acc: 0.581 Test Loss: 1.615 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.070127248764038
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.581 Test Loss: 1.630 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9458198547363281
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.652 Vali Acc: 0.581 Test Loss: 1.652 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.032573938369751
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.672 Vali Acc: 0.581 Test Loss: 1.672 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9653873443603516
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.581 Test Loss: 1.683 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0447986125946045
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.581 Test Loss: 1.689 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 206980
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.299565553665161
Epoch: 1, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.424 Vali Acc: 0.243 Test Loss: 1.424 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.2635140419006348
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.346 Vali Acc: 0.432 Test Loss: 1.346 Test Acc: 0.432
Validation loss decreased (-0.243229 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.2073781490325928
Epoch: 3, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.230 Vali Acc: 0.419 Test Loss: 1.230 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2699909210205078
Epoch: 4, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.223 Vali Acc: 0.405 Test Loss: 1.223 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2610962390899658
Epoch: 5, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1026344299316406
Epoch: 6, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.208000659942627
Epoch: 7, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3165040016174316
Epoch: 8, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.193 Vali Acc: 0.554 Test Loss: 1.193 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.2591743469238281
Epoch: 9, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.222 Vali Acc: 0.568 Test Loss: 1.222 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 10 cost time: 1.2113897800445557
Epoch: 10, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.268 Vali Acc: 0.568 Test Loss: 1.268 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9154362678527832
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.356 Vali Acc: 0.554 Test Loss: 1.356 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.290602445602417
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.335 Vali Acc: 0.541 Test Loss: 1.335 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1705944538116455
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.385 Vali Acc: 0.554 Test Loss: 1.385 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2937121391296387
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.433 Vali Acc: 0.554 Test Loss: 1.433 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0613348484039307
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.460 Vali Acc: 0.595 Test Loss: 1.460 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594580).  Saving model ...
Epoch: 16 cost time: 1.0873525142669678
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.510 Vali Acc: 0.581 Test Loss: 1.510 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1679089069366455
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.557 Vali Acc: 0.568 Test Loss: 1.557 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1970503330230713
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.542 Vali Acc: 0.568 Test Loss: 1.542 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1490001678466797
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.566 Vali Acc: 0.568 Test Loss: 1.566 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1932933330535889
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.572 Vali Acc: 0.568 Test Loss: 1.572 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1383321285247803
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.582 Vali Acc: 0.568 Test Loss: 1.582 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1643884181976318
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.577 Vali Acc: 0.568 Test Loss: 1.577 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2554161548614502
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.590 Vali Acc: 0.568 Test Loss: 1.590 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2819652557373047
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.615 Vali Acc: 0.568 Test Loss: 1.615 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2864258289337158
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.626 Vali Acc: 0.568 Test Loss: 1.626 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 194180
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1304116249084473
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.414 Vali Acc: 0.311 Test Loss: 1.414 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0315961837768555
Epoch: 2, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.328 Vali Acc: 0.378 Test Loss: 1.328 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.1921823024749756
Epoch: 3, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.243 Vali Acc: 0.446 Test Loss: 1.243 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.2056047916412354
Epoch: 4, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.203 Vali Acc: 0.446 Test Loss: 1.203 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.3189799785614014
Epoch: 5, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.3015727996826172
Epoch: 6, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3255119323730469
Epoch: 7, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.177 Vali Acc: 0.486 Test Loss: 1.177 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0513677597045898
Epoch: 8, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.3245224952697754
Epoch: 9, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.211 Vali Acc: 0.541 Test Loss: 1.211 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 1.1431794166564941
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.243 Vali Acc: 0.554 Test Loss: 1.243 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.1286771297454834
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1872527599334717
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.362 Vali Acc: 0.514 Test Loss: 1.362 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.185427188873291
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.457 Vali Acc: 0.554 Test Loss: 1.457 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2904868125915527
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.476 Vali Acc: 0.514 Test Loss: 1.476 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3775711059570312
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.531 Vali Acc: 0.514 Test Loss: 1.531 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2609617710113525
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.594 Vali Acc: 0.541 Test Loss: 1.594 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0456178188323975
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.635 Vali Acc: 0.541 Test Loss: 1.635 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1535189151763916
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.646 Vali Acc: 0.541 Test Loss: 1.646 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0310850143432617
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.661 Vali Acc: 0.541 Test Loss: 1.661 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2230908870697021
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.678 Vali Acc: 0.541 Test Loss: 1.678 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 186500
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5545122623443604
Epoch: 1, Steps: 10 | Train Loss: 1.540 Vali Loss: 1.340 Vali Acc: 0.432 Test Loss: 1.340 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.5952868461608887
Epoch: 2, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.299 Vali Acc: 0.432 Test Loss: 1.299 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.6162176132202148
Epoch: 3, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.357 Vali Acc: 0.486 Test Loss: 1.357 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 1.38615083694458
Epoch: 4, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.804 Vali Acc: 0.405 Test Loss: 1.804 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6634409427642822
Epoch: 5, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.984 Vali Acc: 0.432 Test Loss: 1.984 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6339375972747803
Epoch: 6, Steps: 10 | Train Loss: 0.097 Vali Loss: 2.356 Vali Acc: 0.432 Test Loss: 2.356 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.55320405960083
Epoch: 7, Steps: 10 | Train Loss: 0.080 Vali Loss: 2.682 Vali Acc: 0.486 Test Loss: 2.682 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.55324125289917
Epoch: 8, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.027 Vali Acc: 0.419 Test Loss: 3.027 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7090709209442139
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 2.856 Vali Acc: 0.432 Test Loss: 2.856 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.554030179977417
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.351 Vali Acc: 0.527 Test Loss: 3.351 Test Acc: 0.527
Validation loss decreased (-0.486473 --> -0.526994).  Saving model ...
Epoch: 11 cost time: 1.6950666904449463
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.633 Vali Acc: 0.486 Test Loss: 3.633 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5474584102630615
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.757 Vali Acc: 0.446 Test Loss: 3.757 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3993492126464844
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.412 Vali Acc: 0.419 Test Loss: 5.412 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.737290382385254
Epoch: 14, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.246 Vali Acc: 0.541 Test Loss: 4.246 Test Acc: 0.541
Validation loss decreased (-0.526994 --> -0.540498).  Saving model ...
Epoch: 15 cost time: 1.6242609024047852
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.027 Vali Acc: 0.554 Test Loss: 4.027 Test Acc: 0.554
Validation loss decreased (-0.540498 --> -0.554014).  Saving model ...
Epoch: 16 cost time: 1.647270917892456
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.234 Vali Acc: 0.459 Test Loss: 4.234 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6434433460235596
Epoch: 17, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.750 Vali Acc: 0.514 Test Loss: 4.750 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5624704360961914
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.148 Vali Acc: 0.446 Test Loss: 5.148 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5792717933654785
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.757 Vali Acc: 0.486 Test Loss: 5.757 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.706376314163208
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.159 Vali Acc: 0.473 Test Loss: 5.159 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.732572317123413
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.518 Vali Acc: 0.514 Test Loss: 5.518 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.602062702178955
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.363 Vali Acc: 0.486 Test Loss: 5.363 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6270406246185303
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.034 Vali Acc: 0.473 Test Loss: 6.034 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4902989864349365
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.682 Vali Acc: 0.432 Test Loss: 5.682 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6247828006744385
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.531 Vali Acc: 0.432 Test Loss: 5.531 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 510724
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5141079425811768
Epoch: 1, Steps: 10 | Train Loss: 1.523 Vali Loss: 1.378 Vali Acc: 0.338 Test Loss: 1.378 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.162400245666504
Epoch: 2, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.283 Vali Acc: 0.405 Test Loss: 1.283 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.1501731872558594
Epoch: 3, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.242 Vali Acc: 0.473 Test Loss: 1.242 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.1526601314544678
Epoch: 4, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.308 Vali Acc: 0.473 Test Loss: 1.308 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4440300464630127
Epoch: 5, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527013).  Saving model ...
Epoch: 6 cost time: 1.4162099361419678
Epoch: 6, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.563 Vali Acc: 0.459 Test Loss: 1.563 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.498993158340454
Epoch: 7, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.653 Vali Acc: 0.446 Test Loss: 1.653 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4717144966125488
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.758 Vali Acc: 0.486 Test Loss: 1.758 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3281590938568115
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.862 Vali Acc: 0.500 Test Loss: 1.862 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4164559841156006
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.093 Vali Acc: 0.514 Test Loss: 2.093 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2776970863342285
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.948 Vali Acc: 0.473 Test Loss: 1.948 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3500654697418213
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.035 Vali Acc: 0.459 Test Loss: 2.035 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4199090003967285
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.185 Vali Acc: 0.473 Test Loss: 2.185 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.445755958557129
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.050 Vali Acc: 0.446 Test Loss: 2.050 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3110151290893555
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.060 Vali Acc: 0.459 Test Loss: 2.060 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 307204
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1979939937591553
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.402 Vali Acc: 0.297 Test Loss: 1.402 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.3774597644805908
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.220 Vali Acc: 0.392 Test Loss: 1.220 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391880).  Saving model ...
Epoch: 3 cost time: 1.4828877449035645
Epoch: 3, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
Validation loss decreased (-0.391880 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.1382827758789062
Epoch: 4, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2955498695373535
Epoch: 5, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.273 Vali Acc: 0.473 Test Loss: 1.273 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4511311054229736
Epoch: 6, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.4023325443267822
Epoch: 7, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.285 Vali Acc: 0.554 Test Loss: 1.285 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554041).  Saving model ...
Epoch: 8 cost time: 1.2857856750488281
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.424 Vali Acc: 0.514 Test Loss: 1.424 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1793687343597412
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.495 Vali Acc: 0.514 Test Loss: 1.495 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0645101070404053
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3987500667572021
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.658 Vali Acc: 0.568 Test Loss: 1.658 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567551).  Saving model ...
Epoch: 12 cost time: 1.413703203201294
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.699 Vali Acc: 0.581 Test Loss: 1.699 Test Acc: 0.581
Validation loss decreased (-0.567551 --> -0.581064).  Saving model ...
Epoch: 13 cost time: 1.064582109451294
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.611 Vali Acc: 0.554 Test Loss: 1.611 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.419800043106079
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.655 Vali Acc: 0.554 Test Loss: 1.655 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4126179218292236
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.722 Vali Acc: 0.554 Test Loss: 1.722 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4186768531799316
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.541 Test Loss: 1.706 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4953913688659668
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.712 Vali Acc: 0.527 Test Loss: 1.712 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3392302989959717
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.730 Vali Acc: 0.514 Test Loss: 1.730 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.304485559463501
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.744 Vali Acc: 0.527 Test Loss: 1.744 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4771313667297363
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.527 Test Loss: 1.744 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3322935104370117
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.541 Test Loss: 1.735 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4582693576812744
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.541 Test Loss: 1.738 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 236804
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0690767765045166
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.353 Vali Acc: 0.270 Test Loss: 1.353 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.2537181377410889
Epoch: 2, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.217 Vali Acc: 0.432 Test Loss: 1.217 Test Acc: 0.432
Validation loss decreased (-0.270257 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.2793893814086914
Epoch: 3, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.152 Vali Acc: 0.459 Test Loss: 1.152 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 1.2721529006958008
Epoch: 4, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
Validation loss decreased (-0.459448 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.1085846424102783
Epoch: 5, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1864380836486816
Epoch: 6, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.293045997619629
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.221 Vali Acc: 0.527 Test Loss: 1.221 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.08553147315979
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.322 Vali Acc: 0.514 Test Loss: 1.322 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.153491497039795
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.192854881286621
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.458 Vali Acc: 0.527 Test Loss: 1.458 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1000480651855469
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.582 Vali Acc: 0.500 Test Loss: 1.582 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1575615406036377
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0905563831329346
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.632 Vali Acc: 0.486 Test Loss: 1.632 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.46641206741333
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.682 Vali Acc: 0.527 Test Loss: 1.682 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 207364
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2144007682800293
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.393 Vali Acc: 0.216 Test Loss: 1.393 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.3635709285736084
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.216202 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.3018174171447754
Epoch: 3, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.2366139888763428
Epoch: 4, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 1.2075724601745605
Epoch: 5, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 1.4275610446929932
Epoch: 6, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2553856372833252
Epoch: 7, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.184 Vali Acc: 0.568 Test Loss: 1.184 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.150740385055542
Epoch: 8, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4065372943878174
Epoch: 9, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.261 Vali Acc: 0.514 Test Loss: 1.261 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.306976079940796
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.333 Vali Acc: 0.568 Test Loss: 1.333 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1581621170043945
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.314 Vali Acc: 0.595 Test Loss: 1.314 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594581).  Saving model ...
Epoch: 12 cost time: 1.1516060829162598
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.347 Vali Acc: 0.581 Test Loss: 1.347 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2624459266662598
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.458 Vali Acc: 0.541 Test Loss: 1.458 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3298802375793457
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.457 Vali Acc: 0.554 Test Loss: 1.457 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3904528617858887
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.504 Vali Acc: 0.581 Test Loss: 1.504 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4421157836914062
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.547 Vali Acc: 0.568 Test Loss: 1.547 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.115415334701538
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.561 Vali Acc: 0.581 Test Loss: 1.561 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2189335823059082
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.593 Vali Acc: 0.568 Test Loss: 1.593 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3674731254577637
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.601 Vali Acc: 0.581 Test Loss: 1.601 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3795795440673828
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.624 Vali Acc: 0.541 Test Loss: 1.624 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2429959774017334
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.614 Vali Acc: 0.554 Test Loss: 1.614 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 174084
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0307528972625732
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.397 Vali Acc: 0.216 Test Loss: 1.397 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.275451421737671
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.309 Vali Acc: 0.432 Test Loss: 1.309 Test Acc: 0.432
Validation loss decreased (-0.216202 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.315063238143921
Epoch: 3, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.213 Vali Acc: 0.473 Test Loss: 1.213 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.260124683380127
Epoch: 4, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.196 Vali Acc: 0.446 Test Loss: 1.196 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.195143699645996
Epoch: 5, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.370530128479004
Epoch: 6, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4269402027130127
Epoch: 7, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3149406909942627
Epoch: 8, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.390702247619629
Epoch: 9, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.358705759048462
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.216 Vali Acc: 0.581 Test Loss: 1.216 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 1.307769775390625
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.295 Vali Acc: 0.527 Test Loss: 1.295 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3124818801879883
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.342 Vali Acc: 0.527 Test Loss: 1.342 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.308372974395752
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.394 Vali Acc: 0.514 Test Loss: 1.394 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2024061679840088
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.405 Vali Acc: 0.541 Test Loss: 1.405 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0342748165130615
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.453 Vali Acc: 0.554 Test Loss: 1.453 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0380525588989258
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.498 Vali Acc: 0.541 Test Loss: 1.498 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0697646141052246
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.480 Vali Acc: 0.568 Test Loss: 1.480 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3106811046600342
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.520 Vali Acc: 0.541 Test Loss: 1.520 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2633771896362305
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.539 Vali Acc: 0.554 Test Loss: 1.539 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1923015117645264
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.544 Vali Acc: 0.554 Test Loss: 1.544 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 161284
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0820963382720947
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.326 Vali Acc: 0.419 Test Loss: 1.326 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.3626186847686768
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.255 Vali Acc: 0.378 Test Loss: 1.255 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.249009132385254
Epoch: 3, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.219 Vali Acc: 0.419 Test Loss: 1.219 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.0581390857696533
Epoch: 4, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.418907 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.4052214622497559
Epoch: 5, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.1145317554473877
Epoch: 6, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4844970703125
Epoch: 7, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.152 Vali Acc: 0.541 Test Loss: 1.152 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.2777419090270996
Epoch: 8, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2222676277160645
Epoch: 9, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1096127033233643
Epoch: 10, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.246 Vali Acc: 0.527 Test Loss: 1.246 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2387373447418213
Epoch: 11, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.311 Vali Acc: 0.514 Test Loss: 1.311 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2218503952026367
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.420 Vali Acc: 0.500 Test Loss: 1.420 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0767972469329834
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.425 Vali Acc: 0.514 Test Loss: 1.425 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3886401653289795
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.477 Vali Acc: 0.514 Test Loss: 1.477 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.07338547706604
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.481 Vali Acc: 0.514 Test Loss: 1.481 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2433116436004639
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.528 Vali Acc: 0.486 Test Loss: 1.528 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2011618614196777
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.579 Vali Acc: 0.500 Test Loss: 1.579 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 153604
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.605372190475464
Epoch: 1, Steps: 10 | Train Loss: 1.574 Vali Loss: 1.308 Vali Acc: 0.392 Test Loss: 1.308 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.45859694480896
Epoch: 2, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.431 Vali Acc: 0.486 Test Loss: 1.431 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486472).  Saving model ...
Epoch: 3 cost time: 1.367788314819336
Epoch: 3, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.527 Vali Acc: 0.446 Test Loss: 1.527 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3006787300109863
Epoch: 4, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.515 Vali Acc: 0.486 Test Loss: 1.515 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1791894435882568
Epoch: 5, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.705 Vali Acc: 0.500 Test Loss: 1.705 Test Acc: 0.500
Validation loss decreased (-0.486472 --> -0.499983).  Saving model ...
Epoch: 6 cost time: 1.217372179031372
Epoch: 6, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.862 Vali Acc: 0.581 Test Loss: 1.862 Test Acc: 0.581
Validation loss decreased (-0.499983 --> -0.581062).  Saving model ...
Epoch: 7 cost time: 1.2570946216583252
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.203 Vali Acc: 0.500 Test Loss: 2.203 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2384817600250244
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.061 Vali Acc: 0.568 Test Loss: 2.061 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3679993152618408
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.526 Vali Acc: 0.486 Test Loss: 2.526 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.376030683517456
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.430 Vali Acc: 0.473 Test Loss: 3.430 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4729979038238525
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 2.728 Vali Acc: 0.500 Test Loss: 2.728 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4081618785858154
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.185 Vali Acc: 0.500 Test Loss: 3.185 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5969934463500977
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.260 Vali Acc: 0.473 Test Loss: 3.260 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.499504804611206
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.732 Vali Acc: 0.486 Test Loss: 3.732 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.639026165008545
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.698 Vali Acc: 0.459 Test Loss: 3.698 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4582526683807373
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.005 Vali Acc: 0.473 Test Loss: 4.005 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 494276
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.110006332397461
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.321 Vali Acc: 0.419 Test Loss: 1.321 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.1417503356933594
Epoch: 2, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.303393840789795
Epoch: 3, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.3255555629730225
Epoch: 4, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.270 Vali Acc: 0.527 Test Loss: 1.270 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 5 cost time: 1.1485066413879395
Epoch: 5, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.267 Vali Acc: 0.595 Test Loss: 1.267 Test Acc: 0.595
Validation loss decreased (-0.527014 --> -0.594582).  Saving model ...
Epoch: 6 cost time: 1.3027997016906738
Epoch: 6, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.309 Vali Acc: 0.554 Test Loss: 1.309 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1604435443878174
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.546 Vali Acc: 0.541 Test Loss: 1.546 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2591497898101807
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.665 Vali Acc: 0.541 Test Loss: 1.665 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2950937747955322
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.658 Vali Acc: 0.568 Test Loss: 1.658 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2189297676086426
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.734 Vali Acc: 0.541 Test Loss: 1.734 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1966724395751953
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.727 Vali Acc: 0.527 Test Loss: 1.727 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2489039897918701
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.794 Vali Acc: 0.568 Test Loss: 1.794 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3850774765014648
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.863 Vali Acc: 0.608 Test Loss: 1.863 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608089).  Saving model ...
Epoch: 14 cost time: 1.390624761581421
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.818 Vali Acc: 0.568 Test Loss: 1.818 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4961941242218018
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.568 Test Loss: 1.795 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2930946350097656
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.541 Test Loss: 1.825 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4079978466033936
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.835 Vali Acc: 0.568 Test Loss: 1.835 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.351048231124878
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.568 Test Loss: 1.831 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3532652854919434
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.554 Test Loss: 1.837 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3379874229431152
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.842 Vali Acc: 0.568 Test Loss: 1.842 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.322016954421997
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.568 Test Loss: 1.849 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.407205581665039
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.581 Test Loss: 1.866 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4124574661254883
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.876 Vali Acc: 0.568 Test Loss: 1.876 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 290756
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9011127948760986
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.352 Vali Acc: 0.338 Test Loss: 1.352 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0985615253448486
Epoch: 2, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.158 Vali Acc: 0.541 Test Loss: 1.158 Test Acc: 0.541
Validation loss decreased (-0.337824 --> -0.540529).  Saving model ...
Epoch: 3 cost time: 1.0217361450195312
Epoch: 3, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0525524616241455
Epoch: 4, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.090900182723999
Epoch: 5, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.004281759262085
Epoch: 6, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.326 Vali Acc: 0.527 Test Loss: 1.326 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0882208347320557
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.268 Vali Acc: 0.568 Test Loss: 1.268 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567555).  Saving model ...
Epoch: 8 cost time: 1.137366771697998
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.547 Vali Acc: 0.527 Test Loss: 1.547 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1447036266326904
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.581 Vali Acc: 0.514 Test Loss: 1.581 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2751636505126953
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.543 Vali Acc: 0.527 Test Loss: 1.543 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.025109052658081
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.657 Vali Acc: 0.541 Test Loss: 1.657 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2011103630065918
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.904 Vali Acc: 0.514 Test Loss: 1.904 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9606595039367676
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.699 Vali Acc: 0.554 Test Loss: 1.699 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0070772171020508
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.732 Vali Acc: 0.527 Test Loss: 1.732 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9355518817901611
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.784 Vali Acc: 0.554 Test Loss: 1.784 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1950342655181885
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.776 Vali Acc: 0.568 Test Loss: 1.776 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3239331245422363
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.760 Vali Acc: 0.554 Test Loss: 1.760 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 220356
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8258213996887207
Epoch: 1, Steps: 10 | Train Loss: 1.587 Vali Loss: 1.396 Vali Acc: 0.284 Test Loss: 1.396 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.2343950271606445
Epoch: 2, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.265 Vali Acc: 0.419 Test Loss: 1.265 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.155813455581665
Epoch: 3, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.3192262649536133
Epoch: 4, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.141 Vali Acc: 0.486 Test Loss: 1.141 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.1709318161010742
Epoch: 5, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1156444549560547
Epoch: 6, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.2882485389709473
Epoch: 7, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.238 Vali Acc: 0.527 Test Loss: 1.238 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.153808832168579
Epoch: 8, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.363 Vali Acc: 0.541 Test Loss: 1.363 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.003345012664795
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.438 Vali Acc: 0.527 Test Loss: 1.438 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0370121002197266
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.433 Vali Acc: 0.541 Test Loss: 1.433 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0099802017211914
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.510 Vali Acc: 0.527 Test Loss: 1.510 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1506898403167725
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.528 Vali Acc: 0.541 Test Loss: 1.528 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0055453777313232
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.513 Vali Acc: 0.568 Test Loss: 1.513 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567552).  Saving model ...
Epoch: 14 cost time: 0.997689962387085
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.576 Vali Acc: 0.554 Test Loss: 1.576 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.944378137588501
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.588 Vali Acc: 0.541 Test Loss: 1.588 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1687123775482178
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.613 Vali Acc: 0.514 Test Loss: 1.613 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0418589115142822
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.628 Vali Acc: 0.514 Test Loss: 1.628 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9584405422210693
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.652 Vali Acc: 0.514 Test Loss: 1.652 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.145176649093628
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.665 Vali Acc: 0.541 Test Loss: 1.665 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0317039489746094
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.527 Test Loss: 1.672 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.230316162109375
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.676 Vali Acc: 0.554 Test Loss: 1.676 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2381067276000977
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.685 Vali Acc: 0.554 Test Loss: 1.685 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.197500467300415
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.697 Vali Acc: 0.568 Test Loss: 1.697 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 190916
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1473240852355957
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.447 Vali Acc: 0.297 Test Loss: 1.447 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.1570508480072021
Epoch: 2, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.305 Vali Acc: 0.378 Test Loss: 1.305 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.0495741367340088
Epoch: 3, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.250 Vali Acc: 0.405 Test Loss: 1.250 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.1207959651947021
Epoch: 4, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.181 Vali Acc: 0.459 Test Loss: 1.181 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 0.9962515830993652
Epoch: 5, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.1633937358856201
Epoch: 6, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.240 Vali Acc: 0.432 Test Loss: 1.240 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.11641263961792
Epoch: 7, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.088235855102539
Epoch: 8, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.9199941158294678
Epoch: 9, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.365 Vali Acc: 0.527 Test Loss: 1.365 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527013).  Saving model ...
Epoch: 10 cost time: 0.9527668952941895
Epoch: 10, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.462 Vali Acc: 0.527 Test Loss: 1.462 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0586822032928467
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.456 Vali Acc: 0.541 Test Loss: 1.456 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540526).  Saving model ...
Epoch: 12 cost time: 1.1029739379882812
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.534 Vali Acc: 0.514 Test Loss: 1.534 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0828745365142822
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.620 Vali Acc: 0.514 Test Loss: 1.620 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0072431564331055
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.633 Vali Acc: 0.541 Test Loss: 1.633 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9330184459686279
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.649 Vali Acc: 0.554 Test Loss: 1.649 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554038).  Saving model ...
Epoch: 16 cost time: 1.0586585998535156
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.675 Vali Acc: 0.554 Test Loss: 1.675 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.151789665222168
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.669 Vali Acc: 0.554 Test Loss: 1.669 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3308327198028564
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.689 Vali Acc: 0.514 Test Loss: 1.689 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2249927520751953
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.706 Vali Acc: 0.527 Test Loss: 1.706 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.183990716934204
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.727 Vali Acc: 0.554 Test Loss: 1.727 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.296513557434082
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.724 Vali Acc: 0.541 Test Loss: 1.724 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3051605224609375
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.729 Vali Acc: 0.527 Test Loss: 1.729 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3199565410614014
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.744 Vali Acc: 0.541 Test Loss: 1.744 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3763535022735596
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.768 Vali Acc: 0.554 Test Loss: 1.768 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3126718997955322
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.777 Vali Acc: 0.568 Test Loss: 1.777 Test Acc: 0.568
Validation loss decreased (-0.554038 --> -0.567550).  Saving model ...
Epoch: 26 cost time: 1.2638509273529053
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.798 Vali Acc: 0.554 Test Loss: 1.798 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2463195323944092
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.814 Vali Acc: 0.554 Test Loss: 1.814 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1527910232543945
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.827 Vali Acc: 0.541 Test Loss: 1.827 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1882977485656738
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.554 Test Loss: 1.835 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2491428852081299
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.847 Vali Acc: 0.554 Test Loss: 1.847 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4864141941070557
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.847 Vali Acc: 0.554 Test Loss: 1.847 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3567380905151367
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.850 Vali Acc: 0.554 Test Loss: 1.850 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.177800178527832
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.859 Vali Acc: 0.554 Test Loss: 1.859 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1482973098754883
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.870 Vali Acc: 0.554 Test Loss: 1.870 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.194934606552124
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.885 Vali Acc: 0.554 Test Loss: 1.885 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 157636
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.100710391998291
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.460 Vali Acc: 0.189 Test Loss: 1.460 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.2238073348999023
Epoch: 2, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.319 Vali Acc: 0.446 Test Loss: 1.319 Test Acc: 0.446
Validation loss decreased (-0.189175 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.2142984867095947
Epoch: 3, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2342660427093506
Epoch: 4, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.238 Vali Acc: 0.514 Test Loss: 1.238 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.1459333896636963
Epoch: 5, Steps: 10 | Train Loss: 0.644 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
Validation loss decreased (-0.513501 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 1.2263705730438232
Epoch: 6, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2210922241210938
Epoch: 7, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.271650791168213
Epoch: 8, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.152 Vali Acc: 0.541 Test Loss: 1.152 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.258204698562622
Epoch: 9, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 1.2608695030212402
Epoch: 10, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.220 Vali Acc: 0.568 Test Loss: 1.220 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3034389019012451
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2567873001098633
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.334 Vali Acc: 0.554 Test Loss: 1.334 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2858009338378906
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.389 Vali Acc: 0.581 Test Loss: 1.389 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2340161800384521
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.396 Vali Acc: 0.554 Test Loss: 1.396 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.333435297012329
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.455 Vali Acc: 0.581 Test Loss: 1.455 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1512980461120605
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.474 Vali Acc: 0.581 Test Loss: 1.474 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.221686840057373
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.486 Vali Acc: 0.608 Test Loss: 1.486 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608093).  Saving model ...
Epoch: 18 cost time: 1.3490302562713623
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.503 Vali Acc: 0.608 Test Loss: 1.503 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.285970687866211
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.516 Vali Acc: 0.608 Test Loss: 1.516 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3042352199554443
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.510 Vali Acc: 0.608 Test Loss: 1.510 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2074708938598633
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.510 Vali Acc: 0.608 Test Loss: 1.510 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3163528442382812
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.536 Vali Acc: 0.608 Test Loss: 1.536 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3921005725860596
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.554 Vali Acc: 0.595 Test Loss: 1.554 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2466483116149902
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.568 Vali Acc: 0.608 Test Loss: 1.568 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4221715927124023
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.577 Vali Acc: 0.595 Test Loss: 1.577 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.297353744506836
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.592 Vali Acc: 0.608 Test Loss: 1.592 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.274519681930542
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.601 Vali Acc: 0.608 Test Loss: 1.601 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 144836
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1880273818969727
Epoch: 1, Steps: 10 | Train Loss: 1.561 Vali Loss: 1.497 Vali Acc: 0.324 Test Loss: 1.497 Test Acc: 0.324
Validation loss decreased (inf --> -0.324309).  Saving model ...
Epoch: 2 cost time: 1.1853878498077393
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.384 Vali Acc: 0.351 Test Loss: 1.384 Test Acc: 0.351
Validation loss decreased (-0.324309 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8781847953796387
Epoch: 3, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.282 Vali Acc: 0.392 Test Loss: 1.282 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.1352801322937012
Epoch: 4, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.233 Vali Acc: 0.405 Test Loss: 1.233 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.2387816905975342
Epoch: 5, Steps: 10 | Train Loss: 0.723 Vali Loss: 1.218 Vali Acc: 0.419 Test Loss: 1.218 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 6 cost time: 1.190018653869629
Epoch: 6, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.183 Vali Acc: 0.432 Test Loss: 1.183 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432421).  Saving model ...
Epoch: 7 cost time: 1.2031569480895996
Epoch: 7, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
Validation loss decreased (-0.432421 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.2661097049713135
Epoch: 8, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.236 Vali Acc: 0.473 Test Loss: 1.236 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0663321018218994
Epoch: 9, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 1.3130807876586914
Epoch: 10, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.273 Vali Acc: 0.459 Test Loss: 1.273 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3879036903381348
Epoch: 11, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.289 Vali Acc: 0.527 Test Loss: 1.289 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3497090339660645
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.362 Vali Acc: 0.514 Test Loss: 1.362 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2338588237762451
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.413 Vali Acc: 0.554 Test Loss: 1.413 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554040).  Saving model ...
Epoch: 14 cost time: 1.235539197921753
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.476 Vali Acc: 0.514 Test Loss: 1.476 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2108581066131592
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.545 Vali Acc: 0.527 Test Loss: 1.545 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.190314531326294
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.567 Vali Acc: 0.541 Test Loss: 1.567 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1954758167266846
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.572 Vali Acc: 0.514 Test Loss: 1.572 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3111798763275146
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.614 Vali Acc: 0.527 Test Loss: 1.614 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2948641777038574
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.630 Vali Acc: 0.541 Test Loss: 1.630 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2164397239685059
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.661 Vali Acc: 0.527 Test Loss: 1.661 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1664292812347412
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.669 Vali Acc: 0.500 Test Loss: 1.669 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2395997047424316
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.692 Vali Acc: 0.486 Test Loss: 1.692 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0148851871490479
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.723 Vali Acc: 0.514 Test Loss: 1.723 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm128_nh16_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 137156
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9270503520965576
Epoch: 1, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.444 Vali Acc: 0.311 Test Loss: 1.444 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.498337984085083
Epoch: 2, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.293 Vali Acc: 0.473 Test Loss: 1.293 Test Acc: 0.473
Validation loss decreased (-0.310796 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.6475505828857422
Epoch: 3, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.1725246906280518
Epoch: 4, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.412 Vali Acc: 0.459 Test Loss: 1.412 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3967046737670898
Epoch: 5, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.884 Vali Acc: 0.432 Test Loss: 1.884 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4976332187652588
Epoch: 6, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.650 Vali Acc: 0.473 Test Loss: 1.650 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4923057556152344
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.823 Vali Acc: 0.486 Test Loss: 1.823 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.322875738143921
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.813 Vali Acc: 0.527 Test Loss: 1.813 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527009).  Saving model ...
Epoch: 9 cost time: 1.4999730587005615
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.897 Vali Acc: 0.473 Test Loss: 1.897 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3836545944213867
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.937 Vali Acc: 0.527 Test Loss: 1.937 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4524650573730469
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.030 Vali Acc: 0.500 Test Loss: 2.030 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.39534330368042
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.072 Vali Acc: 0.514 Test Loss: 2.072 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5338373184204102
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.043 Vali Acc: 0.514 Test Loss: 2.043 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3574213981628418
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.017 Vali Acc: 0.514 Test Loss: 2.017 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2215428352355957
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.093 Vali Acc: 0.527 Test Loss: 2.093 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5720229148864746
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.103 Vali Acc: 0.527 Test Loss: 2.103 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3377702236175537
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.105 Vali Acc: 0.527 Test Loss: 2.105 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5038671493530273
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.113 Vali Acc: 0.500 Test Loss: 2.113 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 255556
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9736196994781494
Epoch: 1, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.443 Vali Acc: 0.230 Test Loss: 1.443 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.356473445892334
Epoch: 2, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.187 Vali Acc: 0.432 Test Loss: 1.187 Test Acc: 0.432
Validation loss decreased (-0.229715 --> -0.432421).  Saving model ...
Epoch: 3 cost time: 1.034576177597046
Epoch: 3, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
Validation loss decreased (-0.432421 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.3420031070709229
Epoch: 4, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.3934435844421387
Epoch: 5, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2519071102142334
Epoch: 6, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.406 Vali Acc: 0.486 Test Loss: 1.406 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3015484809875488
Epoch: 7, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.531592607498169
Epoch: 8, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.339 Vali Acc: 0.541 Test Loss: 1.339 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3395278453826904
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.436 Vali Acc: 0.541 Test Loss: 1.436 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2249860763549805
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.489 Vali Acc: 0.568 Test Loss: 1.489 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567553).  Saving model ...
Epoch: 11 cost time: 1.3993394374847412
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.561 Vali Acc: 0.514 Test Loss: 1.561 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3526794910430908
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.560 Vali Acc: 0.527 Test Loss: 1.560 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.362715721130371
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.624 Vali Acc: 0.541 Test Loss: 1.624 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3768317699432373
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.648 Vali Acc: 0.527 Test Loss: 1.648 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.100623369216919
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.670 Vali Acc: 0.541 Test Loss: 1.670 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1415116786956787
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.673 Vali Acc: 0.541 Test Loss: 1.673 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9986653327941895
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.541 Test Loss: 1.671 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1468462944030762
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.693 Vali Acc: 0.541 Test Loss: 1.693 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.212404727935791
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.541 Test Loss: 1.720 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.105581521987915
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.541 Test Loss: 1.720 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 153796
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.232093334197998
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.457 Vali Acc: 0.203 Test Loss: 1.457 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.3058998584747314
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.347 Vali Acc: 0.311 Test Loss: 1.347 Test Acc: 0.311
Validation loss decreased (-0.202688 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.1585612297058105
Epoch: 3, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.208 Vali Acc: 0.405 Test Loss: 1.208 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.2271311283111572
Epoch: 4, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.199 Vali Acc: 0.446 Test Loss: 1.199 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.121021032333374
Epoch: 5, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.335179090499878
Epoch: 6, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.1678094863891602
Epoch: 7, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.262962818145752
Epoch: 8, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.232255458831787
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2020082473754883
Epoch: 10, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.245 Vali Acc: 0.541 Test Loss: 1.245 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.325087547302246
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.417 Vali Acc: 0.568 Test Loss: 1.417 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567553).  Saving model ...
Epoch: 12 cost time: 1.2507646083831787
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.425 Vali Acc: 0.568 Test Loss: 1.425 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.221916913986206
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.451 Vali Acc: 0.595 Test Loss: 1.451 Test Acc: 0.595
Validation loss decreased (-0.567553 --> -0.594580).  Saving model ...
Epoch: 14 cost time: 1.0850450992584229
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.453 Vali Acc: 0.568 Test Loss: 1.453 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2849361896514893
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.428 Vali Acc: 0.568 Test Loss: 1.428 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9865672588348389
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.463 Vali Acc: 0.554 Test Loss: 1.463 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.137202262878418
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.518 Vali Acc: 0.554 Test Loss: 1.518 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2734096050262451
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.529 Vali Acc: 0.541 Test Loss: 1.529 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3022639751434326
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.530 Vali Acc: 0.541 Test Loss: 1.530 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3753175735473633
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.196962833404541
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.545 Vali Acc: 0.541 Test Loss: 1.545 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.110198974609375
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.579 Vali Acc: 0.541 Test Loss: 1.579 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.347005844116211
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.614 Vali Acc: 0.541 Test Loss: 1.614 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 118596
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6429288387298584
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.428 Vali Acc: 0.324 Test Loss: 1.428 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.0465636253356934
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 0.9643163681030273
Epoch: 3, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.9982631206512451
Epoch: 4, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9964151382446289
Epoch: 5, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2864031791687012
Epoch: 6, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.127 Vali Acc: 0.446 Test Loss: 1.127 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2655725479125977
Epoch: 7, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1754848957061768
Epoch: 8, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.245283842086792
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.203 Vali Acc: 0.581 Test Loss: 1.203 Test Acc: 0.581
Validation loss decreased (-0.499989 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 0.9439711570739746
Epoch: 10, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.213 Vali Acc: 0.541 Test Loss: 1.213 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2677936553955078
Epoch: 11, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.979762077331543
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.338 Vali Acc: 0.541 Test Loss: 1.338 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.071103811264038
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.369 Vali Acc: 0.527 Test Loss: 1.369 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1807808876037598
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.439 Vali Acc: 0.541 Test Loss: 1.439 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.997413158416748
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.440 Vali Acc: 0.541 Test Loss: 1.440 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2751638889312744
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.468 Vali Acc: 0.541 Test Loss: 1.468 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2537696361541748
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.494 Vali Acc: 0.541 Test Loss: 1.494 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2227721214294434
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.518 Vali Acc: 0.541 Test Loss: 1.518 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1259305477142334
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.508 Vali Acc: 0.541 Test Loss: 1.508 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 103876
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.963259220123291
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.456 Vali Acc: 0.203 Test Loss: 1.456 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.031895399093628
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.366 Vali Acc: 0.405 Test Loss: 1.366 Test Acc: 0.405
Validation loss decreased (-0.202688 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.2795593738555908
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.281 Vali Acc: 0.392 Test Loss: 1.281 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0086734294891357
Epoch: 4, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.258 Vali Acc: 0.392 Test Loss: 1.258 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2631771564483643
Epoch: 5, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
Validation loss decreased (-0.405392 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.9995720386505127
Epoch: 6, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1829211711883545
Epoch: 7, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1113080978393555
Epoch: 8, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9806981086730957
Epoch: 9, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9703359603881836
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.164 Vali Acc: 0.554 Test Loss: 1.164 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 0.9799466133117676
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.152 Vali Acc: 0.541 Test Loss: 1.152 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0094006061553955
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.207 Vali Acc: 0.568 Test Loss: 1.207 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 13 cost time: 1.0779032707214355
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.269 Vali Acc: 0.568 Test Loss: 1.269 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0619168281555176
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9919276237487793
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1377387046813965
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.372 Vali Acc: 0.581 Test Loss: 1.372 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581067).  Saving model ...
Epoch: 17 cost time: 0.9999039173126221
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.363 Vali Acc: 0.568 Test Loss: 1.363 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.27913236618042
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.418 Vali Acc: 0.595 Test Loss: 1.418 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594580).  Saving model ...
Epoch: 19 cost time: 0.9645514488220215
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.441 Vali Acc: 0.554 Test Loss: 1.441 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1397151947021484
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.451 Vali Acc: 0.554 Test Loss: 1.451 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1751575469970703
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.475 Vali Acc: 0.568 Test Loss: 1.475 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0619609355926514
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.494 Vali Acc: 0.568 Test Loss: 1.494 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1305654048919678
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.517 Vali Acc: 0.595 Test Loss: 1.517 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0518362522125244
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.525 Vali Acc: 0.595 Test Loss: 1.525 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1374609470367432
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.541 Vali Acc: 0.608 Test Loss: 1.541 Test Acc: 0.608
Validation loss decreased (-0.594580 --> -0.608093).  Saving model ...
Epoch: 26 cost time: 1.0753581523895264
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.545 Vali Acc: 0.608 Test Loss: 1.545 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1936359405517578
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.571 Vali Acc: 0.608 Test Loss: 1.571 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9153423309326172
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.585 Vali Acc: 0.595 Test Loss: 1.585 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1659808158874512
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.604 Vali Acc: 0.581 Test Loss: 1.604 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.044386863708496
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.621 Vali Acc: 0.581 Test Loss: 1.621 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0738353729248047
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.632 Vali Acc: 0.554 Test Loss: 1.632 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1364998817443848
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.646 Vali Acc: 0.581 Test Loss: 1.646 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0307884216308594
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.658 Vali Acc: 0.568 Test Loss: 1.658 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0970518589019775
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.686 Vali Acc: 0.581 Test Loss: 1.686 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.197507381439209
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.693 Vali Acc: 0.541 Test Loss: 1.693 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 87236
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6476473808288574
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.596 Vali Acc: 0.149 Test Loss: 1.596 Test Acc: 0.149
Validation loss decreased (inf --> -0.148633).  Saving model ...
Epoch: 2 cost time: 0.8283388614654541
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.470 Vali Acc: 0.203 Test Loss: 1.470 Test Acc: 0.203
Validation loss decreased (-0.148633 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 0.8812592029571533
Epoch: 3, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.342 Vali Acc: 0.338 Test Loss: 1.342 Test Acc: 0.338
Validation loss decreased (-0.202688 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.9558298587799072
Epoch: 4, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.9077777862548828
Epoch: 5, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.280 Vali Acc: 0.446 Test Loss: 1.280 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8732669353485107
Epoch: 6, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7732021808624268
Epoch: 7, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.8514995574951172
Epoch: 8, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.216 Vali Acc: 0.446 Test Loss: 1.216 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7798564434051514
Epoch: 9, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.207 Vali Acc: 0.446 Test Loss: 1.207 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7237093448638916
Epoch: 10, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 0.8588314056396484
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 12 cost time: 0.8911452293395996
Epoch: 12, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8053760528564453
Epoch: 13, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.257 Vali Acc: 0.527 Test Loss: 1.257 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8336827754974365
Epoch: 14, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.266 Vali Acc: 0.554 Test Loss: 1.266 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8785855770111084
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.319 Vali Acc: 0.554 Test Loss: 1.319 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8239247798919678
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.362 Vali Acc: 0.554 Test Loss: 1.362 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8011059761047363
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.334 Vali Acc: 0.554 Test Loss: 1.334 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7979891300201416
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.358 Vali Acc: 0.541 Test Loss: 1.358 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8453786373138428
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.424 Vali Acc: 0.554 Test Loss: 1.424 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8441562652587891
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.460 Vali Acc: 0.554 Test Loss: 1.460 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8982107639312744
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.451 Vali Acc: 0.514 Test Loss: 1.451 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 80836
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5218398571014404
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.8529577255249023
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.346 Vali Acc: 0.338 Test Loss: 1.346 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.8814294338226318
Epoch: 3, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.300 Vali Acc: 0.459 Test Loss: 1.300 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 0.7551746368408203
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.266 Vali Acc: 0.473 Test Loss: 1.266 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 0.880021333694458
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.231 Vali Acc: 0.527 Test Loss: 1.231 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.8134875297546387
Epoch: 6, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7430145740509033
Epoch: 7, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8374502658843994
Epoch: 8, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9063513278961182
Epoch: 9, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8721721172332764
Epoch: 10, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.0396614074707031
Epoch: 11, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7669274806976318
Epoch: 12, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.223 Vali Acc: 0.527 Test Loss: 1.223 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.835059404373169
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7196149826049805
Epoch: 14, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.253 Vali Acc: 0.514 Test Loss: 1.253 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9210305213928223
Epoch: 15, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.268 Vali Acc: 0.514 Test Loss: 1.268 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8409838676452637
Epoch: 16, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.321 Vali Acc: 0.514 Test Loss: 1.321 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8217496871948242
Epoch: 17, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.308 Vali Acc: 0.527 Test Loss: 1.308 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.841109037399292
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.350 Vali Acc: 0.486 Test Loss: 1.350 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7985954284667969
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.405 Vali Acc: 0.486 Test Loss: 1.405 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7920653820037842
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.430 Vali Acc: 0.527 Test Loss: 1.430 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 76996
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8018829822540283
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.358 Vali Acc: 0.351 Test Loss: 1.358 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.279482364654541
Epoch: 2, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.300 Vali Acc: 0.419 Test Loss: 1.300 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.2460460662841797
Epoch: 3, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2687222957611084
Epoch: 4, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.392 Vali Acc: 0.486 Test Loss: 1.392 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.139266014099121
Epoch: 5, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.382 Vali Acc: 0.568 Test Loss: 1.382 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567554).  Saving model ...
Epoch: 6 cost time: 1.343252182006836
Epoch: 6, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.344 Vali Acc: 0.527 Test Loss: 1.344 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2381031513214111
Epoch: 7, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.625 Vali Acc: 0.527 Test Loss: 1.625 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.218860387802124
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.939 Vali Acc: 0.446 Test Loss: 1.939 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2277281284332275
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.906 Vali Acc: 0.514 Test Loss: 1.906 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1577980518341064
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.916 Vali Acc: 0.459 Test Loss: 1.916 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1850852966308594
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.138 Vali Acc: 0.514 Test Loss: 2.138 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1213552951812744
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.067 Vali Acc: 0.500 Test Loss: 2.067 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2234950065612793
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.009 Vali Acc: 0.527 Test Loss: 2.009 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1187412738800049
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.092 Vali Acc: 0.514 Test Loss: 2.092 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.176055908203125
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.094 Vali Acc: 0.527 Test Loss: 2.094 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 239044
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7607367038726807
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.456 Vali Acc: 0.297 Test Loss: 1.456 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.097841739654541
Epoch: 2, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.377 Vali Acc: 0.338 Test Loss: 1.377 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.0640909671783447
Epoch: 3, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.284 Vali Acc: 0.446 Test Loss: 1.284 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.1059269905090332
Epoch: 4, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.0131299495697021
Epoch: 5, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.312 Vali Acc: 0.568 Test Loss: 1.312 Test Acc: 0.568
Validation loss decreased (-0.459447 --> -0.567554).  Saving model ...
Epoch: 6 cost time: 1.0137898921966553
Epoch: 6, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.362 Vali Acc: 0.392 Test Loss: 1.362 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.959517240524292
Epoch: 7, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.578 Vali Acc: 0.446 Test Loss: 1.578 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0997776985168457
Epoch: 8, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.419 Vali Acc: 0.446 Test Loss: 1.419 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1120309829711914
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.500 Vali Acc: 0.514 Test Loss: 1.500 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.341623067855835
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4948761463165283
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.595 Vali Acc: 0.500 Test Loss: 1.595 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4180717468261719
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.670 Vali Acc: 0.514 Test Loss: 1.670 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5348031520843506
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.768 Vali Acc: 0.514 Test Loss: 1.768 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3110575675964355
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.729 Vali Acc: 0.514 Test Loss: 1.729 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5755927562713623
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.774 Vali Acc: 0.554 Test Loss: 1.774 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 137284
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0918211936950684
Epoch: 1, Steps: 10 | Train Loss: 1.608 Vali Loss: 1.477 Vali Acc: 0.257 Test Loss: 1.477 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.3997724056243896
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.353 Vali Acc: 0.284 Test Loss: 1.353 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.3656954765319824
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.273 Vali Acc: 0.392 Test Loss: 1.273 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.4982829093933105
Epoch: 4, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.2335638999938965
Epoch: 5, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.171 Vali Acc: 0.473 Test Loss: 1.171 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3706023693084717
Epoch: 6, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.3180701732635498
Epoch: 7, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3226237297058105
Epoch: 8, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3241345882415771
Epoch: 9, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.285 Vali Acc: 0.514 Test Loss: 1.285 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 1.3578996658325195
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.331 Vali Acc: 0.514 Test Loss: 1.331 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3678832054138184
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3304193019866943
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.450 Vali Acc: 0.514 Test Loss: 1.450 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3632559776306152
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.473 Vali Acc: 0.514 Test Loss: 1.473 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3936192989349365
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.495 Vali Acc: 0.514 Test Loss: 1.495 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.218395471572876
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.513 Vali Acc: 0.514 Test Loss: 1.513 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4197721481323242
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.545 Vali Acc: 0.514 Test Loss: 1.545 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.35731840133667
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.578 Vali Acc: 0.514 Test Loss: 1.578 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.441765546798706
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.564 Vali Acc: 0.514 Test Loss: 1.564 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2104365825653076
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 102084
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8872039318084717
Epoch: 1, Steps: 10 | Train Loss: 1.573 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.2688236236572266
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.340 Vali Acc: 0.324 Test Loss: 1.340 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.9024393558502197
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.279 Vali Acc: 0.432 Test Loss: 1.279 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.2759363651275635
Epoch: 4, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.166 Vali Acc: 0.527 Test Loss: 1.166 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.4813919067382812
Epoch: 5, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3583855628967285
Epoch: 6, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.499741554260254
Epoch: 7, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.3445940017700195
Epoch: 8, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.154 Vali Acc: 0.554 Test Loss: 1.154 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2765171527862549
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.188 Vali Acc: 0.527 Test Loss: 1.188 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5057623386383057
Epoch: 10, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3961384296417236
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.416492223739624
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.281 Vali Acc: 0.622 Test Loss: 1.281 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621609).  Saving model ...
Epoch: 13 cost time: 1.4783439636230469
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.343 Vali Acc: 0.554 Test Loss: 1.343 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1575243473052979
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5808179378509521
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.413 Vali Acc: 0.527 Test Loss: 1.413 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.461592435836792
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.448 Vali Acc: 0.514 Test Loss: 1.448 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2907094955444336
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.428 Vali Acc: 0.541 Test Loss: 1.428 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3996882438659668
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.460 Vali Acc: 0.554 Test Loss: 1.460 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2314178943634033
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.471 Vali Acc: 0.541 Test Loss: 1.471 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4453856945037842
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.483 Vali Acc: 0.554 Test Loss: 1.483 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5221974849700928
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.486 Vali Acc: 0.527 Test Loss: 1.486 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2655491828918457
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.517 Vali Acc: 0.541 Test Loss: 1.517 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 87364
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3055834770202637
Epoch: 1, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.488 Vali Acc: 0.270 Test Loss: 1.488 Test Acc: 0.270
Validation loss decreased (inf --> -0.270255).  Saving model ...
Epoch: 2 cost time: 1.3087196350097656
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
Validation loss decreased (-0.270255 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 1.2639470100402832
Epoch: 3, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.317 Vali Acc: 0.365 Test Loss: 1.317 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.3354520797729492
Epoch: 4, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.3751912117004395
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.177 Vali Acc: 0.473 Test Loss: 1.177 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.3414433002471924
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.211 Vali Acc: 0.432 Test Loss: 1.211 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3284971714019775
Epoch: 7, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.2738444805145264
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.215 Vali Acc: 0.459 Test Loss: 1.215 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4846558570861816
Epoch: 9, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3300542831420898
Epoch: 10, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.2963109016418457
Epoch: 11, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.515371561050415
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4024605751037598
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2527978420257568
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.347 Vali Acc: 0.554 Test Loss: 1.347 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 15 cost time: 1.3364779949188232
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.363159418106079
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.439 Vali Acc: 0.541 Test Loss: 1.439 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.488074779510498
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.406 Vali Acc: 0.541 Test Loss: 1.406 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.29740571975708
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.408851146697998
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.476 Vali Acc: 0.541 Test Loss: 1.476 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.513794183731079
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.472 Vali Acc: 0.554 Test Loss: 1.472 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2818055152893066
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.497 Vali Acc: 0.541 Test Loss: 1.497 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.454277515411377
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.514 Vali Acc: 0.541 Test Loss: 1.514 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2994189262390137
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.549 Vali Acc: 0.554 Test Loss: 1.549 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4174613952636719
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.573 Vali Acc: 0.554 Test Loss: 1.573 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 70724
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7042319774627686
Epoch: 1, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.396 Vali Acc: 0.284 Test Loss: 1.396 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9473404884338379
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.352 Vali Acc: 0.324 Test Loss: 1.352 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.9397163391113281
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.322 Vali Acc: 0.365 Test Loss: 1.322 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.8622076511383057
Epoch: 4, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.263 Vali Acc: 0.419 Test Loss: 1.263 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.9088706970214844
Epoch: 5, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8841016292572021
Epoch: 6, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9117140769958496
Epoch: 7, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.9640665054321289
Epoch: 8, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.8136529922485352
Epoch: 9, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 0.9653823375701904
Epoch: 10, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.153 Vali Acc: 0.554 Test Loss: 1.153 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.0693612098693848
Epoch: 11, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8762857913970947
Epoch: 12, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.240 Vali Acc: 0.554 Test Loss: 1.240 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9441318511962891
Epoch: 13, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.232 Vali Acc: 0.608 Test Loss: 1.232 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608096).  Saving model ...
Epoch: 14 cost time: 0.8159306049346924
Epoch: 14, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.251 Vali Acc: 0.581 Test Loss: 1.251 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.993633508682251
Epoch: 15, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.299 Vali Acc: 0.581 Test Loss: 1.299 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.825324535369873
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.319 Vali Acc: 0.581 Test Loss: 1.319 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9899826049804688
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.355 Vali Acc: 0.568 Test Loss: 1.355 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.868199348449707
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.401 Vali Acc: 0.581 Test Loss: 1.401 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8850047588348389
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.357 Vali Acc: 0.595 Test Loss: 1.357 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8371672630310059
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.382 Vali Acc: 0.595 Test Loss: 1.382 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9587209224700928
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.446 Vali Acc: 0.595 Test Loss: 1.446 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8962905406951904
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.467 Vali Acc: 0.595 Test Loss: 1.467 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9494438171386719
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.490 Vali Acc: 0.595 Test Loss: 1.490 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 64324
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6126339435577393
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.471 Vali Acc: 0.284 Test Loss: 1.471 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 0.8994545936584473
Epoch: 2, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.408 Vali Acc: 0.351 Test Loss: 1.408 Test Acc: 0.351
Validation loss decreased (-0.283769 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 0.9593117237091064
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.357 Vali Acc: 0.419 Test Loss: 1.357 Test Acc: 0.419
Validation loss decreased (-0.351337 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 0.9805452823638916
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.302 Vali Acc: 0.459 Test Loss: 1.302 Test Acc: 0.459
Validation loss decreased (-0.418905 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 0.9122285842895508
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.235 Vali Acc: 0.473 Test Loss: 1.235 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.8810408115386963
Epoch: 6, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.194 Vali Acc: 0.459 Test Loss: 1.194 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9682290554046631
Epoch: 7, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.204 Vali Acc: 0.432 Test Loss: 1.204 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.953455924987793
Epoch: 8, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.153 Vali Acc: 0.486 Test Loss: 1.153 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 0.9010632038116455
Epoch: 9, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9098436832427979
Epoch: 10, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.179 Vali Acc: 0.486 Test Loss: 1.179 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9877007007598877
Epoch: 11, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 0.8633511066436768
Epoch: 12, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9620444774627686
Epoch: 13, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.226 Vali Acc: 0.527 Test Loss: 1.226 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9194772243499756
Epoch: 14, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8308253288269043
Epoch: 15, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.261 Vali Acc: 0.527 Test Loss: 1.261 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8420195579528809
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.306 Vali Acc: 0.568 Test Loss: 1.306 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567555).  Saving model ...
Epoch: 17 cost time: 1.0014581680297852
Epoch: 17, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.299 Vali Acc: 0.527 Test Loss: 1.299 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9331910610198975
Epoch: 18, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.346 Vali Acc: 0.541 Test Loss: 1.346 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.901547908782959
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9279227256774902
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.419 Vali Acc: 0.541 Test Loss: 1.419 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8675765991210938
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.439 Vali Acc: 0.527 Test Loss: 1.439 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9414350986480713
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.480 Vali Acc: 0.514 Test Loss: 1.480 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8622746467590332
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.500 Vali Acc: 0.514 Test Loss: 1.500 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9327175617218018
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8311774730682373
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9866509437561035
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.543 Vali Acc: 0.527 Test Loss: 1.543 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 60484
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6871190071105957
Epoch: 1, Steps: 10 | Train Loss: 1.536 Vali Loss: 1.441 Vali Acc: 0.297 Test Loss: 1.441 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.509934902191162
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.532 Vali Acc: 0.257 Test Loss: 1.532 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5741229057312012
Epoch: 3, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.534 Vali Acc: 0.486 Test Loss: 1.534 Test Acc: 0.486
Validation loss decreased (-0.297283 --> -0.486471).  Saving model ...
Epoch: 4 cost time: 1.6571760177612305
Epoch: 4, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.311 Vali Acc: 0.459 Test Loss: 1.311 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6425116062164307
Epoch: 5, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.564 Vali Acc: 0.459 Test Loss: 1.564 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5854122638702393
Epoch: 6, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.790 Vali Acc: 0.459 Test Loss: 1.790 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.409081220626831
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.605 Vali Acc: 0.514 Test Loss: 1.605 Test Acc: 0.514
Validation loss decreased (-0.486471 --> -0.513497).  Saving model ...
Epoch: 8 cost time: 1.7011566162109375
Epoch: 8, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.813 Vali Acc: 0.568 Test Loss: 1.813 Test Acc: 0.568
Validation loss decreased (-0.513497 --> -0.567549).  Saving model ...
Epoch: 9 cost time: 1.5425848960876465
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.975 Vali Acc: 0.486 Test Loss: 1.975 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7358269691467285
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.181 Vali Acc: 0.459 Test Loss: 2.181 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5837018489837646
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.036 Vali Acc: 0.459 Test Loss: 2.036 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6989452838897705
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.039 Vali Acc: 0.446 Test Loss: 2.039 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4416999816894531
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.219 Vali Acc: 0.459 Test Loss: 2.219 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3476710319519043
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.133 Vali Acc: 0.473 Test Loss: 2.133 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5617856979370117
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.097 Vali Acc: 0.459 Test Loss: 2.097 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5054678916931152
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.117 Vali Acc: 0.473 Test Loss: 2.117 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.496216058731079
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.133 Vali Acc: 0.459 Test Loss: 2.133 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7798316478729248
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.459 Test Loss: 2.141 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 230788
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8888752460479736
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.435 Vali Acc: 0.270 Test Loss: 1.435 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.9401671886444092
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.282 Vali Acc: 0.351 Test Loss: 1.282 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351339).  Saving model ...
Epoch: 3 cost time: 1.153665542602539
Epoch: 3, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.194 Vali Acc: 0.405 Test Loss: 1.194 Test Acc: 0.405
Validation loss decreased (-0.351339 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.0183827877044678
Epoch: 4, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.245 Vali Acc: 0.419 Test Loss: 1.245 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.1924359798431396
Epoch: 5, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.3674581050872803
Epoch: 6, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.287 Vali Acc: 0.459 Test Loss: 1.287 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2145740985870361
Epoch: 7, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.2456459999084473
Epoch: 8, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.330 Vali Acc: 0.486 Test Loss: 1.330 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2072458267211914
Epoch: 9, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.422 Vali Acc: 0.486 Test Loss: 1.422 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0862843990325928
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.412 Vali Acc: 0.500 Test Loss: 1.412 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2958507537841797
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.596 Vali Acc: 0.527 Test Loss: 1.596 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527011).  Saving model ...
Epoch: 12 cost time: 1.2201621532440186
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.553 Vali Acc: 0.473 Test Loss: 1.553 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0891456604003906
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.640 Vali Acc: 0.500 Test Loss: 1.640 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2827601432800293
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.671 Vali Acc: 0.486 Test Loss: 1.671 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.284717082977295
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.702 Vali Acc: 0.446 Test Loss: 1.702 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3661561012268066
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.725 Vali Acc: 0.473 Test Loss: 1.725 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2853193283081055
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.730 Vali Acc: 0.473 Test Loss: 1.730 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.332038164138794
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.711 Vali Acc: 0.459 Test Loss: 1.711 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3195109367370605
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.723 Vali Acc: 0.459 Test Loss: 1.723 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2794232368469238
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.751 Vali Acc: 0.459 Test Loss: 1.751 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0817584991455078
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.759 Vali Acc: 0.459 Test Loss: 1.759 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 129028
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.948035955429077
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.339 Vali Acc: 0.311 Test Loss: 1.339 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.300260066986084
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.2095568180084229
Epoch: 3, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.9859259128570557
Epoch: 4, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.150 Vali Acc: 0.419 Test Loss: 1.150 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2206151485443115
Epoch: 5, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.194 Vali Acc: 0.527 Test Loss: 1.194 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.1654884815216064
Epoch: 6, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1418979167938232
Epoch: 7, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2080178260803223
Epoch: 8, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.061234474182129
Epoch: 9, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.305 Vali Acc: 0.473 Test Loss: 1.305 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1046321392059326
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.308 Vali Acc: 0.514 Test Loss: 1.308 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2687466144561768
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.358 Vali Acc: 0.486 Test Loss: 1.358 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2380144596099854
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.496 Vali Acc: 0.486 Test Loss: 1.496 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0851924419403076
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.481 Vali Acc: 0.459 Test Loss: 1.481 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0263104438781738
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.503 Vali Acc: 0.500 Test Loss: 1.503 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0175960063934326
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.541 Vali Acc: 0.486 Test Loss: 1.541 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 93828
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7385878562927246
Epoch: 1, Steps: 10 | Train Loss: 1.516 Vali Loss: 1.417 Vali Acc: 0.257 Test Loss: 1.417 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.1369237899780273
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.1317412853240967
Epoch: 3, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.1596829891204834
Epoch: 4, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.174 Vali Acc: 0.459 Test Loss: 1.174 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.1544649600982666
Epoch: 5, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.138 Vali Acc: 0.486 Test Loss: 1.138 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.0704152584075928
Epoch: 6, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.176 Vali Acc: 0.459 Test Loss: 1.176 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.100139856338501
Epoch: 7, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.207 Vali Acc: 0.514 Test Loss: 1.207 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.1473402976989746
Epoch: 8, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0418360233306885
Epoch: 9, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.229522943496704
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1563429832458496
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1906518936157227
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.321 Vali Acc: 0.554 Test Loss: 1.321 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 13 cost time: 1.2040081024169922
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.428 Vali Acc: 0.527 Test Loss: 1.428 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9707944393157959
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.418 Vali Acc: 0.554 Test Loss: 1.418 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8638944625854492
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.438 Vali Acc: 0.554 Test Loss: 1.438 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9600110054016113
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.470 Vali Acc: 0.541 Test Loss: 1.470 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0502650737762451
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.453 Vali Acc: 0.541 Test Loss: 1.453 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1749742031097412
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.503 Vali Acc: 0.568 Test Loss: 1.503 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567553).  Saving model ...
Epoch: 19 cost time: 1.258052110671997
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.532 Vali Acc: 0.554 Test Loss: 1.532 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9874267578125
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.532 Vali Acc: 0.554 Test Loss: 1.532 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1859593391418457
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.559 Vali Acc: 0.554 Test Loss: 1.559 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8431949615478516
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.551 Vali Acc: 0.554 Test Loss: 1.551 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2313838005065918
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.582 Vali Acc: 0.568 Test Loss: 1.582 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9147458076477051
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.614 Vali Acc: 0.554 Test Loss: 1.614 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1262130737304688
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.619 Vali Acc: 0.554 Test Loss: 1.619 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2650632858276367
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.615 Vali Acc: 0.541 Test Loss: 1.615 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0519766807556152
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.621 Vali Acc: 0.541 Test Loss: 1.621 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9593801498413086
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.648 Vali Acc: 0.554 Test Loss: 1.648 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 79108
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8551762104034424
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.395 Vali Acc: 0.257 Test Loss: 1.395 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.303201675415039
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.338 Vali Acc: 0.324 Test Loss: 1.338 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.016667366027832
Epoch: 3, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.3719630241394043
Epoch: 4, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9985430240631104
Epoch: 5, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.214 Vali Acc: 0.446 Test Loss: 1.214 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3281095027923584
Epoch: 6, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.164 Vali Acc: 0.473 Test Loss: 1.164 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.1037867069244385
Epoch: 7, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.2155327796936035
Epoch: 8, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3005931377410889
Epoch: 9, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.165 Vali Acc: 0.541 Test Loss: 1.165 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.3168399333953857
Epoch: 10, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0517163276672363
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.180 Vali Acc: 0.568 Test Loss: 1.180 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.2589735984802246
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.291 Vali Acc: 0.541 Test Loss: 1.291 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.876776933670044
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.265 Vali Acc: 0.568 Test Loss: 1.265 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.116706371307373
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.350 Vali Acc: 0.581 Test Loss: 1.350 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 15 cost time: 1.1101291179656982
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.346 Vali Acc: 0.568 Test Loss: 1.346 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0767614841461182
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.410 Vali Acc: 0.568 Test Loss: 1.410 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.980858564376831
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.404 Vali Acc: 0.581 Test Loss: 1.404 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.048175573348999
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.434 Vali Acc: 0.595 Test Loss: 1.434 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594580).  Saving model ...
Epoch: 19 cost time: 1.2111060619354248
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.461 Vali Acc: 0.554 Test Loss: 1.461 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.088318109512329
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.497 Vali Acc: 0.554 Test Loss: 1.497 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1584537029266357
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.523 Vali Acc: 0.541 Test Loss: 1.523 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8890113830566406
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.538 Vali Acc: 0.554 Test Loss: 1.538 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1405596733093262
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.541 Vali Acc: 0.554 Test Loss: 1.541 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1259145736694336
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.573 Vali Acc: 0.568 Test Loss: 1.573 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.301576852798462
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.588 Vali Acc: 0.568 Test Loss: 1.588 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1716718673706055
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.592 Vali Acc: 0.568 Test Loss: 1.592 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0675764083862305
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.602 Vali Acc: 0.554 Test Loss: 1.602 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9171779155731201
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.614 Vali Acc: 0.554 Test Loss: 1.614 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 62468
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6107401847839355
Epoch: 1, Steps: 10 | Train Loss: 1.547 Vali Loss: 1.322 Vali Acc: 0.351 Test Loss: 1.322 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.8621566295623779
Epoch: 2, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.264 Vali Acc: 0.392 Test Loss: 1.264 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.9218640327453613
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.9008350372314453
Epoch: 4, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.186 Vali Acc: 0.459 Test Loss: 1.186 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 0.8094069957733154
Epoch: 5, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.138 Vali Acc: 0.459 Test Loss: 1.138 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 0.8482959270477295
Epoch: 6, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.9512343406677246
Epoch: 7, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.8217008113861084
Epoch: 8, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9644668102264404
Epoch: 9, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8934576511383057
Epoch: 10, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.882798433303833
Epoch: 11, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8235125541687012
Epoch: 12, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.193 Vali Acc: 0.568 Test Loss: 1.193 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 0.8820157051086426
Epoch: 13, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 14 cost time: 0.9726362228393555
Epoch: 14, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.202 Vali Acc: 0.581 Test Loss: 1.202 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8892073631286621
Epoch: 15, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.212 Vali Acc: 0.595 Test Loss: 1.212 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 16 cost time: 0.9532029628753662
Epoch: 16, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.273 Vali Acc: 0.514 Test Loss: 1.273 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9404125213623047
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.304 Vali Acc: 0.581 Test Loss: 1.304 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7888083457946777
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.330 Vali Acc: 0.568 Test Loss: 1.330 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.908604621887207
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7640542984008789
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.370 Vali Acc: 0.581 Test Loss: 1.370 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.901890754699707
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.411 Vali Acc: 0.541 Test Loss: 1.411 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.822962760925293
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.436 Vali Acc: 0.568 Test Loss: 1.436 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9147961139678955
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.463 Vali Acc: 0.581 Test Loss: 1.463 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7674593925476074
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.459 Vali Acc: 0.568 Test Loss: 1.459 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9408812522888184
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.487 Vali Acc: 0.581 Test Loss: 1.487 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 56068
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.622609853744507
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.594 Vali Acc: 0.162 Test Loss: 1.594 Test Acc: 0.162
Validation loss decreased (inf --> -0.162146).  Saving model ...
Epoch: 2 cost time: 0.7781305313110352
Epoch: 2, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.542 Vali Acc: 0.203 Test Loss: 1.542 Test Acc: 0.203
Validation loss decreased (-0.162146 --> -0.202687).  Saving model ...
Epoch: 3 cost time: 0.7747399806976318
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.459 Vali Acc: 0.297 Test Loss: 1.459 Test Acc: 0.297
Validation loss decreased (-0.202687 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 0.8097641468048096
Epoch: 4, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.385 Vali Acc: 0.405 Test Loss: 1.385 Test Acc: 0.405
Validation loss decreased (-0.297283 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.8401005268096924
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.325 Vali Acc: 0.351 Test Loss: 1.325 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.792182207107544
Epoch: 6, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.282 Vali Acc: 0.405 Test Loss: 1.282 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 0.8421115875244141
Epoch: 7, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.243 Vali Acc: 0.392 Test Loss: 1.243 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7674529552459717
Epoch: 8, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 0.8589468002319336
Epoch: 9, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7324459552764893
Epoch: 10, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.210 Vali Acc: 0.514 Test Loss: 1.210 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 11 cost time: 0.8955283164978027
Epoch: 11, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9590375423431396
Epoch: 12, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7964212894439697
Epoch: 13, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9907345771789551
Epoch: 14, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8603050708770752
Epoch: 15, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.297 Vali Acc: 0.514 Test Loss: 1.297 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9409546852111816
Epoch: 16, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 17 cost time: 0.8468003273010254
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.400 Vali Acc: 0.486 Test Loss: 1.400 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.824918270111084
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.386 Vali Acc: 0.527 Test Loss: 1.386 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8584952354431152
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.409 Vali Acc: 0.514 Test Loss: 1.409 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8014154434204102
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.451 Vali Acc: 0.541 Test Loss: 1.451 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540526).  Saving model ...
Epoch: 21 cost time: 0.9358270168304443
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.500 Vali Acc: 0.554 Test Loss: 1.500 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554039).  Saving model ...
Epoch: 22 cost time: 0.844984769821167
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.520 Vali Acc: 0.527 Test Loss: 1.520 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8181664943695068
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.525 Vali Acc: 0.514 Test Loss: 1.525 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8364076614379883
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.540 Vali Acc: 0.514 Test Loss: 1.540 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9332492351531982
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.552 Vali Acc: 0.527 Test Loss: 1.552 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9301455020904541
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.566 Vali Acc: 0.527 Test Loss: 1.566 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8082454204559326
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.577 Vali Acc: 0.554 Test Loss: 1.577 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8960421085357666
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.613 Vali Acc: 0.554 Test Loss: 1.613 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8002364635467529
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.625 Vali Acc: 0.527 Test Loss: 1.625 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8845765590667725
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.622 Vali Acc: 0.527 Test Loss: 1.622 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8310329914093018
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.643 Vali Acc: 0.514 Test Loss: 1.643 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm64_nh16_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 52228
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7626264095306396
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.8868722915649414
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.211 Vali Acc: 0.541 Test Loss: 1.211 Test Acc: 0.541
Validation loss decreased (-0.243229 --> -0.540528).  Saving model ...
Epoch: 3 cost time: 0.8951153755187988
Epoch: 3, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9153404235839844
Epoch: 4, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0615334510803223
Epoch: 5, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.284 Vali Acc: 0.459 Test Loss: 1.284 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1001455783843994
Epoch: 6, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.330 Vali Acc: 0.459 Test Loss: 1.330 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0380191802978516
Epoch: 7, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.0211918354034424
Epoch: 8, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.487 Vali Acc: 0.514 Test Loss: 1.487 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9745192527770996
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1601214408874512
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.472 Vali Acc: 0.514 Test Loss: 1.472 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.963127613067627
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9382612705230713
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.579 Vali Acc: 0.459 Test Loss: 1.579 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1240622997283936
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.579 Vali Acc: 0.514 Test Loss: 1.579 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0873017311096191
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.595 Vali Acc: 0.446 Test Loss: 1.595 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0706543922424316
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.660 Vali Acc: 0.486 Test Loss: 1.660 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0480670928955078
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.612 Vali Acc: 0.486 Test Loss: 1.612 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9439096450805664
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.621 Vali Acc: 0.514 Test Loss: 1.621 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 123812
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0507261753082275
Epoch: 1, Steps: 10 | Train Loss: 1.599 Vali Loss: 1.450 Vali Acc: 0.257 Test Loss: 1.450 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.9840896129608154
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.370 Vali Acc: 0.324 Test Loss: 1.370 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.0584635734558105
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.336 Vali Acc: 0.365 Test Loss: 1.336 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.0437991619110107
Epoch: 4, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.226 Vali Acc: 0.459 Test Loss: 1.226 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.1803817749023438
Epoch: 5, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.200 Vali Acc: 0.446 Test Loss: 1.200 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0638701915740967
Epoch: 6, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.201 Vali Acc: 0.446 Test Loss: 1.201 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9902889728546143
Epoch: 7, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.207 Vali Acc: 0.432 Test Loss: 1.207 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0426056385040283
Epoch: 8, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.0667343139648438
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.249 Vali Acc: 0.432 Test Loss: 1.249 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0238821506500244
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.229 Vali Acc: 0.459 Test Loss: 1.229 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0733871459960938
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.321 Vali Acc: 0.486 Test Loss: 1.321 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486473).  Saving model ...
Epoch: 12 cost time: 1.0133280754089355
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.322 Vali Acc: 0.473 Test Loss: 1.322 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9378538131713867
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.383 Vali Acc: 0.473 Test Loss: 1.383 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9189038276672363
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.450 Vali Acc: 0.432 Test Loss: 1.450 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1597826480865479
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.444 Vali Acc: 0.432 Test Loss: 1.444 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2675414085388184
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.486 Vali Acc: 0.432 Test Loss: 1.486 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4082956314086914
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.493 Vali Acc: 0.446 Test Loss: 1.493 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2304511070251465
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.511 Vali Acc: 0.459 Test Loss: 1.511 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3213458061218262
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.534 Vali Acc: 0.446 Test Loss: 1.534 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.240978479385376
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.539 Vali Acc: 0.446 Test Loss: 1.539 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9523317813873291
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.560 Vali Acc: 0.446 Test Loss: 1.560 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 72932
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3457448482513428
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.381 Vali Acc: 0.351 Test Loss: 1.381 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.222362995147705
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.301 Vali Acc: 0.419 Test Loss: 1.301 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.1651256084442139
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.256 Vali Acc: 0.432 Test Loss: 1.256 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.2542243003845215
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.2191591262817383
Epoch: 5, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.148 Vali Acc: 0.446 Test Loss: 1.148 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1292924880981445
Epoch: 6, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.1698517799377441
Epoch: 7, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.148848056793213
Epoch: 8, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.188978672027588
Epoch: 9, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2287986278533936
Epoch: 10, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0290403366088867
Epoch: 11, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.198 Vali Acc: 0.595 Test Loss: 1.198 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 12 cost time: 0.9077019691467285
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.206 Vali Acc: 0.581 Test Loss: 1.206 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2519423961639404
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.242 Vali Acc: 0.568 Test Loss: 1.242 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1982719898223877
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.270 Vali Acc: 0.595 Test Loss: 1.270 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1487877368927002
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.315 Vali Acc: 0.568 Test Loss: 1.315 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1786961555480957
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.357 Vali Acc: 0.595 Test Loss: 1.357 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0252859592437744
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.371 Vali Acc: 0.581 Test Loss: 1.371 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1834068298339844
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.386 Vali Acc: 0.622 Test Loss: 1.386 Test Acc: 0.622
Validation loss decreased (-0.594583 --> -0.621608).  Saving model ...
Epoch: 19 cost time: 1.2841107845306396
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.409 Vali Acc: 0.608 Test Loss: 1.409 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.238814353942871
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.455 Vali Acc: 0.595 Test Loss: 1.455 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.254495620727539
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.466 Vali Acc: 0.608 Test Loss: 1.466 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0470926761627197
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.487 Vali Acc: 0.595 Test Loss: 1.487 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2690672874450684
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.511 Vali Acc: 0.595 Test Loss: 1.511 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1785528659820557
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.525 Vali Acc: 0.595 Test Loss: 1.525 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0584678649902344
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.524 Vali Acc: 0.595 Test Loss: 1.524 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2213308811187744
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.531 Vali Acc: 0.595 Test Loss: 1.531 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3812267780303955
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.533 Vali Acc: 0.595 Test Loss: 1.533 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3499870300292969
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.556 Vali Acc: 0.622 Test Loss: 1.556 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 55332
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.709397792816162
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.458 Vali Acc: 0.257 Test Loss: 1.458 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.846071720123291
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.364 Vali Acc: 0.297 Test Loss: 1.364 Test Acc: 0.297
Validation loss decreased (-0.256742 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.0055232048034668
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.338 Vali Acc: 0.338 Test Loss: 1.338 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.0239896774291992
Epoch: 4, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.247 Vali Acc: 0.405 Test Loss: 1.247 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 0.9558403491973877
Epoch: 5, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.224 Vali Acc: 0.405 Test Loss: 1.224 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 1.0672285556793213
Epoch: 6, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.216 Vali Acc: 0.405 Test Loss: 1.216 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 0.970754861831665
Epoch: 7, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.130 Vali Acc: 0.432 Test Loss: 1.130 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432421).  Saving model ...
Epoch: 8 cost time: 0.9010424613952637
Epoch: 8, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.131 Vali Acc: 0.459 Test Loss: 1.131 Test Acc: 0.459
Validation loss decreased (-0.432421 --> -0.459448).  Saving model ...
Epoch: 9 cost time: 0.9376070499420166
Epoch: 9, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.116 Vali Acc: 0.473 Test Loss: 1.116 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 10 cost time: 1.0421090126037598
Epoch: 10, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 0.9338574409484863
Epoch: 11, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 0.9792764186859131
Epoch: 12, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.082 Vali Acc: 0.514 Test Loss: 1.082 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.009840726852417
Epoch: 13, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0005526542663574
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 1.2187607288360596
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 0.9850952625274658
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9205951690673828
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.194 Vali Acc: 0.554 Test Loss: 1.194 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9722418785095215
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.222 Vali Acc: 0.527 Test Loss: 1.222 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9816246032714844
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.243 Vali Acc: 0.568 Test Loss: 1.243 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9565885066986084
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.246 Vali Acc: 0.554 Test Loss: 1.246 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0107319355010986
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.264 Vali Acc: 0.568 Test Loss: 1.264 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0259132385253906
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.275 Vali Acc: 0.581 Test Loss: 1.275 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 23 cost time: 1.0366432666778564
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.304 Vali Acc: 0.554 Test Loss: 1.304 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.100644826889038
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0030786991119385
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.336 Vali Acc: 0.554 Test Loss: 1.336 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9806950092315674
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.332 Vali Acc: 0.581 Test Loss: 1.332 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9170544147491455
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.333 Vali Acc: 0.581 Test Loss: 1.333 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9592185020446777
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.358 Vali Acc: 0.541 Test Loss: 1.358 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9364302158355713
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.375 Vali Acc: 0.554 Test Loss: 1.375 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8878839015960693
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.387 Vali Acc: 0.541 Test Loss: 1.387 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8049287796020508
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.395 Vali Acc: 0.527 Test Loss: 1.395 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.960047721862793
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.406 Vali Acc: 0.554 Test Loss: 1.406 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 47972
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.711216926574707
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.435 Vali Acc: 0.257 Test Loss: 1.435 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.9053308963775635
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.415 Vali Acc: 0.297 Test Loss: 1.415 Test Acc: 0.297
Validation loss decreased (-0.256742 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.9481427669525146
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.372 Vali Acc: 0.378 Test Loss: 1.372 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.8334903717041016
Epoch: 4, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.305 Vali Acc: 0.432 Test Loss: 1.305 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 0.7903695106506348
Epoch: 5, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.270 Vali Acc: 0.432 Test Loss: 1.270 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.8674604892730713
Epoch: 6, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.8250434398651123
Epoch: 7, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.048388957977295
Epoch: 8, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.8682425022125244
Epoch: 9, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.9218306541442871
Epoch: 10, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 0.8612298965454102
Epoch: 11, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.159 Vali Acc: 0.541 Test Loss: 1.159 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1378827095031738
Epoch: 12, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8679702281951904
Epoch: 13, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0194792747497559
Epoch: 14, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 0.8634591102600098
Epoch: 15, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.179 Vali Acc: 0.581 Test Loss: 1.179 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 16 cost time: 0.9165112972259521
Epoch: 16, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.183 Vali Acc: 0.541 Test Loss: 1.183 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9289824962615967
Epoch: 17, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.200 Vali Acc: 0.581 Test Loss: 1.200 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8838508129119873
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.194 Vali Acc: 0.581 Test Loss: 1.194 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8547754287719727
Epoch: 19, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.247 Vali Acc: 0.595 Test Loss: 1.247 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 20 cost time: 1.0279510021209717
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.236 Vali Acc: 0.554 Test Loss: 1.236 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9152264595031738
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.262 Vali Acc: 0.568 Test Loss: 1.262 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8722734451293945
Epoch: 22, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.292 Vali Acc: 0.568 Test Loss: 1.292 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9223241806030273
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.303 Vali Acc: 0.541 Test Loss: 1.303 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8996336460113525
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9913702011108398
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.318 Vali Acc: 0.568 Test Loss: 1.318 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.899402379989624
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.348 Vali Acc: 0.581 Test Loss: 1.348 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8515505790710449
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.339 Vali Acc: 0.595 Test Loss: 1.339 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9871306419372559
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.348 Vali Acc: 0.595 Test Loss: 1.348 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8177511692047119
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.376 Vali Acc: 0.595 Test Loss: 1.376 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 39652
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7582180500030518
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.513 Vali Acc: 0.216 Test Loss: 1.513 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 0.8627245426177979
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
Validation loss decreased (-0.216201 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.7881948947906494
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.443 Vali Acc: 0.203 Test Loss: 1.443 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8881180286407471
Epoch: 4, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.410 Vali Acc: 0.257 Test Loss: 1.410 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256743).  Saving model ...
Epoch: 5 cost time: 0.8956913948059082
Epoch: 5, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.338 Vali Acc: 0.365 Test Loss: 1.338 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364851).  Saving model ...
Epoch: 6 cost time: 0.8027050495147705
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 0.9162583351135254
Epoch: 7, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 0.9724843502044678
Epoch: 8, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 0.7962868213653564
Epoch: 9, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 0.7809560298919678
Epoch: 10, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.204 Vali Acc: 0.432 Test Loss: 1.204 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9042589664459229
Epoch: 11, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.171 Vali Acc: 0.459 Test Loss: 1.171 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 12 cost time: 0.8862943649291992
Epoch: 12, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 13 cost time: 0.973703145980835
Epoch: 13, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7243883609771729
Epoch: 14, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8352465629577637
Epoch: 15, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 16 cost time: 0.9149012565612793
Epoch: 16, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 0.8117208480834961
Epoch: 17, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.748502254486084
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.812676191329956
Epoch: 19, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 20 cost time: 0.8833272457122803
Epoch: 20, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8854339122772217
Epoch: 21, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7989637851715088
Epoch: 22, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8512983322143555
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.812798261642456
Epoch: 24, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.294 Vali Acc: 0.514 Test Loss: 1.294 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8513014316558838
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.296 Vali Acc: 0.527 Test Loss: 1.296 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527014).  Saving model ...
Epoch: 26 cost time: 0.8796303272247314
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.282 Vali Acc: 0.541 Test Loss: 1.282 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540528).  Saving model ...
Epoch: 27 cost time: 1.034625768661499
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.329 Vali Acc: 0.500 Test Loss: 1.329 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7787208557128906
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.365 Vali Acc: 0.514 Test Loss: 1.365 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.972938060760498
Epoch: 29, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8500268459320068
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.377 Vali Acc: 0.541 Test Loss: 1.377 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.828343391418457
Epoch: 31, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.364 Vali Acc: 0.541 Test Loss: 1.364 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8280282020568848
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.368 Vali Acc: 0.541 Test Loss: 1.368 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8426010608673096
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.366 Vali Acc: 0.541 Test Loss: 1.366 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8291552066802979
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.387 Vali Acc: 0.554 Test Loss: 1.387 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554040).  Saving model ...
Epoch: 35 cost time: 0.9376749992370605
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.406 Vali Acc: 0.541 Test Loss: 1.406 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9263856410980225
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.404 Vali Acc: 0.554 Test Loss: 1.404 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.89188551902771
Epoch: 37, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.413 Vali Acc: 0.527 Test Loss: 1.413 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9633383750915527
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.431 Vali Acc: 0.541 Test Loss: 1.431 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8466699123382568
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.417 Vali Acc: 0.541 Test Loss: 1.417 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9632189273834229
Epoch: 40, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.434 Vali Acc: 0.554 Test Loss: 1.434 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9032108783721924
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.468 Vali Acc: 0.541 Test Loss: 1.468 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0150048732757568
Epoch: 42, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.487 Vali Acc: 0.541 Test Loss: 1.487 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8567452430725098
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.489 Vali Acc: 0.527 Test Loss: 1.489 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9653351306915283
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.506 Vali Acc: 0.541 Test Loss: 1.506 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 36452
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4935343265533447
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.533 Vali Acc: 0.162 Test Loss: 1.533 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 0.9847984313964844
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.483 Vali Acc: 0.189 Test Loss: 1.483 Test Acc: 0.189
Validation loss decreased (-0.162147 --> -0.189174).  Saving model ...
Epoch: 3 cost time: 0.954401969909668
Epoch: 3, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.439 Vali Acc: 0.216 Test Loss: 1.439 Test Acc: 0.216
Validation loss decreased (-0.189174 --> -0.216202).  Saving model ...
Epoch: 4 cost time: 0.9555935859680176
Epoch: 4, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.377 Vali Acc: 0.297 Test Loss: 1.377 Test Acc: 0.297
Validation loss decreased (-0.216202 --> -0.297284).  Saving model ...
Epoch: 5 cost time: 0.9475479125976562
Epoch: 5, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.316 Vali Acc: 0.405 Test Loss: 1.316 Test Acc: 0.405
Validation loss decreased (-0.297284 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 0.9423494338989258
Epoch: 6, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.286 Vali Acc: 0.459 Test Loss: 1.286 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.0265247821807861
Epoch: 7, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.9325196743011475
Epoch: 8, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.215 Vali Acc: 0.554 Test Loss: 1.215 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 0.7542390823364258
Epoch: 9, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8664681911468506
Epoch: 10, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7875397205352783
Epoch: 11, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9039802551269531
Epoch: 12, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.037236213684082
Epoch: 13, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.183 Vali Acc: 0.568 Test Loss: 1.183 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 0.8893961906433105
Epoch: 14, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.186 Vali Acc: 0.541 Test Loss: 1.186 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8379497528076172
Epoch: 15, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.194 Vali Acc: 0.554 Test Loss: 1.194 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0185153484344482
Epoch: 16, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8724792003631592
Epoch: 17, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9035112857818604
Epoch: 18, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7953951358795166
Epoch: 19, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8513970375061035
Epoch: 20, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.247 Vali Acc: 0.595 Test Loss: 1.247 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594582).  Saving model ...
Epoch: 21 cost time: 0.820685625076294
Epoch: 21, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.275 Vali Acc: 0.595 Test Loss: 1.275 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8596343994140625
Epoch: 22, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.285 Vali Acc: 0.554 Test Loss: 1.285 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8520328998565674
Epoch: 23, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.294 Vali Acc: 0.554 Test Loss: 1.294 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8254773616790771
Epoch: 24, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.321 Vali Acc: 0.541 Test Loss: 1.321 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0916686058044434
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.346 Vali Acc: 0.568 Test Loss: 1.346 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8829641342163086
Epoch: 26, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.356 Vali Acc: 0.554 Test Loss: 1.356 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8984527587890625
Epoch: 27, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.374 Vali Acc: 0.554 Test Loss: 1.374 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9103422164916992
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.385 Vali Acc: 0.554 Test Loss: 1.385 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8505549430847168
Epoch: 29, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.402 Vali Acc: 0.554 Test Loss: 1.402 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.894385576248169
Epoch: 30, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.424 Vali Acc: 0.554 Test Loss: 1.424 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 34532
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0966970920562744
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.456 Vali Acc: 0.230 Test Loss: 1.456 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.2659573554992676
Epoch: 2, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.366 Vali Acc: 0.324 Test Loss: 1.366 Test Acc: 0.324
Validation loss decreased (-0.229715 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.096721887588501
Epoch: 3, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.258 Vali Acc: 0.378 Test Loss: 1.258 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 1.1167547702789307
Epoch: 4, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.240 Vali Acc: 0.473 Test Loss: 1.240 Test Acc: 0.473
Validation loss decreased (-0.378366 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.251774787902832
Epoch: 5, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.0093941688537598
Epoch: 6, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.248 Vali Acc: 0.419 Test Loss: 1.248 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1930537223815918
Epoch: 7, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9593777656555176
Epoch: 8, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527012).  Saving model ...
Epoch: 9 cost time: 1.197723150253296
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.322 Vali Acc: 0.527 Test Loss: 1.322 Test Acc: 0.527
Validation loss decreased (-0.527012 --> -0.527014).  Saving model ...
Epoch: 10 cost time: 1.1231272220611572
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.377 Vali Acc: 0.500 Test Loss: 1.377 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0785143375396729
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.610 Vali Acc: 0.500 Test Loss: 1.610 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9726719856262207
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.518 Vali Acc: 0.554 Test Loss: 1.518 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554039).  Saving model ...
Epoch: 13 cost time: 1.1720054149627686
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1275720596313477
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.616 Vali Acc: 0.527 Test Loss: 1.616 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0126574039459229
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2163753509521484
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.657 Vali Acc: 0.500 Test Loss: 1.657 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0617311000823975
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.665 Vali Acc: 0.500 Test Loss: 1.665 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1873090267181396
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.675 Vali Acc: 0.527 Test Loss: 1.675 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1380183696746826
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.514 Test Loss: 1.683 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0929241180419922
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.705 Vali Acc: 0.486 Test Loss: 1.705 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0674641132354736
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.740 Vali Acc: 0.486 Test Loss: 1.740 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0954303741455078
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.737 Vali Acc: 0.500 Test Loss: 1.737 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 115492
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.928122043609619
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.517 Vali Acc: 0.257 Test Loss: 1.517 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.0386993885040283
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.395 Vali Acc: 0.324 Test Loss: 1.395 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.12062668800354
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.268 Vali Acc: 0.419 Test Loss: 1.268 Test Acc: 0.419
Validation loss decreased (-0.324310 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.1355218887329102
Epoch: 4, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.256 Vali Acc: 0.392 Test Loss: 1.256 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9381086826324463
Epoch: 5, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.235 Vali Acc: 0.392 Test Loss: 1.235 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1851603984832764
Epoch: 6, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.0575978755950928
Epoch: 7, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.234 Vali Acc: 0.392 Test Loss: 1.234 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1869111061096191
Epoch: 8, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 0.98309326171875
Epoch: 9, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.220 Vali Acc: 0.446 Test Loss: 1.220 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9817194938659668
Epoch: 10, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.318 Vali Acc: 0.419 Test Loss: 1.318 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2514472007751465
Epoch: 11, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.294 Vali Acc: 0.419 Test Loss: 1.294 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.000112771987915
Epoch: 12, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.415 Vali Acc: 0.432 Test Loss: 1.415 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9202654361724854
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.428 Vali Acc: 0.432 Test Loss: 1.428 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0835833549499512
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.524 Vali Acc: 0.446 Test Loss: 1.524 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9567372798919678
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.472 Vali Acc: 0.459 Test Loss: 1.472 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.265852689743042
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.520 Vali Acc: 0.419 Test Loss: 1.520 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0814428329467773
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.538 Vali Acc: 0.459 Test Loss: 1.538 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2175745964050293
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.619 Vali Acc: 0.432 Test Loss: 1.619 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 64612
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7168617248535156
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.472 Vali Acc: 0.176 Test Loss: 1.472 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.0592777729034424
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.428 Vali Acc: 0.311 Test Loss: 1.428 Test Acc: 0.311
Validation loss decreased (-0.175661 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.149505853652954
Epoch: 3, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.390 Vali Acc: 0.338 Test Loss: 1.390 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.1208326816558838
Epoch: 4, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.299 Vali Acc: 0.365 Test Loss: 1.299 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.2099475860595703
Epoch: 5, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.270 Vali Acc: 0.446 Test Loss: 1.270 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.1058344841003418
Epoch: 6, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.1135330200195312
Epoch: 7, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.187 Vali Acc: 0.459 Test Loss: 1.187 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.161982774734497
Epoch: 8, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.240 Vali Acc: 0.473 Test Loss: 1.240 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2173078060150146
Epoch: 9, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1863832473754883
Epoch: 10, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.153832197189331
Epoch: 11, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.035109043121338
Epoch: 12, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.225 Vali Acc: 0.595 Test Loss: 1.225 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594582).  Saving model ...
Epoch: 13 cost time: 1.1151981353759766
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.257 Vali Acc: 0.608 Test Loss: 1.257 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608096).  Saving model ...
Epoch: 14 cost time: 0.9573841094970703
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.266 Vali Acc: 0.514 Test Loss: 1.266 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9293854236602783
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.349 Vali Acc: 0.527 Test Loss: 1.349 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9505612850189209
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.333 Vali Acc: 0.527 Test Loss: 1.333 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.987135648727417
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.404 Vali Acc: 0.568 Test Loss: 1.404 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1083929538726807
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.438 Vali Acc: 0.554 Test Loss: 1.438 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9559400081634521
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.458 Vali Acc: 0.581 Test Loss: 1.458 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9094979763031006
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.485 Vali Acc: 0.554 Test Loss: 1.485 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.136704921722412
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.488 Vali Acc: 0.554 Test Loss: 1.488 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1908254623413086
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.515 Vali Acc: 0.554 Test Loss: 1.515 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1301143169403076
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.529 Vali Acc: 0.568 Test Loss: 1.529 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 47012
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5898447036743164
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.411 Vali Acc: 0.297 Test Loss: 1.411 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.8665940761566162
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (-0.297283 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.9281280040740967
Epoch: 3, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.321 Vali Acc: 0.365 Test Loss: 1.321 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.8011665344238281
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.260 Vali Acc: 0.446 Test Loss: 1.260 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.9062950611114502
Epoch: 5, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.978832483291626
Epoch: 6, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.8793172836303711
Epoch: 7, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.169 Vali Acc: 0.432 Test Loss: 1.169 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8532965183258057
Epoch: 8, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.149 Vali Acc: 0.459 Test Loss: 1.149 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8522725105285645
Epoch: 9, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8332805633544922
Epoch: 10, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8101475238800049
Epoch: 11, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 0.7464752197265625
Epoch: 12, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8345725536346436
Epoch: 13, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 14 cost time: 0.7758080959320068
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.199 Vali Acc: 0.486 Test Loss: 1.199 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7628226280212402
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.228 Vali Acc: 0.541 Test Loss: 1.228 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7516200542449951
Epoch: 16, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7185192108154297
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.237 Vali Acc: 0.514 Test Loss: 1.237 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8032872676849365
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.235 Vali Acc: 0.541 Test Loss: 1.235 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8105103969573975
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.279 Vali Acc: 0.541 Test Loss: 1.279 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7868976593017578
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.271 Vali Acc: 0.514 Test Loss: 1.271 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8134098052978516
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.294 Vali Acc: 0.514 Test Loss: 1.294 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9180703163146973
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8562815189361572
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.356 Vali Acc: 0.527 Test Loss: 1.356 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 39652
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6834025382995605
Epoch: 1, Steps: 10 | Train Loss: 1.607 Vali Loss: 1.431 Vali Acc: 0.324 Test Loss: 1.431 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 0.8374853134155273
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.404 Vali Acc: 0.311 Test Loss: 1.404 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9484291076660156
Epoch: 3, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.354 Vali Acc: 0.324 Test Loss: 1.354 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.9907166957855225
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.302 Vali Acc: 0.405 Test Loss: 1.302 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.8016736507415771
Epoch: 5, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.252 Vali Acc: 0.446 Test Loss: 1.252 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.9436945915222168
Epoch: 6, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.9301984310150146
Epoch: 7, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.182 Vali Acc: 0.459 Test Loss: 1.182 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 8 cost time: 0.8720247745513916
Epoch: 8, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.9932088851928711
Epoch: 9, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.155 Vali Acc: 0.459 Test Loss: 1.155 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9684886932373047
Epoch: 10, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.8333144187927246
Epoch: 11, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9230060577392578
Epoch: 12, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.8685290813446045
Epoch: 13, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 14 cost time: 0.7900702953338623
Epoch: 14, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8413138389587402
Epoch: 15, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8748128414154053
Epoch: 16, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.190 Vali Acc: 0.514 Test Loss: 1.190 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7753593921661377
Epoch: 17, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.184 Vali Acc: 0.554 Test Loss: 1.184 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 18 cost time: 0.9372005462646484
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.220 Vali Acc: 0.581 Test Loss: 1.220 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 19 cost time: 0.8074219226837158
Epoch: 19, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.208 Vali Acc: 0.595 Test Loss: 1.208 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594583).  Saving model ...
Epoch: 20 cost time: 0.8807737827301025
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.212 Vali Acc: 0.568 Test Loss: 1.212 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9201221466064453
Epoch: 21, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.249 Vali Acc: 0.541 Test Loss: 1.249 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8217930793762207
Epoch: 22, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.269 Vali Acc: 0.554 Test Loss: 1.269 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9697132110595703
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.292 Vali Acc: 0.554 Test Loss: 1.292 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8818299770355225
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.313 Vali Acc: 0.541 Test Loss: 1.313 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8990573883056641
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.329 Vali Acc: 0.554 Test Loss: 1.329 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9373610019683838
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0224206447601318
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.358 Vali Acc: 0.554 Test Loss: 1.358 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9148101806640625
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.365 Vali Acc: 0.568 Test Loss: 1.365 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.033468246459961
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.388 Vali Acc: 0.554 Test Loss: 1.388 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 31332
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.781599760055542
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.584 Vali Acc: 0.189 Test Loss: 1.584 Test Acc: 0.189
Validation loss decreased (inf --> -0.189173).  Saving model ...
Epoch: 2 cost time: 0.8876998424530029
Epoch: 2, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.481 Vali Acc: 0.243 Test Loss: 1.481 Test Acc: 0.243
Validation loss decreased (-0.189173 --> -0.243228).  Saving model ...
Epoch: 3 cost time: 0.9140510559082031
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.405 Vali Acc: 0.297 Test Loss: 1.405 Test Acc: 0.297
Validation loss decreased (-0.243228 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 0.8419277667999268
Epoch: 4, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.354 Vali Acc: 0.392 Test Loss: 1.354 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391878).  Saving model ...
Epoch: 5 cost time: 0.8791885375976562
Epoch: 5, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.329 Vali Acc: 0.351 Test Loss: 1.329 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9102730751037598
Epoch: 6, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.309 Vali Acc: 0.365 Test Loss: 1.309 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9670586585998535
Epoch: 7, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.279 Vali Acc: 0.365 Test Loss: 1.279 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8382608890533447
Epoch: 8, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.259 Vali Acc: 0.338 Test Loss: 1.259 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9507629871368408
Epoch: 9, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.222 Vali Acc: 0.351 Test Loss: 1.222 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9180686473846436
Epoch: 10, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.206 Vali Acc: 0.405 Test Loss: 1.206 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405393).  Saving model ...
Epoch: 11 cost time: 0.8864657878875732
Epoch: 11, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.193 Vali Acc: 0.419 Test Loss: 1.193 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 12 cost time: 0.9231960773468018
Epoch: 12, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.215 Vali Acc: 0.446 Test Loss: 1.215 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445934).  Saving model ...
Epoch: 13 cost time: 0.8886616230010986
Epoch: 13, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.210 Vali Acc: 0.432 Test Loss: 1.210 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8438496589660645
Epoch: 14, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.197 Vali Acc: 0.446 Test Loss: 1.197 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 15 cost time: 0.8224964141845703
Epoch: 15, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.213 Vali Acc: 0.446 Test Loss: 1.213 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8567397594451904
Epoch: 16, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 17 cost time: 0.8837020397186279
Epoch: 17, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 18 cost time: 0.9046926498413086
Epoch: 18, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8776638507843018
Epoch: 19, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.281 Vali Acc: 0.446 Test Loss: 1.281 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9369175434112549
Epoch: 20, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9623274803161621
Epoch: 21, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499987).  Saving model ...
Epoch: 22 cost time: 0.9757664203643799
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.297 Vali Acc: 0.486 Test Loss: 1.297 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9454052448272705
Epoch: 23, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.292 Vali Acc: 0.514 Test Loss: 1.292 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 24 cost time: 0.9013676643371582
Epoch: 24, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.341 Vali Acc: 0.486 Test Loss: 1.341 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8692595958709717
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.350 Vali Acc: 0.473 Test Loss: 1.350 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9034276008605957
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.342 Vali Acc: 0.500 Test Loss: 1.342 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8915936946868896
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.366 Vali Acc: 0.486 Test Loss: 1.366 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8702106475830078
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.391 Vali Acc: 0.514 Test Loss: 1.391 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9018337726593018
Epoch: 29, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527013).  Saving model ...
Epoch: 30 cost time: 0.8237330913543701
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
Validation loss decreased (-0.527013 --> -0.527013).  Saving model ...
Epoch: 31 cost time: 0.934553861618042
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.392 Vali Acc: 0.514 Test Loss: 1.392 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9227690696716309
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.424 Vali Acc: 0.514 Test Loss: 1.424 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8595705032348633
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.439 Vali Acc: 0.514 Test Loss: 1.439 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9459428787231445
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.463 Vali Acc: 0.514 Test Loss: 1.463 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.022325038909912
Epoch: 35, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.477 Vali Acc: 0.514 Test Loss: 1.477 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.852348804473877
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.732499361038208
Epoch: 37, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.963555097579956
Epoch: 38, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.528 Vali Acc: 0.500 Test Loss: 1.528 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8907375335693359
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.527 Vali Acc: 0.500 Test Loss: 1.527 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9953525066375732
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.521 Vali Acc: 0.486 Test Loss: 1.521 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 28132
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5222249031066895
Epoch: 1, Steps: 10 | Train Loss: 1.523 Vali Loss: 1.456 Vali Acc: 0.216 Test Loss: 1.456 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.8832995891571045
Epoch: 2, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.418 Vali Acc: 0.284 Test Loss: 1.418 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.9816055297851562
Epoch: 3, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.0763404369354248
Epoch: 4, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.322 Vali Acc: 0.338 Test Loss: 1.322 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 0.7882330417633057
Epoch: 5, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.280 Vali Acc: 0.432 Test Loss: 1.280 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.9285752773284912
Epoch: 6, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 0.8456873893737793
Epoch: 7, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.221 Vali Acc: 0.473 Test Loss: 1.221 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.898836612701416
Epoch: 8, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 0.955134391784668
Epoch: 9, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9481022357940674
Epoch: 10, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.922435998916626
Epoch: 11, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.9797244071960449
Epoch: 12, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 0.9169204235076904
Epoch: 13, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0009760856628418
Epoch: 14, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9793589115142822
Epoch: 15, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9618022441864014
Epoch: 16, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9341030120849609
Epoch: 17, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9133975505828857
Epoch: 18, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.218 Vali Acc: 0.514 Test Loss: 1.218 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9815192222595215
Epoch: 19, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9019186496734619
Epoch: 20, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9525461196899414
Epoch: 21, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.280 Vali Acc: 0.473 Test Loss: 1.280 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9738273620605469
Epoch: 22, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.280 Vali Acc: 0.527 Test Loss: 1.280 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 26212
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.201975107192993
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.346 Vali Acc: 0.311 Test Loss: 1.346 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0216255187988281
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.348 Vali Acc: 0.351 Test Loss: 1.348 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.282146692276001
Epoch: 3, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.210913896560669
Epoch: 4, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.1008479595184326
Epoch: 5, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1209487915039062
Epoch: 6, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.188 Vali Acc: 0.568 Test Loss: 1.188 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 1.0122497081756592
Epoch: 7, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.285 Vali Acc: 0.514 Test Loss: 1.285 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.00053071975708
Epoch: 8, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.356 Vali Acc: 0.486 Test Loss: 1.356 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1074316501617432
Epoch: 9, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.373 Vali Acc: 0.554 Test Loss: 1.373 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.014026165008545
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1051831245422363
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.587 Vali Acc: 0.500 Test Loss: 1.587 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0564167499542236
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.472 Vali Acc: 0.500 Test Loss: 1.472 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2061352729797363
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.547 Vali Acc: 0.486 Test Loss: 1.547 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.122746229171753
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1064789295196533
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.636 Vali Acc: 0.473 Test Loss: 1.636 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.212571382522583
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.637 Vali Acc: 0.459 Test Loss: 1.637 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 111332
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.053251266479492
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.422 Vali Acc: 0.311 Test Loss: 1.422 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.994497537612915
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.153393268585205
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.310797 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.1373696327209473
Epoch: 4, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.216 Vali Acc: 0.514 Test Loss: 1.216 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.10432767868042
Epoch: 5, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1893947124481201
Epoch: 6, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.243 Vali Acc: 0.486 Test Loss: 1.243 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1689307689666748
Epoch: 7, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2154812812805176
Epoch: 8, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.097529649734497
Epoch: 9, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1413793563842773
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0420141220092773
Epoch: 11, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1792411804199219
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.397 Vali Acc: 0.554 Test Loss: 1.397 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554040).  Saving model ...
Epoch: 13 cost time: 0.9236950874328613
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1927251815795898
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.480 Vali Acc: 0.541 Test Loss: 1.480 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1115930080413818
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.482 Vali Acc: 0.500 Test Loss: 1.482 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1631317138671875
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.531 Vali Acc: 0.500 Test Loss: 1.531 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1083385944366455
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.572 Vali Acc: 0.527 Test Loss: 1.572 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2371435165405273
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.549 Vali Acc: 0.500 Test Loss: 1.549 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0065641403198242
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.601 Vali Acc: 0.527 Test Loss: 1.601 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3069846630096436
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.613 Vali Acc: 0.527 Test Loss: 1.613 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2274470329284668
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.629 Vali Acc: 0.514 Test Loss: 1.629 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0349617004394531
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.639 Vali Acc: 0.541 Test Loss: 1.639 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 60452
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8214969635009766
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.434 Vali Acc: 0.338 Test Loss: 1.434 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.851168155670166
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.337 Vali Acc: 0.351 Test Loss: 1.337 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.7937886714935303
Epoch: 3, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.301 Vali Acc: 0.446 Test Loss: 1.301 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.9153425693511963
Epoch: 4, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.292 Vali Acc: 0.432 Test Loss: 1.292 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8849835395812988
Epoch: 5, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.9427444934844971
Epoch: 6, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1240336894989014
Epoch: 7, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.080871820449829
Epoch: 8, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.0152218341827393
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1733837127685547
Epoch: 10, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0175836086273193
Epoch: 11, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9873096942901611
Epoch: 12, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.288 Vali Acc: 0.527 Test Loss: 1.288 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0378916263580322
Epoch: 13, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.297 Vali Acc: 0.514 Test Loss: 1.297 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7917201519012451
Epoch: 14, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.092099905014038
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.364 Vali Acc: 0.541 Test Loss: 1.364 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 16 cost time: 1.0748770236968994
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.407 Vali Acc: 0.554 Test Loss: 1.407 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 17 cost time: 1.119652509689331
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0669631958007812
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.470 Vali Acc: 0.581 Test Loss: 1.470 Test Acc: 0.581
Validation loss decreased (-0.554040 --> -0.581066).  Saving model ...
Epoch: 19 cost time: 1.0627326965332031
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.509 Vali Acc: 0.554 Test Loss: 1.509 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8490071296691895
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.512 Vali Acc: 0.568 Test Loss: 1.512 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0978999137878418
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.527 Vali Acc: 0.554 Test Loss: 1.527 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8771555423736572
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.555 Vali Acc: 0.568 Test Loss: 1.555 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.236520528793335
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.566 Vali Acc: 0.581 Test Loss: 1.566 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9407052993774414
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.584 Vali Acc: 0.568 Test Loss: 1.584 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0812313556671143
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.606 Vali Acc: 0.581 Test Loss: 1.606 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1594791412353516
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.616 Vali Acc: 0.568 Test Loss: 1.616 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2326455116271973
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.646 Vali Acc: 0.581 Test Loss: 1.646 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9987070560455322
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.643 Vali Acc: 0.581 Test Loss: 1.643 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 42852
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6377267837524414
Epoch: 1, Steps: 10 | Train Loss: 1.517 Vali Loss: 1.443 Vali Acc: 0.230 Test Loss: 1.443 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.7813687324523926
Epoch: 2, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.436 Vali Acc: 0.216 Test Loss: 1.436 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7449846267700195
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (-0.229715 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 0.8136556148529053
Epoch: 4, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
Validation loss decreased (-0.297284 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9870450496673584
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.7816646099090576
Epoch: 6, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.210 Vali Acc: 0.446 Test Loss: 1.210 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7693414688110352
Epoch: 7, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.7695071697235107
Epoch: 8, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 0.839247465133667
Epoch: 9, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7506864070892334
Epoch: 10, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.143 Vali Acc: 0.568 Test Loss: 1.143 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7468743324279785
Epoch: 11, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8736834526062012
Epoch: 12, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8489608764648438
Epoch: 13, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 0.8046672344207764
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7876896858215332
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.170 Vali Acc: 0.568 Test Loss: 1.170 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7075991630554199
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.190 Vali Acc: 0.581 Test Loss: 1.190 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8131294250488281
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8428514003753662
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.243 Vali Acc: 0.554 Test Loss: 1.243 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8179819583892822
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.252 Vali Acc: 0.568 Test Loss: 1.252 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8540260791778564
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.271 Vali Acc: 0.568 Test Loss: 1.271 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7659895420074463
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.293 Vali Acc: 0.581 Test Loss: 1.293 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8721516132354736
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.310 Vali Acc: 0.581 Test Loss: 1.310 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7415227890014648
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.313 Vali Acc: 0.554 Test Loss: 1.313 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 35492
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.635667085647583
Epoch: 1, Steps: 10 | Train Loss: 1.519 Vali Loss: 1.462 Vali Acc: 0.311 Test Loss: 1.462 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 0.7595021724700928
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.427 Vali Acc: 0.324 Test Loss: 1.427 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 0.7844297885894775
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.392 Vali Acc: 0.351 Test Loss: 1.392 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 0.8035547733306885
Epoch: 4, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.350 Vali Acc: 0.392 Test Loss: 1.350 Test Acc: 0.392
Validation loss decreased (-0.351337 --> -0.391878).  Saving model ...
Epoch: 5 cost time: 0.7702212333679199
Epoch: 5, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.329 Vali Acc: 0.419 Test Loss: 1.329 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.7644462585449219
Epoch: 6, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.283 Vali Acc: 0.432 Test Loss: 1.283 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 0.8578224182128906
Epoch: 7, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.281 Vali Acc: 0.419 Test Loss: 1.281 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8164258003234863
Epoch: 8, Steps: 10 | Train Loss: 0.762 Vali Loss: 1.277 Vali Acc: 0.419 Test Loss: 1.277 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0424950122833252
Epoch: 9, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.250 Vali Acc: 0.459 Test Loss: 1.250 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 0.869774341583252
Epoch: 10, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 11 cost time: 0.8960099220275879
Epoch: 11, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 12 cost time: 0.8974034786224365
Epoch: 12, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.7915406227111816
Epoch: 13, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.814680814743042
Epoch: 14, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9292068481445312
Epoch: 15, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.276 Vali Acc: 0.541 Test Loss: 1.276 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 16 cost time: 0.8447463512420654
Epoch: 16, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.310 Vali Acc: 0.541 Test Loss: 1.310 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8477957248687744
Epoch: 17, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.341 Vali Acc: 0.514 Test Loss: 1.341 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7964179515838623
Epoch: 18, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.329 Vali Acc: 0.554 Test Loss: 1.329 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 19 cost time: 0.9066905975341797
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.383 Vali Acc: 0.514 Test Loss: 1.383 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0016076564788818
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.400 Vali Acc: 0.568 Test Loss: 1.400 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567554).  Saving model ...
Epoch: 21 cost time: 0.8510515689849854
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.441 Vali Acc: 0.554 Test Loss: 1.441 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8902926445007324
Epoch: 22, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.435 Vali Acc: 0.541 Test Loss: 1.435 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.85872483253479
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.425 Vali Acc: 0.595 Test Loss: 1.425 Test Acc: 0.595
Validation loss decreased (-0.567554 --> -0.594580).  Saving model ...
Epoch: 24 cost time: 0.8696191310882568
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.447 Vali Acc: 0.595 Test Loss: 1.447 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8978264331817627
Epoch: 25, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.459 Vali Acc: 0.581 Test Loss: 1.459 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8316259384155273
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.495 Vali Acc: 0.581 Test Loss: 1.495 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8528568744659424
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.528 Vali Acc: 0.554 Test Loss: 1.528 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8519341945648193
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.546 Vali Acc: 0.554 Test Loss: 1.546 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9050066471099854
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.542 Vali Acc: 0.568 Test Loss: 1.542 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9079396724700928
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.563 Vali Acc: 0.554 Test Loss: 1.563 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7684285640716553
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.584 Vali Acc: 0.554 Test Loss: 1.584 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9195847511291504
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.601 Vali Acc: 0.568 Test Loss: 1.601 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9529333114624023
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.588 Vali Acc: 0.554 Test Loss: 1.588 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 27172
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5707051753997803
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.508 Vali Acc: 0.189 Test Loss: 1.508 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 0.8103926181793213
Epoch: 2, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.458 Vali Acc: 0.216 Test Loss: 1.458 Test Acc: 0.216
Validation loss decreased (-0.189174 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 0.8505456447601318
Epoch: 3, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.412 Vali Acc: 0.257 Test Loss: 1.412 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 0.7850286960601807
Epoch: 4, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.369 Vali Acc: 0.284 Test Loss: 1.369 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 0.9767379760742188
Epoch: 5, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 6 cost time: 0.831902027130127
Epoch: 6, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.298 Vali Acc: 0.365 Test Loss: 1.298 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 0.8936977386474609
Epoch: 7, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.271 Vali Acc: 0.392 Test Loss: 1.271 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 8 cost time: 0.88181471824646
Epoch: 8, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 0.8573882579803467
Epoch: 9, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.226 Vali Acc: 0.419 Test Loss: 1.226 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8982946872711182
Epoch: 10, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.195 Vali Acc: 0.459 Test Loss: 1.195 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 11 cost time: 0.8087863922119141
Epoch: 11, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.186 Vali Acc: 0.459 Test Loss: 1.186 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 12 cost time: 0.7620031833648682
Epoch: 12, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9015088081359863
Epoch: 13, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.191 Vali Acc: 0.446 Test Loss: 1.191 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8702375888824463
Epoch: 14, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.190 Vali Acc: 0.446 Test Loss: 1.190 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8919861316680908
Epoch: 15, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.177 Vali Acc: 0.473 Test Loss: 1.177 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 16 cost time: 0.8851149082183838
Epoch: 16, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.201 Vali Acc: 0.459 Test Loss: 1.201 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8306372165679932
Epoch: 17, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9008450508117676
Epoch: 18, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.213 Vali Acc: 0.459 Test Loss: 1.213 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8997550010681152
Epoch: 19, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9447405338287354
Epoch: 20, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.199 Vali Acc: 0.486 Test Loss: 1.199 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 21 cost time: 0.7775077819824219
Epoch: 21, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.929105281829834
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.257 Vali Acc: 0.514 Test Loss: 1.257 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 23 cost time: 0.8155601024627686
Epoch: 23, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.271 Vali Acc: 0.541 Test Loss: 1.271 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540528).  Saving model ...
Epoch: 24 cost time: 0.8000319004058838
Epoch: 24, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9789125919342041
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.327 Vali Acc: 0.514 Test Loss: 1.327 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7601687908172607
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9763374328613281
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9774477481842041
Epoch: 28, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7434163093566895
Epoch: 29, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.363 Vali Acc: 0.473 Test Loss: 1.363 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8483486175537109
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.381 Vali Acc: 0.486 Test Loss: 1.381 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.819969892501831
Epoch: 31, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.398 Vali Acc: 0.473 Test Loss: 1.398 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6907374858856201
Epoch: 32, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.387 Vali Acc: 0.486 Test Loss: 1.387 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7668204307556152
Epoch: 33, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 23972
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7341251373291016
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.312 Vali Acc: 0.257 Test Loss: 1.312 Test Acc: 0.257
Validation loss decreased (inf --> -0.256744).  Saving model ...
Epoch: 2 cost time: 0.755948543548584
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.296 Vali Acc: 0.311 Test Loss: 1.296 Test Acc: 0.311
Validation loss decreased (-0.256744 --> -0.310798).  Saving model ...
Epoch: 3 cost time: 1.0576930046081543
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.266 Vali Acc: 0.351 Test Loss: 1.266 Test Acc: 0.351
Validation loss decreased (-0.310798 --> -0.351339).  Saving model ...
Epoch: 4 cost time: 0.8164899349212646
Epoch: 4, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.234 Vali Acc: 0.378 Test Loss: 1.234 Test Acc: 0.378
Validation loss decreased (-0.351339 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 0.8031337261199951
Epoch: 5, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.8838536739349365
Epoch: 6, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.8647210597991943
Epoch: 7, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 0.8097097873687744
Epoch: 8, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.123 Vali Acc: 0.568 Test Loss: 1.123 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 0.7821741104125977
Epoch: 9, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8463554382324219
Epoch: 10, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9416496753692627
Epoch: 11, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8540060520172119
Epoch: 12, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.099 Vali Acc: 0.541 Test Loss: 1.099 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0386378765106201
Epoch: 13, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9504520893096924
Epoch: 14, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.101 Vali Acc: 0.486 Test Loss: 1.101 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.879819393157959
Epoch: 15, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0162453651428223
Epoch: 16, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9890987873077393
Epoch: 17, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8449733257293701
Epoch: 18, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm32_nh4_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 22052
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.89376163482666
Epoch: 1, Steps: 10 | Train Loss: 1.519 Vali Loss: 1.316 Vali Acc: 0.338 Test Loss: 1.316 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 0.9861819744110107
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.279 Vali Acc: 0.365 Test Loss: 1.279 Test Acc: 0.365
Validation loss decreased (-0.337825 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.8714592456817627
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
Validation loss decreased (-0.364852 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.0546414852142334
Epoch: 4, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.146 Vali Acc: 0.432 Test Loss: 1.146 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.203624963760376
Epoch: 5, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.076099157333374
Epoch: 6, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.139 Vali Acc: 0.473 Test Loss: 1.139 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8876903057098389
Epoch: 7, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.9494259357452393
Epoch: 8, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9773130416870117
Epoch: 9, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0065882205963135
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0607988834381104
Epoch: 11, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.260 Vali Acc: 0.527 Test Loss: 1.260 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1054441928863525
Epoch: 12, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.408 Vali Acc: 0.500 Test Loss: 1.408 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9842483997344971
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.293 Vali Acc: 0.486 Test Loss: 1.293 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9556121826171875
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.402 Vali Acc: 0.514 Test Loss: 1.402 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0007262229919434
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.393 Vali Acc: 0.473 Test Loss: 1.393 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0696241855621338
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1050646305084229
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.482 Vali Acc: 0.500 Test Loss: 1.482 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 61012
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.738419532775879
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.395 Vali Acc: 0.230 Test Loss: 1.395 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.9285719394683838
Epoch: 2, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
Validation loss decreased (-0.229716 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.8978376388549805
Epoch: 3, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.363 Vali Acc: 0.284 Test Loss: 1.363 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 0.8156182765960693
Epoch: 4, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.331 Vali Acc: 0.446 Test Loss: 1.331 Test Acc: 0.446
Validation loss decreased (-0.283770 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.8283963203430176
Epoch: 5, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.8366227149963379
Epoch: 6, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.245 Vali Acc: 0.432 Test Loss: 1.245 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.786135196685791
Epoch: 7, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.180 Vali Acc: 0.446 Test Loss: 1.180 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.8355526924133301
Epoch: 8, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.207 Vali Acc: 0.514 Test Loss: 1.207 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 0.8081059455871582
Epoch: 9, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9302904605865479
Epoch: 10, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.9270048141479492
Epoch: 11, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0364437103271484
Epoch: 12, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.122 Vali Acc: 0.459 Test Loss: 1.122 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9668962955474854
Epoch: 13, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8483026027679443
Epoch: 14, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9775221347808838
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 16 cost time: 0.9542849063873291
Epoch: 16, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9213809967041016
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9537715911865234
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.277 Vali Acc: 0.541 Test Loss: 1.277 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8304884433746338
Epoch: 19, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.248 Vali Acc: 0.527 Test Loss: 1.248 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8859362602233887
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9272322654724121
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.272 Vali Acc: 0.554 Test Loss: 1.272 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8035359382629395
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.293 Vali Acc: 0.554 Test Loss: 1.293 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8078176975250244
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.301 Vali Acc: 0.554 Test Loss: 1.301 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8975889682769775
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.313 Vali Acc: 0.554 Test Loss: 1.313 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.886277437210083
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 35572
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5846481323242188
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.425 Vali Acc: 0.311 Test Loss: 1.425 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8516643047332764
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.381 Vali Acc: 0.351 Test Loss: 1.381 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8773059844970703
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.358 Vali Acc: 0.365 Test Loss: 1.358 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.8617043495178223
Epoch: 4, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.346 Vali Acc: 0.392 Test Loss: 1.346 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391878).  Saving model ...
Epoch: 5 cost time: 0.8467237949371338
Epoch: 5, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.289 Vali Acc: 0.405 Test Loss: 1.289 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.778010368347168
Epoch: 6, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.257 Vali Acc: 0.419 Test Loss: 1.257 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.9279248714447021
Epoch: 7, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 0.9328751564025879
Epoch: 8, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.222 Vali Acc: 0.432 Test Loss: 1.222 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 0.9739611148834229
Epoch: 9, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 0.9673030376434326
Epoch: 10, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.9012820720672607
Epoch: 11, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9434127807617188
Epoch: 12, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 0.7774658203125
Epoch: 13, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.154 Vali Acc: 0.554 Test Loss: 1.154 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 0.935344934463501
Epoch: 14, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9315764904022217
Epoch: 15, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9240503311157227
Epoch: 16, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8144059181213379
Epoch: 17, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8374361991882324
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7606585025787354
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7389395236968994
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.300 Vali Acc: 0.514 Test Loss: 1.300 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.854210615158081
Epoch: 21, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7963221073150635
Epoch: 22, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8794472217559814
Epoch: 23, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.360 Vali Acc: 0.473 Test Loss: 1.360 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 26772
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6644997596740723
Epoch: 1, Steps: 10 | Train Loss: 1.637 Vali Loss: 1.448 Vali Acc: 0.284 Test Loss: 1.448 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 0.8304686546325684
Epoch: 2, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.427 Vali Acc: 0.230 Test Loss: 1.427 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7990152835845947
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9419968128204346
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.360 Vali Acc: 0.284 Test Loss: 1.360 Test Acc: 0.284
Validation loss decreased (-0.283769 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 0.7863669395446777
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.324 Vali Acc: 0.378 Test Loss: 1.324 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 0.8332438468933105
Epoch: 6, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.291 Vali Acc: 0.365 Test Loss: 1.291 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9513144493103027
Epoch: 7, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.259 Vali Acc: 0.405 Test Loss: 1.259 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 8 cost time: 0.7227158546447754
Epoch: 8, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 0.789036750793457
Epoch: 9, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 0.7838332653045654
Epoch: 10, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.8223917484283447
Epoch: 11, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7998769283294678
Epoch: 12, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.8734710216522217
Epoch: 13, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.8811304569244385
Epoch: 14, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.838738203048706
Epoch: 15, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 0.9252667427062988
Epoch: 16, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.164 Vali Acc: 0.527 Test Loss: 1.164 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 17 cost time: 0.9767258167266846
Epoch: 17, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8689634799957275
Epoch: 18, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8832027912139893
Epoch: 19, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7324655055999756
Epoch: 20, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.195 Vali Acc: 0.473 Test Loss: 1.195 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8700101375579834
Epoch: 21, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8512790203094482
Epoch: 22, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.235 Vali Acc: 0.446 Test Loss: 1.235 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8734378814697266
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.263 Vali Acc: 0.486 Test Loss: 1.263 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8404521942138672
Epoch: 24, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.284 Vali Acc: 0.473 Test Loss: 1.284 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8714497089385986
Epoch: 25, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.286 Vali Acc: 0.473 Test Loss: 1.286 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8277559280395508
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.295 Vali Acc: 0.486 Test Loss: 1.295 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 23092
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.824676275253296
Epoch: 1, Steps: 10 | Train Loss: 1.550 Vali Loss: 1.519 Vali Acc: 0.203 Test Loss: 1.519 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.8127400875091553
Epoch: 2, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.484 Vali Acc: 0.176 Test Loss: 1.484 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.836456298828125
Epoch: 3, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.444 Vali Acc: 0.243 Test Loss: 1.444 Test Acc: 0.243
Validation loss decreased (-0.202688 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 0.8459954261779785
Epoch: 4, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.419 Vali Acc: 0.297 Test Loss: 1.419 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 0.9006764888763428
Epoch: 5, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.399 Vali Acc: 0.284 Test Loss: 1.399 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8081603050231934
Epoch: 6, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.364 Vali Acc: 0.311 Test Loss: 1.364 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 7 cost time: 0.7377769947052002
Epoch: 7, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.336 Vali Acc: 0.338 Test Loss: 1.336 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 8 cost time: 0.8220927715301514
Epoch: 8, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.325 Vali Acc: 0.338 Test Loss: 1.325 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 9 cost time: 0.9228384494781494
Epoch: 9, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.304 Vali Acc: 0.392 Test Loss: 1.304 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 10 cost time: 0.9194667339324951
Epoch: 10, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.275 Vali Acc: 0.419 Test Loss: 1.275 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 11 cost time: 0.8581883907318115
Epoch: 11, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.261 Vali Acc: 0.432 Test Loss: 1.261 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 1.0510098934173584
Epoch: 12, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.250 Vali Acc: 0.432 Test Loss: 1.250 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 13 cost time: 0.8732657432556152
Epoch: 13, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.260 Vali Acc: 0.419 Test Loss: 1.260 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8824260234832764
Epoch: 14, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.241 Vali Acc: 0.432 Test Loss: 1.241 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 15 cost time: 0.8295013904571533
Epoch: 15, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.239 Vali Acc: 0.419 Test Loss: 1.239 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7867648601531982
Epoch: 16, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 17 cost time: 0.8029980659484863
Epoch: 17, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.236 Vali Acc: 0.486 Test Loss: 1.236 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 18 cost time: 0.8088784217834473
Epoch: 18, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.228 Vali Acc: 0.432 Test Loss: 1.228 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9591562747955322
Epoch: 19, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 20 cost time: 0.8582549095153809
Epoch: 20, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.953948974609375
Epoch: 21, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.247 Vali Acc: 0.473 Test Loss: 1.247 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7763893604278564
Epoch: 22, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.250 Vali Acc: 0.446 Test Loss: 1.250 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7579789161682129
Epoch: 23, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.273 Vali Acc: 0.473 Test Loss: 1.273 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8759620189666748
Epoch: 24, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 25 cost time: 0.7581419944763184
Epoch: 25, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.304 Vali Acc: 0.473 Test Loss: 1.304 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7588367462158203
Epoch: 26, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.320 Vali Acc: 0.486 Test Loss: 1.320 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8326559066772461
Epoch: 27, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.309 Vali Acc: 0.473 Test Loss: 1.309 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8369359970092773
Epoch: 28, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.327 Vali Acc: 0.486 Test Loss: 1.327 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9726781845092773
Epoch: 29, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8963179588317871
Epoch: 30, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7858359813690186
Epoch: 31, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.367 Vali Acc: 0.486 Test Loss: 1.367 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9294319152832031
Epoch: 32, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.374 Vali Acc: 0.486 Test Loss: 1.374 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9377701282501221
Epoch: 33, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.383 Vali Acc: 0.486 Test Loss: 1.383 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8867671489715576
Epoch: 34, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.418 Vali Acc: 0.500 Test Loss: 1.418 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 18932
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7763991355895996
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.395 Vali Acc: 0.324 Test Loss: 1.395 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.028226613998413
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.382 Vali Acc: 0.365 Test Loss: 1.382 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.0598876476287842
Epoch: 3, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.367 Vali Acc: 0.338 Test Loss: 1.367 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.00777006149292
Epoch: 4, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.338 Vali Acc: 0.324 Test Loss: 1.338 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9756283760070801
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.308 Vali Acc: 0.324 Test Loss: 1.308 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0244989395141602
Epoch: 6, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 0.9709792137145996
Epoch: 7, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.247 Vali Acc: 0.459 Test Loss: 1.247 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 0.9978046417236328
Epoch: 8, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 1.060347318649292
Epoch: 9, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 0.8711504936218262
Epoch: 10, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.8907403945922852
Epoch: 11, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 0.9628345966339111
Epoch: 12, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.163 Vali Acc: 0.486 Test Loss: 1.163 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8650667667388916
Epoch: 13, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 0.9052705764770508
Epoch: 14, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 0.9380161762237549
Epoch: 15, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 16 cost time: 0.9608757495880127
Epoch: 16, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 17 cost time: 0.8294141292572021
Epoch: 17, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.098 Vali Acc: 0.527 Test Loss: 1.098 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8005838394165039
Epoch: 18, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 19 cost time: 0.8775162696838379
Epoch: 19, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.078 Vali Acc: 0.568 Test Loss: 1.078 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 20 cost time: 0.7691266536712646
Epoch: 20, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 21 cost time: 0.8615555763244629
Epoch: 21, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9801440238952637
Epoch: 22, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9049336910247803
Epoch: 23, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.076 Vali Acc: 0.541 Test Loss: 1.076 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0108721256256104
Epoch: 24, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9589211940765381
Epoch: 25, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0470731258392334
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8708088397979736
Epoch: 27, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8754005432128906
Epoch: 28, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9005875587463379
Epoch: 29, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.150 Vali Acc: 0.554 Test Loss: 1.150 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8027100563049316
Epoch: 30, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.154 Vali Acc: 0.554 Test Loss: 1.154 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 17332
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.584120035171509
Epoch: 1, Steps: 10 | Train Loss: 1.516 Vali Loss: 1.409 Vali Acc: 0.284 Test Loss: 1.409 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8846168518066406
Epoch: 2, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8656461238861084
Epoch: 3, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.390 Vali Acc: 0.257 Test Loss: 1.390 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9302852153778076
Epoch: 4, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.361 Vali Acc: 0.297 Test Loss: 1.361 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 5 cost time: 0.9125962257385254
Epoch: 5, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.332 Vali Acc: 0.311 Test Loss: 1.332 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310797).  Saving model ...
Epoch: 6 cost time: 0.9404451847076416
Epoch: 6, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.313 Vali Acc: 0.324 Test Loss: 1.313 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 7 cost time: 0.8770639896392822
Epoch: 7, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.291 Vali Acc: 0.257 Test Loss: 1.291 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.884835958480835
Epoch: 8, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.266 Vali Acc: 0.351 Test Loss: 1.266 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351339).  Saving model ...
Epoch: 9 cost time: 0.9382755756378174
Epoch: 9, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.245 Vali Acc: 0.405 Test Loss: 1.245 Test Acc: 0.405
Validation loss decreased (-0.351339 --> -0.405393).  Saving model ...
Epoch: 10 cost time: 0.980924129486084
Epoch: 10, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 11 cost time: 0.8881831169128418
Epoch: 11, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 0.9147243499755859
Epoch: 12, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 0.8144588470458984
Epoch: 13, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 0.9305019378662109
Epoch: 14, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8006329536437988
Epoch: 15, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 0.8929681777954102
Epoch: 16, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8888764381408691
Epoch: 17, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 18 cost time: 0.9448678493499756
Epoch: 18, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.909980058670044
Epoch: 19, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9061391353607178
Epoch: 20, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7900638580322266
Epoch: 21, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 22 cost time: 0.7195427417755127
Epoch: 22, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 23 cost time: 0.8964917659759521
Epoch: 23, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6984474658966064
Epoch: 24, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7131867408752441
Epoch: 25, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8486058712005615
Epoch: 26, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7083759307861328
Epoch: 27, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8587770462036133
Epoch: 28, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.752143383026123
Epoch: 29, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.245 Vali Acc: 0.486 Test Loss: 1.245 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8937046527862549
Epoch: 30, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8909337520599365
Epoch: 31, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9483120441436768
Epoch: 32, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.264 Vali Acc: 0.541 Test Loss: 1.264 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df256_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 16372
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9244043827056885
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0304882526397705
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.314 Vali Acc: 0.459 Test Loss: 1.314 Test Acc: 0.459
Validation loss decreased (-0.256743 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.076108694076538
Epoch: 3, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.254 Vali Acc: 0.486 Test Loss: 1.254 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.1917736530303955
Epoch: 4, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.2825696468353271
Epoch: 5, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.0999135971069336
Epoch: 6, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.248 Vali Acc: 0.459 Test Loss: 1.248 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.164466381072998
Epoch: 7, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.120 Vali Acc: 0.554 Test Loss: 1.120 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.188462257385254
Epoch: 8, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0720782279968262
Epoch: 9, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1526837348937988
Epoch: 10, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9543497562408447
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.260 Vali Acc: 0.554 Test Loss: 1.260 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.966167688369751
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.288 Vali Acc: 0.514 Test Loss: 1.288 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.047863483428955
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0307087898254395
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.377 Vali Acc: 0.514 Test Loss: 1.377 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0201516151428223
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.399 Vali Acc: 0.514 Test Loss: 1.399 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.067397117614746
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.439 Vali Acc: 0.514 Test Loss: 1.439 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0353269577026367
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.437 Vali Acc: 0.514 Test Loss: 1.437 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 56788
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.684781789779663
Epoch: 1, Steps: 10 | Train Loss: 1.628 Vali Loss: 1.440 Vali Acc: 0.230 Test Loss: 1.440 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.8220162391662598
Epoch: 2, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.375 Vali Acc: 0.338 Test Loss: 1.375 Test Acc: 0.338
Validation loss decreased (-0.229715 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.8554258346557617
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.8959231376647949
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.277 Vali Acc: 0.473 Test Loss: 1.277 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 0.7877397537231445
Epoch: 5, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8601810932159424
Epoch: 6, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.189 Vali Acc: 0.486 Test Loss: 1.189 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9330389499664307
Epoch: 7, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.8604271411895752
Epoch: 8, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9158070087432861
Epoch: 9, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.9544172286987305
Epoch: 10, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.865443229675293
Epoch: 11, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 0.7132692337036133
Epoch: 12, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8456599712371826
Epoch: 13, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8439950942993164
Epoch: 14, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9754788875579834
Epoch: 15, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8353028297424316
Epoch: 16, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.834078311920166
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.198 Vali Acc: 0.568 Test Loss: 1.198 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 18 cost time: 0.7979433536529541
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9234063625335693
Epoch: 19, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.235 Vali Acc: 0.581 Test Loss: 1.235 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 20 cost time: 1.0311915874481201
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.220 Vali Acc: 0.527 Test Loss: 1.220 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.920443058013916
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.229 Vali Acc: 0.541 Test Loss: 1.229 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.930962085723877
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.255 Vali Acc: 0.581 Test Loss: 1.255 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8712913990020752
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.276 Vali Acc: 0.527 Test Loss: 1.276 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8823773860931396
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8684494495391846
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.281 Vali Acc: 0.527 Test Loss: 1.281 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7945230007171631
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.305 Vali Acc: 0.568 Test Loss: 1.305 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9412314891815186
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.807896614074707
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.348 Vali Acc: 0.527 Test Loss: 1.348 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8681676387786865
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.347 Vali Acc: 0.554 Test Loss: 1.347 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 31348
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.775395631790161
Epoch: 1, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.471 Vali Acc: 0.203 Test Loss: 1.471 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.8497049808502197
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.463 Vali Acc: 0.243 Test Loss: 1.463 Test Acc: 0.243
Validation loss decreased (-0.202688 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.8665122985839844
Epoch: 3, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.459 Vali Acc: 0.257 Test Loss: 1.459 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256742).  Saving model ...
Epoch: 4 cost time: 0.7510626316070557
Epoch: 4, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.450 Vali Acc: 0.284 Test Loss: 1.450 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283769).  Saving model ...
Epoch: 5 cost time: 0.9809000492095947
Epoch: 5, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.401 Vali Acc: 0.284 Test Loss: 1.401 Test Acc: 0.284
Validation loss decreased (-0.283769 --> -0.283770).  Saving model ...
Epoch: 6 cost time: 1.0091197490692139
Epoch: 6, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.363 Vali Acc: 0.378 Test Loss: 1.363 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 0.8316798210144043
Epoch: 7, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.369 Vali Acc: 0.365 Test Loss: 1.369 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.857306718826294
Epoch: 8, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.326 Vali Acc: 0.378 Test Loss: 1.326 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 9 cost time: 0.7526788711547852
Epoch: 9, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.303 Vali Acc: 0.405 Test Loss: 1.303 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 10 cost time: 0.9038381576538086
Epoch: 10, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.306 Vali Acc: 0.432 Test Loss: 1.306 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 11 cost time: 0.8277628421783447
Epoch: 11, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 12 cost time: 0.8356258869171143
Epoch: 12, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.325 Vali Acc: 0.432 Test Loss: 1.325 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8271622657775879
Epoch: 13, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.308 Vali Acc: 0.473 Test Loss: 1.308 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 14 cost time: 0.8120884895324707
Epoch: 14, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.297 Vali Acc: 0.473 Test Loss: 1.297 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 15 cost time: 0.8045656681060791
Epoch: 15, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.300 Vali Acc: 0.514 Test Loss: 1.300 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 16 cost time: 0.8787188529968262
Epoch: 16, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8565402030944824
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.340 Vali Acc: 0.514 Test Loss: 1.340 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8247854709625244
Epoch: 18, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527013).  Saving model ...
Epoch: 19 cost time: 0.727900505065918
Epoch: 19, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
Validation loss decreased (-0.527013 --> -0.527013).  Saving model ...
Epoch: 20 cost time: 0.7627489566802979
Epoch: 20, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.428 Vali Acc: 0.500 Test Loss: 1.428 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7522203922271729
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.427 Vali Acc: 0.527 Test Loss: 1.427 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9200022220611572
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.464 Vali Acc: 0.514 Test Loss: 1.464 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8419103622436523
Epoch: 23, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9586994647979736
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.501 Vali Acc: 0.514 Test Loss: 1.501 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8972129821777344
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.550 Vali Acc: 0.473 Test Loss: 1.550 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7579553127288818
Epoch: 26, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.577 Vali Acc: 0.473 Test Loss: 1.577 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8550171852111816
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.580 Vali Acc: 0.473 Test Loss: 1.580 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7754361629486084
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.608 Vali Acc: 0.500 Test Loss: 1.608 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9014694690704346
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.635 Vali Acc: 0.500 Test Loss: 1.635 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 22548
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.46085786819458
Epoch: 1, Steps: 10 | Train Loss: 1.549 Vali Loss: 1.365 Vali Acc: 0.297 Test Loss: 1.365 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.8000552654266357
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.330 Vali Acc: 0.324 Test Loss: 1.330 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.834599494934082
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.299 Vali Acc: 0.365 Test Loss: 1.299 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.8243319988250732
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.252 Vali Acc: 0.432 Test Loss: 1.252 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.9009826183319092
Epoch: 5, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.231 Vali Acc: 0.473 Test Loss: 1.231 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.8005640506744385
Epoch: 6, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.7720096111297607
Epoch: 7, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.7698209285736084
Epoch: 8, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 0.8220791816711426
Epoch: 9, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.878075361251831
Epoch: 10, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 0.7560629844665527
Epoch: 11, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7800111770629883
Epoch: 12, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8634428977966309
Epoch: 13, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.797433614730835
Epoch: 14, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.814711332321167
Epoch: 15, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7476704120635986
Epoch: 16, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8106074333190918
Epoch: 17, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.137 Vali Acc: 0.568 Test Loss: 1.137 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7822058200836182
Epoch: 18, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.148 Vali Acc: 0.595 Test Loss: 1.148 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 19 cost time: 0.7483761310577393
Epoch: 19, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7883219718933105
Epoch: 20, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.189 Vali Acc: 0.541 Test Loss: 1.189 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8484442234039307
Epoch: 21, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.219 Vali Acc: 0.568 Test Loss: 1.219 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8231494426727295
Epoch: 22, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.227 Vali Acc: 0.595 Test Loss: 1.227 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.864116907119751
Epoch: 23, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.211 Vali Acc: 0.554 Test Loss: 1.211 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8018527030944824
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8039069175720215
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.280 Vali Acc: 0.554 Test Loss: 1.280 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8000893592834473
Epoch: 26, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.285 Vali Acc: 0.554 Test Loss: 1.285 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8684177398681641
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.294 Vali Acc: 0.568 Test Loss: 1.294 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7979798316955566
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 18868
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.890613317489624
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.461 Vali Acc: 0.284 Test Loss: 1.461 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 0.8494629859924316
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.403 Vali Acc: 0.297 Test Loss: 1.403 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.8169598579406738
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.353 Vali Acc: 0.378 Test Loss: 1.353 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.8079237937927246
Epoch: 4, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.322 Vali Acc: 0.419 Test Loss: 1.322 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.7499678134918213
Epoch: 5, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.292 Vali Acc: 0.446 Test Loss: 1.292 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.8682546615600586
Epoch: 6, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.281 Vali Acc: 0.459 Test Loss: 1.281 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.9457821846008301
Epoch: 7, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.257 Vali Acc: 0.459 Test Loss: 1.257 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 0.7884504795074463
Epoch: 8, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 0.8561685085296631
Epoch: 9, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.766258955001831
Epoch: 10, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9135231971740723
Epoch: 11, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.153 Vali Acc: 0.486 Test Loss: 1.153 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8578808307647705
Epoch: 12, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9312891960144043
Epoch: 13, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 0.8606925010681152
Epoch: 14, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8369872570037842
Epoch: 15, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 16 cost time: 0.7696833610534668
Epoch: 16, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 17 cost time: 1.0105180740356445
Epoch: 17, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 0.8569767475128174
Epoch: 18, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7708454132080078
Epoch: 19, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.812096357345581
Epoch: 20, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.114 Vali Acc: 0.459 Test Loss: 1.114 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8370027542114258
Epoch: 21, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.873908281326294
Epoch: 22, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7776644229888916
Epoch: 23, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8079071044921875
Epoch: 24, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8745977878570557
Epoch: 25, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8166100978851318
Epoch: 26, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.173 Vali Acc: 0.473 Test Loss: 1.173 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7559316158294678
Epoch: 27, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 14708
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7014033794403076
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.472 Vali Acc: 0.243 Test Loss: 1.472 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9405057430267334
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.452 Vali Acc: 0.243 Test Loss: 1.452 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.8751742839813232
Epoch: 3, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.426 Vali Acc: 0.297 Test Loss: 1.426 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 0.8664484024047852
Epoch: 4, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.408 Vali Acc: 0.365 Test Loss: 1.408 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 0.7974252700805664
Epoch: 5, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.383 Vali Acc: 0.351 Test Loss: 1.383 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8999056816101074
Epoch: 6, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.363 Vali Acc: 0.365 Test Loss: 1.363 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364851).  Saving model ...
Epoch: 7 cost time: 0.8282256126403809
Epoch: 7, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.349 Vali Acc: 0.392 Test Loss: 1.349 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391878).  Saving model ...
Epoch: 8 cost time: 0.753868818283081
Epoch: 8, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.326 Vali Acc: 0.419 Test Loss: 1.326 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 9 cost time: 0.8882248401641846
Epoch: 9, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.311 Vali Acc: 0.419 Test Loss: 1.311 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 10 cost time: 0.7888293266296387
Epoch: 10, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.292 Vali Acc: 0.459 Test Loss: 1.292 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 11 cost time: 0.9004909992218018
Epoch: 11, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 12 cost time: 0.8228535652160645
Epoch: 12, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 13 cost time: 1.0215167999267578
Epoch: 13, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.249 Vali Acc: 0.473 Test Loss: 1.249 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.855546236038208
Epoch: 14, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 15 cost time: 0.8666918277740479
Epoch: 15, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.966184139251709
Epoch: 16, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.0727319717407227
Epoch: 17, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0459461212158203
Epoch: 18, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8479993343353271
Epoch: 19, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9118435382843018
Epoch: 20, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9839143753051758
Epoch: 21, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8115501403808594
Epoch: 22, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 23 cost time: 0.8890619277954102
Epoch: 23, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.235 Vali Acc: 0.514 Test Loss: 1.235 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 24 cost time: 0.9018270969390869
Epoch: 24, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.231 Vali Acc: 0.554 Test Loss: 1.231 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 25 cost time: 0.9082992076873779
Epoch: 25, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.250 Vali Acc: 0.527 Test Loss: 1.250 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8648738861083984
Epoch: 26, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0734272003173828
Epoch: 27, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9369854927062988
Epoch: 28, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8627305030822754
Epoch: 29, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.254 Vali Acc: 0.554 Test Loss: 1.254 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9589972496032715
Epoch: 30, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.890042781829834
Epoch: 31, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0142238140106201
Epoch: 32, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.293 Vali Acc: 0.527 Test Loss: 1.293 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0088236331939697
Epoch: 33, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.306 Vali Acc: 0.554 Test Loss: 1.306 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9348030090332031
Epoch: 34, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 13108
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.792271614074707
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.490 Vali Acc: 0.135 Test Loss: 1.490 Test Acc: 0.135
Validation loss decreased (inf --> -0.135120).  Saving model ...
Epoch: 2 cost time: 0.8689899444580078
Epoch: 2, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.465 Vali Acc: 0.216 Test Loss: 1.465 Test Acc: 0.216
Validation loss decreased (-0.135120 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 0.807112455368042
Epoch: 3, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.446 Vali Acc: 0.257 Test Loss: 1.446 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256742).  Saving model ...
Epoch: 4 cost time: 0.8511104583740234
Epoch: 4, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.431 Vali Acc: 0.284 Test Loss: 1.431 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283769).  Saving model ...
Epoch: 5 cost time: 1.0065186023712158
Epoch: 5, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.402 Vali Acc: 0.338 Test Loss: 1.402 Test Acc: 0.338
Validation loss decreased (-0.283769 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 0.8698751926422119
Epoch: 6, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.377 Vali Acc: 0.324 Test Loss: 1.377 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0800909996032715
Epoch: 7, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.351 Vali Acc: 0.324 Test Loss: 1.351 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0142149925231934
Epoch: 8, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.328 Vali Acc: 0.351 Test Loss: 1.328 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 9 cost time: 1.1720247268676758
Epoch: 9, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.304 Vali Acc: 0.378 Test Loss: 1.304 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 10 cost time: 0.943427324295044
Epoch: 10, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.284 Vali Acc: 0.392 Test Loss: 1.284 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 11 cost time: 0.9059591293334961
Epoch: 11, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.258 Vali Acc: 0.405 Test Loss: 1.258 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 12 cost time: 1.1281628608703613
Epoch: 12, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.249 Vali Acc: 0.405 Test Loss: 1.249 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 13 cost time: 1.0518746376037598
Epoch: 13, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.221 Vali Acc: 0.392 Test Loss: 1.221 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9877941608428955
Epoch: 14, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.209 Vali Acc: 0.378 Test Loss: 1.209 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.029310703277588
Epoch: 15, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.199 Vali Acc: 0.419 Test Loss: 1.199 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 16 cost time: 0.8912200927734375
Epoch: 16, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.203 Vali Acc: 0.405 Test Loss: 1.203 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9072740077972412
Epoch: 17, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.188 Vali Acc: 0.432 Test Loss: 1.188 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432421).  Saving model ...
Epoch: 18 cost time: 0.945347785949707
Epoch: 18, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.187 Vali Acc: 0.432 Test Loss: 1.187 Test Acc: 0.432
Validation loss decreased (-0.432421 --> -0.432421).  Saving model ...
Epoch: 19 cost time: 0.91499924659729
Epoch: 19, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.180 Vali Acc: 0.446 Test Loss: 1.180 Test Acc: 0.446
Validation loss decreased (-0.432421 --> -0.445934).  Saving model ...
Epoch: 20 cost time: 0.9840898513793945
Epoch: 20, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.199 Vali Acc: 0.446 Test Loss: 1.199 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8907501697540283
Epoch: 21, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 22 cost time: 0.9194304943084717
Epoch: 22, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.198 Vali Acc: 0.459 Test Loss: 1.198 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9285287857055664
Epoch: 23, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.188 Vali Acc: 0.432 Test Loss: 1.188 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9023542404174805
Epoch: 24, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.187 Vali Acc: 0.459 Test Loss: 1.187 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0381851196289062
Epoch: 25, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.195 Vali Acc: 0.473 Test Loss: 1.195 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8950338363647461
Epoch: 26, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.216 Vali Acc: 0.473 Test Loss: 1.216 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9744713306427002
Epoch: 27, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.216 Vali Acc: 0.473 Test Loss: 1.216 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.038283109664917
Epoch: 28, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9051680564880371
Epoch: 29, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 30 cost time: 0.9153974056243896
Epoch: 30, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.266 Vali Acc: 0.486 Test Loss: 1.266 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9089789390563965
Epoch: 31, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.272 Vali Acc: 0.473 Test Loss: 1.272 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9278955459594727
Epoch: 32, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.275 Vali Acc: 0.473 Test Loss: 1.275 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9597764015197754
Epoch: 33, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.279 Vali Acc: 0.514 Test Loss: 1.279 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9175026416778564
Epoch: 34, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.303 Vali Acc: 0.486 Test Loss: 1.303 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0326611995697021
Epoch: 35, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.317 Vali Acc: 0.514 Test Loss: 1.317 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9889380931854248
Epoch: 36, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.340 Vali Acc: 0.514 Test Loss: 1.340 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0435075759887695
Epoch: 37, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.369 Vali Acc: 0.486 Test Loss: 1.369 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9132380485534668
Epoch: 38, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.381 Vali Acc: 0.514 Test Loss: 1.381 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8723089694976807
Epoch: 39, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.368 Vali Acc: 0.514 Test Loss: 1.368 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df128_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 12148
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0834062099456787
Epoch: 1, Steps: 10 | Train Loss: 1.554 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.023371934890747
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.387 Vali Acc: 0.311 Test Loss: 1.387 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.1557722091674805
Epoch: 3, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.272 Vali Acc: 0.419 Test Loss: 1.272 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.253652572631836
Epoch: 4, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.301 Vali Acc: 0.392 Test Loss: 1.301 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0330581665039062
Epoch: 5, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.209 Vali Acc: 0.419 Test Loss: 1.209 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 6 cost time: 1.0557126998901367
Epoch: 6, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
Validation loss decreased (-0.418907 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.0929527282714844
Epoch: 7, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.181919813156128
Epoch: 8, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0076401233673096
Epoch: 9, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.262 Vali Acc: 0.473 Test Loss: 1.262 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.11433744430542
Epoch: 10, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0687458515167236
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.356 Vali Acc: 0.514 Test Loss: 1.356 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513500).  Saving model ...
Epoch: 12 cost time: 1.2090988159179688
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0815505981445312
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.385 Vali Acc: 0.486 Test Loss: 1.385 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1149523258209229
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.413 Vali Acc: 0.500 Test Loss: 1.413 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1071662902832031
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1674611568450928
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.470 Vali Acc: 0.486 Test Loss: 1.470 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.345717430114746
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.486 Vali Acc: 0.514 Test Loss: 1.486 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.139735460281372
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1136987209320068
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.536 Vali Acc: 0.486 Test Loss: 1.536 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2263379096984863
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.556 Vali Acc: 0.486 Test Loss: 1.556 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1715304851531982
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.567 Vali Acc: 0.486 Test Loss: 1.567 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 54676
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.941849708557129
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.402 Vali Acc: 0.297 Test Loss: 1.402 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.7884476184844971
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.404 Vali Acc: 0.324 Test Loss: 1.404 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 0.8292648792266846
Epoch: 3, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.330 Vali Acc: 0.378 Test Loss: 1.330 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.8581881523132324
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.261 Vali Acc: 0.446 Test Loss: 1.261 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.8811166286468506
Epoch: 5, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.281 Vali Acc: 0.432 Test Loss: 1.281 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.774040699005127
Epoch: 6, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.240 Vali Acc: 0.486 Test Loss: 1.240 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.8899645805358887
Epoch: 7, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.8729984760284424
Epoch: 8, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.198 Vali Acc: 0.446 Test Loss: 1.198 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9453988075256348
Epoch: 9, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.8425848484039307
Epoch: 10, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7790555953979492
Epoch: 11, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.200 Vali Acc: 0.459 Test Loss: 1.200 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8076786994934082
Epoch: 12, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 13 cost time: 0.8577365875244141
Epoch: 13, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9354135990142822
Epoch: 14, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9062983989715576
Epoch: 15, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.232 Vali Acc: 0.527 Test Loss: 1.232 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8569440841674805
Epoch: 16, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.866004228591919
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.279 Vali Acc: 0.527 Test Loss: 1.279 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9085946083068848
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.314 Vali Acc: 0.473 Test Loss: 1.314 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9051260948181152
Epoch: 19, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.321 Vali Acc: 0.514 Test Loss: 1.321 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8409953117370605
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.373 Vali Acc: 0.473 Test Loss: 1.373 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.023890495300293
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.379 Vali Acc: 0.514 Test Loss: 1.379 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0045928955078125
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.389 Vali Acc: 0.541 Test Loss: 1.389 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 23 cost time: 0.7053990364074707
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.424 Vali Acc: 0.486 Test Loss: 1.424 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.800142765045166
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.451 Vali Acc: 0.527 Test Loss: 1.451 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9232211112976074
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.452 Vali Acc: 0.514 Test Loss: 1.452 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0301530361175537
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.459 Vali Acc: 0.514 Test Loss: 1.459 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8337788581848145
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.459 Vali Acc: 0.500 Test Loss: 1.459 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9044272899627686
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.469 Vali Acc: 0.514 Test Loss: 1.469 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9118630886077881
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.473 Vali Acc: 0.514 Test Loss: 1.473 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8488821983337402
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.492 Vali Acc: 0.514 Test Loss: 1.492 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8398599624633789
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.515 Vali Acc: 0.541 Test Loss: 1.515 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8430542945861816
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.524 Vali Acc: 0.527 Test Loss: 1.524 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 29236
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.65014910697937
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.459 Vali Acc: 0.230 Test Loss: 1.459 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.8281705379486084
Epoch: 2, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.8226685523986816
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.427 Vali Acc: 0.311 Test Loss: 1.427 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.9864373207092285
Epoch: 4, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.389 Vali Acc: 0.324 Test Loss: 1.389 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 0.9548768997192383
Epoch: 5, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.358 Vali Acc: 0.378 Test Loss: 1.358 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 0.8494753837585449
Epoch: 6, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.344 Vali Acc: 0.378 Test Loss: 1.344 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 0.892101526260376
Epoch: 7, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.286 Vali Acc: 0.446 Test Loss: 1.286 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 0.940018892288208
Epoch: 8, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.284 Vali Acc: 0.432 Test Loss: 1.284 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7681961059570312
Epoch: 9, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 0.7814958095550537
Epoch: 10, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.272 Vali Acc: 0.473 Test Loss: 1.272 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 11 cost time: 0.7856028079986572
Epoch: 11, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.236 Vali Acc: 0.486 Test Loss: 1.236 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 12 cost time: 0.8166515827178955
Epoch: 12, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.264 Vali Acc: 0.459 Test Loss: 1.264 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8721392154693604
Epoch: 13, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.8739988803863525
Epoch: 14, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8406350612640381
Epoch: 15, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.276 Vali Acc: 0.473 Test Loss: 1.276 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9206712245941162
Epoch: 16, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.291 Vali Acc: 0.486 Test Loss: 1.291 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8492605686187744
Epoch: 17, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.341 Vali Acc: 0.486 Test Loss: 1.341 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9196782112121582
Epoch: 18, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8795828819274902
Epoch: 19, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.364 Vali Acc: 0.486 Test Loss: 1.364 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8982429504394531
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.351 Vali Acc: 0.459 Test Loss: 1.351 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8347206115722656
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.379 Vali Acc: 0.459 Test Loss: 1.379 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1120281219482422
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.415 Vali Acc: 0.486 Test Loss: 1.415 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8548791408538818
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.432 Vali Acc: 0.473 Test Loss: 1.432 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 20436
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5176949501037598
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.344 Vali Acc: 0.338 Test Loss: 1.344 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.7975029945373535
Epoch: 2, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.7834010124206543
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.325 Vali Acc: 0.365 Test Loss: 1.325 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.8119759559631348
Epoch: 4, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.281 Vali Acc: 0.419 Test Loss: 1.281 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.8670070171356201
Epoch: 5, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.91619873046875
Epoch: 6, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.233 Vali Acc: 0.459 Test Loss: 1.233 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.931262731552124
Epoch: 7, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.196 Vali Acc: 0.446 Test Loss: 1.196 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0870726108551025
Epoch: 8, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.9712531566619873
Epoch: 9, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9669375419616699
Epoch: 10, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.177 Vali Acc: 0.459 Test Loss: 1.177 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0139374732971191
Epoch: 11, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.154 Vali Acc: 0.446 Test Loss: 1.154 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8859989643096924
Epoch: 12, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.143 Vali Acc: 0.459 Test Loss: 1.143 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8561928272247314
Epoch: 13, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.141 Vali Acc: 0.473 Test Loss: 1.141 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 14 cost time: 0.8459627628326416
Epoch: 14, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.143 Vali Acc: 0.473 Test Loss: 1.143 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9416916370391846
Epoch: 15, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486475).  Saving model ...
Epoch: 16 cost time: 0.8784716129302979
Epoch: 16, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.124 Vali Acc: 0.473 Test Loss: 1.124 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9144060611724854
Epoch: 17, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.147 Vali Acc: 0.473 Test Loss: 1.147 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8605263233184814
Epoch: 18, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 0.8597850799560547
Epoch: 19, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7332243919372559
Epoch: 20, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.135 Vali Acc: 0.473 Test Loss: 1.135 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9865422248840332
Epoch: 21, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.164 Vali Acc: 0.473 Test Loss: 1.164 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9092118740081787
Epoch: 22, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9016335010528564
Epoch: 23, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 24 cost time: 0.8892836570739746
Epoch: 24, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8710663318634033
Epoch: 25, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9300384521484375
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.250 Vali Acc: 0.486 Test Loss: 1.250 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9086213111877441
Epoch: 27, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9274590015411377
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.280 Vali Acc: 0.514 Test Loss: 1.280 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9578847885131836
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.288 Vali Acc: 0.527 Test Loss: 1.288 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9609246253967285
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.301 Vali Acc: 0.514 Test Loss: 1.301 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9575357437133789
Epoch: 31, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.858344316482544
Epoch: 32, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8642654418945312
Epoch: 33, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.313 Vali Acc: 0.527 Test Loss: 1.313 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 16756
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.673863649368286
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.634 Vali Acc: 0.162 Test Loss: 1.634 Test Acc: 0.162
Validation loss decreased (inf --> -0.162146).  Saving model ...
Epoch: 2 cost time: 0.9281454086303711
Epoch: 2, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.564 Vali Acc: 0.189 Test Loss: 1.564 Test Acc: 0.189
Validation loss decreased (-0.162146 --> -0.189174).  Saving model ...
Epoch: 3 cost time: 0.9394218921661377
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.522 Vali Acc: 0.189 Test Loss: 1.522 Test Acc: 0.189
Validation loss decreased (-0.189174 --> -0.189174).  Saving model ...
Epoch: 4 cost time: 0.8516743183135986
Epoch: 4, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.469 Vali Acc: 0.176 Test Loss: 1.469 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8801989555358887
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.445 Vali Acc: 0.243 Test Loss: 1.445 Test Acc: 0.243
Validation loss decreased (-0.189174 --> -0.243229).  Saving model ...
Epoch: 6 cost time: 0.8651206493377686
Epoch: 6, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.416 Vali Acc: 0.257 Test Loss: 1.416 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256743).  Saving model ...
Epoch: 7 cost time: 0.8425462245941162
Epoch: 7, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.373 Vali Acc: 0.311 Test Loss: 1.373 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 8 cost time: 0.8553812503814697
Epoch: 8, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.351 Vali Acc: 0.365 Test Loss: 1.351 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 9 cost time: 0.8114762306213379
Epoch: 9, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.329 Vali Acc: 0.351 Test Loss: 1.329 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8427176475524902
Epoch: 10, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.304 Vali Acc: 0.419 Test Loss: 1.304 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 11 cost time: 0.9981997013092041
Epoch: 11, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.940880298614502
Epoch: 12, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.1096112728118896
Epoch: 13, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.070255994796753
Epoch: 14, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.893181562423706
Epoch: 15, Steps: 10 | Train Loss: 0.583 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9749021530151367
Epoch: 16, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8301486968994141
Epoch: 17, Steps: 10 | Train Loss: 0.509 Vali Loss: 1.204 Vali Acc: 0.459 Test Loss: 1.204 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8661606311798096
Epoch: 18, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 19 cost time: 0.9754238128662109
Epoch: 19, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9053804874420166
Epoch: 20, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 21 cost time: 0.9278779029846191
Epoch: 21, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9850418567657471
Epoch: 22, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8035194873809814
Epoch: 23, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9257855415344238
Epoch: 24, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9609038829803467
Epoch: 25, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.231 Vali Acc: 0.527 Test Loss: 1.231 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9785535335540771
Epoch: 26, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.225 Vali Acc: 0.568 Test Loss: 1.225 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567555).  Saving model ...
Epoch: 27 cost time: 0.8963766098022461
Epoch: 27, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9179069995880127
Epoch: 28, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9256064891815186
Epoch: 29, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9061028957366943
Epoch: 30, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.300 Vali Acc: 0.527 Test Loss: 1.300 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9575409889221191
Epoch: 31, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.285 Vali Acc: 0.527 Test Loss: 1.285 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9068281650543213
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9533140659332275
Epoch: 33, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.313 Vali Acc: 0.527 Test Loss: 1.313 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9561200141906738
Epoch: 34, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.327 Vali Acc: 0.541 Test Loss: 1.327 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0233254432678223
Epoch: 35, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9770758152008057
Epoch: 36, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.342 Vali Acc: 0.527 Test Loss: 1.342 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 12596
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7228074073791504
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.418 Vali Acc: 0.311 Test Loss: 1.418 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8014638423919678
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.375 Vali Acc: 0.338 Test Loss: 1.375 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.8076658248901367
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.330 Vali Acc: 0.378 Test Loss: 1.330 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.8609700202941895
Epoch: 4, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.287 Vali Acc: 0.432 Test Loss: 1.287 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.8592245578765869
Epoch: 5, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.262 Vali Acc: 0.459 Test Loss: 1.262 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8059477806091309
Epoch: 6, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.242 Vali Acc: 0.459 Test Loss: 1.242 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.786421537399292
Epoch: 7, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.9475946426391602
Epoch: 8, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.189 Vali Acc: 0.486 Test Loss: 1.189 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.861189603805542
Epoch: 9, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.920607328414917
Epoch: 10, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.8870251178741455
Epoch: 11, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.145 Vali Acc: 0.514 Test Loss: 1.145 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.0127487182617188
Epoch: 12, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.0390160083770752
Epoch: 13, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 0.8939039707183838
Epoch: 14, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 15 cost time: 0.9083807468414307
Epoch: 15, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.105 Vali Acc: 0.527 Test Loss: 1.105 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9719994068145752
Epoch: 16, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9429326057434082
Epoch: 17, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9215428829193115
Epoch: 18, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.087 Vali Acc: 0.514 Test Loss: 1.087 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.871739387512207
Epoch: 19, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7541170120239258
Epoch: 20, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.094 Vali Acc: 0.527 Test Loss: 1.094 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7773590087890625
Epoch: 21, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7952136993408203
Epoch: 22, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.085 Vali Acc: 0.527 Test Loss: 1.085 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8323020935058594
Epoch: 23, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.074 Vali Acc: 0.541 Test Loss: 1.074 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 24 cost time: 0.8888404369354248
Epoch: 24, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.093 Vali Acc: 0.486 Test Loss: 1.093 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8788549900054932
Epoch: 25, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8421602249145508
Epoch: 26, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8827183246612549
Epoch: 27, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.109 Vali Acc: 0.527 Test Loss: 1.109 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9257056713104248
Epoch: 28, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9971132278442383
Epoch: 29, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.866004228591919
Epoch: 30, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7505855560302734
Epoch: 31, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9443767070770264
Epoch: 32, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8293766975402832
Epoch: 33, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 10996
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.590991258621216
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.364 Vali Acc: 0.324 Test Loss: 1.364 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.7446849346160889
Epoch: 2, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.350 Vali Acc: 0.311 Test Loss: 1.350 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7804076671600342
Epoch: 3, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.342 Vali Acc: 0.365 Test Loss: 1.342 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.7200939655303955
Epoch: 4, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.326 Vali Acc: 0.392 Test Loss: 1.326 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.7629067897796631
Epoch: 5, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.7241430282592773
Epoch: 6, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 0.6911177635192871
Epoch: 7, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.268 Vali Acc: 0.432 Test Loss: 1.268 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 0.7918136119842529
Epoch: 8, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 0.9026975631713867
Epoch: 9, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.231 Vali Acc: 0.459 Test Loss: 1.231 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 0.7954180240631104
Epoch: 10, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.212 Vali Acc: 0.446 Test Loss: 1.212 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9484012126922607
Epoch: 11, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.7467517852783203
Epoch: 12, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8074915409088135
Epoch: 13, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.9002029895782471
Epoch: 14, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.135 Vali Acc: 0.554 Test Loss: 1.135 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 0.8252696990966797
Epoch: 15, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.113 Vali Acc: 0.581 Test Loss: 1.113 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 0.9014906883239746
Epoch: 16, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.108 Vali Acc: 0.568 Test Loss: 1.108 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7791867256164551
Epoch: 17, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 18 cost time: 0.8129658699035645
Epoch: 18, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.101 Vali Acc: 0.622 Test Loss: 1.101 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 19 cost time: 0.8112237453460693
Epoch: 19, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.097 Vali Acc: 0.622 Test Loss: 1.097 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 20 cost time: 0.7957065105438232
Epoch: 20, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8249788284301758
Epoch: 21, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.089 Vali Acc: 0.608 Test Loss: 1.089 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.905585527420044
Epoch: 22, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.094 Vali Acc: 0.581 Test Loss: 1.094 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8447346687316895
Epoch: 23, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7988741397857666
Epoch: 24, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8480119705200195
Epoch: 25, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7992641925811768
Epoch: 26, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.093 Vali Acc: 0.527 Test Loss: 1.093 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.802147388458252
Epoch: 27, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8559272289276123
Epoch: 28, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8947849273681641
Epoch: 29, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_PatchTST_UEA_ftM_sl400_ll0_pl0_el1_dm16_nh4_df64_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 10036
model size : 0.35MB
