Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.2774317
	speed: 0.9335s/iter; left time: 34354.7105s
	iters: 200, epoch: 1 | loss: 1.9194781
	speed: 0.7160s/iter; left time: 26276.3527s
	iters: 300, epoch: 1 | loss: 3.0633225
	speed: 1.0234s/iter; left time: 37457.0733s
Epoch: 1 cost time: 334.78124928474426
Epoch: 1, Steps: 369 | Train Loss: 2.912 Vali Loss: 2.006 Vali Acc: 0.645 Test Loss: 2.006 Test Acc: 0.645
Validation loss decreased (inf --> -0.645269).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.6507440
	speed: 2.7179s/iter; left time: 99017.2911s
	iters: 200, epoch: 2 | loss: 4.3008089
	speed: 1.1271s/iter; left time: 40950.5948s
	iters: 300, epoch: 2 | loss: 4.7788949
	speed: 1.0406s/iter; left time: 37702.2695s
Epoch: 2 cost time: 359.6036756038666
Epoch: 2, Steps: 369 | Train Loss: 5.035 Vali Loss: 5.359 Vali Acc: 0.644 Test Loss: 5.359 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.7167048
	speed: 2.5200s/iter; left time: 90877.6104s
	iters: 200, epoch: 3 | loss: 12.1310253
	speed: 0.7922s/iter; left time: 28491.4953s
	iters: 300, epoch: 3 | loss: 4.4529247
	speed: 0.7661s/iter; left time: 27474.7030s
Epoch: 3 cost time: 306.38361859321594
Epoch: 3, Steps: 369 | Train Loss: 7.338 Vali Loss: 8.688 Vali Acc: 0.638 Test Loss: 8.688 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 6.7560077
	speed: 2.4159s/iter; left time: 86233.2758s
	iters: 200, epoch: 4 | loss: 15.5304546
	speed: 0.8966s/iter; left time: 31912.7629s
	iters: 300, epoch: 4 | loss: 9.3745813
	speed: 0.8959s/iter; left time: 31799.1840s
Epoch: 4 cost time: 304.2129361629486
Epoch: 4, Steps: 369 | Train Loss: 9.035 Vali Loss: 9.701 Vali Acc: 0.648 Test Loss: 9.701 Test Acc: 0.648
Validation loss decreased (-0.645269 --> -0.647463).  Saving model ...
	iters: 100, epoch: 5 | loss: 7.6024632
	speed: 2.4218s/iter; left time: 85551.0403s
	iters: 200, epoch: 5 | loss: 10.0496035
	speed: 0.7889s/iter; left time: 27787.7239s
	iters: 300, epoch: 5 | loss: 6.7246761
	speed: 0.7906s/iter; left time: 27768.6011s
Epoch: 5 cost time: 308.5154023170471
Epoch: 5, Steps: 369 | Train Loss: 10.046 Vali Loss: 14.241 Vali Acc: 0.642 Test Loss: 14.241 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 6.7273779
	speed: 2.4166s/iter; left time: 84475.5200s
	iters: 200, epoch: 6 | loss: 14.3966074
	speed: 0.8757s/iter; left time: 30522.6576s
	iters: 300, epoch: 6 | loss: 13.1766367
	speed: 0.8684s/iter; left time: 30181.1838s
Epoch: 6 cost time: 303.3750956058502
Epoch: 6, Steps: 369 | Train Loss: 9.334 Vali Loss: 11.547 Vali Acc: 0.639 Test Loss: 11.547 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 18.1993675
	speed: 2.4522s/iter; left time: 84812.7234s
	iters: 200, epoch: 7 | loss: 16.6170044
	speed: 0.7741s/iter; left time: 26696.0094s
	iters: 300, epoch: 7 | loss: 3.3988388
	speed: 0.6914s/iter; left time: 23773.6600s
Epoch: 7 cost time: 283.72662019729614
Epoch: 7, Steps: 369 | Train Loss: 9.958 Vali Loss: 14.706 Vali Acc: 0.637 Test Loss: 14.706 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 5.1599960
	speed: 2.1025s/iter; left time: 71942.8317s
	iters: 200, epoch: 8 | loss: 4.3177199
	speed: 0.6925s/iter; left time: 23625.4822s
	iters: 300, epoch: 8 | loss: 7.4887099
	speed: 0.7173s/iter; left time: 24401.5685s
Epoch: 8 cost time: 261.3438994884491
Epoch: 8, Steps: 369 | Train Loss: 8.781 Vali Loss: 13.566 Vali Acc: 0.648 Test Loss: 13.566 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 7.7199717
	speed: 2.0801s/iter; left time: 70410.2725s
	iters: 200, epoch: 9 | loss: 5.6303854
	speed: 0.7189s/iter; left time: 24261.5569s
	iters: 300, epoch: 9 | loss: 9.0036449
	speed: 0.7320s/iter; left time: 24632.1073s
Epoch: 9 cost time: 262.021409034729
Epoch: 9, Steps: 369 | Train Loss: 8.216 Vali Loss: 15.614 Vali Acc: 0.641 Test Loss: 15.614 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 5.7344093
	speed: 2.0691s/iter; left time: 69272.6731s
	iters: 200, epoch: 10 | loss: 9.2783175
	speed: 0.7161s/iter; left time: 23904.3098s
	iters: 300, epoch: 10 | loss: 0.9414332
	speed: 0.7047s/iter; left time: 23453.1283s
Epoch: 10 cost time: 263.5159089565277
Epoch: 10, Steps: 369 | Train Loss: 7.159 Vali Loss: 15.270 Vali Acc: 0.644 Test Loss: 15.270 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 5.6957917
	speed: 2.1102s/iter; left time: 69870.0454s
	iters: 200, epoch: 11 | loss: 4.1111398
	speed: 0.6943s/iter; left time: 22919.9412s
	iters: 300, epoch: 11 | loss: 7.8284068
	speed: 0.7045s/iter; left time: 23184.7178s
Epoch: 11 cost time: 261.34356570243835
Epoch: 11, Steps: 369 | Train Loss: 7.132 Vali Loss: 9.616 Vali Acc: 0.644 Test Loss: 9.616 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.9520377
	speed: 2.0838s/iter; left time: 68228.0601s
	iters: 200, epoch: 12 | loss: 9.1055174
	speed: 0.7160s/iter; left time: 23371.3215s
	iters: 300, epoch: 12 | loss: 8.5123444
	speed: 0.7021s/iter; left time: 22848.4468s
Epoch: 12 cost time: 259.2328085899353
Epoch: 12, Steps: 369 | Train Loss: 6.318 Vali Loss: 12.345 Vali Acc: 0.629 Test Loss: 12.345 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6062404
	speed: 2.0669s/iter; left time: 66913.0875s
	iters: 200, epoch: 13 | loss: 5.7840300
	speed: 0.7021s/iter; left time: 22658.1149s
	iters: 300, epoch: 13 | loss: 3.4299269
	speed: 0.6914s/iter; left time: 22243.8711s
Epoch: 13 cost time: 259.4828531742096
Epoch: 13, Steps: 369 | Train Loss: 5.941 Vali Loss: 4.547 Vali Acc: 0.500 Test Loss: 4.547 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 4.3794785
	speed: 2.0886s/iter; left time: 66842.9319s
	iters: 200, epoch: 14 | loss: 10.5439510
	speed: 0.6868s/iter; left time: 21912.1043s
	iters: 300, epoch: 14 | loss: 2.1217930
	speed: 0.7169s/iter; left time: 22801.7960s
Epoch: 14 cost time: 257.56782269477844
Epoch: 14, Steps: 369 | Train Loss: 4.548 Vali Loss: 7.499 Vali Acc: 0.632 Test Loss: 7.499 Test Acc: 0.632
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6475595913734393
model parameter : 2683522
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.0897074
	speed: 0.3145s/iter; left time: 11575.4168s
	iters: 200, epoch: 1 | loss: 1.6461951
	speed: 0.2940s/iter; left time: 10789.9489s
	iters: 300, epoch: 1 | loss: 3.0401006
	speed: 0.3078s/iter; left time: 11264.1126s
Epoch: 1 cost time: 112.75704717636108
Epoch: 1, Steps: 369 | Train Loss: 2.141 Vali Loss: 1.568 Vali Acc: 0.622 Test Loss: 1.568 Test Acc: 0.622
Validation loss decreased (inf --> -0.622005).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3492126
	speed: 0.9635s/iter; left time: 35100.5243s
	iters: 200, epoch: 2 | loss: 5.8050604
	speed: 0.3105s/iter; left time: 11282.2325s
	iters: 300, epoch: 2 | loss: 5.8583417
	speed: 0.3092s/iter; left time: 11204.1611s
Epoch: 2 cost time: 113.26609969139099
Epoch: 2, Steps: 369 | Train Loss: 3.768 Vali Loss: 2.906 Vali Acc: 0.648 Test Loss: 2.906 Test Acc: 0.648
Validation loss decreased (-0.622005 --> -0.647814).  Saving model ...
	iters: 100, epoch: 3 | loss: 7.7036376
	speed: 0.9968s/iter; left time: 35949.0798s
	iters: 200, epoch: 3 | loss: 3.0119123
	speed: 0.2995s/iter; left time: 10770.5404s
	iters: 300, epoch: 3 | loss: 4.1729565
	speed: 0.2972s/iter; left time: 10659.2622s
Epoch: 3 cost time: 111.08086109161377
Epoch: 3, Steps: 369 | Train Loss: 5.305 Vali Loss: 5.355 Vali Acc: 0.649 Test Loss: 5.355 Test Acc: 0.649
Validation loss decreased (-0.647814 --> -0.648641).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.3926473
	speed: 0.9970s/iter; left time: 35587.9325s
	iters: 200, epoch: 4 | loss: 3.7838635
	speed: 0.3116s/iter; left time: 11090.8084s
	iters: 300, epoch: 4 | loss: 13.9834223
	speed: 0.3078s/iter; left time: 10925.6311s
Epoch: 4 cost time: 114.94505953788757
Epoch: 4, Steps: 369 | Train Loss: 6.551 Vali Loss: 5.897 Vali Acc: 0.604 Test Loss: 5.897 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 15.6552687
	speed: 0.9550s/iter; left time: 33736.6168s
	iters: 200, epoch: 5 | loss: 6.7767844
	speed: 0.2896s/iter; left time: 10202.7627s
	iters: 300, epoch: 5 | loss: 13.6295166
	speed: 0.3107s/iter; left time: 10913.8317s
Epoch: 5 cost time: 109.46496558189392
Epoch: 5, Steps: 369 | Train Loss: 7.248 Vali Loss: 5.955 Vali Acc: 0.636 Test Loss: 5.955 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.6042399
	speed: 1.0200s/iter; left time: 35653.7015s
	iters: 200, epoch: 6 | loss: 4.0863600
	speed: 0.3096s/iter; left time: 10790.3342s
	iters: 300, epoch: 6 | loss: 11.3393574
	speed: 0.2956s/iter; left time: 10273.1639s
Epoch: 6 cost time: 112.05558061599731
Epoch: 6, Steps: 369 | Train Loss: 7.583 Vali Loss: 5.064 Vali Acc: 0.655 Test Loss: 5.064 Test Acc: 0.655
Validation loss decreased (-0.648641 --> -0.654603).  Saving model ...
	iters: 100, epoch: 7 | loss: 14.2705708
	speed: 0.9652s/iter; left time: 33383.1384s
	iters: 200, epoch: 7 | loss: 12.5430956
	speed: 0.3143s/iter; left time: 10837.7438s
	iters: 300, epoch: 7 | loss: 12.4838238
	speed: 0.3101s/iter; left time: 10662.5224s
Epoch: 7 cost time: 116.01073932647705
Epoch: 7, Steps: 369 | Train Loss: 7.661 Vali Loss: 11.146 Vali Acc: 0.627 Test Loss: 11.146 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 9.5446339
	speed: 0.9921s/iter; left time: 33947.4138s
	iters: 200, epoch: 8 | loss: 17.8540516
	speed: 0.2899s/iter; left time: 9892.0842s
	iters: 300, epoch: 8 | loss: 17.2888622
	speed: 0.2956s/iter; left time: 10056.9701s
Epoch: 8 cost time: 109.18469285964966
Epoch: 8, Steps: 369 | Train Loss: 9.156 Vali Loss: 12.718 Vali Acc: 0.589 Test Loss: 12.718 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 19.3366528
	speed: 1.0018s/iter; left time: 33910.3671s
	iters: 200, epoch: 9 | loss: 4.4249783
	speed: 0.3101s/iter; left time: 10464.4801s
	iters: 300, epoch: 9 | loss: 6.9867125
	speed: 0.3145s/iter; left time: 10582.9085s
Epoch: 9 cost time: 114.68847179412842
Epoch: 9, Steps: 369 | Train Loss: 9.371 Vali Loss: 6.474 Vali Acc: 0.634 Test Loss: 6.474 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 10.6367598
	speed: 0.9513s/iter; left time: 31850.7090s
	iters: 200, epoch: 10 | loss: 7.8663387
	speed: 0.3051s/iter; left time: 10184.3452s
	iters: 300, epoch: 10 | loss: 8.2895889
	speed: 0.3071s/iter; left time: 10219.5949s
Epoch: 10 cost time: 112.16418385505676
Epoch: 10, Steps: 369 | Train Loss: 6.814 Vali Loss: 9.773 Vali Acc: 0.648 Test Loss: 9.773 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8749335
	speed: 1.0085s/iter; left time: 33392.3825s
	iters: 200, epoch: 11 | loss: 4.9935770
	speed: 0.2822s/iter; left time: 9316.0267s
	iters: 300, epoch: 11 | loss: 8.0750008
	speed: 0.2835s/iter; left time: 9331.7456s
Epoch: 11 cost time: 108.34460020065308
Epoch: 11, Steps: 369 | Train Loss: 6.593 Vali Loss: 6.573 Vali Acc: 0.649 Test Loss: 6.573 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 6.0207233
	speed: 0.8826s/iter; left time: 28897.9335s
	iters: 200, epoch: 12 | loss: 2.9094090
	speed: 0.3089s/iter; left time: 10083.9858s
	iters: 300, epoch: 12 | loss: 0.6538796
	speed: 0.3064s/iter; left time: 9971.9870s
Epoch: 12 cost time: 108.5583918094635
Epoch: 12, Steps: 369 | Train Loss: 5.461 Vali Loss: 4.942 Vali Acc: 0.639 Test Loss: 4.942 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 5.9802265
	speed: 1.0047s/iter; left time: 32523.8416s
	iters: 200, epoch: 13 | loss: 1.4158802
	speed: 0.2949s/iter; left time: 9518.8388s
	iters: 300, epoch: 13 | loss: 2.4935193
	speed: 0.3019s/iter; left time: 9713.7755s
Epoch: 13 cost time: 111.89740586280823
Epoch: 13, Steps: 369 | Train Loss: 3.676 Vali Loss: 3.619 Vali Acc: 0.645 Test Loss: 3.619 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.6151388
	speed: 0.9842s/iter; left time: 31499.8835s
	iters: 200, epoch: 14 | loss: 2.0911903
	speed: 0.3005s/iter; left time: 9586.1864s
	iters: 300, epoch: 14 | loss: 3.5995574
	speed: 0.3033s/iter; left time: 9646.3611s
Epoch: 14 cost time: 112.04958987236023
Epoch: 14, Steps: 369 | Train Loss: 1.925 Vali Loss: 1.298 Vali Acc: 0.638 Test Loss: 1.298 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5907138
	speed: 0.9672s/iter; left time: 30597.6154s
	iters: 200, epoch: 15 | loss: 0.9267507
	speed: 0.2821s/iter; left time: 8896.3947s
	iters: 300, epoch: 15 | loss: 0.4796358
	speed: 0.3104s/iter; left time: 9757.7175s
Epoch: 15 cost time: 109.7722053527832
Epoch: 15, Steps: 369 | Train Loss: 0.604 Vali Loss: 0.838 Vali Acc: 0.650 Test Loss: 0.838 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.7099158
	speed: 1.0112s/iter; left time: 31616.5187s
	iters: 200, epoch: 16 | loss: 0.2590836
	speed: 0.3043s/iter; left time: 9483.0036s
	iters: 300, epoch: 16 | loss: 0.3889042
	speed: 0.2912s/iter; left time: 9047.2409s
Epoch: 16 cost time: 110.66608381271362
Epoch: 16, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.849 Vali Acc: 0.652 Test Loss: 0.849 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6546538024971623
model parameter : 1540994
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.6129210
	speed: 0.2546s/iter; left time: 9368.3710s
	iters: 200, epoch: 1 | loss: 1.5641004
	speed: 0.2294s/iter; left time: 8417.8194s
	iters: 300, epoch: 1 | loss: 1.8130267
	speed: 0.2169s/iter; left time: 7938.1722s
Epoch: 1 cost time: 84.83743453025818
Epoch: 1, Steps: 369 | Train Loss: 1.743 Vali Loss: 1.744 Vali Acc: 0.578 Test Loss: 1.744 Test Acc: 0.578
Validation loss decreased (inf --> -0.578303).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5154767
	speed: 0.7391s/iter; left time: 26927.3853s
	iters: 200, epoch: 2 | loss: 3.1901026
	speed: 0.2328s/iter; left time: 8459.7144s
	iters: 300, epoch: 2 | loss: 8.1343870
	speed: 0.2312s/iter; left time: 8377.1363s
Epoch: 2 cost time: 86.65960431098938
Epoch: 2, Steps: 369 | Train Loss: 2.962 Vali Loss: 5.275 Vali Acc: 0.638 Test Loss: 5.275 Test Acc: 0.638
Validation loss decreased (-0.578303 --> -0.637859).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5952296
	speed: 0.7816s/iter; left time: 28187.9353s
	iters: 200, epoch: 3 | loss: 1.9184909
	speed: 0.2353s/iter; left time: 8462.4390s
	iters: 300, epoch: 3 | loss: 6.7706866
	speed: 0.2277s/iter; left time: 8167.1942s
Epoch: 3 cost time: 86.39330840110779
Epoch: 3, Steps: 369 | Train Loss: 4.502 Vali Loss: 5.397 Vali Acc: 0.660 Test Loss: 5.397 Test Acc: 0.660
Validation loss decreased (-0.637859 --> -0.660275).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0841203
	speed: 0.7590s/iter; left time: 27093.3153s
	iters: 200, epoch: 4 | loss: 6.5936899
	speed: 0.2308s/iter; left time: 8216.2602s
	iters: 300, epoch: 4 | loss: 4.1776800
	speed: 0.2309s/iter; left time: 8197.1228s
Epoch: 4 cost time: 85.95766592025757
Epoch: 4, Steps: 369 | Train Loss: 5.181 Vali Loss: 5.419 Vali Acc: 0.635 Test Loss: 5.419 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9293723
	speed: 0.7773s/iter; left time: 27458.2136s
	iters: 200, epoch: 5 | loss: 12.2252617
	speed: 0.2395s/iter; left time: 8437.6131s
	iters: 300, epoch: 5 | loss: 4.4296341
	speed: 0.2283s/iter; left time: 8019.1562s
Epoch: 5 cost time: 86.4681715965271
Epoch: 5, Steps: 369 | Train Loss: 6.017 Vali Loss: 4.076 Vali Acc: 0.632 Test Loss: 4.076 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 8.2433300
	speed: 0.7450s/iter; left time: 26043.0415s
	iters: 200, epoch: 6 | loss: 6.8242168
	speed: 0.2357s/iter; left time: 8214.3720s
	iters: 300, epoch: 6 | loss: 5.3005381
	speed: 0.2332s/iter; left time: 8105.6795s
Epoch: 6 cost time: 87.0273711681366
Epoch: 6, Steps: 369 | Train Loss: 6.479 Vali Loss: 5.007 Vali Acc: 0.659 Test Loss: 5.007 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 6.0324092
	speed: 0.7789s/iter; left time: 26939.7665s
	iters: 200, epoch: 7 | loss: 6.5294805
	speed: 0.2331s/iter; left time: 8038.6725s
	iters: 300, epoch: 7 | loss: 5.8059878
	speed: 0.2281s/iter; left time: 7844.6806s
Epoch: 7 cost time: 85.49863123893738
Epoch: 7, Steps: 369 | Train Loss: 5.982 Vali Loss: 4.271 Vali Acc: 0.657 Test Loss: 4.271 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.7520661
	speed: 0.7514s/iter; left time: 25712.7320s
	iters: 200, epoch: 8 | loss: 3.5283492
	speed: 0.2403s/iter; left time: 8199.8905s
	iters: 300, epoch: 8 | loss: 7.2513123
	speed: 0.2409s/iter; left time: 8194.5692s
Epoch: 8 cost time: 88.58929753303528
Epoch: 8, Steps: 369 | Train Loss: 5.445 Vali Loss: 6.513 Vali Acc: 0.648 Test Loss: 6.513 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 4.8173375
	speed: 0.7744s/iter; left time: 26214.2631s
	iters: 200, epoch: 9 | loss: 4.8356533
	speed: 0.2309s/iter; left time: 7794.1143s
	iters: 300, epoch: 9 | loss: 5.2105985
	speed: 0.2260s/iter; left time: 7603.3582s
Epoch: 9 cost time: 84.48105669021606
Epoch: 9, Steps: 369 | Train Loss: 5.420 Vali Loss: 4.132 Vali Acc: 0.651 Test Loss: 4.132 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 4.6987338
	speed: 0.7299s/iter; left time: 24437.6942s
	iters: 200, epoch: 10 | loss: 7.9703560
	speed: 0.2385s/iter; left time: 7962.1172s
	iters: 300, epoch: 10 | loss: 3.6480675
	speed: 0.2347s/iter; left time: 7810.3854s
Epoch: 10 cost time: 86.41809844970703
Epoch: 10, Steps: 369 | Train Loss: 4.349 Vali Loss: 4.995 Vali Acc: 0.647 Test Loss: 4.995 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.8014319
	speed: 0.7815s/iter; left time: 25875.6602s
	iters: 200, epoch: 11 | loss: 5.3881369
	speed: 0.2337s/iter; left time: 7713.8162s
	iters: 300, epoch: 11 | loss: 6.6131659
	speed: 0.2356s/iter; left time: 7754.9674s
Epoch: 11 cost time: 86.65893816947937
Epoch: 11, Steps: 369 | Train Loss: 3.510 Vali Loss: 3.733 Vali Acc: 0.634 Test Loss: 3.733 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.0189390
	speed: 0.7275s/iter; left time: 23818.5334s
	iters: 200, epoch: 12 | loss: 3.4477499
	speed: 0.2240s/iter; left time: 7312.3828s
	iters: 300, epoch: 12 | loss: 0.9164466
	speed: 0.2375s/iter; left time: 7728.8276s
Epoch: 12 cost time: 84.44278025627136
Epoch: 12, Steps: 369 | Train Loss: 2.482 Vali Loss: 1.718 Vali Acc: 0.655 Test Loss: 1.718 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.9195215
	speed: 0.7840s/iter; left time: 25380.7651s
	iters: 200, epoch: 13 | loss: 1.8052621
	speed: 0.2397s/iter; left time: 7736.4244s
	iters: 300, epoch: 13 | loss: 0.4822020
	speed: 0.2391s/iter; left time: 7693.2035s
Epoch: 13 cost time: 88.90286135673523
Epoch: 13, Steps: 369 | Train Loss: 1.166 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6603291713961408
model parameter : 1172482
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7046778
	speed: 0.1830s/iter; left time: 6734.0560s
	iters: 200, epoch: 1 | loss: 0.6077374
	speed: 0.1732s/iter; left time: 6357.7228s
	iters: 300, epoch: 1 | loss: 0.7938619
	speed: 0.1762s/iter; left time: 6448.8096s
Epoch: 1 cost time: 65.67585444450378
Epoch: 1, Steps: 369 | Train Loss: 1.545 Vali Loss: 0.964 Vali Acc: 0.656 Test Loss: 0.964 Test Acc: 0.656
Validation loss decreased (inf --> -0.655495).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8600946
	speed: 0.5730s/iter; left time: 20875.7995s
	iters: 200, epoch: 2 | loss: 0.9086992
	speed: 0.1773s/iter; left time: 6442.0002s
	iters: 300, epoch: 2 | loss: 2.7116041
	speed: 0.1761s/iter; left time: 6379.5340s
Epoch: 2 cost time: 64.73088932037354
Epoch: 2, Steps: 369 | Train Loss: 2.619 Vali Loss: 1.615 Vali Acc: 0.643 Test Loss: 1.615 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2622204
	speed: 0.5481s/iter; left time: 19766.5473s
	iters: 200, epoch: 3 | loss: 2.5888014
	speed: 0.1701s/iter; left time: 6118.8886s
	iters: 300, epoch: 3 | loss: 3.1195333
	speed: 0.1701s/iter; left time: 6100.7178s
Epoch: 3 cost time: 63.1134192943573
Epoch: 3, Steps: 369 | Train Loss: 3.605 Vali Loss: 4.558 Vali Acc: 0.647 Test Loss: 4.558 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 5.6765957
	speed: 0.5760s/iter; left time: 20561.4988s
	iters: 200, epoch: 4 | loss: 2.6233828
	speed: 0.1697s/iter; left time: 6040.6225s
	iters: 300, epoch: 4 | loss: 2.5214527
	speed: 0.1764s/iter; left time: 6262.4982s
Epoch: 4 cost time: 64.27611517906189
Epoch: 4, Steps: 369 | Train Loss: 4.483 Vali Loss: 4.316 Vali Acc: 0.639 Test Loss: 4.316 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.8068495
	speed: 0.5692s/iter; left time: 20107.0918s
	iters: 200, epoch: 5 | loss: 5.1595750
	speed: 0.1709s/iter; left time: 6020.7494s
	iters: 300, epoch: 5 | loss: 8.7936201
	speed: 0.1740s/iter; left time: 6110.9101s
Epoch: 5 cost time: 63.85365581512451
Epoch: 5, Steps: 369 | Train Loss: 5.124 Vali Loss: 4.238 Vali Acc: 0.647 Test Loss: 4.238 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.8968363
	speed: 0.5564s/iter; left time: 19449.2732s
	iters: 200, epoch: 6 | loss: 6.0379486
	speed: 0.1761s/iter; left time: 6139.1804s
	iters: 300, epoch: 6 | loss: 8.1566219
	speed: 0.1748s/iter; left time: 6073.6128s
Epoch: 6 cost time: 65.01168537139893
Epoch: 6, Steps: 369 | Train Loss: 5.086 Vali Loss: 4.496 Vali Acc: 0.624 Test Loss: 4.496 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.5969789
	speed: 0.5757s/iter; left time: 19912.7913s
	iters: 200, epoch: 7 | loss: 9.2098885
	speed: 0.1729s/iter; left time: 5963.3329s
	iters: 300, epoch: 7 | loss: 5.0224252
	speed: 0.1726s/iter; left time: 5936.8129s
Epoch: 7 cost time: 64.43681788444519
Epoch: 7, Steps: 369 | Train Loss: 5.383 Vali Loss: 3.733 Vali Acc: 0.643 Test Loss: 3.733 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.4014213
	speed: 0.5610s/iter; left time: 19196.6635s
	iters: 200, epoch: 8 | loss: 4.6392689
	speed: 0.1663s/iter; left time: 5674.5049s
	iters: 300, epoch: 8 | loss: 7.8515515
	speed: 0.1697s/iter; left time: 5773.4425s
Epoch: 8 cost time: 62.06890296936035
Epoch: 8, Steps: 369 | Train Loss: 4.732 Vali Loss: 3.341 Vali Acc: 0.652 Test Loss: 3.341 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 4.2615390
	speed: 0.5654s/iter; left time: 19137.9645s
	iters: 200, epoch: 9 | loss: 2.1298678
	speed: 0.1767s/iter; left time: 5964.8820s
	iters: 300, epoch: 9 | loss: 9.1729717
	speed: 0.1762s/iter; left time: 5928.1701s
Epoch: 9 cost time: 65.55012226104736
Epoch: 9, Steps: 369 | Train Loss: 4.525 Vali Loss: 5.113 Vali Acc: 0.604 Test Loss: 5.113 Test Acc: 0.604
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.1983360
	speed: 0.5768s/iter; left time: 19311.4764s
	iters: 200, epoch: 10 | loss: 4.3567514
	speed: 0.1770s/iter; left time: 5906.6144s
	iters: 300, epoch: 10 | loss: 2.4587257
	speed: 0.1742s/iter; left time: 5797.9782s
Epoch: 10 cost time: 64.5581886768341
Epoch: 10, Steps: 369 | Train Loss: 3.880 Vali Loss: 5.412 Vali Acc: 0.608 Test Loss: 5.412 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.4101369
	speed: 0.5344s/iter; left time: 17695.4206s
	iters: 200, epoch: 11 | loss: 3.0041938
	speed: 0.1605s/iter; left time: 5297.5376s
	iters: 300, epoch: 11 | loss: 5.0703239
	speed: 0.1690s/iter; left time: 5563.1374s
Epoch: 11 cost time: 61.46076035499573
Epoch: 11, Steps: 369 | Train Loss: 3.057 Vali Loss: 2.570 Vali Acc: 0.653 Test Loss: 2.570 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6555051078320091
model parameter : 951554
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.9208491
	speed: 0.1639s/iter; left time: 6032.4071s
	iters: 200, epoch: 1 | loss: 0.9574939
	speed: 0.1481s/iter; left time: 5433.9360s
	iters: 300, epoch: 1 | loss: 1.5272030
	speed: 0.1474s/iter; left time: 5396.0518s
Epoch: 1 cost time: 55.74098443984985
Epoch: 1, Steps: 369 | Train Loss: 1.458 Vali Loss: 1.086 Vali Acc: 0.654 Test Loss: 1.086 Test Acc: 0.654
Validation loss decreased (inf --> -0.653508).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6622550
	speed: 0.4451s/iter; left time: 16215.9565s
	iters: 200, epoch: 2 | loss: 2.7604513
	speed: 0.1362s/iter; left time: 4949.1721s
	iters: 300, epoch: 2 | loss: 1.9354233
	speed: 0.1366s/iter; left time: 4948.6193s
Epoch: 2 cost time: 50.21787357330322
Epoch: 2, Steps: 369 | Train Loss: 2.251 Vali Loss: 2.755 Vali Acc: 0.627 Test Loss: 2.755 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.5439186
	speed: 0.4613s/iter; left time: 16635.5818s
	iters: 200, epoch: 3 | loss: 1.9976583
	speed: 0.1484s/iter; left time: 5336.0338s
	iters: 300, epoch: 3 | loss: 1.4167291
	speed: 0.1473s/iter; left time: 5282.9648s
Epoch: 3 cost time: 54.72579765319824
Epoch: 3, Steps: 369 | Train Loss: 3.110 Vali Loss: 2.536 Vali Acc: 0.648 Test Loss: 2.536 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 6.3292751
	speed: 0.4739s/iter; left time: 16914.5873s
	iters: 200, epoch: 4 | loss: 4.9340830
	speed: 0.1502s/iter; left time: 5345.2486s
	iters: 300, epoch: 4 | loss: 0.6526283
	speed: 0.1492s/iter; left time: 5297.2093s
Epoch: 4 cost time: 55.33319926261902
Epoch: 4, Steps: 369 | Train Loss: 3.881 Vali Loss: 7.753 Vali Acc: 0.650 Test Loss: 7.753 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 6.4117203
	speed: 0.4612s/iter; left time: 16292.6291s
	iters: 200, epoch: 5 | loss: 4.0274553
	speed: 0.1413s/iter; left time: 4978.7757s
	iters: 300, epoch: 5 | loss: 3.8986380
	speed: 0.1454s/iter; left time: 5106.2943s
Epoch: 5 cost time: 53.313729763031006
Epoch: 5, Steps: 369 | Train Loss: 4.409 Vali Loss: 5.026 Vali Acc: 0.632 Test Loss: 5.026 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 7.9535170
	speed: 0.4758s/iter; left time: 16631.8130s
	iters: 200, epoch: 6 | loss: 0.0107760
	speed: 0.1468s/iter; left time: 5116.3494s
	iters: 300, epoch: 6 | loss: 6.5136795
	speed: 0.1469s/iter; left time: 5104.7205s
Epoch: 6 cost time: 55.03307509422302
Epoch: 6, Steps: 369 | Train Loss: 4.558 Vali Loss: 4.698 Vali Acc: 0.609 Test Loss: 4.698 Test Acc: 0.609
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 6.2258482
	speed: 0.4794s/iter; left time: 16582.5823s
	iters: 200, epoch: 7 | loss: 5.4718976
	speed: 0.1464s/iter; left time: 5048.4604s
	iters: 300, epoch: 7 | loss: 1.1394187
	speed: 0.1467s/iter; left time: 5044.8522s
Epoch: 7 cost time: 54.676496505737305
Epoch: 7, Steps: 369 | Train Loss: 4.470 Vali Loss: 21.631 Vali Acc: 0.500 Test Loss: 21.631 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 4.3840265
	speed: 0.4587s/iter; left time: 15697.3221s
	iters: 200, epoch: 8 | loss: 4.8870277
	speed: 0.1402s/iter; left time: 4784.8851s
	iters: 300, epoch: 8 | loss: 3.4530642
	speed: 0.1431s/iter; left time: 4866.6397s
Epoch: 8 cost time: 52.60385322570801
Epoch: 8, Steps: 369 | Train Loss: 4.432 Vali Loss: 3.317 Vali Acc: 0.631 Test Loss: 3.317 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 5.4133425
	speed: 0.3573s/iter; left time: 12095.2275s
	iters: 200, epoch: 9 | loss: 5.9265418
	speed: 0.1089s/iter; left time: 3674.9825s
	iters: 300, epoch: 9 | loss: 2.7486482
	speed: 0.1564s/iter; left time: 5264.3752s
Epoch: 9 cost time: 47.47875189781189
Epoch: 9, Steps: 369 | Train Loss: 4.114 Vali Loss: 4.016 Vali Acc: 0.640 Test Loss: 4.016 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.8255632
	speed: 0.3751s/iter; left time: 12559.3882s
	iters: 200, epoch: 10 | loss: 2.3428028
	speed: 0.2014s/iter; left time: 6724.1702s
	iters: 300, epoch: 10 | loss: 4.9581532
	speed: 0.1978s/iter; left time: 6582.4505s
Epoch: 10 cost time: 65.33888077735901
Epoch: 10, Steps: 369 | Train Loss: 3.728 Vali Loss: 3.979 Vali Acc: 0.662 Test Loss: 3.979 Test Acc: 0.662
Validation loss decreased (-0.653508 --> -0.662276).  Saving model ...
	iters: 100, epoch: 11 | loss: 7.2566957
	speed: 0.6331s/iter; left time: 20961.4122s
	iters: 200, epoch: 11 | loss: 2.2188179
	speed: 0.1946s/iter; left time: 6424.9002s
	iters: 300, epoch: 11 | loss: 3.0684955
	speed: 0.1953s/iter; left time: 6428.8315s
Epoch: 11 cost time: 72.33148527145386
Epoch: 11, Steps: 369 | Train Loss: 2.928 Vali Loss: 1.910 Vali Acc: 0.643 Test Loss: 1.910 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3898479
	speed: 0.6213s/iter; left time: 20343.3007s
	iters: 200, epoch: 12 | loss: 1.0176607
	speed: 0.1998s/iter; left time: 6521.0355s
	iters: 300, epoch: 12 | loss: 2.5343187
	speed: 0.1995s/iter; left time: 6490.6880s
Epoch: 12 cost time: 74.05248141288757
Epoch: 12, Steps: 369 | Train Loss: 2.005 Vali Loss: 1.210 Vali Acc: 0.661 Test Loss: 1.210 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6611648
	speed: 0.6222s/iter; left time: 20140.9640s
	iters: 200, epoch: 13 | loss: 0.5519633
	speed: 0.1987s/iter; left time: 6412.8080s
	iters: 300, epoch: 13 | loss: 0.7350039
	speed: 0.1976s/iter; left time: 6356.6649s
Epoch: 13 cost time: 73.2269549369812
Epoch: 13, Steps: 369 | Train Loss: 1.031 Vali Loss: 0.805 Vali Acc: 0.673 Test Loss: 0.805 Test Acc: 0.673
Validation loss decreased (-0.662276 --> -0.672807).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5716237
	speed: 0.6254s/iter; left time: 20015.9129s
	iters: 200, epoch: 14 | loss: 0.6235454
	speed: 0.1958s/iter; left time: 6248.0559s
	iters: 300, epoch: 14 | loss: 0.4207436
	speed: 0.1949s/iter; left time: 6199.7908s
Epoch: 14 cost time: 71.9097228050232
Epoch: 14, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.709 Vali Acc: 0.676 Test Loss: 0.709 Test Acc: 0.676
Validation loss decreased (-0.672807 --> -0.675929).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4790134
	speed: 0.5920s/iter; left time: 18728.2669s
	iters: 200, epoch: 15 | loss: 0.4415545
	speed: 0.1858s/iter; left time: 5858.4026s
	iters: 300, epoch: 15 | loss: 0.3616646
	speed: 0.1867s/iter; left time: 5867.9523s
Epoch: 15 cost time: 69.38650488853455
Epoch: 15, Steps: 369 | Train Loss: 0.494 Vali Loss: 0.700 Vali Acc: 0.676 Test Loss: 0.700 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.9243813
	speed: 0.5961s/iter; left time: 18639.0854s
	iters: 200, epoch: 16 | loss: 0.3368065
	speed: 0.1888s/iter; left time: 5884.6215s
	iters: 300, epoch: 16 | loss: 0.4252664
	speed: 0.1846s/iter; left time: 5736.1367s
Epoch: 16 cost time: 69.79916310310364
Epoch: 16, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.663 Vali Acc: 0.675 Test Loss: 0.663 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3341898
	speed: 0.5856s/iter; left time: 18091.9518s
	iters: 200, epoch: 17 | loss: 0.9248585
	speed: 0.1809s/iter; left time: 5571.7995s
	iters: 300, epoch: 17 | loss: 0.3238970
	speed: 0.1843s/iter; left time: 5657.0487s
Epoch: 17 cost time: 68.19167590141296
Epoch: 17, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.741 Vali Acc: 0.672 Test Loss: 0.741 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3009346
	speed: 0.5849s/iter; left time: 17855.0772s
	iters: 200, epoch: 18 | loss: 0.4124329
	speed: 0.1888s/iter; left time: 5743.5369s
	iters: 300, epoch: 18 | loss: 0.6188184
	speed: 0.1969s/iter; left time: 5970.7970s
Epoch: 18 cost time: 71.22224688529968
Epoch: 18, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.805 Vali Acc: 0.671 Test Loss: 0.805 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3529787
	speed: 0.6243s/iter; left time: 18828.8339s
	iters: 200, epoch: 19 | loss: 0.3247343
	speed: 0.2000s/iter; left time: 6010.7934s
	iters: 300, epoch: 19 | loss: 0.2622887
	speed: 0.1993s/iter; left time: 5969.3901s
Epoch: 19 cost time: 73.8769907951355
Epoch: 19, Steps: 369 | Train Loss: 0.433 Vali Loss: 0.782 Vali Acc: 0.666 Test Loss: 0.782 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.4279068
	speed: 0.6129s/iter; left time: 18259.6937s
	iters: 200, epoch: 20 | loss: 0.6619136
	speed: 0.1948s/iter; left time: 5782.8932s
	iters: 300, epoch: 20 | loss: 0.3964874
	speed: 0.1937s/iter; left time: 5732.2062s
Epoch: 20 cost time: 72.07337689399719
Epoch: 20, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.813 Vali Acc: 0.657 Test Loss: 0.813 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6272281
	speed: 0.6206s/iter; left time: 18257.5527s
	iters: 200, epoch: 21 | loss: 0.2969897
	speed: 0.2020s/iter; left time: 5923.0827s
	iters: 300, epoch: 21 | loss: 0.3331941
	speed: 0.2010s/iter; left time: 5873.9208s
Epoch: 21 cost time: 74.22015333175659
Epoch: 21, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.829 Vali Acc: 0.652 Test Loss: 0.829 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6057116
	speed: 0.6352s/iter; left time: 18454.9533s
	iters: 200, epoch: 22 | loss: 0.3800375
	speed: 0.2007s/iter; left time: 5811.7830s
	iters: 300, epoch: 22 | loss: 0.4841460
	speed: 0.2000s/iter; left time: 5769.0740s
Epoch: 22 cost time: 74.3031394481659
Epoch: 22, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.817 Vali Acc: 0.663 Test Loss: 0.817 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2094864
	speed: 0.5893s/iter; left time: 16902.9656s
	iters: 200, epoch: 23 | loss: 0.2849644
	speed: 0.1809s/iter; left time: 5169.5311s
	iters: 300, epoch: 23 | loss: 0.1145692
	speed: 0.1787s/iter; left time: 5090.7337s
Epoch: 23 cost time: 67.1687183380127
Epoch: 23, Steps: 369 | Train Loss: 0.369 Vali Loss: 0.834 Vali Acc: 0.659 Test Loss: 0.834 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1419105
	speed: 0.5864s/iter; left time: 16602.1620s
	iters: 200, epoch: 24 | loss: 0.3762740
	speed: 0.1898s/iter; left time: 5354.9664s
	iters: 300, epoch: 24 | loss: 0.3542466
	speed: 0.1858s/iter; left time: 5223.2133s
Epoch: 24 cost time: 69.83337950706482
Epoch: 24, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.937 Vali Acc: 0.657 Test Loss: 0.937 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6759364358683314
model parameter : 841346
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9669887
	speed: 0.1854s/iter; left time: 6824.5755s
	iters: 200, epoch: 1 | loss: 1.2021015
	speed: 0.1635s/iter; left time: 5999.8919s
	iters: 300, epoch: 1 | loss: 1.1491383
	speed: 0.1580s/iter; left time: 5784.1292s
Epoch: 1 cost time: 62.46720910072327
Epoch: 1, Steps: 369 | Train Loss: 1.254 Vali Loss: 1.092 Vali Acc: 0.636 Test Loss: 1.092 Test Acc: 0.636
Validation loss decreased (inf --> -0.636482).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2312164
	speed: 0.5440s/iter; left time: 19817.8695s
	iters: 200, epoch: 2 | loss: 2.3252461
	speed: 0.1694s/iter; left time: 6154.5082s
	iters: 300, epoch: 2 | loss: 2.7660406
	speed: 0.1696s/iter; left time: 6144.7015s
Epoch: 2 cost time: 63.091668128967285
Epoch: 2, Steps: 369 | Train Loss: 2.003 Vali Loss: 2.001 Vali Acc: 0.647 Test Loss: 2.001 Test Acc: 0.647
Validation loss decreased (-0.636482 --> -0.646972).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0930655
	speed: 0.5620s/iter; left time: 20268.4777s
	iters: 200, epoch: 3 | loss: 5.3330541
	speed: 0.1728s/iter; left time: 6214.7835s
	iters: 300, epoch: 3 | loss: 1.3676264
	speed: 0.1730s/iter; left time: 6205.8076s
Epoch: 3 cost time: 64.14593982696533
Epoch: 3, Steps: 369 | Train Loss: 2.766 Vali Loss: 2.642 Vali Acc: 0.661 Test Loss: 2.642 Test Acc: 0.661
Validation loss decreased (-0.646972 --> -0.661438).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2810392
	speed: 0.5696s/iter; left time: 20331.9088s
	iters: 200, epoch: 4 | loss: 3.0960574
	speed: 0.1735s/iter; left time: 6176.6745s
	iters: 300, epoch: 4 | loss: 3.5492315
	speed: 0.1748s/iter; left time: 6203.3844s
Epoch: 4 cost time: 65.02347755432129
Epoch: 4, Steps: 369 | Train Loss: 3.291 Vali Loss: 11.694 Vali Acc: 0.501 Test Loss: 11.694 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5217810
	speed: 0.5532s/iter; left time: 19540.5475s
	iters: 200, epoch: 5 | loss: 5.1843667
	speed: 0.1716s/iter; left time: 6044.4492s
	iters: 300, epoch: 5 | loss: 3.1230922
	speed: 0.1712s/iter; left time: 6014.4104s
Epoch: 5 cost time: 63.684152126312256
Epoch: 5, Steps: 369 | Train Loss: 3.693 Vali Loss: 4.476 Vali Acc: 0.591 Test Loss: 4.476 Test Acc: 0.591
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.5849495
	speed: 0.5628s/iter; left time: 19674.6668s
	iters: 200, epoch: 6 | loss: 3.5625768
	speed: 0.1701s/iter; left time: 5929.9648s
	iters: 300, epoch: 6 | loss: 5.7486396
	speed: 0.1643s/iter; left time: 5709.7532s
Epoch: 6 cost time: 62.32342767715454
Epoch: 6, Steps: 369 | Train Loss: 3.757 Vali Loss: 1.664 Vali Acc: 0.652 Test Loss: 1.664 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3074499
	speed: 0.5282s/iter; left time: 18269.0787s
	iters: 200, epoch: 7 | loss: 7.2669086
	speed: 0.1617s/iter; left time: 5575.2158s
	iters: 300, epoch: 7 | loss: 4.8772197
	speed: 0.1653s/iter; left time: 5685.2760s
Epoch: 7 cost time: 60.934340715408325
Epoch: 7, Steps: 369 | Train Loss: 3.637 Vali Loss: 3.806 Vali Acc: 0.657 Test Loss: 3.806 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 5.4771123
	speed: 0.5303s/iter; left time: 18146.1209s
	iters: 200, epoch: 8 | loss: 5.7054815
	speed: 0.1646s/iter; left time: 5614.4979s
	iters: 300, epoch: 8 | loss: 7.2917314
	speed: 0.1567s/iter; left time: 5329.9895s
Epoch: 8 cost time: 60.25336527824402
Epoch: 8, Steps: 369 | Train Loss: 3.860 Vali Loss: 3.443 Vali Acc: 0.654 Test Loss: 3.443 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.0877087
	speed: 0.5242s/iter; left time: 17745.0461s
	iters: 200, epoch: 9 | loss: 2.8193269
	speed: 0.1597s/iter; left time: 5390.0809s
	iters: 300, epoch: 9 | loss: 5.7954965
	speed: 0.1608s/iter; left time: 5410.5341s
Epoch: 9 cost time: 59.60629081726074
Epoch: 9, Steps: 369 | Train Loss: 3.668 Vali Loss: 1.608 Vali Acc: 0.644 Test Loss: 1.608 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.9937177
	speed: 0.5265s/iter; left time: 17627.1385s
	iters: 200, epoch: 10 | loss: 1.6480081
	speed: 0.1659s/iter; left time: 5537.3193s
	iters: 300, epoch: 10 | loss: 2.6586001
	speed: 0.1560s/iter; left time: 5191.3703s
Epoch: 10 cost time: 61.320024251937866
Epoch: 10, Steps: 369 | Train Loss: 3.092 Vali Loss: 4.272 Vali Acc: 0.638 Test Loss: 4.272 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.8194935
	speed: 0.5657s/iter; left time: 18730.7897s
	iters: 200, epoch: 11 | loss: 0.7829546
	speed: 0.1771s/iter; left time: 5847.5892s
	iters: 300, epoch: 11 | loss: 0.8133114
	speed: 0.1770s/iter; left time: 5824.6797s
Epoch: 11 cost time: 65.82032561302185
Epoch: 11, Steps: 369 | Train Loss: 2.467 Vali Loss: 2.549 Vali Acc: 0.601 Test Loss: 2.549 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.0547010
	speed: 0.5783s/iter; left time: 18936.3246s
	iters: 200, epoch: 12 | loss: 1.0506512
	speed: 0.1764s/iter; left time: 5758.3846s
	iters: 300, epoch: 12 | loss: 0.6935425
	speed: 0.1755s/iter; left time: 5710.3097s
Epoch: 12 cost time: 65.48627710342407
Epoch: 12, Steps: 369 | Train Loss: 1.487 Vali Loss: 1.183 Vali Acc: 0.660 Test Loss: 1.183 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.3883026
	speed: 0.5859s/iter; left time: 18967.6221s
	iters: 200, epoch: 13 | loss: 0.5509660
	speed: 0.1788s/iter; left time: 5771.1409s
	iters: 300, epoch: 13 | loss: 0.3127255
	speed: 0.1754s/iter; left time: 5643.9609s
Epoch: 13 cost time: 66.44264936447144
Epoch: 13, Steps: 369 | Train Loss: 0.829 Vali Loss: 0.794 Vali Acc: 0.657 Test Loss: 0.794 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6614642451759364
model parameter : 731138
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.4446073
	speed: 0.0713s/iter; left time: 2624.4158s
	iters: 200, epoch: 1 | loss: 1.0969732
	speed: 0.0553s/iter; left time: 2027.9712s
	iters: 300, epoch: 1 | loss: 0.6540643
	speed: 0.0552s/iter; left time: 2018.8007s
Epoch: 1 cost time: 22.103555917739868
Epoch: 1, Steps: 369 | Train Loss: 1.125 Vali Loss: 1.096 Vali Acc: 0.631 Test Loss: 1.096 Test Acc: 0.631
Validation loss decreased (inf --> -0.630523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9067955
	speed: 0.1882s/iter; left time: 6856.7627s
	iters: 200, epoch: 2 | loss: 3.0043595
	speed: 0.0558s/iter; left time: 2028.5818s
	iters: 300, epoch: 2 | loss: 0.6219255
	speed: 0.0574s/iter; left time: 2079.3446s
Epoch: 2 cost time: 21.43744158744812
Epoch: 2, Steps: 369 | Train Loss: 1.704 Vali Loss: 2.979 Vali Acc: 0.620 Test Loss: 2.979 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.1381891
	speed: 0.1952s/iter; left time: 7037.8303s
	iters: 200, epoch: 3 | loss: 3.3306360
	speed: 0.0591s/iter; left time: 2124.0782s
	iters: 300, epoch: 3 | loss: 5.1292982
	speed: 0.0596s/iter; left time: 2137.6874s
Epoch: 3 cost time: 22.348508596420288
Epoch: 3, Steps: 369 | Train Loss: 2.311 Vali Loss: 2.431 Vali Acc: 0.632 Test Loss: 2.431 Test Acc: 0.632
Validation loss decreased (-0.630523 --> -0.632212).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6610582
	speed: 0.1972s/iter; left time: 7039.5611s
	iters: 200, epoch: 4 | loss: 3.5357254
	speed: 0.0597s/iter; left time: 2125.6690s
	iters: 300, epoch: 4 | loss: 4.2307401
	speed: 0.0596s/iter; left time: 2115.8650s
Epoch: 4 cost time: 22.49755358695984
Epoch: 4, Steps: 369 | Train Loss: 2.844 Vali Loss: 3.046 Vali Acc: 0.634 Test Loss: 3.046 Test Acc: 0.634
Validation loss decreased (-0.632212 --> -0.633624).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3877819
	speed: 0.2013s/iter; left time: 7112.6863s
	iters: 200, epoch: 5 | loss: 2.5348735
	speed: 0.0601s/iter; left time: 2117.4521s
	iters: 300, epoch: 5 | loss: 3.7689202
	speed: 0.0600s/iter; left time: 2108.7403s
Epoch: 5 cost time: 22.628477334976196
Epoch: 5, Steps: 369 | Train Loss: 3.269 Vali Loss: 3.101 Vali Acc: 0.636 Test Loss: 3.101 Test Acc: 0.636
Validation loss decreased (-0.633624 --> -0.635610).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5478903
	speed: 0.1968s/iter; left time: 6880.7735s
	iters: 200, epoch: 6 | loss: 5.1849704
	speed: 0.0600s/iter; left time: 2092.6122s
	iters: 300, epoch: 6 | loss: 5.7815475
	speed: 0.0602s/iter; left time: 2092.4492s
Epoch: 6 cost time: 22.708602905273438
Epoch: 6, Steps: 369 | Train Loss: 3.330 Vali Loss: 4.139 Vali Acc: 0.618 Test Loss: 4.139 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.6990242
	speed: 0.2035s/iter; left time: 7037.8499s
	iters: 200, epoch: 7 | loss: 5.8842697
	speed: 0.0599s/iter; left time: 2065.7859s
	iters: 300, epoch: 7 | loss: 1.9598730
	speed: 0.0603s/iter; left time: 2074.5957s
Epoch: 7 cost time: 22.731067895889282
Epoch: 7, Steps: 369 | Train Loss: 3.308 Vali Loss: 3.331 Vali Acc: 0.660 Test Loss: 3.331 Test Acc: 0.660
Validation loss decreased (-0.635610 --> -0.660012).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1528823
	speed: 0.2007s/iter; left time: 6868.7489s
	iters: 200, epoch: 8 | loss: 2.3474908
	speed: 0.0606s/iter; left time: 2066.8957s
	iters: 300, epoch: 8 | loss: 2.6729159
	speed: 0.0602s/iter; left time: 2049.4839s
Epoch: 8 cost time: 22.778414726257324
Epoch: 8, Steps: 369 | Train Loss: 3.259 Vali Loss: 6.541 Vali Acc: 0.523 Test Loss: 6.541 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0454678
	speed: 0.2042s/iter; left time: 6910.3783s
	iters: 200, epoch: 9 | loss: 3.1680634
	speed: 0.0606s/iter; left time: 2046.8708s
	iters: 300, epoch: 9 | loss: 1.7048035
	speed: 0.0605s/iter; left time: 2036.9626s
Epoch: 9 cost time: 22.915508270263672
Epoch: 9, Steps: 369 | Train Loss: 3.191 Vali Loss: 2.225 Vali Acc: 0.666 Test Loss: 2.225 Test Acc: 0.666
Validation loss decreased (-0.660012 --> -0.666266).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3293962
	speed: 0.2054s/iter; left time: 6876.9428s
	iters: 200, epoch: 10 | loss: 3.7095976
	speed: 0.0606s/iter; left time: 2023.8264s
	iters: 300, epoch: 10 | loss: 3.0603199
	speed: 0.0604s/iter; left time: 2009.7920s
Epoch: 10 cost time: 23.0151948928833
Epoch: 10, Steps: 369 | Train Loss: 2.862 Vali Loss: 1.750 Vali Acc: 0.633 Test Loss: 1.750 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0160961
	speed: 0.1993s/iter; left time: 6600.0877s
	iters: 200, epoch: 11 | loss: 1.6093804
	speed: 0.0605s/iter; left time: 1996.0732s
	iters: 300, epoch: 11 | loss: 1.2412198
	speed: 0.0604s/iter; left time: 1986.4390s
Epoch: 11 cost time: 22.840805530548096
Epoch: 11, Steps: 369 | Train Loss: 2.116 Vali Loss: 1.428 Vali Acc: 0.661 Test Loss: 1.428 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1064005
	speed: 0.1991s/iter; left time: 6518.9293s
	iters: 200, epoch: 12 | loss: 1.5689418
	speed: 0.0607s/iter; left time: 1981.9717s
	iters: 300, epoch: 12 | loss: 1.9349580
	speed: 0.0605s/iter; left time: 1969.6326s
Epoch: 12 cost time: 22.816550731658936
Epoch: 12, Steps: 369 | Train Loss: 1.438 Vali Loss: 1.188 Vali Acc: 0.647 Test Loss: 1.188 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4550068
	speed: 0.1999s/iter; left time: 6470.7986s
	iters: 200, epoch: 13 | loss: 0.8909965
	speed: 0.0603s/iter; left time: 1947.1680s
	iters: 300, epoch: 13 | loss: 0.4760125
	speed: 0.0606s/iter; left time: 1948.6829s
Epoch: 13 cost time: 22.813653469085693
Epoch: 13, Steps: 369 | Train Loss: 0.805 Vali Loss: 0.740 Vali Acc: 0.671 Test Loss: 0.740 Test Acc: 0.671
Validation loss decreased (-0.666266 --> -0.671105).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6122469
	speed: 0.2028s/iter; left time: 6490.3063s
	iters: 200, epoch: 14 | loss: 0.7357101
	speed: 0.0605s/iter; left time: 1928.7105s
	iters: 300, epoch: 14 | loss: 0.4663741
	speed: 0.0604s/iter; left time: 1920.9798s
Epoch: 14 cost time: 22.791839838027954
Epoch: 14, Steps: 369 | Train Loss: 0.520 Vali Loss: 0.705 Vali Acc: 0.669 Test Loss: 0.705 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4969391
	speed: 0.2012s/iter; left time: 6364.3063s
	iters: 200, epoch: 15 | loss: 0.5342212
	speed: 0.0603s/iter; left time: 1900.0416s
	iters: 300, epoch: 15 | loss: 0.4893804
	speed: 0.0604s/iter; left time: 1897.2714s
Epoch: 15 cost time: 22.85054349899292
Epoch: 15, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.697 Vali Acc: 0.681 Test Loss: 0.697 Test Acc: 0.681
Validation loss decreased (-0.671105 --> -0.680754).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4988185
	speed: 0.2004s/iter; left time: 6264.6203s
	iters: 200, epoch: 16 | loss: 0.4874113
	speed: 0.0603s/iter; left time: 1880.4967s
	iters: 300, epoch: 16 | loss: 0.2265446
	speed: 0.0601s/iter; left time: 1867.1324s
Epoch: 16 cost time: 22.83684754371643
Epoch: 16, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.762 Vali Acc: 0.646 Test Loss: 0.762 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3227164
	speed: 0.2028s/iter; left time: 6264.5937s
	iters: 200, epoch: 17 | loss: 0.4979031
	speed: 0.0600s/iter; left time: 1848.9634s
	iters: 300, epoch: 17 | loss: 0.3010365
	speed: 0.0605s/iter; left time: 1858.4409s
Epoch: 17 cost time: 22.828119039535522
Epoch: 17, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.674 Vali Acc: 0.678 Test Loss: 0.674 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2869745
	speed: 0.2011s/iter; left time: 6138.4881s
	iters: 200, epoch: 18 | loss: 0.4751975
	speed: 0.0606s/iter; left time: 1844.8475s
	iters: 300, epoch: 18 | loss: 0.4639359
	speed: 0.0604s/iter; left time: 1830.3520s
Epoch: 18 cost time: 22.844032049179077
Epoch: 18, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.696 Vali Acc: 0.672 Test Loss: 0.696 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3555698
	speed: 0.2028s/iter; left time: 6116.8039s
	iters: 200, epoch: 19 | loss: 0.5435381
	speed: 0.0608s/iter; left time: 1826.7121s
	iters: 300, epoch: 19 | loss: 0.3611162
	speed: 0.0608s/iter; left time: 1821.6962s
Epoch: 19 cost time: 22.9386203289032
Epoch: 19, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.676 Vali Acc: 0.677 Test Loss: 0.676 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2722766
	speed: 0.2054s/iter; left time: 6120.0198s
	iters: 200, epoch: 20 | loss: 0.3268134
	speed: 0.0603s/iter; left time: 1790.6145s
	iters: 300, epoch: 20 | loss: 0.8784292
	speed: 0.0604s/iter; left time: 1787.1531s
Epoch: 20 cost time: 22.836446285247803
Epoch: 20, Steps: 369 | Train Loss: 0.397 Vali Loss: 0.774 Vali Acc: 0.664 Test Loss: 0.774 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5158242
	speed: 0.2057s/iter; left time: 6052.3992s
	iters: 200, epoch: 21 | loss: 0.3493288
	speed: 0.0604s/iter; left time: 1769.8302s
	iters: 300, epoch: 21 | loss: 0.4770731
	speed: 0.0604s/iter; left time: 1763.5865s
Epoch: 21 cost time: 22.829092025756836
Epoch: 21, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.746 Vali Acc: 0.654 Test Loss: 0.746 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3647232
	speed: 0.2006s/iter; left time: 5828.6412s
	iters: 200, epoch: 22 | loss: 0.3527761
	speed: 0.0603s/iter; left time: 1745.0625s
	iters: 300, epoch: 22 | loss: 0.3362412
	speed: 0.0608s/iter; left time: 1753.7806s
Epoch: 22 cost time: 22.89561414718628
Epoch: 22, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.794 Vali Acc: 0.666 Test Loss: 0.794 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3144502
	speed: 0.2008s/iter; left time: 5760.7586s
	iters: 200, epoch: 23 | loss: 0.4444357
	speed: 0.0606s/iter; left time: 1732.1942s
	iters: 300, epoch: 23 | loss: 0.1980916
	speed: 0.0604s/iter; left time: 1719.0395s
Epoch: 23 cost time: 22.812218189239502
Epoch: 23, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.834 Vali Acc: 0.678 Test Loss: 0.834 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2037655
	speed: 0.2016s/iter; left time: 5708.4510s
	iters: 200, epoch: 24 | loss: 0.2804691
	speed: 0.0604s/iter; left time: 1704.0462s
	iters: 300, epoch: 24 | loss: 0.3808370
	speed: 0.0605s/iter; left time: 1700.3349s
Epoch: 24 cost time: 22.82792568206787
Epoch: 24, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.829 Vali Acc: 0.656 Test Loss: 0.829 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.2151586
	speed: 0.1996s/iter; left time: 5578.2670s
	iters: 200, epoch: 25 | loss: 0.5694075
	speed: 0.0600s/iter; left time: 1671.2407s
	iters: 300, epoch: 25 | loss: 0.1566570
	speed: 0.0603s/iter; left time: 1673.9690s
Epoch: 25 cost time: 22.856637239456177
Epoch: 25, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.857 Vali Acc: 0.667 Test Loss: 0.857 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6807604994324631
model parameter : 657794
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0337348
	speed: 0.6547s/iter; left time: 24095.0673s
	iters: 200, epoch: 1 | loss: 2.3666501
	speed: 0.6357s/iter; left time: 23329.8702s
	iters: 300, epoch: 1 | loss: 6.5586586
	speed: 0.5742s/iter; left time: 21014.9583s
Epoch: 1 cost time: 228.8701913356781
Epoch: 1, Steps: 369 | Train Loss: 3.250 Vali Loss: 2.137 Vali Acc: 0.648 Test Loss: 2.137 Test Acc: 0.648
Validation loss decreased (inf --> -0.648390).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7352593
	speed: 1.9204s/iter; left time: 69965.5986s
	iters: 200, epoch: 2 | loss: 0.7970105
	speed: 0.6227s/iter; left time: 22624.2452s
	iters: 300, epoch: 2 | loss: 4.2180891
	speed: 0.6510s/iter; left time: 23585.6014s
Epoch: 2 cost time: 226.7218210697174
Epoch: 2, Steps: 369 | Train Loss: 5.399 Vali Loss: 4.288 Vali Acc: 0.642 Test Loss: 4.288 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 10.3049145
	speed: 1.9056s/iter; left time: 68723.2322s
	iters: 200, epoch: 3 | loss: 6.9406986
	speed: 0.6271s/iter; left time: 22551.6955s
	iters: 300, epoch: 3 | loss: 12.3521919
	speed: 0.5677s/iter; left time: 20359.7840s
Epoch: 3 cost time: 226.9658715724945
Epoch: 3, Steps: 369 | Train Loss: 7.561 Vali Loss: 11.111 Vali Acc: 0.505 Test Loss: 11.111 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.5542415
	speed: 1.9160s/iter; left time: 68388.8863s
	iters: 200, epoch: 4 | loss: 7.7146101
	speed: 0.5294s/iter; left time: 18842.2398s
	iters: 300, epoch: 4 | loss: 7.8132997
	speed: 0.5597s/iter; left time: 19864.2287s
Epoch: 4 cost time: 221.91725516319275
Epoch: 4, Steps: 369 | Train Loss: 8.744 Vali Loss: 10.263 Vali Acc: 0.629 Test Loss: 10.263 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 13.6254053
	speed: 2.5088s/iter; left time: 88621.7226s
	iters: 200, epoch: 5 | loss: 0.1088441
	speed: 0.8096s/iter; left time: 28518.3224s
	iters: 300, epoch: 5 | loss: 7.3321362
	speed: 0.7825s/iter; left time: 27486.7322s
Epoch: 5 cost time: 292.47919392585754
Epoch: 5, Steps: 369 | Train Loss: 9.671 Vali Loss: 14.157 Vali Acc: 0.657 Test Loss: 14.157 Test Acc: 0.657
Validation loss decreased (-0.648390 --> -0.657350).  Saving model ...
	iters: 100, epoch: 6 | loss: 26.6523380
	speed: 2.3663s/iter; left time: 82714.7196s
	iters: 200, epoch: 6 | loss: 5.0267954
	speed: 0.8241s/iter; left time: 28724.8769s
	iters: 300, epoch: 6 | loss: 8.7762337
	speed: 0.8109s/iter; left time: 28184.7375s
Epoch: 6 cost time: 294.82224321365356
Epoch: 6, Steps: 369 | Train Loss: 9.988 Vali Loss: 13.427 Vali Acc: 0.645 Test Loss: 13.427 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 12.7901344
	speed: 2.5263s/iter; left time: 87377.9573s
	iters: 200, epoch: 7 | loss: 6.7400513
	speed: 0.7549s/iter; left time: 26032.8334s
	iters: 300, epoch: 7 | loss: 8.4774294
	speed: 0.7550s/iter; left time: 25961.9102s
Epoch: 7 cost time: 284.17140913009644
Epoch: 7, Steps: 369 | Train Loss: 9.024 Vali Loss: 14.672 Vali Acc: 0.631 Test Loss: 14.672 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 19.4179192
	speed: 2.4784s/iter; left time: 84804.9477s
	iters: 200, epoch: 8 | loss: 1.9230094
	speed: 0.8075s/iter; left time: 27549.7479s
	iters: 300, epoch: 8 | loss: 6.0046210
	speed: 0.8179s/iter; left time: 27822.2138s
Epoch: 8 cost time: 301.77118253707886
Epoch: 8, Steps: 369 | Train Loss: 8.498 Vali Loss: 12.005 Vali Acc: 0.646 Test Loss: 12.005 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 5.9019537
	speed: 2.4219s/iter; left time: 81978.0110s
	iters: 200, epoch: 9 | loss: 17.9535332
	speed: 0.7710s/iter; left time: 26019.2493s
	iters: 300, epoch: 9 | loss: 3.0189312
	speed: 0.7769s/iter; left time: 26140.3217s
Epoch: 9 cost time: 285.141881942749
Epoch: 9, Steps: 369 | Train Loss: 7.726 Vali Loss: 16.411 Vali Acc: 0.648 Test Loss: 16.411 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 7.9394326
	speed: 2.5339s/iter; left time: 84836.2173s
	iters: 200, epoch: 10 | loss: 3.3088374
	speed: 0.8212s/iter; left time: 27410.8505s
	iters: 300, epoch: 10 | loss: 15.3853035
	speed: 0.7822s/iter; left time: 26031.0319s
Epoch: 10 cost time: 295.0246613025665
Epoch: 10, Steps: 369 | Train Loss: 7.998 Vali Loss: 11.724 Vali Acc: 0.634 Test Loss: 11.724 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 5.6541328
	speed: 2.3821s/iter; left time: 78874.6166s
	iters: 200, epoch: 11 | loss: 5.8041573
	speed: 0.8166s/iter; left time: 26957.4412s
	iters: 300, epoch: 11 | loss: 12.8343010
	speed: 0.8053s/iter; left time: 26502.3617s
Epoch: 11 cost time: 295.1038329601288
Epoch: 11, Steps: 369 | Train Loss: 8.325 Vali Loss: 7.142 Vali Acc: 0.637 Test Loss: 7.142 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 6.2368670
	speed: 2.5241s/iter; left time: 82643.1511s
	iters: 200, epoch: 12 | loss: 6.9650636
	speed: 0.7588s/iter; left time: 24768.2922s
	iters: 300, epoch: 12 | loss: 14.9027672
	speed: 0.7716s/iter; left time: 25108.4027s
Epoch: 12 cost time: 284.40942549705505
Epoch: 12, Steps: 369 | Train Loss: 9.327 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 12.1355162
	speed: 2.4705s/iter; left time: 79976.2802s
	iters: 200, epoch: 13 | loss: 8.5063543
	speed: 0.8129s/iter; left time: 26233.5789s
	iters: 300, epoch: 13 | loss: 3.2723126
	speed: 0.8170s/iter; left time: 26284.8913s
Epoch: 13 cost time: 300.7954251766205
Epoch: 13, Steps: 369 | Train Loss: 6.322 Vali Loss: 1.963 Vali Acc: 0.628 Test Loss: 1.963 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 4.5887327
	speed: 2.4318s/iter; left time: 77827.5641s
	iters: 200, epoch: 14 | loss: 1.5156610
	speed: 0.7768s/iter; left time: 24782.2193s
	iters: 300, epoch: 14 | loss: 2.5869951
	speed: 0.7612s/iter; left time: 24209.6320s
Epoch: 14 cost time: 285.4389798641205
Epoch: 14, Steps: 369 | Train Loss: 2.631 Vali Loss: 0.727 Vali Acc: 0.503 Test Loss: 0.727 Test Acc: 0.503
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6394330
	speed: 2.5509s/iter; left time: 80698.8363s
	iters: 200, epoch: 15 | loss: 0.7487329
	speed: 0.8030s/iter; left time: 25324.0459s
	iters: 300, epoch: 15 | loss: 0.6863826
	speed: 0.7781s/iter; left time: 24461.0761s
Epoch: 15 cost time: 293.16328835487366
Epoch: 15, Steps: 369 | Train Loss: 0.948 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6574914869466515
model parameter : 2584834
model size : 12.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0660565
	speed: 0.3969s/iter; left time: 14606.4083s
	iters: 200, epoch: 1 | loss: 1.9180309
	speed: 0.3724s/iter; left time: 13668.1830s
	iters: 300, epoch: 1 | loss: 3.5689464
	speed: 0.3774s/iter; left time: 13814.2166s
Epoch: 1 cost time: 141.49130535125732
Epoch: 1, Steps: 369 | Train Loss: 2.113 Vali Loss: 1.781 Vali Acc: 0.637 Test Loss: 1.781 Test Acc: 0.637
Validation loss decreased (inf --> -0.637042).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7909573
	speed: 1.3836s/iter; left time: 50405.5201s
	iters: 200, epoch: 2 | loss: 5.0444484
	speed: 0.4172s/iter; left time: 15159.3376s
	iters: 300, epoch: 2 | loss: 3.3758378
	speed: 0.4192s/iter; left time: 15187.4024s
Epoch: 2 cost time: 155.11022400856018
Epoch: 2, Steps: 369 | Train Loss: 3.757 Vali Loss: 3.814 Vali Acc: 0.628 Test Loss: 3.814 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.2265344
	speed: 1.4598s/iter; left time: 52644.5786s
	iters: 200, epoch: 3 | loss: 5.2467470
	speed: 0.4368s/iter; left time: 15707.5347s
	iters: 300, epoch: 3 | loss: 4.1289568
	speed: 0.4281s/iter; left time: 15352.8676s
Epoch: 3 cost time: 159.8648715019226
Epoch: 3, Steps: 369 | Train Loss: 5.080 Vali Loss: 5.659 Vali Acc: 0.590 Test Loss: 5.659 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.6195264
	speed: 1.3966s/iter; left time: 49850.2539s
	iters: 200, epoch: 4 | loss: 2.4790998
	speed: 0.4050s/iter; left time: 14415.5839s
	iters: 300, epoch: 4 | loss: 3.2639496
	speed: 0.4071s/iter; left time: 14448.5570s
Epoch: 4 cost time: 150.5291931629181
Epoch: 4, Steps: 369 | Train Loss: 6.235 Vali Loss: 4.782 Vali Acc: 0.657 Test Loss: 4.782 Test Acc: 0.657
Validation loss decreased (-0.637042 --> -0.657160).  Saving model ...
	iters: 100, epoch: 5 | loss: 6.8113289
	speed: 1.3636s/iter; left time: 48170.5327s
	iters: 200, epoch: 5 | loss: 9.1574879
	speed: 0.3921s/iter; left time: 13811.8377s
	iters: 300, epoch: 5 | loss: 9.4967737
	speed: 0.3935s/iter; left time: 13820.7284s
Epoch: 5 cost time: 145.91900634765625
Epoch: 5, Steps: 369 | Train Loss: 7.223 Vali Loss: 10.089 Vali Acc: 0.653 Test Loss: 10.089 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 5.6554728
	speed: 1.3327s/iter; left time: 46587.4683s
	iters: 200, epoch: 6 | loss: 7.1958041
	speed: 0.4164s/iter; left time: 14513.4940s
	iters: 300, epoch: 6 | loss: 5.3217530
	speed: 0.4120s/iter; left time: 14318.5322s
Epoch: 6 cost time: 143.21091675758362
Epoch: 6, Steps: 369 | Train Loss: 7.683 Vali Loss: 7.767 Vali Acc: 0.645 Test Loss: 7.767 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 10.0736065
	speed: 1.1277s/iter; left time: 39002.1245s
	iters: 200, epoch: 7 | loss: 7.7932262
	speed: 0.3875s/iter; left time: 13363.3247s
	iters: 300, epoch: 7 | loss: 11.9755106
	speed: 0.3960s/iter; left time: 13617.1586s
Epoch: 7 cost time: 144.09927105903625
Epoch: 7, Steps: 369 | Train Loss: 7.268 Vali Loss: 10.969 Vali Acc: 0.647 Test Loss: 10.969 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.9538305
	speed: 1.3400s/iter; left time: 45853.4379s
	iters: 200, epoch: 8 | loss: 3.1810083
	speed: 0.3490s/iter; left time: 11908.2508s
	iters: 300, epoch: 8 | loss: 19.2066879
	speed: 0.3603s/iter; left time: 12257.5149s
Epoch: 8 cost time: 134.8065469264984
Epoch: 8, Steps: 369 | Train Loss: 6.734 Vali Loss: 9.844 Vali Acc: 0.667 Test Loss: 9.844 Test Acc: 0.667
Validation loss decreased (-0.657160 --> -0.667325).  Saving model ...
	iters: 100, epoch: 9 | loss: 6.9190421
	speed: 1.2140s/iter; left time: 41093.8109s
	iters: 200, epoch: 9 | loss: 11.0181046
	speed: 0.3627s/iter; left time: 12241.1223s
	iters: 300, epoch: 9 | loss: 9.6862383
	speed: 0.4026s/iter; left time: 13547.3229s
Epoch: 9 cost time: 140.9350962638855
Epoch: 9, Steps: 369 | Train Loss: 5.712 Vali Loss: 8.113 Vali Acc: 0.657 Test Loss: 8.113 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 4.9164205
	speed: 1.3858s/iter; left time: 46397.6597s
	iters: 200, epoch: 10 | loss: 9.1650000
	speed: 0.3981s/iter; left time: 13286.9713s
	iters: 300, epoch: 10 | loss: 1.5614526
	speed: 0.4043s/iter; left time: 13455.0037s
Epoch: 10 cost time: 149.97700238227844
Epoch: 10, Steps: 369 | Train Loss: 5.445 Vali Loss: 6.043 Vali Acc: 0.660 Test Loss: 6.043 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.5758460
	speed: 1.2685s/iter; left time: 42000.8162s
	iters: 200, epoch: 11 | loss: 2.4341934
	speed: 0.3520s/iter; left time: 11619.6324s
	iters: 300, epoch: 11 | loss: 1.9883003
	speed: 0.3502s/iter; left time: 11524.4524s
Epoch: 11 cost time: 131.00207233428955
Epoch: 11, Steps: 369 | Train Loss: 4.585 Vali Loss: 6.652 Vali Acc: 0.663 Test Loss: 6.652 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.7542181
	speed: 1.2755s/iter; left time: 41763.4995s
	iters: 200, epoch: 12 | loss: 2.1001523
	speed: 0.4062s/iter; left time: 13257.6502s
	iters: 300, epoch: 12 | loss: 4.1615195
	speed: 0.4172s/iter; left time: 13574.9774s
Epoch: 12 cost time: 151.58855438232422
Epoch: 12, Steps: 369 | Train Loss: 3.107 Vali Loss: 4.322 Vali Acc: 0.645 Test Loss: 4.322 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.7394612
	speed: 1.4283s/iter; left time: 46239.2386s
	iters: 200, epoch: 13 | loss: 2.4340551
	speed: 0.3763s/iter; left time: 12144.9483s
	iters: 300, epoch: 13 | loss: 2.2217517
	speed: 0.3604s/iter; left time: 11594.7156s
Epoch: 13 cost time: 141.14662790298462
Epoch: 13, Steps: 369 | Train Loss: 1.948 Vali Loss: 2.724 Vali Acc: 0.645 Test Loss: 2.724 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.4784602
	speed: 1.2255s/iter; left time: 39219.4433s
	iters: 200, epoch: 14 | loss: 1.4404141
	speed: 0.3487s/iter; left time: 11123.8691s
	iters: 300, epoch: 14 | loss: 0.4497325
	speed: 0.3678s/iter; left time: 11698.5786s
Epoch: 14 cost time: 135.58561825752258
Epoch: 14, Steps: 369 | Train Loss: 0.869 Vali Loss: 1.280 Vali Acc: 0.646 Test Loss: 1.280 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3860417
	speed: 1.3797s/iter; left time: 43647.4487s
	iters: 200, epoch: 15 | loss: 0.4450831
	speed: 0.4085s/iter; left time: 12881.2189s
	iters: 300, epoch: 15 | loss: 0.3252575
	speed: 0.4081s/iter; left time: 12828.6212s
Epoch: 15 cost time: 151.25166988372803
Epoch: 15, Steps: 369 | Train Loss: 0.437 Vali Loss: 1.218 Vali Acc: 0.648 Test Loss: 1.218 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3284060
	speed: 1.3364s/iter; left time: 41783.6056s
	iters: 200, epoch: 16 | loss: 0.4096985
	speed: 0.3800s/iter; left time: 11842.5199s
	iters: 300, epoch: 16 | loss: 0.1970440
	speed: 0.3697s/iter; left time: 11484.8415s
Epoch: 16 cost time: 137.76993465423584
Epoch: 16, Steps: 369 | Train Loss: 0.381 Vali Loss: 1.036 Vali Acc: 0.648 Test Loss: 1.036 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0759732
	speed: 1.2443s/iter; left time: 38445.6599s
	iters: 200, epoch: 17 | loss: 0.1915777
	speed: 0.3900s/iter; left time: 12009.3589s
	iters: 300, epoch: 17 | loss: 0.3160174
	speed: 0.4029s/iter; left time: 12366.5366s
Epoch: 17 cost time: 146.7877869606018
Epoch: 17, Steps: 369 | Train Loss: 0.354 Vali Loss: 1.035 Vali Acc: 0.648 Test Loss: 1.035 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2545331
	speed: 1.4164s/iter; left time: 43240.2394s
	iters: 200, epoch: 18 | loss: 0.3871966
	speed: 0.4090s/iter; left time: 12444.1726s
	iters: 300, epoch: 18 | loss: 0.2607110
	speed: 0.3612s/iter; left time: 10955.6583s
Epoch: 18 cost time: 143.47758603096008
Epoch: 18, Steps: 369 | Train Loss: 0.339 Vali Loss: 1.023 Vali Acc: 0.643 Test Loss: 1.023 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6674233825198638
model parameter : 1442306
model size : 7.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.4353135
	speed: 0.3022s/iter; left time: 11122.3142s
	iters: 200, epoch: 1 | loss: 1.1365016
	speed: 0.2824s/iter; left time: 10362.6113s
	iters: 300, epoch: 1 | loss: 2.8447306
	speed: 0.2860s/iter; left time: 10467.6394s
Epoch: 1 cost time: 107.09763836860657
Epoch: 1, Steps: 369 | Train Loss: 1.867 Vali Loss: 1.083 Vali Acc: 0.634 Test Loss: 1.083 Test Acc: 0.634
Validation loss decreased (inf --> -0.634212).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.0377789
	speed: 0.9679s/iter; left time: 35264.1668s
	iters: 200, epoch: 2 | loss: 3.0917835
	speed: 0.2863s/iter; left time: 10402.8799s
	iters: 300, epoch: 2 | loss: 7.8531604
	speed: 0.2867s/iter; left time: 10388.6987s
Epoch: 2 cost time: 103.87351107597351
Epoch: 2, Steps: 369 | Train Loss: 3.135 Vali Loss: 4.610 Vali Acc: 0.539 Test Loss: 4.610 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.3912220
	speed: 0.8580s/iter; left time: 30942.5148s
	iters: 200, epoch: 3 | loss: 2.6558459
	speed: 0.2572s/iter; left time: 9249.0906s
	iters: 300, epoch: 3 | loss: 7.5079160
	speed: 0.2532s/iter; left time: 9082.0662s
Epoch: 3 cost time: 95.83264970779419
Epoch: 3, Steps: 369 | Train Loss: 4.324 Vali Loss: 3.976 Vali Acc: 0.659 Test Loss: 3.976 Test Acc: 0.659
Validation loss decreased (-0.634212 --> -0.659154).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.3630638
	speed: 0.8820s/iter; left time: 31482.9601s
	iters: 200, epoch: 4 | loss: 12.0409431
	speed: 0.2741s/iter; left time: 9756.8329s
	iters: 300, epoch: 4 | loss: 2.5731993
	speed: 0.2891s/iter; left time: 10260.6270s
Epoch: 4 cost time: 102.75229573249817
Epoch: 4, Steps: 369 | Train Loss: 5.169 Vali Loss: 6.240 Vali Acc: 0.622 Test Loss: 6.240 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 6.2923975
	speed: 0.9743s/iter; left time: 34418.8393s
	iters: 200, epoch: 5 | loss: 12.3514929
	speed: 0.2917s/iter; left time: 10275.3057s
	iters: 300, epoch: 5 | loss: 11.9197283
	speed: 0.2955s/iter; left time: 10380.1934s
Epoch: 5 cost time: 108.7887053489685
Epoch: 5, Steps: 369 | Train Loss: 5.885 Vali Loss: 5.071 Vali Acc: 0.656 Test Loss: 5.071 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1817782
	speed: 0.9570s/iter; left time: 33451.9925s
	iters: 200, epoch: 6 | loss: 6.1104131
	speed: 0.2609s/iter; left time: 9094.3557s
	iters: 300, epoch: 6 | loss: 2.7544763
	speed: 0.2594s/iter; left time: 9014.7393s
Epoch: 6 cost time: 98.54057288169861
Epoch: 6, Steps: 369 | Train Loss: 6.170 Vali Loss: 7.275 Vali Acc: 0.612 Test Loss: 7.275 Test Acc: 0.612
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 7.2647223
	speed: 0.8757s/iter; left time: 30286.1261s
	iters: 200, epoch: 7 | loss: 4.0188770
	speed: 0.2606s/iter; left time: 8985.6526s
	iters: 300, epoch: 7 | loss: 3.2301631
	speed: 0.2537s/iter; left time: 8725.5688s
Epoch: 7 cost time: 95.92142510414124
Epoch: 7, Steps: 369 | Train Loss: 5.812 Vali Loss: 5.934 Vali Acc: 0.654 Test Loss: 5.934 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 6.7467480
	speed: 0.9240s/iter; left time: 31618.1216s
	iters: 200, epoch: 8 | loss: 6.2495041
	speed: 0.2905s/iter; left time: 9910.8496s
	iters: 300, epoch: 8 | loss: 6.0298996
	speed: 0.2932s/iter; left time: 9973.6289s
Epoch: 8 cost time: 108.69944047927856
Epoch: 8, Steps: 369 | Train Loss: 5.691 Vali Loss: 7.546 Vali Acc: 0.660 Test Loss: 7.546 Test Acc: 0.660
Validation loss decreased (-0.659154 --> -0.660254).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4822433
	speed: 1.0106s/iter; left time: 34207.2977s
	iters: 200, epoch: 9 | loss: 2.9101832
	speed: 0.3022s/iter; left time: 10199.0649s
	iters: 300, epoch: 9 | loss: 4.1110392
	speed: 0.3001s/iter; left time: 10096.4281s
Epoch: 9 cost time: 111.66198539733887
Epoch: 9, Steps: 369 | Train Loss: 5.867 Vali Loss: 4.113 Vali Acc: 0.642 Test Loss: 4.113 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7190751
	speed: 0.8923s/iter; left time: 29875.3072s
	iters: 200, epoch: 10 | loss: 7.6107101
	speed: 0.2475s/iter; left time: 8260.9420s
	iters: 300, epoch: 10 | loss: 4.7313833
	speed: 0.2473s/iter; left time: 8231.4527s
Epoch: 10 cost time: 91.75200986862183
Epoch: 10, Steps: 369 | Train Loss: 4.857 Vali Loss: 6.767 Vali Acc: 0.642 Test Loss: 6.767 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 7.5320640
	speed: 0.8652s/iter; left time: 28647.8708s
	iters: 200, epoch: 11 | loss: 2.0913956
	speed: 0.2625s/iter; left time: 8664.8781s
	iters: 300, epoch: 11 | loss: 2.3635788
	speed: 0.2756s/iter; left time: 9069.1650s
Epoch: 11 cost time: 101.56624126434326
Epoch: 11, Steps: 369 | Train Loss: 3.637 Vali Loss: 2.744 Vali Acc: 0.638 Test Loss: 2.744 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.9006504
	speed: 1.0100s/iter; left time: 33069.3433s
	iters: 200, epoch: 12 | loss: 0.6622722
	speed: 0.2908s/iter; left time: 9492.1015s
	iters: 300, epoch: 12 | loss: 2.7454908
	speed: 0.2947s/iter; left time: 9591.0577s
Epoch: 12 cost time: 109.39141130447388
Epoch: 12, Steps: 369 | Train Loss: 2.140 Vali Loss: 1.859 Vali Acc: 0.644 Test Loss: 1.859 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.9081151
	speed: 1.0008s/iter; left time: 32400.0673s
	iters: 200, epoch: 13 | loss: 1.7197930
	speed: 0.2826s/iter; left time: 9121.0513s
	iters: 300, epoch: 13 | loss: 0.5619473
	speed: 0.2641s/iter; left time: 8495.8487s
Epoch: 13 cost time: 102.96140241622925
Epoch: 13, Steps: 369 | Train Loss: 1.070 Vali Loss: 1.119 Vali Acc: 0.649 Test Loss: 1.119 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.4183878
	speed: 0.8756s/iter; left time: 28022.4258s
	iters: 200, epoch: 14 | loss: 0.3895806
	speed: 0.2575s/iter; left time: 8215.1350s
	iters: 300, epoch: 14 | loss: 0.6774096
	speed: 0.2598s/iter; left time: 8262.4645s
Epoch: 14 cost time: 95.12240958213806
Epoch: 14, Steps: 369 | Train Loss: 0.512 Vali Loss: 0.833 Vali Acc: 0.670 Test Loss: 0.833 Test Acc: 0.670
Validation loss decreased (-0.660254 --> -0.669685).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4549581
	speed: 0.8971s/iter; left time: 28379.5402s
	iters: 200, epoch: 15 | loss: 0.1900820
	speed: 0.2875s/iter; left time: 9067.8743s
	iters: 300, epoch: 15 | loss: 0.2753316
	speed: 0.2878s/iter; left time: 9047.5867s
Epoch: 15 cost time: 107.16779375076294
Epoch: 15, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.733 Vali Acc: 0.660 Test Loss: 0.733 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4825619
	speed: 1.0098s/iter; left time: 31571.6635s
	iters: 200, epoch: 16 | loss: 0.3353171
	speed: 0.3016s/iter; left time: 9400.3462s
	iters: 300, epoch: 16 | loss: 0.5444149
	speed: 0.3017s/iter; left time: 9371.9698s
Epoch: 16 cost time: 112.25271487236023
Epoch: 16, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.727 Vali Acc: 0.644 Test Loss: 0.727 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4120109
	speed: 0.9403s/iter; left time: 29052.9110s
	iters: 200, epoch: 17 | loss: 0.2325568
	speed: 0.2546s/iter; left time: 7840.0496s
	iters: 300, epoch: 17 | loss: 0.7759016
	speed: 0.2529s/iter; left time: 7762.9672s
Epoch: 17 cost time: 94.86354398727417
Epoch: 17, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.823 Vali Acc: 0.635 Test Loss: 0.823 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6869509
	speed: 0.8728s/iter; left time: 26645.2522s
	iters: 200, epoch: 18 | loss: 0.3391877
	speed: 0.2576s/iter; left time: 7837.2796s
	iters: 300, epoch: 18 | loss: 0.3662534
	speed: 0.2570s/iter; left time: 7792.8163s
Epoch: 18 cost time: 97.88125658035278
Epoch: 18, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.883 Vali Acc: 0.658 Test Loss: 0.883 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2789454
	speed: 0.9810s/iter; left time: 29586.7461s
	iters: 200, epoch: 19 | loss: 0.2461274
	speed: 0.2897s/iter; left time: 8708.7124s
	iters: 300, epoch: 19 | loss: 0.2676016
	speed: 0.2863s/iter; left time: 8578.6561s
Epoch: 19 cost time: 107.78060817718506
Epoch: 19, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.989 Vali Acc: 0.643 Test Loss: 0.989 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6962296
	speed: 0.9948s/iter; left time: 29635.8947s
	iters: 200, epoch: 20 | loss: 0.1090810
	speed: 0.2935s/iter; left time: 8714.7521s
	iters: 300, epoch: 20 | loss: 0.2705275
	speed: 0.2754s/iter; left time: 8149.9973s
Epoch: 20 cost time: 105.37585139274597
Epoch: 20, Steps: 369 | Train Loss: 0.327 Vali Loss: 1.014 Vali Acc: 0.639 Test Loss: 1.014 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2618101
	speed: 0.8755s/iter; left time: 25758.2907s
	iters: 200, epoch: 21 | loss: 0.3109375
	speed: 0.2393s/iter; left time: 7015.5317s
	iters: 300, epoch: 21 | loss: 0.6660805
	speed: 0.2483s/iter; left time: 7256.5218s
Epoch: 21 cost time: 91.95390510559082
Epoch: 21, Steps: 369 | Train Loss: 0.294 Vali Loss: 1.056 Vali Acc: 0.648 Test Loss: 1.056 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.4696465
	speed: 0.8644s/iter; left time: 25111.6807s
	iters: 200, epoch: 22 | loss: 0.3516146
	speed: 0.2770s/iter; left time: 8018.7199s
	iters: 300, epoch: 22 | loss: 0.3276696
	speed: 0.2789s/iter; left time: 8046.3119s
Epoch: 22 cost time: 101.23729062080383
Epoch: 22, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.125 Vali Acc: 0.637 Test Loss: 1.125 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1545590
	speed: 0.9743s/iter; left time: 27944.7196s
	iters: 200, epoch: 23 | loss: 0.2137087
	speed: 0.2873s/iter; left time: 8210.6000s
	iters: 300, epoch: 23 | loss: 0.1849294
	speed: 0.2921s/iter; left time: 8320.1259s
Epoch: 23 cost time: 107.96304154396057
Epoch: 23, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.183 Vali Acc: 0.649 Test Loss: 1.183 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0738049
	speed: 0.9462s/iter; left time: 26791.9036s
	iters: 200, epoch: 24 | loss: 0.2145279
	speed: 0.2454s/iter; left time: 6923.5948s
	iters: 300, epoch: 24 | loss: 0.2013590
	speed: 0.2546s/iter; left time: 7156.5142s
Epoch: 24 cost time: 93.49889612197876
Epoch: 24, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.463 Vali Acc: 0.633 Test Loss: 1.463 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6696935300794552
model parameter : 1073794
model size : 6.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.9965787
	speed: 0.2273s/iter; left time: 8365.8911s
	iters: 200, epoch: 1 | loss: 1.4789932
	speed: 0.2100s/iter; left time: 7707.8982s
	iters: 300, epoch: 1 | loss: 1.4951053
	speed: 0.2135s/iter; left time: 7816.1345s
Epoch: 1 cost time: 79.95480251312256
Epoch: 1, Steps: 369 | Train Loss: 1.510 Vali Loss: 1.197 Vali Acc: 0.589 Test Loss: 1.197 Test Acc: 0.589
Validation loss decreased (inf --> -0.588524).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3775969
	speed: 0.7251s/iter; left time: 26415.9987s
	iters: 200, epoch: 2 | loss: 0.6258824
	speed: 0.2127s/iter; left time: 7729.1670s
	iters: 300, epoch: 2 | loss: 2.4921370
	speed: 0.2109s/iter; left time: 7642.2346s
Epoch: 2 cost time: 79.06770968437195
Epoch: 2, Steps: 369 | Train Loss: 2.542 Vali Loss: 2.191 Vali Acc: 0.647 Test Loss: 2.191 Test Acc: 0.647
Validation loss decreased (-0.588524 --> -0.646970).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1709034
	speed: 0.6978s/iter; left time: 25163.1140s
	iters: 200, epoch: 3 | loss: 0.2640587
	speed: 0.1846s/iter; left time: 6637.2691s
	iters: 300, epoch: 3 | loss: 5.0856905
	speed: 0.1830s/iter; left time: 6563.2273s
Epoch: 3 cost time: 69.09532165527344
Epoch: 3, Steps: 369 | Train Loss: 3.565 Vali Loss: 4.047 Vali Acc: 0.651 Test Loss: 4.047 Test Acc: 0.651
Validation loss decreased (-0.646970 --> -0.650641).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2716188
	speed: 0.6460s/iter; left time: 23059.2505s
	iters: 200, epoch: 4 | loss: 5.0055199
	speed: 0.1950s/iter; left time: 6940.7036s
	iters: 300, epoch: 4 | loss: 6.0037293
	speed: 0.1914s/iter; left time: 6792.8083s
Epoch: 4 cost time: 71.89758062362671
Epoch: 4, Steps: 369 | Train Loss: 4.388 Vali Loss: 5.175 Vali Acc: 0.602 Test Loss: 5.175 Test Acc: 0.602
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.4992919
	speed: 0.6400s/iter; left time: 22608.1221s
	iters: 200, epoch: 5 | loss: 5.7562275
	speed: 0.1953s/iter; left time: 6879.3923s
	iters: 300, epoch: 5 | loss: 4.8207035
	speed: 0.2204s/iter; left time: 7741.3244s
Epoch: 5 cost time: 76.29425978660583
Epoch: 5, Steps: 369 | Train Loss: 4.657 Vali Loss: 8.320 Vali Acc: 0.572 Test Loss: 8.320 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3056874
	speed: 0.7430s/iter; left time: 25972.8290s
	iters: 200, epoch: 6 | loss: 8.2660713
	speed: 0.2193s/iter; left time: 7644.2882s
	iters: 300, epoch: 6 | loss: 2.5209227
	speed: 0.2185s/iter; left time: 7595.8238s
Epoch: 6 cost time: 81.30281496047974
Epoch: 6, Steps: 369 | Train Loss: 4.890 Vali Loss: 4.707 Vali Acc: 0.659 Test Loss: 4.707 Test Acc: 0.659
Validation loss decreased (-0.650641 --> -0.659431).  Saving model ...
	iters: 100, epoch: 7 | loss: 10.5926991
	speed: 0.7354s/iter; left time: 25435.9965s
	iters: 200, epoch: 7 | loss: 8.2979345
	speed: 0.2200s/iter; left time: 7586.9478s
	iters: 300, epoch: 7 | loss: 2.9289021
	speed: 0.2201s/iter; left time: 7568.8925s
Epoch: 7 cost time: 81.70457243919373
Epoch: 7, Steps: 369 | Train Loss: 5.150 Vali Loss: 11.066 Vali Acc: 0.602 Test Loss: 11.066 Test Acc: 0.602
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.6482511
	speed: 0.6754s/iter; left time: 23110.6112s
	iters: 200, epoch: 8 | loss: 2.0788665
	speed: 0.1885s/iter; left time: 6430.1726s
	iters: 300, epoch: 8 | loss: 3.3258677
	speed: 0.1899s/iter; left time: 6459.2733s
Epoch: 8 cost time: 71.01371908187866
Epoch: 8, Steps: 369 | Train Loss: 5.083 Vali Loss: 6.636 Vali Acc: 0.626 Test Loss: 6.636 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 4.2938499
	speed: 0.6285s/iter; left time: 21272.7469s
	iters: 200, epoch: 9 | loss: 4.1963520
	speed: 0.1812s/iter; left time: 6116.9025s
	iters: 300, epoch: 9 | loss: 0.4223598
	speed: 0.1812s/iter; left time: 6097.4690s
Epoch: 9 cost time: 68.0136239528656
Epoch: 9, Steps: 369 | Train Loss: 4.701 Vali Loss: 3.959 Vali Acc: 0.623 Test Loss: 3.959 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.2962651
	speed: 0.6442s/iter; left time: 21568.0469s
	iters: 200, epoch: 10 | loss: 4.2020702
	speed: 0.2079s/iter; left time: 6939.2667s
	iters: 300, epoch: 10 | loss: 2.2201283
	speed: 0.2118s/iter; left time: 7049.6077s
Epoch: 10 cost time: 78.86444878578186
Epoch: 10, Steps: 369 | Train Loss: 3.815 Vali Loss: 3.132 Vali Acc: 0.640 Test Loss: 3.132 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.1213012
	speed: 0.7309s/iter; left time: 24199.5635s
	iters: 200, epoch: 11 | loss: 1.6564748
	speed: 0.2173s/iter; left time: 7173.4949s
	iters: 300, epoch: 11 | loss: 2.3164964
	speed: 0.2176s/iter; left time: 7161.0257s
Epoch: 11 cost time: 80.88467502593994
Epoch: 11, Steps: 369 | Train Loss: 2.938 Vali Loss: 2.048 Vali Acc: 0.637 Test Loss: 2.048 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.7407060
	speed: 0.7363s/iter; left time: 24108.3591s
	iters: 200, epoch: 12 | loss: 2.7560475
	speed: 0.2147s/iter; left time: 7009.4322s
	iters: 300, epoch: 12 | loss: 1.7374098
	speed: 0.2036s/iter; left time: 6624.7072s
Epoch: 12 cost time: 77.1819314956665
Epoch: 12, Steps: 369 | Train Loss: 1.872 Vali Loss: 1.597 Vali Acc: 0.658 Test Loss: 1.597 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3988139
	speed: 0.6360s/iter; left time: 20588.9460s
	iters: 200, epoch: 13 | loss: 0.7558517
	speed: 0.1913s/iter; left time: 6174.0782s
	iters: 300, epoch: 13 | loss: 0.8411437
	speed: 0.1866s/iter; left time: 6002.3120s
Epoch: 13 cost time: 69.3752646446228
Epoch: 13, Steps: 369 | Train Loss: 0.990 Vali Loss: 0.938 Vali Acc: 0.653 Test Loss: 0.938 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9545968
	speed: 0.6316s/iter; left time: 20212.2544s
	iters: 200, epoch: 14 | loss: 0.5728991
	speed: 0.1938s/iter; left time: 6183.3855s
	iters: 300, epoch: 14 | loss: 0.5969814
	speed: 0.1916s/iter; left time: 6093.7034s
Epoch: 14 cost time: 71.54761958122253
Epoch: 14, Steps: 369 | Train Loss: 0.501 Vali Loss: 0.763 Vali Acc: 0.670 Test Loss: 0.763 Test Acc: 0.670
Validation loss decreased (-0.659431 --> -0.669970).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5067360
	speed: 0.6458s/iter; left time: 20429.2026s
	iters: 200, epoch: 15 | loss: 0.5435392
	speed: 0.2170s/iter; left time: 6843.8787s
	iters: 300, epoch: 15 | loss: 0.6052740
	speed: 0.2174s/iter; left time: 6832.7211s
Epoch: 15 cost time: 80.35547184944153
Epoch: 15, Steps: 369 | Train Loss: 0.437 Vali Loss: 0.783 Vali Acc: 0.648 Test Loss: 0.783 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5138239
	speed: 0.5064s/iter; left time: 15833.9289s
	iters: 200, epoch: 16 | loss: 0.6778288
	speed: 0.1122s/iter; left time: 3495.5026s
	iters: 300, epoch: 16 | loss: 0.6301998
	speed: 0.1120s/iter; left time: 3478.4275s
Epoch: 16 cost time: 47.91765642166138
Epoch: 16, Steps: 369 | Train Loss: 0.416 Vali Loss: 0.835 Vali Acc: 0.669 Test Loss: 0.835 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1694803
	speed: 0.7008s/iter; left time: 21653.2603s
	iters: 200, epoch: 17 | loss: 0.3748139
	speed: 0.2089s/iter; left time: 6432.0385s
	iters: 300, epoch: 17 | loss: 0.4118232
	speed: 0.2126s/iter; left time: 6524.6909s
Epoch: 17 cost time: 78.22412919998169
Epoch: 17, Steps: 369 | Train Loss: 0.400 Vali Loss: 0.902 Vali Acc: 0.645 Test Loss: 0.902 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4715155
	speed: 0.7240s/iter; left time: 22103.5780s
	iters: 200, epoch: 18 | loss: 0.2517678
	speed: 0.1954s/iter; left time: 5944.4402s
	iters: 300, epoch: 18 | loss: 0.2832352
	speed: 0.1762s/iter; left time: 5342.3286s
Epoch: 18 cost time: 71.24227142333984
Epoch: 18, Steps: 369 | Train Loss: 0.390 Vali Loss: 0.812 Vali Acc: 0.650 Test Loss: 0.812 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5215250
	speed: 0.6020s/iter; left time: 18154.9465s
	iters: 200, epoch: 19 | loss: 0.5068660
	speed: 0.1668s/iter; left time: 5012.9409s
	iters: 300, epoch: 19 | loss: 0.1364402
	speed: 0.1681s/iter; left time: 5035.6740s
Epoch: 19 cost time: 62.428868532180786
Epoch: 19, Steps: 369 | Train Loss: 0.370 Vali Loss: 0.786 Vali Acc: 0.654 Test Loss: 0.786 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1760747
	speed: 0.6383s/iter; left time: 19015.0589s
	iters: 200, epoch: 20 | loss: 0.2087470
	speed: 0.2013s/iter; left time: 5975.9963s
	iters: 300, epoch: 20 | loss: 0.5715771
	speed: 0.2016s/iter; left time: 5964.0771s
Epoch: 20 cost time: 75.44289231300354
Epoch: 20, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.928 Vali Acc: 0.646 Test Loss: 0.928 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2641587
	speed: 0.7123s/iter; left time: 20955.2370s
	iters: 200, epoch: 21 | loss: 0.3820388
	speed: 0.2096s/iter; left time: 6144.8960s
	iters: 300, epoch: 21 | loss: 0.1257542
	speed: 0.2106s/iter; left time: 6152.9386s
Epoch: 21 cost time: 76.68490171432495
Epoch: 21, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.929 Vali Acc: 0.643 Test Loss: 0.929 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2057185
	speed: 0.6228s/iter; left time: 18093.7180s
	iters: 200, epoch: 22 | loss: 0.5138547
	speed: 0.1775s/iter; left time: 5139.1241s
	iters: 300, epoch: 22 | loss: 0.2840747
	speed: 0.1700s/iter; left time: 4905.9085s
Epoch: 22 cost time: 65.07466721534729
Epoch: 22, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.987 Vali Acc: 0.633 Test Loss: 0.987 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2209182
	speed: 0.5793s/iter; left time: 16614.7287s
	iters: 200, epoch: 23 | loss: 0.4401649
	speed: 0.1935s/iter; left time: 5531.6714s
	iters: 300, epoch: 23 | loss: 0.2447160
	speed: 0.1947s/iter; left time: 5545.0419s
Epoch: 23 cost time: 69.33963775634766
Epoch: 23, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.960 Vali Acc: 0.650 Test Loss: 0.960 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.3018084
	speed: 0.6838s/iter; left time: 19360.0471s
	iters: 200, epoch: 24 | loss: 0.3714691
	speed: 0.2045s/iter; left time: 5769.0019s
	iters: 300, epoch: 24 | loss: 0.0900869
	speed: 0.2086s/iter; left time: 5864.7254s
Epoch: 24 cost time: 76.52123856544495
Epoch: 24, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.953 Vali Acc: 0.644 Test Loss: 0.953 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6699772985244041
model parameter : 852866
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3543618
	speed: 0.1692s/iter; left time: 6226.9183s
	iters: 200, epoch: 1 | loss: 1.2457151
	speed: 0.1540s/iter; left time: 5651.6241s
	iters: 300, epoch: 1 | loss: 2.0381720
	speed: 0.1515s/iter; left time: 5544.9289s
Epoch: 1 cost time: 60.077160120010376
Epoch: 1, Steps: 369 | Train Loss: 1.422 Vali Loss: 1.109 Vali Acc: 0.638 Test Loss: 1.109 Test Acc: 0.638
Validation loss decreased (inf --> -0.637900).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4099104
	speed: 0.6230s/iter; left time: 22695.8564s
	iters: 200, epoch: 2 | loss: 2.1014707
	speed: 0.1797s/iter; left time: 6528.8783s
	iters: 300, epoch: 2 | loss: 2.5358605
	speed: 0.1797s/iter; left time: 6511.5835s
Epoch: 2 cost time: 67.11107015609741
Epoch: 2, Steps: 369 | Train Loss: 2.355 Vali Loss: 2.081 Vali Acc: 0.656 Test Loss: 2.081 Test Acc: 0.656
Validation loss decreased (-0.637900 --> -0.656052).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0469272
	speed: 0.6272s/iter; left time: 22617.4163s
	iters: 200, epoch: 3 | loss: 3.7859912
	speed: 0.1845s/iter; left time: 6633.4504s
	iters: 300, epoch: 3 | loss: 3.1074657
	speed: 0.1654s/iter; left time: 5932.6590s
Epoch: 3 cost time: 64.19104433059692
Epoch: 3, Steps: 369 | Train Loss: 3.132 Vali Loss: 3.402 Vali Acc: 0.566 Test Loss: 3.402 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1146278
	speed: 0.5450s/iter; left time: 19451.9914s
	iters: 200, epoch: 4 | loss: 0.1701806
	speed: 0.1524s/iter; left time: 5422.7712s
	iters: 300, epoch: 4 | loss: 6.3957810
	speed: 0.1541s/iter; left time: 5469.4520s
Epoch: 4 cost time: 57.97739577293396
Epoch: 4, Steps: 369 | Train Loss: 3.815 Vali Loss: 3.441 Vali Acc: 0.663 Test Loss: 3.441 Test Acc: 0.663
Validation loss decreased (-0.656052 --> -0.662565).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2883563
	speed: 0.5439s/iter; left time: 19212.1636s
	iters: 200, epoch: 5 | loss: 3.1268525
	speed: 0.1745s/iter; left time: 6146.7183s
	iters: 300, epoch: 5 | loss: 7.5336142
	speed: 0.1841s/iter; left time: 6465.5242s
Epoch: 5 cost time: 64.5749204158783
Epoch: 5, Steps: 369 | Train Loss: 4.221 Vali Loss: 3.691 Vali Acc: 0.662 Test Loss: 3.691 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4561427
	speed: 0.6315s/iter; left time: 22074.1978s
	iters: 200, epoch: 6 | loss: 6.1089911
	speed: 0.1840s/iter; left time: 6414.6722s
	iters: 300, epoch: 6 | loss: 3.8977780
	speed: 0.1863s/iter; left time: 6475.0572s
Epoch: 6 cost time: 68.86864900588989
Epoch: 6, Steps: 369 | Train Loss: 4.261 Vali Loss: 3.172 Vali Acc: 0.659 Test Loss: 3.172 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.9161115
	speed: 0.6308s/iter; left time: 21816.1776s
	iters: 200, epoch: 7 | loss: 9.7948723
	speed: 0.1543s/iter; left time: 5320.6150s
	iters: 300, epoch: 7 | loss: 4.7369261
	speed: 0.1541s/iter; left time: 5299.8681s
Epoch: 7 cost time: 59.95401692390442
Epoch: 7, Steps: 369 | Train Loss: 4.360 Vali Loss: 4.655 Vali Acc: 0.621 Test Loss: 4.655 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 10.2087173
	speed: 0.5341s/iter; left time: 18274.1634s
	iters: 200, epoch: 8 | loss: 5.4354510
	speed: 0.1522s/iter; left time: 5193.1195s
	iters: 300, epoch: 8 | loss: 3.9294345
	speed: 0.1502s/iter; left time: 5110.3525s
Epoch: 8 cost time: 56.31669759750366
Epoch: 8, Steps: 369 | Train Loss: 4.010 Vali Loss: 4.007 Vali Acc: 0.644 Test Loss: 4.007 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 4.4317846
	speed: 0.5781s/iter; left time: 19568.9260s
	iters: 200, epoch: 9 | loss: 4.9146056
	speed: 0.1854s/iter; left time: 6256.5229s
	iters: 300, epoch: 9 | loss: 1.8799828
	speed: 0.1845s/iter; left time: 6209.2543s
Epoch: 9 cost time: 69.22819113731384
Epoch: 9, Steps: 369 | Train Loss: 3.863 Vali Loss: 2.707 Vali Acc: 0.647 Test Loss: 2.707 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.3584750
	speed: 0.6337s/iter; left time: 21216.5275s
	iters: 200, epoch: 10 | loss: 1.7751539
	speed: 0.1837s/iter; left time: 6131.5704s
	iters: 300, epoch: 10 | loss: 5.0551648
	speed: 0.1826s/iter; left time: 6075.2696s
Epoch: 10 cost time: 68.27676820755005
Epoch: 10, Steps: 369 | Train Loss: 3.507 Vali Loss: 6.066 Vali Acc: 0.572 Test Loss: 6.066 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.6652999
	speed: 0.5846s/iter; left time: 19355.9339s
	iters: 200, epoch: 11 | loss: 0.7603365
	speed: 0.1553s/iter; left time: 5125.0401s
	iters: 300, epoch: 11 | loss: 2.4380119
	speed: 0.1565s/iter; left time: 5151.2298s
Epoch: 11 cost time: 57.879037618637085
Epoch: 11, Steps: 369 | Train Loss: 2.685 Vali Loss: 3.027 Vali Acc: 0.625 Test Loss: 3.027 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 4.2363191
	speed: 0.5350s/iter; left time: 17517.8729s
	iters: 200, epoch: 12 | loss: 0.7037669
	speed: 0.1483s/iter; left time: 4839.6614s
	iters: 300, epoch: 12 | loss: 1.8645148
	speed: 0.1504s/iter; left time: 4892.8108s
Epoch: 12 cost time: 56.5662739276886
Epoch: 12, Steps: 369 | Train Loss: 1.953 Vali Loss: 2.082 Vali Acc: 0.659 Test Loss: 2.082 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3083818
	speed: 0.5975s/iter; left time: 19342.2272s
	iters: 200, epoch: 13 | loss: 1.1009617
	speed: 0.1807s/iter; left time: 5832.9186s
	iters: 300, epoch: 13 | loss: 0.3234007
	speed: 0.1805s/iter; left time: 5805.6377s
Epoch: 13 cost time: 67.43904256820679
Epoch: 13, Steps: 369 | Train Loss: 1.181 Vali Loss: 1.063 Vali Acc: 0.655 Test Loss: 1.063 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7301227
	speed: 0.6367s/iter; left time: 20376.9991s
	iters: 200, epoch: 14 | loss: 0.2525067
	speed: 0.1845s/iter; left time: 5884.7792s
	iters: 300, epoch: 14 | loss: 0.7882856
	speed: 0.1849s/iter; left time: 5879.3177s
Epoch: 14 cost time: 68.0544023513794
Epoch: 14, Steps: 369 | Train Loss: 0.538 Vali Loss: 0.784 Vali Acc: 0.652 Test Loss: 0.784 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6625993189557321
model parameter : 742658
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1685619
	speed: 0.1454s/iter; left time: 5349.0725s
	iters: 200, epoch: 1 | loss: 0.9480823
	speed: 0.1214s/iter; left time: 4456.3281s
	iters: 300, epoch: 1 | loss: 1.9037062
	speed: 0.1216s/iter; left time: 4448.8543s
Epoch: 1 cost time: 47.39910840988159
Epoch: 1, Steps: 369 | Train Loss: 1.246 Vali Loss: 1.053 Vali Acc: 0.655 Test Loss: 1.053 Test Acc: 0.655
Validation loss decreased (inf --> -0.655211).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0782061
	speed: 0.4798s/iter; left time: 17479.4757s
	iters: 200, epoch: 2 | loss: 2.7740467
	speed: 0.1515s/iter; left time: 5503.0059s
	iters: 300, epoch: 2 | loss: 1.3617963
	speed: 0.1527s/iter; left time: 5531.8882s
Epoch: 2 cost time: 56.93002247810364
Epoch: 2, Steps: 369 | Train Loss: 1.949 Vali Loss: 2.164 Vali Acc: 0.642 Test Loss: 2.164 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4663656
	speed: 0.5140s/iter; left time: 18538.0986s
	iters: 200, epoch: 3 | loss: 3.3984647
	speed: 0.1512s/iter; left time: 5436.0533s
	iters: 300, epoch: 3 | loss: 2.0090303
	speed: 0.1503s/iter; left time: 5390.3689s
Epoch: 3 cost time: 56.150315284729004
Epoch: 3, Steps: 369 | Train Loss: 2.747 Vali Loss: 1.913 Vali Acc: 0.640 Test Loss: 1.913 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0196302
	speed: 0.4769s/iter; left time: 17020.7760s
	iters: 200, epoch: 4 | loss: 1.7278578
	speed: 0.1192s/iter; left time: 4242.5078s
	iters: 300, epoch: 4 | loss: 2.0793512
	speed: 0.1231s/iter; left time: 4368.0147s
Epoch: 4 cost time: 44.9106342792511
Epoch: 4, Steps: 369 | Train Loss: 3.271 Vali Loss: 3.466 Vali Acc: 0.650 Test Loss: 3.466 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 5.3903413
	speed: 0.4170s/iter; left time: 14730.3967s
	iters: 200, epoch: 5 | loss: 2.8392735
	speed: 0.1260s/iter; left time: 4438.6294s
	iters: 300, epoch: 5 | loss: 2.1993704
	speed: 0.1265s/iter; left time: 4443.0355s
Epoch: 5 cost time: 46.67500948905945
Epoch: 5, Steps: 369 | Train Loss: 3.459 Vali Loss: 3.386 Vali Acc: 0.653 Test Loss: 3.386 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 9.0767870
	speed: 0.4200s/iter; left time: 14680.8027s
	iters: 200, epoch: 6 | loss: 0.4202963
	speed: 0.1506s/iter; left time: 5248.3447s
	iters: 300, epoch: 6 | loss: 3.9899457
	speed: 0.1498s/iter; left time: 5206.8058s
Epoch: 6 cost time: 53.33211851119995
Epoch: 6, Steps: 369 | Train Loss: 3.805 Vali Loss: 4.579 Vali Acc: 0.598 Test Loss: 4.579 Test Acc: 0.598
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.5889030
	speed: 0.5136s/iter; left time: 17764.0816s
	iters: 200, epoch: 7 | loss: 5.2872210
	speed: 0.1516s/iter; left time: 5229.0146s
	iters: 300, epoch: 7 | loss: 1.1106911
	speed: 0.1519s/iter; left time: 5223.1552s
Epoch: 7 cost time: 56.80764603614807
Epoch: 7, Steps: 369 | Train Loss: 3.638 Vali Loss: 3.146 Vali Acc: 0.609 Test Loss: 3.146 Test Acc: 0.609
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 5.0388641
	speed: 0.5165s/iter; left time: 17674.0368s
	iters: 200, epoch: 8 | loss: 0.2228915
	speed: 0.1535s/iter; left time: 5237.1256s
	iters: 300, epoch: 8 | loss: 9.5552015
	speed: 0.1357s/iter; left time: 4616.6341s
Epoch: 8 cost time: 53.50841784477234
Epoch: 8, Steps: 369 | Train Loss: 3.622 Vali Loss: 4.464 Vali Acc: 0.621 Test Loss: 4.464 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 7.8314791
	speed: 0.4300s/iter; left time: 14554.9726s
	iters: 200, epoch: 9 | loss: 6.2431998
	speed: 0.1205s/iter; left time: 4065.8529s
	iters: 300, epoch: 9 | loss: 1.0861477
	speed: 0.1219s/iter; left time: 4100.4867s
Epoch: 9 cost time: 44.791436195373535
Epoch: 9, Steps: 369 | Train Loss: 3.346 Vali Loss: 4.323 Vali Acc: 0.647 Test Loss: 4.323 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.5647266
	speed: 0.4098s/iter; left time: 13719.2270s
	iters: 200, epoch: 10 | loss: 2.6085222
	speed: 0.1238s/iter; left time: 4130.8708s
	iters: 300, epoch: 10 | loss: 2.7720349
	speed: 0.1235s/iter; left time: 4110.7443s
Epoch: 10 cost time: 45.71352028846741
Epoch: 10, Steps: 369 | Train Loss: 2.792 Vali Loss: 4.035 Vali Acc: 0.625 Test Loss: 4.035 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.0237355
	speed: 0.4951s/iter; left time: 16393.9081s
	iters: 200, epoch: 11 | loss: 1.5067079
	speed: 0.1485s/iter; left time: 4900.9039s
	iters: 300, epoch: 11 | loss: 1.1404412
	speed: 0.1486s/iter; left time: 4889.9255s
Epoch: 11 cost time: 56.00120425224304
Epoch: 11, Steps: 369 | Train Loss: 2.389 Vali Loss: 2.558 Vali Acc: 0.642 Test Loss: 2.558 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6552213393870602
model parameter : 632450
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7587172
	speed: 0.1294s/iter; left time: 4763.3981s
	iters: 200, epoch: 1 | loss: 0.7694587
	speed: 0.1062s/iter; left time: 3899.3754s
	iters: 300, epoch: 1 | loss: 0.8092213
	speed: 0.1057s/iter; left time: 3869.1414s
Epoch: 1 cost time: 41.518999099731445
Epoch: 1, Steps: 369 | Train Loss: 1.152 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (inf --> -0.600444).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8394115
	speed: 0.3851s/iter; left time: 14030.6939s
	iters: 200, epoch: 2 | loss: 2.1525917
	speed: 0.1282s/iter; left time: 4656.1354s
	iters: 300, epoch: 2 | loss: 1.5118464
	speed: 0.1281s/iter; left time: 4641.0890s
Epoch: 2 cost time: 46.22040271759033
Epoch: 2, Steps: 369 | Train Loss: 1.680 Vali Loss: 4.622 Vali Acc: 0.521 Test Loss: 4.622 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0225240
	speed: 0.4294s/iter; left time: 15485.6724s
	iters: 200, epoch: 3 | loss: 4.2920332
	speed: 0.1242s/iter; left time: 4466.9359s
	iters: 300, epoch: 3 | loss: 1.8499503
	speed: 0.1239s/iter; left time: 4444.3213s
Epoch: 3 cost time: 46.46530818939209
Epoch: 3, Steps: 369 | Train Loss: 2.335 Vali Loss: 3.522 Vali Acc: 0.650 Test Loss: 3.522 Test Acc: 0.650
Validation loss decreased (-0.600444 --> -0.649511).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9648728
	speed: 0.4231s/iter; left time: 15101.8500s
	iters: 200, epoch: 4 | loss: 4.9476075
	speed: 0.1234s/iter; left time: 4391.8493s
	iters: 300, epoch: 4 | loss: 1.5503901
	speed: 0.1260s/iter; left time: 4473.3173s
Epoch: 4 cost time: 46.52117204666138
Epoch: 4, Steps: 369 | Train Loss: 2.811 Vali Loss: 2.097 Vali Acc: 0.656 Test Loss: 2.097 Test Acc: 0.656
Validation loss decreased (-0.649511 --> -0.655484).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.6911592
	speed: 0.3927s/iter; left time: 13871.7836s
	iters: 200, epoch: 5 | loss: 3.1531157
	speed: 0.1085s/iter; left time: 3820.4671s
	iters: 300, epoch: 5 | loss: 4.7335134
	speed: 0.1078s/iter; left time: 3786.4359s
Epoch: 5 cost time: 40.34644865989685
Epoch: 5, Steps: 369 | Train Loss: 3.021 Vali Loss: 3.790 Vali Acc: 0.596 Test Loss: 3.790 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0090282
	speed: 0.3528s/iter; left time: 12332.0737s
	iters: 200, epoch: 6 | loss: 3.4169085
	speed: 0.1029s/iter; left time: 3587.4734s
	iters: 300, epoch: 6 | loss: 5.7379127
	speed: 0.1061s/iter; left time: 3687.8813s
Epoch: 6 cost time: 39.120238304138184
Epoch: 6, Steps: 369 | Train Loss: 3.216 Vali Loss: 3.772 Vali Acc: 0.655 Test Loss: 3.772 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.2782981
	speed: 0.3687s/iter; left time: 12750.7041s
	iters: 200, epoch: 7 | loss: 0.0050373
	speed: 0.1194s/iter; left time: 4116.0607s
	iters: 300, epoch: 7 | loss: 0.5373847
	speed: 0.1187s/iter; left time: 4082.7180s
Epoch: 7 cost time: 44.75169134140015
Epoch: 7, Steps: 369 | Train Loss: 3.190 Vali Loss: 2.812 Vali Acc: 0.643 Test Loss: 2.812 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1888254
	speed: 0.4117s/iter; left time: 14087.8423s
	iters: 200, epoch: 8 | loss: 2.3496459
	speed: 0.1195s/iter; left time: 4077.3035s
	iters: 300, epoch: 8 | loss: 1.2548347
	speed: 0.1208s/iter; left time: 4109.6472s
Epoch: 8 cost time: 44.978161096572876
Epoch: 8, Steps: 369 | Train Loss: 3.013 Vali Loss: 5.073 Vali Acc: 0.610 Test Loss: 5.073 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.6899941
	speed: 0.4166s/iter; left time: 14102.1390s
	iters: 200, epoch: 9 | loss: 2.3966920
	speed: 0.1213s/iter; left time: 4093.5927s
	iters: 300, epoch: 9 | loss: 0.8482331
	speed: 0.1222s/iter; left time: 4110.2292s
Epoch: 9 cost time: 45.531444787979126
Epoch: 9, Steps: 369 | Train Loss: 2.930 Vali Loss: 4.562 Vali Acc: 0.579 Test Loss: 4.562 Test Acc: 0.579
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.0104444
	speed: 0.3747s/iter; left time: 12544.6567s
	iters: 200, epoch: 10 | loss: 2.0611107
	speed: 0.1008s/iter; left time: 3364.5155s
	iters: 300, epoch: 10 | loss: 0.6198712
	speed: 0.1009s/iter; left time: 3358.5551s
Epoch: 10 cost time: 38.27972412109375
Epoch: 10, Steps: 369 | Train Loss: 2.582 Vali Loss: 2.133 Vali Acc: 0.664 Test Loss: 2.133 Test Acc: 0.664
Validation loss decreased (-0.655484 --> -0.663713).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.4519203
	speed: 0.3637s/iter; left time: 12042.8191s
	iters: 200, epoch: 11 | loss: 3.9365103
	speed: 0.1035s/iter; left time: 3416.7179s
	iters: 300, epoch: 11 | loss: 2.5222352
	speed: 0.1047s/iter; left time: 3446.6402s
Epoch: 11 cost time: 39.25089478492737
Epoch: 11, Steps: 369 | Train Loss: 2.203 Vali Loss: 2.431 Vali Acc: 0.633 Test Loss: 2.431 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0662215
	speed: 0.4072s/iter; left time: 13331.1198s
	iters: 200, epoch: 12 | loss: 0.9324727
	speed: 0.1261s/iter; left time: 4114.6464s
	iters: 300, epoch: 12 | loss: 1.4531844
	speed: 0.1245s/iter; left time: 4050.1680s
Epoch: 12 cost time: 47.31895995140076
Epoch: 12, Steps: 369 | Train Loss: 1.574 Vali Loss: 1.679 Vali Acc: 0.644 Test Loss: 1.679 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.0447769
	speed: 0.4547s/iter; left time: 14720.2137s
	iters: 200, epoch: 13 | loss: 0.8948410
	speed: 0.1263s/iter; left time: 4077.5885s
	iters: 300, epoch: 13 | loss: 0.2022225
	speed: 0.1254s/iter; left time: 4033.6035s
Epoch: 13 cost time: 47.36465406417847
Epoch: 13, Steps: 369 | Train Loss: 1.036 Vali Loss: 1.002 Vali Acc: 0.634 Test Loss: 1.002 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4000557
	speed: 0.4558s/iter; left time: 14588.9687s
	iters: 200, epoch: 14 | loss: 0.5389533
	speed: 0.1276s/iter; left time: 4071.8251s
	iters: 300, epoch: 14 | loss: 0.8716655
	speed: 0.1152s/iter; left time: 3664.8534s
Epoch: 14 cost time: 45.312389612197876
Epoch: 14, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.773 Vali Acc: 0.654 Test Loss: 0.773 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6347360
	speed: 0.3906s/iter; left time: 12356.6382s
	iters: 200, epoch: 15 | loss: 0.2993612
	speed: 0.1090s/iter; left time: 3438.5330s
	iters: 300, epoch: 15 | loss: 0.7045385
	speed: 0.1080s/iter; left time: 3394.4833s
Epoch: 15 cost time: 40.453338384628296
Epoch: 15, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.745 Vali Acc: 0.659 Test Loss: 0.745 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.3768016
	speed: 0.3833s/iter; left time: 11985.7966s
	iters: 200, epoch: 16 | loss: 0.3831854
	speed: 0.1063s/iter; left time: 3314.3399s
	iters: 300, epoch: 16 | loss: 0.2671236
	speed: 0.1059s/iter; left time: 3289.8942s
Epoch: 16 cost time: 40.09258008003235
Epoch: 16, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.770 Vali Acc: 0.671 Test Loss: 0.770 Test Acc: 0.671
Validation loss decreased (-0.663713 --> -0.671388).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5952141
	speed: 0.4350s/iter; left time: 13438.7166s
	iters: 200, epoch: 17 | loss: 0.4399301
	speed: 0.1304s/iter; left time: 4016.9862s
	iters: 300, epoch: 17 | loss: 0.5051954
	speed: 0.1313s/iter; left time: 4029.4774s
Epoch: 17 cost time: 48.98468351364136
Epoch: 17, Steps: 369 | Train Loss: 0.385 Vali Loss: 0.830 Vali Acc: 0.663 Test Loss: 0.830 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3568114
	speed: 0.4624s/iter; left time: 14115.3597s
	iters: 200, epoch: 18 | loss: 0.2036483
	speed: 0.1299s/iter; left time: 3953.4462s
	iters: 300, epoch: 18 | loss: 0.3640476
	speed: 0.1302s/iter; left time: 3948.6998s
Epoch: 18 cost time: 48.79555559158325
Epoch: 18, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.850 Vali Acc: 0.656 Test Loss: 0.850 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4293670
	speed: 0.4672s/iter; left time: 14089.0900s
	iters: 200, epoch: 19 | loss: 0.3517562
	speed: 0.1131s/iter; left time: 3398.3964s
	iters: 300, epoch: 19 | loss: 0.1808448
	speed: 0.1052s/iter; left time: 3152.5801s
Epoch: 19 cost time: 42.66185522079468
Epoch: 19, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.931 Vali Acc: 0.654 Test Loss: 0.931 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2631550
	speed: 0.3769s/iter; left time: 11226.6081s
	iters: 200, epoch: 20 | loss: 0.2639153
	speed: 0.1074s/iter; left time: 3189.1419s
	iters: 300, epoch: 20 | loss: 0.4029759
	speed: 0.1018s/iter; left time: 3011.2755s
Epoch: 20 cost time: 38.9489324092865
Epoch: 20, Steps: 369 | Train Loss: 0.312 Vali Loss: 0.971 Vali Acc: 0.656 Test Loss: 0.971 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1861087
	speed: 0.3781s/iter; left time: 11125.1696s
	iters: 200, epoch: 21 | loss: 0.5112930
	speed: 0.1094s/iter; left time: 3208.9042s
	iters: 300, epoch: 21 | loss: 0.4271625
	speed: 0.1078s/iter; left time: 3150.8129s
Epoch: 21 cost time: 39.793721199035645
Epoch: 21, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.039 Vali Acc: 0.646 Test Loss: 1.039 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0984441
	speed: 0.3845s/iter; left time: 11171.3119s
	iters: 200, epoch: 22 | loss: 0.0661873
	speed: 0.1223s/iter; left time: 3541.9801s
	iters: 300, epoch: 22 | loss: 0.0986934
	speed: 0.1212s/iter; left time: 3496.2134s
Epoch: 22 cost time: 44.25210762023926
Epoch: 22, Steps: 369 | Train Loss: 0.311 Vali Loss: 1.059 Vali Acc: 0.639 Test Loss: 1.059 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2849811
	speed: 0.2855s/iter; left time: 8190.0171s
	iters: 200, epoch: 23 | loss: 0.2187812
	speed: 0.0676s/iter; left time: 1932.4616s
	iters: 300, epoch: 23 | loss: 0.2671224
	speed: 0.0666s/iter; left time: 1896.9864s
Epoch: 23 cost time: 27.558276653289795
Epoch: 23, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.078 Vali Acc: 0.645 Test Loss: 1.078 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.7050614
	speed: 0.4218s/iter; left time: 11943.4750s
	iters: 200, epoch: 24 | loss: 0.1788312
	speed: 0.1222s/iter; left time: 3446.9803s
	iters: 300, epoch: 24 | loss: 0.3097516
	speed: 0.1216s/iter; left time: 3419.5811s
Epoch: 24 cost time: 45.955827474594116
Epoch: 24, Steps: 369 | Train Loss: 0.258 Vali Loss: 1.133 Vali Acc: 0.654 Test Loss: 1.133 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2258858
	speed: 0.4526s/iter; left time: 12647.6455s
	iters: 200, epoch: 25 | loss: 0.2413893
	speed: 0.1246s/iter; left time: 3470.0860s
	iters: 300, epoch: 25 | loss: 0.1724339
	speed: 0.1249s/iter; left time: 3465.1860s
Epoch: 25 cost time: 46.98314189910889
Epoch: 25, Steps: 369 | Train Loss: 0.244 Vali Loss: 1.290 Vali Acc: 0.644 Test Loss: 1.290 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4013950
	speed: 0.4112s/iter; left time: 11340.2595s
	iters: 200, epoch: 26 | loss: 0.3800474
	speed: 0.1024s/iter; left time: 2812.5693s
	iters: 300, epoch: 26 | loss: 0.2134755
	speed: 0.1022s/iter; left time: 2797.2419s
Epoch: 26 cost time: 38.18417739868164
Epoch: 26, Steps: 369 | Train Loss: 0.261 Vali Loss: 1.170 Vali Acc: 0.638 Test Loss: 1.170 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6713961407491487
model parameter : 559106
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0211174
	speed: 0.8060s/iter; left time: 29660.6012s
	iters: 200, epoch: 1 | loss: 0.9181938
	speed: 0.7685s/iter; left time: 28204.6100s
	iters: 300, epoch: 1 | loss: 4.0022597
	speed: 0.6950s/iter; left time: 25439.0194s
Epoch: 1 cost time: 272.5117344856262
Epoch: 1, Steps: 369 | Train Loss: 3.288 Vali Loss: 3.006 Vali Acc: 0.633 Test Loss: 3.006 Test Acc: 0.633
Validation loss decreased (inf --> -0.633057).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9704998
	speed: 2.2542s/iter; left time: 82124.8521s
	iters: 200, epoch: 2 | loss: 5.9255309
	speed: 0.6996s/iter; left time: 25418.6717s
	iters: 300, epoch: 2 | loss: 6.5548115
	speed: 0.6217s/iter; left time: 22524.4252s
Epoch: 2 cost time: 248.99724507331848
Epoch: 2, Steps: 369 | Train Loss: 5.643 Vali Loss: 12.625 Vali Acc: 0.559 Test Loss: 12.625 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.9803257
	speed: 2.2647s/iter; left time: 81671.5575s
	iters: 200, epoch: 3 | loss: 6.3408813
	speed: 0.6585s/iter; left time: 23681.3700s
	iters: 300, epoch: 3 | loss: 7.5811653
	speed: 0.6365s/iter; left time: 22825.9172s
Epoch: 3 cost time: 249.51956057548523
Epoch: 3, Steps: 369 | Train Loss: 7.742 Vali Loss: 12.862 Vali Acc: 0.633 Test Loss: 12.862 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 12.2448969
	speed: 2.2306s/iter; left time: 79619.8054s
	iters: 200, epoch: 4 | loss: 7.9663887
	speed: 0.6043s/iter; left time: 21510.9634s
	iters: 300, epoch: 4 | loss: 20.9223042
	speed: 0.6483s/iter; left time: 23009.1941s
Epoch: 4 cost time: 243.20043683052063
Epoch: 4, Steps: 369 | Train Loss: 8.734 Vali Loss: 9.936 Vali Acc: 0.637 Test Loss: 9.936 Test Acc: 0.637
Validation loss decreased (-0.633057 --> -0.637245).  Saving model ...
	iters: 100, epoch: 5 | loss: 11.8796444
	speed: 2.2756s/iter; left time: 80386.2974s
	iters: 200, epoch: 5 | loss: 2.0830460
	speed: 0.6319s/iter; left time: 22258.0282s
	iters: 300, epoch: 5 | loss: 9.9372063
	speed: 0.6973s/iter; left time: 24493.5182s
Epoch: 5 cost time: 245.56548166275024
Epoch: 5, Steps: 369 | Train Loss: 10.174 Vali Loss: 10.825 Vali Acc: 0.640 Test Loss: 10.825 Test Acc: 0.640
Validation loss decreased (-0.637245 --> -0.639506).  Saving model ...
	iters: 100, epoch: 6 | loss: 9.0386887
	speed: 2.1654s/iter; left time: 75693.6189s
	iters: 200, epoch: 6 | loss: 11.7320213
	speed: 0.6565s/iter; left time: 22884.4692s
	iters: 300, epoch: 6 | loss: 6.9584789
	speed: 0.7397s/iter; left time: 25710.0493s
Epoch: 6 cost time: 252.6676549911499
Epoch: 6, Steps: 369 | Train Loss: 9.910 Vali Loss: 11.260 Vali Acc: 0.644 Test Loss: 11.260 Test Acc: 0.644
Validation loss decreased (-0.639506 --> -0.643758).  Saving model ...
	iters: 100, epoch: 7 | loss: 6.9944277
	speed: 2.1526s/iter; left time: 74450.8537s
	iters: 200, epoch: 7 | loss: 4.6325083
	speed: 0.7194s/iter; left time: 24811.2437s
	iters: 300, epoch: 7 | loss: 3.1240716
	speed: 0.7455s/iter; left time: 25636.8754s
Epoch: 7 cost time: 258.26695370674133
Epoch: 7, Steps: 369 | Train Loss: 8.909 Vali Loss: 14.793 Vali Acc: 0.643 Test Loss: 14.793 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 11.0119762
	speed: 2.0785s/iter; left time: 71123.1292s
	iters: 200, epoch: 8 | loss: 7.9784141
	speed: 0.7189s/iter; left time: 24526.3360s
	iters: 300, epoch: 8 | loss: 10.0031252
	speed: 0.7088s/iter; left time: 24110.4406s
Epoch: 8 cost time: 250.1338632106781
Epoch: 8, Steps: 369 | Train Loss: 8.406 Vali Loss: 15.119 Vali Acc: 0.639 Test Loss: 15.119 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 5.0495758
	speed: 2.0696s/iter; left time: 70054.3847s
	iters: 200, epoch: 9 | loss: 13.2167492
	speed: 0.7190s/iter; left time: 24265.4899s
	iters: 300, epoch: 9 | loss: 8.4165850
	speed: 0.6788s/iter; left time: 22841.6817s
Epoch: 9 cost time: 250.5823998451233
Epoch: 9, Steps: 369 | Train Loss: 7.875 Vali Loss: 15.573 Vali Acc: 0.636 Test Loss: 15.573 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 5.5166297
	speed: 2.0981s/iter; left time: 70244.5976s
	iters: 200, epoch: 10 | loss: 2.0157428
	speed: 0.7233s/iter; left time: 24142.9004s
	iters: 300, epoch: 10 | loss: 10.7828760
	speed: 0.6287s/iter; left time: 20922.4491s
Epoch: 10 cost time: 249.36092495918274
Epoch: 10, Steps: 369 | Train Loss: 6.181 Vali Loss: 12.078 Vali Acc: 0.648 Test Loss: 12.078 Test Acc: 0.648
Validation loss decreased (-0.643758 --> -0.647723).  Saving model ...
	iters: 100, epoch: 11 | loss: 5.0769844
	speed: 2.2219s/iter; left time: 73570.3985s
	iters: 200, epoch: 11 | loss: 9.6975899
	speed: 0.7066s/iter; left time: 23325.6870s
	iters: 300, epoch: 11 | loss: 9.0108986
	speed: 0.6254s/iter; left time: 20582.3657s
Epoch: 11 cost time: 249.94377398490906
Epoch: 11, Steps: 369 | Train Loss: 5.580 Vali Loss: 9.020 Vali Acc: 0.651 Test Loss: 9.020 Test Acc: 0.651
Validation loss decreased (-0.647723 --> -0.650875).  Saving model ...
	iters: 100, epoch: 12 | loss: 4.6416974
	speed: 2.2325s/iter; left time: 73096.6690s
	iters: 200, epoch: 12 | loss: 3.0580716
	speed: 0.6300s/iter; left time: 20563.4887s
	iters: 300, epoch: 12 | loss: 3.0093977
	speed: 0.5993s/iter; left time: 19502.3928s
Epoch: 12 cost time: 239.7112159729004
Epoch: 12, Steps: 369 | Train Loss: 4.656 Vali Loss: 9.657 Vali Acc: 0.662 Test Loss: 9.657 Test Acc: 0.662
Validation loss decreased (-0.650875 --> -0.662219).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6044273
	speed: 2.3105s/iter; left time: 74797.0667s
	iters: 200, epoch: 13 | loss: 1.3845334
	speed: 0.6207s/iter; left time: 20031.4053s
	iters: 300, epoch: 13 | loss: 3.6020479
	speed: 0.6345s/iter; left time: 20413.0697s
Epoch: 13 cost time: 241.19270372390747
Epoch: 13, Steps: 369 | Train Loss: 2.797 Vali Loss: 10.318 Vali Acc: 0.637 Test Loss: 10.318 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.5968571
	speed: 2.0468s/iter; left time: 65507.3624s
	iters: 200, epoch: 14 | loss: 0.0000011
	speed: 0.6816s/iter; left time: 21745.2725s
	iters: 300, epoch: 14 | loss: 1.3654619
	speed: 0.5758s/iter; left time: 18312.8349s
Epoch: 14 cost time: 242.0770013332367
Epoch: 14, Steps: 369 | Train Loss: 1.917 Vali Loss: 7.160 Vali Acc: 0.661 Test Loss: 7.160 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2815259
	speed: 2.2336s/iter; left time: 70658.9291s
	iters: 200, epoch: 15 | loss: 3.3308427
	speed: 0.6102s/iter; left time: 19242.4980s
	iters: 300, epoch: 15 | loss: 3.8404136
	speed: 0.7000s/iter; left time: 22004.2947s
Epoch: 15 cost time: 247.97647213935852
Epoch: 15, Steps: 369 | Train Loss: 1.134 Vali Loss: 4.985 Vali Acc: 0.640 Test Loss: 4.985 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.7605719
	speed: 2.1397s/iter; left time: 66900.2327s
	iters: 200, epoch: 16 | loss: 1.1408999
	speed: 0.7072s/iter; left time: 22041.6478s
	iters: 300, epoch: 16 | loss: 2.1248019
	speed: 0.7065s/iter; left time: 21948.2444s
Epoch: 16 cost time: 245.2519817352295
Epoch: 16, Steps: 369 | Train Loss: 0.640 Vali Loss: 2.768 Vali Acc: 0.633 Test Loss: 2.768 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5338188
	speed: 2.1417s/iter; left time: 66172.4235s
	iters: 200, epoch: 17 | loss: 0.0301934
	speed: 0.7051s/iter; left time: 21713.9068s
	iters: 300, epoch: 17 | loss: 0.2102007
	speed: 0.5935s/iter; left time: 18217.9739s
Epoch: 17 cost time: 243.92474675178528
Epoch: 17, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.814 Vali Acc: 0.638 Test Loss: 1.814 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1410348
	speed: 2.2244s/iter; left time: 67905.3608s
	iters: 200, epoch: 18 | loss: 0.2180942
	speed: 0.5876s/iter; left time: 17880.3964s
	iters: 300, epoch: 18 | loss: 0.1546832
	speed: 0.6695s/iter; left time: 20304.3296s
Epoch: 18 cost time: 242.76592755317688
Epoch: 18, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.784 Vali Acc: 0.627 Test Loss: 1.784 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0280446
	speed: 2.1245s/iter; left time: 64073.4247s
	iters: 200, epoch: 19 | loss: 0.1266698
	speed: 0.7291s/iter; left time: 21916.7251s
	iters: 300, epoch: 19 | loss: 0.0342571
	speed: 0.7227s/iter; left time: 21650.2057s
Epoch: 19 cost time: 249.08210682868958
Epoch: 19, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.768 Vali Acc: 0.643 Test Loss: 1.768 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0129080
	speed: 2.1528s/iter; left time: 64132.6066s
	iters: 200, epoch: 20 | loss: 0.1684825
	speed: 0.7174s/iter; left time: 21298.7244s
	iters: 300, epoch: 20 | loss: 0.2406456
	speed: 0.5838s/iter; left time: 17274.0551s
Epoch: 20 cost time: 246.01278591156006
Epoch: 20, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.898 Vali Acc: 0.637 Test Loss: 1.898 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1141458
	speed: 2.2487s/iter; left time: 66160.2999s
	iters: 200, epoch: 21 | loss: 0.2567138
	speed: 0.5948s/iter; left time: 17439.8273s
	iters: 300, epoch: 21 | loss: 0.0154494
	speed: 0.6526s/iter; left time: 19071.0831s
Epoch: 21 cost time: 243.83569645881653
Epoch: 21, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.777 Vali Acc: 0.626 Test Loss: 1.777 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0553587
	speed: 2.1866s/iter; left time: 63525.0567s
	iters: 200, epoch: 22 | loss: 0.0229148
	speed: 0.6775s/iter; left time: 19614.7943s
	iters: 300, epoch: 22 | loss: 0.1637006
	speed: 0.7158s/iter; left time: 20653.1538s
Epoch: 22 cost time: 248.6551320552826
Epoch: 22, Steps: 369 | Train Loss: 0.156 Vali Loss: 2.685 Vali Acc: 0.631 Test Loss: 2.685 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6623155505107832
model parameter : 2535490
model size : 12.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.2482016
	speed: 0.3597s/iter; left time: 13237.0099s
	iters: 200, epoch: 1 | loss: 1.0634861
	speed: 0.3095s/iter; left time: 11359.4877s
	iters: 300, epoch: 1 | loss: 1.2973825
	speed: 0.2796s/iter; left time: 10232.5738s
Epoch: 1 cost time: 114.46182894706726
Epoch: 1, Steps: 369 | Train Loss: 2.300 Vali Loss: 1.796 Vali Acc: 0.617 Test Loss: 1.796 Test Acc: 0.617
Validation loss decreased (inf --> -0.616895).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2242568
	speed: 1.0901s/iter; left time: 39713.1771s
	iters: 200, epoch: 2 | loss: 0.7050859
	speed: 0.3620s/iter; left time: 13152.4861s
	iters: 300, epoch: 2 | loss: 3.0047932
	speed: 0.3650s/iter; left time: 13225.1141s
Epoch: 2 cost time: 133.32685661315918
Epoch: 2, Steps: 369 | Train Loss: 3.869 Vali Loss: 3.266 Vali Acc: 0.650 Test Loss: 3.266 Test Acc: 0.650
Validation loss decreased (-0.616895 --> -0.649797).  Saving model ...
	iters: 100, epoch: 3 | loss: 6.1544390
	speed: 1.0412s/iter; left time: 37548.5363s
	iters: 200, epoch: 3 | loss: 10.7961922
	speed: 0.2793s/iter; left time: 10043.1656s
	iters: 300, epoch: 3 | loss: 5.8629379
	speed: 0.3348s/iter; left time: 12005.6022s
Epoch: 3 cost time: 113.33452606201172
Epoch: 3, Steps: 369 | Train Loss: 5.463 Vali Loss: 7.023 Vali Acc: 0.660 Test Loss: 7.023 Test Acc: 0.660
Validation loss decreased (-0.649797 --> -0.659691).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.3306026
	speed: 1.2207s/iter; left time: 43572.6132s
	iters: 200, epoch: 4 | loss: 5.5276380
	speed: 0.3086s/iter; left time: 10983.8283s
	iters: 300, epoch: 4 | loss: 7.9124179
	speed: 0.2890s/iter; left time: 10256.5549s
Epoch: 4 cost time: 115.56974339485168
Epoch: 4, Steps: 369 | Train Loss: 6.696 Vali Loss: 6.924 Vali Acc: 0.663 Test Loss: 6.924 Test Acc: 0.663
Validation loss decreased (-0.659691 --> -0.663098).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.7387662
	speed: 1.0127s/iter; left time: 35773.3673s
	iters: 200, epoch: 5 | loss: 4.7823038
	speed: 0.2122s/iter; left time: 7476.0315s
	iters: 300, epoch: 5 | loss: 10.8353767
	speed: 0.2152s/iter; left time: 7557.4998s
Epoch: 5 cost time: 92.66624116897583
Epoch: 5, Steps: 369 | Train Loss: 7.188 Vali Loss: 6.370 Vali Acc: 0.625 Test Loss: 6.370 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0069947
	speed: 1.0769s/iter; left time: 37643.6032s
	iters: 200, epoch: 6 | loss: 7.0155854
	speed: 0.3209s/iter; left time: 11183.9074s
	iters: 300, epoch: 6 | loss: 4.5687385
	speed: 0.3115s/iter; left time: 10826.4792s
Epoch: 6 cost time: 116.73678541183472
Epoch: 6, Steps: 369 | Train Loss: 6.878 Vali Loss: 5.562 Vali Acc: 0.661 Test Loss: 5.562 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 8.6125584
	speed: 0.9835s/iter; left time: 34017.6202s
	iters: 200, epoch: 7 | loss: 13.0088720
	speed: 0.2927s/iter; left time: 10094.9600s
	iters: 300, epoch: 7 | loss: 2.2483273
	speed: 0.3167s/iter; left time: 10891.2475s
Epoch: 7 cost time: 111.16292262077332
Epoch: 7, Steps: 369 | Train Loss: 7.299 Vali Loss: 9.515 Vali Acc: 0.647 Test Loss: 9.515 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.8798776
	speed: 1.0864s/iter; left time: 37174.2850s
	iters: 200, epoch: 8 | loss: 21.8859901
	speed: 0.3117s/iter; left time: 10632.9341s
	iters: 300, epoch: 8 | loss: 6.3411989
	speed: 0.2765s/iter; left time: 9404.5983s
Epoch: 8 cost time: 110.40067195892334
Epoch: 8, Steps: 369 | Train Loss: 6.686 Vali Loss: 18.824 Vali Acc: 0.591 Test Loss: 18.824 Test Acc: 0.591
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 4.7577319
	speed: 1.0017s/iter; left time: 33907.6837s
	iters: 200, epoch: 9 | loss: 6.0214195
	speed: 0.3076s/iter; left time: 10382.8294s
	iters: 300, epoch: 9 | loss: 10.3316097
	speed: 0.3111s/iter; left time: 10469.7546s
Epoch: 9 cost time: 114.96981573104858
Epoch: 9, Steps: 369 | Train Loss: 6.411 Vali Loss: 6.016 Vali Acc: 0.651 Test Loss: 6.016 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 4.8127227
	speed: 1.0769s/iter; left time: 36053.5611s
	iters: 200, epoch: 10 | loss: 8.1195822
	speed: 0.2844s/iter; left time: 9493.4339s
	iters: 300, epoch: 10 | loss: 2.7959616
	speed: 0.2805s/iter; left time: 9336.2284s
Epoch: 10 cost time: 106.32303380966187
Epoch: 10, Steps: 369 | Train Loss: 5.233 Vali Loss: 7.177 Vali Acc: 0.654 Test Loss: 7.177 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.0729914
	speed: 1.0511s/iter; left time: 34801.9975s
	iters: 200, epoch: 11 | loss: 0.6244517
	speed: 0.3173s/iter; left time: 10475.7169s
	iters: 300, epoch: 11 | loss: 3.2371991
	speed: 0.3199s/iter; left time: 10529.0248s
Epoch: 11 cost time: 118.15193152427673
Epoch: 11, Steps: 369 | Train Loss: 4.144 Vali Loss: 6.035 Vali Acc: 0.646 Test Loss: 6.035 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 5.8504915
	speed: 1.0301s/iter; left time: 33728.0620s
	iters: 200, epoch: 12 | loss: 2.8317969
	speed: 0.2811s/iter; left time: 9175.0149s
	iters: 300, epoch: 12 | loss: 0.9887732
	speed: 0.3119s/iter; left time: 10148.8999s
Epoch: 12 cost time: 110.0681140422821
Epoch: 12, Steps: 369 | Train Loss: 2.695 Vali Loss: 3.499 Vali Acc: 0.648 Test Loss: 3.499 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.2169700
	speed: 1.0968s/iter; left time: 35507.6541s
	iters: 200, epoch: 13 | loss: 2.2859166
	speed: 0.3138s/iter; left time: 10127.3071s
	iters: 300, epoch: 13 | loss: 1.7047614
	speed: 0.2997s/iter; left time: 9642.8033s
Epoch: 13 cost time: 113.26364779472351
Epoch: 13, Steps: 369 | Train Loss: 1.361 Vali Loss: 2.355 Vali Acc: 0.650 Test Loss: 2.355 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.3760026
	speed: 1.0256s/iter; left time: 32824.5913s
	iters: 200, epoch: 14 | loss: 0.1531381
	speed: 0.3218s/iter; left time: 10267.0609s
	iters: 300, epoch: 14 | loss: 1.0598797
	speed: 0.3227s/iter; left time: 10264.2417s
Epoch: 14 cost time: 117.75304794311523
Epoch: 14, Steps: 369 | Train Loss: 0.682 Vali Loss: 1.237 Vali Acc: 0.649 Test Loss: 1.237 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.66316685584563
model parameter : 1392962
model size : 7.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.1195989
	speed: 0.2127s/iter; left time: 7829.3794s
	iters: 200, epoch: 1 | loss: 1.2277521
	speed: 0.1945s/iter; left time: 7137.8245s
	iters: 300, epoch: 1 | loss: 1.2816205
	speed: 0.2118s/iter; left time: 7750.9051s
Epoch: 1 cost time: 77.59328174591064
Epoch: 1, Steps: 369 | Train Loss: 1.781 Vali Loss: 1.906 Vali Acc: 0.650 Test Loss: 1.906 Test Acc: 0.650
Validation loss decreased (inf --> -0.649811).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3135715
	speed: 0.7754s/iter; left time: 28251.1419s
	iters: 200, epoch: 2 | loss: 3.9405696
	speed: 0.2303s/iter; left time: 8368.3331s
	iters: 300, epoch: 2 | loss: 1.0851173
	speed: 0.2308s/iter; left time: 8360.6759s
Epoch: 2 cost time: 85.36975431442261
Epoch: 2, Steps: 369 | Train Loss: 3.089 Vali Loss: 2.341 Vali Acc: 0.642 Test Loss: 2.341 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5643641
	speed: 0.7268s/iter; left time: 26210.0158s
	iters: 200, epoch: 3 | loss: 4.9887490
	speed: 0.1867s/iter; left time: 6714.5371s
	iters: 300, epoch: 3 | loss: 5.1411819
	speed: 0.1837s/iter; left time: 6589.3005s
Epoch: 3 cost time: 70.25809717178345
Epoch: 3, Steps: 369 | Train Loss: 4.493 Vali Loss: 4.995 Vali Acc: 0.645 Test Loss: 4.995 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.7794621
	speed: 0.7005s/iter; left time: 25002.7851s
	iters: 200, epoch: 4 | loss: 5.4871330
	speed: 0.2144s/iter; left time: 7632.4695s
	iters: 300, epoch: 4 | loss: 9.4459982
	speed: 0.2189s/iter; left time: 7768.0444s
Epoch: 4 cost time: 80.4801197052002
Epoch: 4, Steps: 369 | Train Loss: 5.282 Vali Loss: 4.493 Vali Acc: 0.636 Test Loss: 4.493 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 6.9949169
	speed: 0.7506s/iter; left time: 26513.9954s
	iters: 200, epoch: 5 | loss: 3.9491143
	speed: 0.2125s/iter; left time: 7483.6406s
	iters: 300, epoch: 5 | loss: 7.1531568
	speed: 0.1910s/iter; left time: 6710.4145s
Epoch: 5 cost time: 76.14938569068909
Epoch: 5, Steps: 369 | Train Loss: 6.014 Vali Loss: 11.592 Vali Acc: 0.555 Test Loss: 11.592 Test Acc: 0.555
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.8552337
	speed: 0.6803s/iter; left time: 23779.1787s
	iters: 200, epoch: 6 | loss: 4.9378252
	speed: 0.2074s/iter; left time: 7228.6657s
	iters: 300, epoch: 6 | loss: 13.8864069
	speed: 0.2077s/iter; left time: 7218.9833s
Epoch: 6 cost time: 76.13816595077515
Epoch: 6, Steps: 369 | Train Loss: 6.345 Vali Loss: 6.301 Vali Acc: 0.659 Test Loss: 6.301 Test Acc: 0.659
Validation loss decreased (-0.649811 --> -0.659131).  Saving model ...
	iters: 100, epoch: 7 | loss: 5.5324073
	speed: 0.7298s/iter; left time: 25242.3286s
	iters: 200, epoch: 7 | loss: 5.4908943
	speed: 0.2117s/iter; left time: 7299.9198s
	iters: 300, epoch: 7 | loss: 3.5416753
	speed: 0.2136s/iter; left time: 7343.9655s
Epoch: 7 cost time: 79.79128193855286
Epoch: 7, Steps: 369 | Train Loss: 5.977 Vali Loss: 8.897 Vali Acc: 0.649 Test Loss: 8.897 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 6.3483262
	speed: 0.6858s/iter; left time: 23466.0610s
	iters: 200, epoch: 8 | loss: 7.6389985
	speed: 0.1871s/iter; left time: 6382.2789s
	iters: 300, epoch: 8 | loss: 9.9381227
	speed: 0.1827s/iter; left time: 6216.2847s
Epoch: 8 cost time: 70.71415710449219
Epoch: 8, Steps: 369 | Train Loss: 5.783 Vali Loss: 5.857 Vali Acc: 0.651 Test Loss: 5.857 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5698662
	speed: 0.7330s/iter; left time: 24811.9263s
	iters: 200, epoch: 9 | loss: 9.0632210
	speed: 0.2122s/iter; left time: 7160.3278s
	iters: 300, epoch: 9 | loss: 6.2210789
	speed: 0.2116s/iter; left time: 7118.5585s
Epoch: 9 cost time: 79.1050488948822
Epoch: 9, Steps: 369 | Train Loss: 5.119 Vali Loss: 8.238 Vali Acc: 0.640 Test Loss: 8.238 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8158941
	speed: 0.7123s/iter; left time: 23848.1504s
	iters: 200, epoch: 10 | loss: 7.4735022
	speed: 0.1891s/iter; left time: 6310.7649s
	iters: 300, epoch: 10 | loss: 4.9144778
	speed: 0.1856s/iter; left time: 6177.4946s
Epoch: 10 cost time: 70.47776532173157
Epoch: 10, Steps: 369 | Train Loss: 4.541 Vali Loss: 5.271 Vali Acc: 0.649 Test Loss: 5.271 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8561693
	speed: 0.7036s/iter; left time: 23295.3216s
	iters: 200, epoch: 11 | loss: 3.2303002
	speed: 0.2140s/iter; left time: 7063.9322s
	iters: 300, epoch: 11 | loss: 4.8071079
	speed: 0.2177s/iter; left time: 7163.8721s
Epoch: 11 cost time: 80.51836776733398
Epoch: 11, Steps: 369 | Train Loss: 3.381 Vali Loss: 3.306 Vali Acc: 0.638 Test Loss: 3.306 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 5.7809863
	speed: 0.7543s/iter; left time: 24696.8022s
	iters: 200, epoch: 12 | loss: 2.5234540
	speed: 0.2122s/iter; left time: 6925.9986s
	iters: 300, epoch: 12 | loss: 1.2543249
	speed: 0.1912s/iter; left time: 6221.7349s
Epoch: 12 cost time: 75.8762571811676
Epoch: 12, Steps: 369 | Train Loss: 1.979 Vali Loss: 2.410 Vali Acc: 0.649 Test Loss: 2.410 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.7949464
	speed: 0.6531s/iter; left time: 21142.2462s
	iters: 200, epoch: 13 | loss: 0.5388055
	speed: 0.2032s/iter; left time: 6556.2891s
	iters: 300, epoch: 13 | loss: 0.7849931
	speed: 0.2105s/iter; left time: 6772.3829s
Epoch: 13 cost time: 75.47105073928833
Epoch: 13, Steps: 369 | Train Loss: 1.106 Vali Loss: 1.164 Vali Acc: 0.648 Test Loss: 1.164 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2721667
	speed: 0.7374s/iter; left time: 23600.1262s
	iters: 200, epoch: 14 | loss: 0.1424105
	speed: 0.2147s/iter; left time: 6850.0330s
	iters: 300, epoch: 14 | loss: 0.2626452
	speed: 0.2154s/iter; left time: 6851.2880s
Epoch: 14 cost time: 80.65980577468872
Epoch: 14, Steps: 369 | Train Loss: 0.506 Vali Loss: 0.754 Vali Acc: 0.648 Test Loss: 0.754 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1307814
	speed: 0.6819s/iter; left time: 21572.3480s
	iters: 200, epoch: 15 | loss: 0.2550811
	speed: 0.1933s/iter; left time: 6095.1502s
	iters: 300, epoch: 15 | loss: 0.2446370
	speed: 0.1906s/iter; left time: 5991.6191s
Epoch: 15 cost time: 72.62165880203247
Epoch: 15, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.800 Vali Acc: 0.657 Test Loss: 0.800 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2998356
	speed: 0.7242s/iter; left time: 22642.8011s
	iters: 200, epoch: 16 | loss: 0.7245661
	speed: 0.2085s/iter; left time: 6499.1697s
	iters: 300, epoch: 16 | loss: 0.3896357
	speed: 0.2094s/iter; left time: 6505.3061s
Epoch: 16 cost time: 77.86201500892639
Epoch: 16, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.761 Vali Acc: 0.654 Test Loss: 0.761 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6591940976163451
model parameter : 1024450
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.0523314
	speed: 0.1670s/iter; left time: 6146.6588s
	iters: 200, epoch: 1 | loss: 0.5063522
	speed: 0.1583s/iter; left time: 5808.5283s
	iters: 300, epoch: 1 | loss: 1.5923787
	speed: 0.1601s/iter; left time: 5860.1087s
Epoch: 1 cost time: 59.63041877746582
Epoch: 1, Steps: 369 | Train Loss: 1.512 Vali Loss: 2.293 Vali Acc: 0.567 Test Loss: 2.293 Test Acc: 0.567
Validation loss decreased (inf --> -0.566663).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0373659
	speed: 0.5638s/iter; left time: 20538.5529s
	iters: 200, epoch: 2 | loss: 4.8014193
	speed: 0.1663s/iter; left time: 6040.2891s
	iters: 300, epoch: 2 | loss: 2.7606812
	speed: 0.1659s/iter; left time: 6010.9327s
Epoch: 2 cost time: 61.71165704727173
Epoch: 2, Steps: 369 | Train Loss: 2.527 Vali Loss: 12.807 Vali Acc: 0.514 Test Loss: 12.807 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.0063040
	speed: 0.5326s/iter; left time: 19205.9945s
	iters: 200, epoch: 3 | loss: 3.6063204
	speed: 0.1406s/iter; left time: 5057.9267s
	iters: 300, epoch: 3 | loss: 2.4270077
	speed: 0.1390s/iter; left time: 4983.9938s
Epoch: 3 cost time: 51.963746070861816
Epoch: 3, Steps: 369 | Train Loss: 3.655 Vali Loss: 2.823 Vali Acc: 0.619 Test Loss: 2.823 Test Acc: 0.619
Validation loss decreased (-0.566663 --> -0.618871).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4551950
	speed: 0.4845s/iter; left time: 17295.0369s
	iters: 200, epoch: 4 | loss: 2.2055969
	speed: 0.1577s/iter; left time: 5611.4913s
	iters: 300, epoch: 4 | loss: 2.8830168
	speed: 0.1563s/iter; left time: 5547.3875s
Epoch: 4 cost time: 56.95284938812256
Epoch: 4, Steps: 369 | Train Loss: 4.152 Vali Loss: 6.187 Vali Acc: 0.644 Test Loss: 6.187 Test Acc: 0.644
Validation loss decreased (-0.618871 --> -0.644092).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0541103
	speed: 0.5610s/iter; left time: 19816.6739s
	iters: 200, epoch: 5 | loss: 3.0429988
	speed: 0.1651s/iter; left time: 5814.5365s
	iters: 300, epoch: 5 | loss: 2.8367636
	speed: 0.1630s/iter; left time: 5725.6580s
Epoch: 5 cost time: 61.24478816986084
Epoch: 5, Steps: 369 | Train Loss: 4.899 Vali Loss: 8.338 Vali Acc: 0.609 Test Loss: 8.338 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.3633204
	speed: 0.5476s/iter; left time: 19141.3448s
	iters: 200, epoch: 6 | loss: 6.8077359
	speed: 0.1447s/iter; left time: 5043.1221s
	iters: 300, epoch: 6 | loss: 9.4867496
	speed: 0.1451s/iter; left time: 5041.8985s
Epoch: 6 cost time: 54.686437129974365
Epoch: 6, Steps: 369 | Train Loss: 4.868 Vali Loss: 7.125 Vali Acc: 0.654 Test Loss: 7.125 Test Acc: 0.654
Validation loss decreased (-0.644092 --> -0.653731).  Saving model ...
	iters: 100, epoch: 7 | loss: 12.6142120
	speed: 0.5050s/iter; left time: 17464.7866s
	iters: 200, epoch: 7 | loss: 5.0200887
	speed: 0.1536s/iter; left time: 5298.4155s
	iters: 300, epoch: 7 | loss: 2.2237687
	speed: 0.1619s/iter; left time: 5568.2561s
Epoch: 7 cost time: 57.92347717285156
Epoch: 7, Steps: 369 | Train Loss: 4.506 Vali Loss: 5.820 Vali Acc: 0.627 Test Loss: 5.820 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3952911
	speed: 0.5567s/iter; left time: 19049.1494s
	iters: 200, epoch: 8 | loss: 1.9523998
	speed: 0.1612s/iter; left time: 5498.3690s
	iters: 300, epoch: 8 | loss: 6.1839361
	speed: 0.1613s/iter; left time: 5486.4094s
Epoch: 8 cost time: 59.9198260307312
Epoch: 8, Steps: 369 | Train Loss: 4.787 Vali Loss: 5.346 Vali Acc: 0.632 Test Loss: 5.346 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0007601
	speed: 0.5518s/iter; left time: 18678.4794s
	iters: 200, epoch: 9 | loss: 2.4622593
	speed: 0.1497s/iter; left time: 5052.0555s
	iters: 300, epoch: 9 | loss: 4.9221907
	speed: 0.1508s/iter; left time: 5073.7690s
Epoch: 9 cost time: 56.873390436172485
Epoch: 9, Steps: 369 | Train Loss: 4.317 Vali Loss: 3.382 Vali Acc: 0.623 Test Loss: 3.382 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3501403
	speed: 0.5196s/iter; left time: 17397.7326s
	iters: 200, epoch: 10 | loss: 1.5862467
	speed: 0.1670s/iter; left time: 5575.0977s
	iters: 300, epoch: 10 | loss: 5.0011587
	speed: 0.1659s/iter; left time: 5522.3333s
Epoch: 10 cost time: 60.14067769050598
Epoch: 10, Steps: 369 | Train Loss: 3.696 Vali Loss: 3.456 Vali Acc: 0.635 Test Loss: 3.456 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.5556674
	speed: 0.5693s/iter; left time: 18851.5603s
	iters: 200, epoch: 11 | loss: 1.5982605
	speed: 0.1638s/iter; left time: 5406.9853s
	iters: 300, epoch: 11 | loss: 3.8253376
	speed: 0.1643s/iter; left time: 5406.6929s
Epoch: 11 cost time: 61.34104084968567
Epoch: 11, Steps: 369 | Train Loss: 3.225 Vali Loss: 3.026 Vali Acc: 0.638 Test Loss: 3.026 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.3962517
	speed: 0.5575s/iter; left time: 18254.3765s
	iters: 200, epoch: 12 | loss: 6.5587378
	speed: 0.1470s/iter; left time: 4797.9314s
	iters: 300, epoch: 12 | loss: 2.9232814
	speed: 0.1416s/iter; left time: 4607.1220s
Epoch: 12 cost time: 54.150169134140015
Epoch: 12, Steps: 369 | Train Loss: 2.207 Vali Loss: 2.608 Vali Acc: 0.645 Test Loss: 2.608 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 3.8831902
	speed: 0.4939s/iter; left time: 15990.0702s
	iters: 200, epoch: 13 | loss: 3.9020205
	speed: 0.1398s/iter; left time: 4512.9507s
	iters: 300, epoch: 13 | loss: 1.4057500
	speed: 0.1665s/iter; left time: 5356.8582s
Epoch: 13 cost time: 53.81232452392578
Epoch: 13, Steps: 369 | Train Loss: 1.354 Vali Loss: 1.792 Vali Acc: 0.647 Test Loss: 1.792 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.6001273
	speed: 0.4073s/iter; left time: 13033.7951s
	iters: 200, epoch: 14 | loss: 0.5507138
	speed: 0.1104s/iter; left time: 3521.7301s
	iters: 300, epoch: 14 | loss: 0.5429683
	speed: 0.1096s/iter; left time: 3486.2820s
Epoch: 14 cost time: 41.751150369644165
Epoch: 14, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.861 Vali Acc: 0.652 Test Loss: 0.861 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1880061
	speed: 0.4561s/iter; left time: 14428.1843s
	iters: 200, epoch: 15 | loss: 0.5372552
	speed: 0.1609s/iter; left time: 5074.7910s
	iters: 300, epoch: 15 | loss: 0.4911990
	speed: 0.1601s/iter; left time: 5033.0031s
Epoch: 15 cost time: 60.32940983772278
Epoch: 15, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.871 Vali Acc: 0.652 Test Loss: 0.871 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3650250
	speed: 0.5548s/iter; left time: 17344.9428s
	iters: 200, epoch: 16 | loss: 0.2591331
	speed: 0.1606s/iter; left time: 5004.9829s
	iters: 300, epoch: 16 | loss: 0.3786941
	speed: 0.1625s/iter; left time: 5047.1460s
Epoch: 16 cost time: 60.451904296875
Epoch: 16, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.868 Vali Acc: 0.652 Test Loss: 0.868 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 803522
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4869164
	speed: 0.1587s/iter; left time: 5839.5735s
	iters: 200, epoch: 1 | loss: 1.7136289
	speed: 0.1426s/iter; left time: 5234.0681s
	iters: 300, epoch: 1 | loss: 1.3001356
	speed: 0.1421s/iter; left time: 5201.7593s
Epoch: 1 cost time: 54.25719594955444
Epoch: 1, Steps: 369 | Train Loss: 1.466 Vali Loss: 1.713 Vali Acc: 0.615 Test Loss: 1.713 Test Acc: 0.615
Validation loss decreased (inf --> -0.615477).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7417156
	speed: 0.4981s/iter; left time: 18145.3861s
	iters: 200, epoch: 2 | loss: 2.8720226
	speed: 0.1443s/iter; left time: 5244.1923s
	iters: 300, epoch: 2 | loss: 3.0425673
	speed: 0.1435s/iter; left time: 5199.9636s
Epoch: 2 cost time: 53.80421233177185
Epoch: 2, Steps: 369 | Train Loss: 2.328 Vali Loss: 4.959 Vali Acc: 0.597 Test Loss: 4.959 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.7203020
	speed: 0.4904s/iter; left time: 17683.7370s
	iters: 200, epoch: 3 | loss: 5.1583319
	speed: 0.1231s/iter; left time: 4428.3874s
	iters: 300, epoch: 3 | loss: 8.1111088
	speed: 0.1212s/iter; left time: 4347.0331s
Epoch: 3 cost time: 47.28211259841919
Epoch: 3, Steps: 369 | Train Loss: 3.233 Vali Loss: 2.961 Vali Acc: 0.643 Test Loss: 2.961 Test Acc: 0.643
Validation loss decreased (-0.615477 --> -0.642990).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0727427
	speed: 0.4444s/iter; left time: 15861.3077s
	iters: 200, epoch: 4 | loss: 2.2167723
	speed: 0.1222s/iter; left time: 4347.9594s
	iters: 300, epoch: 4 | loss: 4.3264217
	speed: 0.1304s/iter; left time: 4627.3317s
Epoch: 4 cost time: 50.8172447681427
Epoch: 4, Steps: 369 | Train Loss: 4.132 Vali Loss: 4.087 Vali Acc: 0.656 Test Loss: 4.087 Test Acc: 0.656
Validation loss decreased (-0.642990 --> -0.656316).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5728173
	speed: 0.7651s/iter; left time: 27028.2741s
	iters: 200, epoch: 5 | loss: 0.0165929
	speed: 0.2435s/iter; left time: 8576.0020s
	iters: 300, epoch: 5 | loss: 7.9345398
	speed: 0.2764s/iter; left time: 9707.9121s
Epoch: 5 cost time: 90.82380986213684
Epoch: 5, Steps: 369 | Train Loss: 4.298 Vali Loss: 3.617 Vali Acc: 0.656 Test Loss: 3.617 Test Acc: 0.656
Validation loss decreased (-0.656316 --> -0.656320).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.9668694
	speed: 0.9241s/iter; left time: 32302.7320s
	iters: 200, epoch: 6 | loss: 7.0877757
	speed: 0.2334s/iter; left time: 8136.7035s
	iters: 300, epoch: 6 | loss: 2.3384032
	speed: 0.2837s/iter; left time: 9861.4482s
Epoch: 6 cost time: 99.17756795883179
Epoch: 6, Steps: 369 | Train Loss: 4.289 Vali Loss: 3.607 Vali Acc: 0.661 Test Loss: 3.607 Test Acc: 0.661
Validation loss decreased (-0.656320 --> -0.661144).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9874644
	speed: 0.8272s/iter; left time: 28611.0773s
	iters: 200, epoch: 7 | loss: 6.8522344
	speed: 0.2074s/iter; left time: 7152.3813s
	iters: 300, epoch: 7 | loss: 3.3582821
	speed: 0.2665s/iter; left time: 9164.2047s
Epoch: 7 cost time: 87.22853517532349
Epoch: 7, Steps: 369 | Train Loss: 4.137 Vali Loss: 3.712 Vali Acc: 0.625 Test Loss: 3.712 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2319512
	speed: 0.8323s/iter; left time: 28478.6641s
	iters: 200, epoch: 8 | loss: 3.4274998
	speed: 0.2216s/iter; left time: 7559.2665s
	iters: 300, epoch: 8 | loss: 2.8499703
	speed: 0.2742s/iter; left time: 9327.5311s
Epoch: 8 cost time: 95.81731605529785
Epoch: 8, Steps: 369 | Train Loss: 4.040 Vali Loss: 3.784 Vali Acc: 0.642 Test Loss: 3.784 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.8811903
	speed: 0.8941s/iter; left time: 30263.9839s
	iters: 200, epoch: 9 | loss: 4.6710973
	speed: 0.2470s/iter; left time: 8335.4150s
	iters: 300, epoch: 9 | loss: 6.7429657
	speed: 0.2863s/iter; left time: 9634.6641s
Epoch: 9 cost time: 94.28924870491028
Epoch: 9, Steps: 369 | Train Loss: 3.756 Vali Loss: 8.087 Vali Acc: 0.595 Test Loss: 8.087 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6290723
	speed: 0.8533s/iter; left time: 28569.7117s
	iters: 200, epoch: 10 | loss: 2.1326621
	speed: 0.2050s/iter; left time: 6842.1876s
	iters: 300, epoch: 10 | loss: 4.8468432
	speed: 0.2685s/iter; left time: 8935.8345s
Epoch: 10 cost time: 85.41330194473267
Epoch: 10, Steps: 369 | Train Loss: 3.431 Vali Loss: 3.495 Vali Acc: 0.637 Test Loss: 3.495 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.7370570
	speed: 0.8387s/iter; left time: 27770.8225s
	iters: 200, epoch: 11 | loss: 4.1484318
	speed: 0.2223s/iter; left time: 7338.1223s
	iters: 300, epoch: 11 | loss: 3.2757552
	speed: 0.2657s/iter; left time: 8742.9341s
Epoch: 11 cost time: 91.20336699485779
Epoch: 11, Steps: 369 | Train Loss: 2.743 Vali Loss: 2.328 Vali Acc: 0.644 Test Loss: 2.328 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0199238
	speed: 0.8933s/iter; left time: 29249.3353s
	iters: 200, epoch: 12 | loss: 0.8685202
	speed: 0.2208s/iter; left time: 7208.0713s
	iters: 300, epoch: 12 | loss: 1.6718670
	speed: 0.2879s/iter; left time: 9367.6051s
Epoch: 12 cost time: 95.68310618400574
Epoch: 12, Steps: 369 | Train Loss: 1.847 Vali Loss: 1.846 Vali Acc: 0.635 Test Loss: 1.846 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4918168
	speed: 0.9228s/iter; left time: 29874.1212s
	iters: 200, epoch: 13 | loss: 0.1296565
	speed: 0.2034s/iter; left time: 6564.2593s
	iters: 300, epoch: 13 | loss: 0.8403786
	speed: 0.2734s/iter; left time: 8795.7258s
Epoch: 13 cost time: 91.377601146698
Epoch: 13, Steps: 369 | Train Loss: 0.918 Vali Loss: 1.017 Vali Acc: 0.657 Test Loss: 1.017 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3744860
	speed: 0.7660s/iter; left time: 24515.4795s
	iters: 200, epoch: 14 | loss: 0.7977471
	speed: 0.1681s/iter; left time: 5364.3327s
	iters: 300, epoch: 14 | loss: 0.4220628
	speed: 0.1703s/iter; left time: 5417.2526s
Epoch: 14 cost time: 68.21042251586914
Epoch: 14, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.793 Vali Acc: 0.672 Test Loss: 0.793 Test Acc: 0.672
Validation loss decreased (-0.661144 --> -0.671672).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3564064
	speed: 0.7744s/iter; left time: 24497.4128s
	iters: 200, epoch: 15 | loss: 0.7059887
	speed: 0.2622s/iter; left time: 8269.3024s
	iters: 300, epoch: 15 | loss: 0.1355374
	speed: 0.2216s/iter; left time: 6966.7339s
Epoch: 15 cost time: 89.74598503112793
Epoch: 15, Steps: 369 | Train Loss: 0.415 Vali Loss: 0.778 Vali Acc: 0.646 Test Loss: 0.778 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1846033
	speed: 0.8566s/iter; left time: 26781.9267s
	iters: 200, epoch: 16 | loss: 0.3776441
	speed: 0.2965s/iter; left time: 9240.6851s
	iters: 300, epoch: 16 | loss: 0.3432637
	speed: 0.2484s/iter; left time: 7715.8480s
Epoch: 16 cost time: 98.79279255867004
Epoch: 16, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.840 Vali Acc: 0.666 Test Loss: 0.840 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1591101
	speed: 0.8610s/iter; left time: 26603.3606s
	iters: 200, epoch: 17 | loss: 0.3592857
	speed: 0.2108s/iter; left time: 6490.7248s
	iters: 300, epoch: 17 | loss: 0.5510899
	speed: 0.2227s/iter; left time: 6836.8168s
Epoch: 17 cost time: 82.15306854248047
Epoch: 17, Steps: 369 | Train Loss: 0.357 Vali Loss: 0.870 Vali Acc: 0.661 Test Loss: 0.870 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1428487
	speed: 0.7960s/iter; left time: 24299.9497s
	iters: 200, epoch: 18 | loss: 0.1810983
	speed: 0.2567s/iter; left time: 7812.2123s
	iters: 300, epoch: 18 | loss: 0.5551487
	speed: 0.2766s/iter; left time: 8388.1145s
Epoch: 18 cost time: 97.19435930252075
Epoch: 18, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.918 Vali Acc: 0.655 Test Loss: 0.918 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2491334
	speed: 0.8543s/iter; left time: 25765.9384s
	iters: 200, epoch: 19 | loss: 0.6685177
	speed: 0.2607s/iter; left time: 7837.1584s
	iters: 300, epoch: 19 | loss: 0.0964272
	speed: 0.2844s/iter; left time: 8519.5793s
Epoch: 19 cost time: 96.61978602409363
Epoch: 19, Steps: 369 | Train Loss: 0.313 Vali Loss: 0.912 Vali Acc: 0.640 Test Loss: 0.912 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2161489
	speed: 0.8803s/iter; left time: 26222.8372s
	iters: 200, epoch: 20 | loss: 0.1481846
	speed: 0.2467s/iter; left time: 7324.2572s
	iters: 300, epoch: 20 | loss: 0.9420932
	speed: 0.2321s/iter; left time: 6866.9666s
Epoch: 20 cost time: 92.37182831764221
Epoch: 20, Steps: 369 | Train Loss: 0.287 Vali Loss: 1.065 Vali Acc: 0.654 Test Loss: 1.065 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3008456
	speed: 0.7736s/iter; left time: 22761.4183s
	iters: 200, epoch: 21 | loss: 0.2846709
	speed: 0.2249s/iter; left time: 6593.5020s
	iters: 300, epoch: 21 | loss: 0.4061874
	speed: 0.2234s/iter; left time: 6528.1961s
Epoch: 21 cost time: 83.85763788223267
Epoch: 21, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.111 Vali Acc: 0.651 Test Loss: 1.111 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3798507
	speed: 0.8874s/iter; left time: 25780.3877s
	iters: 200, epoch: 22 | loss: 0.2244003
	speed: 0.2391s/iter; left time: 6921.0742s
	iters: 300, epoch: 22 | loss: 0.4287787
	speed: 0.2545s/iter; left time: 7342.7661s
Epoch: 22 cost time: 93.7860279083252
Epoch: 22, Steps: 369 | Train Loss: 0.247 Vali Loss: 1.229 Vali Acc: 0.655 Test Loss: 1.229 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1024752
	speed: 0.8936s/iter; left time: 25631.8792s
	iters: 200, epoch: 23 | loss: 0.1299228
	speed: 0.2471s/iter; left time: 7062.5255s
	iters: 300, epoch: 23 | loss: 0.1755191
	speed: 0.2488s/iter; left time: 7086.2491s
Epoch: 23 cost time: 94.09281539916992
Epoch: 23, Steps: 369 | Train Loss: 0.239 Vali Loss: 1.177 Vali Acc: 0.654 Test Loss: 1.177 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2901329
	speed: 0.8424s/iter; left time: 23850.4913s
	iters: 200, epoch: 24 | loss: 0.3878016
	speed: 0.2032s/iter; left time: 5733.6186s
	iters: 300, epoch: 24 | loss: 0.3242734
	speed: 0.1690s/iter; left time: 4752.5828s
Epoch: 24 cost time: 76.53107976913452
Epoch: 24, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.250 Vali Acc: 0.648 Test Loss: 1.250 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 693314
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1603138
	speed: 0.2132s/iter; left time: 7846.5477s
	iters: 200, epoch: 1 | loss: 1.1636931
	speed: 0.2106s/iter; left time: 7729.3254s
	iters: 300, epoch: 1 | loss: 1.5238388
	speed: 0.1978s/iter; left time: 7238.2392s
Epoch: 1 cost time: 78.06837463378906
Epoch: 1, Steps: 369 | Train Loss: 1.234 Vali Loss: 1.436 Vali Acc: 0.615 Test Loss: 1.436 Test Acc: 0.615
Validation loss decreased (inf --> -0.615196).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7762378
	speed: 0.6424s/iter; left time: 23404.4505s
	iters: 200, epoch: 2 | loss: 1.2469686
	speed: 0.1855s/iter; left time: 6738.2478s
	iters: 300, epoch: 2 | loss: 0.9336749
	speed: 0.2163s/iter; left time: 7835.3215s
Epoch: 2 cost time: 73.25689649581909
Epoch: 2, Steps: 369 | Train Loss: 1.926 Vali Loss: 3.433 Vali Acc: 0.601 Test Loss: 3.433 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5153849
	speed: 0.6010s/iter; left time: 21674.8157s
	iters: 200, epoch: 3 | loss: 2.3449781
	speed: 0.2063s/iter; left time: 7419.3221s
	iters: 300, epoch: 3 | loss: 2.2976036
	speed: 0.1904s/iter; left time: 6828.0415s
Epoch: 3 cost time: 69.97220230102539
Epoch: 3, Steps: 369 | Train Loss: 2.750 Vali Loss: 5.530 Vali Acc: 0.601 Test Loss: 5.530 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8740171
	speed: 0.6228s/iter; left time: 22229.5346s
	iters: 200, epoch: 4 | loss: 4.3881931
	speed: 0.1105s/iter; left time: 3933.5604s
	iters: 300, epoch: 4 | loss: 2.1845145
	speed: 0.1100s/iter; left time: 3903.2925s
Epoch: 4 cost time: 43.513442516326904
Epoch: 4, Steps: 369 | Train Loss: 3.136 Vali Loss: 11.173 Vali Acc: 0.510 Test Loss: 11.173 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 8.5669537
	speed: 0.3702s/iter; left time: 13078.2458s
	iters: 200, epoch: 5 | loss: 3.0569386
	speed: 0.1115s/iter; left time: 3926.6181s
	iters: 300, epoch: 5 | loss: 3.6547098
	speed: 0.1119s/iter; left time: 3929.6600s
Epoch: 5 cost time: 41.92559862136841
Epoch: 5, Steps: 369 | Train Loss: 3.650 Vali Loss: 7.521 Vali Acc: 0.545 Test Loss: 7.521 Test Acc: 0.545
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 5.8110871
	speed: 0.3598s/iter; left time: 12578.2480s
	iters: 200, epoch: 6 | loss: 4.8880820
	speed: 0.1015s/iter; left time: 3537.8331s
	iters: 300, epoch: 6 | loss: 3.3240442
	speed: 0.0970s/iter; left time: 3369.8733s
Epoch: 6 cost time: 38.19572925567627
Epoch: 6, Steps: 369 | Train Loss: 3.550 Vali Loss: 5.688 Vali Acc: 0.615 Test Loss: 5.688 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.7160573
	speed: 0.3521s/iter; left time: 12176.6628s
	iters: 200, epoch: 7 | loss: 5.9120302
	speed: 0.1083s/iter; left time: 3734.8507s
	iters: 300, epoch: 7 | loss: 3.7730389
	speed: 0.1065s/iter; left time: 3661.1633s
Epoch: 7 cost time: 40.36143517494202
Epoch: 7, Steps: 369 | Train Loss: 3.749 Vali Loss: 5.319 Vali Acc: 0.591 Test Loss: 5.319 Test Acc: 0.591
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.2412509
	speed: 0.3680s/iter; left time: 12593.8361s
	iters: 200, epoch: 8 | loss: 2.4724715
	speed: 0.1071s/iter; left time: 3655.1832s
	iters: 300, epoch: 8 | loss: 2.2645524
	speed: 0.1069s/iter; left time: 3637.3607s
Epoch: 8 cost time: 40.18199586868286
Epoch: 8, Steps: 369 | Train Loss: 3.380 Vali Loss: 3.796 Vali Acc: 0.633 Test Loss: 3.796 Test Acc: 0.633
Validation loss decreased (-0.615196 --> -0.633049).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0353177
	speed: 0.3641s/iter; left time: 12325.5477s
	iters: 200, epoch: 9 | loss: 5.7913427
	speed: 0.1069s/iter; left time: 3607.9698s
	iters: 300, epoch: 9 | loss: 1.4568713
	speed: 0.1064s/iter; left time: 3578.5857s
Epoch: 9 cost time: 39.1151487827301
Epoch: 9, Steps: 369 | Train Loss: 3.175 Vali Loss: 3.134 Vali Acc: 0.638 Test Loss: 3.134 Test Acc: 0.638
Validation loss decreased (-0.633049 --> -0.638164).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7383935
	speed: 0.3391s/iter; left time: 11352.8492s
	iters: 200, epoch: 10 | loss: 2.2611885
	speed: 0.1011s/iter; left time: 3374.0673s
	iters: 300, epoch: 10 | loss: 1.0542157
	speed: 0.1006s/iter; left time: 3346.8228s
Epoch: 10 cost time: 37.664347887039185
Epoch: 10, Steps: 369 | Train Loss: 2.831 Vali Loss: 3.562 Vali Acc: 0.642 Test Loss: 3.562 Test Acc: 0.642
Validation loss decreased (-0.638164 --> -0.641565).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6621361
	speed: 0.3509s/iter; left time: 11619.3026s
	iters: 200, epoch: 11 | loss: 1.7122282
	speed: 0.1066s/iter; left time: 3518.4496s
	iters: 300, epoch: 11 | loss: 2.3979809
	speed: 0.1073s/iter; left time: 3530.2361s
Epoch: 11 cost time: 40.22948694229126
Epoch: 11, Steps: 369 | Train Loss: 2.289 Vali Loss: 2.951 Vali Acc: 0.659 Test Loss: 2.951 Test Acc: 0.659
Validation loss decreased (-0.641565 --> -0.658881).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.0785782
	speed: 0.3636s/iter; left time: 11905.7718s
	iters: 200, epoch: 12 | loss: 0.2944164
	speed: 0.1082s/iter; left time: 3532.5907s
	iters: 300, epoch: 12 | loss: 4.2380242
	speed: 0.1067s/iter; left time: 3472.7713s
Epoch: 12 cost time: 40.21808481216431
Epoch: 12, Steps: 369 | Train Loss: 1.794 Vali Loss: 3.024 Vali Acc: 0.646 Test Loss: 3.024 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5963296
	speed: 0.3585s/iter; left time: 11606.0784s
	iters: 200, epoch: 13 | loss: 0.4304664
	speed: 0.0986s/iter; left time: 3180.6963s
	iters: 300, epoch: 13 | loss: 0.9111032
	speed: 0.0961s/iter; left time: 3091.3805s
Epoch: 13 cost time: 37.304752349853516
Epoch: 13, Steps: 369 | Train Loss: 1.291 Vali Loss: 1.757 Vali Acc: 0.655 Test Loss: 1.757 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3088248
	speed: 0.3348s/iter; left time: 10715.0307s
	iters: 200, epoch: 14 | loss: 0.6953660
	speed: 0.0965s/iter; left time: 3078.4061s
	iters: 300, epoch: 14 | loss: 0.6276869
	speed: 0.0936s/iter; left time: 2976.4150s
Epoch: 14 cost time: 35.59085965156555
Epoch: 14, Steps: 369 | Train Loss: 0.793 Vali Loss: 0.893 Vali Acc: 0.640 Test Loss: 0.893 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2580388
	speed: 0.3594s/iter; left time: 11370.1198s
	iters: 200, epoch: 15 | loss: 0.5666707
	speed: 0.1074s/iter; left time: 3386.0293s
	iters: 300, epoch: 15 | loss: 0.3798667
	speed: 0.1079s/iter; left time: 3390.3968s
Epoch: 15 cost time: 40.56243634223938
Epoch: 15, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.804 Vali Acc: 0.661 Test Loss: 0.804 Test Acc: 0.661
Validation loss decreased (-0.658881 --> -0.660605).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2475827
	speed: 0.3615s/iter; left time: 11302.6211s
	iters: 200, epoch: 16 | loss: 0.2803993
	speed: 0.1083s/iter; left time: 3374.6338s
	iters: 300, epoch: 16 | loss: 0.2150836
	speed: 0.1067s/iter; left time: 3315.3685s
Epoch: 16 cost time: 40.28148603439331
Epoch: 16, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.899 Vali Acc: 0.648 Test Loss: 0.899 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3567832
	speed: 0.3545s/iter; left time: 10954.2327s
	iters: 200, epoch: 17 | loss: 0.5997085
	speed: 0.0986s/iter; left time: 3036.9120s
	iters: 300, epoch: 17 | loss: 0.1264240
	speed: 0.0980s/iter; left time: 3009.1138s
Epoch: 17 cost time: 37.42391753196716
Epoch: 17, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.922 Vali Acc: 0.653 Test Loss: 0.922 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5269717
	speed: 0.3430s/iter; left time: 10470.3494s
	iters: 200, epoch: 18 | loss: 0.4605336
	speed: 0.0959s/iter; left time: 2918.0311s
	iters: 300, epoch: 18 | loss: 0.2456596
	speed: 0.1012s/iter; left time: 3070.3594s
Epoch: 18 cost time: 37.54394555091858
Epoch: 18, Steps: 369 | Train Loss: 0.299 Vali Loss: 1.043 Vali Acc: 0.648 Test Loss: 1.043 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1453930
	speed: 0.3648s/iter; left time: 11000.9399s
	iters: 200, epoch: 19 | loss: 0.6750515
	speed: 0.1066s/iter; left time: 3203.5809s
	iters: 300, epoch: 19 | loss: 0.7201513
	speed: 0.1048s/iter; left time: 3138.7383s
Epoch: 19 cost time: 39.79074692726135
Epoch: 19, Steps: 369 | Train Loss: 0.285 Vali Loss: 1.010 Vali Acc: 0.648 Test Loss: 1.010 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1428505
	speed: 0.3645s/iter; left time: 10859.4332s
	iters: 200, epoch: 20 | loss: 0.3271225
	speed: 0.1062s/iter; left time: 3152.0103s
	iters: 300, epoch: 20 | loss: 0.1732402
	speed: 0.1064s/iter; left time: 3149.3245s
Epoch: 20 cost time: 39.93316626548767
Epoch: 20, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.167 Vali Acc: 0.642 Test Loss: 1.167 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3256064
	speed: 0.3526s/iter; left time: 10374.6742s
	iters: 200, epoch: 21 | loss: 0.4436817
	speed: 0.0991s/iter; left time: 2904.8759s
	iters: 300, epoch: 21 | loss: 0.0807073
	speed: 0.0952s/iter; left time: 2781.3831s
Epoch: 21 cost time: 36.97960901260376
Epoch: 21, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.213 Vali Acc: 0.645 Test Loss: 1.213 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2171834
	speed: 0.3470s/iter; left time: 10079.7983s
	iters: 200, epoch: 22 | loss: 0.1326406
	speed: 0.1071s/iter; left time: 3102.1639s
	iters: 300, epoch: 22 | loss: 0.4414124
	speed: 0.1067s/iter; left time: 3079.1853s
Epoch: 22 cost time: 39.48750972747803
Epoch: 22, Steps: 369 | Train Loss: 0.243 Vali Loss: 1.209 Vali Acc: 0.646 Test Loss: 1.209 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.1520253
	speed: 0.3739s/iter; left time: 10723.4205s
	iters: 200, epoch: 23 | loss: 0.1713407
	speed: 0.1044s/iter; left time: 2984.2396s
	iters: 300, epoch: 23 | loss: 0.0982298
	speed: 0.1056s/iter; left time: 3006.6315s
Epoch: 23 cost time: 39.590287923812866
Epoch: 23, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.328 Vali Acc: 0.641 Test Loss: 1.328 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1306543
	speed: 0.3706s/iter; left time: 10494.5317s
	iters: 200, epoch: 24 | loss: 0.4124516
	speed: 0.1066s/iter; left time: 3006.5955s
	iters: 300, epoch: 24 | loss: 0.0204642
	speed: 0.1057s/iter; left time: 2973.0029s
Epoch: 24 cost time: 39.16029763221741
Epoch: 24, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.421 Vali Acc: 0.635 Test Loss: 1.421 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1738368
	speed: 0.3535s/iter; left time: 9879.8059s
	iters: 200, epoch: 25 | loss: 0.4052280
	speed: 0.0908s/iter; left time: 2528.8781s
	iters: 300, epoch: 25 | loss: 0.3531719
	speed: 0.0955s/iter; left time: 2649.4717s
Epoch: 25 cost time: 35.35538101196289
Epoch: 25, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.373 Vali Acc: 0.651 Test Loss: 1.373 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6606129398410897
model parameter : 583106
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.3917608
	speed: 0.0758s/iter; left time: 2789.1550s
	iters: 200, epoch: 1 | loss: 0.8125090
	speed: 0.0559s/iter; left time: 2052.2883s
	iters: 300, epoch: 1 | loss: 0.9540831
	speed: 0.0582s/iter; left time: 2129.6894s
Epoch: 1 cost time: 23.230672597885132
Epoch: 1, Steps: 369 | Train Loss: 1.112 Vali Loss: 0.912 Vali Acc: 0.654 Test Loss: 0.912 Test Acc: 0.654
Validation loss decreased (inf --> -0.654077).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3519063
	speed: 0.3557s/iter; left time: 12958.9600s
	iters: 200, epoch: 2 | loss: 2.1743860
	speed: 0.1209s/iter; left time: 4392.7584s
	iters: 300, epoch: 2 | loss: 1.1386708
	speed: 0.1218s/iter; left time: 4412.2036s
Epoch: 2 cost time: 45.46784210205078
Epoch: 2, Steps: 369 | Train Loss: 1.719 Vali Loss: 1.544 Vali Acc: 0.644 Test Loss: 1.544 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3398116
	speed: 0.4361s/iter; left time: 15728.8634s
	iters: 200, epoch: 3 | loss: 2.2916472
	speed: 0.1203s/iter; left time: 4326.4334s
	iters: 300, epoch: 3 | loss: 4.8795371
	speed: 0.1197s/iter; left time: 4291.9145s
Epoch: 3 cost time: 45.00752902030945
Epoch: 3, Steps: 369 | Train Loss: 2.345 Vali Loss: 2.624 Vali Acc: 0.651 Test Loss: 2.624 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.8571825
	speed: 0.4490s/iter; left time: 16025.4503s
	iters: 200, epoch: 4 | loss: 0.6538306
	speed: 0.1211s/iter; left time: 4311.5588s
	iters: 300, epoch: 4 | loss: 2.6705477
	speed: 0.1225s/iter; left time: 4348.1460s
Epoch: 4 cost time: 45.70986294746399
Epoch: 4, Steps: 369 | Train Loss: 2.749 Vali Loss: 4.783 Vali Acc: 0.636 Test Loss: 4.783 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.0353291
	speed: 0.4472s/iter; left time: 15795.9356s
	iters: 200, epoch: 5 | loss: 2.8850460
	speed: 0.1254s/iter; left time: 4418.3761s
	iters: 300, epoch: 5 | loss: 3.6057637
	speed: 0.1254s/iter; left time: 4406.3811s
Epoch: 5 cost time: 46.920626401901245
Epoch: 5, Steps: 369 | Train Loss: 2.948 Vali Loss: 4.459 Vali Acc: 0.601 Test Loss: 4.459 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.8004415
	speed: 0.4496s/iter; left time: 15715.8529s
	iters: 200, epoch: 6 | loss: 2.7923899
	speed: 0.1238s/iter; left time: 4316.6635s
	iters: 300, epoch: 6 | loss: 1.8652180
	speed: 0.1240s/iter; left time: 4310.0841s
Epoch: 6 cost time: 46.50871276855469
Epoch: 6, Steps: 369 | Train Loss: 3.093 Vali Loss: 4.385 Vali Acc: 0.647 Test Loss: 4.385 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.6271877
	speed: 0.4546s/iter; left time: 15722.5789s
	iters: 200, epoch: 7 | loss: 1.1161492
	speed: 0.1238s/iter; left time: 4270.5484s
	iters: 300, epoch: 7 | loss: 1.8258533
	speed: 0.1233s/iter; left time: 4239.0369s
Epoch: 7 cost time: 46.35299491882324
Epoch: 7, Steps: 369 | Train Loss: 2.958 Vali Loss: 3.181 Vali Acc: 0.654 Test Loss: 3.181 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 5.0364904
	speed: 0.4518s/iter; left time: 15460.1587s
	iters: 200, epoch: 8 | loss: 4.2750506
	speed: 0.1223s/iter; left time: 4173.6099s
	iters: 300, epoch: 8 | loss: 4.3455887
	speed: 0.1136s/iter; left time: 3863.0498s
Epoch: 8 cost time: 45.01267337799072
Epoch: 8, Steps: 369 | Train Loss: 2.759 Vali Loss: 3.307 Vali Acc: 0.642 Test Loss: 3.307 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 3.2592232
	speed: 0.4369s/iter; left time: 14790.1632s
	iters: 200, epoch: 9 | loss: 1.3884840
	speed: 0.1176s/iter; left time: 3967.2824s
	iters: 300, epoch: 9 | loss: 5.1963315
	speed: 0.1174s/iter; left time: 3948.9442s
Epoch: 9 cost time: 44.44438314437866
Epoch: 9, Steps: 369 | Train Loss: 2.557 Vali Loss: 4.175 Vali Acc: 0.627 Test Loss: 4.175 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.1048944
	speed: 0.4358s/iter; left time: 14590.5497s
	iters: 200, epoch: 10 | loss: 2.6789966
	speed: 0.1210s/iter; left time: 4040.4333s
	iters: 300, epoch: 10 | loss: 2.7478819
	speed: 0.1201s/iter; left time: 3995.2939s
Epoch: 10 cost time: 45.09387254714966
Epoch: 10, Steps: 369 | Train Loss: 2.176 Vali Loss: 3.619 Vali Acc: 0.659 Test Loss: 3.619 Test Acc: 0.659
Validation loss decreased (-0.654077 --> -0.659158).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6373039
	speed: 0.4311s/iter; left time: 14275.6345s
	iters: 200, epoch: 11 | loss: 0.2337733
	speed: 0.1180s/iter; left time: 3896.9191s
	iters: 300, epoch: 11 | loss: 3.1963553
	speed: 0.1174s/iter; left time: 3864.0533s
Epoch: 11 cost time: 44.59234976768494
Epoch: 11, Steps: 369 | Train Loss: 1.886 Vali Loss: 3.176 Vali Acc: 0.643 Test Loss: 3.176 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9037955
	speed: 0.4262s/iter; left time: 13955.5958s
	iters: 200, epoch: 12 | loss: 1.3658791
	speed: 0.1187s/iter; left time: 3875.7012s
	iters: 300, epoch: 12 | loss: 2.6994081
	speed: 0.1190s/iter; left time: 3872.5758s
Epoch: 12 cost time: 44.64338231086731
Epoch: 12, Steps: 369 | Train Loss: 1.530 Vali Loss: 3.284 Vali Acc: 0.647 Test Loss: 3.284 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.1915348
	speed: 0.4270s/iter; left time: 13822.5703s
	iters: 200, epoch: 13 | loss: 1.0433848
	speed: 0.1175s/iter; left time: 3791.3470s
	iters: 300, epoch: 13 | loss: 0.6869966
	speed: 0.1126s/iter; left time: 3623.6448s
Epoch: 13 cost time: 42.6977744102478
Epoch: 13, Steps: 369 | Train Loss: 1.229 Vali Loss: 2.065 Vali Acc: 0.642 Test Loss: 2.065 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2546711
	speed: 0.4278s/iter; left time: 13690.1915s
	iters: 200, epoch: 14 | loss: 1.8561962
	speed: 0.1187s/iter; left time: 3786.3106s
	iters: 300, epoch: 14 | loss: 0.0401644
	speed: 0.1189s/iter; left time: 3782.1509s
Epoch: 14 cost time: 44.693986654281616
Epoch: 14, Steps: 369 | Train Loss: 0.847 Vali Loss: 1.902 Vali Acc: 0.648 Test Loss: 1.902 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2768626
	speed: 0.4441s/iter; left time: 14048.4740s
	iters: 200, epoch: 15 | loss: 0.6839538
	speed: 0.1229s/iter; left time: 3876.9155s
	iters: 300, epoch: 15 | loss: 0.9144390
	speed: 0.1230s/iter; left time: 3867.6574s
Epoch: 15 cost time: 46.02229857444763
Epoch: 15, Steps: 369 | Train Loss: 0.553 Vali Loss: 1.475 Vali Acc: 0.657 Test Loss: 1.475 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1827845
	speed: 0.4491s/iter; left time: 14042.9788s
	iters: 200, epoch: 16 | loss: 0.3176727
	speed: 0.1236s/iter; left time: 3851.4308s
	iters: 300, epoch: 16 | loss: 0.2622039
	speed: 0.1237s/iter; left time: 3843.1731s
Epoch: 16 cost time: 46.35083556175232
Epoch: 16, Steps: 369 | Train Loss: 0.359 Vali Loss: 1.182 Vali Acc: 0.658 Test Loss: 1.182 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.4165468
	speed: 0.4444s/iter; left time: 13731.6051s
	iters: 200, epoch: 17 | loss: 0.6216432
	speed: 0.1231s/iter; left time: 3791.7853s
	iters: 300, epoch: 17 | loss: 0.2936478
	speed: 0.1237s/iter; left time: 3797.9090s
Epoch: 17 cost time: 46.15697264671326
Epoch: 17, Steps: 369 | Train Loss: 0.290 Vali Loss: 1.144 Vali Acc: 0.647 Test Loss: 1.144 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3200575
	speed: 0.4468s/iter; left time: 13639.9058s
	iters: 200, epoch: 18 | loss: 0.2128098
	speed: 0.1208s/iter; left time: 3676.8528s
	iters: 300, epoch: 18 | loss: 0.1932272
	speed: 0.1216s/iter; left time: 3689.0716s
Epoch: 18 cost time: 45.459303855895996
Epoch: 18, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.186 Vali Acc: 0.646 Test Loss: 1.186 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2713471
	speed: 0.4509s/iter; left time: 13598.6663s
	iters: 200, epoch: 19 | loss: 0.2803040
	speed: 0.1226s/iter; left time: 3684.5761s
	iters: 300, epoch: 19 | loss: 0.4774920
	speed: 0.1225s/iter; left time: 3671.0649s
Epoch: 19 cost time: 45.933290243148804
Epoch: 19, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.334 Vali Acc: 0.638 Test Loss: 1.334 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1781610
	speed: 0.4357s/iter; left time: 12978.5001s
	iters: 200, epoch: 20 | loss: 0.1838010
	speed: 0.1205s/iter; left time: 3578.4305s
	iters: 300, epoch: 20 | loss: 0.0477130
	speed: 0.1204s/iter; left time: 3562.5601s
Epoch: 20 cost time: 44.36299729347229
Epoch: 20, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.463 Vali Acc: 0.644 Test Loss: 1.463 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6591940976163451
model parameter : 509762
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1941082
	speed: 0.7849s/iter; left time: 28885.3587s
	iters: 200, epoch: 1 | loss: 1.4263073
	speed: 0.7328s/iter; left time: 26895.7713s
	iters: 300, epoch: 1 | loss: 3.1993525
	speed: 0.7156s/iter; left time: 26192.1732s
Epoch: 1 cost time: 274.6276309490204
Epoch: 1, Steps: 369 | Train Loss: 2.184 Vali Loss: 1.369 Vali Acc: 0.657 Test Loss: 1.369 Test Acc: 0.657
Validation loss decreased (inf --> -0.656626).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.9031172
	speed: 2.3108s/iter; left time: 84186.3769s
	iters: 200, epoch: 2 | loss: 3.9444671
	speed: 0.7390s/iter; left time: 26850.2494s
	iters: 300, epoch: 2 | loss: 2.7131748
	speed: 0.7431s/iter; left time: 26924.7788s
Epoch: 2 cost time: 276.3008654117584
Epoch: 2, Steps: 369 | Train Loss: 3.461 Vali Loss: 3.128 Vali Acc: 0.584 Test Loss: 3.128 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2377512
	speed: 2.2783s/iter; left time: 82162.4175s
	iters: 200, epoch: 3 | loss: 3.3391614
	speed: 0.7166s/iter; left time: 25772.3204s
	iters: 300, epoch: 3 | loss: 1.8275759
	speed: 0.7259s/iter; left time: 26034.2736s
Epoch: 3 cost time: 266.277131319046
Epoch: 3, Steps: 369 | Train Loss: 4.852 Vali Loss: 4.944 Vali Acc: 0.646 Test Loss: 4.944 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 8.0538692
	speed: 2.2653s/iter; left time: 80855.9708s
	iters: 200, epoch: 4 | loss: 6.3535495
	speed: 0.7524s/iter; left time: 26781.3745s
	iters: 300, epoch: 4 | loss: 7.6095452
	speed: 0.7480s/iter; left time: 26548.6437s
Epoch: 4 cost time: 277.96128845214844
Epoch: 4, Steps: 369 | Train Loss: 5.258 Vali Loss: 7.141 Vali Acc: 0.625 Test Loss: 7.141 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 8.8339577
	speed: 2.2816s/iter; left time: 80596.4192s
	iters: 200, epoch: 5 | loss: 5.1802692
	speed: 0.7208s/iter; left time: 25388.7475s
	iters: 300, epoch: 5 | loss: 9.5360203
	speed: 0.7351s/iter; left time: 25821.3908s
Epoch: 5 cost time: 270.03445744514465
Epoch: 5, Steps: 369 | Train Loss: 4.932 Vali Loss: 7.281 Vali Acc: 0.640 Test Loss: 7.281 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 7.5410442
	speed: 2.2654s/iter; left time: 79189.8876s
	iters: 200, epoch: 6 | loss: 3.2718167
	speed: 0.7517s/iter; left time: 26202.1068s
	iters: 300, epoch: 6 | loss: 3.7314146
	speed: 0.7376s/iter; left time: 25634.8289s
Epoch: 6 cost time: 274.5924699306488
Epoch: 6, Steps: 369 | Train Loss: 4.600 Vali Loss: 9.138 Vali Acc: 0.646 Test Loss: 9.138 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 11.2003708
	speed: 2.3045s/iter; left time: 79707.1549s
	iters: 200, epoch: 7 | loss: 14.5578737
	speed: 0.7441s/iter; left time: 25661.8485s
	iters: 300, epoch: 7 | loss: 4.0132108
	speed: 0.7328s/iter; left time: 25198.9729s
Epoch: 7 cost time: 276.60018825531006
Epoch: 7, Steps: 369 | Train Loss: 3.926 Vali Loss: 8.135 Vali Acc: 0.638 Test Loss: 8.135 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7327842
	speed: 2.2865s/iter; left time: 78239.0105s
	iters: 200, epoch: 8 | loss: 4.6113758
	speed: 0.7286s/iter; left time: 24859.5686s
	iters: 300, epoch: 8 | loss: 5.7177896
	speed: 0.7333s/iter; left time: 24945.0252s
Epoch: 8 cost time: 273.3880524635315
Epoch: 8, Steps: 369 | Train Loss: 2.793 Vali Loss: 10.756 Vali Acc: 0.617 Test Loss: 10.756 Test Acc: 0.617
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.2856808
	speed: 2.3059s/iter; left time: 78050.9532s
	iters: 200, epoch: 9 | loss: 1.7396319
	speed: 0.7371s/iter; left time: 24875.6684s
	iters: 300, epoch: 9 | loss: 1.8858873
	speed: 0.7434s/iter; left time: 25015.7135s
Epoch: 9 cost time: 273.9313519001007
Epoch: 9, Steps: 369 | Train Loss: 1.866 Vali Loss: 11.743 Vali Acc: 0.627 Test Loss: 11.743 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.3484550
	speed: 2.2795s/iter; left time: 76316.9581s
	iters: 200, epoch: 10 | loss: 2.2504668
	speed: 0.7132s/iter; left time: 23806.8364s
	iters: 300, epoch: 10 | loss: 4.6092720
	speed: 0.7425s/iter; left time: 24709.2318s
Epoch: 10 cost time: 271.2902147769928
Epoch: 10, Steps: 369 | Train Loss: 1.212 Vali Loss: 8.048 Vali Acc: 0.612 Test Loss: 8.048 Test Acc: 0.612
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0003495
	speed: 2.2964s/iter; left time: 76037.4784s
	iters: 200, epoch: 11 | loss: 0.0003390
	speed: 0.7487s/iter; left time: 24715.3876s
	iters: 300, epoch: 11 | loss: 0.0984113
	speed: 0.7658s/iter; left time: 25204.3959s
Epoch: 11 cost time: 278.0550835132599
Epoch: 11, Steps: 369 | Train Loss: 0.901 Vali Loss: 9.202 Vali Acc: 0.638 Test Loss: 9.202 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6566401816118048
model parameter : 1292994
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.4539020
	speed: 0.3495s/iter; left time: 12861.5242s
	iters: 200, epoch: 1 | loss: 1.4785310
	speed: 0.3215s/iter; left time: 11798.9176s
	iters: 300, epoch: 1 | loss: 0.9128549
	speed: 0.3273s/iter; left time: 11978.9880s
Epoch: 1 cost time: 123.93422675132751
Epoch: 1, Steps: 369 | Train Loss: 1.662 Vali Loss: 1.345 Vali Acc: 0.654 Test Loss: 1.345 Test Acc: 0.654
Validation loss decreased (inf --> -0.654357).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6562715
	speed: 1.1271s/iter; left time: 41062.5453s
	iters: 200, epoch: 2 | loss: 4.0113993
	speed: 0.3322s/iter; left time: 12070.5488s
	iters: 300, epoch: 2 | loss: 3.9858794
	speed: 0.3468s/iter; left time: 12566.8370s
Epoch: 2 cost time: 126.75450539588928
Epoch: 2, Steps: 369 | Train Loss: 2.537 Vali Loss: 1.532 Vali Acc: 0.646 Test Loss: 1.532 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6976686
	speed: 1.1725s/iter; left time: 42283.8615s
	iters: 200, epoch: 3 | loss: 3.1492956
	speed: 0.3664s/iter; left time: 13176.6852s
	iters: 300, epoch: 3 | loss: 5.9766488
	speed: 0.3680s/iter; left time: 13199.1154s
Epoch: 3 cost time: 135.4809114933014
Epoch: 3, Steps: 369 | Train Loss: 3.275 Vali Loss: 2.398 Vali Acc: 0.639 Test Loss: 2.398 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.5403047
	speed: 1.2063s/iter; left time: 43056.3233s
	iters: 200, epoch: 4 | loss: 5.2971191
	speed: 0.3622s/iter; left time: 12892.9371s
	iters: 300, epoch: 4 | loss: 5.8888569
	speed: 0.3651s/iter; left time: 12960.1414s
Epoch: 4 cost time: 134.92244839668274
Epoch: 4, Steps: 369 | Train Loss: 3.783 Vali Loss: 10.791 Vali Acc: 0.501 Test Loss: 10.791 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.8596482
	speed: 1.2017s/iter; left time: 42451.1193s
	iters: 200, epoch: 5 | loss: 1.6426512
	speed: 0.3628s/iter; left time: 12779.0441s
	iters: 300, epoch: 5 | loss: 4.8002524
	speed: 0.3626s/iter; left time: 12734.6414s
Epoch: 5 cost time: 134.22692012786865
Epoch: 5, Steps: 369 | Train Loss: 3.854 Vali Loss: 5.029 Vali Acc: 0.667 Test Loss: 5.029 Test Acc: 0.667
Validation loss decreased (-0.654357 --> -0.666806).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.5430079
	speed: 1.1899s/iter; left time: 41592.9299s
	iters: 200, epoch: 6 | loss: 2.8342764
	speed: 0.3625s/iter; left time: 12633.5630s
	iters: 300, epoch: 6 | loss: 2.3931293
	speed: 0.3532s/iter; left time: 12274.6321s
Epoch: 6 cost time: 132.18848204612732
Epoch: 6, Steps: 369 | Train Loss: 3.649 Vali Loss: 5.695 Vali Acc: 0.660 Test Loss: 5.695 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0343015
	speed: 1.1892s/iter; left time: 41131.8957s
	iters: 200, epoch: 7 | loss: 1.8485850
	speed: 0.3725s/iter; left time: 12847.5090s
	iters: 300, epoch: 7 | loss: 0.8897029
	speed: 0.3735s/iter; left time: 12843.3725s
Epoch: 7 cost time: 137.14949202537537
Epoch: 7, Steps: 369 | Train Loss: 2.901 Vali Loss: 6.052 Vali Acc: 0.644 Test Loss: 6.052 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.5602591
	speed: 1.2105s/iter; left time: 41421.7383s
	iters: 200, epoch: 8 | loss: 0.9037145
	speed: 0.3606s/iter; left time: 12301.5064s
	iters: 300, epoch: 8 | loss: 0.5793063
	speed: 0.3599s/iter; left time: 12242.3934s
Epoch: 8 cost time: 134.0072512626648
Epoch: 8, Steps: 369 | Train Loss: 2.313 Vali Loss: 3.705 Vali Acc: 0.636 Test Loss: 3.705 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0364480
	speed: 1.2309s/iter; left time: 41664.9785s
	iters: 200, epoch: 9 | loss: 0.5817422
	speed: 0.3700s/iter; left time: 12488.3521s
	iters: 300, epoch: 9 | loss: 0.9203361
	speed: 0.3686s/iter; left time: 12403.6037s
Epoch: 9 cost time: 137.32294178009033
Epoch: 9, Steps: 369 | Train Loss: 1.413 Vali Loss: 3.918 Vali Acc: 0.633 Test Loss: 3.918 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1137704
	speed: 1.1802s/iter; left time: 39514.0843s
	iters: 200, epoch: 10 | loss: 0.3152185
	speed: 0.3564s/iter; left time: 11895.1986s
	iters: 300, epoch: 10 | loss: 2.1226962
	speed: 0.3564s/iter; left time: 11860.3658s
Epoch: 10 cost time: 132.56800532341003
Epoch: 10, Steps: 369 | Train Loss: 0.795 Vali Loss: 3.488 Vali Acc: 0.633 Test Loss: 3.488 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0050145
	speed: 1.1968s/iter; left time: 39628.0121s
	iters: 200, epoch: 11 | loss: 0.4742471
	speed: 0.3646s/iter; left time: 12036.5473s
	iters: 300, epoch: 11 | loss: 0.0171294
	speed: 0.3658s/iter; left time: 12039.8725s
Epoch: 11 cost time: 135.2184522151947
Epoch: 11, Steps: 369 | Train Loss: 0.406 Vali Loss: 2.227 Vali Acc: 0.629 Test Loss: 2.227 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0963749
	speed: 1.1992s/iter; left time: 39262.9619s
	iters: 200, epoch: 12 | loss: 0.2293754
	speed: 0.3606s/iter; left time: 11769.5431s
	iters: 300, epoch: 12 | loss: 0.1224382
	speed: 0.3656s/iter; left time: 11898.9422s
Epoch: 12 cost time: 135.29212737083435
Epoch: 12, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.871 Vali Acc: 0.637 Test Loss: 1.871 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1995182
	speed: 1.2307s/iter; left time: 39840.9317s
	iters: 200, epoch: 13 | loss: 0.1244598
	speed: 0.3729s/iter; left time: 12035.5984s
	iters: 300, epoch: 13 | loss: 0.0093649
	speed: 0.3642s/iter; left time: 11717.3818s
Epoch: 13 cost time: 136.8192639350891
Epoch: 13, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.795 Vali Acc: 0.646 Test Loss: 1.795 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1407273
	speed: 1.2047s/iter; left time: 38554.1775s
	iters: 200, epoch: 14 | loss: 0.0062133
	speed: 0.3651s/iter; left time: 11647.7361s
	iters: 300, epoch: 14 | loss: 0.3280865
	speed: 0.3604s/iter; left time: 11462.0238s
Epoch: 14 cost time: 135.14450192451477
Epoch: 14, Steps: 369 | Train Loss: 0.078 Vali Loss: 1.991 Vali Acc: 0.648 Test Loss: 1.991 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0676447
	speed: 1.2119s/iter; left time: 38337.9459s
	iters: 200, epoch: 15 | loss: 0.0168070
	speed: 0.3520s/iter; left time: 11101.6962s
	iters: 300, epoch: 15 | loss: 0.0109119
	speed: 0.3393s/iter; left time: 10665.4918s
Epoch: 15 cost time: 130.37136912345886
Epoch: 15, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.956 Vali Acc: 0.647 Test Loss: 1.956 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6668558456299659
model parameter : 721730
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1297029
	speed: 0.2859s/iter; left time: 10521.4260s
	iters: 200, epoch: 1 | loss: 1.5179588
	speed: 0.2664s/iter; left time: 9778.8179s
	iters: 300, epoch: 1 | loss: 1.0640984
	speed: 0.2675s/iter; left time: 9790.1323s
Epoch: 1 cost time: 100.6940586566925
Epoch: 1, Steps: 369 | Train Loss: 1.326 Vali Loss: 2.551 Vali Acc: 0.551 Test Loss: 2.551 Test Acc: 0.551
Validation loss decreased (inf --> -0.551053).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3713288
	speed: 0.9121s/iter; left time: 33231.4152s
	iters: 200, epoch: 2 | loss: 2.6394899
	speed: 0.2734s/iter; left time: 9931.4564s
	iters: 300, epoch: 2 | loss: 1.3819983
	speed: 0.2739s/iter; left time: 9924.2462s
Epoch: 2 cost time: 100.85575366020203
Epoch: 2, Steps: 369 | Train Loss: 1.985 Vali Loss: 1.530 Vali Acc: 0.661 Test Loss: 1.530 Test Acc: 0.661
Validation loss decreased (-0.551053 --> -0.661449).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4532959
	speed: 0.9416s/iter; left time: 33956.5628s
	iters: 200, epoch: 3 | loss: 3.4364829
	speed: 0.2801s/iter; left time: 10073.2410s
	iters: 300, epoch: 3 | loss: 2.2283690
	speed: 0.2818s/iter; left time: 10106.5594s
Epoch: 3 cost time: 104.23743605613708
Epoch: 3, Steps: 369 | Train Loss: 2.752 Vali Loss: 3.534 Vali Acc: 0.644 Test Loss: 3.534 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6368926
	speed: 0.9485s/iter; left time: 33857.2970s
	iters: 200, epoch: 4 | loss: 1.8618636
	speed: 0.2781s/iter; left time: 9899.4514s
	iters: 300, epoch: 4 | loss: 2.1809182
	speed: 0.2714s/iter; left time: 9633.3223s
Epoch: 4 cost time: 102.14833545684814
Epoch: 4, Steps: 369 | Train Loss: 3.090 Vali Loss: 2.820 Vali Acc: 0.660 Test Loss: 2.820 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 5.4179506
	speed: 0.8846s/iter; left time: 31248.7440s
	iters: 200, epoch: 5 | loss: 1.8827505
	speed: 0.2387s/iter; left time: 8409.6603s
	iters: 300, epoch: 5 | loss: 3.6516023
	speed: 0.2416s/iter; left time: 8486.5760s
Epoch: 5 cost time: 89.70570302009583
Epoch: 5, Steps: 369 | Train Loss: 3.047 Vali Loss: 5.579 Vali Acc: 0.650 Test Loss: 5.579 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.6743207
	speed: 0.8612s/iter; left time: 30104.6173s
	iters: 200, epoch: 6 | loss: 5.7229376
	speed: 0.2523s/iter; left time: 8792.4841s
	iters: 300, epoch: 6 | loss: 1.3907675
	speed: 0.2658s/iter; left time: 9239.4931s
Epoch: 6 cost time: 96.14715504646301
Epoch: 6, Steps: 369 | Train Loss: 2.887 Vali Loss: 4.006 Vali Acc: 0.647 Test Loss: 4.006 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.2953870
	speed: 0.9116s/iter; left time: 31529.8105s
	iters: 200, epoch: 7 | loss: 1.2665564
	speed: 0.2645s/iter; left time: 9121.6853s
	iters: 300, epoch: 7 | loss: 4.3681273
	speed: 0.2667s/iter; left time: 9169.8503s
Epoch: 7 cost time: 98.87451815605164
Epoch: 7, Steps: 369 | Train Loss: 2.492 Vali Loss: 3.317 Vali Acc: 0.648 Test Loss: 3.317 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.8147373
	speed: 0.9374s/iter; left time: 32076.7212s
	iters: 200, epoch: 8 | loss: 1.5225066
	speed: 0.2805s/iter; left time: 9568.6594s
	iters: 300, epoch: 8 | loss: 2.0888541
	speed: 0.2784s/iter; left time: 9469.8790s
Epoch: 8 cost time: 103.08596086502075
Epoch: 8, Steps: 369 | Train Loss: 1.963 Vali Loss: 2.911 Vali Acc: 0.644 Test Loss: 2.911 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2409925
	speed: 0.9613s/iter; left time: 32537.8180s
	iters: 200, epoch: 9 | loss: 0.8990500
	speed: 0.2818s/iter; left time: 9511.3175s
	iters: 300, epoch: 9 | loss: 1.6356521
	speed: 0.2802s/iter; left time: 9429.4412s
Epoch: 9 cost time: 104.17173075675964
Epoch: 9, Steps: 369 | Train Loss: 1.255 Vali Loss: 2.591 Vali Acc: 0.653 Test Loss: 2.591 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.0808232
	speed: 0.9331s/iter; left time: 31240.7146s
	iters: 200, epoch: 10 | loss: 0.1340624
	speed: 0.2682s/iter; left time: 8952.9657s
	iters: 300, epoch: 10 | loss: 0.3560860
	speed: 0.2653s/iter; left time: 8828.1241s
Epoch: 10 cost time: 99.70361495018005
Epoch: 10, Steps: 369 | Train Loss: 0.750 Vali Loss: 2.524 Vali Acc: 0.641 Test Loss: 2.524 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0994380
	speed: 0.9166s/iter; left time: 30350.8874s
	iters: 200, epoch: 11 | loss: 0.2111723
	speed: 0.2681s/iter; left time: 8851.7716s
	iters: 300, epoch: 11 | loss: 0.0602432
	speed: 0.2742s/iter; left time: 9025.0079s
Epoch: 11 cost time: 100.5297794342041
Epoch: 11, Steps: 369 | Train Loss: 0.373 Vali Loss: 1.596 Vali Acc: 0.640 Test Loss: 1.596 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1462870
	speed: 0.9204s/iter; left time: 30136.8210s
	iters: 200, epoch: 12 | loss: 0.6193755
	speed: 0.2470s/iter; left time: 8063.8245s
	iters: 300, epoch: 12 | loss: 0.1771223
	speed: 0.2623s/iter; left time: 8537.3290s
Epoch: 12 cost time: 95.98699927330017
Epoch: 12, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.424 Vali Acc: 0.646 Test Loss: 1.424 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6614642451759364
model parameter : 537474
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8166567
	speed: 0.2165s/iter; left time: 7969.1193s
	iters: 200, epoch: 1 | loss: 0.9460280
	speed: 0.1971s/iter; left time: 7234.7248s
	iters: 300, epoch: 1 | loss: 1.5483303
	speed: 0.1968s/iter; left time: 7204.0913s
Epoch: 1 cost time: 74.86373472213745
Epoch: 1, Steps: 369 | Train Loss: 1.206 Vali Loss: 1.101 Vali Acc: 0.657 Test Loss: 1.101 Test Acc: 0.657
Validation loss decreased (inf --> -0.657480).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6603811
	speed: 0.6745s/iter; left time: 24573.8034s
	iters: 200, epoch: 2 | loss: 1.6288141
	speed: 0.1971s/iter; left time: 7160.9114s
	iters: 300, epoch: 2 | loss: 2.0000420
	speed: 0.1970s/iter; left time: 7136.9591s
Epoch: 2 cost time: 73.18051958084106
Epoch: 2, Steps: 369 | Train Loss: 1.686 Vali Loss: 2.346 Vali Acc: 0.636 Test Loss: 2.346 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9205523
	speed: 0.6658s/iter; left time: 24011.1249s
	iters: 200, epoch: 3 | loss: 2.1225042
	speed: 0.1960s/iter; left time: 7047.0443s
	iters: 300, epoch: 3 | loss: 2.6231010
	speed: 0.1966s/iter; left time: 7049.7522s
Epoch: 3 cost time: 72.6827826499939
Epoch: 3, Steps: 369 | Train Loss: 2.305 Vali Loss: 1.814 Vali Acc: 0.633 Test Loss: 1.814 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.4733891
	speed: 0.6625s/iter; left time: 23647.1957s
	iters: 200, epoch: 4 | loss: 2.4434032
	speed: 0.1871s/iter; left time: 6658.8449s
	iters: 300, epoch: 4 | loss: 0.5281685
	speed: 0.1930s/iter; left time: 6851.3968s
Epoch: 4 cost time: 71.42481851577759
Epoch: 4, Steps: 369 | Train Loss: 2.494 Vali Loss: 5.250 Vali Acc: 0.636 Test Loss: 5.250 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8182267
	speed: 0.6556s/iter; left time: 23160.7467s
	iters: 200, epoch: 5 | loss: 1.0061067
	speed: 0.1887s/iter; left time: 6645.5520s
	iters: 300, epoch: 5 | loss: 2.9924035
	speed: 0.1894s/iter; left time: 6653.9591s
Epoch: 5 cost time: 69.06671929359436
Epoch: 5, Steps: 369 | Train Loss: 2.514 Vali Loss: 3.698 Vali Acc: 0.631 Test Loss: 3.698 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9669564
	speed: 0.6469s/iter; left time: 22612.2561s
	iters: 200, epoch: 6 | loss: 2.8700862
	speed: 0.1928s/iter; left time: 6719.9680s
	iters: 300, epoch: 6 | loss: 3.1087399
	speed: 0.1901s/iter; left time: 6605.5128s
Epoch: 6 cost time: 71.41723155975342
Epoch: 6, Steps: 369 | Train Loss: 2.311 Vali Loss: 3.410 Vali Acc: 0.637 Test Loss: 3.410 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 4.1329536
	speed: 0.6516s/iter; left time: 22536.0557s
	iters: 200, epoch: 7 | loss: 0.6586083
	speed: 0.1842s/iter; left time: 6353.6464s
	iters: 300, epoch: 7 | loss: 1.9431653
	speed: 0.1800s/iter; left time: 6190.4384s
Epoch: 7 cost time: 69.07589077949524
Epoch: 7, Steps: 369 | Train Loss: 2.117 Vali Loss: 4.838 Vali Acc: 0.632 Test Loss: 4.838 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.6931162
	speed: 0.6661s/iter; left time: 22791.8480s
	iters: 200, epoch: 8 | loss: 2.6363640
	speed: 0.1958s/iter; left time: 6681.8028s
	iters: 300, epoch: 8 | loss: 2.9312210
	speed: 0.1973s/iter; left time: 6711.2426s
Epoch: 8 cost time: 73.05965638160706
Epoch: 8, Steps: 369 | Train Loss: 1.578 Vali Loss: 3.675 Vali Acc: 0.642 Test Loss: 3.675 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0702838
	speed: 0.6612s/iter; left time: 22381.4092s
	iters: 200, epoch: 9 | loss: 1.8472900
	speed: 0.1971s/iter; left time: 6652.4433s
	iters: 300, epoch: 9 | loss: 1.1193194
	speed: 0.1980s/iter; left time: 6661.7152s
Epoch: 9 cost time: 72.92028880119324
Epoch: 9, Steps: 369 | Train Loss: 1.063 Vali Loss: 2.792 Vali Acc: 0.630 Test Loss: 2.792 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.1992637
	speed: 0.6760s/iter; left time: 22632.2821s
	iters: 200, epoch: 10 | loss: 0.1346245
	speed: 0.1979s/iter; left time: 6605.9942s
	iters: 300, epoch: 10 | loss: 0.7420000
	speed: 0.1970s/iter; left time: 6554.8203s
Epoch: 10 cost time: 73.66048955917358
Epoch: 10, Steps: 369 | Train Loss: 0.683 Vali Loss: 2.256 Vali Acc: 0.624 Test Loss: 2.256 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.2159645
	speed: 0.6750s/iter; left time: 22348.9941s
	iters: 200, epoch: 11 | loss: 0.1706415
	speed: 0.1965s/iter; left time: 6487.8971s
	iters: 300, epoch: 11 | loss: 0.3133712
	speed: 0.1963s/iter; left time: 6459.5128s
Epoch: 11 cost time: 73.28653216362
Epoch: 11, Steps: 369 | Train Loss: 0.319 Vali Loss: 1.442 Vali Acc: 0.629 Test Loss: 1.442 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6574914869466515
model parameter : 427010
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.9980451
	speed: 0.1820s/iter; left time: 6695.9675s
	iters: 200, epoch: 1 | loss: 1.5413536
	speed: 0.1504s/iter; left time: 5520.6559s
	iters: 300, epoch: 1 | loss: 0.7059880
	speed: 0.1418s/iter; left time: 5191.6260s
Epoch: 1 cost time: 57.96341109275818
Epoch: 1, Steps: 369 | Train Loss: 1.078 Vali Loss: 1.099 Vali Acc: 0.648 Test Loss: 1.099 Test Acc: 0.648
Validation loss decreased (inf --> -0.647549).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8533751
	speed: 0.5218s/iter; left time: 19010.4039s
	iters: 200, epoch: 2 | loss: 1.2725323
	speed: 0.1503s/iter; left time: 5462.3304s
	iters: 300, epoch: 2 | loss: 1.7480098
	speed: 0.1490s/iter; left time: 5400.2266s
Epoch: 2 cost time: 55.96233773231506
Epoch: 2, Steps: 369 | Train Loss: 1.489 Vali Loss: 2.123 Vali Acc: 0.645 Test Loss: 2.123 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1421921
	speed: 0.5345s/iter; left time: 19274.6001s
	iters: 200, epoch: 3 | loss: 2.2595251
	speed: 0.1490s/iter; left time: 5360.1033s
	iters: 300, epoch: 3 | loss: 0.9034810
	speed: 0.1482s/iter; left time: 5315.8794s
Epoch: 3 cost time: 52.95752310752869
Epoch: 3, Steps: 369 | Train Loss: 2.000 Vali Loss: 2.239 Vali Acc: 0.647 Test Loss: 2.239 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.5998864
	speed: 0.4562s/iter; left time: 16283.6354s
	iters: 200, epoch: 4 | loss: 1.5383654
	speed: 0.1674s/iter; left time: 5960.1111s
	iters: 300, epoch: 4 | loss: 2.7704165
	speed: 0.1679s/iter; left time: 5959.1213s
Epoch: 4 cost time: 62.713775873184204
Epoch: 4, Steps: 369 | Train Loss: 2.209 Vali Loss: 5.785 Vali Acc: 0.550 Test Loss: 5.785 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.3503678
	speed: 0.6007s/iter; left time: 21219.3551s
	iters: 200, epoch: 5 | loss: 2.3889260
	speed: 0.1690s/iter; left time: 5953.6589s
	iters: 300, epoch: 5 | loss: 1.9494640
	speed: 0.1724s/iter; left time: 6055.9797s
Epoch: 5 cost time: 58.44003963470459
Epoch: 5, Steps: 369 | Train Loss: 2.141 Vali Loss: 2.744 Vali Acc: 0.649 Test Loss: 2.744 Test Acc: 0.649
Validation loss decreased (-0.647549 --> -0.648951).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0161943
	speed: 0.3294s/iter; left time: 11513.7108s
	iters: 200, epoch: 6 | loss: 1.8158985
	speed: 0.0859s/iter; left time: 2993.2727s
	iters: 300, epoch: 6 | loss: 4.0037165
	speed: 0.0859s/iter; left time: 2984.0030s
Epoch: 6 cost time: 32.54475998878479
Epoch: 6, Steps: 369 | Train Loss: 1.978 Vali Loss: 2.359 Vali Acc: 0.651 Test Loss: 2.359 Test Acc: 0.651
Validation loss decreased (-0.648951 --> -0.651225).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2902942
	speed: 0.3477s/iter; left time: 12026.6930s
	iters: 200, epoch: 7 | loss: 1.3240966
	speed: 0.0875s/iter; left time: 3016.7938s
	iters: 300, epoch: 7 | loss: 0.7511908
	speed: 0.0979s/iter; left time: 3365.7566s
Epoch: 7 cost time: 38.6249566078186
Epoch: 7, Steps: 369 | Train Loss: 1.807 Vali Loss: 3.935 Vali Acc: 0.651 Test Loss: 3.935 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2767586
	speed: 0.5485s/iter; left time: 18769.9412s
	iters: 200, epoch: 8 | loss: 2.1662109
	speed: 0.1543s/iter; left time: 5265.5154s
	iters: 300, epoch: 8 | loss: 1.7793651
	speed: 0.1528s/iter; left time: 5197.0929s
Epoch: 8 cost time: 57.54423666000366
Epoch: 8, Steps: 369 | Train Loss: 1.375 Vali Loss: 3.259 Vali Acc: 0.629 Test Loss: 3.259 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0411326
	speed: 0.5472s/iter; left time: 18521.9244s
	iters: 200, epoch: 9 | loss: 0.7017606
	speed: 0.1488s/iter; left time: 5023.3096s
	iters: 300, epoch: 9 | loss: 2.7161808
	speed: 0.1498s/iter; left time: 5041.1430s
Epoch: 9 cost time: 56.4800591468811
Epoch: 9, Steps: 369 | Train Loss: 0.953 Vali Loss: 2.621 Vali Acc: 0.653 Test Loss: 2.621 Test Acc: 0.653
Validation loss decreased (-0.651225 --> -0.652925).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8205423
	speed: 0.5483s/iter; left time: 18357.3521s
	iters: 200, epoch: 10 | loss: 1.0706683
	speed: 0.1512s/iter; left time: 5047.1055s
	iters: 300, epoch: 10 | loss: 0.8616685
	speed: 0.1525s/iter; left time: 5075.9996s
Epoch: 10 cost time: 56.98503351211548
Epoch: 10, Steps: 369 | Train Loss: 0.646 Vali Loss: 2.599 Vali Acc: 0.640 Test Loss: 2.599 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9816275
	speed: 0.5132s/iter; left time: 16991.1971s
	iters: 200, epoch: 11 | loss: 0.3801697
	speed: 0.1388s/iter; left time: 4580.5749s
	iters: 300, epoch: 11 | loss: 0.4183462
	speed: 0.1371s/iter; left time: 4510.6794s
Epoch: 11 cost time: 52.66540026664734
Epoch: 11, Steps: 369 | Train Loss: 0.430 Vali Loss: 1.876 Vali Acc: 0.652 Test Loss: 1.876 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4371159
	speed: 0.4940s/iter; left time: 16174.3005s
	iters: 200, epoch: 12 | loss: 0.2519577
	speed: 0.1359s/iter; left time: 4434.6815s
	iters: 300, epoch: 12 | loss: 0.2727246
	speed: 0.1354s/iter; left time: 4406.3575s
Epoch: 12 cost time: 51.07041668891907
Epoch: 12, Steps: 369 | Train Loss: 0.267 Vali Loss: 1.547 Vali Acc: 0.639 Test Loss: 1.547 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2780197
	speed: 0.5074s/iter; left time: 16424.9472s
	iters: 200, epoch: 13 | loss: 0.2672525
	speed: 0.1398s/iter; left time: 4510.7480s
	iters: 300, epoch: 13 | loss: 0.0107231
	speed: 0.1319s/iter; left time: 4245.1650s
Epoch: 13 cost time: 52.91543793678284
Epoch: 13, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.614 Vali Acc: 0.652 Test Loss: 1.614 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1706415
	speed: 0.5433s/iter; left time: 17388.5581s
	iters: 200, epoch: 14 | loss: 0.1329107
	speed: 0.1488s/iter; left time: 4748.8757s
	iters: 300, epoch: 14 | loss: 0.0304118
	speed: 0.1476s/iter; left time: 4695.3451s
Epoch: 14 cost time: 55.73915481567383
Epoch: 14, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.622 Vali Acc: 0.637 Test Loss: 1.622 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0070940
	speed: 0.5378s/iter; left time: 17013.7027s
	iters: 200, epoch: 15 | loss: 0.1665061
	speed: 0.1481s/iter; left time: 4671.5863s
	iters: 300, epoch: 15 | loss: 0.0853924
	speed: 0.1479s/iter; left time: 4650.2075s
Epoch: 15 cost time: 55.96749305725098
Epoch: 15, Steps: 369 | Train Loss: 0.091 Vali Loss: 1.763 Vali Acc: 0.654 Test Loss: 1.763 Test Acc: 0.654
Validation loss decreased (-0.652925 --> -0.653501).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0371478
	speed: 0.5513s/iter; left time: 17236.0751s
	iters: 200, epoch: 16 | loss: 0.0532644
	speed: 0.1504s/iter; left time: 4687.5918s
	iters: 300, epoch: 16 | loss: 0.1063483
	speed: 0.1525s/iter; left time: 4737.6156s
Epoch: 16 cost time: 56.36664295196533
Epoch: 16, Steps: 369 | Train Loss: 0.080 Vali Loss: 1.764 Vali Acc: 0.641 Test Loss: 1.764 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0520381
	speed: 0.5242s/iter; left time: 16197.3156s
	iters: 200, epoch: 17 | loss: 0.2779345
	speed: 0.1415s/iter; left time: 4358.4998s
	iters: 300, epoch: 17 | loss: 0.2150274
	speed: 0.1412s/iter; left time: 4334.4107s
Epoch: 17 cost time: 53.74010181427002
Epoch: 17, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.973 Vali Acc: 0.644 Test Loss: 1.973 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1126358
	speed: 0.5121s/iter; left time: 15632.3672s
	iters: 200, epoch: 18 | loss: 0.0268683
	speed: 0.1382s/iter; left time: 4205.7308s
	iters: 300, epoch: 18 | loss: 0.1354923
	speed: 0.1376s/iter; left time: 4174.3150s
Epoch: 18 cost time: 52.57745575904846
Epoch: 18, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.805 Vali Acc: 0.656 Test Loss: 1.805 Test Acc: 0.656
Validation loss decreased (-0.653501 --> -0.655771).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1739732
	speed: 0.5170s/iter; left time: 15593.0341s
	iters: 200, epoch: 19 | loss: 0.3043539
	speed: 0.1357s/iter; left time: 4077.6906s
	iters: 300, epoch: 19 | loss: 0.2732362
	speed: 0.1399s/iter; left time: 4190.6365s
Epoch: 19 cost time: 53.19287371635437
Epoch: 19, Steps: 369 | Train Loss: 0.076 Vali Loss: 1.896 Vali Acc: 0.648 Test Loss: 1.896 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0181291
	speed: 0.5628s/iter; left time: 16767.0465s
	iters: 200, epoch: 20 | loss: 0.0233306
	speed: 0.1507s/iter; left time: 4472.9860s
	iters: 300, epoch: 20 | loss: 0.0163002
	speed: 0.1517s/iter; left time: 4489.0452s
Epoch: 20 cost time: 56.92576622962952
Epoch: 20, Steps: 369 | Train Loss: 0.071 Vali Loss: 1.987 Vali Acc: 0.660 Test Loss: 1.987 Test Acc: 0.660
Validation loss decreased (-0.655771 --> -0.660026).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0108836
	speed: 0.5416s/iter; left time: 15933.7547s
	iters: 200, epoch: 21 | loss: 0.0034200
	speed: 0.1535s/iter; left time: 4501.3629s
	iters: 300, epoch: 21 | loss: 0.0699606
	speed: 0.1537s/iter; left time: 4491.4265s
Epoch: 21 cost time: 57.549376010894775
Epoch: 21, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.008 Vali Acc: 0.644 Test Loss: 2.008 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0030975
	speed: 0.5575s/iter; left time: 16195.0717s
	iters: 200, epoch: 22 | loss: 0.3014211
	speed: 0.1533s/iter; left time: 4438.8157s
	iters: 300, epoch: 22 | loss: 0.0013884
	speed: 0.1540s/iter; left time: 4442.6012s
Epoch: 22 cost time: 56.236541509628296
Epoch: 22, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.234 Vali Acc: 0.635 Test Loss: 2.234 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0024242
	speed: 0.5117s/iter; left time: 14676.3327s
	iters: 200, epoch: 23 | loss: 0.0011064
	speed: 0.1465s/iter; left time: 4186.6252s
	iters: 300, epoch: 23 | loss: 0.0074136
	speed: 0.1451s/iter; left time: 4132.4542s
Epoch: 23 cost time: 54.36976718902588
Epoch: 23, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.255 Vali Acc: 0.643 Test Loss: 2.255 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3150361
	speed: 0.5177s/iter; left time: 14656.9926s
	iters: 200, epoch: 24 | loss: 0.2352844
	speed: 0.1335s/iter; left time: 3765.6747s
	iters: 300, epoch: 24 | loss: 0.1253025
	speed: 0.1344s/iter; left time: 3779.5354s
Epoch: 24 cost time: 51.53060054779053
Epoch: 24, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.242 Vali Acc: 0.635 Test Loss: 2.242 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1180101
	speed: 0.5160s/iter; left time: 14419.8704s
	iters: 200, epoch: 25 | loss: 0.0432105
	speed: 0.1329s/iter; left time: 3700.2841s
	iters: 300, epoch: 25 | loss: 0.1204487
	speed: 0.1499s/iter; left time: 4157.9444s
Epoch: 25 cost time: 53.700926303863525
Epoch: 25, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.218 Vali Acc: 0.646 Test Loss: 2.218 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0136042
	speed: 0.5788s/iter; left time: 15960.7684s
	iters: 200, epoch: 26 | loss: 0.0095117
	speed: 0.1530s/iter; left time: 4202.7076s
	iters: 300, epoch: 26 | loss: 0.0477780
	speed: 0.1551s/iter; left time: 4246.3985s
Epoch: 26 cost time: 58.441999197006226
Epoch: 26, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.364 Vali Acc: 0.656 Test Loss: 2.364 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.3990174
	speed: 0.5635s/iter; left time: 15330.4276s
	iters: 200, epoch: 27 | loss: 0.0380045
	speed: 0.1555s/iter; left time: 4215.0615s
	iters: 300, epoch: 27 | loss: 0.0017477
	speed: 0.1537s/iter; left time: 4150.1432s
Epoch: 27 cost time: 58.06164813041687
Epoch: 27, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.464 Vali Acc: 0.645 Test Loss: 2.464 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0815917
	speed: 0.5761s/iter; left time: 15462.1016s
	iters: 200, epoch: 28 | loss: 0.1518333
	speed: 0.1534s/iter; left time: 4102.5110s
	iters: 300, epoch: 28 | loss: 0.0960156
	speed: 0.1323s/iter; left time: 3525.4473s
Epoch: 28 cost time: 55.108609676361084
Epoch: 28, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.536 Vali Acc: 0.653 Test Loss: 2.536 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0052676
	speed: 0.5207s/iter; left time: 13783.1282s
	iters: 200, epoch: 29 | loss: 0.0224139
	speed: 0.1372s/iter; left time: 3618.8286s
	iters: 300, epoch: 29 | loss: 0.0022954
	speed: 0.1382s/iter; left time: 3629.9788s
Epoch: 29 cost time: 52.17157292366028
Epoch: 29, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.621 Vali Acc: 0.637 Test Loss: 2.621 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.2804249
	speed: 0.5294s/iter; left time: 13816.2624s
	iters: 200, epoch: 30 | loss: 0.0021059
	speed: 0.1361s/iter; left time: 3537.8322s
	iters: 300, epoch: 30 | loss: 0.0050390
	speed: 0.1355s/iter; left time: 3508.8485s
Epoch: 30 cost time: 52.094550132751465
Epoch: 30, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.479 Vali Acc: 0.648 Test Loss: 2.479 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6600454029511919
model parameter : 371906
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1164089
	speed: 0.1497s/iter; left time: 5507.2969s
	iters: 200, epoch: 1 | loss: 0.9254608
	speed: 0.1172s/iter; left time: 4301.1867s
	iters: 300, epoch: 1 | loss: 0.9902241
	speed: 0.1152s/iter; left time: 4218.1675s
Epoch: 1 cost time: 46.17072892189026
Epoch: 1, Steps: 369 | Train Loss: 1.002 Vali Loss: 0.963 Vali Acc: 0.642 Test Loss: 0.963 Test Acc: 0.642
Validation loss decreased (inf --> -0.641875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5328047
	speed: 0.4382s/iter; left time: 15964.8079s
	iters: 200, epoch: 2 | loss: 2.3328898
	speed: 0.1134s/iter; left time: 4121.3210s
	iters: 300, epoch: 2 | loss: 0.1000638
	speed: 0.1122s/iter; left time: 4065.1441s
Epoch: 2 cost time: 43.21405744552612
Epoch: 2, Steps: 369 | Train Loss: 1.296 Vali Loss: 1.515 Vali Acc: 0.637 Test Loss: 1.515 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8652062
	speed: 0.4302s/iter; left time: 15514.4962s
	iters: 200, epoch: 3 | loss: 0.8340994
	speed: 0.1110s/iter; left time: 3991.2317s
	iters: 300, epoch: 3 | loss: 0.1307903
	speed: 0.1121s/iter; left time: 4018.8586s
Epoch: 3 cost time: 42.83524036407471
Epoch: 3, Steps: 369 | Train Loss: 1.731 Vali Loss: 2.307 Vali Acc: 0.655 Test Loss: 2.307 Test Acc: 0.655
Validation loss decreased (-0.641875 --> -0.654631).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7439877
	speed: 0.4326s/iter; left time: 15439.5376s
	iters: 200, epoch: 4 | loss: 0.7957397
	speed: 0.1191s/iter; left time: 4239.1220s
	iters: 300, epoch: 4 | loss: 0.6305098
	speed: 0.1169s/iter; left time: 4149.1301s
Epoch: 4 cost time: 45.2972526550293
Epoch: 4, Steps: 369 | Train Loss: 1.919 Vali Loss: 2.606 Vali Acc: 0.650 Test Loss: 2.606 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5494387
	speed: 0.4709s/iter; left time: 16632.9615s
	iters: 200, epoch: 5 | loss: 0.2068405
	speed: 0.1293s/iter; left time: 4554.0307s
	iters: 300, epoch: 5 | loss: 1.8110813
	speed: 0.1282s/iter; left time: 4504.6998s
Epoch: 5 cost time: 48.587467193603516
Epoch: 5, Steps: 369 | Train Loss: 1.938 Vali Loss: 3.074 Vali Acc: 0.636 Test Loss: 3.074 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.4528441
	speed: 0.4752s/iter; left time: 16611.7883s
	iters: 200, epoch: 6 | loss: 1.2116140
	speed: 0.1297s/iter; left time: 4520.2416s
	iters: 300, epoch: 6 | loss: 1.1892760
	speed: 0.1297s/iter; left time: 4508.3122s
Epoch: 6 cost time: 48.733214378356934
Epoch: 6, Steps: 369 | Train Loss: 1.618 Vali Loss: 3.670 Vali Acc: 0.651 Test Loss: 3.670 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 4.6841559
	speed: 0.4676s/iter; left time: 16172.3238s
	iters: 200, epoch: 7 | loss: 0.3010835
	speed: 0.1304s/iter; left time: 4497.4260s
	iters: 300, epoch: 7 | loss: 0.4507129
	speed: 0.1318s/iter; left time: 4532.1654s
Epoch: 7 cost time: 49.172539472579956
Epoch: 7, Steps: 369 | Train Loss: 1.493 Vali Loss: 3.641 Vali Acc: 0.632 Test Loss: 3.641 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0243429
	speed: 0.4668s/iter; left time: 15972.5128s
	iters: 200, epoch: 8 | loss: 1.7200903
	speed: 0.1199s/iter; left time: 4092.2854s
	iters: 300, epoch: 8 | loss: 2.0069914
	speed: 0.1157s/iter; left time: 3937.4781s
Epoch: 8 cost time: 44.61604142189026
Epoch: 8, Steps: 369 | Train Loss: 1.126 Vali Loss: 2.996 Vali Acc: 0.644 Test Loss: 2.996 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.1483721
	speed: 0.4354s/iter; left time: 14736.3206s
	iters: 200, epoch: 9 | loss: 0.4708431
	speed: 0.1161s/iter; left time: 3918.5719s
	iters: 300, epoch: 9 | loss: 0.3438914
	speed: 0.1183s/iter; left time: 3979.9882s
Epoch: 9 cost time: 43.18225073814392
Epoch: 9, Steps: 369 | Train Loss: 0.770 Vali Loss: 3.023 Vali Acc: 0.637 Test Loss: 3.023 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7408648
	speed: 0.4282s/iter; left time: 14337.1192s
	iters: 200, epoch: 10 | loss: 2.0216608
	speed: 0.1135s/iter; left time: 3788.2027s
	iters: 300, epoch: 10 | loss: 1.0057724
	speed: 0.1149s/iter; left time: 3824.2261s
Epoch: 10 cost time: 43.57291793823242
Epoch: 10, Steps: 369 | Train Loss: 0.553 Vali Loss: 2.615 Vali Acc: 0.637 Test Loss: 2.615 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4864758
	speed: 0.4463s/iter; left time: 14777.3031s
	iters: 200, epoch: 11 | loss: 0.0814921
	speed: 0.1209s/iter; left time: 3990.3807s
	iters: 300, epoch: 11 | loss: 0.8856152
	speed: 0.1316s/iter; left time: 4332.1711s
Epoch: 11 cost time: 47.264023303985596
Epoch: 11, Steps: 369 | Train Loss: 0.424 Vali Loss: 1.930 Vali Acc: 0.648 Test Loss: 1.930 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1217575
	speed: 0.4772s/iter; left time: 15625.3636s
	iters: 200, epoch: 12 | loss: 0.4325683
	speed: 0.1322s/iter; left time: 4315.2454s
	iters: 300, epoch: 12 | loss: 0.0855423
	speed: 0.1315s/iter; left time: 4277.7674s
Epoch: 12 cost time: 49.7544527053833
Epoch: 12, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.653 Vali Acc: 0.640 Test Loss: 1.653 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0302421
	speed: 0.4852s/iter; left time: 15706.9511s
	iters: 200, epoch: 13 | loss: 0.0174862
	speed: 0.1318s/iter; left time: 4253.8113s
	iters: 300, epoch: 13 | loss: 0.0251000
	speed: 0.1316s/iter; left time: 4235.0888s
Epoch: 13 cost time: 49.80133032798767
Epoch: 13, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.725 Vali Acc: 0.648 Test Loss: 1.725 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6546538024971623
model parameter : 316802
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2259140
	speed: 0.1185s/iter; left time: 4361.8522s
	iters: 200, epoch: 1 | loss: 1.2754236
	speed: 0.0921s/iter; left time: 3381.0157s
	iters: 300, epoch: 1 | loss: 0.9005750
	speed: 0.0823s/iter; left time: 3011.3605s
Epoch: 1 cost time: 35.770853757858276
Epoch: 1, Steps: 369 | Train Loss: 0.877 Vali Loss: 0.773 Vali Acc: 0.641 Test Loss: 0.773 Test Acc: 0.641
Validation loss decreased (inf --> -0.641309).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8567399
	speed: 0.3696s/iter; left time: 13466.4569s
	iters: 200, epoch: 2 | loss: 0.4264683
	speed: 0.0898s/iter; left time: 3262.2645s
	iters: 300, epoch: 2 | loss: 0.8202553
	speed: 0.0926s/iter; left time: 3353.8413s
Epoch: 2 cost time: 35.24440121650696
Epoch: 2, Steps: 369 | Train Loss: 1.181 Vali Loss: 1.459 Vali Acc: 0.667 Test Loss: 1.459 Test Acc: 0.667
Validation loss decreased (-0.641309 --> -0.667409).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9918588
	speed: 0.3673s/iter; left time: 13247.1808s
	iters: 200, epoch: 3 | loss: 0.0373050
	speed: 0.0846s/iter; left time: 3042.0725s
	iters: 300, epoch: 3 | loss: 1.8686842
	speed: 0.1026s/iter; left time: 3679.1969s
Epoch: 3 cost time: 36.06482219696045
Epoch: 3, Steps: 369 | Train Loss: 1.520 Vali Loss: 1.911 Vali Acc: 0.663 Test Loss: 1.911 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0218585
	speed: 0.3777s/iter; left time: 13480.2809s
	iters: 200, epoch: 4 | loss: 0.8278261
	speed: 0.1043s/iter; left time: 3711.0721s
	iters: 300, epoch: 4 | loss: 0.9676959
	speed: 0.1038s/iter; left time: 3685.4710s
Epoch: 4 cost time: 39.27226114273071
Epoch: 4, Steps: 369 | Train Loss: 1.720 Vali Loss: 3.222 Vali Acc: 0.618 Test Loss: 3.222 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2225791
	speed: 0.3861s/iter; left time: 13638.0504s
	iters: 200, epoch: 5 | loss: 2.8265595
	speed: 0.1045s/iter; left time: 3681.5297s
	iters: 300, epoch: 5 | loss: 1.1829290
	speed: 0.1034s/iter; left time: 3632.3425s
Epoch: 5 cost time: 39.27876377105713
Epoch: 5, Steps: 369 | Train Loss: 1.650 Vali Loss: 2.597 Vali Acc: 0.672 Test Loss: 2.597 Test Acc: 0.672
Validation loss decreased (-0.667409 --> -0.671654).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5791127
	speed: 0.3937s/iter; left time: 13762.2723s
	iters: 200, epoch: 6 | loss: 1.7000978
	speed: 0.1019s/iter; left time: 3550.3568s
	iters: 300, epoch: 6 | loss: 0.8451244
	speed: 0.1028s/iter; left time: 3573.2663s
Epoch: 6 cost time: 39.06853938102722
Epoch: 6, Steps: 369 | Train Loss: 1.595 Vali Loss: 2.464 Vali Acc: 0.648 Test Loss: 2.464 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7194127
	speed: 0.3806s/iter; left time: 13162.3642s
	iters: 200, epoch: 7 | loss: 1.9926237
	speed: 0.1023s/iter; left time: 3529.0037s
	iters: 300, epoch: 7 | loss: 2.4640892
	speed: 0.1017s/iter; left time: 3498.3365s
Epoch: 7 cost time: 38.70344066619873
Epoch: 7, Steps: 369 | Train Loss: 1.395 Vali Loss: 2.949 Vali Acc: 0.637 Test Loss: 2.949 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0449355
	speed: 0.3581s/iter; left time: 12253.2193s
	iters: 200, epoch: 8 | loss: 0.7451597
	speed: 0.0937s/iter; left time: 3198.1445s
	iters: 300, epoch: 8 | loss: 0.7943912
	speed: 0.0935s/iter; left time: 3181.3013s
Epoch: 8 cost time: 35.375908851623535
Epoch: 8, Steps: 369 | Train Loss: 1.048 Vali Loss: 2.793 Vali Acc: 0.650 Test Loss: 2.793 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0014781
	speed: 0.3708s/iter; left time: 12551.5107s
	iters: 200, epoch: 9 | loss: 2.7859612
	speed: 0.0915s/iter; left time: 3087.5826s
	iters: 300, epoch: 9 | loss: 0.2354678
	speed: 0.0939s/iter; left time: 3160.2614s
Epoch: 9 cost time: 34.49261260032654
Epoch: 9, Steps: 369 | Train Loss: 0.754 Vali Loss: 2.371 Vali Acc: 0.637 Test Loss: 2.371 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.8816089
	speed: 0.3605s/iter; left time: 12067.9576s
	iters: 200, epoch: 10 | loss: 1.4862938
	speed: 0.0911s/iter; left time: 3039.7318s
	iters: 300, epoch: 10 | loss: 0.9234380
	speed: 0.0928s/iter; left time: 3087.8125s
Epoch: 10 cost time: 35.12509799003601
Epoch: 10, Steps: 369 | Train Loss: 0.527 Vali Loss: 2.018 Vali Acc: 0.645 Test Loss: 2.018 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2369188
	speed: 0.3682s/iter; left time: 12189.9806s
	iters: 200, epoch: 11 | loss: 0.8999438
	speed: 0.0951s/iter; left time: 3138.6657s
	iters: 300, epoch: 11 | loss: 0.7381020
	speed: 0.0876s/iter; left time: 2882.0066s
Epoch: 11 cost time: 36.1005437374115
Epoch: 11, Steps: 369 | Train Loss: 0.338 Vali Loss: 1.723 Vali Acc: 0.649 Test Loss: 1.723 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1125533
	speed: 0.3951s/iter; left time: 12937.5623s
	iters: 200, epoch: 12 | loss: 0.1549329
	speed: 0.1053s/iter; left time: 3437.9891s
	iters: 300, epoch: 12 | loss: 0.2108092
	speed: 0.1075s/iter; left time: 3497.0298s
Epoch: 12 cost time: 40.295268297195435
Epoch: 12, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.575 Vali Acc: 0.652 Test Loss: 1.575 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0073119
	speed: 0.3968s/iter; left time: 12844.3839s
	iters: 200, epoch: 13 | loss: 0.6551951
	speed: 0.1046s/iter; left time: 3376.4112s
	iters: 300, epoch: 13 | loss: 0.3142273
	speed: 0.1038s/iter; left time: 3340.0398s
Epoch: 13 cost time: 40.050989627838135
Epoch: 13, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.500 Vali Acc: 0.644 Test Loss: 1.500 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0456151
	speed: 0.3968s/iter; left time: 12697.8095s
	iters: 200, epoch: 14 | loss: 0.1966354
	speed: 0.1020s/iter; left time: 3255.6990s
	iters: 300, epoch: 14 | loss: 0.0826398
	speed: 0.1027s/iter; left time: 3266.4197s
Epoch: 14 cost time: 39.12758660316467
Epoch: 14, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.674 Vali Acc: 0.656 Test Loss: 1.674 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3953429
	speed: 0.4167s/iter; left time: 13183.0720s
	iters: 200, epoch: 15 | loss: 0.0388706
	speed: 0.1036s/iter; left time: 3266.1076s
	iters: 300, epoch: 15 | loss: 0.0544818
	speed: 0.1034s/iter; left time: 3251.2521s
Epoch: 15 cost time: 39.741652488708496
Epoch: 15, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.684 Vali Acc: 0.646 Test Loss: 1.684 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 280130
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.2540770
	speed: 0.5536s/iter; left time: 20373.5377s
	iters: 200, epoch: 1 | loss: 1.7260821
	speed: 0.5649s/iter; left time: 20732.6797s
	iters: 300, epoch: 1 | loss: 1.7285310
	speed: 0.5570s/iter; left time: 20387.9373s
Epoch: 1 cost time: 205.50417685508728
Epoch: 1, Steps: 369 | Train Loss: 2.360 Vali Loss: 1.958 Vali Acc: 0.643 Test Loss: 1.958 Test Acc: 0.643
Validation loss decreased (inf --> -0.643283).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.9681425
	speed: 1.7999s/iter; left time: 65572.8804s
	iters: 200, epoch: 2 | loss: 2.2949390
	speed: 0.5319s/iter; left time: 19326.5051s
	iters: 300, epoch: 2 | loss: 3.6734672
	speed: 0.5304s/iter; left time: 19216.5242s
Epoch: 2 cost time: 196.74819493293762
Epoch: 2, Steps: 369 | Train Loss: 3.617 Vali Loss: 2.099 Vali Acc: 0.664 Test Loss: 2.099 Test Acc: 0.664
Validation loss decreased (-0.643283 --> -0.664281).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.6478686
	speed: 1.6767s/iter; left time: 60467.7000s
	iters: 200, epoch: 3 | loss: 6.2694769
	speed: 0.5250s/iter; left time: 18880.7801s
	iters: 300, epoch: 3 | loss: 8.9322338
	speed: 0.5387s/iter; left time: 19318.4591s
Epoch: 3 cost time: 194.71320056915283
Epoch: 3, Steps: 369 | Train Loss: 4.686 Vali Loss: 6.185 Vali Acc: 0.657 Test Loss: 6.185 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 6.5410852
	speed: 1.7898s/iter; left time: 63885.1479s
	iters: 200, epoch: 4 | loss: 1.6669378
	speed: 0.5015s/iter; left time: 17851.7900s
	iters: 300, epoch: 4 | loss: 10.0568666
	speed: 0.5176s/iter; left time: 18370.1780s
Epoch: 4 cost time: 191.25343012809753
Epoch: 4, Steps: 369 | Train Loss: 5.394 Vali Loss: 9.743 Vali Acc: 0.641 Test Loss: 9.743 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001549
	speed: 1.6288s/iter; left time: 57538.8943s
	iters: 200, epoch: 5 | loss: 14.6975756
	speed: 0.5284s/iter; left time: 18611.8549s
	iters: 300, epoch: 5 | loss: 2.4839387
	speed: 0.5374s/iter; left time: 18874.8860s
Epoch: 5 cost time: 194.5128948688507
Epoch: 5, Steps: 369 | Train Loss: 5.058 Vali Loss: 8.211 Vali Acc: 0.664 Test Loss: 8.211 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 5.0803947
	speed: 1.7692s/iter; left time: 61843.6008s
	iters: 200, epoch: 6 | loss: 6.3524776
	speed: 0.4984s/iter; left time: 17371.7365s
	iters: 300, epoch: 6 | loss: 6.1113071
	speed: 0.5096s/iter; left time: 17711.1351s
Epoch: 6 cost time: 189.13727617263794
Epoch: 6, Steps: 369 | Train Loss: 4.369 Vali Loss: 7.846 Vali Acc: 0.658 Test Loss: 7.846 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3265228
	speed: 1.6572s/iter; left time: 57316.6541s
	iters: 200, epoch: 7 | loss: 0.9498953
	speed: 0.5251s/iter; left time: 18108.8261s
	iters: 300, epoch: 7 | loss: 2.1950517
	speed: 0.5273s/iter; left time: 18132.8846s
Epoch: 7 cost time: 192.6443190574646
Epoch: 7, Steps: 369 | Train Loss: 3.627 Vali Loss: 10.158 Vali Acc: 0.631 Test Loss: 10.158 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000962
	speed: 1.7383s/iter; left time: 59480.5962s
	iters: 200, epoch: 8 | loss: 1.9533647
	speed: 0.4955s/iter; left time: 16904.5663s
	iters: 300, epoch: 8 | loss: 1.5790288
	speed: 0.5095s/iter; left time: 17332.0081s
Epoch: 8 cost time: 187.71651411056519
Epoch: 8, Steps: 369 | Train Loss: 2.497 Vali Loss: 8.235 Vali Acc: 0.629 Test Loss: 8.235 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8973511
	speed: 1.6514s/iter; left time: 55898.5326s
	iters: 200, epoch: 9 | loss: 2.7051387
	speed: 0.5286s/iter; left time: 17839.8623s
	iters: 300, epoch: 9 | loss: 0.2593699
	speed: 0.5355s/iter; left time: 18019.6146s
Epoch: 9 cost time: 193.49414110183716
Epoch: 9, Steps: 369 | Train Loss: 1.838 Vali Loss: 8.408 Vali Acc: 0.639 Test Loss: 8.408 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.2967949
	speed: 1.8056s/iter; left time: 60452.8372s
	iters: 200, epoch: 10 | loss: 1.0563868
	speed: 0.5100s/iter; left time: 17023.2852s
	iters: 300, epoch: 10 | loss: 4.3512611
	speed: 0.5086s/iter; left time: 16925.9125s
Epoch: 10 cost time: 192.0149359703064
Epoch: 10, Steps: 369 | Train Loss: 1.298 Vali Loss: 8.357 Vali Acc: 0.636 Test Loss: 8.357 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.8309786
	speed: 1.5763s/iter; left time: 52194.4212s
	iters: 200, epoch: 11 | loss: 0.4562676
	speed: 0.4874s/iter; left time: 16090.8698s
	iters: 300, epoch: 11 | loss: 0.0206964
	speed: 0.5733s/iter; left time: 18867.6560s
Epoch: 11 cost time: 174.74405813217163
Epoch: 11, Steps: 369 | Train Loss: 0.775 Vali Loss: 9.620 Vali Acc: 0.633 Test Loss: 9.620 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0003378
	speed: 1.3410s/iter; left time: 43907.1514s
	iters: 200, epoch: 12 | loss: 0.9554918
	speed: 0.4831s/iter; left time: 15769.0135s
	iters: 300, epoch: 12 | loss: 0.0000092
	speed: 0.4909s/iter; left time: 15976.1109s
Epoch: 12 cost time: 180.8331220149994
Epoch: 12, Steps: 369 | Train Loss: 0.545 Vali Loss: 7.500 Vali Acc: 0.635 Test Loss: 7.500 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6643019296254257
model parameter : 1243458
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.9198444
	speed: 0.2858s/iter; left time: 10517.8447s
	iters: 200, epoch: 1 | loss: 0.6019742
	speed: 0.2610s/iter; left time: 9578.5015s
	iters: 300, epoch: 1 | loss: 2.8363032
	speed: 0.2626s/iter; left time: 9610.9743s
Epoch: 1 cost time: 98.79789710044861
Epoch: 1, Steps: 369 | Train Loss: 1.575 Vali Loss: 1.276 Vali Acc: 0.636 Test Loss: 1.276 Test Acc: 0.636
Validation loss decreased (inf --> -0.635629).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5652602
	speed: 0.9605s/iter; left time: 34993.2562s
	iters: 200, epoch: 2 | loss: 0.2206744
	speed: 0.2449s/iter; left time: 8897.4666s
	iters: 300, epoch: 2 | loss: 4.2000370
	speed: 0.2404s/iter; left time: 8708.6487s
Epoch: 2 cost time: 89.18064165115356
Epoch: 2, Steps: 369 | Train Loss: 2.441 Vali Loss: 2.786 Vali Acc: 0.644 Test Loss: 2.786 Test Acc: 0.644
Validation loss decreased (-0.635629 --> -0.644410).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.7949266
	speed: 0.9287s/iter; left time: 33491.6539s
	iters: 200, epoch: 3 | loss: 4.3614945
	speed: 0.2697s/iter; left time: 9700.9791s
	iters: 300, epoch: 3 | loss: 2.7964051
	speed: 0.2674s/iter; left time: 9588.2766s
Epoch: 3 cost time: 98.3679838180542
Epoch: 3, Steps: 369 | Train Loss: 3.316 Vali Loss: 2.525 Vali Acc: 0.654 Test Loss: 2.525 Test Acc: 0.654
Validation loss decreased (-0.644410 --> -0.653493).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3614705
	speed: 1.0166s/iter; left time: 36287.0190s
	iters: 200, epoch: 4 | loss: 4.4009867
	speed: 0.2699s/iter; left time: 9606.7350s
	iters: 300, epoch: 4 | loss: 3.6298802
	speed: 0.2699s/iter; left time: 9581.0715s
Epoch: 4 cost time: 98.95082330703735
Epoch: 4, Steps: 369 | Train Loss: 3.523 Vali Loss: 4.775 Vali Acc: 0.626 Test Loss: 4.775 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3804853
	speed: 0.8753s/iter; left time: 30920.8129s
	iters: 200, epoch: 5 | loss: 5.2099977
	speed: 0.2225s/iter; left time: 7837.6072s
	iters: 300, epoch: 5 | loss: 4.2832494
	speed: 0.2305s/iter; left time: 8096.3045s
Epoch: 5 cost time: 82.06906318664551
Epoch: 5, Steps: 369 | Train Loss: 3.665 Vali Loss: 4.410 Vali Acc: 0.626 Test Loss: 4.410 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.1458864
	speed: 0.9200s/iter; left time: 32159.1291s
	iters: 200, epoch: 6 | loss: 3.8549905
	speed: 0.2535s/iter; left time: 8834.4502s
	iters: 300, epoch: 6 | loss: 1.1428094
	speed: 0.2590s/iter; left time: 9003.2482s
Epoch: 6 cost time: 95.49392771720886
Epoch: 6, Steps: 369 | Train Loss: 3.219 Vali Loss: 7.709 Vali Acc: 0.638 Test Loss: 7.709 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.8164930
	speed: 0.9700s/iter; left time: 33550.4883s
	iters: 200, epoch: 7 | loss: 3.8180742
	speed: 0.2366s/iter; left time: 8161.2226s
	iters: 300, epoch: 7 | loss: 0.7286428
	speed: 0.2371s/iter; left time: 8153.2921s
Epoch: 7 cost time: 89.98850178718567
Epoch: 7, Steps: 369 | Train Loss: 2.715 Vali Loss: 6.932 Vali Acc: 0.631 Test Loss: 6.932 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3440914
	speed: 0.9134s/iter; left time: 31254.7805s
	iters: 200, epoch: 8 | loss: 0.5642133
	speed: 0.2532s/iter; left time: 8638.7144s
	iters: 300, epoch: 8 | loss: 0.2233470
	speed: 0.2646s/iter; left time: 9000.2709s
Epoch: 8 cost time: 94.99969029426575
Epoch: 8, Steps: 369 | Train Loss: 1.981 Vali Loss: 6.656 Vali Acc: 0.632 Test Loss: 6.656 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 4.5157475
	speed: 0.9999s/iter; left time: 33844.0656s
	iters: 200, epoch: 9 | loss: 4.4815750
	speed: 0.2585s/iter; left time: 8724.1124s
	iters: 300, epoch: 9 | loss: 1.3415165
	speed: 0.2595s/iter; left time: 8730.8485s
Epoch: 9 cost time: 97.5844976902008
Epoch: 9, Steps: 369 | Train Loss: 1.573 Vali Loss: 6.457 Vali Acc: 0.631 Test Loss: 6.457 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.0680869
	speed: 0.9261s/iter; left time: 31005.1808s
	iters: 200, epoch: 10 | loss: 0.2049806
	speed: 0.2544s/iter; left time: 8491.7139s
	iters: 300, epoch: 10 | loss: 1.0859990
	speed: 0.2568s/iter; left time: 8544.8907s
Epoch: 10 cost time: 93.50953102111816
Epoch: 10, Steps: 369 | Train Loss: 0.876 Vali Loss: 5.090 Vali Acc: 0.631 Test Loss: 5.090 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1078771
	speed: 0.9802s/iter; left time: 32454.3869s
	iters: 200, epoch: 11 | loss: 1.4443790
	speed: 0.2685s/iter; left time: 8864.6985s
	iters: 300, epoch: 11 | loss: 0.5934336
	speed: 0.2702s/iter; left time: 8893.4075s
Epoch: 11 cost time: 100.28399610519409
Epoch: 11, Steps: 369 | Train Loss: 0.590 Vali Loss: 3.813 Vali Acc: 0.637 Test Loss: 3.813 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.1224915
	speed: 1.0050s/iter; left time: 32905.8766s
	iters: 200, epoch: 12 | loss: 0.3857951
	speed: 0.2444s/iter; left time: 7978.5991s
	iters: 300, epoch: 12 | loss: 0.3381231
	speed: 0.2441s/iter; left time: 7942.5065s
Epoch: 12 cost time: 91.77215838432312
Epoch: 12, Steps: 369 | Train Loss: 0.298 Vali Loss: 3.404 Vali Acc: 0.647 Test Loss: 3.404 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0004251
	speed: 0.9261s/iter; left time: 29979.6016s
	iters: 200, epoch: 13 | loss: 0.0045451
	speed: 0.2460s/iter; left time: 7937.7702s
	iters: 300, epoch: 13 | loss: 0.1497112
	speed: 0.2637s/iter; left time: 8485.1453s
Epoch: 13 cost time: 95.53578686714172
Epoch: 13, Steps: 369 | Train Loss: 0.181 Vali Loss: 2.600 Vali Acc: 0.636 Test Loss: 2.600 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6535187287173666
model parameter : 672194
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1242733
	speed: 0.2034s/iter; left time: 7486.4879s
	iters: 200, epoch: 1 | loss: 0.9632396
	speed: 0.1769s/iter; left time: 6490.6614s
	iters: 300, epoch: 1 | loss: 1.3056862
	speed: 0.1770s/iter; left time: 6476.9896s
Epoch: 1 cost time: 68.05050468444824
Epoch: 1, Steps: 369 | Train Loss: 1.410 Vali Loss: 1.461 Vali Acc: 0.654 Test Loss: 1.461 Test Acc: 0.654
Validation loss decreased (inf --> -0.654072).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4207568
	speed: 0.6979s/iter; left time: 25424.1299s
	iters: 200, epoch: 2 | loss: 3.6520455
	speed: 0.1959s/iter; left time: 7118.4821s
	iters: 300, epoch: 2 | loss: 1.4200143
	speed: 0.1959s/iter; left time: 7097.8973s
Epoch: 2 cost time: 73.599778175354
Epoch: 2, Steps: 369 | Train Loss: 1.965 Vali Loss: 2.915 Vali Acc: 0.658 Test Loss: 2.915 Test Acc: 0.658
Validation loss decreased (-0.654072 --> -0.657746).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9619482
	speed: 0.7486s/iter; left time: 26995.6674s
	iters: 200, epoch: 3 | loss: 1.9017681
	speed: 0.2003s/iter; left time: 7203.9026s
	iters: 300, epoch: 3 | loss: 3.4659979
	speed: 0.2019s/iter; left time: 7240.4512s
Epoch: 3 cost time: 74.71770930290222
Epoch: 3, Steps: 369 | Train Loss: 2.779 Vali Loss: 2.049 Vali Acc: 0.631 Test Loss: 2.049 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1807268
	speed: 0.6708s/iter; left time: 23944.7272s
	iters: 200, epoch: 4 | loss: 2.3010237
	speed: 0.1724s/iter; left time: 6136.2607s
	iters: 300, epoch: 4 | loss: 6.2239957
	speed: 0.1688s/iter; left time: 5991.0525s
Epoch: 4 cost time: 64.38690710067749
Epoch: 4, Steps: 369 | Train Loss: 3.049 Vali Loss: 3.226 Vali Acc: 0.649 Test Loss: 3.226 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3856127
	speed: 0.6539s/iter; left time: 23100.5302s
	iters: 200, epoch: 5 | loss: 1.7830901
	speed: 0.1847s/iter; left time: 6507.1684s
	iters: 300, epoch: 5 | loss: 4.1395769
	speed: 0.1838s/iter; left time: 6457.6005s
Epoch: 5 cost time: 68.79035377502441
Epoch: 5, Steps: 369 | Train Loss: 2.924 Vali Loss: 3.890 Vali Acc: 0.609 Test Loss: 3.890 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1986893
	speed: 0.6948s/iter; left time: 24288.5200s
	iters: 200, epoch: 6 | loss: 3.8227701
	speed: 0.1845s/iter; left time: 6430.1128s
	iters: 300, epoch: 6 | loss: 2.4451656
	speed: 0.1856s/iter; left time: 6450.0522s
Epoch: 6 cost time: 69.75591397285461
Epoch: 6, Steps: 369 | Train Loss: 2.923 Vali Loss: 4.743 Vali Acc: 0.648 Test Loss: 4.743 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 6.6270781
	speed: 0.6975s/iter; left time: 24125.1218s
	iters: 200, epoch: 7 | loss: 2.5405424
	speed: 0.1834s/iter; left time: 6326.5552s
	iters: 300, epoch: 7 | loss: 2.5878060
	speed: 0.1855s/iter; left time: 6379.9466s
Epoch: 7 cost time: 69.08456444740295
Epoch: 7, Steps: 369 | Train Loss: 2.218 Vali Loss: 4.130 Vali Acc: 0.658 Test Loss: 4.130 Test Acc: 0.658
Validation loss decreased (-0.657746 --> -0.658018).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1795261
	speed: 0.6704s/iter; left time: 22939.3760s
	iters: 200, epoch: 8 | loss: 0.3389027
	speed: 0.1637s/iter; left time: 5584.1078s
	iters: 300, epoch: 8 | loss: 3.9645152
	speed: 0.1732s/iter; left time: 5890.6454s
Epoch: 8 cost time: 64.79136538505554
Epoch: 8, Steps: 369 | Train Loss: 1.703 Vali Loss: 4.484 Vali Acc: 0.637 Test Loss: 4.484 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2501373
	speed: 0.6875s/iter; left time: 23271.2973s
	iters: 200, epoch: 9 | loss: 1.9329062
	speed: 0.1837s/iter; left time: 6201.3491s
	iters: 300, epoch: 9 | loss: 0.8961014
	speed: 0.1876s/iter; left time: 6311.8232s
Epoch: 9 cost time: 69.74941825866699
Epoch: 9, Steps: 369 | Train Loss: 1.250 Vali Loss: 3.617 Vali Acc: 0.643 Test Loss: 3.617 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6055570
	speed: 0.7162s/iter; left time: 23979.9208s
	iters: 200, epoch: 10 | loss: 0.0665183
	speed: 0.1646s/iter; left time: 5495.0156s
	iters: 300, epoch: 10 | loss: 0.0275262
	speed: 0.1752s/iter; left time: 5831.2604s
Epoch: 10 cost time: 66.27467107772827
Epoch: 10, Steps: 369 | Train Loss: 0.785 Vali Loss: 3.125 Vali Acc: 0.621 Test Loss: 3.125 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0029900
	speed: 0.6696s/iter; left time: 22171.5750s
	iters: 200, epoch: 11 | loss: 0.6425503
	speed: 0.1746s/iter; left time: 5762.9026s
	iters: 300, epoch: 11 | loss: 0.5926346
	speed: 0.1824s/iter; left time: 6002.5425s
Epoch: 11 cost time: 66.91681098937988
Epoch: 11, Steps: 369 | Train Loss: 0.403 Vali Loss: 2.061 Vali Acc: 0.646 Test Loss: 2.061 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0547524
	speed: 0.7028s/iter; left time: 23010.2247s
	iters: 200, epoch: 12 | loss: 0.0783900
	speed: 0.1967s/iter; left time: 6420.6278s
	iters: 300, epoch: 12 | loss: 0.1625267
	speed: 0.1954s/iter; left time: 6358.1947s
Epoch: 12 cost time: 73.42851138114929
Epoch: 12, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.697 Vali Acc: 0.644 Test Loss: 1.697 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1911702
	speed: 0.7274s/iter; left time: 23547.7797s
	iters: 200, epoch: 13 | loss: 0.0591441
	speed: 0.1929s/iter; left time: 6226.1785s
	iters: 300, epoch: 13 | loss: 0.0311837
	speed: 0.1938s/iter; left time: 6233.8680s
Epoch: 13 cost time: 71.95106506347656
Epoch: 13, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.724 Vali Acc: 0.641 Test Loss: 1.724 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0883431
	speed: 0.6848s/iter; left time: 21916.1146s
	iters: 200, epoch: 14 | loss: 0.0578845
	speed: 0.1729s/iter; left time: 5516.2438s
	iters: 300, epoch: 14 | loss: 0.0204941
	speed: 0.1735s/iter; left time: 5519.0739s
Epoch: 14 cost time: 66.5992591381073
Epoch: 14, Steps: 369 | Train Loss: 0.085 Vali Loss: 1.908 Vali Acc: 0.645 Test Loss: 1.908 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2173331
	speed: 0.6830s/iter; left time: 21606.0581s
	iters: 200, epoch: 15 | loss: 0.0024187
	speed: 0.1909s/iter; left time: 6020.4610s
	iters: 300, epoch: 15 | loss: 0.0143070
	speed: 0.1918s/iter; left time: 6028.1330s
Epoch: 15 cost time: 70.74252152442932
Epoch: 15, Steps: 369 | Train Loss: 0.071 Vali Loss: 1.897 Vali Acc: 0.642 Test Loss: 1.897 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0086095
	speed: 0.7139s/iter; left time: 22321.8729s
	iters: 200, epoch: 16 | loss: 0.0427091
	speed: 0.1977s/iter; left time: 6160.4898s
	iters: 300, epoch: 16 | loss: 0.0008529
	speed: 0.1993s/iter; left time: 6192.9171s
Epoch: 16 cost time: 73.91771531105042
Epoch: 16, Steps: 369 | Train Loss: 0.081 Vali Loss: 2.173 Vali Acc: 0.632 Test Loss: 2.173 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0051226
	speed: 0.7167s/iter; left time: 22142.4168s
	iters: 200, epoch: 17 | loss: 0.0390116
	speed: 0.1760s/iter; left time: 5419.4187s
	iters: 300, epoch: 17 | loss: 0.1199669
	speed: 0.1771s/iter; left time: 5437.5460s
Epoch: 17 cost time: 66.40212440490723
Epoch: 17, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.215 Vali Acc: 0.644 Test Loss: 2.215 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6580590238365494
model parameter : 487938
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2981781
	speed: 0.1646s/iter; left time: 6058.5824s
	iters: 200, epoch: 1 | loss: 1.4665728
	speed: 0.1422s/iter; left time: 5220.5158s
	iters: 300, epoch: 1 | loss: 1.1935670
	speed: 0.1442s/iter; left time: 5276.7696s
Epoch: 1 cost time: 55.047157526016235
Epoch: 1, Steps: 369 | Train Loss: 1.170 Vali Loss: 1.202 Vali Acc: 0.621 Test Loss: 1.202 Test Acc: 0.621
Validation loss decreased (inf --> -0.620590).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0154586
	speed: 0.5559s/iter; left time: 20253.3058s
	iters: 200, epoch: 2 | loss: 1.3831918
	speed: 0.1445s/iter; left time: 5249.2377s
	iters: 300, epoch: 2 | loss: 3.9046988
	speed: 0.1437s/iter; left time: 5205.8361s
Epoch: 2 cost time: 53.14667844772339
Epoch: 2, Steps: 369 | Train Loss: 1.689 Vali Loss: 2.540 Vali Acc: 0.643 Test Loss: 2.540 Test Acc: 0.643
Validation loss decreased (-0.620590 --> -0.643278).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1296782
	speed: 0.5326s/iter; left time: 19205.7406s
	iters: 200, epoch: 3 | loss: 2.6486762
	speed: 0.1336s/iter; left time: 4803.4222s
	iters: 300, epoch: 3 | loss: 1.9138224
	speed: 0.1306s/iter; left time: 4683.7785s
Epoch: 3 cost time: 49.97410011291504
Epoch: 3, Steps: 369 | Train Loss: 2.257 Vali Loss: 2.865 Vali Acc: 0.659 Test Loss: 2.865 Test Acc: 0.659
Validation loss decreased (-0.643278 --> -0.658882).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8224566
	speed: 0.5255s/iter; left time: 18758.8950s
	iters: 200, epoch: 4 | loss: 2.4623566
	speed: 0.1301s/iter; left time: 4629.3560s
	iters: 300, epoch: 4 | loss: 3.0265784
	speed: 0.1287s/iter; left time: 4568.7295s
Epoch: 4 cost time: 50.144575119018555
Epoch: 4, Steps: 369 | Train Loss: 2.338 Vali Loss: 2.620 Vali Acc: 0.666 Test Loss: 2.620 Test Acc: 0.666
Validation loss decreased (-0.658882 --> -0.665695).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2360084
	speed: 0.5573s/iter; left time: 19685.4950s
	iters: 200, epoch: 5 | loss: 1.4280365
	speed: 0.1426s/iter; left time: 5023.7617s
	iters: 300, epoch: 5 | loss: 3.5682604
	speed: 0.1433s/iter; left time: 5033.0917s
Epoch: 5 cost time: 53.65969514846802
Epoch: 5, Steps: 369 | Train Loss: 2.538 Vali Loss: 4.967 Vali Acc: 0.613 Test Loss: 4.967 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3936560
	speed: 0.5816s/iter; left time: 20330.9829s
	iters: 200, epoch: 6 | loss: 0.7016951
	speed: 0.1486s/iter; left time: 5178.0533s
	iters: 300, epoch: 6 | loss: 1.3139833
	speed: 0.1506s/iter; left time: 5234.1126s
Epoch: 6 cost time: 55.99834108352661
Epoch: 6, Steps: 369 | Train Loss: 2.381 Vali Loss: 4.410 Vali Acc: 0.623 Test Loss: 4.410 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.7318807
	speed: 0.5628s/iter; left time: 19465.3676s
	iters: 200, epoch: 7 | loss: 2.4999170
	speed: 0.1390s/iter; left time: 4792.9674s
	iters: 300, epoch: 7 | loss: 2.5613568
	speed: 0.1350s/iter; left time: 4640.6033s
Epoch: 7 cost time: 51.595359802246094
Epoch: 7, Steps: 369 | Train Loss: 1.979 Vali Loss: 4.749 Vali Acc: 0.627 Test Loss: 4.749 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8345525
	speed: 0.5414s/iter; left time: 18526.9797s
	iters: 200, epoch: 8 | loss: 2.1792572
	speed: 0.1326s/iter; left time: 4524.8829s
	iters: 300, epoch: 8 | loss: 0.6520424
	speed: 0.1286s/iter; left time: 4375.7558s
Epoch: 8 cost time: 48.03655767440796
Epoch: 8, Steps: 369 | Train Loss: 1.469 Vali Loss: 4.444 Vali Acc: 0.654 Test Loss: 4.444 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1058112
	speed: 0.5548s/iter; left time: 18781.0510s
	iters: 200, epoch: 9 | loss: 1.2762796
	speed: 0.0919s/iter; left time: 3100.0672s
	iters: 300, epoch: 9 | loss: 0.7021985
	speed: 0.0916s/iter; left time: 3082.2697s
Epoch: 9 cost time: 38.333648443222046
Epoch: 9, Steps: 369 | Train Loss: 1.019 Vali Loss: 3.290 Vali Acc: 0.654 Test Loss: 3.290 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0396388
	speed: 0.4018s/iter; left time: 13451.5441s
	iters: 200, epoch: 10 | loss: 0.5360023
	speed: 0.1410s/iter; left time: 4706.5518s
	iters: 300, epoch: 10 | loss: 0.0154214
	speed: 0.1393s/iter; left time: 4636.5823s
Epoch: 10 cost time: 50.399837493896484
Epoch: 10, Steps: 369 | Train Loss: 0.682 Vali Loss: 2.879 Vali Acc: 0.632 Test Loss: 2.879 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1052639
	speed: 0.5622s/iter; left time: 18615.3853s
	iters: 200, epoch: 11 | loss: 0.0551129
	speed: 0.1415s/iter; left time: 4669.8428s
	iters: 300, epoch: 11 | loss: 0.8111504
	speed: 0.1422s/iter; left time: 4679.7577s
Epoch: 11 cost time: 53.36713099479675
Epoch: 11, Steps: 369 | Train Loss: 0.407 Vali Loss: 2.126 Vali Acc: 0.631 Test Loss: 2.126 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1510596
	speed: 0.5568s/iter; left time: 18231.1804s
	iters: 200, epoch: 12 | loss: 0.0644831
	speed: 0.1344s/iter; left time: 4387.4684s
	iters: 300, epoch: 12 | loss: 0.1533932
	speed: 0.1345s/iter; left time: 4376.7433s
Epoch: 12 cost time: 51.493367195129395
Epoch: 12, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.746 Vali Acc: 0.635 Test Loss: 1.746 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0922594
	speed: 0.5283s/iter; left time: 17103.5315s
	iters: 200, epoch: 13 | loss: 0.0452885
	speed: 0.1333s/iter; left time: 4302.2125s
	iters: 300, epoch: 13 | loss: 0.6780249
	speed: 0.1242s/iter; left time: 3996.1253s
Epoch: 13 cost time: 48.65127444267273
Epoch: 13, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.870 Vali Acc: 0.650 Test Loss: 1.870 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0504467
	speed: 0.5433s/iter; left time: 17388.6269s
	iters: 200, epoch: 14 | loss: 0.0277826
	speed: 0.1391s/iter; left time: 4437.6423s
	iters: 300, epoch: 14 | loss: 0.4003171
	speed: 0.1392s/iter; left time: 4425.6321s
Epoch: 14 cost time: 52.42434000968933
Epoch: 14, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.809 Vali Acc: 0.643 Test Loss: 1.809 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6657207718501703
model parameter : 377474
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6026821
	speed: 0.1416s/iter; left time: 5210.9110s
	iters: 200, epoch: 1 | loss: 2.0940671
	speed: 0.0973s/iter; left time: 3569.8887s
	iters: 300, epoch: 1 | loss: 1.2284634
	speed: 0.1019s/iter; left time: 3730.2486s
Epoch: 1 cost time: 41.33147597312927
Epoch: 1, Steps: 369 | Train Loss: 1.092 Vali Loss: 0.947 Vali Acc: 0.662 Test Loss: 0.947 Test Acc: 0.662
Validation loss decreased (inf --> -0.661739).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5593650
	speed: 0.3950s/iter; left time: 14391.0614s
	iters: 200, epoch: 2 | loss: 1.7483747
	speed: 0.1014s/iter; left time: 3682.6834s
	iters: 300, epoch: 2 | loss: 1.8202747
	speed: 0.0993s/iter; left time: 3599.1063s
Epoch: 2 cost time: 38.48129868507385
Epoch: 2, Steps: 369 | Train Loss: 1.438 Vali Loss: 1.939 Vali Acc: 0.639 Test Loss: 1.939 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1343615
	speed: 0.3934s/iter; left time: 14187.6465s
	iters: 200, epoch: 3 | loss: 2.0356519
	speed: 0.1002s/iter; left time: 3602.0622s
	iters: 300, epoch: 3 | loss: 0.8863513
	speed: 0.0974s/iter; left time: 3493.4818s
Epoch: 3 cost time: 38.735203981399536
Epoch: 3, Steps: 369 | Train Loss: 1.943 Vali Loss: 2.483 Vali Acc: 0.635 Test Loss: 2.483 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3465743
	speed: 0.4269s/iter; left time: 15236.4317s
	iters: 200, epoch: 4 | loss: 2.1820982
	speed: 0.1156s/iter; left time: 4115.1208s
	iters: 300, epoch: 4 | loss: 1.7508628
	speed: 0.1152s/iter; left time: 4089.0015s
Epoch: 4 cost time: 43.48734951019287
Epoch: 4, Steps: 369 | Train Loss: 2.186 Vali Loss: 3.291 Vali Acc: 0.651 Test Loss: 3.291 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.1111660
	speed: 0.4298s/iter; left time: 15183.9877s
	iters: 200, epoch: 5 | loss: 1.9803928
	speed: 0.1134s/iter; left time: 3993.7544s
	iters: 300, epoch: 5 | loss: 0.7681810
	speed: 0.1127s/iter; left time: 3959.4615s
Epoch: 5 cost time: 42.65159893035889
Epoch: 5, Steps: 369 | Train Loss: 2.109 Vali Loss: 3.969 Vali Acc: 0.645 Test Loss: 3.969 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.4369318
	speed: 0.4158s/iter; left time: 14535.9323s
	iters: 200, epoch: 6 | loss: 2.1682324
	speed: 0.1010s/iter; left time: 3519.3209s
	iters: 300, epoch: 6 | loss: 0.5378726
	speed: 0.0970s/iter; left time: 3371.0141s
Epoch: 6 cost time: 38.00229287147522
Epoch: 6, Steps: 369 | Train Loss: 1.983 Vali Loss: 2.774 Vali Acc: 0.660 Test Loss: 2.774 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8899508
	speed: 0.3837s/iter; left time: 13271.3860s
	iters: 200, epoch: 7 | loss: 0.9913417
	speed: 0.0997s/iter; left time: 3438.9171s
	iters: 300, epoch: 7 | loss: 0.0164975
	speed: 0.0941s/iter; left time: 3234.6590s
Epoch: 7 cost time: 37.27951240539551
Epoch: 7, Steps: 369 | Train Loss: 1.635 Vali Loss: 4.104 Vali Acc: 0.634 Test Loss: 4.104 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.1664168
	speed: 0.3906s/iter; left time: 13364.4030s
	iters: 200, epoch: 8 | loss: 0.5870215
	speed: 0.1044s/iter; left time: 3561.0525s
	iters: 300, epoch: 8 | loss: 0.6311446
	speed: 0.1081s/iter; left time: 3676.2927s
Epoch: 8 cost time: 39.822691679000854
Epoch: 8, Steps: 369 | Train Loss: 1.277 Vali Loss: 4.029 Vali Acc: 0.656 Test Loss: 4.029 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.2387853
	speed: 0.4208s/iter; left time: 14244.1762s
	iters: 200, epoch: 9 | loss: 1.6290373
	speed: 0.1157s/iter; left time: 3904.0797s
	iters: 300, epoch: 9 | loss: 0.2415268
	speed: 0.1151s/iter; left time: 3873.6023s
Epoch: 9 cost time: 43.26346254348755
Epoch: 9, Steps: 369 | Train Loss: 0.882 Vali Loss: 3.586 Vali Acc: 0.639 Test Loss: 3.586 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0373092
	speed: 0.4497s/iter; left time: 15054.9913s
	iters: 200, epoch: 10 | loss: 0.3163208
	speed: 0.1151s/iter; left time: 3841.9657s
	iters: 300, epoch: 10 | loss: 0.0280838
	speed: 0.1141s/iter; left time: 3796.1289s
Epoch: 10 cost time: 43.5321307182312
Epoch: 10, Steps: 369 | Train Loss: 0.685 Vali Loss: 3.077 Vali Acc: 0.648 Test Loss: 3.077 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6571746
	speed: 0.4267s/iter; left time: 14128.3632s
	iters: 200, epoch: 11 | loss: 0.4778779
	speed: 0.1022s/iter; left time: 3374.4474s
	iters: 300, epoch: 11 | loss: 0.6446186
	speed: 0.1014s/iter; left time: 3336.7097s
Epoch: 11 cost time: 38.81811714172363
Epoch: 11, Steps: 369 | Train Loss: 0.409 Vali Loss: 2.212 Vali Acc: 0.646 Test Loss: 2.212 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6617480136208853
model parameter : 322370
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9404601
	speed: 0.1261s/iter; left time: 4642.3744s
	iters: 200, epoch: 1 | loss: 1.6497397
	speed: 0.0987s/iter; left time: 3622.4244s
	iters: 300, epoch: 1 | loss: 0.6560625
	speed: 0.0993s/iter; left time: 3634.6766s
Epoch: 1 cost time: 39.551151275634766
Epoch: 1, Steps: 369 | Train Loss: 0.983 Vali Loss: 1.059 Vali Acc: 0.644 Test Loss: 1.059 Test Acc: 0.644
Validation loss decreased (inf --> -0.643860).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8771260
	speed: 0.3857s/iter; left time: 14052.3790s
	iters: 200, epoch: 2 | loss: 2.1082187
	speed: 0.1018s/iter; left time: 3697.5460s
	iters: 300, epoch: 2 | loss: 0.9923130
	speed: 0.1021s/iter; left time: 3698.5836s
Epoch: 2 cost time: 38.31869196891785
Epoch: 2, Steps: 369 | Train Loss: 1.301 Vali Loss: 1.514 Vali Acc: 0.649 Test Loss: 1.514 Test Acc: 0.649
Validation loss decreased (-0.643860 --> -0.648680).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6941950
	speed: 0.3842s/iter; left time: 13855.5554s
	iters: 200, epoch: 3 | loss: 2.6041667
	speed: 0.1021s/iter; left time: 3672.7746s
	iters: 300, epoch: 3 | loss: 1.6559768
	speed: 0.1017s/iter; left time: 3646.5722s
Epoch: 3 cost time: 37.5185022354126
Epoch: 3, Steps: 369 | Train Loss: 1.688 Vali Loss: 2.167 Vali Acc: 0.647 Test Loss: 2.167 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1247335
	speed: 0.3615s/iter; left time: 12902.0358s
	iters: 200, epoch: 4 | loss: 3.4677894
	speed: 0.0915s/iter; left time: 3258.2570s
	iters: 300, epoch: 4 | loss: 1.9256760
	speed: 0.0884s/iter; left time: 3138.2529s
Epoch: 4 cost time: 34.71599459648132
Epoch: 4, Steps: 369 | Train Loss: 1.741 Vali Loss: 3.593 Vali Acc: 0.573 Test Loss: 3.593 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3189697
	speed: 0.3568s/iter; left time: 12602.5513s
	iters: 200, epoch: 5 | loss: 0.9591393
	speed: 0.0945s/iter; left time: 3327.8910s
	iters: 300, epoch: 5 | loss: 3.2063363
	speed: 0.0907s/iter; left time: 3185.7885s
Epoch: 5 cost time: 35.16827893257141
Epoch: 5, Steps: 369 | Train Loss: 1.866 Vali Loss: 2.279 Vali Acc: 0.650 Test Loss: 2.279 Test Acc: 0.650
Validation loss decreased (-0.648680 --> -0.649523).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2217257
	speed: 0.3530s/iter; left time: 12340.0010s
	iters: 200, epoch: 6 | loss: 1.5130910
	speed: 0.1011s/iter; left time: 3524.7438s
	iters: 300, epoch: 6 | loss: 2.0227714
	speed: 0.1012s/iter; left time: 3516.9901s
Epoch: 6 cost time: 38.358190059661865
Epoch: 6, Steps: 369 | Train Loss: 1.674 Vali Loss: 4.657 Vali Acc: 0.647 Test Loss: 4.657 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4801991
	speed: 0.3855s/iter; left time: 13331.7497s
	iters: 200, epoch: 7 | loss: 0.9138498
	speed: 0.1012s/iter; left time: 3489.2703s
	iters: 300, epoch: 7 | loss: 2.7743952
	speed: 0.0987s/iter; left time: 3393.1800s
Epoch: 7 cost time: 37.72489953041077
Epoch: 7, Steps: 369 | Train Loss: 1.529 Vali Loss: 3.461 Vali Acc: 0.644 Test Loss: 3.461 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8757516
	speed: 0.3936s/iter; left time: 13469.7779s
	iters: 200, epoch: 8 | loss: 1.7294822
	speed: 0.0997s/iter; left time: 3400.3945s
	iters: 300, epoch: 8 | loss: 1.3937032
	speed: 0.0996s/iter; left time: 3389.8641s
Epoch: 8 cost time: 37.579936265945435
Epoch: 8, Steps: 369 | Train Loss: 1.172 Vali Loss: 3.254 Vali Acc: 0.629 Test Loss: 3.254 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.9057615
	speed: 0.3666s/iter; left time: 12410.5343s
	iters: 200, epoch: 9 | loss: 1.2838402
	speed: 0.0907s/iter; left time: 3062.6013s
	iters: 300, epoch: 9 | loss: 0.0832416
	speed: 0.0892s/iter; left time: 3001.6465s
Epoch: 9 cost time: 34.14125084877014
Epoch: 9, Steps: 369 | Train Loss: 0.844 Vali Loss: 3.027 Vali Acc: 0.648 Test Loss: 3.027 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2186243
	speed: 0.3446s/iter; left time: 11538.1347s
	iters: 200, epoch: 10 | loss: 2.2388105
	speed: 0.0928s/iter; left time: 3097.0901s
	iters: 300, epoch: 10 | loss: 0.4644111
	speed: 0.0921s/iter; left time: 3065.4728s
Epoch: 10 cost time: 34.27354025840759
Epoch: 10, Steps: 369 | Train Loss: 0.580 Vali Loss: 2.560 Vali Acc: 0.643 Test Loss: 2.560 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.2612792
	speed: 0.3619s/iter; left time: 11982.1774s
	iters: 200, epoch: 11 | loss: 0.3890751
	speed: 0.0939s/iter; left time: 3100.3719s
	iters: 300, epoch: 11 | loss: 0.4695947
	speed: 0.0881s/iter; left time: 2899.8624s
Epoch: 11 cost time: 35.48212456703186
Epoch: 11, Steps: 369 | Train Loss: 0.374 Vali Loss: 1.863 Vali Acc: 0.638 Test Loss: 1.863 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2957182
	speed: 0.3857s/iter; left time: 12628.2668s
	iters: 200, epoch: 12 | loss: 0.3248496
	speed: 0.1005s/iter; left time: 3279.8668s
	iters: 300, epoch: 12 | loss: 0.2028432
	speed: 0.0989s/iter; left time: 3217.6331s
Epoch: 12 cost time: 37.948001861572266
Epoch: 12, Steps: 369 | Train Loss: 0.258 Vali Loss: 1.830 Vali Acc: 0.631 Test Loss: 1.830 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1104013
	speed: 0.3886s/iter; left time: 12581.6090s
	iters: 200, epoch: 13 | loss: 0.3136841
	speed: 0.1005s/iter; left time: 3242.6356s
	iters: 300, epoch: 13 | loss: 0.0528530
	speed: 0.0996s/iter; left time: 3203.0461s
Epoch: 13 cost time: 38.24550151824951
Epoch: 13, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.734 Vali Acc: 0.653 Test Loss: 1.734 Test Acc: 0.653
Validation loss decreased (-0.649523 --> -0.653218).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1435399
	speed: 0.3902s/iter; left time: 12488.0378s
	iters: 200, epoch: 14 | loss: 0.1579265
	speed: 0.0890s/iter; left time: 2838.2842s
	iters: 300, epoch: 14 | loss: 0.1389066
	speed: 0.0887s/iter; left time: 2821.1003s
Epoch: 14 cost time: 35.16112685203552
Epoch: 14, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.751 Vali Acc: 0.654 Test Loss: 1.751 Test Acc: 0.654
Validation loss decreased (-0.653218 --> -0.654353).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1127488
	speed: 0.3555s/iter; left time: 11246.7227s
	iters: 200, epoch: 15 | loss: 0.0168652
	speed: 0.0898s/iter; left time: 2831.5599s
	iters: 300, epoch: 15 | loss: 0.1748807
	speed: 0.0888s/iter; left time: 2789.8797s
Epoch: 15 cost time: 33.400816440582275
Epoch: 15, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.727 Vali Acc: 0.658 Test Loss: 1.727 Test Acc: 0.658
Validation loss decreased (-0.654353 --> -0.657758).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0185747
	speed: 0.3580s/iter; left time: 11193.7167s
	iters: 200, epoch: 16 | loss: 0.1344907
	speed: 0.0857s/iter; left time: 2671.4533s
	iters: 300, epoch: 16 | loss: 0.0890671
	speed: 0.0869s/iter; left time: 2698.4858s
Epoch: 16 cost time: 33.280853271484375
Epoch: 16, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.908 Vali Acc: 0.640 Test Loss: 1.908 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0353072
	speed: 0.3748s/iter; left time: 11579.8177s
	iters: 200, epoch: 17 | loss: 0.0058065
	speed: 0.1004s/iter; left time: 3093.4278s
	iters: 300, epoch: 17 | loss: 0.2724476
	speed: 0.1006s/iter; left time: 3088.6041s
Epoch: 17 cost time: 38.37254858016968
Epoch: 17, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.929 Vali Acc: 0.648 Test Loss: 1.929 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0190642
	speed: 0.3823s/iter; left time: 11671.9455s
	iters: 200, epoch: 18 | loss: 0.1432125
	speed: 0.1019s/iter; left time: 3100.5692s
	iters: 300, epoch: 18 | loss: 0.0183911
	speed: 0.1022s/iter; left time: 3099.9926s
Epoch: 18 cost time: 38.42596912384033
Epoch: 18, Steps: 369 | Train Loss: 0.074 Vali Loss: 1.995 Vali Acc: 0.644 Test Loss: 1.995 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0219902
	speed: 0.3892s/iter; left time: 11738.7190s
	iters: 200, epoch: 19 | loss: 0.0066397
	speed: 0.1023s/iter; left time: 3075.8531s
	iters: 300, epoch: 19 | loss: 0.0047205
	speed: 0.1014s/iter; left time: 3039.0105s
Epoch: 19 cost time: 38.514564990997314
Epoch: 19, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.170 Vali Acc: 0.644 Test Loss: 2.170 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3085644
	speed: 0.3662s/iter; left time: 10908.5323s
	iters: 200, epoch: 20 | loss: 0.0267764
	speed: 0.0929s/iter; left time: 2759.3780s
	iters: 300, epoch: 20 | loss: 0.0025476
	speed: 0.0897s/iter; left time: 2653.7855s
Epoch: 20 cost time: 34.68545126914978
Epoch: 20, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.219 Vali Acc: 0.644 Test Loss: 2.219 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0309181
	speed: 0.3398s/iter; left time: 9997.1791s
	iters: 200, epoch: 21 | loss: 0.0531948
	speed: 0.0868s/iter; left time: 2544.0943s
	iters: 300, epoch: 21 | loss: 0.0515737
	speed: 0.0900s/iter; left time: 2628.4410s
Epoch: 21 cost time: 33.4761061668396
Epoch: 21, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.200 Vali Acc: 0.643 Test Loss: 2.200 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1966979
	speed: 0.3632s/iter; left time: 10551.4151s
	iters: 200, epoch: 22 | loss: 0.1030792
	speed: 0.0902s/iter; left time: 2612.3935s
	iters: 300, epoch: 22 | loss: 0.0016513
	speed: 0.1008s/iter; left time: 2907.5298s
Epoch: 22 cost time: 36.17923283576965
Epoch: 22, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.328 Vali Acc: 0.642 Test Loss: 2.328 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0025790
	speed: 0.3819s/iter; left time: 10955.4465s
	iters: 200, epoch: 23 | loss: 0.0176225
	speed: 0.1002s/iter; left time: 2864.9435s
	iters: 300, epoch: 23 | loss: 0.1279315
	speed: 0.1009s/iter; left time: 2875.3482s
Epoch: 23 cost time: 38.06551909446716
Epoch: 23, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.260 Vali Acc: 0.642 Test Loss: 2.260 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0920929
	speed: 0.3871s/iter; left time: 10959.9736s
	iters: 200, epoch: 24 | loss: 0.1413828
	speed: 0.1015s/iter; left time: 2863.9507s
	iters: 300, epoch: 24 | loss: 0.3721424
	speed: 0.1008s/iter; left time: 2835.1646s
Epoch: 24 cost time: 38.296964168548584
Epoch: 24, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.295 Vali Acc: 0.642 Test Loss: 2.295 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0009109
	speed: 0.3882s/iter; left time: 10847.7762s
	iters: 200, epoch: 25 | loss: 0.0289648
	speed: 0.0908s/iter; left time: 2527.4346s
	iters: 300, epoch: 25 | loss: 0.2085081
	speed: 0.0908s/iter; left time: 2518.0404s
Epoch: 25 cost time: 34.58560085296631
Epoch: 25, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.272 Vali Acc: 0.639 Test Loss: 2.272 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 267266
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8934376
	speed: 0.1067s/iter; left time: 3928.1802s
	iters: 200, epoch: 1 | loss: 1.6800997
	speed: 0.0799s/iter; left time: 2931.2120s
	iters: 300, epoch: 1 | loss: 1.3250052
	speed: 0.0791s/iter; left time: 2893.9746s
Epoch: 1 cost time: 31.934374570846558
Epoch: 1, Steps: 369 | Train Loss: 0.938 Vali Loss: 0.871 Vali Acc: 0.668 Test Loss: 0.871 Test Acc: 0.668
Validation loss decreased (inf --> -0.667982).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8060601
	speed: 0.3265s/iter; left time: 11893.3172s
	iters: 200, epoch: 2 | loss: 1.2510020
	speed: 0.0849s/iter; left time: 3086.2222s
	iters: 300, epoch: 2 | loss: 0.1624571
	speed: 0.0852s/iter; left time: 3087.6442s
Epoch: 2 cost time: 32.28365159034729
Epoch: 2, Steps: 369 | Train Loss: 1.147 Vali Loss: 2.125 Vali Acc: 0.562 Test Loss: 2.125 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5161966
	speed: 0.3469s/iter; left time: 12510.0031s
	iters: 200, epoch: 3 | loss: 3.3123193
	speed: 0.0873s/iter; left time: 3140.3248s
	iters: 300, epoch: 3 | loss: 2.0795810
	speed: 0.0844s/iter; left time: 3028.4828s
Epoch: 3 cost time: 31.999561548233032
Epoch: 3, Steps: 369 | Train Loss: 1.482 Vali Loss: 2.215 Vali Acc: 0.649 Test Loss: 2.215 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1797878
	speed: 0.3378s/iter; left time: 12056.9982s
	iters: 200, epoch: 4 | loss: 1.1649528
	speed: 0.0835s/iter; left time: 2973.6379s
	iters: 300, epoch: 4 | loss: 3.5766051
	speed: 0.0833s/iter; left time: 2955.7255s
Epoch: 4 cost time: 31.64113974571228
Epoch: 4, Steps: 369 | Train Loss: 1.582 Vali Loss: 2.536 Vali Acc: 0.646 Test Loss: 2.536 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.7962370
	speed: 0.3348s/iter; left time: 11827.0143s
	iters: 200, epoch: 5 | loss: 3.2049305
	speed: 0.0768s/iter; left time: 2704.6157s
	iters: 300, epoch: 5 | loss: 1.6845610
	speed: 0.0784s/iter; left time: 2755.0491s
Epoch: 5 cost time: 29.7848002910614
Epoch: 5, Steps: 369 | Train Loss: 1.451 Vali Loss: 3.068 Vali Acc: 0.638 Test Loss: 3.068 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4594899
	speed: 0.3345s/iter; left time: 11692.2276s
	iters: 200, epoch: 6 | loss: 1.4225618
	speed: 0.0758s/iter; left time: 2641.1222s
	iters: 300, epoch: 6 | loss: 2.9148796
	speed: 0.0782s/iter; left time: 2716.4571s
Epoch: 6 cost time: 29.240734577178955
Epoch: 6, Steps: 369 | Train Loss: 1.424 Vali Loss: 2.894 Vali Acc: 0.631 Test Loss: 2.894 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.2365384
	speed: 0.3396s/iter; left time: 11744.2346s
	iters: 200, epoch: 7 | loss: 1.4621469
	speed: 0.0758s/iter; left time: 2612.5109s
	iters: 300, epoch: 7 | loss: 0.2986421
	speed: 0.0731s/iter; left time: 2512.8613s
Epoch: 7 cost time: 29.393091678619385
Epoch: 7, Steps: 369 | Train Loss: 1.122 Vali Loss: 2.981 Vali Acc: 0.647 Test Loss: 2.981 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.4029456
	speed: 0.3449s/iter; left time: 11800.3359s
	iters: 200, epoch: 8 | loss: 0.4058091
	speed: 0.0863s/iter; left time: 2945.3122s
	iters: 300, epoch: 8 | loss: 0.5333962
	speed: 0.0868s/iter; left time: 2953.6736s
Epoch: 8 cost time: 33.004393577575684
Epoch: 8, Steps: 369 | Train Loss: 0.896 Vali Loss: 3.367 Vali Acc: 0.644 Test Loss: 3.367 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.9418179
	speed: 0.3690s/iter; left time: 12489.7845s
	iters: 200, epoch: 9 | loss: 0.1619352
	speed: 0.0878s/iter; left time: 2963.7613s
	iters: 300, epoch: 9 | loss: 1.0534130
	speed: 0.0880s/iter; left time: 2961.2817s
Epoch: 9 cost time: 33.390185832977295
Epoch: 9, Steps: 369 | Train Loss: 0.738 Vali Loss: 3.319 Vali Acc: 0.639 Test Loss: 3.319 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.3050337
	speed: 0.3632s/iter; left time: 12161.0050s
	iters: 200, epoch: 10 | loss: 0.1996571
	speed: 0.0883s/iter; left time: 2946.7636s
	iters: 300, epoch: 10 | loss: 2.6263962
	speed: 0.0855s/iter; left time: 2845.2683s
Epoch: 10 cost time: 32.30452585220337
Epoch: 10, Steps: 369 | Train Loss: 0.551 Vali Loss: 3.141 Vali Acc: 0.635 Test Loss: 3.141 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6741161
	speed: 0.3254s/iter; left time: 10775.1894s
	iters: 200, epoch: 11 | loss: 0.0049260
	speed: 0.0804s/iter; left time: 2654.8706s
	iters: 300, epoch: 11 | loss: 0.7404653
	speed: 0.0767s/iter; left time: 2522.7818s
Epoch: 11 cost time: 29.164626121520996
Epoch: 11, Steps: 369 | Train Loss: 0.404 Vali Loss: 2.647 Vali Acc: 0.635 Test Loss: 2.647 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 230594
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.7143288
	speed: 0.4773s/iter; left time: 17565.7582s
	iters: 200, epoch: 1 | loss: 1.4766709
	speed: 0.4612s/iter; left time: 16924.8370s
	iters: 300, epoch: 1 | loss: 1.8860438
	speed: 0.4653s/iter; left time: 17031.9624s
Epoch: 1 cost time: 172.61123514175415
Epoch: 1, Steps: 369 | Train Loss: 2.407 Vali Loss: 1.572 Vali Acc: 0.637 Test Loss: 1.572 Test Acc: 0.637
Validation loss decreased (inf --> -0.637044).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3355443
	speed: 1.5043s/iter; left time: 54804.1593s
	iters: 200, epoch: 2 | loss: 4.4793777
	speed: 0.4203s/iter; left time: 15270.9334s
	iters: 300, epoch: 2 | loss: 5.4106522
	speed: 0.4116s/iter; left time: 14911.6251s
Epoch: 2 cost time: 158.54473733901978
Epoch: 2, Steps: 369 | Train Loss: 3.616 Vali Loss: 3.630 Vali Acc: 0.653 Test Loss: 3.630 Test Acc: 0.653
Validation loss decreased (-0.637044 --> -0.652631).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5086737
	speed: 1.5578s/iter; left time: 56178.2490s
	iters: 200, epoch: 3 | loss: 7.3687201
	speed: 0.4665s/iter; left time: 16776.7054s
	iters: 300, epoch: 3 | loss: 5.3831387
	speed: 0.4321s/iter; left time: 15497.8639s
Epoch: 3 cost time: 166.90545558929443
Epoch: 3, Steps: 369 | Train Loss: 4.909 Vali Loss: 4.823 Vali Acc: 0.651 Test Loss: 4.823 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6689627
	speed: 1.4649s/iter; left time: 52287.6653s
	iters: 200, epoch: 4 | loss: 6.6528149
	speed: 0.4561s/iter; left time: 16235.1007s
	iters: 300, epoch: 4 | loss: 3.0363011
	speed: 0.4501s/iter; left time: 15977.0544s
Epoch: 4 cost time: 167.25016927719116
Epoch: 4, Steps: 369 | Train Loss: 5.194 Vali Loss: 7.606 Vali Acc: 0.637 Test Loss: 7.606 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 6.0216446
	speed: 1.4984s/iter; left time: 52931.3027s
	iters: 200, epoch: 5 | loss: 7.3788781
	speed: 0.4257s/iter; left time: 14993.6835s
	iters: 300, epoch: 5 | loss: 4.5992732
	speed: 0.4275s/iter; left time: 15015.6844s
Epoch: 5 cost time: 161.1293249130249
Epoch: 5, Steps: 369 | Train Loss: 4.968 Vali Loss: 7.792 Vali Acc: 0.628 Test Loss: 7.792 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.1746149
	speed: 1.5603s/iter; left time: 54540.9737s
	iters: 200, epoch: 6 | loss: 2.3214653
	speed: 0.4623s/iter; left time: 16113.5750s
	iters: 300, epoch: 6 | loss: 3.6156394
	speed: 0.4216s/iter; left time: 14653.7805s
Epoch: 6 cost time: 164.80913734436035
Epoch: 6, Steps: 369 | Train Loss: 4.412 Vali Loss: 12.134 Vali Acc: 0.615 Test Loss: 12.134 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3951777
	speed: 1.4376s/iter; left time: 49722.0917s
	iters: 200, epoch: 7 | loss: 1.2292175
	speed: 0.3564s/iter; left time: 12292.8745s
	iters: 300, epoch: 7 | loss: 2.7962232
	speed: 0.2996s/iter; left time: 10302.8278s
Epoch: 7 cost time: 136.60511946678162
Epoch: 7, Steps: 369 | Train Loss: 3.544 Vali Loss: 8.703 Vali Acc: 0.634 Test Loss: 8.703 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.4671643
	speed: 1.4466s/iter; left time: 49499.1577s
	iters: 200, epoch: 8 | loss: 1.9029560
	speed: 0.4382s/iter; left time: 14950.9655s
	iters: 300, epoch: 8 | loss: 0.0013192
	speed: 0.3835s/iter; left time: 13047.0161s
Epoch: 8 cost time: 153.19857788085938
Epoch: 8, Steps: 369 | Train Loss: 2.529 Vali Loss: 10.905 Vali Acc: 0.628 Test Loss: 10.905 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.0464680
	speed: 1.3128s/iter; left time: 44436.6155s
	iters: 200, epoch: 9 | loss: 3.9133062
	speed: 0.4167s/iter; left time: 14063.4577s
	iters: 300, epoch: 9 | loss: 0.8004644
	speed: 0.4281s/iter; left time: 14406.0218s
Epoch: 9 cost time: 155.55875253677368
Epoch: 9, Steps: 369 | Train Loss: 1.769 Vali Loss: 10.207 Vali Acc: 0.629 Test Loss: 10.207 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7751294
	speed: 1.3517s/iter; left time: 45253.3297s
	iters: 200, epoch: 10 | loss: 4.2322106
	speed: 0.3770s/iter; left time: 12585.8759s
	iters: 300, epoch: 10 | loss: 1.4129114
	speed: 0.4169s/iter; left time: 13875.9107s
Epoch: 10 cost time: 147.73058533668518
Epoch: 10, Steps: 369 | Train Loss: 1.258 Vali Loss: 8.581 Vali Acc: 0.633 Test Loss: 8.581 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8963721
	speed: 1.4489s/iter; left time: 47972.8793s
	iters: 200, epoch: 11 | loss: 2.0283778
	speed: 0.3799s/iter; left time: 12540.3700s
	iters: 300, epoch: 11 | loss: 2.6766779
	speed: 0.3788s/iter; left time: 12467.6677s
Epoch: 11 cost time: 145.29945135116577
Epoch: 11, Steps: 369 | Train Loss: 0.776 Vali Loss: 8.152 Vali Acc: 0.632 Test Loss: 8.152 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0002790
	speed: 1.4060s/iter; left time: 46034.9799s
	iters: 200, epoch: 12 | loss: 0.7094879
	speed: 0.4282s/iter; left time: 13978.4448s
	iters: 300, epoch: 12 | loss: 0.0000202
	speed: 0.4257s/iter; left time: 13851.7051s
Epoch: 12 cost time: 154.29259538650513
Epoch: 12, Steps: 369 | Train Loss: 0.498 Vali Loss: 7.773 Vali Acc: 0.636 Test Loss: 7.773 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 1218690
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3872494
	speed: 0.2530s/iter; left time: 9310.9008s
	iters: 200, epoch: 1 | loss: 0.8063524
	speed: 0.2315s/iter; left time: 8495.5153s
	iters: 300, epoch: 1 | loss: 1.2530085
	speed: 0.1999s/iter; left time: 7315.6580s
Epoch: 1 cost time: 82.42944884300232
Epoch: 1, Steps: 369 | Train Loss: 1.829 Vali Loss: 1.409 Vali Acc: 0.618 Test Loss: 1.409 Test Acc: 0.618
Validation loss decreased (inf --> -0.618034).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8452133
	speed: 0.7888s/iter; left time: 28736.2223s
	iters: 200, epoch: 2 | loss: 1.0326076
	speed: 0.2161s/iter; left time: 7850.6217s
	iters: 300, epoch: 2 | loss: 2.5591729
	speed: 0.2381s/iter; left time: 8627.5121s
Epoch: 2 cost time: 83.45576786994934
Epoch: 2, Steps: 369 | Train Loss: 2.418 Vali Loss: 2.423 Vali Acc: 0.654 Test Loss: 2.423 Test Acc: 0.654
Validation loss decreased (-0.618034 --> -0.654346).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6527213
	speed: 0.9027s/iter; left time: 32553.7538s
	iters: 200, epoch: 3 | loss: 1.4989221
	speed: 0.2363s/iter; left time: 8498.1183s
	iters: 300, epoch: 3 | loss: 2.0986447
	speed: 0.2372s/iter; left time: 8507.7558s
Epoch: 3 cost time: 86.42264366149902
Epoch: 3, Steps: 369 | Train Loss: 3.417 Vali Loss: 3.380 Vali Acc: 0.651 Test Loss: 3.380 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5075501
	speed: 0.7920s/iter; left time: 28270.1612s
	iters: 200, epoch: 4 | loss: 2.2293885
	speed: 0.2017s/iter; left time: 7180.2678s
	iters: 300, epoch: 4 | loss: 3.6918852
	speed: 0.2090s/iter; left time: 7419.6085s
Epoch: 4 cost time: 78.62417483329773
Epoch: 4, Steps: 369 | Train Loss: 3.776 Vali Loss: 3.128 Vali Acc: 0.626 Test Loss: 3.128 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.7855387
	speed: 0.8974s/iter; left time: 31701.6724s
	iters: 200, epoch: 5 | loss: 2.4576364
	speed: 0.2464s/iter; left time: 8680.1892s
	iters: 300, epoch: 5 | loss: 7.8505621
	speed: 0.2504s/iter; left time: 8794.0700s
Epoch: 5 cost time: 92.4127721786499
Epoch: 5, Steps: 369 | Train Loss: 3.569 Vali Loss: 8.277 Vali Acc: 0.625 Test Loss: 8.277 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1302576
	speed: 0.8502s/iter; left time: 29719.4827s
	iters: 200, epoch: 6 | loss: 5.9073482
	speed: 0.1962s/iter; left time: 6838.8902s
	iters: 300, epoch: 6 | loss: 2.0943704
	speed: 0.2066s/iter; left time: 7180.6208s
Epoch: 6 cost time: 76.037100315094
Epoch: 6, Steps: 369 | Train Loss: 3.108 Vali Loss: 4.411 Vali Acc: 0.637 Test Loss: 4.411 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.9914912
	speed: 0.8682s/iter; left time: 30029.6746s
	iters: 200, epoch: 7 | loss: 3.8304064
	speed: 0.2454s/iter; left time: 8461.8160s
	iters: 300, epoch: 7 | loss: 1.9946234
	speed: 0.2482s/iter; left time: 8535.8108s
Epoch: 7 cost time: 91.7311692237854
Epoch: 7, Steps: 369 | Train Loss: 2.472 Vali Loss: 6.745 Vali Acc: 0.628 Test Loss: 6.745 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.1001766
	speed: 0.8930s/iter; left time: 30555.7741s
	iters: 200, epoch: 8 | loss: 0.0578599
	speed: 0.2094s/iter; left time: 7144.5426s
	iters: 300, epoch: 8 | loss: 0.2326386
	speed: 0.2079s/iter; left time: 7073.7199s
Epoch: 8 cost time: 80.02100014686584
Epoch: 8, Steps: 369 | Train Loss: 2.027 Vali Loss: 5.789 Vali Acc: 0.631 Test Loss: 5.789 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8522665
	speed: 0.8611s/iter; left time: 29146.2468s
	iters: 200, epoch: 9 | loss: 1.7562653
	speed: 0.2461s/iter; left time: 8306.0424s
	iters: 300, epoch: 9 | loss: 1.4048074
	speed: 0.2392s/iter; left time: 8049.9994s
Epoch: 9 cost time: 90.46556258201599
Epoch: 9, Steps: 369 | Train Loss: 1.454 Vali Loss: 4.803 Vali Acc: 0.631 Test Loss: 4.803 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.4113168
	speed: 0.9005s/iter; left time: 30148.5352s
	iters: 200, epoch: 10 | loss: 0.5129302
	speed: 0.2082s/iter; left time: 6948.7516s
	iters: 300, epoch: 10 | loss: 0.0203783
	speed: 0.2069s/iter; left time: 6885.1427s
Epoch: 10 cost time: 80.21112895011902
Epoch: 10, Steps: 369 | Train Loss: 0.911 Vali Loss: 4.905 Vali Acc: 0.629 Test Loss: 4.905 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.2943751
	speed: 0.8363s/iter; left time: 27689.7257s
	iters: 200, epoch: 11 | loss: 0.0006871
	speed: 0.2417s/iter; left time: 7977.9897s
	iters: 300, epoch: 11 | loss: 0.0046941
	speed: 0.2417s/iter; left time: 7956.1204s
Epoch: 11 cost time: 89.6768696308136
Epoch: 11, Steps: 369 | Train Loss: 0.566 Vali Loss: 4.108 Vali Acc: 0.639 Test Loss: 4.108 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.8880093
	speed: 0.9217s/iter; left time: 30179.0399s
	iters: 200, epoch: 12 | loss: 0.7724073
	speed: 0.2341s/iter; left time: 7642.6217s
	iters: 300, epoch: 12 | loss: 0.5951338
	speed: 0.2158s/iter; left time: 7021.1346s
Epoch: 12 cost time: 85.79570746421814
Epoch: 12, Steps: 369 | Train Loss: 0.344 Vali Loss: 3.124 Vali Acc: 0.644 Test Loss: 3.124 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6543700340522134
model parameter : 647426
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5642434
	speed: 0.2027s/iter; left time: 7457.7723s
	iters: 200, epoch: 1 | loss: 0.3470846
	speed: 0.1736s/iter; left time: 6371.0337s
	iters: 300, epoch: 1 | loss: 1.4888511
	speed: 0.1788s/iter; left time: 6544.0782s
Epoch: 1 cost time: 67.49792790412903
Epoch: 1, Steps: 369 | Train Loss: 1.355 Vali Loss: 1.297 Vali Acc: 0.640 Test Loss: 1.297 Test Acc: 0.640
Validation loss decreased (inf --> -0.640169).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1747938
	speed: 0.5986s/iter; left time: 21806.6918s
	iters: 200, epoch: 2 | loss: 0.7808601
	speed: 0.1465s/iter; left time: 5321.1893s
	iters: 300, epoch: 2 | loss: 2.2410955
	speed: 0.1542s/iter; left time: 5586.0920s
Epoch: 2 cost time: 57.52375292778015
Epoch: 2, Steps: 369 | Train Loss: 2.075 Vali Loss: 2.813 Vali Acc: 0.655 Test Loss: 2.813 Test Acc: 0.655
Validation loss decreased (-0.640169 --> -0.655193).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3901125
	speed: 0.6123s/iter; left time: 22080.3397s
	iters: 200, epoch: 3 | loss: 1.0782197
	speed: 0.1800s/iter; left time: 6474.0837s
	iters: 300, epoch: 3 | loss: 5.3135324
	speed: 0.1803s/iter; left time: 6467.3700s
Epoch: 3 cost time: 67.2763524055481
Epoch: 3, Steps: 369 | Train Loss: 2.831 Vali Loss: 2.589 Vali Acc: 0.641 Test Loss: 2.589 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4774947
	speed: 0.6609s/iter; left time: 23589.2539s
	iters: 200, epoch: 4 | loss: 1.9280033
	speed: 0.1822s/iter; left time: 6485.7639s
	iters: 300, epoch: 4 | loss: 2.0441818
	speed: 0.1682s/iter; left time: 5969.8539s
Epoch: 4 cost time: 64.79709053039551
Epoch: 4, Steps: 369 | Train Loss: 2.879 Vali Loss: 2.738 Vali Acc: 0.647 Test Loss: 2.738 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.4997449
	speed: 0.5805s/iter; left time: 20506.5181s
	iters: 200, epoch: 5 | loss: 2.1994841
	speed: 0.1487s/iter; left time: 5238.1230s
	iters: 300, epoch: 5 | loss: 0.2022557
	speed: 0.1477s/iter; left time: 5189.0077s
Epoch: 5 cost time: 55.87857389450073
Epoch: 5, Steps: 369 | Train Loss: 2.985 Vali Loss: 3.982 Vali Acc: 0.630 Test Loss: 3.982 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.4317989
	speed: 0.6178s/iter; left time: 21596.4575s
	iters: 200, epoch: 6 | loss: 2.0429466
	speed: 0.1815s/iter; left time: 6327.4278s
	iters: 300, epoch: 6 | loss: 1.1236783
	speed: 0.1824s/iter; left time: 6341.0874s
Epoch: 6 cost time: 67.96060752868652
Epoch: 6, Steps: 369 | Train Loss: 2.669 Vali Loss: 3.315 Vali Acc: 0.655 Test Loss: 3.315 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5294577
	speed: 0.6733s/iter; left time: 23286.3759s
	iters: 200, epoch: 7 | loss: 3.2474437
	speed: 0.1675s/iter; left time: 5775.8808s
	iters: 300, epoch: 7 | loss: 3.9817238
	speed: 0.1566s/iter; left time: 5386.6398s
Epoch: 7 cost time: 62.308579444885254
Epoch: 7, Steps: 369 | Train Loss: 2.219 Vali Loss: 3.195 Vali Acc: 0.646 Test Loss: 3.195 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.4797893
	speed: 0.5796s/iter; left time: 19832.7091s
	iters: 200, epoch: 8 | loss: 0.3872151
	speed: 0.1464s/iter; left time: 4994.3326s
	iters: 300, epoch: 8 | loss: 0.7293136
	speed: 0.1514s/iter; left time: 5151.4884s
Epoch: 8 cost time: 57.258875370025635
Epoch: 8, Steps: 369 | Train Loss: 1.627 Vali Loss: 3.894 Vali Acc: 0.641 Test Loss: 3.894 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6133568
	speed: 0.6242s/iter; left time: 21127.6129s
	iters: 200, epoch: 9 | loss: 0.4165846
	speed: 0.1697s/iter; left time: 5728.8543s
	iters: 300, epoch: 9 | loss: 0.7474915
	speed: 0.1715s/iter; left time: 5771.9402s
Epoch: 9 cost time: 64.67755436897278
Epoch: 9, Steps: 369 | Train Loss: 1.204 Vali Loss: 4.205 Vali Acc: 0.650 Test Loss: 4.205 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.4267946
	speed: 0.6401s/iter; left time: 21429.5235s
	iters: 200, epoch: 10 | loss: 0.0301980
	speed: 0.1505s/iter; left time: 5022.3462s
	iters: 300, epoch: 10 | loss: 0.7370222
	speed: 0.1535s/iter; left time: 5109.9099s
Epoch: 10 cost time: 57.24800634384155
Epoch: 10, Steps: 369 | Train Loss: 0.739 Vali Loss: 3.764 Vali Acc: 0.643 Test Loss: 3.764 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8444750
	speed: 0.5770s/iter; left time: 19104.1611s
	iters: 200, epoch: 11 | loss: 0.0130621
	speed: 0.1379s/iter; left time: 4551.8913s
	iters: 300, epoch: 11 | loss: 1.1481359
	speed: 0.1763s/iter; left time: 5801.6365s
Epoch: 11 cost time: 60.62668991088867
Epoch: 11, Steps: 369 | Train Loss: 0.454 Vali Loss: 2.778 Vali Acc: 0.633 Test Loss: 2.778 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.4231948
	speed: 0.6559s/iter; left time: 21475.0302s
	iters: 200, epoch: 12 | loss: 0.2143974
	speed: 0.1839s/iter; left time: 6002.0311s
	iters: 300, epoch: 12 | loss: 0.1039917
	speed: 0.1842s/iter; left time: 5994.5116s
Epoch: 12 cost time: 68.23963737487793
Epoch: 12, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.933 Vali Acc: 0.649 Test Loss: 1.933 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6552213393870602
model parameter : 463170
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.3515739
	speed: 0.1320s/iter; left time: 4858.3807s
	iters: 200, epoch: 1 | loss: 1.0755510
	speed: 0.1177s/iter; left time: 4321.4783s
	iters: 300, epoch: 1 | loss: 1.3047116
	speed: 0.1134s/iter; left time: 4149.9872s
Epoch: 1 cost time: 42.520169258117676
Epoch: 1, Steps: 369 | Train Loss: 1.182 Vali Loss: 1.059 Vali Acc: 0.671 Test Loss: 1.059 Test Acc: 0.671
Validation loss decreased (inf --> -0.670534).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1926670
	speed: 0.4397s/iter; left time: 16018.1314s
	iters: 200, epoch: 2 | loss: 1.9604046
	speed: 0.1383s/iter; left time: 5024.7447s
	iters: 300, epoch: 2 | loss: 2.0026319
	speed: 0.0826s/iter; left time: 2993.3770s
Epoch: 2 cost time: 44.276345014572144
Epoch: 2, Steps: 369 | Train Loss: 1.751 Vali Loss: 1.922 Vali Acc: 0.640 Test Loss: 1.922 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8798308
	speed: 0.3536s/iter; left time: 12750.1247s
	iters: 200, epoch: 3 | loss: 0.4731484
	speed: 0.0837s/iter; left time: 3010.3806s
	iters: 300, epoch: 3 | loss: 1.7447370
	speed: 0.0833s/iter; left time: 2987.3269s
Epoch: 3 cost time: 31.32428288459778
Epoch: 3, Steps: 369 | Train Loss: 2.198 Vali Loss: 2.626 Vali Acc: 0.647 Test Loss: 2.626 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.2093875
	speed: 0.4027s/iter; left time: 14374.6490s
	iters: 200, epoch: 4 | loss: 0.9278618
	speed: 0.1341s/iter; left time: 4771.8730s
	iters: 300, epoch: 4 | loss: 4.4391303
	speed: 0.1358s/iter; left time: 4818.9517s
Epoch: 4 cost time: 50.44159436225891
Epoch: 4, Steps: 369 | Train Loss: 2.446 Vali Loss: 3.194 Vali Acc: 0.651 Test Loss: 3.194 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.3273797
	speed: 0.5129s/iter; left time: 18117.9317s
	iters: 200, epoch: 5 | loss: 1.6438322
	speed: 0.1345s/iter; left time: 4737.2831s
	iters: 300, epoch: 5 | loss: 2.1087027
	speed: 0.1348s/iter; left time: 4735.2832s
Epoch: 5 cost time: 50.50313878059387
Epoch: 5, Steps: 369 | Train Loss: 2.445 Vali Loss: 3.457 Vali Acc: 0.654 Test Loss: 3.457 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.5789099
	speed: 0.4730s/iter; left time: 16535.6444s
	iters: 200, epoch: 6 | loss: 5.5408449
	speed: 0.1122s/iter; left time: 3909.1570s
	iters: 300, epoch: 6 | loss: 1.9149724
	speed: 0.1079s/iter; left time: 3749.6471s
Epoch: 6 cost time: 41.58325695991516
Epoch: 6, Steps: 369 | Train Loss: 2.262 Vali Loss: 3.193 Vali Acc: 0.632 Test Loss: 3.193 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.2177343
	speed: 0.4513s/iter; left time: 15607.9621s
	iters: 200, epoch: 7 | loss: 2.1925831
	speed: 0.1373s/iter; left time: 4733.4459s
	iters: 300, epoch: 7 | loss: 4.2093768
	speed: 0.1348s/iter; left time: 4634.0582s
Epoch: 7 cost time: 49.657236099243164
Epoch: 7, Steps: 369 | Train Loss: 1.768 Vali Loss: 4.416 Vali Acc: 0.640 Test Loss: 4.416 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3971374
	speed: 0.5206s/iter; left time: 17814.0116s
	iters: 200, epoch: 8 | loss: 0.8405237
	speed: 0.1341s/iter; left time: 4574.3533s
	iters: 300, epoch: 8 | loss: 0.9731422
	speed: 0.1335s/iter; left time: 4540.0492s
Epoch: 8 cost time: 50.09400177001953
Epoch: 8, Steps: 369 | Train Loss: 1.527 Vali Loss: 4.833 Vali Acc: 0.645 Test Loss: 4.833 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.0204351
	speed: 0.4868s/iter; left time: 16477.0115s
	iters: 200, epoch: 9 | loss: 0.4302907
	speed: 0.1138s/iter; left time: 3840.5522s
	iters: 300, epoch: 9 | loss: 1.9095918
	speed: 0.1119s/iter; left time: 3766.4232s
Epoch: 9 cost time: 42.44117283821106
Epoch: 9, Steps: 369 | Train Loss: 1.075 Vali Loss: 4.059 Vali Acc: 0.649 Test Loss: 4.059 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0107294
	speed: 0.4499s/iter; left time: 15063.1010s
	iters: 200, epoch: 10 | loss: 0.0074937
	speed: 0.1375s/iter; left time: 4590.9407s
	iters: 300, epoch: 10 | loss: 0.5549625
	speed: 0.1387s/iter; left time: 4614.5283s
Epoch: 10 cost time: 49.38802194595337
Epoch: 10, Steps: 369 | Train Loss: 0.661 Vali Loss: 3.388 Vali Acc: 0.631 Test Loss: 3.388 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.3821600
	speed: 0.5204s/iter; left time: 17230.0464s
	iters: 200, epoch: 11 | loss: 0.4650794
	speed: 0.1365s/iter; left time: 4506.2239s
	iters: 300, epoch: 11 | loss: 0.1003493
	speed: 0.1373s/iter; left time: 4517.1746s
Epoch: 11 cost time: 51.28422570228577
Epoch: 11, Steps: 369 | Train Loss: 0.446 Vali Loss: 2.808 Vali Acc: 0.631 Test Loss: 2.808 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6705448354143019
model parameter : 352706
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9977334
	speed: 0.1347s/iter; left time: 4958.0479s
	iters: 200, epoch: 1 | loss: 2.0645916
	speed: 0.1079s/iter; left time: 3959.3109s
	iters: 300, epoch: 1 | loss: 1.3504515
	speed: 0.1087s/iter; left time: 3978.1291s
Epoch: 1 cost time: 42.84512519836426
Epoch: 1, Steps: 369 | Train Loss: 1.111 Vali Loss: 0.982 Vali Acc: 0.634 Test Loss: 0.982 Test Acc: 0.634
Validation loss decreased (inf --> -0.633929).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2047822
	speed: 0.4181s/iter; left time: 15233.6537s
	iters: 200, epoch: 2 | loss: 0.5109397
	speed: 0.1078s/iter; left time: 3916.9725s
	iters: 300, epoch: 2 | loss: 2.9057946
	speed: 0.1104s/iter; left time: 4001.3941s
Epoch: 2 cost time: 41.33176398277283
Epoch: 2, Steps: 369 | Train Loss: 1.533 Vali Loss: 1.216 Vali Acc: 0.654 Test Loss: 1.216 Test Acc: 0.654
Validation loss decreased (-0.633929 --> -0.653790).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3922017
	speed: 0.3744s/iter; left time: 13503.4643s
	iters: 200, epoch: 3 | loss: 2.3467445
	speed: 0.0915s/iter; left time: 3289.9412s
	iters: 300, epoch: 3 | loss: 6.8678441
	speed: 0.0956s/iter; left time: 3427.4259s
Epoch: 3 cost time: 35.136106729507446
Epoch: 3, Steps: 369 | Train Loss: 1.996 Vali Loss: 2.244 Vali Acc: 0.644 Test Loss: 2.244 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9068161
	speed: 0.3614s/iter; left time: 12899.2188s
	iters: 200, epoch: 4 | loss: 0.8531960
	speed: 0.0956s/iter; left time: 3402.4267s
	iters: 300, epoch: 4 | loss: 1.9111542
	speed: 0.0927s/iter; left time: 3291.9430s
Epoch: 4 cost time: 35.807071924209595
Epoch: 4, Steps: 369 | Train Loss: 2.035 Vali Loss: 5.036 Vali Acc: 0.575 Test Loss: 5.036 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0058231
	speed: 0.4045s/iter; left time: 14287.4724s
	iters: 200, epoch: 5 | loss: 1.2535541
	speed: 0.1128s/iter; left time: 3973.8652s
	iters: 300, epoch: 5 | loss: 2.2556612
	speed: 0.1116s/iter; left time: 3918.8674s
Epoch: 5 cost time: 42.65028738975525
Epoch: 5, Steps: 369 | Train Loss: 2.173 Vali Loss: 3.904 Vali Acc: 0.629 Test Loss: 3.904 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0260520
	speed: 0.4182s/iter; left time: 14620.1353s
	iters: 200, epoch: 6 | loss: 2.9627984
	speed: 0.1131s/iter; left time: 3942.8237s
	iters: 300, epoch: 6 | loss: 1.7164944
	speed: 0.1128s/iter; left time: 3918.7821s
Epoch: 6 cost time: 41.79968738555908
Epoch: 6, Steps: 369 | Train Loss: 1.870 Vali Loss: 2.978 Vali Acc: 0.636 Test Loss: 2.978 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1888537
	speed: 0.3631s/iter; left time: 12559.8809s
	iters: 200, epoch: 7 | loss: 1.4981438
	speed: 0.0908s/iter; left time: 3129.7960s
	iters: 300, epoch: 7 | loss: 0.5040799
	speed: 0.0895s/iter; left time: 3076.8413s
Epoch: 7 cost time: 34.61994695663452
Epoch: 7, Steps: 369 | Train Loss: 1.579 Vali Loss: 3.339 Vali Acc: 0.622 Test Loss: 3.339 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.5049999
	speed: 0.3731s/iter; left time: 12767.7996s
	iters: 200, epoch: 8 | loss: 1.5339783
	speed: 0.1040s/iter; left time: 3548.6582s
	iters: 300, epoch: 8 | loss: 2.2779291
	speed: 0.1103s/iter; left time: 3753.3751s
Epoch: 8 cost time: 38.93470048904419
Epoch: 8, Steps: 369 | Train Loss: 1.306 Vali Loss: 3.838 Vali Acc: 0.652 Test Loss: 3.838 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.9041635
	speed: 0.4134s/iter; left time: 13993.1862s
	iters: 200, epoch: 9 | loss: 1.7845913
	speed: 0.1133s/iter; left time: 3822.1903s
	iters: 300, epoch: 9 | loss: 1.3577249
	speed: 0.1078s/iter; left time: 3627.3688s
Epoch: 9 cost time: 41.33732485771179
Epoch: 9, Steps: 369 | Train Loss: 0.939 Vali Loss: 3.939 Vali Acc: 0.639 Test Loss: 3.939 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6041723
	speed: 0.4051s/iter; left time: 13562.9406s
	iters: 200, epoch: 10 | loss: 0.0546543
	speed: 0.0876s/iter; left time: 2924.2208s
	iters: 300, epoch: 10 | loss: 0.4927397
	speed: 0.0945s/iter; left time: 3144.0501s
Epoch: 10 cost time: 36.69383263587952
Epoch: 10, Steps: 369 | Train Loss: 0.712 Vali Loss: 2.910 Vali Acc: 0.658 Test Loss: 2.910 Test Acc: 0.658
Validation loss decreased (-0.653790 --> -0.658314).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0038446
	speed: 0.3541s/iter; left time: 11725.3429s
	iters: 200, epoch: 11 | loss: 0.2394291
	speed: 0.0874s/iter; left time: 2884.4311s
	iters: 300, epoch: 11 | loss: 0.5149674
	speed: 0.0868s/iter; left time: 2855.3889s
Epoch: 11 cost time: 33.33117628097534
Epoch: 11, Steps: 369 | Train Loss: 0.444 Vali Loss: 2.575 Vali Acc: 0.646 Test Loss: 2.575 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0639329
	speed: 0.3759s/iter; left time: 12307.6310s
	iters: 200, epoch: 12 | loss: 0.1312573
	speed: 0.1096s/iter; left time: 3577.7391s
	iters: 300, epoch: 12 | loss: 0.1708656
	speed: 0.1106s/iter; left time: 3599.1256s
Epoch: 12 cost time: 41.69470930099487
Epoch: 12, Steps: 369 | Train Loss: 0.304 Vali Loss: 2.493 Vali Acc: 0.631 Test Loss: 2.493 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1845131
	speed: 0.4017s/iter; left time: 13004.6708s
	iters: 200, epoch: 13 | loss: 0.1123655
	speed: 0.1136s/iter; left time: 3667.4143s
	iters: 300, epoch: 13 | loss: 0.0581765
	speed: 0.1129s/iter; left time: 3633.3652s
Epoch: 13 cost time: 42.54202485084534
Epoch: 13, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.976 Vali Acc: 0.652 Test Loss: 1.976 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2084849
	speed: 0.3861s/iter; left time: 12356.3564s
	iters: 200, epoch: 14 | loss: 0.0053430
	speed: 0.0843s/iter; left time: 2691.0402s
	iters: 300, epoch: 14 | loss: 0.4011083
	speed: 0.0830s/iter; left time: 2639.3135s
Epoch: 14 cost time: 32.59435510635376
Epoch: 14, Steps: 369 | Train Loss: 0.131 Vali Loss: 2.076 Vali Acc: 0.624 Test Loss: 2.076 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0347650
	speed: 0.3465s/iter; left time: 10960.0932s
	iters: 200, epoch: 15 | loss: 0.1012912
	speed: 0.0865s/iter; left time: 2729.1078s
	iters: 300, epoch: 15 | loss: 0.0668376
	speed: 0.0828s/iter; left time: 2601.6031s
Epoch: 15 cost time: 32.27087211608887
Epoch: 15, Steps: 369 | Train Loss: 0.113 Vali Loss: 2.000 Vali Acc: 0.648 Test Loss: 2.000 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0053241
	speed: 0.3705s/iter; left time: 11582.5441s
	iters: 200, epoch: 16 | loss: 0.1351293
	speed: 0.1099s/iter; left time: 3426.5771s
	iters: 300, epoch: 16 | loss: 0.0827897
	speed: 0.1084s/iter; left time: 3369.0477s
Epoch: 16 cost time: 41.65130639076233
Epoch: 16, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.949 Vali Acc: 0.652 Test Loss: 1.949 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0008741
	speed: 0.4045s/iter; left time: 12499.2114s
	iters: 200, epoch: 17 | loss: 0.0873639
	speed: 0.1112s/iter; left time: 3423.7858s
	iters: 300, epoch: 17 | loss: 0.3587483
	speed: 0.1113s/iter; left time: 3417.0822s
Epoch: 17 cost time: 42.18999242782593
Epoch: 17, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.023 Vali Acc: 0.657 Test Loss: 2.023 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0123607
	speed: 0.3800s/iter; left time: 11601.1591s
	iters: 200, epoch: 18 | loss: 0.0197944
	speed: 0.0870s/iter; left time: 2648.5354s
	iters: 300, epoch: 18 | loss: 0.1589262
	speed: 0.0863s/iter; left time: 2617.9600s
Epoch: 18 cost time: 32.62922787666321
Epoch: 18, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.179 Vali Acc: 0.647 Test Loss: 2.179 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0043615
	speed: 0.3371s/iter; left time: 10165.8029s
	iters: 200, epoch: 19 | loss: 0.1407029
	speed: 0.0880s/iter; left time: 2646.3567s
	iters: 300, epoch: 19 | loss: 0.3841527
	speed: 0.0880s/iter; left time: 2635.1826s
Epoch: 19 cost time: 33.12069487571716
Epoch: 19, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.152 Vali Acc: 0.650 Test Loss: 2.152 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0069407
	speed: 0.3834s/iter; left time: 11420.2673s
	iters: 200, epoch: 20 | loss: 0.0028681
	speed: 0.1096s/iter; left time: 3254.3302s
	iters: 300, epoch: 20 | loss: 0.0318854
	speed: 0.1131s/iter; left time: 3347.0373s
Epoch: 20 cost time: 42.069525480270386
Epoch: 20, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.226 Vali Acc: 0.650 Test Loss: 2.226 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6583427922814983
model parameter : 297602
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4604256
	speed: 0.1011s/iter; left time: 3720.3636s
	iters: 200, epoch: 1 | loss: 1.4497112
	speed: 0.0736s/iter; left time: 2701.7986s
	iters: 300, epoch: 1 | loss: 1.0853317
	speed: 0.0742s/iter; left time: 2717.4480s
Epoch: 1 cost time: 30.33716320991516
Epoch: 1, Steps: 369 | Train Loss: 0.993 Vali Loss: 0.852 Vali Acc: 0.663 Test Loss: 0.852 Test Acc: 0.663
Validation loss decreased (inf --> -0.663442).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1001151
	speed: 0.2974s/iter; left time: 10834.6226s
	iters: 200, epoch: 2 | loss: 2.7225003
	speed: 0.0754s/iter; left time: 2739.7588s
	iters: 300, epoch: 2 | loss: 0.6072370
	speed: 0.0728s/iter; left time: 2638.8400s
Epoch: 2 cost time: 28.391958951950073
Epoch: 2, Steps: 369 | Train Loss: 1.328 Vali Loss: 1.339 Vali Acc: 0.645 Test Loss: 1.339 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.9665031
	speed: 0.3116s/iter; left time: 11235.4447s
	iters: 200, epoch: 3 | loss: 1.7131774
	speed: 0.0972s/iter; left time: 3494.7790s
	iters: 300, epoch: 3 | loss: 3.6145637
	speed: 0.0973s/iter; left time: 3488.2932s
Epoch: 3 cost time: 35.192667961120605
Epoch: 3, Steps: 369 | Train Loss: 1.637 Vali Loss: 2.228 Vali Acc: 0.648 Test Loss: 2.228 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4395615
	speed: 0.3699s/iter; left time: 13201.7432s
	iters: 200, epoch: 4 | loss: 2.0933073
	speed: 0.1009s/iter; left time: 3589.8623s
	iters: 300, epoch: 4 | loss: 2.3181746
	speed: 0.0994s/iter; left time: 3526.4031s
Epoch: 4 cost time: 37.56165432929993
Epoch: 4, Steps: 369 | Train Loss: 1.774 Vali Loss: 2.388 Vali Acc: 0.651 Test Loss: 2.388 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.8481181
	speed: 0.3641s/iter; left time: 12863.3107s
	iters: 200, epoch: 5 | loss: 3.4359462
	speed: 0.0888s/iter; left time: 3127.2062s
	iters: 300, epoch: 5 | loss: 0.5923950
	speed: 0.0794s/iter; left time: 2789.0302s
Epoch: 5 cost time: 32.52952861785889
Epoch: 5, Steps: 369 | Train Loss: 1.776 Vali Loss: 3.202 Vali Acc: 0.641 Test Loss: 3.202 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.0869486
	speed: 0.3095s/iter; left time: 10819.5412s
	iters: 200, epoch: 6 | loss: 0.6608759
	speed: 0.0727s/iter; left time: 2535.3539s
	iters: 300, epoch: 6 | loss: 1.9018524
	speed: 0.0773s/iter; left time: 2686.3019s
Epoch: 6 cost time: 29.4088397026062
Epoch: 6, Steps: 369 | Train Loss: 1.609 Vali Loss: 3.631 Vali Acc: 0.627 Test Loss: 3.631 Test Acc: 0.627
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7638288
	speed: 0.3269s/iter; left time: 11306.1050s
	iters: 200, epoch: 7 | loss: 1.0252382
	speed: 0.0801s/iter; left time: 2761.8867s
	iters: 300, epoch: 7 | loss: 2.6350584
	speed: 0.1024s/iter; left time: 3522.5001s
Epoch: 7 cost time: 34.17637515068054
Epoch: 7, Steps: 369 | Train Loss: 1.351 Vali Loss: 4.017 Vali Acc: 0.642 Test Loss: 4.017 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.9622060
	speed: 0.3807s/iter; left time: 13028.0543s
	iters: 200, epoch: 8 | loss: 2.6645577
	speed: 0.1010s/iter; left time: 3447.6132s
	iters: 300, epoch: 8 | loss: 1.1338696
	speed: 0.0998s/iter; left time: 3395.4051s
Epoch: 8 cost time: 38.01866126060486
Epoch: 8, Steps: 369 | Train Loss: 1.091 Vali Loss: 3.713 Vali Acc: 0.638 Test Loss: 3.713 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6455072
	speed: 0.3778s/iter; left time: 12788.8884s
	iters: 200, epoch: 9 | loss: 0.0760204
	speed: 0.1003s/iter; left time: 3385.8237s
	iters: 300, epoch: 9 | loss: 0.6598316
	speed: 0.0806s/iter; left time: 2711.5952s
Epoch: 9 cost time: 33.92058348655701
Epoch: 9, Steps: 369 | Train Loss: 0.797 Vali Loss: 3.402 Vali Acc: 0.647 Test Loss: 3.402 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.1581979
	speed: 0.3275s/iter; left time: 10966.3106s
	iters: 200, epoch: 10 | loss: 0.4499207
	speed: 0.0750s/iter; left time: 2504.9095s
	iters: 300, epoch: 10 | loss: 0.2415533
	speed: 0.0728s/iter; left time: 2421.1635s
Epoch: 10 cost time: 28.64442205429077
Epoch: 10, Steps: 369 | Train Loss: 0.586 Vali Loss: 3.065 Vali Acc: 0.626 Test Loss: 3.065 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0265960
	speed: 0.3283s/iter; left time: 10871.1279s
	iters: 200, epoch: 11 | loss: 0.4077105
	speed: 0.0783s/iter; left time: 2586.1206s
	iters: 300, epoch: 11 | loss: 0.9828111
	speed: 0.0779s/iter; left time: 2564.0736s
Epoch: 11 cost time: 31.949965953826904
Epoch: 11, Steps: 369 | Train Loss: 0.405 Vali Loss: 2.626 Vali Acc: 0.642 Test Loss: 2.626 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6634506242905789
model parameter : 242498
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2299998
	speed: 0.1100s/iter; left time: 4048.1435s
	iters: 200, epoch: 1 | loss: 0.6083845
	speed: 0.0818s/iter; left time: 3003.7480s
	iters: 300, epoch: 1 | loss: 1.4168774
	speed: 0.0822s/iter; left time: 3009.6463s
Epoch: 1 cost time: 33.05181813240051
Epoch: 1, Steps: 369 | Train Loss: 0.919 Vali Loss: 0.765 Vali Acc: 0.671 Test Loss: 0.765 Test Acc: 0.671
Validation loss decreased (inf --> -0.671105).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6484078
	speed: 0.2777s/iter; left time: 10118.6426s
	iters: 200, epoch: 2 | loss: 0.7648357
	speed: 0.0645s/iter; left time: 2342.0118s
	iters: 300, epoch: 2 | loss: 1.2538927
	speed: 0.0644s/iter; left time: 2332.7850s
Epoch: 2 cost time: 23.772919416427612
Epoch: 2, Steps: 369 | Train Loss: 1.157 Vali Loss: 1.247 Vali Acc: 0.669 Test Loss: 1.247 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6529781
	speed: 0.2668s/iter; left time: 9621.9290s
	iters: 200, epoch: 3 | loss: 1.6096393
	speed: 0.0638s/iter; left time: 2295.9016s
	iters: 300, epoch: 3 | loss: 2.8564680
	speed: 0.0649s/iter; left time: 2326.6680s
Epoch: 3 cost time: 25.06555724143982
Epoch: 3, Steps: 369 | Train Loss: 1.467 Vali Loss: 1.491 Vali Acc: 0.648 Test Loss: 1.491 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7186413
	speed: 0.2995s/iter; left time: 10690.6786s
	iters: 200, epoch: 4 | loss: 1.9074452
	speed: 0.0852s/iter; left time: 3033.7288s
	iters: 300, epoch: 4 | loss: 1.5906923
	speed: 0.0838s/iter; left time: 2973.3906s
Epoch: 4 cost time: 32.08318018913269
Epoch: 4, Steps: 369 | Train Loss: 1.513 Vali Loss: 1.992 Vali Acc: 0.656 Test Loss: 1.992 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.9348919
	speed: 0.3345s/iter; left time: 11817.3898s
	iters: 200, epoch: 5 | loss: 1.0551723
	speed: 0.0829s/iter; left time: 2920.5088s
	iters: 300, epoch: 5 | loss: 1.6318164
	speed: 0.0820s/iter; left time: 2878.7683s
Epoch: 5 cost time: 31.79070782661438
Epoch: 5, Steps: 369 | Train Loss: 1.509 Vali Loss: 2.934 Vali Acc: 0.652 Test Loss: 2.934 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4608989
	speed: 0.3377s/iter; left time: 11803.3974s
	iters: 200, epoch: 6 | loss: 0.7815454
	speed: 0.0640s/iter; left time: 2230.3396s
	iters: 300, epoch: 6 | loss: 0.8950557
	speed: 0.0630s/iter; left time: 2190.8942s
Epoch: 6 cost time: 26.238990545272827
Epoch: 6, Steps: 369 | Train Loss: 1.337 Vali Loss: 3.194 Vali Acc: 0.652 Test Loss: 3.194 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8292858
	speed: 0.2717s/iter; left time: 9397.7011s
	iters: 200, epoch: 7 | loss: 2.6018085
	speed: 0.0607s/iter; left time: 2091.8846s
	iters: 300, epoch: 7 | loss: 2.2706730
	speed: 0.0613s/iter; left time: 2106.5432s
Epoch: 7 cost time: 23.90005135536194
Epoch: 7, Steps: 369 | Train Loss: 1.169 Vali Loss: 3.653 Vali Acc: 0.631 Test Loss: 3.653 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6596664
	speed: 0.2811s/iter; left time: 9619.3415s
	iters: 200, epoch: 8 | loss: 0.0401891
	speed: 0.0636s/iter; left time: 2170.3975s
	iters: 300, epoch: 8 | loss: 0.6407409
	speed: 0.0595s/iter; left time: 2023.8468s
Epoch: 8 cost time: 24.631347179412842
Epoch: 8, Steps: 369 | Train Loss: 0.913 Vali Loss: 3.307 Vali Acc: 0.636 Test Loss: 3.307 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.2991100
	speed: 0.3190s/iter; left time: 10797.3874s
	iters: 200, epoch: 9 | loss: 0.0077025
	speed: 0.0822s/iter; left time: 2774.7057s
	iters: 300, epoch: 9 | loss: 0.4019637
	speed: 0.0820s/iter; left time: 2759.3362s
Epoch: 9 cost time: 31.35254955291748
Epoch: 9, Steps: 369 | Train Loss: 0.674 Vali Loss: 3.596 Vali Acc: 0.622 Test Loss: 3.596 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0551064
	speed: 0.3429s/iter; left time: 11478.7061s
	iters: 200, epoch: 10 | loss: 0.0004887
	speed: 0.0823s/iter; left time: 2748.5455s
	iters: 300, epoch: 10 | loss: 1.8962519
	speed: 0.0839s/iter; left time: 2792.0884s
Epoch: 10 cost time: 31.774598121643066
Epoch: 10, Steps: 369 | Train Loss: 0.516 Vali Loss: 2.892 Vali Acc: 0.635 Test Loss: 2.892 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0994980
	speed: 0.3071s/iter; left time: 10167.6287s
	iters: 200, epoch: 11 | loss: 0.3243101
	speed: 0.0644s/iter; left time: 2126.3110s
	iters: 300, epoch: 11 | loss: 1.4224555
	speed: 0.0652s/iter; left time: 2144.8753s
Epoch: 11 cost time: 24.440893173217773
Epoch: 11, Steps: 369 | Train Loss: 0.431 Vali Loss: 2.912 Vali Acc: 0.638 Test Loss: 2.912 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 205826
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 5.7650938
	speed: 0.2722s/iter; left time: 10018.0306s
	iters: 200, epoch: 1 | loss: 2.0856144
	speed: 0.2523s/iter; left time: 9259.1252s
	iters: 300, epoch: 1 | loss: 0.5452705
	speed: 0.2492s/iter; left time: 9119.7828s
Epoch: 1 cost time: 94.80613541603088
Epoch: 1, Steps: 369 | Train Loss: 1.721 Vali Loss: 1.377 Vali Acc: 0.644 Test Loss: 1.377 Test Acc: 0.644
Validation loss decreased (inf --> -0.644141).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2079380
	speed: 0.8470s/iter; left time: 30858.8775s
	iters: 200, epoch: 2 | loss: 3.7865543
	speed: 0.2190s/iter; left time: 7958.1250s
	iters: 300, epoch: 2 | loss: 2.7974966
	speed: 0.2183s/iter; left time: 7911.0438s
Epoch: 2 cost time: 81.93422389030457
Epoch: 2, Steps: 369 | Train Loss: 2.367 Vali Loss: 1.974 Vali Acc: 0.656 Test Loss: 1.974 Test Acc: 0.656
Validation loss decreased (-0.644141 --> -0.656337).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2716715
	speed: 0.7456s/iter; left time: 26889.9387s
	iters: 200, epoch: 3 | loss: 3.5172656
	speed: 0.2269s/iter; left time: 8160.5710s
	iters: 300, epoch: 3 | loss: 2.1899958
	speed: 0.2292s/iter; left time: 8219.8328s
Epoch: 3 cost time: 85.23427820205688
Epoch: 3, Steps: 369 | Train Loss: 3.136 Vali Loss: 2.298 Vali Acc: 0.661 Test Loss: 2.298 Test Acc: 0.661
Validation loss decreased (-0.656337 --> -0.660590).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0683277
	speed: 0.8157s/iter; left time: 29116.8123s
	iters: 200, epoch: 4 | loss: 0.9216008
	speed: 0.2178s/iter; left time: 7752.3724s
	iters: 300, epoch: 4 | loss: 1.9588492
	speed: 0.2107s/iter; left time: 7476.8891s
Epoch: 4 cost time: 82.65772438049316
Epoch: 4, Steps: 369 | Train Loss: 3.101 Vali Loss: 4.972 Vali Acc: 0.651 Test Loss: 4.972 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5135014
	speed: 0.7326s/iter; left time: 25880.3691s
	iters: 200, epoch: 5 | loss: 0.1932668
	speed: 0.2405s/iter; left time: 8471.7185s
	iters: 300, epoch: 5 | loss: 1.4359469
	speed: 0.2428s/iter; left time: 8527.0624s
Epoch: 5 cost time: 87.17843556404114
Epoch: 5, Steps: 369 | Train Loss: 2.708 Vali Loss: 5.237 Vali Acc: 0.626 Test Loss: 5.237 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5761151
	speed: 0.8516s/iter; left time: 29769.3766s
	iters: 200, epoch: 6 | loss: 0.0000057
	speed: 0.2459s/iter; left time: 8571.3857s
	iters: 300, epoch: 6 | loss: 2.3568180
	speed: 0.2112s/iter; left time: 7340.0428s
Epoch: 6 cost time: 85.67674660682678
Epoch: 6, Steps: 369 | Train Loss: 1.799 Vali Loss: 4.355 Vali Acc: 0.628 Test Loss: 4.355 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2482129
	speed: 0.7195s/iter; left time: 24884.5152s
	iters: 200, epoch: 7 | loss: 1.6428524
	speed: 0.1996s/iter; left time: 6883.6956s
	iters: 300, epoch: 7 | loss: 1.4657487
	speed: 0.1802s/iter; left time: 6195.5591s
Epoch: 7 cost time: 74.71985077857971
Epoch: 7, Steps: 369 | Train Loss: 1.100 Vali Loss: 3.123 Vali Acc: 0.629 Test Loss: 3.123 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.2666582
	speed: 0.6712s/iter; left time: 22968.4584s
	iters: 200, epoch: 8 | loss: 0.1154524
	speed: 0.1683s/iter; left time: 5742.1074s
	iters: 300, epoch: 8 | loss: 1.3207023
	speed: 0.1566s/iter; left time: 5325.5932s
Epoch: 8 cost time: 61.43116641044617
Epoch: 8, Steps: 369 | Train Loss: 0.575 Vali Loss: 3.311 Vali Acc: 0.622 Test Loss: 3.311 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2806395
	speed: 0.6692s/iter; left time: 22653.4117s
	iters: 200, epoch: 9 | loss: 0.0582314
	speed: 0.2308s/iter; left time: 7789.0862s
	iters: 300, epoch: 9 | loss: 0.0087754
	speed: 0.2408s/iter; left time: 8101.9238s
Epoch: 9 cost time: 88.54094505310059
Epoch: 9, Steps: 369 | Train Loss: 0.297 Vali Loss: 3.511 Vali Acc: 0.623 Test Loss: 3.511 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0122356
	speed: 0.8617s/iter; left time: 28850.6705s
	iters: 200, epoch: 10 | loss: 0.0552104
	speed: 0.2206s/iter; left time: 7362.4986s
	iters: 300, epoch: 10 | loss: 0.7753892
	speed: 0.2184s/iter; left time: 7267.1330s
Epoch: 10 cost time: 84.66245412826538
Epoch: 10, Steps: 369 | Train Loss: 0.187 Vali Loss: 2.448 Vali Acc: 0.633 Test Loss: 2.448 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0587521
	speed: 0.7801s/iter; left time: 25830.0063s
	iters: 200, epoch: 11 | loss: 0.2891729
	speed: 0.2341s/iter; left time: 7727.8361s
	iters: 300, epoch: 11 | loss: 0.0363085
	speed: 0.2375s/iter; left time: 7815.9450s
Epoch: 11 cost time: 87.82884740829468
Epoch: 11, Steps: 369 | Train Loss: 0.110 Vali Loss: 2.255 Vali Acc: 0.626 Test Loss: 2.255 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0232203
	speed: 0.8387s/iter; left time: 27461.5870s
	iters: 200, epoch: 12 | loss: 0.0230514
	speed: 0.2290s/iter; left time: 7474.4907s
	iters: 300, epoch: 12 | loss: 0.1007743
	speed: 0.2065s/iter; left time: 6719.8686s
Epoch: 12 cost time: 82.30514812469482
Epoch: 12, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.261 Vali Acc: 0.635 Test Loss: 2.261 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0070944
	speed: 0.7476s/iter; left time: 24201.4079s
	iters: 200, epoch: 13 | loss: 0.0932118
	speed: 0.2309s/iter; left time: 7451.7186s
	iters: 300, epoch: 13 | loss: 0.0027950
	speed: 0.2470s/iter; left time: 7946.2994s
Epoch: 13 cost time: 87.0200891494751
Epoch: 13, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.325 Vali Acc: 0.630 Test Loss: 2.325 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6606129398410897
model parameter : 634594
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9323936
	speed: 0.1180s/iter; left time: 4342.7096s
	iters: 200, epoch: 1 | loss: 2.6744213
	speed: 0.0892s/iter; left time: 3274.1560s
	iters: 300, epoch: 1 | loss: 1.0857439
	speed: 0.0986s/iter; left time: 3609.1887s
Epoch: 1 cost time: 37.535919427871704
Epoch: 1, Steps: 369 | Train Loss: 1.230 Vali Loss: 1.153 Vali Acc: 0.652 Test Loss: 1.153 Test Acc: 0.652
Validation loss decreased (inf --> -0.652088).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3600647
	speed: 0.4192s/iter; left time: 15272.6497s
	iters: 200, epoch: 2 | loss: 1.1508749
	speed: 0.1168s/iter; left time: 4242.0784s
	iters: 300, epoch: 2 | loss: 0.5658711
	speed: 0.1148s/iter; left time: 4158.9522s
Epoch: 2 cost time: 43.06531476974487
Epoch: 2, Steps: 369 | Train Loss: 1.647 Vali Loss: 1.927 Vali Acc: 0.640 Test Loss: 1.927 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2596848
	speed: 0.4607s/iter; left time: 16614.0127s
	iters: 200, epoch: 3 | loss: 0.8370714
	speed: 0.1143s/iter; left time: 4110.8052s
	iters: 300, epoch: 3 | loss: 2.1479981
	speed: 0.1152s/iter; left time: 4133.1707s
Epoch: 3 cost time: 43.31784462928772
Epoch: 3, Steps: 369 | Train Loss: 2.128 Vali Loss: 1.981 Vali Acc: 0.635 Test Loss: 1.981 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.3664470
	speed: 0.4614s/iter; left time: 16470.4527s
	iters: 200, epoch: 4 | loss: 2.2922831
	speed: 0.1033s/iter; left time: 3676.8441s
	iters: 300, epoch: 4 | loss: 0.6407278
	speed: 0.1016s/iter; left time: 3606.3896s
Epoch: 4 cost time: 40.50713229179382
Epoch: 4, Steps: 369 | Train Loss: 2.147 Vali Loss: 3.108 Vali Acc: 0.612 Test Loss: 3.108 Test Acc: 0.612
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.1308925
	speed: 0.4173s/iter; left time: 14742.7105s
	iters: 200, epoch: 5 | loss: 1.3592343
	speed: 0.1052s/iter; left time: 3707.0528s
	iters: 300, epoch: 5 | loss: 4.5654941
	speed: 0.1054s/iter; left time: 3703.5352s
Epoch: 5 cost time: 38.91574239730835
Epoch: 5, Steps: 369 | Train Loss: 1.986 Vali Loss: 3.035 Vali Acc: 0.630 Test Loss: 3.035 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6724981
	speed: 0.4392s/iter; left time: 15352.1088s
	iters: 200, epoch: 6 | loss: 0.2884855
	speed: 0.1172s/iter; left time: 4084.8719s
	iters: 300, epoch: 6 | loss: 2.4470174
	speed: 0.1189s/iter; left time: 4130.9892s
Epoch: 6 cost time: 44.42778253555298
Epoch: 6, Steps: 369 | Train Loss: 1.359 Vali Loss: 2.735 Vali Acc: 0.661 Test Loss: 2.735 Test Acc: 0.661
Validation loss decreased (-0.652088 --> -0.660869).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3357739
	speed: 0.4697s/iter; left time: 16245.1208s
	iters: 200, epoch: 7 | loss: 0.5606260
	speed: 0.1182s/iter; left time: 4074.8761s
	iters: 300, epoch: 7 | loss: 0.0565642
	speed: 0.1184s/iter; left time: 4072.8651s
Epoch: 7 cost time: 44.58251929283142
Epoch: 7, Steps: 369 | Train Loss: 0.908 Vali Loss: 2.554 Vali Acc: 0.635 Test Loss: 2.554 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5201240
	speed: 0.4500s/iter; left time: 15398.3590s
	iters: 200, epoch: 8 | loss: 0.9010083
	speed: 0.0993s/iter; left time: 3386.3311s
	iters: 300, epoch: 8 | loss: 0.9174368
	speed: 0.0978s/iter; left time: 3327.8705s
Epoch: 8 cost time: 37.07618761062622
Epoch: 8, Steps: 369 | Train Loss: 0.485 Vali Loss: 1.990 Vali Acc: 0.638 Test Loss: 1.990 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2077068
	speed: 0.4143s/iter; left time: 14022.3924s
	iters: 200, epoch: 9 | loss: 0.4186416
	speed: 0.0986s/iter; left time: 3328.7018s
	iters: 300, epoch: 9 | loss: 0.2754822
	speed: 0.0955s/iter; left time: 3213.8723s
Epoch: 9 cost time: 37.70835518836975
Epoch: 9, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.414 Vali Acc: 0.634 Test Loss: 1.414 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0793159
	speed: 0.4449s/iter; left time: 14896.6399s
	iters: 200, epoch: 10 | loss: 0.0758014
	speed: 0.1144s/iter; left time: 3818.3676s
	iters: 300, epoch: 10 | loss: 0.4119895
	speed: 0.1152s/iter; left time: 3833.0318s
Epoch: 10 cost time: 43.179014682769775
Epoch: 10, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.583 Vali Acc: 0.652 Test Loss: 1.583 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2167412
	speed: 0.4643s/iter; left time: 15374.7356s
	iters: 200, epoch: 11 | loss: 0.0087676
	speed: 0.1162s/iter; left time: 3835.8193s
	iters: 300, epoch: 11 | loss: 0.0860071
	speed: 0.1175s/iter; left time: 3868.1311s
Epoch: 11 cost time: 44.11795902252197
Epoch: 11, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.637 Vali Acc: 0.643 Test Loss: 1.637 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0217697
	speed: 0.4368s/iter; left time: 14301.8574s
	iters: 200, epoch: 12 | loss: 0.2457215
	speed: 0.1059s/iter; left time: 3455.3195s
	iters: 300, epoch: 12 | loss: 0.0300285
	speed: 0.1029s/iter; left time: 3347.1701s
Epoch: 12 cost time: 39.209959745407104
Epoch: 12, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.800 Vali Acc: 0.635 Test Loss: 1.800 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0013904
	speed: 0.4084s/iter; left time: 13220.8624s
	iters: 200, epoch: 13 | loss: 0.1957782
	speed: 0.0998s/iter; left time: 3221.1577s
	iters: 300, epoch: 13 | loss: 0.1878984
	speed: 0.1020s/iter; left time: 3282.0008s
Epoch: 13 cost time: 39.63247203826904
Epoch: 13, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.019 Vali Acc: 0.642 Test Loss: 2.019 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0328071
	speed: 0.4770s/iter; left time: 15264.6870s
	iters: 200, epoch: 14 | loss: 0.0035890
	speed: 0.1179s/iter; left time: 3762.0574s
	iters: 300, epoch: 14 | loss: 0.1319029
	speed: 0.1189s/iter; left time: 3781.6992s
Epoch: 14 cost time: 44.90780782699585
Epoch: 14, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.136 Vali Acc: 0.639 Test Loss: 2.136 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0159338
	speed: 0.4912s/iter; left time: 15539.3956s
	iters: 200, epoch: 15 | loss: 0.1680890
	speed: 0.1200s/iter; left time: 3782.8073s
	iters: 300, epoch: 15 | loss: 0.2019749
	speed: 0.1090s/iter; left time: 3427.1480s
Epoch: 15 cost time: 43.022228956222534
Epoch: 15, Steps: 369 | Train Loss: 0.068 Vali Loss: 1.813 Vali Acc: 0.632 Test Loss: 1.813 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0014433
	speed: 0.4139s/iter; left time: 12939.9010s
	iters: 200, epoch: 16 | loss: 0.0137953
	speed: 0.0928s/iter; left time: 2891.6468s
	iters: 300, epoch: 16 | loss: 0.0071250
	speed: 0.0960s/iter; left time: 2983.5176s
Epoch: 16 cost time: 36.39581060409546
Epoch: 16, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.138 Vali Acc: 0.625 Test Loss: 2.138 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6608967082860386
model parameter : 348962
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5362223
	speed: 0.1110s/iter; left time: 4083.5418s
	iters: 200, epoch: 1 | loss: 1.3859416
	speed: 0.0865s/iter; left time: 3173.2685s
	iters: 300, epoch: 1 | loss: 0.8075151
	speed: 0.0883s/iter; left time: 3232.4514s
Epoch: 1 cost time: 34.82684516906738
Epoch: 1, Steps: 369 | Train Loss: 1.050 Vali Loss: 0.938 Vali Acc: 0.654 Test Loss: 0.938 Test Acc: 0.654
Validation loss decreased (inf --> -0.653793).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1118248
	speed: 0.3577s/iter; left time: 13032.4138s
	iters: 200, epoch: 2 | loss: 1.4345617
	speed: 0.0906s/iter; left time: 3289.9949s
	iters: 300, epoch: 2 | loss: 2.5818264
	speed: 0.0901s/iter; left time: 3264.4061s
Epoch: 2 cost time: 33.91251730918884
Epoch: 2, Steps: 369 | Train Loss: 1.413 Vali Loss: 1.506 Vali Acc: 0.656 Test Loss: 1.506 Test Acc: 0.656
Validation loss decreased (-0.653793 --> -0.656058).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8913956
	speed: 0.3412s/iter; left time: 12306.0747s
	iters: 200, epoch: 3 | loss: 0.8187038
	speed: 0.0795s/iter; left time: 2860.3362s
	iters: 300, epoch: 3 | loss: 1.2144655
	speed: 0.0756s/iter; left time: 2711.4358s
Epoch: 3 cost time: 29.390572547912598
Epoch: 3, Steps: 369 | Train Loss: 1.662 Vali Loss: 2.113 Vali Acc: 0.657 Test Loss: 2.113 Test Acc: 0.657
Validation loss decreased (-0.656058 --> -0.657187).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2706587
	speed: 0.3085s/iter; left time: 11010.8451s
	iters: 200, epoch: 4 | loss: 0.2340543
	speed: 0.0756s/iter; left time: 2691.0719s
	iters: 300, epoch: 4 | loss: 2.7329612
	speed: 0.0728s/iter; left time: 2584.0430s
Epoch: 4 cost time: 28.671756505966187
Epoch: 4, Steps: 369 | Train Loss: 1.732 Vali Loss: 2.260 Vali Acc: 0.656 Test Loss: 2.260 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1061120
	speed: 0.3385s/iter; left time: 11958.7975s
	iters: 200, epoch: 5 | loss: 2.0342073
	speed: 0.0893s/iter; left time: 3146.2296s
	iters: 300, epoch: 5 | loss: 1.4764827
	speed: 0.0882s/iter; left time: 3097.3927s
Epoch: 5 cost time: 33.5956494808197
Epoch: 5, Steps: 369 | Train Loss: 1.594 Vali Loss: 2.737 Vali Acc: 0.634 Test Loss: 2.737 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8159795
	speed: 0.3592s/iter; left time: 12557.4496s
	iters: 200, epoch: 6 | loss: 1.2824870
	speed: 0.0892s/iter; left time: 3109.4364s
	iters: 300, epoch: 6 | loss: 1.6995233
	speed: 0.0897s/iter; left time: 3116.0286s
Epoch: 6 cost time: 33.65127778053284
Epoch: 6, Steps: 369 | Train Loss: 1.237 Vali Loss: 1.990 Vali Acc: 0.637 Test Loss: 1.990 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9706335
	speed: 0.3605s/iter; left time: 12468.1193s
	iters: 200, epoch: 7 | loss: 0.6116349
	speed: 0.0884s/iter; left time: 3047.3004s
	iters: 300, epoch: 7 | loss: 0.2030672
	speed: 0.0894s/iter; left time: 3073.4973s
Epoch: 7 cost time: 32.86728835105896
Epoch: 7, Steps: 369 | Train Loss: 0.739 Vali Loss: 1.813 Vali Acc: 0.639 Test Loss: 1.813 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.9091232
	speed: 0.3189s/iter; left time: 10912.9915s
	iters: 200, epoch: 8 | loss: 0.0959846
	speed: 0.0746s/iter; left time: 2544.1497s
	iters: 300, epoch: 8 | loss: 0.0607863
	speed: 0.0730s/iter; left time: 2482.6087s
Epoch: 8 cost time: 27.632871866226196
Epoch: 8, Steps: 369 | Train Loss: 0.385 Vali Loss: 1.377 Vali Acc: 0.635 Test Loss: 1.377 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1611997
	speed: 0.3171s/iter; left time: 10733.6522s
	iters: 200, epoch: 9 | loss: 0.0226785
	speed: 0.0745s/iter; left time: 2512.8304s
	iters: 300, epoch: 9 | loss: 0.1232591
	speed: 0.0740s/iter; left time: 2489.9784s
Epoch: 9 cost time: 28.424644470214844
Epoch: 9, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.347 Vali Acc: 0.649 Test Loss: 1.347 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1365428
	speed: 0.3422s/iter; left time: 11457.2206s
	iters: 200, epoch: 10 | loss: 0.0980282
	speed: 0.0886s/iter; left time: 2958.1237s
	iters: 300, epoch: 10 | loss: 0.0223426
	speed: 0.0907s/iter; left time: 3018.3581s
Epoch: 10 cost time: 33.82100200653076
Epoch: 10, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.536 Vali Acc: 0.643 Test Loss: 1.536 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0893209
	speed: 0.3711s/iter; left time: 12287.5033s
	iters: 200, epoch: 11 | loss: 0.1342794
	speed: 0.0913s/iter; left time: 3012.4633s
	iters: 300, epoch: 11 | loss: 0.0159551
	speed: 0.0905s/iter; left time: 2977.2460s
Epoch: 11 cost time: 34.23106932640076
Epoch: 11, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.625 Vali Acc: 0.638 Test Loss: 1.625 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0077338
	speed: 0.3690s/iter; left time: 12080.8269s
	iters: 200, epoch: 12 | loss: 0.0568316
	speed: 0.0848s/iter; left time: 2766.7324s
	iters: 300, epoch: 12 | loss: 0.0918509
	speed: 0.0767s/iter; left time: 2497.0722s
Epoch: 12 cost time: 31.226147174835205
Epoch: 12, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.894 Vali Acc: 0.650 Test Loss: 1.894 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0509898
	speed: 0.3274s/iter; left time: 10598.0425s
	iters: 200, epoch: 13 | loss: 0.3718177
	speed: 0.0748s/iter; left time: 2412.6260s
	iters: 300, epoch: 13 | loss: 0.4868150
	speed: 0.0784s/iter; left time: 2520.9891s
Epoch: 13 cost time: 29.22666621208191
Epoch: 13, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.885 Vali Acc: 0.641 Test Loss: 1.885 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6572077185017026
model parameter : 256834
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6047423
	speed: 0.0997s/iter; left time: 3670.6663s
	iters: 200, epoch: 1 | loss: 1.2212695
	speed: 0.0724s/iter; left time: 2658.9144s
	iters: 300, epoch: 1 | loss: 1.3024921
	speed: 0.0698s/iter; left time: 2554.2199s
Epoch: 1 cost time: 29.279430866241455
Epoch: 1, Steps: 369 | Train Loss: 0.961 Vali Loss: 0.872 Vali Acc: 0.637 Test Loss: 0.872 Test Acc: 0.637
Validation loss decreased (inf --> -0.637335).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6930114
	speed: 0.2995s/iter; left time: 10910.0980s
	iters: 200, epoch: 2 | loss: 0.5655845
	speed: 0.0704s/iter; left time: 2557.0607s
	iters: 300, epoch: 2 | loss: 2.0220408
	speed: 0.0708s/iter; left time: 2564.9371s
Epoch: 2 cost time: 26.79836368560791
Epoch: 2, Steps: 369 | Train Loss: 1.162 Vali Loss: 1.376 Vali Acc: 0.640 Test Loss: 1.376 Test Acc: 0.640
Validation loss decreased (-0.637335 --> -0.639600).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4402081
	speed: 0.2847s/iter; left time: 10268.4306s
	iters: 200, epoch: 3 | loss: 2.1041241
	speed: 0.0585s/iter; left time: 2103.2683s
	iters: 300, epoch: 3 | loss: 2.9580767
	speed: 0.0583s/iter; left time: 2090.3713s
Epoch: 3 cost time: 22.569602489471436
Epoch: 3, Steps: 369 | Train Loss: 1.480 Vali Loss: 1.988 Vali Acc: 0.655 Test Loss: 1.988 Test Acc: 0.655
Validation loss decreased (-0.639600 --> -0.654918).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1945601
	speed: 0.2753s/iter; left time: 9825.5769s
	iters: 200, epoch: 4 | loss: 3.1128933
	speed: 0.0593s/iter; left time: 2111.5340s
	iters: 300, epoch: 4 | loss: 2.0031371
	speed: 0.0580s/iter; left time: 2059.5816s
Epoch: 4 cost time: 22.393149375915527
Epoch: 4, Steps: 369 | Train Loss: 1.427 Vali Loss: 2.728 Vali Acc: 0.616 Test Loss: 2.728 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9137072
	speed: 0.2754s/iter; left time: 9729.9031s
	iters: 200, epoch: 5 | loss: 1.2379503
	speed: 0.0580s/iter; left time: 2042.8936s
	iters: 300, epoch: 5 | loss: 1.1308844
	speed: 0.0637s/iter; left time: 2236.2429s
Epoch: 5 cost time: 23.945791244506836
Epoch: 5, Steps: 369 | Train Loss: 1.209 Vali Loss: 2.180 Vali Acc: 0.627 Test Loss: 2.180 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8971234
	speed: 0.3011s/iter; left time: 10525.2449s
	iters: 200, epoch: 6 | loss: 0.6112772
	speed: 0.0719s/iter; left time: 2504.4701s
	iters: 300, epoch: 6 | loss: 1.5491674
	speed: 0.0727s/iter; left time: 2527.5308s
Epoch: 6 cost time: 27.508654356002808
Epoch: 6, Steps: 369 | Train Loss: 0.975 Vali Loss: 2.447 Vali Acc: 0.633 Test Loss: 2.447 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3457420
	speed: 0.3015s/iter; left time: 10428.8122s
	iters: 200, epoch: 7 | loss: 0.4444338
	speed: 0.0719s/iter; left time: 2478.5384s
	iters: 300, epoch: 7 | loss: 1.1559509
	speed: 0.0720s/iter; left time: 2474.2556s
Epoch: 7 cost time: 27.40636372566223
Epoch: 7, Steps: 369 | Train Loss: 0.672 Vali Loss: 2.237 Vali Acc: 0.624 Test Loss: 2.237 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7613118
	speed: 0.3142s/iter; left time: 10752.4076s
	iters: 200, epoch: 8 | loss: 0.4821928
	speed: 0.0603s/iter; left time: 2057.9704s
	iters: 300, epoch: 8 | loss: 0.0205922
	speed: 0.0610s/iter; left time: 2075.0387s
Epoch: 8 cost time: 23.765908002853394
Epoch: 8, Steps: 369 | Train Loss: 0.453 Vali Loss: 1.658 Vali Acc: 0.624 Test Loss: 1.658 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1138895
	speed: 0.2723s/iter; left time: 9216.2319s
	iters: 200, epoch: 9 | loss: 0.3676794
	speed: 0.0620s/iter; left time: 2091.1057s
	iters: 300, epoch: 9 | loss: 0.1333586
	speed: 0.0584s/iter; left time: 1963.7122s
Epoch: 9 cost time: 22.86798071861267
Epoch: 9, Steps: 369 | Train Loss: 0.264 Vali Loss: 1.421 Vali Acc: 0.632 Test Loss: 1.421 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2324201
	speed: 0.2846s/iter; left time: 9526.7950s
	iters: 200, epoch: 10 | loss: 0.2103832
	speed: 0.0628s/iter; left time: 2096.8490s
	iters: 300, epoch: 10 | loss: 0.0577428
	speed: 0.0615s/iter; left time: 2048.2446s
Epoch: 10 cost time: 23.70606827735901
Epoch: 10, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.354 Vali Acc: 0.642 Test Loss: 1.354 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1344921
	speed: 0.2996s/iter; left time: 9921.3992s
	iters: 200, epoch: 11 | loss: 0.0596963
	speed: 0.0731s/iter; left time: 2413.7197s
	iters: 300, epoch: 11 | loss: 0.0433720
	speed: 0.0733s/iter; left time: 2412.5151s
Epoch: 11 cost time: 27.548839807510376
Epoch: 11, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.438 Vali Acc: 0.644 Test Loss: 1.438 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0894623
	speed: 0.3061s/iter; left time: 10022.8940s
	iters: 200, epoch: 12 | loss: 0.0112323
	speed: 0.0715s/iter; left time: 2333.5397s
	iters: 300, epoch: 12 | loss: 0.0175575
	speed: 0.0715s/iter; left time: 2327.7013s
Epoch: 12 cost time: 27.35632634162903
Epoch: 12, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.718 Vali Acc: 0.646 Test Loss: 1.718 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0616388
	speed: 0.3113s/iter; left time: 10078.0156s
	iters: 200, epoch: 13 | loss: 0.2621936
	speed: 0.0611s/iter; left time: 1971.5642s
	iters: 300, epoch: 13 | loss: 0.0673139
	speed: 0.0598s/iter; left time: 1924.7580s
Epoch: 13 cost time: 24.285887241363525
Epoch: 13, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.746 Vali Acc: 0.640 Test Loss: 1.746 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6549375709421112
model parameter : 201602
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0088567
	speed: 0.0675s/iter; left time: 2482.5547s
	iters: 200, epoch: 1 | loss: 1.2595707
	speed: 0.0408s/iter; left time: 1499.1933s
	iters: 300, epoch: 1 | loss: 0.8995623
	speed: 0.0605s/iter; left time: 2214.7049s
Epoch: 1 cost time: 21.343405723571777
Epoch: 1, Steps: 369 | Train Loss: 0.902 Vali Loss: 1.023 Vali Acc: 0.627 Test Loss: 1.023 Test Acc: 0.627
Validation loss decreased (inf --> -0.626834).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3790461
	speed: 0.2576s/iter; left time: 9386.2208s
	iters: 200, epoch: 2 | loss: 0.9891021
	speed: 0.0401s/iter; left time: 1455.7325s
	iters: 300, epoch: 2 | loss: 1.4624121
	speed: 0.0418s/iter; left time: 1513.3163s
Epoch: 2 cost time: 16.104914903640747
Epoch: 2, Steps: 369 | Train Loss: 1.015 Vali Loss: 1.225 Vali Acc: 0.649 Test Loss: 1.225 Test Acc: 0.649
Validation loss decreased (-0.626834 --> -0.649250).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5711659
	speed: 0.2159s/iter; left time: 7787.5651s
	iters: 200, epoch: 3 | loss: 1.1001875
	speed: 0.0415s/iter; left time: 1490.7183s
	iters: 300, epoch: 3 | loss: 1.3468966
	speed: 0.0531s/iter; left time: 1904.5612s
Epoch: 3 cost time: 19.887977838516235
Epoch: 3, Steps: 369 | Train Loss: 1.266 Vali Loss: 1.621 Vali Acc: 0.646 Test Loss: 1.621 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7118886
	speed: 0.3404s/iter; left time: 12151.5750s
	iters: 200, epoch: 4 | loss: 2.4977934
	speed: 0.0828s/iter; left time: 2946.2634s
	iters: 300, epoch: 4 | loss: 0.3722262
	speed: 0.0839s/iter; left time: 2976.4199s
Epoch: 4 cost time: 31.538349628448486
Epoch: 4, Steps: 369 | Train Loss: 1.280 Vali Loss: 1.607 Vali Acc: 0.642 Test Loss: 1.607 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2405134
	speed: 0.3498s/iter; left time: 12357.1527s
	iters: 200, epoch: 5 | loss: 0.5560735
	speed: 0.0817s/iter; left time: 2876.1912s
	iters: 300, epoch: 5 | loss: 1.5520693
	speed: 0.0827s/iter; left time: 2904.8411s
Epoch: 5 cost time: 31.39818263053894
Epoch: 5, Steps: 369 | Train Loss: 1.110 Vali Loss: 2.647 Vali Acc: 0.630 Test Loss: 2.647 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6965214
	speed: 0.3490s/iter; left time: 12199.1825s
	iters: 200, epoch: 6 | loss: 1.3366215
	speed: 0.0854s/iter; left time: 2977.8045s
	iters: 300, epoch: 6 | loss: 1.2118490
	speed: 0.0844s/iter; left time: 2932.1448s
Epoch: 6 cost time: 32.069353103637695
Epoch: 6, Steps: 369 | Train Loss: 0.835 Vali Loss: 1.979 Vali Acc: 0.638 Test Loss: 1.979 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.4557443
	speed: 0.3350s/iter; left time: 11587.5734s
	iters: 200, epoch: 7 | loss: 0.4167418
	speed: 0.0837s/iter; left time: 2885.0235s
	iters: 300, epoch: 7 | loss: 0.5666779
	speed: 0.0824s/iter; left time: 2833.9757s
Epoch: 7 cost time: 29.98481273651123
Epoch: 7, Steps: 369 | Train Loss: 0.586 Vali Loss: 1.931 Vali Acc: 0.645 Test Loss: 1.931 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7891975
	speed: 0.2897s/iter; left time: 9914.4458s
	iters: 200, epoch: 8 | loss: 1.0909883
	speed: 0.0673s/iter; left time: 2295.4898s
	iters: 300, epoch: 8 | loss: 0.5077102
	speed: 0.0636s/iter; left time: 2163.9103s
Epoch: 8 cost time: 25.296154737472534
Epoch: 8, Steps: 369 | Train Loss: 0.409 Vali Loss: 1.669 Vali Acc: 0.634 Test Loss: 1.669 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3917798
	speed: 0.2936s/iter; left time: 9938.8341s
	iters: 200, epoch: 9 | loss: 0.3022294
	speed: 0.0655s/iter; left time: 2211.7920s
	iters: 300, epoch: 9 | loss: 0.0949006
	speed: 0.0660s/iter; left time: 2219.6294s
Epoch: 9 cost time: 24.610925674438477
Epoch: 9, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.566 Vali Acc: 0.646 Test Loss: 1.566 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1963608
	speed: 0.2832s/iter; left time: 9479.9808s
	iters: 200, epoch: 10 | loss: 0.3004850
	speed: 0.0634s/iter; left time: 2116.5727s
	iters: 300, epoch: 10 | loss: 0.3124233
	speed: 0.0646s/iter; left time: 2150.5876s
Epoch: 10 cost time: 24.602546215057373
Epoch: 10, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.587 Vali Acc: 0.628 Test Loss: 1.587 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0355906
	speed: 0.2859s/iter; left time: 9468.0723s
	iters: 200, epoch: 11 | loss: 0.1657249
	speed: 0.0675s/iter; left time: 2228.6540s
	iters: 300, epoch: 11 | loss: 0.0164298
	speed: 0.0663s/iter; left time: 2182.0924s
Epoch: 11 cost time: 25.197124004364014
Epoch: 11, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.706 Vali Acc: 0.638 Test Loss: 1.706 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1848518
	speed: 0.3020s/iter; left time: 9889.6012s
	iters: 200, epoch: 12 | loss: 0.1717581
	speed: 0.0804s/iter; left time: 2625.7316s
	iters: 300, epoch: 12 | loss: 0.0408092
	speed: 0.0799s/iter; left time: 2598.6174s
Epoch: 12 cost time: 30.779050827026367
Epoch: 12, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.610 Vali Acc: 0.633 Test Loss: 1.610 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6492622020431328
model parameter : 174050
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4650215
	speed: 0.1029s/iter; left time: 3785.9257s
	iters: 200, epoch: 1 | loss: 0.7293918
	speed: 0.0705s/iter; left time: 2589.0155s
	iters: 300, epoch: 1 | loss: 0.6358108
	speed: 0.0710s/iter; left time: 2599.1361s
Epoch: 1 cost time: 29.52411723136902
Epoch: 1, Steps: 369 | Train Loss: 0.824 Vali Loss: 0.971 Vali Acc: 0.633 Test Loss: 0.971 Test Acc: 0.633
Validation loss decreased (inf --> -0.632510).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0306480
	speed: 0.3025s/iter; left time: 11020.3199s
	iters: 200, epoch: 2 | loss: 1.0634178
	speed: 0.0723s/iter; left time: 2627.1961s
	iters: 300, epoch: 2 | loss: 1.0969630
	speed: 0.0716s/iter; left time: 2592.6281s
Epoch: 2 cost time: 27.46358370780945
Epoch: 2, Steps: 369 | Train Loss: 0.945 Vali Loss: 1.348 Vali Acc: 0.644 Test Loss: 1.348 Test Acc: 0.644
Validation loss decreased (-0.632510 --> -0.644141).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7334592
	speed: 0.3063s/iter; left time: 11044.4759s
	iters: 200, epoch: 3 | loss: 2.3545060
	speed: 0.0591s/iter; left time: 2125.7837s
	iters: 300, epoch: 3 | loss: 1.0488890
	speed: 0.0629s/iter; left time: 2255.5470s
Epoch: 3 cost time: 24.29356336593628
Epoch: 3, Steps: 369 | Train Loss: 1.076 Vali Loss: 1.631 Vali Acc: 0.643 Test Loss: 1.631 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8396894
	speed: 0.2735s/iter; left time: 9760.6889s
	iters: 200, epoch: 4 | loss: 1.1332774
	speed: 0.0638s/iter; left time: 2270.8189s
	iters: 300, epoch: 4 | loss: 0.1769162
	speed: 0.0631s/iter; left time: 2239.3772s
Epoch: 4 cost time: 24.44390034675598
Epoch: 4, Steps: 369 | Train Loss: 1.135 Vali Loss: 2.074 Vali Acc: 0.659 Test Loss: 2.074 Test Acc: 0.659
Validation loss decreased (-0.644141 --> -0.659457).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3742805
	speed: 0.2747s/iter; left time: 9702.3404s
	iters: 200, epoch: 5 | loss: 0.8343285
	speed: 0.0631s/iter; left time: 2224.0797s
	iters: 300, epoch: 5 | loss: 0.0478132
	speed: 0.0559s/iter; left time: 1964.3951s
Epoch: 5 cost time: 23.036821603775024
Epoch: 5, Steps: 369 | Train Loss: 0.999 Vali Loss: 2.166 Vali Acc: 0.653 Test Loss: 2.166 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6621940
	speed: 0.2788s/iter; left time: 9745.2893s
	iters: 200, epoch: 6 | loss: 1.1176504
	speed: 0.0595s/iter; left time: 2075.3185s
	iters: 300, epoch: 6 | loss: 0.3740523
	speed: 0.0557s/iter; left time: 1936.2340s
Epoch: 6 cost time: 22.873250246047974
Epoch: 6, Steps: 369 | Train Loss: 0.830 Vali Loss: 1.748 Vali Acc: 0.654 Test Loss: 1.748 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3300337
	speed: 0.2809s/iter; left time: 9716.4265s
	iters: 200, epoch: 7 | loss: 0.3842490
	speed: 0.0622s/iter; left time: 2146.7302s
	iters: 300, epoch: 7 | loss: 0.4792610
	speed: 0.0609s/iter; left time: 2095.0399s
Epoch: 7 cost time: 23.537139415740967
Epoch: 7, Steps: 369 | Train Loss: 0.576 Vali Loss: 1.697 Vali Acc: 0.643 Test Loss: 1.697 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1909155
	speed: 0.2785s/iter; left time: 9529.3324s
	iters: 200, epoch: 8 | loss: 0.2160411
	speed: 0.0697s/iter; left time: 2378.1879s
	iters: 300, epoch: 8 | loss: 0.1197551
	speed: 0.0698s/iter; left time: 2372.9787s
Epoch: 8 cost time: 26.538583517074585
Epoch: 8, Steps: 369 | Train Loss: 0.400 Vali Loss: 1.482 Vali Acc: 0.652 Test Loss: 1.482 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0349549
	speed: 0.2946s/iter; left time: 9972.9796s
	iters: 200, epoch: 9 | loss: 0.1630352
	speed: 0.0717s/iter; left time: 2418.2592s
	iters: 300, epoch: 9 | loss: 0.3283273
	speed: 0.0714s/iter; left time: 2403.3538s
Epoch: 9 cost time: 27.340612411499023
Epoch: 9, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.322 Vali Acc: 0.658 Test Loss: 1.322 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0491239
	speed: 0.3027s/iter; left time: 10134.8767s
	iters: 200, epoch: 10 | loss: 0.1996437
	speed: 0.0717s/iter; left time: 2394.5777s
	iters: 300, epoch: 10 | loss: 0.4142991
	speed: 0.0722s/iter; left time: 2403.8197s
Epoch: 10 cost time: 27.485357761383057
Epoch: 10, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.274 Vali Acc: 0.654 Test Loss: 1.274 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0379401
	speed: 0.3150s/iter; left time: 10431.1557s
	iters: 200, epoch: 11 | loss: 0.0537546
	speed: 0.0730s/iter; left time: 2410.5389s
	iters: 300, epoch: 11 | loss: 0.4409388
	speed: 0.0722s/iter; left time: 2375.5205s
Epoch: 11 cost time: 27.7958402633667
Epoch: 11, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.377 Vali Acc: 0.648 Test Loss: 1.377 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1983984
	speed: 0.2950s/iter; left time: 9660.1833s
	iters: 200, epoch: 12 | loss: 0.0389837
	speed: 0.0621s/iter; left time: 2025.6763s
	iters: 300, epoch: 12 | loss: 0.3459392
	speed: 0.0625s/iter; left time: 2032.5462s
Epoch: 12 cost time: 23.747033834457397
Epoch: 12, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.417 Vali Acc: 0.650 Test Loss: 1.417 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0095430
	speed: 0.2730s/iter; left time: 8837.1247s
	iters: 200, epoch: 13 | loss: 0.1540237
	speed: 0.0615s/iter; left time: 1985.4406s
	iters: 300, epoch: 13 | loss: 0.2364096
	speed: 0.0625s/iter; left time: 2012.1820s
Epoch: 13 cost time: 23.570780515670776
Epoch: 13, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.592 Vali Acc: 0.642 Test Loss: 1.592 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1971492
	speed: 0.2651s/iter; left time: 8484.6759s
	iters: 200, epoch: 14 | loss: 0.0372464
	speed: 0.0647s/iter; left time: 2064.1068s
	iters: 300, epoch: 14 | loss: 0.0050345
	speed: 0.0538s/iter; left time: 1711.3537s
Epoch: 14 cost time: 23.06144118309021
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.625 Vali Acc: 0.637 Test Loss: 1.625 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.659477866061294
model parameter : 146498
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5541148
	speed: 0.0884s/iter; left time: 3252.5830s
	iters: 200, epoch: 1 | loss: 0.8156840
	speed: 0.0596s/iter; left time: 2188.9991s
	iters: 300, epoch: 1 | loss: 0.8512631
	speed: 0.0516s/iter; left time: 1888.6709s
Epoch: 1 cost time: 24.568108797073364
Epoch: 1, Steps: 369 | Train Loss: 0.800 Vali Loss: 0.872 Vali Acc: 0.646 Test Loss: 0.872 Test Acc: 0.646
Validation loss decreased (inf --> -0.645848).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3124188
	speed: 0.2854s/iter; left time: 10398.1174s
	iters: 200, epoch: 2 | loss: 0.9044172
	speed: 0.0631s/iter; left time: 2292.4910s
	iters: 300, epoch: 2 | loss: 0.8473920
	speed: 0.0635s/iter; left time: 2302.3055s
Epoch: 2 cost time: 23.997337579727173
Epoch: 2, Steps: 369 | Train Loss: 0.851 Vali Loss: 1.099 Vali Acc: 0.656 Test Loss: 1.099 Test Acc: 0.656
Validation loss decreased (-0.645848 --> -0.655778).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1753198
	speed: 0.2843s/iter; left time: 10253.7197s
	iters: 200, epoch: 3 | loss: 0.5340469
	speed: 0.0621s/iter; left time: 2232.3900s
	iters: 300, epoch: 3 | loss: 0.8140588
	speed: 0.0619s/iter; left time: 2220.2183s
Epoch: 3 cost time: 23.911095142364502
Epoch: 3, Steps: 369 | Train Loss: 0.946 Vali Loss: 1.556 Vali Acc: 0.627 Test Loss: 1.556 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7081367
	speed: 0.2667s/iter; left time: 9520.6490s
	iters: 200, epoch: 4 | loss: 0.9766271
	speed: 0.0614s/iter; left time: 2184.5828s
	iters: 300, epoch: 4 | loss: 0.0729583
	speed: 0.0633s/iter; left time: 2246.0131s
Epoch: 4 cost time: 24.12111186981201
Epoch: 4, Steps: 369 | Train Loss: 0.940 Vali Loss: 1.828 Vali Acc: 0.634 Test Loss: 1.828 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2404874
	speed: 0.2701s/iter; left time: 9541.3429s
	iters: 200, epoch: 5 | loss: 0.8535549
	speed: 0.0635s/iter; left time: 2235.9691s
	iters: 300, epoch: 5 | loss: 1.1707163
	speed: 0.0644s/iter; left time: 2262.3511s
Epoch: 5 cost time: 24.503077507019043
Epoch: 5, Steps: 369 | Train Loss: 0.833 Vali Loss: 1.897 Vali Acc: 0.636 Test Loss: 1.897 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5776865
	speed: 0.2676s/iter; left time: 9355.8563s
	iters: 200, epoch: 6 | loss: 0.5897202
	speed: 0.0560s/iter; left time: 1952.9102s
	iters: 300, epoch: 6 | loss: 0.5158631
	speed: 0.0565s/iter; left time: 1962.0249s
Epoch: 6 cost time: 21.455740928649902
Epoch: 6, Steps: 369 | Train Loss: 0.674 Vali Loss: 1.825 Vali Acc: 0.656 Test Loss: 1.825 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3840677
	speed: 0.2527s/iter; left time: 8739.4035s
	iters: 200, epoch: 7 | loss: 0.5020640
	speed: 0.0543s/iter; left time: 1872.9946s
	iters: 300, epoch: 7 | loss: 0.1543472
	speed: 0.0547s/iter; left time: 1880.5334s
Epoch: 7 cost time: 20.89081859588623
Epoch: 7, Steps: 369 | Train Loss: 0.547 Vali Loss: 1.741 Vali Acc: 0.635 Test Loss: 1.741 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7058004
	speed: 0.2443s/iter; left time: 8359.3197s
	iters: 200, epoch: 8 | loss: 0.7865713
	speed: 0.0543s/iter; left time: 1854.1090s
	iters: 300, epoch: 8 | loss: 0.0111983
	speed: 0.0524s/iter; left time: 1782.6515s
Epoch: 8 cost time: 20.46805715560913
Epoch: 8, Steps: 369 | Train Loss: 0.401 Vali Loss: 1.612 Vali Acc: 0.625 Test Loss: 1.612 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.5021563
	speed: 0.2623s/iter; left time: 8878.4752s
	iters: 200, epoch: 9 | loss: 0.1419162
	speed: 0.0542s/iter; left time: 1829.9130s
	iters: 300, epoch: 9 | loss: 0.3733954
	speed: 0.0550s/iter; left time: 1849.5379s
Epoch: 9 cost time: 20.987366199493408
Epoch: 9, Steps: 369 | Train Loss: 0.312 Vali Loss: 1.497 Vali Acc: 0.631 Test Loss: 1.497 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0749654
	speed: 0.2643s/iter; left time: 8850.2736s
	iters: 200, epoch: 10 | loss: 0.4194261
	speed: 0.0553s/iter; left time: 1844.6130s
	iters: 300, epoch: 10 | loss: 0.1556175
	speed: 0.0530s/iter; left time: 1765.2342s
Epoch: 10 cost time: 21.055881023406982
Epoch: 10, Steps: 369 | Train Loss: 0.250 Vali Loss: 1.389 Vali Acc: 0.639 Test Loss: 1.389 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1756733
	speed: 0.2604s/iter; left time: 8621.6436s
	iters: 200, epoch: 11 | loss: 0.4176624
	speed: 0.0645s/iter; left time: 2128.3324s
	iters: 300, epoch: 11 | loss: 0.4370950
	speed: 0.0629s/iter; left time: 2069.4172s
Epoch: 11 cost time: 24.591428995132446
Epoch: 11, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.431 Vali Acc: 0.656 Test Loss: 1.431 Test Acc: 0.656
Validation loss decreased (-0.655778 --> -0.656342).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0941160
	speed: 0.2575s/iter; left time: 8430.9027s
	iters: 200, epoch: 12 | loss: 0.0685406
	speed: 0.0647s/iter; left time: 2111.3353s
	iters: 300, epoch: 12 | loss: 0.1182263
	speed: 0.0635s/iter; left time: 2066.9104s
Epoch: 12 cost time: 24.11329197883606
Epoch: 12, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.567 Vali Acc: 0.636 Test Loss: 1.567 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0630396
	speed: 0.2723s/iter; left time: 8813.8959s
	iters: 200, epoch: 13 | loss: 0.0198665
	speed: 0.0640s/iter; left time: 2066.7559s
	iters: 300, epoch: 13 | loss: 0.3677806
	speed: 0.0635s/iter; left time: 2041.8899s
Epoch: 13 cost time: 24.39768624305725
Epoch: 13, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.599 Vali Acc: 0.646 Test Loss: 1.599 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1370472
	speed: 0.2838s/iter; left time: 9082.8745s
	iters: 200, epoch: 14 | loss: 0.0441436
	speed: 0.0646s/iter; left time: 2060.5262s
	iters: 300, epoch: 14 | loss: 0.1985918
	speed: 0.0641s/iter; left time: 2039.7673s
Epoch: 14 cost time: 24.329339742660522
Epoch: 14, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.694 Vali Acc: 0.640 Test Loss: 1.694 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0109556
	speed: 0.2901s/iter; left time: 9176.8516s
	iters: 200, epoch: 15 | loss: 0.0049444
	speed: 0.0628s/iter; left time: 1979.7060s
	iters: 300, epoch: 15 | loss: 0.5236147
	speed: 0.0635s/iter; left time: 1996.9532s
Epoch: 15 cost time: 22.736214637756348
Epoch: 15, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.704 Vali Acc: 0.642 Test Loss: 1.704 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0109983
	speed: 0.2463s/iter; left time: 7702.2221s
	iters: 200, epoch: 16 | loss: 0.0305815
	speed: 0.0545s/iter; left time: 1698.1579s
	iters: 300, epoch: 16 | loss: 0.0812044
	speed: 0.0537s/iter; left time: 1668.9131s
Epoch: 16 cost time: 20.822094917297363
Epoch: 16, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.767 Vali Acc: 0.632 Test Loss: 1.767 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0308185
	speed: 0.2379s/iter; left time: 7350.4406s
	iters: 200, epoch: 17 | loss: 0.0104416
	speed: 0.0550s/iter; left time: 1695.3512s
	iters: 300, epoch: 17 | loss: 0.0383042
	speed: 0.0556s/iter; left time: 1708.1175s
Epoch: 17 cost time: 20.479414224624634
Epoch: 17, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.063 Vali Acc: 0.634 Test Loss: 2.063 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0112256
	speed: 0.2408s/iter; left time: 7351.1292s
	iters: 200, epoch: 18 | loss: 0.0017377
	speed: 0.0556s/iter; left time: 1690.6888s
	iters: 300, epoch: 18 | loss: 0.0404068
	speed: 0.0559s/iter; left time: 1695.3843s
Epoch: 18 cost time: 21.076441526412964
Epoch: 18, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.870 Vali Acc: 0.632 Test Loss: 1.870 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0011049
	speed: 0.2625s/iter; left time: 7915.3446s
	iters: 200, epoch: 19 | loss: 0.0076150
	speed: 0.0558s/iter; left time: 1676.6471s
	iters: 300, epoch: 19 | loss: 0.0021745
	speed: 0.0542s/iter; left time: 1623.5335s
Epoch: 19 cost time: 21.15388560295105
Epoch: 19, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.047 Vali Acc: 0.627 Test Loss: 2.047 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0340302
	speed: 0.2561s/iter; left time: 7630.1181s
	iters: 200, epoch: 20 | loss: 0.0071673
	speed: 0.0562s/iter; left time: 1669.8940s
	iters: 300, epoch: 20 | loss: 0.1021549
	speed: 0.0539s/iter; left time: 1595.0363s
Epoch: 20 cost time: 21.805354833602905
Epoch: 20, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.007 Vali Acc: 0.635 Test Loss: 2.007 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2215485
	speed: 0.2740s/iter; left time: 8059.9158s
	iters: 200, epoch: 21 | loss: 0.0001820
	speed: 0.0637s/iter; left time: 1868.0917s
	iters: 300, epoch: 21 | loss: 0.4015572
	speed: 0.0656s/iter; left time: 1917.5397s
Epoch: 21 cost time: 24.414347648620605
Epoch: 21, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.069 Vali Acc: 0.638 Test Loss: 2.069 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6563564131668559
model parameter : 128162
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.1040564
	speed: 0.2875s/iter; left time: 10582.1271s
	iters: 200, epoch: 1 | loss: 2.6544762
	speed: 0.2590s/iter; left time: 9505.7544s
	iters: 300, epoch: 1 | loss: 1.7028852
	speed: 0.2547s/iter; left time: 9320.5134s
Epoch: 1 cost time: 96.26223492622375
Epoch: 1, Steps: 369 | Train Loss: 1.704 Vali Loss: 1.593 Vali Acc: 0.614 Test Loss: 1.593 Test Acc: 0.614
Validation loss decreased (inf --> -0.613491).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2374137
	speed: 0.7609s/iter; left time: 27721.7706s
	iters: 200, epoch: 2 | loss: 3.0409904
	speed: 0.2061s/iter; left time: 7489.4585s
	iters: 300, epoch: 2 | loss: 3.4771211
	speed: 0.2113s/iter; left time: 7655.5901s
Epoch: 2 cost time: 77.36794137954712
Epoch: 2, Steps: 369 | Train Loss: 2.384 Vali Loss: 2.463 Vali Acc: 0.651 Test Loss: 2.463 Test Acc: 0.651
Validation loss decreased (-0.613491 --> -0.651224).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1292158
	speed: 0.7535s/iter; left time: 27174.6568s
	iters: 200, epoch: 3 | loss: 4.1210175
	speed: 0.2123s/iter; left time: 7635.5629s
	iters: 300, epoch: 3 | loss: 3.1594326
	speed: 0.2207s/iter; left time: 7913.4364s
Epoch: 3 cost time: 83.17010164260864
Epoch: 3, Steps: 369 | Train Loss: 3.005 Vali Loss: 3.651 Vali Acc: 0.629 Test Loss: 3.651 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9518347
	speed: 0.9115s/iter; left time: 32535.3986s
	iters: 200, epoch: 4 | loss: 3.3672202
	speed: 0.2591s/iter; left time: 9221.0026s
	iters: 300, epoch: 4 | loss: 2.3931997
	speed: 0.2617s/iter; left time: 9289.0330s
Epoch: 4 cost time: 97.01493334770203
Epoch: 4, Steps: 369 | Train Loss: 3.105 Vali Loss: 3.634 Vali Acc: 0.656 Test Loss: 3.634 Test Acc: 0.656
Validation loss decreased (-0.651224 --> -0.656320).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0816855
	speed: 0.9118s/iter; left time: 32207.5799s
	iters: 200, epoch: 5 | loss: 4.0437055
	speed: 0.2244s/iter; left time: 7902.7807s
	iters: 300, epoch: 5 | loss: 4.3079410
	speed: 0.2197s/iter; left time: 7716.2298s
Epoch: 5 cost time: 85.60744190216064
Epoch: 5, Steps: 369 | Train Loss: 2.678 Vali Loss: 4.267 Vali Acc: 0.625 Test Loss: 4.267 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6462684
	speed: 0.7632s/iter; left time: 26679.1192s
	iters: 200, epoch: 6 | loss: 4.8720512
	speed: 0.2120s/iter; left time: 7390.5843s
	iters: 300, epoch: 6 | loss: 0.4991811
	speed: 0.2120s/iter; left time: 7367.0852s
Epoch: 6 cost time: 78.82787609100342
Epoch: 6, Steps: 369 | Train Loss: 1.939 Vali Loss: 5.005 Vali Acc: 0.644 Test Loss: 5.005 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1552482
	speed: 0.7919s/iter; left time: 27389.8716s
	iters: 200, epoch: 7 | loss: 0.0598022
	speed: 0.2534s/iter; left time: 8738.4184s
	iters: 300, epoch: 7 | loss: 0.3447085
	speed: 0.2540s/iter; left time: 8735.4280s
Epoch: 7 cost time: 94.48004961013794
Epoch: 7, Steps: 369 | Train Loss: 1.013 Vali Loss: 3.357 Vali Acc: 0.632 Test Loss: 3.357 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4817408
	speed: 0.9061s/iter; left time: 31005.1164s
	iters: 200, epoch: 8 | loss: 0.0686488
	speed: 0.2589s/iter; left time: 8834.7048s
	iters: 300, epoch: 8 | loss: 0.4238433
	speed: 0.2607s/iter; left time: 8867.6962s
Epoch: 8 cost time: 96.48199200630188
Epoch: 8, Steps: 369 | Train Loss: 0.584 Vali Loss: 2.949 Vali Acc: 0.622 Test Loss: 2.949 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0012149
	speed: 0.8153s/iter; left time: 27598.1166s
	iters: 200, epoch: 9 | loss: 0.0454048
	speed: 0.2186s/iter; left time: 7377.1771s
	iters: 300, epoch: 9 | loss: 0.2582254
	speed: 0.2196s/iter; left time: 7387.7384s
Epoch: 9 cost time: 81.14552116394043
Epoch: 9, Steps: 369 | Train Loss: 0.265 Vali Loss: 2.138 Vali Acc: 0.633 Test Loss: 2.138 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1245421
	speed: 0.7678s/iter; left time: 25707.0317s
	iters: 200, epoch: 10 | loss: 0.0500694
	speed: 0.2071s/iter; left time: 6913.0355s
	iters: 300, epoch: 10 | loss: 0.2130555
	speed: 0.2045s/iter; left time: 6806.4988s
Epoch: 10 cost time: 81.11474323272705
Epoch: 10, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.785 Vali Acc: 0.637 Test Loss: 1.785 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0394492
	speed: 0.8942s/iter; left time: 29608.4142s
	iters: 200, epoch: 11 | loss: 0.0669613
	speed: 0.2603s/iter; left time: 8592.6781s
	iters: 300, epoch: 11 | loss: 0.1977054
	speed: 0.2615s/iter; left time: 8607.8092s
Epoch: 11 cost time: 96.56699705123901
Epoch: 11, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.891 Vali Acc: 0.632 Test Loss: 1.891 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0306589
	speed: 0.9133s/iter; left time: 29903.9530s
	iters: 200, epoch: 12 | loss: 0.0516457
	speed: 0.2224s/iter; left time: 7259.0956s
	iters: 300, epoch: 12 | loss: 0.0228986
	speed: 0.2246s/iter; left time: 7308.3330s
Epoch: 12 cost time: 86.31759214401245
Epoch: 12, Steps: 369 | Train Loss: 0.075 Vali Loss: 1.874 Vali Acc: 0.646 Test Loss: 1.874 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0238431
	speed: 0.7496s/iter; left time: 24267.9339s
	iters: 200, epoch: 13 | loss: 0.0019277
	speed: 0.1998s/iter; left time: 6448.0860s
	iters: 300, epoch: 13 | loss: 0.0141052
	speed: 0.2042s/iter; left time: 6569.2992s
Epoch: 13 cost time: 75.55187153816223
Epoch: 13, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.402 Vali Acc: 0.645 Test Loss: 2.402 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0062682
	speed: 0.7730s/iter; left time: 24737.9673s
	iters: 200, epoch: 14 | loss: 0.1873714
	speed: 0.2411s/iter; left time: 7691.7940s
	iters: 300, epoch: 14 | loss: 0.0511221
	speed: 0.2464s/iter; left time: 7835.7238s
Epoch: 14 cost time: 90.76749968528748
Epoch: 14, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.591 Vali Acc: 0.624 Test Loss: 2.591 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6563564131668559
model parameter : 609634
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9809823
	speed: 0.1523s/iter; left time: 5603.7798s
	iters: 200, epoch: 1 | loss: 1.3962700
	speed: 0.1175s/iter; left time: 4311.0493s
	iters: 300, epoch: 1 | loss: 0.5716998
	speed: 0.1095s/iter; left time: 4007.6834s
Epoch: 1 cost time: 45.744446992874146
Epoch: 1, Steps: 369 | Train Loss: 1.251 Vali Loss: 1.037 Vali Acc: 0.668 Test Loss: 1.037 Test Acc: 0.668
Validation loss decreased (inf --> -0.667981).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3469862
	speed: 0.4437s/iter; left time: 16163.5752s
	iters: 200, epoch: 2 | loss: 1.4555902
	speed: 0.1075s/iter; left time: 3904.4923s
	iters: 300, epoch: 2 | loss: 1.7166786
	speed: 0.1055s/iter; left time: 3820.9929s
Epoch: 2 cost time: 40.55915665626526
Epoch: 2, Steps: 369 | Train Loss: 1.686 Vali Loss: 1.453 Vali Acc: 0.652 Test Loss: 1.453 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2170248
	speed: 0.4340s/iter; left time: 15650.4745s
	iters: 200, epoch: 3 | loss: 2.8686082
	speed: 0.1053s/iter; left time: 3787.4769s
	iters: 300, epoch: 3 | loss: 3.7983882
	speed: 0.1050s/iter; left time: 3764.8875s
Epoch: 3 cost time: 39.79285502433777
Epoch: 3, Steps: 369 | Train Loss: 2.104 Vali Loss: 3.351 Vali Acc: 0.647 Test Loss: 3.351 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.0153103
	speed: 0.4290s/iter; left time: 15313.9369s
	iters: 200, epoch: 4 | loss: 2.3474672
	speed: 0.1039s/iter; left time: 3699.4073s
	iters: 300, epoch: 4 | loss: 2.8083243
	speed: 0.0869s/iter; left time: 3086.1094s
Epoch: 4 cost time: 39.056572675704956
Epoch: 4, Steps: 369 | Train Loss: 2.268 Vali Loss: 2.440 Vali Acc: 0.638 Test Loss: 2.440 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.9828792
	speed: 0.5012s/iter; left time: 17704.3904s
	iters: 200, epoch: 5 | loss: 1.0262777
	speed: 0.1254s/iter; left time: 4418.4211s
	iters: 300, epoch: 5 | loss: 4.8561363
	speed: 0.1240s/iter; left time: 4353.9546s
Epoch: 5 cost time: 47.05786108970642
Epoch: 5, Steps: 369 | Train Loss: 1.789 Vali Loss: 3.896 Vali Acc: 0.629 Test Loss: 3.896 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5892059
	speed: 0.5097s/iter; left time: 17816.6440s
	iters: 200, epoch: 6 | loss: 0.0332503
	speed: 0.1281s/iter; left time: 4463.9076s
	iters: 300, epoch: 6 | loss: 1.2901914
	speed: 0.1280s/iter; left time: 4448.7766s
Epoch: 6 cost time: 48.31664204597473
Epoch: 6, Steps: 369 | Train Loss: 1.376 Vali Loss: 3.453 Vali Acc: 0.632 Test Loss: 3.453 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5826029
	speed: 0.5139s/iter; left time: 17773.1303s
	iters: 200, epoch: 7 | loss: 0.4413983
	speed: 0.1285s/iter; left time: 4431.8275s
	iters: 300, epoch: 7 | loss: 1.5988642
	speed: 0.1058s/iter; left time: 3638.5036s
Epoch: 7 cost time: 44.65051770210266
Epoch: 7, Steps: 369 | Train Loss: 0.736 Vali Loss: 2.699 Vali Acc: 0.632 Test Loss: 2.699 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.5172340
	speed: 0.4457s/iter; left time: 15250.3618s
	iters: 200, epoch: 8 | loss: 0.7523071
	speed: 0.1059s/iter; left time: 3612.7842s
	iters: 300, epoch: 8 | loss: 0.0014408
	speed: 0.1025s/iter; left time: 3487.7147s
Epoch: 8 cost time: 39.809802770614624
Epoch: 8, Steps: 369 | Train Loss: 0.401 Vali Loss: 2.301 Vali Acc: 0.631 Test Loss: 2.301 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4646999
	speed: 0.4361s/iter; left time: 14762.6666s
	iters: 200, epoch: 9 | loss: 0.2748211
	speed: 0.1022s/iter; left time: 3448.3144s
	iters: 300, epoch: 9 | loss: 0.0847854
	speed: 0.1068s/iter; left time: 3594.6555s
Epoch: 9 cost time: 40.25653409957886
Epoch: 9, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.827 Vali Acc: 0.627 Test Loss: 1.827 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.4300317
	speed: 0.4376s/iter; left time: 14649.8244s
	iters: 200, epoch: 10 | loss: 0.1429403
	speed: 0.1054s/iter; left time: 3516.7920s
	iters: 300, epoch: 10 | loss: 0.1946137
	speed: 0.1023s/iter; left time: 3404.8884s
Epoch: 10 cost time: 40.73243474960327
Epoch: 10, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.651 Vali Acc: 0.628 Test Loss: 1.651 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0061076
	speed: 0.5014s/iter; left time: 16601.2934s
	iters: 200, epoch: 11 | loss: 0.1501236
	speed: 0.1260s/iter; left time: 4160.0420s
	iters: 300, epoch: 11 | loss: 0.1923293
	speed: 0.1252s/iter; left time: 4120.8738s
Epoch: 11 cost time: 47.32321000099182
Epoch: 11, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.861 Vali Acc: 0.650 Test Loss: 1.861 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 324002
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7335492
	speed: 0.1183s/iter; left time: 4353.7023s
	iters: 200, epoch: 1 | loss: 1.2108036
	speed: 0.0949s/iter; left time: 3484.3274s
	iters: 300, epoch: 1 | loss: 0.8513101
	speed: 0.0926s/iter; left time: 3389.1130s
Epoch: 1 cost time: 36.93571734428406
Epoch: 1, Steps: 369 | Train Loss: 1.105 Vali Loss: 1.007 Vali Acc: 0.656 Test Loss: 1.007 Test Acc: 0.656
Validation loss decreased (inf --> -0.656063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4346492
	speed: 0.3768s/iter; left time: 13727.5133s
	iters: 200, epoch: 2 | loss: 1.8951643
	speed: 0.0877s/iter; left time: 3187.9476s
	iters: 300, epoch: 2 | loss: 3.0105951
	speed: 0.0849s/iter; left time: 3075.9645s
Epoch: 2 cost time: 33.108848333358765
Epoch: 2, Steps: 369 | Train Loss: 1.376 Vali Loss: 1.379 Vali Acc: 0.659 Test Loss: 1.379 Test Acc: 0.659
Validation loss decreased (-0.656063 --> -0.658897).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3474131
	speed: 0.3584s/iter; left time: 12925.1623s
	iters: 200, epoch: 3 | loss: 2.2078035
	speed: 0.0864s/iter; left time: 3107.8536s
	iters: 300, epoch: 3 | loss: 0.1871202
	speed: 0.0834s/iter; left time: 2992.3474s
Epoch: 3 cost time: 32.48419904708862
Epoch: 3, Steps: 369 | Train Loss: 1.702 Vali Loss: 1.505 Vali Acc: 0.652 Test Loss: 1.505 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3473954
	speed: 0.3679s/iter; left time: 13130.4171s
	iters: 200, epoch: 4 | loss: 1.5329198
	speed: 0.0834s/iter; left time: 2970.3055s
	iters: 300, epoch: 4 | loss: 1.2457976
	speed: 0.0857s/iter; left time: 3042.9683s
Epoch: 4 cost time: 31.818321466445923
Epoch: 4, Steps: 369 | Train Loss: 1.635 Vali Loss: 2.973 Vali Acc: 0.629 Test Loss: 2.973 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.1371787
	speed: 0.4204s/iter; left time: 14851.2976s
	iters: 200, epoch: 5 | loss: 1.3116595
	speed: 0.1036s/iter; left time: 3650.6570s
	iters: 300, epoch: 5 | loss: 0.9528595
	speed: 0.1028s/iter; left time: 3609.8129s
Epoch: 5 cost time: 39.156118392944336
Epoch: 5, Steps: 369 | Train Loss: 1.390 Vali Loss: 3.032 Vali Acc: 0.646 Test Loss: 3.032 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1639181
	speed: 0.4526s/iter; left time: 15821.6260s
	iters: 200, epoch: 6 | loss: 0.6451526
	speed: 0.1040s/iter; left time: 3625.7516s
	iters: 300, epoch: 6 | loss: 1.4514793
	speed: 0.1021s/iter; left time: 3549.0793s
Epoch: 6 cost time: 39.0960750579834
Epoch: 6, Steps: 369 | Train Loss: 1.092 Vali Loss: 2.809 Vali Acc: 0.619 Test Loss: 2.809 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.4992818
	speed: 0.4412s/iter; left time: 15258.9490s
	iters: 200, epoch: 7 | loss: 0.0626334
	speed: 0.1054s/iter; left time: 3634.4746s
	iters: 300, epoch: 7 | loss: 0.2063977
	speed: 0.1051s/iter; left time: 3614.0557s
Epoch: 7 cost time: 39.870280504226685
Epoch: 7, Steps: 369 | Train Loss: 0.735 Vali Loss: 2.521 Vali Acc: 0.650 Test Loss: 2.521 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0129517
	speed: 0.4078s/iter; left time: 13952.8895s
	iters: 200, epoch: 8 | loss: 0.0205101
	speed: 0.0863s/iter; left time: 2945.6160s
	iters: 300, epoch: 8 | loss: 0.3224076
	speed: 0.0889s/iter; left time: 3024.9286s
Epoch: 8 cost time: 33.651453495025635
Epoch: 8, Steps: 369 | Train Loss: 0.459 Vali Loss: 2.206 Vali Acc: 0.638 Test Loss: 2.206 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.4111167
	speed: 0.3963s/iter; left time: 13414.4502s
	iters: 200, epoch: 9 | loss: 0.0152165
	speed: 0.0903s/iter; left time: 3047.4480s
	iters: 300, epoch: 9 | loss: 0.1968075
	speed: 0.0888s/iter; left time: 2987.6196s
Epoch: 9 cost time: 34.09482717514038
Epoch: 9, Steps: 369 | Train Loss: 0.292 Vali Loss: 1.664 Vali Acc: 0.624 Test Loss: 1.664 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5901812
	speed: 0.3859s/iter; left time: 12920.2584s
	iters: 200, epoch: 10 | loss: 0.0108238
	speed: 0.0931s/iter; left time: 3107.8208s
	iters: 300, epoch: 10 | loss: 0.0824566
	speed: 0.0882s/iter; left time: 2935.6446s
Epoch: 10 cost time: 34.6014244556427
Epoch: 10, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.564 Vali Acc: 0.646 Test Loss: 1.564 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1315230
	speed: 0.3836s/iter; left time: 12702.2897s
	iters: 200, epoch: 11 | loss: 0.3952070
	speed: 0.0831s/iter; left time: 2741.6110s
	iters: 300, epoch: 11 | loss: 0.0296515
	speed: 0.1018s/iter; left time: 3350.3361s
Epoch: 11 cost time: 35.27031922340393
Epoch: 11, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.707 Vali Acc: 0.644 Test Loss: 1.707 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1974949
	speed: 0.4448s/iter; left time: 14563.4561s
	iters: 200, epoch: 12 | loss: 0.0075144
	speed: 0.1031s/iter; left time: 3366.1288s
	iters: 300, epoch: 12 | loss: 0.1425960
	speed: 0.1025s/iter; left time: 3337.0185s
Epoch: 12 cost time: 39.27616620063782
Epoch: 12, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.790 Vali Acc: 0.629 Test Loss: 1.790 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6589103291713961
model parameter : 231874
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7287653
	speed: 0.1101s/iter; left time: 4051.1974s
	iters: 200, epoch: 1 | loss: 1.3945856
	speed: 0.0814s/iter; left time: 2988.8556s
	iters: 300, epoch: 1 | loss: 1.6905355
	speed: 0.0846s/iter; left time: 3095.0205s
Epoch: 1 cost time: 32.704041481018066
Epoch: 1, Steps: 369 | Train Loss: 0.942 Vali Loss: 0.750 Vali Acc: 0.663 Test Loss: 0.750 Test Acc: 0.663
Validation loss decreased (inf --> -0.663159).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0072613
	speed: 0.3114s/iter; left time: 11345.2945s
	iters: 200, epoch: 2 | loss: 1.0719593
	speed: 0.0705s/iter; left time: 2560.0840s
	iters: 300, epoch: 2 | loss: 0.6727238
	speed: 0.0676s/iter; left time: 2448.7844s
Epoch: 2 cost time: 26.407145977020264
Epoch: 2, Steps: 369 | Train Loss: 1.191 Vali Loss: 1.609 Vali Acc: 0.629 Test Loss: 1.609 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3190465
	speed: 0.3059s/iter; left time: 11033.4417s
	iters: 200, epoch: 3 | loss: 1.7687873
	speed: 0.0666s/iter; left time: 2396.2292s
	iters: 300, epoch: 3 | loss: 2.1123521
	speed: 0.0655s/iter; left time: 2348.6227s
Epoch: 3 cost time: 25.36996293067932
Epoch: 3, Steps: 369 | Train Loss: 1.488 Vali Loss: 1.775 Vali Acc: 0.646 Test Loss: 1.775 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1375538
	speed: 0.3046s/iter; left time: 10873.4575s
	iters: 200, epoch: 4 | loss: 0.3574309
	speed: 0.0667s/iter; left time: 2373.7131s
	iters: 300, epoch: 4 | loss: 1.0688173
	speed: 0.0650s/iter; left time: 2308.5095s
Epoch: 4 cost time: 25.606340169906616
Epoch: 4, Steps: 369 | Train Loss: 1.413 Vali Loss: 3.005 Vali Acc: 0.628 Test Loss: 3.005 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8426027
	speed: 0.3195s/iter; left time: 11284.6816s
	iters: 200, epoch: 5 | loss: 1.0210165
	speed: 0.0688s/iter; left time: 2424.1231s
	iters: 300, epoch: 5 | loss: 1.0614696
	speed: 0.0687s/iter; left time: 2411.8274s
Epoch: 5 cost time: 26.232441902160645
Epoch: 5, Steps: 369 | Train Loss: 1.252 Vali Loss: 2.161 Vali Acc: 0.653 Test Loss: 2.161 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9000546
	speed: 0.3285s/iter; left time: 11482.1616s
	iters: 200, epoch: 6 | loss: 1.4933527
	speed: 0.0803s/iter; left time: 2800.0119s
	iters: 300, epoch: 6 | loss: 1.2560714
	speed: 0.0801s/iter; left time: 2783.7073s
Epoch: 6 cost time: 30.57818913459778
Epoch: 6, Steps: 369 | Train Loss: 0.953 Vali Loss: 2.506 Vali Acc: 0.625 Test Loss: 2.506 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.4531176
	speed: 0.3197s/iter; left time: 11056.5908s
	iters: 200, epoch: 7 | loss: 1.2749863
	speed: 0.0420s/iter; left time: 1448.9590s
	iters: 300, epoch: 7 | loss: 0.5479727
	speed: 0.0411s/iter; left time: 1411.9138s
Epoch: 7 cost time: 17.189204931259155
Epoch: 7, Steps: 369 | Train Loss: 0.654 Vali Loss: 2.090 Vali Acc: 0.648 Test Loss: 2.090 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1238521
	speed: 0.2069s/iter; left time: 7080.9364s
	iters: 200, epoch: 8 | loss: 0.1006602
	speed: 0.0588s/iter; left time: 2006.2958s
	iters: 300, epoch: 8 | loss: 1.5228890
	speed: 0.0785s/iter; left time: 2670.4620s
Epoch: 8 cost time: 24.237983465194702
Epoch: 8, Steps: 369 | Train Loss: 0.416 Vali Loss: 1.778 Vali Acc: 0.644 Test Loss: 1.778 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.1653053
	speed: 0.3447s/iter; left time: 11668.7260s
	iters: 200, epoch: 9 | loss: 0.1791803
	speed: 0.0778s/iter; left time: 2627.2035s
	iters: 300, epoch: 9 | loss: 0.2216457
	speed: 0.0769s/iter; left time: 2588.2348s
Epoch: 9 cost time: 30.05889081954956
Epoch: 9, Steps: 369 | Train Loss: 0.289 Vali Loss: 1.571 Vali Acc: 0.640 Test Loss: 1.571 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.1555901
	speed: 0.3434s/iter; left time: 11496.1053s
	iters: 200, epoch: 10 | loss: 0.1474354
	speed: 0.0790s/iter; left time: 2637.6092s
	iters: 300, epoch: 10 | loss: 0.0683093
	speed: 0.0795s/iter; left time: 2646.0885s
Epoch: 10 cost time: 30.006702423095703
Epoch: 10, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.471 Vali Acc: 0.643 Test Loss: 1.471 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0114516
	speed: 0.3143s/iter; left time: 10407.2053s
	iters: 200, epoch: 11 | loss: 0.0935929
	speed: 0.0613s/iter; left time: 2025.0481s
	iters: 300, epoch: 11 | loss: 0.0452568
	speed: 0.0640s/iter; left time: 2105.5774s
Epoch: 11 cost time: 24.27535080909729
Epoch: 11, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.460 Vali Acc: 0.648 Test Loss: 1.460 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.66316685584563
model parameter : 176642
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7144417
	speed: 0.0724s/iter; left time: 2664.4230s
	iters: 200, epoch: 1 | loss: 0.8014405
	speed: 0.0507s/iter; left time: 1860.3031s
	iters: 300, epoch: 1 | loss: 1.3952886
	speed: 0.0496s/iter; left time: 1814.4209s
Epoch: 1 cost time: 20.86085081100464
Epoch: 1, Steps: 369 | Train Loss: 0.892 Vali Loss: 0.854 Vali Acc: 0.638 Test Loss: 0.854 Test Acc: 0.638
Validation loss decreased (inf --> -0.638187).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7859716
	speed: 0.2598s/iter; left time: 9464.9664s
	iters: 200, epoch: 2 | loss: 1.0260725
	speed: 0.0673s/iter; left time: 2443.5385s
	iters: 300, epoch: 2 | loss: 0.5200773
	speed: 0.0670s/iter; left time: 2427.7875s
Epoch: 2 cost time: 25.60911226272583
Epoch: 2, Steps: 369 | Train Loss: 1.047 Vali Loss: 1.506 Vali Acc: 0.649 Test Loss: 1.506 Test Acc: 0.649
Validation loss decreased (-0.638187 --> -0.648680).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5369331
	speed: 0.2891s/iter; left time: 10426.9400s
	iters: 200, epoch: 3 | loss: 0.1974578
	speed: 0.0669s/iter; left time: 2406.8279s
	iters: 300, epoch: 3 | loss: 1.1210151
	speed: 0.0671s/iter; left time: 2408.1505s
Epoch: 3 cost time: 25.717124223709106
Epoch: 3, Steps: 369 | Train Loss: 1.190 Vali Loss: 1.720 Vali Acc: 0.631 Test Loss: 1.720 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8149545
	speed: 0.2772s/iter; left time: 9895.5126s
	iters: 200, epoch: 4 | loss: 3.1171596
	speed: 0.0672s/iter; left time: 2392.5436s
	iters: 300, epoch: 4 | loss: 3.9241378
	speed: 0.0675s/iter; left time: 2395.1658s
Epoch: 4 cost time: 25.642340421676636
Epoch: 4, Steps: 369 | Train Loss: 1.283 Vali Loss: 2.727 Vali Acc: 0.640 Test Loss: 2.727 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2840921
	speed: 0.2622s/iter; left time: 9263.1894s
	iters: 200, epoch: 5 | loss: 1.3854655
	speed: 0.0503s/iter; left time: 1773.1511s
	iters: 300, epoch: 5 | loss: 0.4217632
	speed: 0.0536s/iter; left time: 1881.0661s
Epoch: 5 cost time: 20.467058658599854
Epoch: 5, Steps: 369 | Train Loss: 1.007 Vali Loss: 2.491 Vali Acc: 0.649 Test Loss: 2.491 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.7827177
	speed: 0.2606s/iter; left time: 9110.9155s
	iters: 200, epoch: 6 | loss: 0.6670687
	speed: 0.0531s/iter; left time: 1849.1569s
	iters: 300, epoch: 6 | loss: 1.5928816
	speed: 0.0483s/iter; left time: 1676.9806s
Epoch: 6 cost time: 19.782257795333862
Epoch: 6, Steps: 369 | Train Loss: 0.832 Vali Loss: 2.242 Vali Acc: 0.649 Test Loss: 2.242 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.1696390
	speed: 0.2645s/iter; left time: 9146.8942s
	iters: 200, epoch: 7 | loss: 0.7986106
	speed: 0.0518s/iter; left time: 1785.7808s
	iters: 300, epoch: 7 | loss: 0.5152628
	speed: 0.0518s/iter; left time: 1781.7398s
Epoch: 7 cost time: 19.98664879798889
Epoch: 7, Steps: 369 | Train Loss: 0.585 Vali Loss: 2.065 Vali Acc: 0.631 Test Loss: 2.065 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1385006
	speed: 0.2615s/iter; left time: 8946.4316s
	iters: 200, epoch: 8 | loss: 0.5556489
	speed: 0.0659s/iter; left time: 2248.0547s
	iters: 300, epoch: 8 | loss: 0.5933391
	speed: 0.0642s/iter; left time: 2184.2525s
Epoch: 8 cost time: 24.922314167022705
Epoch: 8, Steps: 369 | Train Loss: 0.420 Vali Loss: 1.895 Vali Acc: 0.644 Test Loss: 1.895 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0664821
	speed: 0.2816s/iter; left time: 9530.8327s
	iters: 200, epoch: 9 | loss: 0.1570129
	speed: 0.0656s/iter; left time: 2213.2476s
	iters: 300, epoch: 9 | loss: 0.1837577
	speed: 0.0659s/iter; left time: 2218.1744s
Epoch: 9 cost time: 25.383951902389526
Epoch: 9, Steps: 369 | Train Loss: 0.294 Vali Loss: 1.725 Vali Acc: 0.646 Test Loss: 1.725 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1103750
	speed: 0.3027s/iter; left time: 10133.4582s
	iters: 200, epoch: 10 | loss: 0.0116833
	speed: 0.0654s/iter; left time: 2183.1340s
	iters: 300, epoch: 10 | loss: 0.0100375
	speed: 0.0665s/iter; left time: 2213.2266s
Epoch: 10 cost time: 25.610919952392578
Epoch: 10, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.532 Vali Acc: 0.634 Test Loss: 1.532 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1335765
	speed: 0.2842s/iter; left time: 9411.4524s
	iters: 200, epoch: 11 | loss: 0.2666777
	speed: 0.0517s/iter; left time: 1706.1797s
	iters: 300, epoch: 11 | loss: 0.3224765
	speed: 0.0536s/iter; left time: 1764.0041s
Epoch: 11 cost time: 20.58926773071289
Epoch: 11, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.699 Vali Acc: 0.645 Test Loss: 1.699 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1754092
	speed: 0.2550s/iter; left time: 8350.5670s
	iters: 200, epoch: 12 | loss: 0.0017553
	speed: 0.0505s/iter; left time: 1649.7439s
	iters: 300, epoch: 12 | loss: 0.1226575
	speed: 0.0502s/iter; left time: 1634.9336s
Epoch: 12 cost time: 20.20885944366455
Epoch: 12, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.683 Vali Acc: 0.648 Test Loss: 1.683 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6486946651532349
model parameter : 149090
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5681962
	speed: 0.0860s/iter; left time: 3166.1475s
	iters: 200, epoch: 1 | loss: 1.1044223
	speed: 0.0608s/iter; left time: 2229.9354s
	iters: 300, epoch: 1 | loss: 1.3518612
	speed: 0.0605s/iter; left time: 2215.4256s
Epoch: 1 cost time: 25.087300300598145
Epoch: 1, Steps: 369 | Train Loss: 0.852 Vali Loss: 1.133 Vali Acc: 0.636 Test Loss: 1.133 Test Acc: 0.636
Validation loss decreased (inf --> -0.635914).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8043300
	speed: 0.2756s/iter; left time: 10039.6083s
	iters: 200, epoch: 2 | loss: 1.2757010
	speed: 0.0604s/iter; left time: 2193.2980s
	iters: 300, epoch: 2 | loss: 0.3099873
	speed: 0.0610s/iter; left time: 2208.6866s
Epoch: 2 cost time: 23.25544571876526
Epoch: 2, Steps: 369 | Train Loss: 0.916 Vali Loss: 1.329 Vali Acc: 0.642 Test Loss: 1.329 Test Acc: 0.642
Validation loss decreased (-0.635914 --> -0.642155).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3035191
	speed: 0.2562s/iter; left time: 9239.5233s
	iters: 200, epoch: 3 | loss: 2.3057475
	speed: 0.0617s/iter; left time: 2217.7540s
	iters: 300, epoch: 3 | loss: 0.2729104
	speed: 0.0602s/iter; left time: 2157.4841s
Epoch: 3 cost time: 23.3850257396698
Epoch: 3, Steps: 369 | Train Loss: 1.094 Vali Loss: 1.749 Vali Acc: 0.635 Test Loss: 1.749 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9655987
	speed: 0.2463s/iter; left time: 8793.2148s
	iters: 200, epoch: 4 | loss: 1.0164073
	speed: 0.0480s/iter; left time: 1706.8732s
	iters: 300, epoch: 4 | loss: 1.1806544
	speed: 0.0460s/iter; left time: 1631.0731s
Epoch: 4 cost time: 18.511874198913574
Epoch: 4, Steps: 369 | Train Loss: 1.015 Vali Loss: 1.930 Vali Acc: 0.648 Test Loss: 1.930 Test Acc: 0.648
Validation loss decreased (-0.642155 --> -0.648392).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1512311
	speed: 0.2594s/iter; left time: 9162.7513s
	iters: 200, epoch: 5 | loss: 0.3860711
	speed: 0.0477s/iter; left time: 1678.9453s
	iters: 300, epoch: 5 | loss: 1.5856552
	speed: 0.0469s/iter; left time: 1646.9997s
Epoch: 5 cost time: 19.144303560256958
Epoch: 5, Steps: 369 | Train Loss: 0.893 Vali Loss: 2.171 Vali Acc: 0.635 Test Loss: 2.171 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9623984
	speed: 0.2558s/iter; left time: 8941.2253s
	iters: 200, epoch: 6 | loss: 1.1523561
	speed: 0.0477s/iter; left time: 1662.4353s
	iters: 300, epoch: 6 | loss: 0.8741681
	speed: 0.0476s/iter; left time: 1654.7148s
Epoch: 6 cost time: 18.674680471420288
Epoch: 6, Steps: 369 | Train Loss: 0.703 Vali Loss: 2.109 Vali Acc: 0.633 Test Loss: 2.109 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0560570
	speed: 0.2518s/iter; left time: 8709.5373s
	iters: 200, epoch: 7 | loss: 0.8832086
	speed: 0.0471s/iter; left time: 1623.8946s
	iters: 300, epoch: 7 | loss: 1.0406208
	speed: 0.0594s/iter; left time: 2043.5568s
Epoch: 7 cost time: 20.931438446044922
Epoch: 7, Steps: 369 | Train Loss: 0.544 Vali Loss: 1.781 Vali Acc: 0.665 Test Loss: 1.781 Test Acc: 0.665
Validation loss decreased (-0.648392 --> -0.665135).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2098322
	speed: 0.2763s/iter; left time: 9453.6476s
	iters: 200, epoch: 8 | loss: 0.5642282
	speed: 0.0607s/iter; left time: 2069.5373s
	iters: 300, epoch: 8 | loss: 0.3949125
	speed: 0.0599s/iter; left time: 2038.9587s
Epoch: 8 cost time: 23.205604791641235
Epoch: 8, Steps: 369 | Train Loss: 0.448 Vali Loss: 1.719 Vali Acc: 0.649 Test Loss: 1.719 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0531956
	speed: 0.2735s/iter; left time: 9259.1513s
	iters: 200, epoch: 9 | loss: 0.2981331
	speed: 0.0605s/iter; left time: 2041.7464s
	iters: 300, epoch: 9 | loss: 0.1342363
	speed: 0.0609s/iter; left time: 2049.5205s
Epoch: 9 cost time: 23.56144666671753
Epoch: 9, Steps: 369 | Train Loss: 0.325 Vali Loss: 1.575 Vali Acc: 0.652 Test Loss: 1.575 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1862068
	speed: 0.2946s/iter; left time: 9862.1270s
	iters: 200, epoch: 10 | loss: 0.5347779
	speed: 0.0501s/iter; left time: 1672.7782s
	iters: 300, epoch: 10 | loss: 0.2399672
	speed: 0.0471s/iter; left time: 1568.0380s
Epoch: 10 cost time: 20.70319652557373
Epoch: 10, Steps: 369 | Train Loss: 0.259 Vali Loss: 1.512 Vali Acc: 0.661 Test Loss: 1.512 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3463012
	speed: 0.2409s/iter; left time: 7975.1995s
	iters: 200, epoch: 11 | loss: 0.0575022
	speed: 0.0480s/iter; left time: 1585.4973s
	iters: 300, epoch: 11 | loss: 0.6604530
	speed: 0.0485s/iter; left time: 1596.5365s
Epoch: 11 cost time: 18.765863180160522
Epoch: 11, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.421 Vali Acc: 0.654 Test Loss: 1.421 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1945734
	speed: 0.2323s/iter; left time: 7605.1135s
	iters: 200, epoch: 12 | loss: 0.2960742
	speed: 0.0468s/iter; left time: 1528.3730s
	iters: 300, epoch: 12 | loss: 0.0314715
	speed: 0.0483s/iter; left time: 1572.4211s
Epoch: 12 cost time: 18.490575075149536
Epoch: 12, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.516 Vali Acc: 0.656 Test Loss: 1.516 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0343996
	speed: 0.2387s/iter; left time: 7728.8912s
	iters: 200, epoch: 13 | loss: 0.0335558
	speed: 0.0476s/iter; left time: 1534.7967s
	iters: 300, epoch: 13 | loss: 0.1628113
	speed: 0.0480s/iter; left time: 1544.1524s
Epoch: 13 cost time: 18.623459100723267
Epoch: 13, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.560 Vali Acc: 0.641 Test Loss: 1.560 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1918849
	speed: 0.2496s/iter; left time: 7988.4931s
	iters: 200, epoch: 14 | loss: 0.0177146
	speed: 0.0611s/iter; left time: 1950.0494s
	iters: 300, epoch: 14 | loss: 0.0301932
	speed: 0.0605s/iter; left time: 1923.8909s
Epoch: 14 cost time: 23.378174781799316
Epoch: 14, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.620 Vali Acc: 0.652 Test Loss: 1.620 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0156674
	speed: 0.2823s/iter; left time: 8931.3768s
	iters: 200, epoch: 15 | loss: 0.0011965
	speed: 0.0600s/iter; left time: 1891.0076s
	iters: 300, epoch: 15 | loss: 0.0386204
	speed: 0.0605s/iter; left time: 1900.9565s
Epoch: 15 cost time: 23.45696997642517
Epoch: 15, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.704 Vali Acc: 0.650 Test Loss: 1.704 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0284195
	speed: 0.2900s/iter; left time: 9067.3067s
	iters: 200, epoch: 16 | loss: 0.0015315
	speed: 0.0609s/iter; left time: 1897.2914s
	iters: 300, epoch: 16 | loss: 0.3319811
	speed: 0.0603s/iter; left time: 1872.3603s
Epoch: 16 cost time: 23.445934534072876
Epoch: 16, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.765 Vali Acc: 0.657 Test Loss: 1.765 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0854200
	speed: 0.2522s/iter; left time: 7793.5470s
	iters: 200, epoch: 17 | loss: 0.0932837
	speed: 0.0469s/iter; left time: 1443.4399s
	iters: 300, epoch: 17 | loss: 0.0472280
	speed: 0.0462s/iter; left time: 1419.0483s
Epoch: 17 cost time: 18.176289319992065
Epoch: 17, Steps: 369 | Train Loss: 0.091 Vali Loss: 1.878 Vali Acc: 0.652 Test Loss: 1.878 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6651532349602725
model parameter : 121538
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6974729
	speed: 0.0626s/iter; left time: 2304.8134s
	iters: 200, epoch: 1 | loss: 0.4095745
	speed: 0.0393s/iter; left time: 1441.1738s
	iters: 300, epoch: 1 | loss: 0.7833309
	speed: 0.0384s/iter; left time: 1406.7927s
Epoch: 1 cost time: 16.755157947540283
Epoch: 1, Steps: 369 | Train Loss: 0.799 Vali Loss: 1.000 Vali Acc: 0.653 Test Loss: 1.000 Test Acc: 0.653
Validation loss decreased (inf --> -0.653225).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9956517
	speed: 0.2261s/iter; left time: 8238.2600s
	iters: 200, epoch: 2 | loss: 0.3851411
	speed: 0.0486s/iter; left time: 1764.8878s
	iters: 300, epoch: 2 | loss: 0.8826579
	speed: 0.0502s/iter; left time: 1819.6269s
Epoch: 2 cost time: 19.183452129364014
Epoch: 2, Steps: 369 | Train Loss: 0.840 Vali Loss: 1.073 Vali Acc: 0.654 Test Loss: 1.073 Test Acc: 0.654
Validation loss decreased (-0.653225 --> -0.653792).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7601098
	speed: 0.2376s/iter; left time: 8568.9880s
	iters: 200, epoch: 3 | loss: 0.4473413
	speed: 0.0497s/iter; left time: 1788.6358s
	iters: 300, epoch: 3 | loss: 0.6803415
	speed: 0.0504s/iter; left time: 1808.7642s
Epoch: 3 cost time: 19.300185680389404
Epoch: 3, Steps: 369 | Train Loss: 0.913 Vali Loss: 1.730 Vali Acc: 0.639 Test Loss: 1.730 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1242691
	speed: 0.2311s/iter; left time: 8249.3349s
	iters: 200, epoch: 4 | loss: 2.1960754
	speed: 0.0497s/iter; left time: 1768.2418s
	iters: 300, epoch: 4 | loss: 0.7496725
	speed: 0.0495s/iter; left time: 1756.9452s
Epoch: 4 cost time: 19.181551694869995
Epoch: 4, Steps: 369 | Train Loss: 0.886 Vali Loss: 2.042 Vali Acc: 0.648 Test Loss: 2.042 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4223036
	speed: 0.2225s/iter; left time: 7858.4962s
	iters: 200, epoch: 5 | loss: 0.3096991
	speed: 0.0392s/iter; left time: 1379.5133s
	iters: 300, epoch: 5 | loss: 1.0720989
	speed: 0.0398s/iter; left time: 1396.8414s
Epoch: 5 cost time: 15.3626868724823
Epoch: 5, Steps: 369 | Train Loss: 0.783 Vali Loss: 1.937 Vali Acc: 0.645 Test Loss: 1.937 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3022535
	speed: 0.1937s/iter; left time: 6770.8631s
	iters: 200, epoch: 6 | loss: 0.7615328
	speed: 0.0411s/iter; left time: 1434.1676s
	iters: 300, epoch: 6 | loss: 0.0393346
	speed: 0.0411s/iter; left time: 1427.1273s
Epoch: 6 cost time: 15.846802711486816
Epoch: 6, Steps: 369 | Train Loss: 0.669 Vali Loss: 1.929 Vali Acc: 0.626 Test Loss: 1.929 Test Acc: 0.626
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1547967
	speed: 0.1941s/iter; left time: 6714.7411s
	iters: 200, epoch: 7 | loss: 0.3569492
	speed: 0.0409s/iter; left time: 1412.0082s
	iters: 300, epoch: 7 | loss: 0.2613914
	speed: 0.0395s/iter; left time: 1359.2136s
Epoch: 7 cost time: 15.176713466644287
Epoch: 7, Steps: 369 | Train Loss: 0.531 Vali Loss: 1.946 Vali Acc: 0.656 Test Loss: 1.946 Test Acc: 0.656
Validation loss decreased (-0.653792 --> -0.656053).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2631426
	speed: 0.1922s/iter; left time: 6577.4762s
	iters: 200, epoch: 8 | loss: 0.1635195
	speed: 0.0391s/iter; left time: 1335.4363s
	iters: 300, epoch: 8 | loss: 0.0441046
	speed: 0.0379s/iter; left time: 1289.6588s
Epoch: 8 cost time: 15.064687013626099
Epoch: 8, Steps: 369 | Train Loss: 0.415 Vali Loss: 1.614 Vali Acc: 0.640 Test Loss: 1.614 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0527446
	speed: 0.1970s/iter; left time: 6669.4669s
	iters: 200, epoch: 9 | loss: 0.7819381
	speed: 0.0514s/iter; left time: 1734.3111s
	iters: 300, epoch: 9 | loss: 0.9011254
	speed: 0.0512s/iter; left time: 1721.5836s
Epoch: 9 cost time: 19.018149614334106
Epoch: 9, Steps: 369 | Train Loss: 0.314 Vali Loss: 1.685 Vali Acc: 0.647 Test Loss: 1.685 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1394329
	speed: 0.2321s/iter; left time: 7770.7152s
	iters: 200, epoch: 10 | loss: 0.2703447
	speed: 0.0494s/iter; left time: 1647.5678s
	iters: 300, epoch: 10 | loss: 0.3487886
	speed: 0.0480s/iter; left time: 1598.3806s
Epoch: 10 cost time: 18.87054467201233
Epoch: 10, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.686 Vali Acc: 0.643 Test Loss: 1.686 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2408001
	speed: 0.2337s/iter; left time: 7739.2030s
	iters: 200, epoch: 11 | loss: 0.1751382
	speed: 0.0485s/iter; left time: 1602.3275s
	iters: 300, epoch: 11 | loss: 0.0234953
	speed: 0.0495s/iter; left time: 1627.5121s
Epoch: 11 cost time: 19.062622547149658
Epoch: 11, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.596 Vali Acc: 0.635 Test Loss: 1.596 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0283038
	speed: 0.2387s/iter; left time: 7815.0681s
	iters: 200, epoch: 12 | loss: 0.0429667
	speed: 0.0499s/iter; left time: 1629.3849s
	iters: 300, epoch: 12 | loss: 0.0307209
	speed: 0.0502s/iter; left time: 1635.0290s
Epoch: 12 cost time: 19.390934944152832
Epoch: 12, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.614 Vali Acc: 0.652 Test Loss: 1.614 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1421616
	speed: 0.1970s/iter; left time: 6376.4450s
	iters: 200, epoch: 13 | loss: 0.1435686
	speed: 0.0396s/iter; left time: 1278.3398s
	iters: 300, epoch: 13 | loss: 0.0204966
	speed: 0.0385s/iter; left time: 1238.5549s
Epoch: 13 cost time: 15.366482734680176
Epoch: 13, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.705 Vali Acc: 0.640 Test Loss: 1.705 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0277980
	speed: 0.1894s/iter; left time: 6062.2461s
	iters: 200, epoch: 14 | loss: 0.0970231
	speed: 0.0412s/iter; left time: 1314.8910s
	iters: 300, epoch: 14 | loss: 0.1249865
	speed: 0.0401s/iter; left time: 1274.2316s
Epoch: 14 cost time: 15.486324548721313
Epoch: 14, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.723 Vali Acc: 0.650 Test Loss: 1.723 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1406378
	speed: 0.1937s/iter; left time: 6127.0676s
	iters: 200, epoch: 15 | loss: 0.0075024
	speed: 0.0397s/iter; left time: 1250.6664s
	iters: 300, epoch: 15 | loss: 0.0145653
	speed: 0.0392s/iter; left time: 1231.8894s
Epoch: 15 cost time: 15.351973533630371
Epoch: 15, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.788 Vali Acc: 0.642 Test Loss: 1.788 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0513935
	speed: 0.1989s/iter; left time: 6218.0470s
	iters: 200, epoch: 16 | loss: 0.0252469
	speed: 0.0405s/iter; left time: 1260.7886s
	iters: 300, epoch: 16 | loss: 0.3487017
	speed: 0.0396s/iter; left time: 1231.2704s
Epoch: 16 cost time: 15.4696044921875
Epoch: 16, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.867 Vali Acc: 0.640 Test Loss: 1.867 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0180477
	speed: 0.2208s/iter; left time: 6820.8692s
	iters: 200, epoch: 17 | loss: 0.0154958
	speed: 0.0507s/iter; left time: 1562.5578s
	iters: 300, epoch: 17 | loss: 0.1671871
	speed: 0.0498s/iter; left time: 1527.5160s
Epoch: 17 cost time: 19.29572558403015
Epoch: 17, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.898 Vali Acc: 0.649 Test Loss: 1.898 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.656072644721907
model parameter : 103202
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.2169056
	speed: 0.2538s/iter; left time: 9341.1941s
	iters: 200, epoch: 1 | loss: 1.5832757
	speed: 0.2063s/iter; left time: 7571.8325s
	iters: 300, epoch: 1 | loss: 1.7303777
	speed: 0.1877s/iter; left time: 6868.4494s
Epoch: 1 cost time: 77.42353582382202
Epoch: 1, Steps: 369 | Train Loss: 1.722 Vali Loss: 1.194 Vali Acc: 0.648 Test Loss: 1.194 Test Acc: 0.648
Validation loss decreased (inf --> -0.647548).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2061006
	speed: 0.6260s/iter; left time: 22805.3560s
	iters: 200, epoch: 2 | loss: 3.7517550
	speed: 0.1709s/iter; left time: 6210.7890s
	iters: 300, epoch: 2 | loss: 1.4710224
	speed: 0.1682s/iter; left time: 6092.5763s
Epoch: 2 cost time: 64.4701132774353
Epoch: 2, Steps: 369 | Train Loss: 2.468 Vali Loss: 2.428 Vali Acc: 0.652 Test Loss: 2.428 Test Acc: 0.652
Validation loss decreased (-0.647548 --> -0.652359).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6497390
	speed: 0.7593s/iter; left time: 27382.4190s
	iters: 200, epoch: 3 | loss: 3.2652922
	speed: 0.2273s/iter; left time: 8175.2132s
	iters: 300, epoch: 3 | loss: 0.6098063
	speed: 0.2324s/iter; left time: 8333.9091s
Epoch: 3 cost time: 85.2543113231659
Epoch: 3, Steps: 369 | Train Loss: 2.985 Vali Loss: 2.741 Vali Acc: 0.648 Test Loss: 2.741 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6062241
	speed: 0.7151s/iter; left time: 25523.8154s
	iters: 200, epoch: 4 | loss: 4.8880816
	speed: 0.1795s/iter; left time: 6390.7802s
	iters: 300, epoch: 4 | loss: 0.5839099
	speed: 0.1725s/iter; left time: 6124.0790s
Epoch: 4 cost time: 66.68734097480774
Epoch: 4, Steps: 369 | Train Loss: 3.151 Vali Loss: 4.761 Vali Acc: 0.621 Test Loss: 4.761 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2643249
	speed: 0.6816s/iter; left time: 24077.5089s
	iters: 200, epoch: 5 | loss: 1.3893850
	speed: 0.2193s/iter; left time: 7726.0242s
	iters: 300, epoch: 5 | loss: 1.4965984
	speed: 0.2219s/iter; left time: 7795.0530s
Epoch: 5 cost time: 81.52278351783752
Epoch: 5, Steps: 369 | Train Loss: 2.627 Vali Loss: 6.825 Vali Acc: 0.624 Test Loss: 6.825 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7388595
	speed: 0.7580s/iter; left time: 26496.9018s
	iters: 200, epoch: 6 | loss: 2.1004636
	speed: 0.1636s/iter; left time: 5701.9611s
	iters: 300, epoch: 6 | loss: 1.1208483
	speed: 0.1697s/iter; left time: 5899.5643s
Epoch: 6 cost time: 66.95819592475891
Epoch: 6, Steps: 369 | Train Loss: 1.956 Vali Loss: 3.641 Vali Acc: 0.637 Test Loss: 3.641 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0040501
	speed: 0.6409s/iter; left time: 22168.0083s
	iters: 200, epoch: 7 | loss: 0.0046883
	speed: 0.1783s/iter; left time: 6150.2103s
	iters: 300, epoch: 7 | loss: 1.4643117
	speed: 0.1957s/iter; left time: 6729.0623s
Epoch: 7 cost time: 72.11549758911133
Epoch: 7, Steps: 369 | Train Loss: 1.022 Vali Loss: 3.707 Vali Acc: 0.634 Test Loss: 3.707 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.5340065
	speed: 0.8085s/iter; left time: 27666.6568s
	iters: 200, epoch: 8 | loss: 1.4576873
	speed: 0.2309s/iter; left time: 7877.4349s
	iters: 300, epoch: 8 | loss: 0.4764056
	speed: 0.2327s/iter; left time: 7914.4617s
Epoch: 8 cost time: 84.15267300605774
Epoch: 8, Steps: 369 | Train Loss: 0.487 Vali Loss: 3.404 Vali Acc: 0.634 Test Loss: 3.404 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0510977
	speed: 0.6713s/iter; left time: 22722.3689s
	iters: 200, epoch: 9 | loss: 0.1206742
	speed: 0.1709s/iter; left time: 5767.9818s
	iters: 300, epoch: 9 | loss: 0.4628887
	speed: 0.1687s/iter; left time: 5676.6404s
Epoch: 9 cost time: 64.60271692276001
Epoch: 9, Steps: 369 | Train Loss: 0.246 Vali Loss: 2.669 Vali Acc: 0.632 Test Loss: 2.669 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1336740
	speed: 0.7010s/iter; left time: 23467.8888s
	iters: 200, epoch: 10 | loss: 0.0990631
	speed: 0.2205s/iter; left time: 7358.9347s
	iters: 300, epoch: 10 | loss: 0.1105262
	speed: 0.2224s/iter; left time: 7402.0961s
Epoch: 10 cost time: 82.40002298355103
Epoch: 10, Steps: 369 | Train Loss: 0.159 Vali Loss: 2.242 Vali Acc: 0.642 Test Loss: 2.242 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0324571
	speed: 0.7743s/iter; left time: 25637.6285s
	iters: 200, epoch: 11 | loss: 0.0033396
	speed: 0.1837s/iter; left time: 6064.0524s
	iters: 300, epoch: 11 | loss: 0.0236209
	speed: 0.1875s/iter; left time: 6171.5685s
Epoch: 11 cost time: 69.36228823661804
Epoch: 11, Steps: 369 | Train Loss: 0.111 Vali Loss: 2.067 Vali Acc: 0.640 Test Loss: 2.067 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2714176
	speed: 0.6624s/iter; left time: 21688.3105s
	iters: 200, epoch: 12 | loss: 0.0159402
	speed: 0.1923s/iter; left time: 6275.5484s
	iters: 300, epoch: 12 | loss: 0.0000486
	speed: 0.2331s/iter; left time: 7585.8670s
Epoch: 12 cost time: 77.32557940483093
Epoch: 12, Steps: 369 | Train Loss: 0.090 Vali Loss: 2.126 Vali Acc: 0.618 Test Loss: 2.126 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6523836549375709
model parameter : 597154
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4133120
	speed: 0.1223s/iter; left time: 4499.0167s
	iters: 200, epoch: 1 | loss: 1.7616504
	speed: 0.0914s/iter; left time: 3352.6790s
	iters: 300, epoch: 1 | loss: 2.4309297
	speed: 0.0947s/iter; left time: 3467.1795s
Epoch: 1 cost time: 37.422895193099976
Epoch: 1, Steps: 369 | Train Loss: 1.293 Vali Loss: 1.325 Vali Acc: 0.632 Test Loss: 1.325 Test Acc: 0.632
Validation loss decreased (inf --> -0.631655).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1610472
	speed: 0.3735s/iter; left time: 13608.9557s
	iters: 200, epoch: 2 | loss: 1.1676707
	speed: 0.0895s/iter; left time: 3252.5440s
	iters: 300, epoch: 2 | loss: 1.3244417
	speed: 0.0861s/iter; left time: 3121.1017s
Epoch: 2 cost time: 34.42424464225769
Epoch: 2, Steps: 369 | Train Loss: 1.647 Vali Loss: 1.912 Vali Acc: 0.664 Test Loss: 1.912 Test Acc: 0.664
Validation loss decreased (-0.631655 --> -0.663999).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0764611
	speed: 0.4191s/iter; left time: 15112.3313s
	iters: 200, epoch: 3 | loss: 0.9256362
	speed: 0.1278s/iter; left time: 4594.3074s
	iters: 300, epoch: 3 | loss: 2.0505326
	speed: 0.1309s/iter; left time: 4695.1803s
Epoch: 3 cost time: 48.84540629386902
Epoch: 3, Steps: 369 | Train Loss: 2.043 Vali Loss: 2.695 Vali Acc: 0.635 Test Loss: 2.695 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1807010
	speed: 0.4733s/iter; left time: 16894.4191s
	iters: 200, epoch: 4 | loss: 3.9327519
	speed: 0.1306s/iter; left time: 4647.4609s
	iters: 300, epoch: 4 | loss: 2.2224665
	speed: 0.1321s/iter; left time: 4687.5799s
Epoch: 4 cost time: 49.06302189826965
Epoch: 4, Steps: 369 | Train Loss: 1.938 Vali Loss: 3.996 Vali Acc: 0.650 Test Loss: 3.996 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.7436314
	speed: 0.4035s/iter; left time: 14254.1484s
	iters: 200, epoch: 5 | loss: 2.3309515
	speed: 0.0985s/iter; left time: 3469.6861s
	iters: 300, epoch: 5 | loss: 0.4785028
	speed: 0.0907s/iter; left time: 3187.0764s
Epoch: 5 cost time: 36.262805461883545
Epoch: 5, Steps: 369 | Train Loss: 1.693 Vali Loss: 3.644 Vali Acc: 0.634 Test Loss: 3.644 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2952271
	speed: 0.3697s/iter; left time: 12922.3878s
	iters: 200, epoch: 6 | loss: 1.7886245
	speed: 0.0986s/iter; left time: 3438.1619s
	iters: 300, epoch: 6 | loss: 0.2467600
	speed: 0.0961s/iter; left time: 3340.0671s
Epoch: 6 cost time: 36.07165861129761
Epoch: 6, Steps: 369 | Train Loss: 1.246 Vali Loss: 3.978 Vali Acc: 0.638 Test Loss: 3.978 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2831779
	speed: 0.4415s/iter; left time: 15268.7837s
	iters: 200, epoch: 7 | loss: 0.0172401
	speed: 0.1283s/iter; left time: 4426.1612s
	iters: 300, epoch: 7 | loss: 1.2850643
	speed: 0.1278s/iter; left time: 4393.6053s
Epoch: 7 cost time: 48.22110986709595
Epoch: 7, Steps: 369 | Train Loss: 0.766 Vali Loss: 3.373 Vali Acc: 0.641 Test Loss: 3.373 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1883759
	speed: 0.4808s/iter; left time: 16452.3375s
	iters: 200, epoch: 8 | loss: 0.1032690
	speed: 0.1278s/iter; left time: 4361.8801s
	iters: 300, epoch: 8 | loss: 0.8685726
	speed: 0.1177s/iter; left time: 4002.7899s
Epoch: 8 cost time: 44.9844925403595
Epoch: 8, Steps: 369 | Train Loss: 0.517 Vali Loss: 2.642 Vali Acc: 0.639 Test Loss: 2.642 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7877844
	speed: 0.3759s/iter; left time: 12723.1960s
	iters: 200, epoch: 9 | loss: 0.8721931
	speed: 0.0957s/iter; left time: 3229.2088s
	iters: 300, epoch: 9 | loss: 0.1871828
	speed: 0.0968s/iter; left time: 3257.1725s
Epoch: 9 cost time: 35.58052945137024
Epoch: 9, Steps: 369 | Train Loss: 0.295 Vali Loss: 2.353 Vali Acc: 0.630 Test Loss: 2.353 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2354115
	speed: 0.3939s/iter; left time: 13186.6224s
	iters: 200, epoch: 10 | loss: 0.0730153
	speed: 0.0958s/iter; left time: 3199.0733s
	iters: 300, epoch: 10 | loss: 0.2140352
	speed: 0.0979s/iter; left time: 3257.5912s
Epoch: 10 cost time: 36.834375858306885
Epoch: 10, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.919 Vali Acc: 0.636 Test Loss: 1.919 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0436376
	speed: 0.4384s/iter; left time: 14516.2726s
	iters: 200, epoch: 11 | loss: 0.0196968
	speed: 0.0644s/iter; left time: 2125.7513s
	iters: 300, epoch: 11 | loss: 0.1132603
	speed: 0.0649s/iter; left time: 2134.9458s
Epoch: 11 cost time: 29.920257806777954
Epoch: 11, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.885 Vali Acc: 0.646 Test Loss: 1.885 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0772246
	speed: 0.3661s/iter; left time: 11988.2556s
	iters: 200, epoch: 12 | loss: 0.0068550
	speed: 0.1250s/iter; left time: 4078.6303s
	iters: 300, epoch: 12 | loss: 0.0866208
	speed: 0.1251s/iter; left time: 4069.8500s
Epoch: 12 cost time: 46.9659423828125
Epoch: 12, Steps: 369 | Train Loss: 0.074 Vali Loss: 2.005 Vali Acc: 0.642 Test Loss: 2.005 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6640181611804767
model parameter : 311522
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7826621
	speed: 0.0912s/iter; left time: 3355.0121s
	iters: 200, epoch: 1 | loss: 1.0600319
	speed: 0.0751s/iter; left time: 2756.1512s
	iters: 300, epoch: 1 | loss: 0.1713850
	speed: 0.0737s/iter; left time: 2696.5330s
Epoch: 1 cost time: 29.33610200881958
Epoch: 1, Steps: 369 | Train Loss: 1.103 Vali Loss: 0.916 Vali Acc: 0.640 Test Loss: 0.916 Test Acc: 0.640
Validation loss decreased (inf --> -0.639605).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4144516
	speed: 0.3134s/iter; left time: 11418.0072s
	iters: 200, epoch: 2 | loss: 1.3662534
	speed: 0.0993s/iter; left time: 3608.4036s
	iters: 300, epoch: 2 | loss: 1.3027568
	speed: 0.1012s/iter; left time: 3668.0853s
Epoch: 2 cost time: 34.94650626182556
Epoch: 2, Steps: 369 | Train Loss: 1.357 Vali Loss: 1.407 Vali Acc: 0.645 Test Loss: 1.407 Test Acc: 0.645
Validation loss decreased (-0.639605 --> -0.644708).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3655887
	speed: 0.4160s/iter; left time: 15002.7981s
	iters: 200, epoch: 3 | loss: 1.5108447
	speed: 0.1021s/iter; left time: 3672.2700s
	iters: 300, epoch: 3 | loss: 1.1571468
	speed: 0.1034s/iter; left time: 3707.2098s
Epoch: 3 cost time: 38.86096668243408
Epoch: 3, Steps: 369 | Train Loss: 1.711 Vali Loss: 2.241 Vali Acc: 0.644 Test Loss: 2.241 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1879764
	speed: 0.3543s/iter; left time: 12645.2756s
	iters: 200, epoch: 4 | loss: 4.5575438
	speed: 0.0753s/iter; left time: 2679.8144s
	iters: 300, epoch: 4 | loss: 1.7873894
	speed: 0.0769s/iter; left time: 2729.9363s
Epoch: 4 cost time: 28.76569366455078
Epoch: 4, Steps: 369 | Train Loss: 1.684 Vali Loss: 2.124 Vali Acc: 0.630 Test Loss: 2.124 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0073802
	speed: 0.3262s/iter; left time: 11523.1854s
	iters: 200, epoch: 5 | loss: 1.0874363
	speed: 0.0746s/iter; left time: 2628.8871s
	iters: 300, epoch: 5 | loss: 0.3545552
	speed: 0.0777s/iter; left time: 2730.2255s
Epoch: 5 cost time: 28.449605703353882
Epoch: 5, Steps: 369 | Train Loss: 1.431 Vali Loss: 2.780 Vali Acc: 0.646 Test Loss: 2.780 Test Acc: 0.646
Validation loss decreased (-0.644708 --> -0.646113).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4840674
	speed: 0.3956s/iter; left time: 13830.3093s
	iters: 200, epoch: 6 | loss: 0.1126381
	speed: 0.1025s/iter; left time: 3572.0546s
	iters: 300, epoch: 6 | loss: 0.5080436
	speed: 0.1031s/iter; left time: 3582.0029s
Epoch: 6 cost time: 38.8911566734314
Epoch: 6, Steps: 369 | Train Loss: 1.130 Vali Loss: 2.757 Vali Acc: 0.623 Test Loss: 2.757 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3609145
	speed: 0.4134s/iter; left time: 14298.8533s
	iters: 200, epoch: 7 | loss: 1.3788184
	speed: 0.0712s/iter; left time: 2455.9854s
	iters: 300, epoch: 7 | loss: 0.7273542
	speed: 0.0715s/iter; left time: 2457.0756s
Epoch: 7 cost time: 30.63936686515808
Epoch: 7, Steps: 369 | Train Loss: 0.697 Vali Loss: 2.136 Vali Acc: 0.634 Test Loss: 2.136 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0558728
	speed: 0.3206s/iter; left time: 10969.9361s
	iters: 200, epoch: 8 | loss: 0.7805163
	speed: 0.0724s/iter; left time: 2470.3113s
	iters: 300, epoch: 8 | loss: 0.6342310
	speed: 0.0722s/iter; left time: 2455.1173s
Epoch: 8 cost time: 26.930095911026
Epoch: 8, Steps: 369 | Train Loss: 0.393 Vali Loss: 1.720 Vali Acc: 0.652 Test Loss: 1.720 Test Acc: 0.652
Validation loss decreased (-0.646113 --> -0.651515).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0317302
	speed: 0.3282s/iter; left time: 11109.3069s
	iters: 200, epoch: 9 | loss: 0.0065297
	speed: 0.0984s/iter; left time: 3319.9651s
	iters: 300, epoch: 9 | loss: 0.1233738
	speed: 0.1038s/iter; left time: 3491.7653s
Epoch: 9 cost time: 35.60870814323425
Epoch: 9, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.635 Vali Acc: 0.636 Test Loss: 1.635 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2191646
	speed: 0.4327s/iter; left time: 14485.4385s
	iters: 200, epoch: 10 | loss: 0.0862664
	speed: 0.1030s/iter; left time: 3439.0250s
	iters: 300, epoch: 10 | loss: 0.0489487
	speed: 0.1022s/iter; left time: 3400.7957s
Epoch: 10 cost time: 39.08844542503357
Epoch: 10, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.675 Vali Acc: 0.634 Test Loss: 1.675 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0301763
	speed: 0.3639s/iter; left time: 12048.9718s
	iters: 200, epoch: 11 | loss: 0.0622111
	speed: 0.0723s/iter; left time: 2386.9916s
	iters: 300, epoch: 11 | loss: 0.0287020
	speed: 0.0717s/iter; left time: 2360.2393s
Epoch: 11 cost time: 28.180981874465942
Epoch: 11, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.634 Vali Acc: 0.643 Test Loss: 1.634 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0028398
	speed: 0.3302s/iter; left time: 10809.8958s
	iters: 200, epoch: 12 | loss: 0.0070005
	speed: 0.0760s/iter; left time: 2481.5919s
	iters: 300, epoch: 12 | loss: 0.0188896
	speed: 0.0763s/iter; left time: 2481.7147s
Epoch: 12 cost time: 29.027830600738525
Epoch: 12, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.739 Vali Acc: 0.639 Test Loss: 1.739 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0064696
	speed: 0.4034s/iter; left time: 13059.1875s
	iters: 200, epoch: 13 | loss: 0.1301426
	speed: 0.1068s/iter; left time: 3445.8756s
	iters: 300, epoch: 13 | loss: 0.0564859
	speed: 0.1059s/iter; left time: 3407.6258s
Epoch: 13 cost time: 39.71376442909241
Epoch: 13, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.942 Vali Acc: 0.633 Test Loss: 1.942 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0152207
	speed: 0.4094s/iter; left time: 13101.1032s
	iters: 200, epoch: 14 | loss: 0.0824644
	speed: 0.0724s/iter; left time: 2310.2191s
	iters: 300, epoch: 14 | loss: 0.3006670
	speed: 0.0705s/iter; left time: 2242.6641s
Epoch: 14 cost time: 30.201557636260986
Epoch: 14, Steps: 369 | Train Loss: 0.080 Vali Loss: 1.997 Vali Acc: 0.635 Test Loss: 1.997 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0186367
	speed: 0.3200s/iter; left time: 10123.5316s
	iters: 200, epoch: 15 | loss: 0.0120652
	speed: 0.0712s/iter; left time: 2245.5115s
	iters: 300, epoch: 15 | loss: 0.0383065
	speed: 0.0702s/iter; left time: 2206.9799s
Epoch: 15 cost time: 26.51157259941101
Epoch: 15, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.086 Vali Acc: 0.630 Test Loss: 2.086 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0432540
	speed: 0.3218s/iter; left time: 10060.5605s
	iters: 200, epoch: 16 | loss: 0.0666408
	speed: 0.0994s/iter; left time: 3097.1670s
	iters: 300, epoch: 16 | loss: 0.2128149
	speed: 0.1037s/iter; left time: 3221.3919s
Epoch: 16 cost time: 35.82485485076904
Epoch: 16, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.092 Vali Acc: 0.638 Test Loss: 2.092 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0048805
	speed: 0.4270s/iter; left time: 13193.6205s
	iters: 200, epoch: 17 | loss: 0.0097543
	speed: 0.1021s/iter; left time: 3144.7459s
	iters: 300, epoch: 17 | loss: 0.0447691
	speed: 0.1034s/iter; left time: 3174.4712s
Epoch: 17 cost time: 39.11067509651184
Epoch: 17, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.229 Vali Acc: 0.633 Test Loss: 2.229 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1220329
	speed: 0.3543s/iter; left time: 10817.3214s
	iters: 200, epoch: 18 | loss: 0.0401868
	speed: 0.0725s/iter; left time: 2204.6048s
	iters: 300, epoch: 18 | loss: 0.0079516
	speed: 0.0706s/iter; left time: 2139.8681s
Epoch: 18 cost time: 27.35926651954651
Epoch: 18, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.308 Vali Acc: 0.641 Test Loss: 2.308 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6515323496027242
model parameter : 219394
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9651572
	speed: 0.1084s/iter; left time: 3988.1861s
	iters: 200, epoch: 1 | loss: 0.9554464
	speed: 0.0887s/iter; left time: 3254.0654s
	iters: 300, epoch: 1 | loss: 0.7310228
	speed: 0.0869s/iter; left time: 3181.9189s
Epoch: 1 cost time: 34.71371364593506
Epoch: 1, Steps: 369 | Train Loss: 0.969 Vali Loss: 1.000 Vali Acc: 0.635 Test Loss: 1.000 Test Acc: 0.635
Validation loss decreased (inf --> -0.634496).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9539100
	speed: 0.3415s/iter; left time: 12440.8986s
	iters: 200, epoch: 2 | loss: 0.9670489
	speed: 0.0804s/iter; left time: 2922.1679s
	iters: 300, epoch: 2 | loss: 1.8059086
	speed: 0.0551s/iter; left time: 1996.9880s
Epoch: 2 cost time: 27.27066731452942
Epoch: 2, Steps: 369 | Train Loss: 1.177 Vali Loss: 1.562 Vali Acc: 0.655 Test Loss: 1.562 Test Acc: 0.655
Validation loss decreased (-0.634496 --> -0.655206).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7517414
	speed: 0.2538s/iter; left time: 9153.8855s
	iters: 200, epoch: 3 | loss: 1.6026864
	speed: 0.0551s/iter; left time: 1980.8417s
	iters: 300, epoch: 3 | loss: 0.3696722
	speed: 0.0529s/iter; left time: 1896.3719s
Epoch: 3 cost time: 21.09002137184143
Epoch: 3, Steps: 369 | Train Loss: 1.394 Vali Loss: 1.973 Vali Acc: 0.629 Test Loss: 1.973 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3938430
	speed: 0.2505s/iter; left time: 8941.5451s
	iters: 200, epoch: 4 | loss: 1.2586069
	speed: 0.0530s/iter; left time: 1886.9066s
	iters: 300, epoch: 4 | loss: 2.4491005
	speed: 0.0573s/iter; left time: 2032.8588s
Epoch: 4 cost time: 21.530710220336914
Epoch: 4, Steps: 369 | Train Loss: 1.376 Vali Loss: 2.497 Vali Acc: 0.644 Test Loss: 2.497 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7298276
	speed: 0.3291s/iter; left time: 11624.4191s
	iters: 200, epoch: 5 | loss: 0.0838923
	speed: 0.0875s/iter; left time: 3081.0357s
	iters: 300, epoch: 5 | loss: 1.4573424
	speed: 0.0884s/iter; left time: 3104.3475s
Epoch: 5 cost time: 33.553783655166626
Epoch: 5, Steps: 369 | Train Loss: 1.131 Vali Loss: 2.462 Vali Acc: 0.630 Test Loss: 2.462 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.7158792
	speed: 0.3586s/iter; left time: 12534.0103s
	iters: 200, epoch: 6 | loss: 0.4308644
	speed: 0.0682s/iter; left time: 2377.1355s
	iters: 300, epoch: 6 | loss: 1.9498274
	speed: 0.0587s/iter; left time: 2041.7887s
Epoch: 6 cost time: 26.75374746322632
Epoch: 6, Steps: 369 | Train Loss: 0.962 Vali Loss: 2.789 Vali Acc: 0.631 Test Loss: 2.789 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2340095
	speed: 0.2681s/iter; left time: 9274.0076s
	iters: 200, epoch: 7 | loss: 1.1928374
	speed: 0.0564s/iter; left time: 1945.4481s
	iters: 300, epoch: 7 | loss: 1.6257758
	speed: 0.0559s/iter; left time: 1922.9828s
Epoch: 7 cost time: 21.50256037712097
Epoch: 7, Steps: 369 | Train Loss: 0.638 Vali Loss: 2.411 Vali Acc: 0.635 Test Loss: 2.411 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1996117
	speed: 0.2675s/iter; left time: 9154.9937s
	iters: 200, epoch: 8 | loss: 0.3366735
	speed: 0.0554s/iter; left time: 1889.8506s
	iters: 300, epoch: 8 | loss: 0.2062088
	speed: 0.0565s/iter; left time: 1922.1991s
Epoch: 8 cost time: 23.86271905899048
Epoch: 8, Steps: 369 | Train Loss: 0.396 Vali Loss: 2.189 Vali Acc: 0.629 Test Loss: 2.189 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.5786467
	speed: 0.3637s/iter; left time: 12311.6410s
	iters: 200, epoch: 9 | loss: 0.3182729
	speed: 0.0877s/iter; left time: 2958.2343s
	iters: 300, epoch: 9 | loss: 0.4618137
	speed: 0.0856s/iter; left time: 2879.2208s
Epoch: 9 cost time: 32.858877182006836
Epoch: 9, Steps: 369 | Train Loss: 0.290 Vali Loss: 1.747 Vali Acc: 0.636 Test Loss: 1.747 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0100462
	speed: 0.3305s/iter; left time: 11063.5973s
	iters: 200, epoch: 10 | loss: 0.0946002
	speed: 0.0602s/iter; left time: 2009.5822s
	iters: 300, epoch: 10 | loss: 0.3248197
	speed: 0.0582s/iter; left time: 1938.5549s
Epoch: 10 cost time: 23.16541361808777
Epoch: 10, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.631 Vali Acc: 0.638 Test Loss: 1.631 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.3367641
	speed: 0.2700s/iter; left time: 8939.6205s
	iters: 200, epoch: 11 | loss: 0.0737474
	speed: 0.0564s/iter; left time: 1860.4938s
	iters: 300, epoch: 11 | loss: 0.4011530
	speed: 0.0559s/iter; left time: 1839.4065s
Epoch: 11 cost time: 21.696362257003784
Epoch: 11, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.574 Vali Acc: 0.628 Test Loss: 1.574 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.3792301
	speed: 0.2716s/iter; left time: 8891.3365s
	iters: 200, epoch: 12 | loss: 0.0365927
	speed: 0.0575s/iter; left time: 1875.4518s
	iters: 300, epoch: 12 | loss: 0.0511956
	speed: 0.0691s/iter; left time: 2247.5855s
Epoch: 12 cost time: 25.00141453742981
Epoch: 12, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.869 Vali Acc: 0.638 Test Loss: 1.869 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6552213393870602
model parameter : 164162
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5730252
	speed: 0.0709s/iter; left time: 2609.1293s
	iters: 200, epoch: 1 | loss: 2.0028527
	speed: 0.0453s/iter; left time: 1663.4099s
	iters: 300, epoch: 1 | loss: 0.9282688
	speed: 0.0451s/iter; left time: 1649.3599s
Epoch: 1 cost time: 19.42678427696228
Epoch: 1, Steps: 369 | Train Loss: 0.926 Vali Loss: 1.045 Vali Acc: 0.639 Test Loss: 1.045 Test Acc: 0.639
Validation loss decreased (inf --> -0.638752).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5595006
	speed: 0.2033s/iter; left time: 7408.4131s
	iters: 200, epoch: 2 | loss: 0.4852791
	speed: 0.0407s/iter; left time: 1477.6344s
	iters: 300, epoch: 2 | loss: 0.9688445
	speed: 0.0440s/iter; left time: 1594.6323s
Epoch: 2 cost time: 16.921706914901733
Epoch: 2, Steps: 369 | Train Loss: 1.018 Vali Loss: 1.033 Vali Acc: 0.640 Test Loss: 1.033 Test Acc: 0.640
Validation loss decreased (-0.638752 --> -0.639888).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3732156
	speed: 0.2022s/iter; left time: 7293.2589s
	iters: 200, epoch: 3 | loss: 1.9312452
	speed: 0.0418s/iter; left time: 1503.9922s
	iters: 300, epoch: 3 | loss: 1.9900959
	speed: 0.0405s/iter; left time: 1452.4309s
Epoch: 3 cost time: 16.119043111801147
Epoch: 3, Steps: 369 | Train Loss: 1.229 Vali Loss: 1.814 Vali Acc: 0.640 Test Loss: 1.814 Test Acc: 0.640
Validation loss decreased (-0.639888 --> -0.640447).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0465581
	speed: 0.2477s/iter; left time: 8842.2757s
	iters: 200, epoch: 4 | loss: 1.1072598
	speed: 0.0674s/iter; left time: 2398.3002s
	iters: 300, epoch: 4 | loss: 1.2783482
	speed: 0.0694s/iter; left time: 2463.0745s
Epoch: 4 cost time: 26.264760971069336
Epoch: 4, Steps: 369 | Train Loss: 1.200 Vali Loss: 2.565 Vali Acc: 0.623 Test Loss: 2.565 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8392010
	speed: 0.2912s/iter; left time: 10285.6407s
	iters: 200, epoch: 5 | loss: 0.9825494
	speed: 0.0721s/iter; left time: 2540.9268s
	iters: 300, epoch: 5 | loss: 1.1952840
	speed: 0.0675s/iter; left time: 2370.8743s
Epoch: 5 cost time: 26.449586153030396
Epoch: 5, Steps: 369 | Train Loss: 1.094 Vali Loss: 2.462 Vali Acc: 0.642 Test Loss: 2.462 Test Acc: 0.642
Validation loss decreased (-0.640447 --> -0.641576).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2747921
	speed: 0.2404s/iter; left time: 8403.8169s
	iters: 200, epoch: 6 | loss: 0.8903058
	speed: 0.0453s/iter; left time: 1578.7367s
	iters: 300, epoch: 6 | loss: 0.5242218
	speed: 0.0457s/iter; left time: 1589.0440s
Epoch: 6 cost time: 17.99407434463501
Epoch: 6, Steps: 369 | Train Loss: 0.792 Vali Loss: 2.261 Vali Acc: 0.645 Test Loss: 2.261 Test Acc: 0.645
Validation loss decreased (-0.641576 --> -0.645267).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1836206
	speed: 0.2250s/iter; left time: 7781.5674s
	iters: 200, epoch: 7 | loss: 0.3411990
	speed: 0.0478s/iter; left time: 1647.3089s
	iters: 300, epoch: 7 | loss: 1.3073280
	speed: 0.0483s/iter; left time: 1660.5657s
Epoch: 7 cost time: 18.540319681167603
Epoch: 7, Steps: 369 | Train Loss: 0.562 Vali Loss: 2.290 Vali Acc: 0.631 Test Loss: 2.290 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3048700
	speed: 0.2293s/iter; left time: 7844.9205s
	iters: 200, epoch: 8 | loss: 0.0270539
	speed: 0.0470s/iter; left time: 1602.3124s
	iters: 300, epoch: 8 | loss: 0.5040436
	speed: 0.0431s/iter; left time: 1464.5246s
Epoch: 8 cost time: 19.9013512134552
Epoch: 8, Steps: 369 | Train Loss: 0.451 Vali Loss: 1.893 Vali Acc: 0.620 Test Loss: 1.893 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6614515
	speed: 0.3038s/iter; left time: 10282.7252s
	iters: 200, epoch: 9 | loss: 0.4729305
	speed: 0.0713s/iter; left time: 2407.6305s
	iters: 300, epoch: 9 | loss: 0.4596809
	speed: 0.0729s/iter; left time: 2451.3490s
Epoch: 9 cost time: 27.91754913330078
Epoch: 9, Steps: 369 | Train Loss: 0.328 Vali Loss: 1.621 Vali Acc: 0.637 Test Loss: 1.621 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2615314
	speed: 0.3001s/iter; left time: 10046.7060s
	iters: 200, epoch: 10 | loss: 0.2336334
	speed: 0.0720s/iter; left time: 2404.7277s
	iters: 300, epoch: 10 | loss: 0.4111505
	speed: 0.0453s/iter; left time: 1506.6795s
Epoch: 10 cost time: 23.684675693511963
Epoch: 10, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.546 Vali Acc: 0.643 Test Loss: 1.546 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0060459
	speed: 0.2410s/iter; left time: 7978.3987s
	iters: 200, epoch: 11 | loss: 0.3119639
	speed: 0.0451s/iter; left time: 1490.3289s
	iters: 300, epoch: 11 | loss: 0.3786187
	speed: 0.0449s/iter; left time: 1476.9509s
Epoch: 11 cost time: 18.059892177581787
Epoch: 11, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.554 Vali Acc: 0.639 Test Loss: 1.554 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0238340
	speed: 0.2354s/iter; left time: 7706.0041s
	iters: 200, epoch: 12 | loss: 0.1860193
	speed: 0.0470s/iter; left time: 1535.7740s
	iters: 300, epoch: 12 | loss: 0.0951972
	speed: 0.0477s/iter; left time: 1552.1992s
Epoch: 12 cost time: 18.508742570877075
Epoch: 12, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.608 Vali Acc: 0.643 Test Loss: 1.608 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0025472
	speed: 0.2620s/iter; left time: 8482.5210s
	iters: 200, epoch: 13 | loss: 0.2119010
	speed: 0.0720s/iter; left time: 2324.8263s
	iters: 300, epoch: 13 | loss: 0.3722099
	speed: 0.0701s/iter; left time: 2256.8080s
Epoch: 13 cost time: 27.531941175460815
Epoch: 13, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.629 Vali Acc: 0.648 Test Loss: 1.629 Test Acc: 0.648
Validation loss decreased (-0.645267 --> -0.647827).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2127906
	speed: 0.3114s/iter; left time: 9965.0499s
	iters: 200, epoch: 14 | loss: 0.0078420
	speed: 0.0701s/iter; left time: 2235.6000s
	iters: 300, epoch: 14 | loss: 0.0769608
	speed: 0.0699s/iter; left time: 2221.6250s
Epoch: 14 cost time: 27.313416242599487
Epoch: 14, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.705 Vali Acc: 0.644 Test Loss: 1.705 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0152923
	speed: 0.2758s/iter; left time: 8725.5325s
	iters: 200, epoch: 15 | loss: 0.1085838
	speed: 0.0466s/iter; left time: 1469.3526s
	iters: 300, epoch: 15 | loss: 0.1856457
	speed: 0.0474s/iter; left time: 1490.6576s
Epoch: 15 cost time: 18.323805332183838
Epoch: 15, Steps: 369 | Train Loss: 0.081 Vali Loss: 1.854 Vali Acc: 0.639 Test Loss: 1.854 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1334265
	speed: 0.2587s/iter; left time: 8088.9301s
	iters: 200, epoch: 16 | loss: 0.0086874
	speed: 0.0412s/iter; left time: 1285.3274s
	iters: 300, epoch: 16 | loss: 0.0592933
	speed: 0.0461s/iter; left time: 1431.3604s
Epoch: 16 cost time: 17.2975435256958
Epoch: 16, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.051 Vali Acc: 0.642 Test Loss: 2.051 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0017308
	speed: 0.2401s/iter; left time: 7417.7136s
	iters: 200, epoch: 17 | loss: 0.0135291
	speed: 0.0457s/iter; left time: 1406.8583s
	iters: 300, epoch: 17 | loss: 0.3281007
	speed: 0.0475s/iter; left time: 1458.5894s
Epoch: 17 cost time: 18.569655418395996
Epoch: 17, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.932 Vali Acc: 0.640 Test Loss: 1.932 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0282052
	speed: 0.2938s/iter; left time: 8970.1125s
	iters: 200, epoch: 18 | loss: 0.0628396
	speed: 0.0724s/iter; left time: 2204.3128s
	iters: 300, epoch: 18 | loss: 0.0165324
	speed: 0.0745s/iter; left time: 2258.6011s
Epoch: 18 cost time: 31.17620038986206
Epoch: 18, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.106 Vali Acc: 0.643 Test Loss: 2.106 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0456158
	speed: 0.3743s/iter; left time: 11287.5897s
	iters: 200, epoch: 19 | loss: 0.1909636
	speed: 0.1098s/iter; left time: 3300.5254s
	iters: 300, epoch: 19 | loss: 0.0291123
	speed: 0.0836s/iter; left time: 2504.5107s
Epoch: 19 cost time: 35.40696358680725
Epoch: 19, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.230 Vali Acc: 0.636 Test Loss: 2.230 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0100180
	speed: 0.2956s/iter; left time: 8805.0927s
	iters: 200, epoch: 20 | loss: 0.0111202
	speed: 0.0497s/iter; left time: 1476.9050s
	iters: 300, epoch: 20 | loss: 0.0091005
	speed: 0.0774s/iter; left time: 2288.8167s
Epoch: 20 cost time: 25.0881986618042
Epoch: 20, Steps: 369 | Train Loss: 0.070 Vali Loss: 1.989 Vali Acc: 0.639 Test Loss: 1.989 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0043880
	speed: 0.3261s/iter; left time: 9594.7827s
	iters: 200, epoch: 21 | loss: 0.5838637
	speed: 0.0506s/iter; left time: 1483.1900s
	iters: 300, epoch: 21 | loss: 0.1170568
	speed: 0.0507s/iter; left time: 1482.7331s
Epoch: 21 cost time: 22.151761054992676
Epoch: 21, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.189 Vali Acc: 0.646 Test Loss: 2.189 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0847845
	speed: 0.2828s/iter; left time: 8214.4568s
	iters: 200, epoch: 22 | loss: 0.1844353
	speed: 0.0693s/iter; left time: 2006.5766s
	iters: 300, epoch: 22 | loss: 0.0073962
	speed: 0.0584s/iter; left time: 1685.3815s
Epoch: 22 cost time: 22.020092725753784
Epoch: 22, Steps: 369 | Train Loss: 0.063 Vali Loss: 2.186 Vali Acc: 0.636 Test Loss: 2.186 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0892149
	speed: 0.3065s/iter; left time: 8790.4446s
	iters: 200, epoch: 23 | loss: 0.4651164
	speed: 0.0641s/iter; left time: 1832.4647s
	iters: 300, epoch: 23 | loss: 0.0184646
	speed: 0.0465s/iter; left time: 1324.9208s
Epoch: 23 cost time: 24.236031532287598
Epoch: 23, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.274 Vali Acc: 0.631 Test Loss: 2.274 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6478433598183881
model parameter : 136610
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8416431
	speed: 0.0699s/iter; left time: 2572.2453s
	iters: 200, epoch: 1 | loss: 0.6583349
	speed: 0.0608s/iter; left time: 2232.3058s
	iters: 300, epoch: 1 | loss: 0.4720819
	speed: 0.0648s/iter; left time: 2371.0678s
Epoch: 1 cost time: 22.815614223480225
Epoch: 1, Steps: 369 | Train Loss: 0.866 Vali Loss: 1.108 Vali Acc: 0.607 Test Loss: 1.108 Test Acc: 0.607
Validation loss decreased (inf --> -0.606970).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6845103
	speed: 0.2595s/iter; left time: 9452.9299s
	iters: 200, epoch: 2 | loss: 0.8669095
	speed: 0.0414s/iter; left time: 1504.9442s
	iters: 300, epoch: 2 | loss: 0.9274616
	speed: 0.0391s/iter; left time: 1414.8818s
Epoch: 2 cost time: 18.21284031867981
Epoch: 2, Steps: 369 | Train Loss: 0.913 Vali Loss: 1.445 Vali Acc: 0.629 Test Loss: 1.445 Test Acc: 0.629
Validation loss decreased (-0.606970 --> -0.629384).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3107774
	speed: 0.2940s/iter; left time: 10603.0742s
	iters: 200, epoch: 3 | loss: 1.0862801
	speed: 0.0619s/iter; left time: 2227.7279s
	iters: 300, epoch: 3 | loss: 1.9899735
	speed: 0.0860s/iter; left time: 3083.5668s
Epoch: 3 cost time: 28.694931507110596
Epoch: 3, Steps: 369 | Train Loss: 1.021 Vali Loss: 1.625 Vali Acc: 0.654 Test Loss: 1.625 Test Acc: 0.654
Validation loss decreased (-0.629384 --> -0.653786).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5007718
	speed: 0.3518s/iter; left time: 12556.6853s
	iters: 200, epoch: 4 | loss: 0.5605038
	speed: 0.0775s/iter; left time: 2758.1610s
	iters: 300, epoch: 4 | loss: 1.1181850
	speed: 0.0646s/iter; left time: 2292.4086s
Epoch: 4 cost time: 28.297975063323975
Epoch: 4, Steps: 369 | Train Loss: 1.004 Vali Loss: 2.349 Vali Acc: 0.649 Test Loss: 2.349 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2035599
	speed: 0.2562s/iter; left time: 9048.6642s
	iters: 200, epoch: 5 | loss: 0.0259170
	speed: 0.0661s/iter; left time: 2328.1828s
	iters: 300, epoch: 5 | loss: 1.9878402
	speed: 0.0692s/iter; left time: 2430.8388s
Epoch: 5 cost time: 22.812512636184692
Epoch: 5, Steps: 369 | Train Loss: 0.875 Vali Loss: 2.217 Vali Acc: 0.653 Test Loss: 2.217 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2777531
	speed: 0.2718s/iter; left time: 9500.5898s
	iters: 200, epoch: 6 | loss: 0.6143851
	speed: 0.0456s/iter; left time: 1587.8232s
	iters: 300, epoch: 6 | loss: 0.2837558
	speed: 0.0444s/iter; left time: 1544.4643s
Epoch: 6 cost time: 18.84766149520874
Epoch: 6, Steps: 369 | Train Loss: 0.722 Vali Loss: 2.069 Vali Acc: 0.648 Test Loss: 2.069 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4701523
	speed: 0.2723s/iter; left time: 9418.1798s
	iters: 200, epoch: 7 | loss: 0.1977947
	speed: 0.1042s/iter; left time: 3592.8231s
	iters: 300, epoch: 7 | loss: 0.2606602
	speed: 0.0884s/iter; left time: 3041.1402s
Epoch: 7 cost time: 31.34539818763733
Epoch: 7, Steps: 369 | Train Loss: 0.533 Vali Loss: 2.276 Vali Acc: 0.625 Test Loss: 2.276 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6792097
	speed: 0.3304s/iter; left time: 11305.7604s
	iters: 200, epoch: 8 | loss: 0.5370381
	speed: 0.0696s/iter; left time: 2375.3848s
	iters: 300, epoch: 8 | loss: 0.5575845
	speed: 0.0619s/iter; left time: 2104.2970s
Epoch: 8 cost time: 25.930328369140625
Epoch: 8, Steps: 369 | Train Loss: 0.387 Vali Loss: 2.076 Vali Acc: 0.642 Test Loss: 2.076 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0371235
	speed: 0.2742s/iter; left time: 9281.1597s
	iters: 200, epoch: 9 | loss: 0.1321527
	speed: 0.0405s/iter; left time: 1366.1930s
	iters: 300, epoch: 9 | loss: 0.1394716
	speed: 0.0399s/iter; left time: 1342.6993s
Epoch: 9 cost time: 16.855036973953247
Epoch: 9, Steps: 369 | Train Loss: 0.322 Vali Loss: 1.823 Vali Acc: 0.640 Test Loss: 1.823 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0985078
	speed: 0.2406s/iter; left time: 8054.8068s
	iters: 200, epoch: 10 | loss: 0.2521502
	speed: 0.0413s/iter; left time: 1379.0154s
	iters: 300, epoch: 10 | loss: 0.1197097
	speed: 0.0401s/iter; left time: 1335.4968s
Epoch: 10 cost time: 16.357072591781616
Epoch: 10, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.855 Vali Acc: 0.639 Test Loss: 1.855 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4859593
	speed: 0.2591s/iter; left time: 8579.8191s
	iters: 200, epoch: 11 | loss: 0.2397501
	speed: 0.0452s/iter; left time: 1492.6273s
	iters: 300, epoch: 11 | loss: 0.0358329
	speed: 0.0391s/iter; left time: 1286.9870s
Epoch: 11 cost time: 16.60196614265442
Epoch: 11, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.706 Vali Acc: 0.653 Test Loss: 1.706 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0632380
	speed: 0.2621s/iter; left time: 8580.6358s
	iters: 200, epoch: 12 | loss: 0.0297100
	speed: 0.0619s/iter; left time: 2021.9815s
	iters: 300, epoch: 12 | loss: 0.1226762
	speed: 0.0616s/iter; left time: 2004.6516s
Epoch: 12 cost time: 24.488121509552002
Epoch: 12, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.817 Vali Acc: 0.631 Test Loss: 1.817 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1300018
	speed: 0.3437s/iter; left time: 11126.9799s
	iters: 200, epoch: 13 | loss: 0.2009634
	speed: 0.0710s/iter; left time: 2290.6486s
	iters: 300, epoch: 13 | loss: 0.0141348
	speed: 0.0564s/iter; left time: 1813.0743s
Epoch: 13 cost time: 26.828651666641235
Epoch: 13, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.843 Vali Acc: 0.633 Test Loss: 1.843 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 109058
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0886456
	speed: 0.1103s/iter; left time: 4059.9386s
	iters: 200, epoch: 1 | loss: 1.0349426
	speed: 0.0639s/iter; left time: 2346.0085s
	iters: 300, epoch: 1 | loss: 1.1659523
	speed: 0.0596s/iter; left time: 2182.7429s
Epoch: 1 cost time: 27.678236484527588
Epoch: 1, Steps: 369 | Train Loss: 0.816 Vali Loss: 1.257 Vali Acc: 0.629 Test Loss: 1.257 Test Acc: 0.629
Validation loss decreased (inf --> -0.628535).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5951793
	speed: 0.2630s/iter; left time: 9581.6806s
	iters: 200, epoch: 2 | loss: 1.3564439
	speed: 0.0474s/iter; left time: 1723.0859s
	iters: 300, epoch: 2 | loss: 0.8912246
	speed: 0.0485s/iter; left time: 1756.4705s
Epoch: 2 cost time: 19.035893440246582
Epoch: 2, Steps: 369 | Train Loss: 0.811 Vali Loss: 1.091 Vali Acc: 0.657 Test Loss: 1.091 Test Acc: 0.657
Validation loss decreased (-0.628535 --> -0.657197).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9343891
	speed: 0.2552s/iter; left time: 9203.1481s
	iters: 200, epoch: 3 | loss: 0.5034906
	speed: 0.0633s/iter; left time: 2276.0638s
	iters: 300, epoch: 3 | loss: 1.0766383
	speed: 0.0443s/iter; left time: 1588.3844s
Epoch: 3 cost time: 19.48875069618225
Epoch: 3, Steps: 369 | Train Loss: 0.918 Vali Loss: 1.653 Vali Acc: 0.650 Test Loss: 1.653 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3136002
	speed: 0.2409s/iter; left time: 8598.7062s
	iters: 200, epoch: 4 | loss: 0.4632229
	speed: 0.0379s/iter; left time: 1348.6521s
	iters: 300, epoch: 4 | loss: 0.4923330
	speed: 0.0379s/iter; left time: 1346.3502s
Epoch: 4 cost time: 17.24898862838745
Epoch: 4, Steps: 369 | Train Loss: 0.876 Vali Loss: 2.073 Vali Acc: 0.626 Test Loss: 2.073 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0389313
	speed: 0.2481s/iter; left time: 8763.7896s
	iters: 200, epoch: 5 | loss: 0.2087671
	speed: 0.0647s/iter; left time: 2279.9391s
	iters: 300, epoch: 5 | loss: 1.3154438
	speed: 0.0845s/iter; left time: 2967.4855s
Epoch: 5 cost time: 28.580108165740967
Epoch: 5, Steps: 369 | Train Loss: 0.777 Vali Loss: 2.059 Vali Acc: 0.648 Test Loss: 2.059 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1881284
	speed: 0.3208s/iter; left time: 11214.7018s
	iters: 200, epoch: 6 | loss: 1.0616943
	speed: 0.0827s/iter; left time: 2884.3261s
	iters: 300, epoch: 6 | loss: 0.6895035
	speed: 0.0614s/iter; left time: 2133.4477s
Epoch: 6 cost time: 27.87694215774536
Epoch: 6, Steps: 369 | Train Loss: 0.659 Vali Loss: 2.094 Vali Acc: 0.642 Test Loss: 2.094 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6986568
	speed: 0.2706s/iter; left time: 9360.0410s
	iters: 200, epoch: 7 | loss: 0.1115677
	speed: 0.0366s/iter; left time: 1263.3093s
	iters: 300, epoch: 7 | loss: 0.2224239
	speed: 0.0391s/iter; left time: 1343.8326s
Epoch: 7 cost time: 15.525953769683838
Epoch: 7, Steps: 369 | Train Loss: 0.515 Vali Loss: 2.072 Vali Acc: 0.645 Test Loss: 2.072 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.4658565
	speed: 0.2290s/iter; left time: 7836.3884s
	iters: 200, epoch: 8 | loss: 0.1468394
	speed: 0.0435s/iter; left time: 1484.3839s
	iters: 300, epoch: 8 | loss: 0.1169842
	speed: 0.0503s/iter; left time: 1710.1584s
Epoch: 8 cost time: 18.35352349281311
Epoch: 8, Steps: 369 | Train Loss: 0.403 Vali Loss: 1.871 Vali Acc: 0.635 Test Loss: 1.871 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0121580
	speed: 0.2496s/iter; left time: 8447.0441s
	iters: 200, epoch: 9 | loss: 0.1647902
	speed: 0.0579s/iter; left time: 1952.5071s
	iters: 300, epoch: 9 | loss: 0.0512298
	speed: 0.0506s/iter; left time: 1702.4672s
Epoch: 9 cost time: 18.798925638198853
Epoch: 9, Steps: 369 | Train Loss: 0.327 Vali Loss: 1.772 Vali Acc: 0.638 Test Loss: 1.772 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1101791
	speed: 0.2804s/iter; left time: 9386.6627s
	iters: 200, epoch: 10 | loss: 0.1256897
	speed: 0.0662s/iter; left time: 2209.2714s
	iters: 300, epoch: 10 | loss: 0.3081323
	speed: 0.0632s/iter; left time: 2104.3103s
Epoch: 10 cost time: 27.20298981666565
Epoch: 10, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.833 Vali Acc: 0.636 Test Loss: 1.833 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0896428
	speed: 0.2976s/iter; left time: 9852.7719s
	iters: 200, epoch: 11 | loss: 0.1793136
	speed: 0.0619s/iter; left time: 2044.2262s
	iters: 300, epoch: 11 | loss: 0.5438979
	speed: 0.0886s/iter; left time: 2915.5216s
Epoch: 11 cost time: 27.968220233917236
Epoch: 11, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.767 Vali Acc: 0.649 Test Loss: 1.767 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0333205
	speed: 0.2920s/iter; left time: 9560.8616s
	iters: 200, epoch: 12 | loss: 0.0742195
	speed: 0.0626s/iter; left time: 2043.2880s
	iters: 300, epoch: 12 | loss: 0.0141418
	speed: 0.0402s/iter; left time: 1308.4386s
Epoch: 12 cost time: 19.317519903182983
Epoch: 12, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.834 Vali Acc: 0.633 Test Loss: 1.834 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6572077185017026
model parameter : 90722
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2654427
	speed: 0.2075s/iter; left time: 7635.7242s
	iters: 200, epoch: 1 | loss: 1.9003794
	speed: 0.1786s/iter; left time: 6555.9443s
	iters: 300, epoch: 1 | loss: 1.0874196
	speed: 0.1782s/iter; left time: 6523.8376s
Epoch: 1 cost time: 69.29734516143799
Epoch: 1, Steps: 369 | Train Loss: 1.339 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (inf --> -0.649820).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3326483
	speed: 0.7892s/iter; left time: 28753.3802s
	iters: 200, epoch: 2 | loss: 2.3343124
	speed: 0.2811s/iter; left time: 10214.0338s
	iters: 300, epoch: 2 | loss: 2.3585989
	speed: 0.2688s/iter; left time: 9737.6742s
Epoch: 2 cost time: 106.64956974983215
Epoch: 2, Steps: 369 | Train Loss: 1.624 Vali Loss: 2.577 Vali Acc: 0.612 Test Loss: 2.577 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5218755
	speed: 0.8709s/iter; left time: 31407.8421s
	iters: 200, epoch: 3 | loss: 1.6826143
	speed: 0.2054s/iter; left time: 7385.0422s
	iters: 300, epoch: 3 | loss: 1.4313962
	speed: 0.2236s/iter; left time: 8020.2281s
Epoch: 3 cost time: 83.34478521347046
Epoch: 3, Steps: 369 | Train Loss: 1.860 Vali Loss: 2.302 Vali Acc: 0.644 Test Loss: 2.302 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9633310
	speed: 0.8770s/iter; left time: 31303.0843s
	iters: 200, epoch: 4 | loss: 2.4873028
	speed: 0.2813s/iter; left time: 10013.0453s
	iters: 300, epoch: 4 | loss: 0.8063502
	speed: 0.3008s/iter; left time: 10677.9912s
Epoch: 4 cost time: 108.46830821037292
Epoch: 4, Steps: 369 | Train Loss: 1.495 Vali Loss: 3.881 Vali Acc: 0.622 Test Loss: 3.881 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5730018
	speed: 0.8011s/iter; left time: 28298.1157s
	iters: 200, epoch: 5 | loss: 0.0042076
	speed: 0.2287s/iter; left time: 8054.4888s
	iters: 300, epoch: 5 | loss: 1.3595169
	speed: 0.2241s/iter; left time: 7871.5802s
Epoch: 5 cost time: 81.6667275428772
Epoch: 5, Steps: 369 | Train Loss: 0.961 Vali Loss: 2.436 Vali Acc: 0.613 Test Loss: 2.436 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2731008
	speed: 0.8773s/iter; left time: 30665.1745s
	iters: 200, epoch: 6 | loss: 0.1978306
	speed: 0.2960s/iter; left time: 10318.3306s
	iters: 300, epoch: 6 | loss: 0.4487956
	speed: 0.2550s/iter; left time: 8864.5176s
Epoch: 6 cost time: 100.492032289505
Epoch: 6, Steps: 369 | Train Loss: 0.450 Vali Loss: 2.647 Vali Acc: 0.631 Test Loss: 2.647 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1690916
	speed: 0.7902s/iter; left time: 27330.5884s
	iters: 200, epoch: 7 | loss: 0.5860732
	speed: 0.2622s/iter; left time: 9043.0579s
	iters: 300, epoch: 7 | loss: 0.1427324
	speed: 0.2997s/iter; left time: 10306.2100s
Epoch: 7 cost time: 100.01093792915344
Epoch: 7, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.986 Vali Acc: 0.632 Test Loss: 1.986 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0019338
	speed: 0.9159s/iter; left time: 31340.0435s
	iters: 200, epoch: 8 | loss: 0.0553555
	speed: 0.1953s/iter; left time: 6662.6216s
	iters: 300, epoch: 8 | loss: 0.0164154
	speed: 0.1923s/iter; left time: 6541.5117s
Epoch: 8 cost time: 78.30551290512085
Epoch: 8, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.882 Vali Acc: 0.634 Test Loss: 1.882 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.2123303
	speed: 0.6916s/iter; left time: 23411.4536s
	iters: 200, epoch: 9 | loss: 0.1107099
	speed: 0.2953s/iter; left time: 9964.7543s
	iters: 300, epoch: 9 | loss: 0.1079322
	speed: 0.2910s/iter; left time: 9791.8272s
Epoch: 9 cost time: 101.84461116790771
Epoch: 9, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.736 Vali Acc: 0.620 Test Loss: 1.736 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0088232
	speed: 0.8593s/iter; left time: 28769.4342s
	iters: 200, epoch: 10 | loss: 0.0189648
	speed: 0.2228s/iter; left time: 7436.8148s
	iters: 300, epoch: 10 | loss: 0.8005601
	speed: 0.2254s/iter; left time: 7501.4809s
Epoch: 10 cost time: 88.17000985145569
Epoch: 10, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.914 Vali Acc: 0.620 Test Loss: 1.914 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0105686
	speed: 0.9118s/iter; left time: 30191.4888s
	iters: 200, epoch: 11 | loss: 0.0088561
	speed: 0.2878s/iter; left time: 9499.4857s
	iters: 300, epoch: 11 | loss: 0.3349462
	speed: 0.2972s/iter; left time: 9781.9725s
Epoch: 11 cost time: 109.46572184562683
Epoch: 11, Steps: 369 | Train Loss: 0.081 Vali Loss: 2.063 Vali Acc: 0.614 Test Loss: 2.063 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6498297389330306
model parameter : 314610
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9038656
	speed: 0.1723s/iter; left time: 6339.8576s
	iters: 200, epoch: 1 | loss: 0.2923548
	speed: 0.1298s/iter; left time: 4764.0536s
	iters: 300, epoch: 1 | loss: 1.5312445
	speed: 0.1494s/iter; left time: 5466.4218s
Epoch: 1 cost time: 55.31512260437012
Epoch: 1, Steps: 369 | Train Loss: 1.010 Vali Loss: 0.919 Vali Acc: 0.641 Test Loss: 0.919 Test Acc: 0.641
Validation loss decreased (inf --> -0.641024).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1100476
	speed: 0.5316s/iter; left time: 19368.9313s
	iters: 200, epoch: 2 | loss: 0.6330302
	speed: 0.1064s/iter; left time: 3866.7219s
	iters: 300, epoch: 2 | loss: 1.3965063
	speed: 0.1254s/iter; left time: 4544.8715s
Epoch: 2 cost time: 43.81621742248535
Epoch: 2, Steps: 369 | Train Loss: 1.131 Vali Loss: 1.814 Vali Acc: 0.644 Test Loss: 1.814 Test Acc: 0.644
Validation loss decreased (-0.641024 --> -0.644420).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0710766
	speed: 0.4166s/iter; left time: 15023.3125s
	iters: 200, epoch: 3 | loss: 1.5584732
	speed: 0.0989s/iter; left time: 3557.5471s
	iters: 300, epoch: 3 | loss: 2.0509665
	speed: 0.1265s/iter; left time: 4535.9526s
Epoch: 3 cost time: 39.918535470962524
Epoch: 3, Steps: 369 | Train Loss: 1.274 Vali Loss: 1.913 Vali Acc: 0.621 Test Loss: 1.913 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.8834772
	speed: 0.4399s/iter; left time: 15702.7795s
	iters: 200, epoch: 4 | loss: 1.0632113
	speed: 0.1293s/iter; left time: 4601.4409s
	iters: 300, epoch: 4 | loss: 0.4752562
	speed: 0.1215s/iter; left time: 4312.4070s
Epoch: 4 cost time: 42.98887848854065
Epoch: 4, Steps: 369 | Train Loss: 1.180 Vali Loss: 2.400 Vali Acc: 0.645 Test Loss: 2.400 Test Acc: 0.645
Validation loss decreased (-0.644420 --> -0.645265).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8034624
	speed: 0.4214s/iter; left time: 14885.6341s
	iters: 200, epoch: 5 | loss: 2.5987339
	speed: 0.1587s/iter; left time: 5590.7104s
	iters: 300, epoch: 5 | loss: 0.7637288
	speed: 0.1350s/iter; left time: 4740.1484s
Epoch: 5 cost time: 52.535128116607666
Epoch: 5, Steps: 369 | Train Loss: 0.847 Vali Loss: 1.774 Vali Acc: 0.640 Test Loss: 1.774 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4715744
	speed: 0.5336s/iter; left time: 18653.2954s
	iters: 200, epoch: 6 | loss: 0.9608277
	speed: 0.1269s/iter; left time: 4424.0461s
	iters: 300, epoch: 6 | loss: 0.2610575
	speed: 0.0942s/iter; left time: 3273.9501s
Epoch: 6 cost time: 44.24289655685425
Epoch: 6, Steps: 369 | Train Loss: 0.471 Vali Loss: 1.419 Vali Acc: 0.646 Test Loss: 1.419 Test Acc: 0.646
Validation loss decreased (-0.645265 --> -0.645559).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2079298
	speed: 0.4062s/iter; left time: 14048.9140s
	iters: 200, epoch: 7 | loss: 0.0438871
	speed: 0.0926s/iter; left time: 3195.0982s
	iters: 300, epoch: 7 | loss: 0.3229410
	speed: 0.0857s/iter; left time: 2945.6193s
Epoch: 7 cost time: 34.32311463356018
Epoch: 7, Steps: 369 | Train Loss: 0.284 Vali Loss: 1.304 Vali Acc: 0.642 Test Loss: 1.304 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0933428
	speed: 0.3620s/iter; left time: 12387.8529s
	iters: 200, epoch: 8 | loss: 0.1454426
	speed: 0.0893s/iter; left time: 3046.9514s
	iters: 300, epoch: 8 | loss: 0.1707936
	speed: 0.1152s/iter; left time: 3919.8260s
Epoch: 8 cost time: 39.56813669204712
Epoch: 8, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.325 Vali Acc: 0.640 Test Loss: 1.325 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0519995
	speed: 0.5410s/iter; left time: 18313.5311s
	iters: 200, epoch: 9 | loss: 0.0255612
	speed: 0.1316s/iter; left time: 4440.1912s
	iters: 300, epoch: 9 | loss: 0.2795373
	speed: 0.1493s/iter; left time: 5022.2611s
Epoch: 9 cost time: 54.79017758369446
Epoch: 9, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.531 Vali Acc: 0.636 Test Loss: 1.531 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0364690
	speed: 0.4597s/iter; left time: 15391.7022s
	iters: 200, epoch: 10 | loss: 0.0185025
	speed: 0.1089s/iter; left time: 3634.4678s
	iters: 300, epoch: 10 | loss: 0.0169960
	speed: 0.1320s/iter; left time: 4392.0976s
Epoch: 10 cost time: 41.572776794433594
Epoch: 10, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.585 Vali Acc: 0.646 Test Loss: 1.585 Test Acc: 0.646
Validation loss decreased (-0.645559 --> -0.646409).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0744423
	speed: 0.4177s/iter; left time: 13828.9784s
	iters: 200, epoch: 11 | loss: 0.1292336
	speed: 0.1198s/iter; left time: 3954.4150s
	iters: 300, epoch: 11 | loss: 0.0516674
	speed: 0.1181s/iter; left time: 3886.1112s
Epoch: 11 cost time: 43.244526624679565
Epoch: 11, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.821 Vali Acc: 0.630 Test Loss: 1.821 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0332198
	speed: 0.5289s/iter; left time: 17318.7540s
	iters: 200, epoch: 12 | loss: 0.0250623
	speed: 0.1555s/iter; left time: 5076.9092s
	iters: 300, epoch: 12 | loss: 0.1257868
	speed: 0.1310s/iter; left time: 4261.7742s
Epoch: 12 cost time: 53.97690796852112
Epoch: 12, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.790 Vali Acc: 0.636 Test Loss: 1.790 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0131910
	speed: 0.5044s/iter; left time: 16330.0288s
	iters: 200, epoch: 13 | loss: 0.0231889
	speed: 0.0959s/iter; left time: 3094.6466s
	iters: 300, epoch: 13 | loss: 0.0695410
	speed: 0.0955s/iter; left time: 3071.7534s
Epoch: 13 cost time: 41.747472286224365
Epoch: 13, Steps: 369 | Train Loss: 0.063 Vali Loss: 1.906 Vali Acc: 0.629 Test Loss: 1.906 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0189993
	speed: 0.4443s/iter; left time: 14220.5608s
	iters: 200, epoch: 14 | loss: 0.0145357
	speed: 0.1024s/iter; left time: 3266.5633s
	iters: 300, epoch: 14 | loss: 0.0492476
	speed: 0.0943s/iter; left time: 2999.2034s
Epoch: 14 cost time: 41.716259241104126
Epoch: 14, Steps: 369 | Train Loss: 0.063 Vali Loss: 1.988 Vali Acc: 0.636 Test Loss: 1.988 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0470278
	speed: 0.4873s/iter; left time: 15415.3235s
	iters: 200, epoch: 15 | loss: 0.0010365
	speed: 0.1295s/iter; left time: 4083.5213s
	iters: 300, epoch: 15 | loss: 0.0563928
	speed: 0.1353s/iter; left time: 4253.3928s
Epoch: 15 cost time: 53.808839321136475
Epoch: 15, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.256 Vali Acc: 0.632 Test Loss: 2.256 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0577560
	speed: 0.5533s/iter; left time: 17298.7177s
	iters: 200, epoch: 16 | loss: 0.0127916
	speed: 0.1247s/iter; left time: 3887.8802s
	iters: 300, epoch: 16 | loss: 0.0412221
	speed: 0.1378s/iter; left time: 4282.0363s
Epoch: 16 cost time: 49.0919406414032
Epoch: 16, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.246 Vali Acc: 0.634 Test Loss: 2.246 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0503275
	speed: 0.4218s/iter; left time: 13033.8053s
	iters: 200, epoch: 17 | loss: 0.0491574
	speed: 0.1134s/iter; left time: 3491.4227s
	iters: 300, epoch: 17 | loss: 0.0878183
	speed: 0.1231s/iter; left time: 3778.3594s
Epoch: 17 cost time: 40.87197136878967
Epoch: 17, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.343 Vali Acc: 0.636 Test Loss: 2.343 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.1561222
	speed: 0.4436s/iter; left time: 13542.3551s
	iters: 200, epoch: 18 | loss: 0.0150990
	speed: 0.1561s/iter; left time: 4751.0508s
	iters: 300, epoch: 18 | loss: 0.1159989
	speed: 0.1361s/iter; left time: 4126.2219s
Epoch: 18 cost time: 50.117496967315674
Epoch: 18, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.358 Vali Acc: 0.636 Test Loss: 2.358 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0148592
	speed: 0.4667s/iter; left time: 14076.5182s
	iters: 200, epoch: 19 | loss: 0.0023858
	speed: 0.1173s/iter; left time: 3525.6668s
	iters: 300, epoch: 19 | loss: 0.1719857
	speed: 0.1064s/iter; left time: 3186.7607s
Epoch: 19 cost time: 41.52916193008423
Epoch: 19, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.271 Vali Acc: 0.642 Test Loss: 2.271 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0016130
	speed: 0.4260s/iter; left time: 12690.4123s
	iters: 200, epoch: 20 | loss: 0.0045398
	speed: 0.1286s/iter; left time: 3819.5731s
	iters: 300, epoch: 20 | loss: 0.0465919
	speed: 0.1022s/iter; left time: 3023.2088s
Epoch: 20 cost time: 41.21089744567871
Epoch: 20, Steps: 369 | Train Loss: 0.039 Vali Loss: 2.483 Vali Acc: 0.628 Test Loss: 2.483 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6464245175936436
model parameter : 171794
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6782922
	speed: 0.1434s/iter; left time: 5277.2307s
	iters: 200, epoch: 1 | loss: 0.1742793
	speed: 0.0978s/iter; left time: 3589.2140s
	iters: 300, epoch: 1 | loss: 1.5100771
	speed: 0.1080s/iter; left time: 3951.1200s
Epoch: 1 cost time: 43.68189096450806
Epoch: 1, Steps: 369 | Train Loss: 0.939 Vali Loss: 0.955 Vali Acc: 0.629 Test Loss: 0.955 Test Acc: 0.629
Validation loss decreased (inf --> -0.629389).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6821221
	speed: 0.3871s/iter; left time: 14101.5689s
	iters: 200, epoch: 2 | loss: 0.6649621
	speed: 0.0910s/iter; left time: 3305.6317s
	iters: 300, epoch: 2 | loss: 1.9829305
	speed: 0.0797s/iter; left time: 2887.9852s
Epoch: 2 cost time: 34.64591860771179
Epoch: 2, Steps: 369 | Train Loss: 0.963 Vali Loss: 1.286 Vali Acc: 0.645 Test Loss: 1.286 Test Acc: 0.645
Validation loss decreased (-0.629389 --> -0.645277).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5736794
	speed: 0.3585s/iter; left time: 12929.7796s
	iters: 200, epoch: 3 | loss: 0.5029227
	speed: 0.1059s/iter; left time: 3807.7361s
	iters: 300, epoch: 3 | loss: 1.2955916
	speed: 0.0788s/iter; left time: 2825.2199s
Epoch: 3 cost time: 33.8031280040741
Epoch: 3, Steps: 369 | Train Loss: 1.106 Vali Loss: 1.304 Vali Acc: 0.647 Test Loss: 1.304 Test Acc: 0.647
Validation loss decreased (-0.645277 --> -0.647263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1087481
	speed: 0.3843s/iter; left time: 13718.0989s
	iters: 200, epoch: 4 | loss: 0.1743801
	speed: 0.1238s/iter; left time: 4406.7348s
	iters: 300, epoch: 4 | loss: 1.2368211
	speed: 0.1065s/iter; left time: 3780.3119s
Epoch: 4 cost time: 40.85467767715454
Epoch: 4, Steps: 369 | Train Loss: 0.979 Vali Loss: 1.949 Vali Acc: 0.642 Test Loss: 1.949 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7229154
	speed: 0.4203s/iter; left time: 14846.5301s
	iters: 200, epoch: 5 | loss: 0.5283123
	speed: 0.1143s/iter; left time: 4024.8674s
	iters: 300, epoch: 5 | loss: 0.0208610
	speed: 0.1130s/iter; left time: 3969.9097s
Epoch: 5 cost time: 38.403000831604004
Epoch: 5, Steps: 369 | Train Loss: 0.698 Vali Loss: 1.696 Vali Acc: 0.619 Test Loss: 1.696 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7679061
	speed: 0.3428s/iter; left time: 11981.2956s
	iters: 200, epoch: 6 | loss: 0.6400964
	speed: 0.0766s/iter; left time: 2668.4505s
	iters: 300, epoch: 6 | loss: 0.1341884
	speed: 0.0951s/iter; left time: 3305.0934s
Epoch: 6 cost time: 32.83541202545166
Epoch: 6, Steps: 369 | Train Loss: 0.458 Vali Loss: 1.467 Vali Acc: 0.643 Test Loss: 1.467 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4864491
	speed: 0.3845s/iter; left time: 13299.9105s
	iters: 200, epoch: 7 | loss: 0.2774620
	speed: 0.0762s/iter; left time: 2628.5574s
	iters: 300, epoch: 7 | loss: 0.5691385
	speed: 0.0755s/iter; left time: 2595.5383s
Epoch: 7 cost time: 32.30325508117676
Epoch: 7, Steps: 369 | Train Loss: 0.340 Vali Loss: 1.231 Vali Acc: 0.640 Test Loss: 1.231 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4809548
	speed: 0.4103s/iter; left time: 14038.5940s
	iters: 200, epoch: 8 | loss: 0.2296406
	speed: 0.1120s/iter; left time: 3822.8749s
	iters: 300, epoch: 8 | loss: 0.1309438
	speed: 0.0994s/iter; left time: 3380.4233s
Epoch: 8 cost time: 41.410401821136475
Epoch: 8, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.310 Vali Acc: 0.636 Test Loss: 1.310 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0372413
	speed: 0.4371s/iter; left time: 14795.4818s
	iters: 200, epoch: 9 | loss: 0.4585792
	speed: 0.1132s/iter; left time: 3820.0470s
	iters: 300, epoch: 9 | loss: 0.1008658
	speed: 0.0780s/iter; left time: 2623.7787s
Epoch: 9 cost time: 36.10956335067749
Epoch: 9, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.376 Vali Acc: 0.648 Test Loss: 1.376 Test Acc: 0.648
Validation loss decreased (-0.647263 --> -0.647546).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0630739
	speed: 0.3219s/iter; left time: 10775.9405s
	iters: 200, epoch: 10 | loss: 0.1485974
	speed: 0.0963s/iter; left time: 3214.7361s
	iters: 300, epoch: 10 | loss: 0.1319015
	speed: 0.0827s/iter; left time: 2752.5875s
Epoch: 10 cost time: 30.99980115890503
Epoch: 10, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.504 Vali Acc: 0.644 Test Loss: 1.504 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1417316
	speed: 0.3099s/iter; left time: 10261.2851s
	iters: 200, epoch: 11 | loss: 0.0606987
	speed: 0.0781s/iter; left time: 2576.7017s
	iters: 300, epoch: 11 | loss: 0.2772627
	speed: 0.0707s/iter; left time: 2327.8527s
Epoch: 11 cost time: 27.44534683227539
Epoch: 11, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.535 Vali Acc: 0.648 Test Loss: 1.535 Test Acc: 0.648
Validation loss decreased (-0.647546 --> -0.648396).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0725325
	speed: 0.3518s/iter; left time: 11518.3224s
	iters: 200, epoch: 12 | loss: 0.0142114
	speed: 0.0891s/iter; left time: 2909.5354s
	iters: 300, epoch: 12 | loss: 0.1093280
	speed: 0.0892s/iter; left time: 2902.6210s
Epoch: 12 cost time: 33.82131910324097
Epoch: 12, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.629 Vali Acc: 0.650 Test Loss: 1.629 Test Acc: 0.650
Validation loss decreased (-0.648396 --> -0.649530).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0186296
	speed: 0.3751s/iter; left time: 12142.6289s
	iters: 200, epoch: 13 | loss: 0.0353460
	speed: 0.0677s/iter; left time: 2184.2721s
	iters: 300, epoch: 13 | loss: 0.0027035
	speed: 0.0732s/iter; left time: 2355.2309s
Epoch: 13 cost time: 28.351642370224
Epoch: 13, Steps: 369 | Train Loss: 0.085 Vali Loss: 1.796 Vali Acc: 0.648 Test Loss: 1.796 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0031418
	speed: 0.3365s/iter; left time: 10769.0444s
	iters: 200, epoch: 14 | loss: 0.1506142
	speed: 0.0729s/iter; left time: 2326.8730s
	iters: 300, epoch: 14 | loss: 0.1543433
	speed: 0.0925s/iter; left time: 2940.9081s
Epoch: 14 cost time: 32.80325102806091
Epoch: 14, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.823 Vali Acc: 0.645 Test Loss: 1.823 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2507342
	speed: 0.3748s/iter; left time: 11857.8060s
	iters: 200, epoch: 15 | loss: 0.0228084
	speed: 0.0812s/iter; left time: 2560.3329s
	iters: 300, epoch: 15 | loss: 0.1121326
	speed: 0.0893s/iter; left time: 2808.1778s
Epoch: 15 cost time: 36.04566812515259
Epoch: 15, Steps: 369 | Train Loss: 0.077 Vali Loss: 1.909 Vali Acc: 0.633 Test Loss: 1.909 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0788077
	speed: 0.4406s/iter; left time: 13774.3637s
	iters: 200, epoch: 16 | loss: 0.0664752
	speed: 0.1068s/iter; left time: 3329.7339s
	iters: 300, epoch: 16 | loss: 0.0091290
	speed: 0.0950s/iter; left time: 2951.6083s
Epoch: 16 cost time: 40.226741313934326
Epoch: 16, Steps: 369 | Train Loss: 0.077 Vali Loss: 1.914 Vali Acc: 0.638 Test Loss: 1.914 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1081030
	speed: 0.4160s/iter; left time: 12854.6450s
	iters: 200, epoch: 17 | loss: 0.1645106
	speed: 0.0932s/iter; left time: 2869.1705s
	iters: 300, epoch: 17 | loss: 0.0236848
	speed: 0.0758s/iter; left time: 2326.9320s
Epoch: 17 cost time: 32.49114656448364
Epoch: 17, Steps: 369 | Train Loss: 0.066 Vali Loss: 1.935 Vali Acc: 0.646 Test Loss: 1.935 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0877136
	speed: 0.3712s/iter; left time: 11331.0516s
	iters: 200, epoch: 18 | loss: 0.2115309
	speed: 0.0996s/iter; left time: 3030.3817s
	iters: 300, epoch: 18 | loss: 0.1861066
	speed: 0.0800s/iter; left time: 2426.0644s
Epoch: 18 cost time: 32.622246742248535
Epoch: 18, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.031 Vali Acc: 0.640 Test Loss: 2.031 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0701793
	speed: 0.3729s/iter; left time: 11245.6895s
	iters: 200, epoch: 19 | loss: 0.3233015
	speed: 0.1228s/iter; left time: 3690.1363s
	iters: 300, epoch: 19 | loss: 0.0106205
	speed: 0.1057s/iter; left time: 3165.7028s
Epoch: 19 cost time: 40.00920844078064
Epoch: 19, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.124 Vali Acc: 0.656 Test Loss: 2.124 Test Acc: 0.656
Validation loss decreased (-0.649530 --> -0.655484).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0053666
	speed: 0.4254s/iter; left time: 12672.0116s
	iters: 200, epoch: 20 | loss: 0.0060846
	speed: 0.1224s/iter; left time: 3633.3753s
	iters: 300, epoch: 20 | loss: 0.0240435
	speed: 0.1089s/iter; left time: 3221.9927s
Epoch: 20 cost time: 41.367019176483154
Epoch: 20, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.212 Vali Acc: 0.648 Test Loss: 2.212 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1047798
	speed: 0.3897s/iter; left time: 11464.2842s
	iters: 200, epoch: 21 | loss: 0.0089746
	speed: 0.0994s/iter; left time: 2915.8091s
	iters: 300, epoch: 21 | loss: 0.0018093
	speed: 0.0975s/iter; left time: 2848.8165s
Epoch: 21 cost time: 34.16679286956787
Epoch: 21, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.320 Vali Acc: 0.652 Test Loss: 2.320 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0418714
	speed: 0.3646s/iter; left time: 10593.1402s
	iters: 200, epoch: 22 | loss: 0.0130398
	speed: 0.0908s/iter; left time: 2629.1572s
	iters: 300, epoch: 22 | loss: 0.0115911
	speed: 0.1054s/iter; left time: 3042.1853s
Epoch: 22 cost time: 33.84253120422363
Epoch: 22, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.389 Vali Acc: 0.647 Test Loss: 2.389 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1045376
	speed: 0.4035s/iter; left time: 11572.3030s
	iters: 200, epoch: 23 | loss: 0.1123074
	speed: 0.0994s/iter; left time: 2840.1040s
	iters: 300, epoch: 23 | loss: 0.0718944
	speed: 0.1134s/iter; left time: 3230.3059s
Epoch: 23 cost time: 38.96885895729065
Epoch: 23, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.418 Vali Acc: 0.639 Test Loss: 2.418 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1614441
	speed: 0.4231s/iter; left time: 11979.3547s
	iters: 200, epoch: 24 | loss: 0.0018596
	speed: 0.0966s/iter; left time: 2725.3435s
	iters: 300, epoch: 24 | loss: 0.0020643
	speed: 0.1092s/iter; left time: 3070.0113s
Epoch: 24 cost time: 37.24051022529602
Epoch: 24, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.459 Vali Acc: 0.631 Test Loss: 2.459 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0711462
	speed: 0.3654s/iter; left time: 10210.5666s
	iters: 200, epoch: 25 | loss: 0.0098852
	speed: 0.0757s/iter; left time: 2108.3745s
	iters: 300, epoch: 25 | loss: 0.0026395
	speed: 0.0868s/iter; left time: 2406.9323s
Epoch: 25 cost time: 32.00725245475769
Epoch: 25, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.439 Vali Acc: 0.644 Test Loss: 2.439 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0026420
	speed: 0.3417s/iter; left time: 9423.3135s
	iters: 200, epoch: 26 | loss: 0.0007131
	speed: 0.0695s/iter; left time: 1910.5900s
	iters: 300, epoch: 26 | loss: 0.0234584
	speed: 0.0677s/iter; left time: 1853.6660s
Epoch: 26 cost time: 27.138625621795654
Epoch: 26, Steps: 369 | Train Loss: 0.039 Vali Loss: 2.443 Vali Acc: 0.648 Test Loss: 2.443 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0668975
	speed: 0.3653s/iter; left time: 9938.2979s
	iters: 200, epoch: 27 | loss: 0.0076758
	speed: 0.0882s/iter; left time: 2390.6246s
	iters: 300, epoch: 27 | loss: 0.0067070
	speed: 0.1143s/iter; left time: 3085.7354s
Epoch: 27 cost time: 38.408485651016235
Epoch: 27, Steps: 369 | Train Loss: 0.039 Vali Loss: 2.489 Vali Acc: 0.640 Test Loss: 2.489 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0164343
	speed: 0.4520s/iter; left time: 12131.9262s
	iters: 200, epoch: 28 | loss: 0.0026254
	speed: 0.0737s/iter; left time: 1971.3899s
	iters: 300, epoch: 28 | loss: 0.0010058
	speed: 0.0793s/iter; left time: 2113.5686s
Epoch: 28 cost time: 33.84851837158203
Epoch: 28, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.582 Vali Acc: 0.637 Test Loss: 2.582 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1170886
	speed: 0.3835s/iter; left time: 10150.9214s
	iters: 200, epoch: 29 | loss: 0.0002110
	speed: 0.0808s/iter; left time: 2130.0081s
	iters: 300, epoch: 29 | loss: 0.0059420
	speed: 0.0762s/iter; left time: 2001.3113s
Epoch: 29 cost time: 32.87794756889343
Epoch: 29, Steps: 369 | Train Loss: 0.031 Vali Loss: 2.581 Vali Acc: 0.635 Test Loss: 2.581 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6555051078320091
model parameter : 125730
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.3495026
	speed: 0.0942s/iter; left time: 3467.0577s
	iters: 200, epoch: 1 | loss: 0.5754719
	speed: 0.0735s/iter; left time: 2697.7039s
	iters: 300, epoch: 1 | loss: 1.2191041
	speed: 0.0741s/iter; left time: 2710.7397s
Epoch: 1 cost time: 28.086028575897217
Epoch: 1, Steps: 369 | Train Loss: 0.839 Vali Loss: 1.217 Vali Acc: 0.623 Test Loss: 1.217 Test Acc: 0.623
Validation loss decreased (inf --> -0.622576).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3868396
	speed: 0.2948s/iter; left time: 10740.5748s
	iters: 200, epoch: 2 | loss: 0.9830808
	speed: 0.0700s/iter; left time: 2543.8179s
	iters: 300, epoch: 2 | loss: 1.8060015
	speed: 0.0744s/iter; left time: 2697.3805s
Epoch: 2 cost time: 29.609302520751953
Epoch: 2, Steps: 369 | Train Loss: 0.855 Vali Loss: 1.543 Vali Acc: 0.628 Test Loss: 1.543 Test Acc: 0.628
Validation loss decreased (-0.622576 --> -0.627680).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9622947
	speed: 0.3024s/iter; left time: 10903.9263s
	iters: 200, epoch: 3 | loss: 0.5892067
	speed: 0.0532s/iter; left time: 1912.8486s
	iters: 300, epoch: 3 | loss: 1.0601012
	speed: 0.0451s/iter; left time: 1618.3087s
Epoch: 3 cost time: 20.987578868865967
Epoch: 3, Steps: 369 | Train Loss: 0.851 Vali Loss: 1.647 Vali Acc: 0.631 Test Loss: 1.647 Test Acc: 0.631
Validation loss decreased (-0.627680 --> -0.630801).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5067559
	speed: 0.3026s/iter; left time: 10799.3401s
	iters: 200, epoch: 4 | loss: 0.1771624
	speed: 0.0783s/iter; left time: 2788.6190s
	iters: 300, epoch: 4 | loss: 0.5685377
	speed: 0.0829s/iter; left time: 2944.1844s
Epoch: 4 cost time: 28.61739182472229
Epoch: 4, Steps: 369 | Train Loss: 0.775 Vali Loss: 1.561 Vali Acc: 0.623 Test Loss: 1.561 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1062878
	speed: 0.3196s/iter; left time: 11289.6811s
	iters: 200, epoch: 5 | loss: 0.7262284
	speed: 0.0651s/iter; left time: 2293.3697s
	iters: 300, epoch: 5 | loss: 0.5497307
	speed: 0.0723s/iter; left time: 2540.8044s
Epoch: 5 cost time: 27.77912712097168
Epoch: 5, Steps: 369 | Train Loss: 0.584 Vali Loss: 1.510 Vali Acc: 0.629 Test Loss: 1.510 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7921305
	speed: 0.3321s/iter; left time: 11607.3520s
	iters: 200, epoch: 6 | loss: 0.0530893
	speed: 0.0722s/iter; left time: 2517.0491s
	iters: 300, epoch: 6 | loss: 1.2291590
	speed: 0.0589s/iter; left time: 2046.4789s
Epoch: 6 cost time: 26.405519008636475
Epoch: 6, Steps: 369 | Train Loss: 0.434 Vali Loss: 1.404 Vali Acc: 0.637 Test Loss: 1.404 Test Acc: 0.637
Validation loss decreased (-0.630801 --> -0.637046).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2816796
	speed: 0.2961s/iter; left time: 10240.1845s
	iters: 200, epoch: 7 | loss: 0.1075851
	speed: 0.0685s/iter; left time: 2363.6778s
	iters: 300, epoch: 7 | loss: 0.5878046
	speed: 0.0795s/iter; left time: 2732.5319s
Epoch: 7 cost time: 26.946606159210205
Epoch: 7, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.345 Vali Acc: 0.627 Test Loss: 1.345 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0375467
	speed: 0.3123s/iter; left time: 10685.6277s
	iters: 200, epoch: 8 | loss: 0.0766499
	speed: 0.0695s/iter; left time: 2370.8381s
	iters: 300, epoch: 8 | loss: 0.3057902
	speed: 0.0680s/iter; left time: 2313.2069s
Epoch: 8 cost time: 28.86444592475891
Epoch: 8, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.194 Vali Acc: 0.645 Test Loss: 1.194 Test Acc: 0.645
Validation loss decreased (-0.637046 --> -0.645278).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3962075
	speed: 0.3244s/iter; left time: 10980.3270s
	iters: 200, epoch: 9 | loss: 0.2834314
	speed: 0.0620s/iter; left time: 2093.4227s
	iters: 300, epoch: 9 | loss: 0.4320410
	speed: 0.0613s/iter; left time: 2062.2432s
Epoch: 9 cost time: 24.499890565872192
Epoch: 9, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2213226
	speed: 0.2989s/iter; left time: 10008.3675s
	iters: 200, epoch: 10 | loss: 0.1328317
	speed: 0.0506s/iter; left time: 1689.8251s
	iters: 300, epoch: 10 | loss: 0.1919462
	speed: 0.0531s/iter; left time: 1766.5586s
Epoch: 10 cost time: 20.7248215675354
Epoch: 10, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.404 Vali Acc: 0.636 Test Loss: 1.404 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1230295
	speed: 0.2861s/iter; left time: 9473.4463s
	iters: 200, epoch: 11 | loss: 0.1381775
	speed: 0.0517s/iter; left time: 1707.8997s
	iters: 300, epoch: 11 | loss: 0.2279400
	speed: 0.0595s/iter; left time: 1958.5237s
Epoch: 11 cost time: 23.216794729232788
Epoch: 11, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.584 Vali Acc: 0.642 Test Loss: 1.584 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0228917
	speed: 0.3256s/iter; left time: 10659.3838s
	iters: 200, epoch: 12 | loss: 0.0738904
	speed: 0.0782s/iter; left time: 2552.8300s
	iters: 300, epoch: 12 | loss: 0.2654223
	speed: 0.0680s/iter; left time: 2211.3258s
Epoch: 12 cost time: 28.455394506454468
Epoch: 12, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.697 Vali Acc: 0.641 Test Loss: 1.697 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0089218
	speed: 0.3185s/iter; left time: 10310.6372s
	iters: 200, epoch: 13 | loss: 0.0268818
	speed: 0.0832s/iter; left time: 2683.9876s
	iters: 300, epoch: 13 | loss: 0.0861842
	speed: 0.0826s/iter; left time: 2656.4594s
Epoch: 13 cost time: 29.1067852973938
Epoch: 13, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.732 Vali Acc: 0.625 Test Loss: 1.732 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0737115
	speed: 0.3126s/iter; left time: 10004.1037s
	iters: 200, epoch: 14 | loss: 0.0324419
	speed: 0.0663s/iter; left time: 2115.6153s
	iters: 300, epoch: 14 | loss: 0.2345843
	speed: 0.0777s/iter; left time: 2470.7133s
Epoch: 14 cost time: 28.350467920303345
Epoch: 14, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.819 Vali Acc: 0.640 Test Loss: 1.819 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0458544
	speed: 0.3437s/iter; left time: 10871.8816s
	iters: 200, epoch: 15 | loss: 0.1315009
	speed: 0.0600s/iter; left time: 1893.4890s
	iters: 300, epoch: 15 | loss: 0.2716469
	speed: 0.0592s/iter; left time: 1860.7961s
Epoch: 15 cost time: 25.572367429733276
Epoch: 15, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.912 Vali Acc: 0.628 Test Loss: 1.912 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0044392
	speed: 0.3336s/iter; left time: 10430.2580s
	iters: 200, epoch: 16 | loss: 0.0256530
	speed: 0.0787s/iter; left time: 2453.4026s
	iters: 300, epoch: 16 | loss: 0.0112252
	speed: 0.0655s/iter; left time: 2035.2969s
Epoch: 16 cost time: 27.163378953933716
Epoch: 16, Steps: 369 | Train Loss: 0.074 Vali Loss: 1.988 Vali Acc: 0.635 Test Loss: 1.988 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1828323
	speed: 0.3212s/iter; left time: 9923.4261s
	iters: 200, epoch: 17 | loss: 0.2609014
	speed: 0.0691s/iter; left time: 2128.8629s
	iters: 300, epoch: 17 | loss: 0.0083395
	speed: 0.0848s/iter; left time: 2603.4039s
Epoch: 17 cost time: 29.187633752822876
Epoch: 17, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.109 Vali Acc: 0.634 Test Loss: 2.109 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0388180
	speed: 0.3440s/iter; left time: 10500.5477s
	iters: 200, epoch: 18 | loss: 0.0113868
	speed: 0.0666s/iter; left time: 2027.1141s
	iters: 300, epoch: 18 | loss: 0.0583144
	speed: 0.0716s/iter; left time: 2171.8578s
Epoch: 18 cost time: 28.36360788345337
Epoch: 18, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.005 Vali Acc: 0.634 Test Loss: 2.005 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6452894438138479
model parameter : 98114
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5755203
	speed: 0.0836s/iter; left time: 3076.1333s
	iters: 200, epoch: 1 | loss: 0.6458437
	speed: 0.0544s/iter; left time: 1997.3916s
	iters: 300, epoch: 1 | loss: 0.4611182
	speed: 0.0679s/iter; left time: 2484.1861s
Epoch: 1 cost time: 25.391565322875977
Epoch: 1, Steps: 369 | Train Loss: 0.769 Vali Loss: 1.046 Vali Acc: 0.628 Test Loss: 1.046 Test Acc: 0.628
Validation loss decreased (inf --> -0.627969).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6671034
	speed: 0.2930s/iter; left time: 10673.9865s
	iters: 200, epoch: 2 | loss: 0.8589018
	speed: 0.0665s/iter; left time: 2414.6342s
	iters: 300, epoch: 2 | loss: 0.5780824
	speed: 0.0574s/iter; left time: 2078.7712s
Epoch: 2 cost time: 24.584583044052124
Epoch: 2, Steps: 369 | Train Loss: 0.770 Vali Loss: 1.507 Vali Acc: 0.612 Test Loss: 1.507 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7405784
	speed: 0.2772s/iter; left time: 9997.6856s
	iters: 200, epoch: 3 | loss: 1.1259813
	speed: 0.0566s/iter; left time: 2036.3621s
	iters: 300, epoch: 3 | loss: 0.8405209
	speed: 0.0640s/iter; left time: 2296.8814s
Epoch: 3 cost time: 23.906981945037842
Epoch: 3, Steps: 369 | Train Loss: 0.815 Vali Loss: 1.522 Vali Acc: 0.629 Test Loss: 1.522 Test Acc: 0.629
Validation loss decreased (-0.627969 --> -0.629383).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6592442
	speed: 0.2787s/iter; left time: 9946.8942s
	iters: 200, epoch: 4 | loss: 0.3320628
	speed: 0.0683s/iter; left time: 2432.3144s
	iters: 300, epoch: 4 | loss: 1.3160866
	speed: 0.0602s/iter; left time: 2138.3362s
Epoch: 4 cost time: 23.624335765838623
Epoch: 4, Steps: 369 | Train Loss: 0.697 Vali Loss: 1.593 Vali Acc: 0.631 Test Loss: 1.593 Test Acc: 0.631
Validation loss decreased (-0.629383 --> -0.630801).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8215114
	speed: 0.2681s/iter; left time: 9469.5571s
	iters: 200, epoch: 5 | loss: 0.2850373
	speed: 0.0558s/iter; left time: 1963.9306s
	iters: 300, epoch: 5 | loss: 0.4360673
	speed: 0.0521s/iter; left time: 1829.1298s
Epoch: 5 cost time: 22.371963500976562
Epoch: 5, Steps: 369 | Train Loss: 0.610 Vali Loss: 1.433 Vali Acc: 0.641 Test Loss: 1.433 Test Acc: 0.641
Validation loss decreased (-0.630801 --> -0.641302).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6192957
	speed: 0.2737s/iter; left time: 9565.9308s
	iters: 200, epoch: 6 | loss: 0.8048992
	speed: 0.0542s/iter; left time: 1889.1668s
	iters: 300, epoch: 6 | loss: 1.0715239
	speed: 0.0632s/iter; left time: 2196.2195s
Epoch: 6 cost time: 22.910629749298096
Epoch: 6, Steps: 369 | Train Loss: 0.460 Vali Loss: 1.323 Vali Acc: 0.642 Test Loss: 1.323 Test Acc: 0.642
Validation loss decreased (-0.641302 --> -0.641587).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2511373
	speed: 0.2868s/iter; left time: 9921.1158s
	iters: 200, epoch: 7 | loss: 0.2671500
	speed: 0.0739s/iter; left time: 2549.0580s
	iters: 300, epoch: 7 | loss: 0.3632750
	speed: 0.0594s/iter; left time: 2043.8679s
Epoch: 7 cost time: 25.32400679588318
Epoch: 7, Steps: 369 | Train Loss: 0.353 Vali Loss: 1.165 Vali Acc: 0.643 Test Loss: 1.165 Test Acc: 0.643
Validation loss decreased (-0.641587 --> -0.643008).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2455314
	speed: 0.2790s/iter; left time: 9545.2482s
	iters: 200, epoch: 8 | loss: 0.1560528
	speed: 0.0566s/iter; left time: 1930.2675s
	iters: 300, epoch: 8 | loss: 0.4696767
	speed: 0.0579s/iter; left time: 1968.8852s
Epoch: 8 cost time: 21.820231437683105
Epoch: 8, Steps: 369 | Train Loss: 0.287 Vali Loss: 1.212 Vali Acc: 0.640 Test Loss: 1.212 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0874513
	speed: 0.2339s/iter; left time: 7916.9632s
	iters: 200, epoch: 9 | loss: 0.1847694
	speed: 0.0516s/iter; left time: 1740.5029s
	iters: 300, epoch: 9 | loss: 0.0619918
	speed: 0.0483s/iter; left time: 1625.8258s
Epoch: 9 cost time: 19.00585174560547
Epoch: 9, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.240 Vali Acc: 0.653 Test Loss: 1.240 Test Acc: 0.653
Validation loss decreased (-0.643008 --> -0.652655).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0757487
	speed: 0.2584s/iter; left time: 8652.7329s
	iters: 200, epoch: 10 | loss: 0.0648110
	speed: 0.0456s/iter; left time: 1523.3986s
	iters: 300, epoch: 10 | loss: 0.3231165
	speed: 0.0465s/iter; left time: 1548.5138s
Epoch: 10 cost time: 17.98215651512146
Epoch: 10, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.316 Vali Acc: 0.647 Test Loss: 1.316 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0267206
	speed: 0.2410s/iter; left time: 7978.5384s
	iters: 200, epoch: 11 | loss: 0.0415570
	speed: 0.0441s/iter; left time: 1456.4453s
	iters: 300, epoch: 11 | loss: 0.0641530
	speed: 0.0452s/iter; left time: 1486.4448s
Epoch: 11 cost time: 17.857921838760376
Epoch: 11, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.373 Vali Acc: 0.648 Test Loss: 1.373 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0503194
	speed: 0.2389s/iter; left time: 7821.3764s
	iters: 200, epoch: 12 | loss: 0.0312256
	speed: 0.0499s/iter; left time: 1630.3900s
	iters: 300, epoch: 12 | loss: 0.1560491
	speed: 0.0503s/iter; left time: 1638.3385s
Epoch: 12 cost time: 19.67554783821106
Epoch: 12, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.539 Vali Acc: 0.645 Test Loss: 1.539 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1367215
	speed: 0.2704s/iter; left time: 8753.2201s
	iters: 200, epoch: 13 | loss: 0.0158382
	speed: 0.0591s/iter; left time: 1907.4868s
	iters: 300, epoch: 13 | loss: 0.2615447
	speed: 0.0639s/iter; left time: 2055.2307s
Epoch: 13 cost time: 23.929243803024292
Epoch: 13, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.633 Vali Acc: 0.634 Test Loss: 1.633 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0331272
	speed: 0.2863s/iter; left time: 9162.6703s
	iters: 200, epoch: 14 | loss: 0.0778312
	speed: 0.0688s/iter; left time: 2195.8685s
	iters: 300, epoch: 14 | loss: 0.2952311
	speed: 0.0567s/iter; left time: 1804.7139s
Epoch: 14 cost time: 23.652504205703735
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.617 Vali Acc: 0.640 Test Loss: 1.617 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0561311
	speed: 0.2621s/iter; left time: 8291.4572s
	iters: 200, epoch: 15 | loss: 0.3043372
	speed: 0.0511s/iter; left time: 1611.6208s
	iters: 300, epoch: 15 | loss: 0.2802333
	speed: 0.0505s/iter; left time: 1586.8637s
Epoch: 15 cost time: 20.547856330871582
Epoch: 15, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.743 Vali Acc: 0.634 Test Loss: 1.743 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0361850
	speed: 0.2985s/iter; left time: 9332.2987s
	iters: 200, epoch: 16 | loss: 0.1075296
	speed: 0.0683s/iter; left time: 2129.5875s
	iters: 300, epoch: 16 | loss: 0.3426187
	speed: 0.0551s/iter; left time: 1710.3498s
Epoch: 16 cost time: 23.802103996276855
Epoch: 16, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.814 Vali Acc: 0.640 Test Loss: 1.814 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3034345
	speed: 0.2714s/iter; left time: 8386.1590s
	iters: 200, epoch: 17 | loss: 0.0573217
	speed: 0.0557s/iter; left time: 1715.5147s
	iters: 300, epoch: 17 | loss: 0.2256646
	speed: 0.0623s/iter; left time: 1912.3301s
Epoch: 17 cost time: 23.674072265625
Epoch: 17, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.913 Vali Acc: 0.650 Test Loss: 1.913 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1188800
	speed: 0.3036s/iter; left time: 9267.7264s
	iters: 200, epoch: 18 | loss: 0.0092643
	speed: 0.0736s/iter; left time: 2238.9110s
	iters: 300, epoch: 18 | loss: 0.1346744
	speed: 0.0582s/iter; left time: 1766.3351s
Epoch: 18 cost time: 25.192204236984253
Epoch: 18, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.898 Vali Acc: 0.639 Test Loss: 1.898 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0371689
	speed: 0.2710s/iter; left time: 8173.9705s
	iters: 200, epoch: 19 | loss: 0.0076943
	speed: 0.0516s/iter; left time: 1552.3759s
	iters: 300, epoch: 19 | loss: 0.0717301
	speed: 0.0572s/iter; left time: 1714.6257s
Epoch: 19 cost time: 22.4350483417511
Epoch: 19, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.029 Vali Acc: 0.642 Test Loss: 2.029 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 84338
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7228850
	speed: 0.0756s/iter; left time: 2781.2592s
	iters: 200, epoch: 1 | loss: 0.8486496
	speed: 0.0532s/iter; left time: 1951.1401s
	iters: 300, epoch: 1 | loss: 0.7256084
	speed: 0.0634s/iter; left time: 2321.1173s
Epoch: 1 cost time: 23.797555208206177
Epoch: 1, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.966 Vali Acc: 0.614 Test Loss: 0.966 Test Acc: 0.614
Validation loss decreased (inf --> -0.614349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3462653
	speed: 0.2473s/iter; left time: 9009.1696s
	iters: 200, epoch: 2 | loss: 1.3278143
	speed: 0.0652s/iter; left time: 2370.3282s
	iters: 300, epoch: 2 | loss: 0.8635459
	speed: 0.0501s/iter; left time: 1816.1184s
Epoch: 2 cost time: 22.164053440093994
Epoch: 2, Steps: 369 | Train Loss: 0.720 Vali Loss: 1.261 Vali Acc: 0.617 Test Loss: 1.261 Test Acc: 0.617
Validation loss decreased (-0.614349 --> -0.616616).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1842591
	speed: 0.2383s/iter; left time: 8593.7066s
	iters: 200, epoch: 3 | loss: 0.1699113
	speed: 0.0472s/iter; left time: 1696.7866s
	iters: 300, epoch: 3 | loss: 1.3950107
	speed: 0.0498s/iter; left time: 1785.7123s
Epoch: 3 cost time: 19.922809600830078
Epoch: 3, Steps: 369 | Train Loss: 0.754 Vali Loss: 1.257 Vali Acc: 0.625 Test Loss: 1.257 Test Acc: 0.625
Validation loss decreased (-0.616616 --> -0.625413).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4076893
	speed: 0.2622s/iter; left time: 9359.3375s
	iters: 200, epoch: 4 | loss: 0.5119373
	speed: 0.0599s/iter; left time: 2133.5078s
	iters: 300, epoch: 4 | loss: 0.3380675
	speed: 0.0603s/iter; left time: 2138.8403s
Epoch: 4 cost time: 21.066272020339966
Epoch: 4, Steps: 369 | Train Loss: 0.679 Vali Loss: 1.302 Vali Acc: 0.642 Test Loss: 1.302 Test Acc: 0.642
Validation loss decreased (-0.625413 --> -0.642155).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8346257
	speed: 0.2741s/iter; left time: 9681.0233s
	iters: 200, epoch: 5 | loss: 0.9471850
	speed: 0.0448s/iter; left time: 1579.2982s
	iters: 300, epoch: 5 | loss: 0.5249251
	speed: 0.0443s/iter; left time: 1555.7529s
Epoch: 5 cost time: 18.794845819473267
Epoch: 5, Steps: 369 | Train Loss: 0.581 Vali Loss: 1.245 Vali Acc: 0.636 Test Loss: 1.245 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4738235
	speed: 0.2363s/iter; left time: 8261.7225s
	iters: 200, epoch: 6 | loss: 0.5681483
	speed: 0.0510s/iter; left time: 1777.7991s
	iters: 300, epoch: 6 | loss: 0.5649378
	speed: 0.0644s/iter; left time: 2237.4449s
Epoch: 6 cost time: 22.20332145690918
Epoch: 6, Steps: 369 | Train Loss: 0.469 Vali Loss: 1.238 Vali Acc: 0.641 Test Loss: 1.238 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3580249
	speed: 0.2572s/iter; left time: 8895.3924s
	iters: 200, epoch: 7 | loss: 0.2080383
	speed: 0.0646s/iter; left time: 2228.2111s
	iters: 300, epoch: 7 | loss: 0.4871472
	speed: 0.0534s/iter; left time: 1835.4478s
Epoch: 7 cost time: 22.711464166641235
Epoch: 7, Steps: 369 | Train Loss: 0.371 Vali Loss: 1.127 Vali Acc: 0.635 Test Loss: 1.127 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0749308
	speed: 0.2531s/iter; left time: 8661.5050s
	iters: 200, epoch: 8 | loss: 0.3495016
	speed: 0.0526s/iter; left time: 1793.7210s
	iters: 300, epoch: 8 | loss: 0.3984931
	speed: 0.0488s/iter; left time: 1659.5968s
Epoch: 8 cost time: 20.802409410476685
Epoch: 8, Steps: 369 | Train Loss: 0.316 Vali Loss: 1.062 Vali Acc: 0.648 Test Loss: 1.062 Test Acc: 0.648
Validation loss decreased (-0.642155 --> -0.648400).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1619504
	speed: 0.2470s/iter; left time: 8361.7465s
	iters: 200, epoch: 9 | loss: 0.3111126
	speed: 0.0492s/iter; left time: 1660.9472s
	iters: 300, epoch: 9 | loss: 0.3849672
	speed: 0.0449s/iter; left time: 1510.2623s
Epoch: 9 cost time: 17.951595544815063
Epoch: 9, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.058 Vali Acc: 0.634 Test Loss: 1.058 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1655897
	speed: 0.2252s/iter; left time: 7540.0542s
	iters: 200, epoch: 10 | loss: 0.3061267
	speed: 0.0413s/iter; left time: 1377.8689s
	iters: 300, epoch: 10 | loss: 0.4812516
	speed: 0.0396s/iter; left time: 1319.0139s
Epoch: 10 cost time: 16.39899516105652
Epoch: 10, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.160 Vali Acc: 0.639 Test Loss: 1.160 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0974773
	speed: 0.2329s/iter; left time: 7709.9072s
	iters: 200, epoch: 11 | loss: 0.1498550
	speed: 0.0408s/iter; left time: 1346.3219s
	iters: 300, epoch: 11 | loss: 0.4304712
	speed: 0.0394s/iter; left time: 1296.6871s
Epoch: 11 cost time: 16.609609365463257
Epoch: 11, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.239 Vali Acc: 0.641 Test Loss: 1.239 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1178756
	speed: 0.2053s/iter; left time: 6722.8672s
	iters: 200, epoch: 12 | loss: 0.5191674
	speed: 0.0467s/iter; left time: 1523.4006s
	iters: 300, epoch: 12 | loss: 0.1519025
	speed: 0.0652s/iter; left time: 2121.4165s
Epoch: 12 cost time: 21.17206048965454
Epoch: 12, Steps: 369 | Train Loss: 0.181 Vali Loss: 1.316 Vali Acc: 0.641 Test Loss: 1.316 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0480839
	speed: 0.2739s/iter; left time: 8866.2025s
	iters: 200, epoch: 13 | loss: 0.0887597
	speed: 0.0665s/iter; left time: 2145.0748s
	iters: 300, epoch: 13 | loss: 0.1645110
	speed: 0.0499s/iter; left time: 1604.7926s
Epoch: 13 cost time: 22.87514042854309
Epoch: 13, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.332 Vali Acc: 0.642 Test Loss: 1.332 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0941169
	speed: 0.2468s/iter; left time: 7898.1407s
	iters: 200, epoch: 14 | loss: 0.0774209
	speed: 0.0449s/iter; left time: 1433.9745s
	iters: 300, epoch: 14 | loss: 0.0934494
	speed: 0.0468s/iter; left time: 1488.4385s
Epoch: 14 cost time: 18.173543214797974
Epoch: 14, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.443 Vali Acc: 0.658 Test Loss: 1.443 Test Acc: 0.658
Validation loss decreased (-0.648400 --> -0.657761).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0220090
	speed: 0.2549s/iter; left time: 8064.7199s
	iters: 200, epoch: 15 | loss: 0.2214112
	speed: 0.0551s/iter; left time: 1739.0783s
	iters: 300, epoch: 15 | loss: 0.2174264
	speed: 0.0633s/iter; left time: 1990.7971s
Epoch: 15 cost time: 21.257508516311646
Epoch: 15, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.496 Vali Acc: 0.637 Test Loss: 1.496 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0582149
	speed: 0.2710s/iter; left time: 8473.6122s
	iters: 200, epoch: 16 | loss: 0.2980739
	speed: 0.0553s/iter; left time: 1724.9944s
	iters: 300, epoch: 16 | loss: 0.1849233
	speed: 0.0495s/iter; left time: 1537.1349s
Epoch: 16 cost time: 20.926385164260864
Epoch: 16, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.554 Vali Acc: 0.656 Test Loss: 1.554 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0590328
	speed: 0.2694s/iter; left time: 8322.6739s
	iters: 200, epoch: 17 | loss: 0.0508773
	speed: 0.0507s/iter; left time: 1561.2046s
	iters: 300, epoch: 17 | loss: 0.2220391
	speed: 0.0432s/iter; left time: 1327.1514s
Epoch: 17 cost time: 20.441760540008545
Epoch: 17, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.601 Vali Acc: 0.638 Test Loss: 1.601 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0304836
	speed: 0.2546s/iter; left time: 7771.0067s
	iters: 200, epoch: 18 | loss: 0.0652243
	speed: 0.0593s/iter; left time: 1805.2352s
	iters: 300, epoch: 18 | loss: 0.0156618
	speed: 0.0592s/iter; left time: 1795.0410s
Epoch: 18 cost time: 21.09749460220337
Epoch: 18, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.603 Vali Acc: 0.645 Test Loss: 1.603 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0965508
	speed: 0.2553s/iter; left time: 7699.4472s
	iters: 200, epoch: 19 | loss: 0.0148979
	speed: 0.0481s/iter; left time: 1445.6564s
	iters: 300, epoch: 19 | loss: 0.0169261
	speed: 0.0474s/iter; left time: 1420.7735s
Epoch: 19 cost time: 19.71368980407715
Epoch: 19, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.691 Vali Acc: 0.637 Test Loss: 1.691 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0790539
	speed: 0.2320s/iter; left time: 6910.8815s
	iters: 200, epoch: 20 | loss: 0.0103396
	speed: 0.0442s/iter; left time: 1311.7460s
	iters: 300, epoch: 20 | loss: 0.1087820
	speed: 0.0547s/iter; left time: 1618.6644s
Epoch: 20 cost time: 18.921332597732544
Epoch: 20, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.671 Vali Acc: 0.658 Test Loss: 1.671 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1230876
	speed: 0.2510s/iter; left time: 7384.5510s
	iters: 200, epoch: 21 | loss: 0.0424898
	speed: 0.0600s/iter; left time: 1759.8499s
	iters: 300, epoch: 21 | loss: 0.0244874
	speed: 0.0509s/iter; left time: 1487.0588s
Epoch: 21 cost time: 20.71694779396057
Epoch: 21, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.768 Vali Acc: 0.637 Test Loss: 1.768 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2002819
	speed: 0.2489s/iter; left time: 7231.4331s
	iters: 200, epoch: 22 | loss: 0.1947898
	speed: 0.0423s/iter; left time: 1225.2489s
	iters: 300, epoch: 22 | loss: 0.1291616
	speed: 0.0433s/iter; left time: 1248.0768s
Epoch: 22 cost time: 18.41977596282959
Epoch: 22, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.770 Vali Acc: 0.638 Test Loss: 1.770 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0260269
	speed: 0.2666s/iter; left time: 7646.2203s
	iters: 200, epoch: 23 | loss: 0.1534560
	speed: 0.0526s/iter; left time: 1502.9932s
	iters: 300, epoch: 23 | loss: 0.0236740
	speed: 0.0642s/iter; left time: 1827.9531s
Epoch: 23 cost time: 21.79775047302246
Epoch: 23, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.824 Vali Acc: 0.636 Test Loss: 1.824 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0024378
	speed: 0.2722s/iter; left time: 7708.0702s
	iters: 200, epoch: 24 | loss: 0.0078793
	speed: 0.0635s/iter; left time: 1792.9241s
	iters: 300, epoch: 24 | loss: 0.0077782
	speed: 0.0494s/iter; left time: 1387.4469s
Epoch: 24 cost time: 22.546802282333374
Epoch: 24, Steps: 369 | Train Loss: 0.075 Vali Loss: 1.801 Vali Acc: 0.639 Test Loss: 1.801 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 70562
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8631380
	speed: 0.0657s/iter; left time: 2419.5274s
	iters: 200, epoch: 1 | loss: 0.6478947
	speed: 0.0381s/iter; left time: 1398.8915s
	iters: 300, epoch: 1 | loss: 0.9202234
	speed: 0.0377s/iter; left time: 1380.2095s
Epoch: 1 cost time: 16.99014401435852
Epoch: 1, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.980 Vali Acc: 0.622 Test Loss: 0.980 Test Acc: 0.622
Validation loss decreased (inf --> -0.621727).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4251389
	speed: 0.2234s/iter; left time: 8137.5215s
	iters: 200, epoch: 2 | loss: 0.9368160
	speed: 0.0379s/iter; left time: 1377.6539s
	iters: 300, epoch: 2 | loss: 0.5587349
	speed: 0.0422s/iter; left time: 1527.3457s
Epoch: 2 cost time: 16.886500358581543
Epoch: 2, Steps: 369 | Train Loss: 0.668 Vali Loss: 1.091 Vali Acc: 0.636 Test Loss: 1.091 Test Acc: 0.636
Validation loss decreased (-0.621727 --> -0.636198).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4474890
	speed: 0.2227s/iter; left time: 8029.4360s
	iters: 200, epoch: 3 | loss: 0.5375049
	speed: 0.0436s/iter; left time: 1567.5633s
	iters: 300, epoch: 3 | loss: 0.5163653
	speed: 0.0548s/iter; left time: 1966.3682s
Epoch: 3 cost time: 18.466041088104248
Epoch: 3, Steps: 369 | Train Loss: 0.688 Vali Loss: 1.130 Vali Acc: 0.653 Test Loss: 1.130 Test Acc: 0.653
Validation loss decreased (-0.636198 --> -0.652940).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7411399
	speed: 0.2217s/iter; left time: 7911.7038s
	iters: 200, epoch: 4 | loss: 0.9882348
	speed: 0.0496s/iter; left time: 1765.7574s
	iters: 300, epoch: 4 | loss: 1.5436444
	speed: 0.0549s/iter; left time: 1949.9568s
Epoch: 4 cost time: 19.17711615562439
Epoch: 4, Steps: 369 | Train Loss: 0.636 Vali Loss: 1.269 Vali Acc: 0.636 Test Loss: 1.269 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6178969
	speed: 0.2260s/iter; left time: 7981.7850s
	iters: 200, epoch: 5 | loss: 0.5378221
	speed: 0.0544s/iter; left time: 1915.0202s
	iters: 300, epoch: 5 | loss: 0.3586811
	speed: 0.0478s/iter; left time: 1677.6387s
Epoch: 5 cost time: 18.91794443130493
Epoch: 5, Steps: 369 | Train Loss: 0.564 Vali Loss: 1.190 Vali Acc: 0.660 Test Loss: 1.190 Test Acc: 0.660
Validation loss decreased (-0.652940 --> -0.660034).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5130609
	speed: 0.2159s/iter; left time: 7547.6592s
	iters: 200, epoch: 6 | loss: 0.2315832
	speed: 0.0471s/iter; left time: 1640.5608s
	iters: 300, epoch: 6 | loss: 1.4931517
	speed: 0.0378s/iter; left time: 1314.9970s
Epoch: 6 cost time: 16.99312686920166
Epoch: 6, Steps: 369 | Train Loss: 0.483 Vali Loss: 1.178 Vali Acc: 0.647 Test Loss: 1.178 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7924355
	speed: 0.2229s/iter; left time: 7708.3728s
	iters: 200, epoch: 7 | loss: 0.3649313
	speed: 0.0379s/iter; left time: 1305.6634s
	iters: 300, epoch: 7 | loss: 0.1083618
	speed: 0.0366s/iter; left time: 1256.9132s
Epoch: 7 cost time: 15.626121997833252
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 1.214 Vali Acc: 0.631 Test Loss: 1.214 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6822786
	speed: 0.1843s/iter; left time: 6305.0342s
	iters: 200, epoch: 8 | loss: 0.1472099
	speed: 0.0355s/iter; left time: 1211.2226s
	iters: 300, epoch: 8 | loss: 0.7450852
	speed: 0.0354s/iter; left time: 1205.6841s
Epoch: 8 cost time: 14.108245849609375
Epoch: 8, Steps: 369 | Train Loss: 0.354 Vali Loss: 1.094 Vali Acc: 0.662 Test Loss: 1.094 Test Acc: 0.662
Validation loss decreased (-0.660034 --> -0.662021).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3088993
	speed: 0.2008s/iter; left time: 6796.9092s
	iters: 200, epoch: 9 | loss: 0.2887416
	speed: 0.0394s/iter; left time: 1330.9379s
	iters: 300, epoch: 9 | loss: 0.2027530
	speed: 0.0376s/iter; left time: 1266.6348s
Epoch: 9 cost time: 15.698453664779663
Epoch: 9, Steps: 369 | Train Loss: 0.314 Vali Loss: 1.071 Vali Acc: 0.649 Test Loss: 1.071 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4224330
	speed: 0.1982s/iter; left time: 6635.8566s
	iters: 200, epoch: 10 | loss: 0.1741541
	speed: 0.0396s/iter; left time: 1321.0100s
	iters: 300, epoch: 10 | loss: 0.1619049
	speed: 0.0392s/iter; left time: 1303.3512s
Epoch: 10 cost time: 15.23675537109375
Epoch: 10, Steps: 369 | Train Loss: 0.250 Vali Loss: 1.139 Vali Acc: 0.645 Test Loss: 1.139 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2701941
	speed: 0.1938s/iter; left time: 6416.4241s
	iters: 200, epoch: 11 | loss: 0.0598614
	speed: 0.0361s/iter; left time: 1192.2719s
	iters: 300, epoch: 11 | loss: 0.1300465
	speed: 0.0355s/iter; left time: 1169.4551s
Epoch: 11 cost time: 14.088181734085083
Epoch: 11, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.228 Vali Acc: 0.645 Test Loss: 1.228 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1945100
	speed: 0.1902s/iter; left time: 6227.0432s
	iters: 200, epoch: 12 | loss: 0.5795696
	speed: 0.0389s/iter; left time: 1268.6948s
	iters: 300, epoch: 12 | loss: 0.2982678
	speed: 0.0375s/iter; left time: 1219.6655s
Epoch: 12 cost time: 14.976759195327759
Epoch: 12, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.216 Vali Acc: 0.644 Test Loss: 1.216 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0743723
	speed: 0.1977s/iter; left time: 6399.1595s
	iters: 200, epoch: 13 | loss: 0.3509939
	speed: 0.0356s/iter; left time: 1149.9624s
	iters: 300, epoch: 13 | loss: 0.0826029
	speed: 0.0354s/iter; left time: 1137.8793s
Epoch: 13 cost time: 13.971335649490356
Epoch: 13, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.287 Vali Acc: 0.642 Test Loss: 1.287 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0390347
	speed: 0.1911s/iter; left time: 6114.7342s
	iters: 200, epoch: 14 | loss: 0.2226786
	speed: 0.0327s/iter; left time: 1041.9934s
	iters: 300, epoch: 14 | loss: 0.0657760
	speed: 0.0394s/iter; left time: 1254.1871s
Epoch: 14 cost time: 14.62110686302185
Epoch: 14, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.311 Vali Acc: 0.644 Test Loss: 1.311 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1446006
	speed: 0.2191s/iter; left time: 6929.9799s
	iters: 200, epoch: 15 | loss: 0.0833341
	speed: 0.0577s/iter; left time: 1818.5388s
	iters: 300, epoch: 15 | loss: 0.5201883
	speed: 0.0461s/iter; left time: 1449.1406s
Epoch: 15 cost time: 19.885764837265015
Epoch: 15, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.428 Vali Acc: 0.646 Test Loss: 1.428 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3651502
	speed: 0.2294s/iter; left time: 7173.8075s
	iters: 200, epoch: 16 | loss: 0.0391053
	speed: 0.0430s/iter; left time: 1339.6157s
	iters: 300, epoch: 16 | loss: 0.1622652
	speed: 0.0431s/iter; left time: 1340.1690s
Epoch: 16 cost time: 17.932940006256104
Epoch: 16, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.494 Vali Acc: 0.646 Test Loss: 1.494 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0080055
	speed: 0.2227s/iter; left time: 6879.7908s
	iters: 200, epoch: 17 | loss: 0.1125611
	speed: 0.0379s/iter; left time: 1166.6793s
	iters: 300, epoch: 17 | loss: 0.1846878
	speed: 0.0389s/iter; left time: 1193.4312s
Epoch: 17 cost time: 16.04704737663269
Epoch: 17, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.541 Vali Acc: 0.646 Test Loss: 1.541 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0997886
	speed: 0.2194s/iter; left time: 6698.2410s
	iters: 200, epoch: 18 | loss: 0.0267380
	speed: 0.0387s/iter; left time: 1177.4358s
	iters: 300, epoch: 18 | loss: 0.3678960
	speed: 0.0374s/iter; left time: 1135.1384s
Epoch: 18 cost time: 16.030644178390503
Epoch: 18, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.603 Vali Acc: 0.647 Test Loss: 1.603 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6620317820658342
model parameter : 61394
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8229693
	speed: 0.1804s/iter; left time: 6639.5041s
	iters: 200, epoch: 1 | loss: 1.0726968
	speed: 0.2287s/iter; left time: 8394.3127s
	iters: 300, epoch: 1 | loss: 1.3634453
	speed: 0.1584s/iter; left time: 5798.3697s
Epoch: 1 cost time: 69.26919770240784
Epoch: 1, Steps: 369 | Train Loss: 1.337 Vali Loss: 0.953 Vali Acc: 0.643 Test Loss: 0.953 Test Acc: 0.643
Validation loss decreased (inf --> -0.643294).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4829350
	speed: 0.5555s/iter; left time: 20237.0877s
	iters: 200, epoch: 2 | loss: 1.0359813
	speed: 0.1889s/iter; left time: 6861.9257s
	iters: 300, epoch: 2 | loss: 1.0433254
	speed: 0.1886s/iter; left time: 6831.9997s
Epoch: 2 cost time: 67.12460780143738
Epoch: 2, Steps: 369 | Train Loss: 1.590 Vali Loss: 2.135 Vali Acc: 0.642 Test Loss: 2.135 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9888637
	speed: 0.7282s/iter; left time: 26259.4391s
	iters: 200, epoch: 3 | loss: 4.8192263
	speed: 0.1952s/iter; left time: 7020.6592s
	iters: 300, epoch: 3 | loss: 2.0029953
	speed: 0.2139s/iter; left time: 7671.0162s
Epoch: 3 cost time: 75.45265293121338
Epoch: 3, Steps: 369 | Train Loss: 1.918 Vali Loss: 1.962 Vali Acc: 0.645 Test Loss: 1.962 Test Acc: 0.645
Validation loss decreased (-0.643294 --> -0.644702).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3185205
	speed: 0.6647s/iter; left time: 23724.7621s
	iters: 200, epoch: 4 | loss: 1.4118559
	speed: 0.1843s/iter; left time: 6559.6261s
	iters: 300, epoch: 4 | loss: 0.3207630
	speed: 0.1857s/iter; left time: 6592.0954s
Epoch: 4 cost time: 70.58406829833984
Epoch: 4, Steps: 369 | Train Loss: 1.636 Vali Loss: 2.957 Vali Acc: 0.628 Test Loss: 2.957 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3678498
	speed: 0.6721s/iter; left time: 23740.6049s
	iters: 200, epoch: 5 | loss: 0.3686894
	speed: 0.2095s/iter; left time: 7381.1715s
	iters: 300, epoch: 5 | loss: 0.6341788
	speed: 0.1861s/iter; left time: 6535.8193s
Epoch: 5 cost time: 75.9541745185852
Epoch: 5, Steps: 369 | Train Loss: 0.975 Vali Loss: 2.553 Vali Acc: 0.601 Test Loss: 2.553 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6157542
	speed: 0.7003s/iter; left time: 24480.9778s
	iters: 200, epoch: 6 | loss: 0.5241564
	speed: 0.1869s/iter; left time: 6514.3022s
	iters: 300, epoch: 6 | loss: 0.6839903
	speed: 0.1984s/iter; left time: 6896.1159s
Epoch: 6 cost time: 71.21451687812805
Epoch: 6, Steps: 369 | Train Loss: 0.416 Vali Loss: 1.806 Vali Acc: 0.640 Test Loss: 1.806 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2208671
	speed: 0.6489s/iter; left time: 22443.3827s
	iters: 200, epoch: 7 | loss: 0.2406114
	speed: 0.1671s/iter; left time: 5763.0038s
	iters: 300, epoch: 7 | loss: 0.3318450
	speed: 0.1670s/iter; left time: 5741.8834s
Epoch: 7 cost time: 63.843740701675415
Epoch: 7, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.626 Vali Acc: 0.610 Test Loss: 1.626 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3636706
	speed: 0.5792s/iter; left time: 19819.0341s
	iters: 200, epoch: 8 | loss: 0.2324508
	speed: 0.1648s/iter; left time: 5622.5196s
	iters: 300, epoch: 8 | loss: 0.0080334
	speed: 0.2196s/iter; left time: 7471.0326s
Epoch: 8 cost time: 68.10847115516663
Epoch: 8, Steps: 369 | Train Loss: 0.184 Vali Loss: 2.219 Vali Acc: 0.616 Test Loss: 2.219 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0701433
	speed: 0.6766s/iter; left time: 22903.8295s
	iters: 200, epoch: 9 | loss: 0.0286819
	speed: 0.1932s/iter; left time: 6520.6553s
	iters: 300, epoch: 9 | loss: 0.1703184
	speed: 0.1851s/iter; left time: 6227.2399s
Epoch: 9 cost time: 71.69482398033142
Epoch: 9, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.718 Vali Acc: 0.627 Test Loss: 1.718 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0135183
	speed: 0.7043s/iter; left time: 23580.0509s
	iters: 200, epoch: 10 | loss: 0.0112975
	speed: 0.2057s/iter; left time: 6866.2984s
	iters: 300, epoch: 10 | loss: 0.0705325
	speed: 0.2074s/iter; left time: 6903.9179s
Epoch: 10 cost time: 73.53325867652893
Epoch: 10, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.825 Vali Acc: 0.625 Test Loss: 1.825 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0593240
	speed: 0.6830s/iter; left time: 22614.8447s
	iters: 200, epoch: 11 | loss: 0.0099402
	speed: 0.1732s/iter; left time: 5718.0591s
	iters: 300, epoch: 11 | loss: 0.1664595
	speed: 0.2008s/iter; left time: 6608.0173s
Epoch: 11 cost time: 71.33631372451782
Epoch: 11, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.959 Vali Acc: 0.630 Test Loss: 1.959 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2229714
	speed: 0.7062s/iter; left time: 23121.9548s
	iters: 200, epoch: 12 | loss: 0.1838470
	speed: 0.2188s/iter; left time: 7142.0008s
	iters: 300, epoch: 12 | loss: 0.1045796
	speed: 0.1860s/iter; left time: 6053.9188s
Epoch: 12 cost time: 77.01924300193787
Epoch: 12, Steps: 369 | Train Loss: 0.074 Vali Loss: 2.216 Vali Acc: 0.629 Test Loss: 2.216 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0060665
	speed: 0.7257s/iter; left time: 23492.6768s
	iters: 200, epoch: 13 | loss: 0.1134103
	speed: 0.1702s/iter; left time: 5492.3908s
	iters: 300, epoch: 13 | loss: 0.0127238
	speed: 0.2066s/iter; left time: 6645.4197s
Epoch: 13 cost time: 70.50635147094727
Epoch: 13, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.349 Vali Acc: 0.627 Test Loss: 2.349 Test Acc: 0.627
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.64472190692395
model parameter : 301938
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2515070
	speed: 0.1009s/iter; left time: 3714.2494s
	iters: 200, epoch: 1 | loss: 0.8028363
	speed: 0.0719s/iter; left time: 2639.6067s
	iters: 300, epoch: 1 | loss: 0.8896223
	speed: 0.0714s/iter; left time: 2611.6429s
Epoch: 1 cost time: 29.854891300201416
Epoch: 1, Steps: 369 | Train Loss: 0.954 Vali Loss: 3.173 Vali Acc: 0.512 Test Loss: 3.173 Test Acc: 0.512
Validation loss decreased (inf --> -0.511603).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3106351
	speed: 0.3162s/iter; left time: 11518.3347s
	iters: 200, epoch: 2 | loss: 1.1939150
	speed: 0.0791s/iter; left time: 2875.6200s
	iters: 300, epoch: 2 | loss: 1.7975421
	speed: 0.0740s/iter; left time: 2682.7650s
Epoch: 2 cost time: 29.747238159179688
Epoch: 2, Steps: 369 | Train Loss: 1.134 Vali Loss: 1.526 Vali Acc: 0.652 Test Loss: 1.526 Test Acc: 0.652
Validation loss decreased (-0.511603 --> -0.652085).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2002934
	speed: 0.3761s/iter; left time: 13562.3400s
	iters: 200, epoch: 3 | loss: 1.0804133
	speed: 0.1088s/iter; left time: 3914.5281s
	iters: 300, epoch: 3 | loss: 1.6564989
	speed: 0.1060s/iter; left time: 3801.9177s
Epoch: 3 cost time: 37.98266363143921
Epoch: 3, Steps: 369 | Train Loss: 1.279 Vali Loss: 1.968 Vali Acc: 0.651 Test Loss: 1.968 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7536484
	speed: 0.3899s/iter; left time: 13915.7563s
	iters: 200, epoch: 4 | loss: 0.7238982
	speed: 0.1086s/iter; left time: 3865.5359s
	iters: 300, epoch: 4 | loss: 1.5756812
	speed: 0.1085s/iter; left time: 3850.4547s
Epoch: 4 cost time: 38.23664593696594
Epoch: 4, Steps: 369 | Train Loss: 1.093 Vali Loss: 1.817 Vali Acc: 0.648 Test Loss: 1.817 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8976087
	speed: 0.3921s/iter; left time: 13852.4564s
	iters: 200, epoch: 5 | loss: 0.3859989
	speed: 0.0915s/iter; left time: 3221.6642s
	iters: 300, epoch: 5 | loss: 0.4968649
	speed: 0.1199s/iter; left time: 4209.7755s
Epoch: 5 cost time: 37.37578320503235
Epoch: 5, Steps: 369 | Train Loss: 0.782 Vali Loss: 1.713 Vali Acc: 0.649 Test Loss: 1.713 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6492389
	speed: 0.3867s/iter; left time: 13518.0133s
	iters: 200, epoch: 6 | loss: 0.1865407
	speed: 0.1024s/iter; left time: 3570.4654s
	iters: 300, epoch: 6 | loss: 0.0944488
	speed: 0.1053s/iter; left time: 3660.8192s
Epoch: 6 cost time: 36.171504497528076
Epoch: 6, Steps: 369 | Train Loss: 0.454 Vali Loss: 1.492 Vali Acc: 0.632 Test Loss: 1.492 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0728732
	speed: 0.3975s/iter; left time: 13747.2116s
	iters: 200, epoch: 7 | loss: 0.1619760
	speed: 0.1139s/iter; left time: 3926.6841s
	iters: 300, epoch: 7 | loss: 0.1120870
	speed: 0.1016s/iter; left time: 3495.0373s
Epoch: 7 cost time: 38.05329418182373
Epoch: 7, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.582 Vali Acc: 0.626 Test Loss: 1.582 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1969962
	speed: 0.4133s/iter; left time: 14143.6656s
	iters: 200, epoch: 8 | loss: 0.1905400
	speed: 0.1172s/iter; left time: 3998.9848s
	iters: 300, epoch: 8 | loss: 0.6370963
	speed: 0.1023s/iter; left time: 3480.8559s
Epoch: 8 cost time: 38.59954357147217
Epoch: 8, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.461 Vali Acc: 0.636 Test Loss: 1.461 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2238657
	speed: 0.3927s/iter; left time: 13293.6848s
	iters: 200, epoch: 9 | loss: 0.2060801
	speed: 0.1138s/iter; left time: 3840.7431s
	iters: 300, epoch: 9 | loss: 0.1786977
	speed: 0.0978s/iter; left time: 3290.0455s
Epoch: 9 cost time: 35.69703984260559
Epoch: 9, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.525 Vali Acc: 0.642 Test Loss: 1.525 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0506411
	speed: 0.3679s/iter; left time: 12317.1745s
	iters: 200, epoch: 10 | loss: 0.0217221
	speed: 0.0940s/iter; left time: 3138.5791s
	iters: 300, epoch: 10 | loss: 0.2013408
	speed: 0.1039s/iter; left time: 3456.3233s
Epoch: 10 cost time: 34.994999170303345
Epoch: 10, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.716 Vali Acc: 0.621 Test Loss: 1.716 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0200202
	speed: 0.3968s/iter; left time: 13137.0968s
	iters: 200, epoch: 11 | loss: 0.0267240
	speed: 0.1022s/iter; left time: 3372.4043s
	iters: 300, epoch: 11 | loss: 0.2951450
	speed: 0.1122s/iter; left time: 3691.6275s
Epoch: 11 cost time: 38.15691351890564
Epoch: 11, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.915 Vali Acc: 0.631 Test Loss: 1.915 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0818527
	speed: 0.4002s/iter; left time: 13104.6460s
	iters: 200, epoch: 12 | loss: 0.1952088
	speed: 0.0984s/iter; left time: 3210.5379s
	iters: 300, epoch: 12 | loss: 0.1576164
	speed: 0.1123s/iter; left time: 3655.6728s
Epoch: 12 cost time: 37.02396774291992
Epoch: 12, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.844 Vali Acc: 0.638 Test Loss: 1.844 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6520998864926221
model parameter : 159122
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6381515
	speed: 0.0924s/iter; left time: 3400.0937s
	iters: 200, epoch: 1 | loss: 1.1091714
	speed: 0.0587s/iter; left time: 2155.1498s
	iters: 300, epoch: 1 | loss: 1.1715316
	speed: 0.0587s/iter; left time: 2148.3716s
Epoch: 1 cost time: 26.36077070236206
Epoch: 1, Steps: 369 | Train Loss: 0.898 Vali Loss: 1.015 Vali Acc: 0.646 Test Loss: 1.015 Test Acc: 0.646
Validation loss decreased (inf --> -0.646131).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4364097
	speed: 0.3140s/iter; left time: 11437.8910s
	iters: 200, epoch: 2 | loss: 1.3747859
	speed: 0.0899s/iter; left time: 3266.1474s
	iters: 300, epoch: 2 | loss: 0.8925923
	speed: 0.0811s/iter; left time: 2938.2651s
Epoch: 2 cost time: 29.9945068359375
Epoch: 2, Steps: 369 | Train Loss: 0.937 Vali Loss: 1.209 Vali Acc: 0.653 Test Loss: 1.209 Test Acc: 0.653
Validation loss decreased (-0.646131 --> -0.653223).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1013259
	speed: 0.2893s/iter; left time: 10431.9579s
	iters: 200, epoch: 3 | loss: 0.6815674
	speed: 0.0639s/iter; left time: 2297.5974s
	iters: 300, epoch: 3 | loss: 1.7101696
	speed: 0.0639s/iter; left time: 2293.2433s
Epoch: 3 cost time: 24.401516675949097
Epoch: 3, Steps: 369 | Train Loss: 1.038 Vali Loss: 1.469 Vali Acc: 0.620 Test Loss: 1.469 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0970606
	speed: 0.2559s/iter; left time: 9132.5318s
	iters: 200, epoch: 4 | loss: 1.3376876
	speed: 0.0578s/iter; left time: 2055.7242s
	iters: 300, epoch: 4 | loss: 0.5324935
	speed: 0.0592s/iter; left time: 2100.4058s
Epoch: 4 cost time: 22.33028483390808
Epoch: 4, Steps: 369 | Train Loss: 0.850 Vali Loss: 2.073 Vali Acc: 0.629 Test Loss: 2.073 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9595860
	speed: 0.2706s/iter; left time: 9558.4438s
	iters: 200, epoch: 5 | loss: 0.4458840
	speed: 0.0909s/iter; left time: 3203.2251s
	iters: 300, epoch: 5 | loss: 2.3160877
	speed: 0.0727s/iter; left time: 2553.4631s
Epoch: 5 cost time: 28.93256688117981
Epoch: 5, Steps: 369 | Train Loss: 0.635 Vali Loss: 1.889 Vali Acc: 0.623 Test Loss: 1.889 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1282307
	speed: 0.3169s/iter; left time: 11075.8335s
	iters: 200, epoch: 6 | loss: 0.3900913
	speed: 0.0769s/iter; left time: 2678.7864s
	iters: 300, epoch: 6 | loss: 0.7153687
	speed: 0.0947s/iter; left time: 3290.8509s
Epoch: 6 cost time: 30.251846075057983
Epoch: 6, Steps: 369 | Train Loss: 0.474 Vali Loss: 1.502 Vali Acc: 0.649 Test Loss: 1.502 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3872953
	speed: 0.3478s/iter; left time: 12030.5656s
	iters: 200, epoch: 7 | loss: 0.2636835
	speed: 0.0736s/iter; left time: 2538.1456s
	iters: 300, epoch: 7 | loss: 0.0543854
	speed: 0.0785s/iter; left time: 2698.7734s
Epoch: 7 cost time: 31.330982446670532
Epoch: 7, Steps: 369 | Train Loss: 0.311 Vali Loss: 1.308 Vali Acc: 0.635 Test Loss: 1.308 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8012719
	speed: 0.3643s/iter; left time: 12466.6320s
	iters: 200, epoch: 8 | loss: 0.0605882
	speed: 0.0813s/iter; left time: 2772.5179s
	iters: 300, epoch: 8 | loss: 0.0976298
	speed: 0.0703s/iter; left time: 2389.7898s
Epoch: 8 cost time: 31.535024642944336
Epoch: 8, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.358 Vali Acc: 0.649 Test Loss: 1.358 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2420904
	speed: 0.3687s/iter; left time: 12479.0897s
	iters: 200, epoch: 9 | loss: 0.3523365
	speed: 0.0848s/iter; left time: 2861.3658s
	iters: 300, epoch: 9 | loss: 0.0044950
	speed: 0.0682s/iter; left time: 2294.5109s
Epoch: 9 cost time: 30.242427110671997
Epoch: 9, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.479 Vali Acc: 0.632 Test Loss: 1.479 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0785310
	speed: 0.3367s/iter; left time: 11271.8377s
	iters: 200, epoch: 10 | loss: 0.0270839
	speed: 0.0929s/iter; left time: 3101.3093s
	iters: 300, epoch: 10 | loss: 0.0087558
	speed: 0.0754s/iter; left time: 2509.0282s
Epoch: 10 cost time: 29.367477893829346
Epoch: 10, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.597 Vali Acc: 0.636 Test Loss: 1.597 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2713560
	speed: 0.3347s/iter; left time: 11083.1853s
	iters: 200, epoch: 11 | loss: 0.0172085
	speed: 0.0786s/iter; left time: 2593.8902s
	iters: 300, epoch: 11 | loss: 0.0821044
	speed: 0.0926s/iter; left time: 3048.7425s
Epoch: 11 cost time: 30.831613302230835
Epoch: 11, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.732 Vali Acc: 0.640 Test Loss: 1.732 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0766132
	speed: 0.3463s/iter; left time: 11338.7928s
	iters: 200, epoch: 12 | loss: 0.1981604
	speed: 0.0707s/iter; left time: 2306.2053s
	iters: 300, epoch: 12 | loss: 0.0214958
	speed: 0.0813s/iter; left time: 2647.2344s
Epoch: 12 cost time: 30.167537927627563
Epoch: 12, Steps: 369 | Train Loss: 0.080 Vali Loss: 1.850 Vali Acc: 0.634 Test Loss: 1.850 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6532349602724177
model parameter : 113058
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7539831
	speed: 0.0721s/iter; left time: 2654.6939s
	iters: 200, epoch: 1 | loss: 0.5177567
	speed: 0.0558s/iter; left time: 2047.5435s
	iters: 300, epoch: 1 | loss: 0.8171454
	speed: 0.0689s/iter; left time: 2521.1851s
Epoch: 1 cost time: 23.980425596237183
Epoch: 1, Steps: 369 | Train Loss: 0.822 Vali Loss: 1.138 Vali Acc: 0.633 Test Loss: 1.138 Test Acc: 0.633
Validation loss decreased (inf --> -0.632792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4646197
	speed: 0.2787s/iter; left time: 10152.6815s
	iters: 200, epoch: 2 | loss: 0.8805054
	speed: 0.0568s/iter; left time: 2064.0660s
	iters: 300, epoch: 2 | loss: 0.7128478
	speed: 0.0527s/iter; left time: 1910.6866s
Epoch: 2 cost time: 23.142441749572754
Epoch: 2, Steps: 369 | Train Loss: 0.840 Vali Loss: 1.275 Vali Acc: 0.632 Test Loss: 1.275 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2720139
	speed: 0.2793s/iter; left time: 10071.3416s
	iters: 200, epoch: 3 | loss: 1.5560713
	speed: 0.0657s/iter; left time: 2363.2913s
	iters: 300, epoch: 3 | loss: 0.4166837
	speed: 0.0755s/iter; left time: 2707.3461s
Epoch: 3 cost time: 25.21011781692505
Epoch: 3, Steps: 369 | Train Loss: 0.864 Vali Loss: 1.507 Vali Acc: 0.609 Test Loss: 1.507 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6098823
	speed: 0.2892s/iter; left time: 10323.1043s
	iters: 200, epoch: 4 | loss: 0.9854649
	speed: 0.0495s/iter; left time: 1761.9926s
	iters: 300, epoch: 4 | loss: 0.8273101
	speed: 0.0523s/iter; left time: 1857.1131s
Epoch: 4 cost time: 21.90134859085083
Epoch: 4, Steps: 369 | Train Loss: 0.796 Vali Loss: 1.691 Vali Acc: 0.635 Test Loss: 1.691 Test Acc: 0.635
Validation loss decreased (-0.632792 --> -0.634773).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5049682
	speed: 0.2559s/iter; left time: 9038.9683s
	iters: 200, epoch: 5 | loss: 0.6112821
	speed: 0.0469s/iter; left time: 1652.7882s
	iters: 300, epoch: 5 | loss: 0.8618609
	speed: 0.0530s/iter; left time: 1862.9140s
Epoch: 5 cost time: 19.11122441291809
Epoch: 5, Steps: 369 | Train Loss: 0.616 Vali Loss: 1.499 Vali Acc: 0.634 Test Loss: 1.499 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2600015
	speed: 0.2279s/iter; left time: 7966.4555s
	iters: 200, epoch: 6 | loss: 0.3310465
	speed: 0.0471s/iter; left time: 1641.5024s
	iters: 300, epoch: 6 | loss: 0.7935309
	speed: 0.0450s/iter; left time: 1565.0508s
Epoch: 6 cost time: 17.78092908859253
Epoch: 6, Steps: 369 | Train Loss: 0.461 Vali Loss: 1.359 Vali Acc: 0.645 Test Loss: 1.359 Test Acc: 0.645
Validation loss decreased (-0.634773 --> -0.644708).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3299384
	speed: 0.2215s/iter; left time: 7662.2832s
	iters: 200, epoch: 7 | loss: 0.1865211
	speed: 0.0515s/iter; left time: 1774.7890s
	iters: 300, epoch: 7 | loss: 0.4840471
	speed: 0.0711s/iter; left time: 2445.8851s
Epoch: 7 cost time: 23.15455460548401
Epoch: 7, Steps: 369 | Train Loss: 0.344 Vali Loss: 1.199 Vali Acc: 0.636 Test Loss: 1.199 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2398529
	speed: 0.2807s/iter; left time: 9603.6763s
	iters: 200, epoch: 8 | loss: 0.5630056
	speed: 0.0702s/iter; left time: 2396.5891s
	iters: 300, epoch: 8 | loss: 0.1696118
	speed: 0.0541s/iter; left time: 1840.3052s
Epoch: 8 cost time: 24.298906087875366
Epoch: 8, Steps: 369 | Train Loss: 0.250 Vali Loss: 1.262 Vali Acc: 0.635 Test Loss: 1.262 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0399745
	speed: 0.2757s/iter; left time: 9331.5796s
	iters: 200, epoch: 9 | loss: 0.2200473
	speed: 0.0575s/iter; left time: 1941.8343s
	iters: 300, epoch: 9 | loss: 0.4566560
	speed: 0.0673s/iter; left time: 2263.9614s
Epoch: 9 cost time: 24.75872039794922
Epoch: 9, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.338 Vali Acc: 0.644 Test Loss: 1.338 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0701959
	speed: 0.2974s/iter; left time: 9956.9650s
	iters: 200, epoch: 10 | loss: 0.2480478
	speed: 0.0704s/iter; left time: 2350.3501s
	iters: 300, epoch: 10 | loss: 0.1515715
	speed: 0.0549s/iter; left time: 1827.2374s
Epoch: 10 cost time: 24.277031183242798
Epoch: 10, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.365 Vali Acc: 0.649 Test Loss: 1.365 Test Acc: 0.649
Validation loss decreased (-0.644708 --> -0.648681).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0814786
	speed: 0.2928s/iter; left time: 9694.6479s
	iters: 200, epoch: 11 | loss: 0.0257218
	speed: 0.0499s/iter; left time: 1648.7868s
	iters: 300, epoch: 11 | loss: 0.0887853
	speed: 0.0506s/iter; left time: 1664.0909s
Epoch: 11 cost time: 21.232728481292725
Epoch: 11, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.522 Vali Acc: 0.638 Test Loss: 1.522 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1220964
	speed: 0.3071s/iter; left time: 10055.0927s
	iters: 200, epoch: 12 | loss: 0.0123462
	speed: 0.0567s/iter; left time: 1849.9376s
	iters: 300, epoch: 12 | loss: 0.1232777
	speed: 0.0491s/iter; left time: 1598.8588s
Epoch: 12 cost time: 20.301896810531616
Epoch: 12, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.599 Vali Acc: 0.648 Test Loss: 1.599 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0051569
	speed: 0.3027s/iter; left time: 9800.7831s
	iters: 200, epoch: 13 | loss: 0.0729488
	speed: 0.0408s/iter; left time: 1316.2350s
	iters: 300, epoch: 13 | loss: 0.1681971
	speed: 0.0442s/iter; left time: 1422.8127s
Epoch: 13 cost time: 18.941564083099365
Epoch: 13, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.714 Vali Acc: 0.641 Test Loss: 1.714 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1070851
	speed: 0.2304s/iter; left time: 7372.7996s
	iters: 200, epoch: 14 | loss: 0.0510483
	speed: 0.0561s/iter; left time: 1789.8145s
	iters: 300, epoch: 14 | loss: 0.0496946
	speed: 0.0577s/iter; left time: 1836.3996s
Epoch: 14 cost time: 19.677858352661133
Epoch: 14, Steps: 369 | Train Loss: 0.078 Vali Loss: 1.849 Vali Acc: 0.648 Test Loss: 1.849 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1163376
	speed: 0.2385s/iter; left time: 7546.1186s
	iters: 200, epoch: 15 | loss: 0.1348056
	speed: 0.0421s/iter; left time: 1327.1629s
	iters: 300, epoch: 15 | loss: 0.4256236
	speed: 0.0521s/iter; left time: 1638.2026s
Epoch: 15 cost time: 21.254390716552734
Epoch: 15, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.897 Vali Acc: 0.646 Test Loss: 1.897 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0088031
	speed: 0.3634s/iter; left time: 11363.5983s
	iters: 200, epoch: 16 | loss: 0.0274684
	speed: 0.0954s/iter; left time: 2973.3826s
	iters: 300, epoch: 16 | loss: 0.0197549
	speed: 0.0946s/iter; left time: 2938.7073s
Epoch: 16 cost time: 33.3651659488678
Epoch: 16, Steps: 369 | Train Loss: 0.081 Vali Loss: 1.963 Vali Acc: 0.646 Test Loss: 1.963 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0684733
	speed: 0.3761s/iter; left time: 11619.7708s
	iters: 200, epoch: 17 | loss: 0.0277925
	speed: 0.0792s/iter; left time: 2438.9187s
	iters: 300, epoch: 17 | loss: 0.0388343
	speed: 0.0840s/iter; left time: 2577.7563s
Epoch: 17 cost time: 32.87416934967041
Epoch: 17, Steps: 369 | Train Loss: 0.077 Vali Loss: 2.012 Vali Acc: 0.649 Test Loss: 2.012 Test Acc: 0.649
Validation loss decreased (-0.648681 --> -0.648958).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0075753
	speed: 0.4033s/iter; left time: 12313.4069s
	iters: 200, epoch: 18 | loss: 0.0910638
	speed: 0.0943s/iter; left time: 2869.6437s
	iters: 300, epoch: 18 | loss: 0.0020921
	speed: 0.0850s/iter; left time: 2577.6467s
Epoch: 18 cost time: 33.767581939697266
Epoch: 18, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.058 Vali Acc: 0.646 Test Loss: 2.058 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0054260
	speed: 0.3504s/iter; left time: 10568.7036s
	iters: 200, epoch: 19 | loss: 0.0188705
	speed: 0.0648s/iter; left time: 1948.1603s
	iters: 300, epoch: 19 | loss: 0.0776821
	speed: 0.0715s/iter; left time: 2142.1871s
Epoch: 19 cost time: 26.92309594154358
Epoch: 19, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.054 Vali Acc: 0.650 Test Loss: 2.054 Test Acc: 0.650
Validation loss decreased (-0.648958 --> -0.649525).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0007705
	speed: 0.3478s/iter; left time: 10362.0860s
	iters: 200, epoch: 20 | loss: 0.1039826
	speed: 0.0829s/iter; left time: 2460.3604s
	iters: 300, epoch: 20 | loss: 0.0032369
	speed: 0.0657s/iter; left time: 1944.4430s
Epoch: 20 cost time: 28.530280828475952
Epoch: 20, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.187 Vali Acc: 0.644 Test Loss: 2.187 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0009774
	speed: 0.3076s/iter; left time: 9050.1302s
	iters: 200, epoch: 21 | loss: 0.0122183
	speed: 0.0655s/iter; left time: 1920.5432s
	iters: 300, epoch: 21 | loss: 0.1949116
	speed: 0.0724s/iter; left time: 2115.9275s
Epoch: 21 cost time: 26.335086345672607
Epoch: 21, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.193 Vali Acc: 0.642 Test Loss: 2.193 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0447803
	speed: 0.3348s/iter; left time: 9725.6285s
	iters: 200, epoch: 22 | loss: 0.0277565
	speed: 0.0660s/iter; left time: 1911.6900s
	iters: 300, epoch: 22 | loss: 0.3285017
	speed: 0.0576s/iter; left time: 1661.3014s
Epoch: 22 cost time: 23.09805130958557
Epoch: 22, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.181 Vali Acc: 0.654 Test Loss: 2.181 Test Acc: 0.654
Validation loss decreased (-0.649525 --> -0.653781).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0021502
	speed: 0.3034s/iter; left time: 8701.8802s
	iters: 200, epoch: 23 | loss: 0.0026155
	speed: 0.0708s/iter; left time: 2023.2845s
	iters: 300, epoch: 23 | loss: 0.0387051
	speed: 0.0701s/iter; left time: 1997.4522s
Epoch: 23 cost time: 27.359548568725586
Epoch: 23, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.256 Vali Acc: 0.647 Test Loss: 2.256 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0374522
	speed: 0.3199s/iter; left time: 9058.7810s
	iters: 200, epoch: 24 | loss: 0.0092418
	speed: 0.0722s/iter; left time: 2038.2414s
	iters: 300, epoch: 24 | loss: 0.0055135
	speed: 0.0715s/iter; left time: 2009.3067s
Epoch: 24 cost time: 28.055179119110107
Epoch: 24, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.270 Vali Acc: 0.640 Test Loss: 2.270 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0018405
	speed: 0.3611s/iter; left time: 10091.0989s
	iters: 200, epoch: 25 | loss: 0.0051906
	speed: 0.0989s/iter; left time: 2752.4964s
	iters: 300, epoch: 25 | loss: 0.1504319
	speed: 0.0927s/iter; left time: 2571.3022s
Epoch: 25 cost time: 34.24990153312683
Epoch: 25, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.336 Vali Acc: 0.650 Test Loss: 2.336 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1286939
	speed: 0.3676s/iter; left time: 10138.1236s
	iters: 200, epoch: 26 | loss: 0.0505889
	speed: 0.0599s/iter; left time: 1646.2320s
	iters: 300, epoch: 26 | loss: 0.0198337
	speed: 0.0735s/iter; left time: 2010.9199s
Epoch: 26 cost time: 28.128334283828735
Epoch: 26, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.328 Vali Acc: 0.649 Test Loss: 2.328 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0294825
	speed: 0.3464s/iter; left time: 9423.2207s
	iters: 200, epoch: 27 | loss: 0.0016708
	speed: 0.0822s/iter; left time: 2229.0888s
	iters: 300, epoch: 27 | loss: 0.0022164
	speed: 0.0648s/iter; left time: 1750.2679s
Epoch: 27 cost time: 28.392849683761597
Epoch: 27, Steps: 369 | Train Loss: 0.045 Vali Loss: 2.488 Vali Acc: 0.649 Test Loss: 2.488 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0280444
	speed: 0.3213s/iter; left time: 8622.8971s
	iters: 200, epoch: 28 | loss: 0.0033868
	speed: 0.0631s/iter; left time: 1687.6836s
	iters: 300, epoch: 28 | loss: 0.0014481
	speed: 0.0783s/iter; left time: 2086.4538s
Epoch: 28 cost time: 26.88318681716919
Epoch: 28, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.278 Vali Acc: 0.651 Test Loss: 2.278 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0017397
	speed: 0.3527s/iter; left time: 9334.9832s
	iters: 200, epoch: 29 | loss: 0.0042386
	speed: 0.0681s/iter; left time: 1796.3617s
	iters: 300, epoch: 29 | loss: 0.0610448
	speed: 0.0641s/iter; left time: 1683.1966s
Epoch: 29 cost time: 27.007110118865967
Epoch: 29, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.291 Vali Acc: 0.648 Test Loss: 2.291 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0002198
	speed: 0.3339s/iter; left time: 8714.1251s
	iters: 200, epoch: 30 | loss: 0.0009952
	speed: 0.0935s/iter; left time: 2430.5424s
	iters: 300, epoch: 30 | loss: 0.0060552
	speed: 0.0943s/iter; left time: 2442.6681s
Epoch: 30 cost time: 32.92108774185181
Epoch: 30, Steps: 369 | Train Loss: 0.033 Vali Loss: 2.386 Vali Acc: 0.638 Test Loss: 2.386 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0018832
	speed: 0.3673s/iter; left time: 9452.0416s
	iters: 200, epoch: 31 | loss: 0.0097185
	speed: 0.0788s/iter; left time: 2020.5365s
	iters: 300, epoch: 31 | loss: 0.0195504
	speed: 0.0825s/iter; left time: 2105.9051s
Epoch: 31 cost time: 32.34747910499573
Epoch: 31, Steps: 369 | Train Loss: 0.031 Vali Loss: 2.494 Vali Acc: 0.642 Test Loss: 2.494 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.1050380
	speed: 0.3823s/iter; left time: 9696.1308s
	iters: 200, epoch: 32 | loss: 0.0000775
	speed: 0.0966s/iter; left time: 2440.3208s
	iters: 300, epoch: 32 | loss: 0.0374234
	speed: 0.0800s/iter; left time: 2014.0984s
Epoch: 32 cost time: 33.81752133369446
Epoch: 32, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.593 Vali Acc: 0.640 Test Loss: 2.593 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 85442
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7404959
	speed: 0.0971s/iter; left time: 3572.7687s
	iters: 200, epoch: 1 | loss: 0.8878635
	speed: 0.0737s/iter; left time: 2703.0438s
	iters: 300, epoch: 1 | loss: 0.6781787
	speed: 0.0616s/iter; left time: 2253.3564s
Epoch: 1 cost time: 27.085317373275757
Epoch: 1, Steps: 369 | Train Loss: 0.759 Vali Loss: 1.000 Vali Acc: 0.640 Test Loss: 1.000 Test Acc: 0.640
Validation loss decreased (inf --> -0.640172).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3377201
	speed: 0.2786s/iter; left time: 10151.7545s
	iters: 200, epoch: 2 | loss: 0.8772479
	speed: 0.0553s/iter; left time: 2007.5061s
	iters: 300, epoch: 2 | loss: 0.8491703
	speed: 0.0552s/iter; left time: 1999.8778s
Epoch: 2 cost time: 22.24571990966797
Epoch: 2, Steps: 369 | Train Loss: 0.760 Vali Loss: 1.172 Vali Acc: 0.653 Test Loss: 1.172 Test Acc: 0.653
Validation loss decreased (-0.640172 --> -0.653223).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4869513
	speed: 0.2665s/iter; left time: 9610.5193s
	iters: 200, epoch: 3 | loss: 0.9588690
	speed: 0.0677s/iter; left time: 2435.3052s
	iters: 300, epoch: 3 | loss: 1.0742055
	speed: 0.0718s/iter; left time: 2574.5263s
Epoch: 3 cost time: 25.300364017486572
Epoch: 3, Steps: 369 | Train Loss: 0.755 Vali Loss: 1.604 Vali Acc: 0.629 Test Loss: 1.604 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1901922
	speed: 0.2963s/iter; left time: 10575.3222s
	iters: 200, epoch: 4 | loss: 0.2683796
	speed: 0.0550s/iter; left time: 1958.8941s
	iters: 300, epoch: 4 | loss: 1.4306599
	speed: 0.0538s/iter; left time: 1911.2978s
Epoch: 4 cost time: 23.37048077583313
Epoch: 4, Steps: 369 | Train Loss: 0.695 Vali Loss: 1.612 Vali Acc: 0.642 Test Loss: 1.612 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5972762
	speed: 0.3251s/iter; left time: 11483.4217s
	iters: 200, epoch: 5 | loss: 0.5218521
	speed: 0.0703s/iter; left time: 2474.7515s
	iters: 300, epoch: 5 | loss: 0.4764385
	speed: 0.0801s/iter; left time: 2814.2618s
Epoch: 5 cost time: 28.724316596984863
Epoch: 5, Steps: 369 | Train Loss: 0.559 Vali Loss: 1.597 Vali Acc: 0.624 Test Loss: 1.597 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3829241
	speed: 0.3529s/iter; left time: 12337.5725s
	iters: 200, epoch: 6 | loss: 0.6631413
	speed: 0.0779s/iter; left time: 2716.0244s
	iters: 300, epoch: 6 | loss: 0.0113393
	speed: 0.0677s/iter; left time: 2353.3747s
Epoch: 6 cost time: 28.421053886413574
Epoch: 6, Steps: 369 | Train Loss: 0.459 Vali Loss: 1.502 Vali Acc: 0.645 Test Loss: 1.502 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3159931
	speed: 0.3348s/iter; left time: 11578.3170s
	iters: 200, epoch: 7 | loss: 0.6032078
	speed: 0.0670s/iter; left time: 2310.3965s
	iters: 300, epoch: 7 | loss: 0.4244268
	speed: 0.0797s/iter; left time: 2739.7647s
Epoch: 7 cost time: 28.60076880455017
Epoch: 7, Steps: 369 | Train Loss: 0.389 Vali Loss: 1.344 Vali Acc: 0.647 Test Loss: 1.344 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0959539
	speed: 0.3345s/iter; left time: 11445.5337s
	iters: 200, epoch: 8 | loss: 0.0669435
	speed: 0.0846s/iter; left time: 2885.0502s
	iters: 300, epoch: 8 | loss: 0.2577594
	speed: 0.0725s/iter; left time: 2464.9061s
Epoch: 8 cost time: 28.780686855316162
Epoch: 8, Steps: 369 | Train Loss: 0.292 Vali Loss: 1.361 Vali Acc: 0.635 Test Loss: 1.361 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1450439
	speed: 0.2945s/iter; left time: 9968.8406s
	iters: 200, epoch: 9 | loss: 0.2292399
	speed: 0.0565s/iter; left time: 1905.3888s
	iters: 300, epoch: 9 | loss: 0.1587137
	speed: 0.0551s/iter; left time: 1854.9294s
Epoch: 9 cost time: 23.560239553451538
Epoch: 9, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.345 Vali Acc: 0.638 Test Loss: 1.345 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0342758
	speed: 0.3213s/iter; left time: 10758.4902s
	iters: 200, epoch: 10 | loss: 0.0576077
	speed: 0.0748s/iter; left time: 2496.6697s
	iters: 300, epoch: 10 | loss: 0.1537784
	speed: 0.0681s/iter; left time: 2265.9943s
Epoch: 10 cost time: 25.772175550460815
Epoch: 10, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.407 Vali Acc: 0.635 Test Loss: 1.407 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2261010
	speed: 0.3082s/iter; left time: 10205.4937s
	iters: 200, epoch: 11 | loss: 0.0636433
	speed: 0.0556s/iter; left time: 1834.7165s
	iters: 300, epoch: 11 | loss: 0.1893657
	speed: 0.0560s/iter; left time: 1843.1834s
Epoch: 11 cost time: 22.718162775039673
Epoch: 11, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.501 Vali Acc: 0.639 Test Loss: 1.501 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1558220
	speed: 0.3091s/iter; left time: 10121.8332s
	iters: 200, epoch: 12 | loss: 0.2718630
	speed: 0.0741s/iter; left time: 2419.6215s
	iters: 300, epoch: 12 | loss: 0.0675740
	speed: 0.0730s/iter; left time: 2377.1705s
Epoch: 12 cost time: 25.686803340911865
Epoch: 12, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.535 Vali Acc: 0.641 Test Loss: 1.535 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6532349602724177
model parameter : 71666
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5724962
	speed: 0.0831s/iter; left time: 3059.8749s
	iters: 200, epoch: 1 | loss: 0.2777463
	speed: 0.0558s/iter; left time: 2046.5443s
	iters: 300, epoch: 1 | loss: 1.2855006
	speed: 0.0563s/iter; left time: 2060.8542s
Epoch: 1 cost time: 23.492435693740845
Epoch: 1, Steps: 369 | Train Loss: 0.742 Vali Loss: 1.052 Vali Acc: 0.624 Test Loss: 1.052 Test Acc: 0.624
Validation loss decreased (inf --> -0.623996).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8273343
	speed: 0.2500s/iter; left time: 9108.9099s
	iters: 200, epoch: 2 | loss: 0.5531898
	speed: 0.0602s/iter; left time: 2186.1756s
	iters: 300, epoch: 2 | loss: 0.7742072
	speed: 0.0577s/iter; left time: 2090.9197s
Epoch: 2 cost time: 22.370439291000366
Epoch: 2, Steps: 369 | Train Loss: 0.724 Vali Loss: 1.227 Vali Acc: 0.638 Test Loss: 1.227 Test Acc: 0.638
Validation loss decreased (-0.623996 --> -0.638467).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4159589
	speed: 0.2827s/iter; left time: 10193.2988s
	iters: 200, epoch: 3 | loss: 0.9510322
	speed: 0.0724s/iter; left time: 2605.3428s
	iters: 300, epoch: 3 | loss: 0.2348842
	speed: 0.0717s/iter; left time: 2572.6639s
Epoch: 3 cost time: 25.650465726852417
Epoch: 3, Steps: 369 | Train Loss: 0.698 Vali Loss: 1.468 Vali Acc: 0.637 Test Loss: 1.468 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7927789
	speed: 0.3039s/iter; left time: 10847.3671s
	iters: 200, epoch: 4 | loss: 1.5757052
	speed: 0.0562s/iter; left time: 1998.7427s
	iters: 300, epoch: 4 | loss: 0.9613662
	speed: 0.0501s/iter; left time: 1778.5986s
Epoch: 4 cost time: 22.049021005630493
Epoch: 4, Steps: 369 | Train Loss: 0.652 Vali Loss: 1.486 Vali Acc: 0.633 Test Loss: 1.486 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4012621
	speed: 0.2779s/iter; left time: 9815.2665s
	iters: 200, epoch: 5 | loss: 0.8620057
	speed: 0.0485s/iter; left time: 1709.9965s
	iters: 300, epoch: 5 | loss: 0.5248598
	speed: 0.0523s/iter; left time: 1837.2633s
Epoch: 5 cost time: 20.468554258346558
Epoch: 5, Steps: 369 | Train Loss: 0.579 Vali Loss: 1.335 Vali Acc: 0.636 Test Loss: 1.335 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3059133
	speed: 0.2802s/iter; left time: 9795.9582s
	iters: 200, epoch: 6 | loss: 0.6429242
	speed: 0.0669s/iter; left time: 2330.4629s
	iters: 300, epoch: 6 | loss: 0.2116122
	speed: 0.0662s/iter; left time: 2301.9731s
Epoch: 6 cost time: 23.613070964813232
Epoch: 6, Steps: 369 | Train Loss: 0.474 Vali Loss: 1.244 Vali Acc: 0.629 Test Loss: 1.244 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.4026213
	speed: 0.2802s/iter; left time: 9690.9350s
	iters: 200, epoch: 7 | loss: 0.9141013
	speed: 0.0538s/iter; left time: 1854.8551s
	iters: 300, epoch: 7 | loss: 0.4877751
	speed: 0.0499s/iter; left time: 1716.3386s
Epoch: 7 cost time: 21.63237190246582
Epoch: 7, Steps: 369 | Train Loss: 0.355 Vali Loss: 1.273 Vali Acc: 0.640 Test Loss: 1.273 Test Acc: 0.640
Validation loss decreased (-0.638467 --> -0.639601).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3626118
	speed: 0.2832s/iter; left time: 9690.6367s
	iters: 200, epoch: 8 | loss: 0.2820603
	speed: 0.0613s/iter; left time: 2092.8902s
	iters: 300, epoch: 8 | loss: 0.1172560
	speed: 0.0632s/iter; left time: 2150.9367s
Epoch: 8 cost time: 24.91601014137268
Epoch: 8, Steps: 369 | Train Loss: 0.324 Vali Loss: 1.158 Vali Acc: 0.642 Test Loss: 1.158 Test Acc: 0.642
Validation loss decreased (-0.639601 --> -0.642440).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1530185
	speed: 0.2945s/iter; left time: 9967.1207s
	iters: 200, epoch: 9 | loss: 0.0215877
	speed: 0.0737s/iter; left time: 2488.3593s
	iters: 300, epoch: 9 | loss: 0.3854354
	speed: 0.0743s/iter; left time: 2498.4768s
Epoch: 9 cost time: 26.405856370925903
Epoch: 9, Steps: 369 | Train Loss: 0.267 Vali Loss: 1.237 Vali Acc: 0.646 Test Loss: 1.237 Test Acc: 0.646
Validation loss decreased (-0.642440 --> -0.646412).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2043327
	speed: 0.3142s/iter; left time: 10521.0126s
	iters: 200, epoch: 10 | loss: 0.2917196
	speed: 0.0657s/iter; left time: 2192.8727s
	iters: 300, epoch: 10 | loss: 0.5036666
	speed: 0.0624s/iter; left time: 2076.9681s
Epoch: 10 cost time: 25.433838605880737
Epoch: 10, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.260 Vali Acc: 0.646 Test Loss: 1.260 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1882521
	speed: 0.2921s/iter; left time: 9671.5743s
	iters: 200, epoch: 11 | loss: 0.4053544
	speed: 0.0617s/iter; left time: 2038.2063s
	iters: 300, epoch: 11 | loss: 0.0848346
	speed: 0.0661s/iter; left time: 2174.5327s
Epoch: 11 cost time: 25.091196537017822
Epoch: 11, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.350 Vali Acc: 0.647 Test Loss: 1.350 Test Acc: 0.647
Validation loss decreased (-0.646412 --> -0.646695).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2583411
	speed: 0.2966s/iter; left time: 9711.7426s
	iters: 200, epoch: 12 | loss: 0.0726246
	speed: 0.0674s/iter; left time: 2199.8217s
	iters: 300, epoch: 12 | loss: 0.1319555
	speed: 0.0676s/iter; left time: 2198.3491s
Epoch: 12 cost time: 23.55968689918518
Epoch: 12, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.371 Vali Acc: 0.640 Test Loss: 1.371 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1163537
	speed: 0.2757s/iter; left time: 8926.5270s
	iters: 200, epoch: 13 | loss: 0.0563767
	speed: 0.0554s/iter; left time: 1788.7466s
	iters: 300, epoch: 13 | loss: 0.0714862
	speed: 0.0530s/iter; left time: 1705.2972s
Epoch: 13 cost time: 22.309412956237793
Epoch: 13, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.495 Vali Acc: 0.636 Test Loss: 1.495 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0731601
	speed: 0.2583s/iter; left time: 8265.0668s
	iters: 200, epoch: 14 | loss: 0.0350675
	speed: 0.0461s/iter; left time: 1471.5984s
	iters: 300, epoch: 14 | loss: 0.1905423
	speed: 0.0562s/iter; left time: 1786.2414s
Epoch: 14 cost time: 20.550952911376953
Epoch: 14, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.506 Vali Acc: 0.640 Test Loss: 1.506 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0253066
	speed: 0.2870s/iter; left time: 9078.8927s
	iters: 200, epoch: 15 | loss: 0.0191694
	speed: 0.0671s/iter; left time: 2115.4012s
	iters: 300, epoch: 15 | loss: 0.4214584
	speed: 0.0607s/iter; left time: 1907.4614s
Epoch: 15 cost time: 23.05532693862915
Epoch: 15, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.619 Vali Acc: 0.621 Test Loss: 1.619 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0534741
	speed: 0.2853s/iter; left time: 8919.7639s
	iters: 200, epoch: 16 | loss: 0.0268023
	speed: 0.0463s/iter; left time: 1442.1529s
	iters: 300, epoch: 16 | loss: 0.0331832
	speed: 0.0523s/iter; left time: 1625.0556s
Epoch: 16 cost time: 21.186829566955566
Epoch: 16, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.640 Vali Acc: 0.637 Test Loss: 1.640 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0238899
	speed: 0.3062s/iter; left time: 9461.2426s
	iters: 200, epoch: 17 | loss: 0.0447972
	speed: 0.0586s/iter; left time: 1804.0219s
	iters: 300, epoch: 17 | loss: 0.0145141
	speed: 0.0680s/iter; left time: 2086.9630s
Epoch: 17 cost time: 24.820089101791382
Epoch: 17, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.645 Vali Acc: 0.642 Test Loss: 1.645 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0223294
	speed: 0.3025s/iter; left time: 9233.3662s
	iters: 200, epoch: 18 | loss: 0.0075440
	speed: 0.0732s/iter; left time: 2228.1539s
	iters: 300, epoch: 18 | loss: 0.0366628
	speed: 0.0666s/iter; left time: 2019.0802s
Epoch: 18 cost time: 26.043175220489502
Epoch: 18, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.675 Vali Acc: 0.638 Test Loss: 1.675 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0922264
	speed: 0.3027s/iter; left time: 9128.7755s
	iters: 200, epoch: 19 | loss: 0.0230980
	speed: 0.0608s/iter; left time: 1828.9971s
	iters: 300, epoch: 19 | loss: 0.0875855
	speed: 0.0595s/iter; left time: 1781.0960s
Epoch: 19 cost time: 24.55585479736328
Epoch: 19, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.738 Vali Acc: 0.635 Test Loss: 1.738 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0139796
	speed: 0.2654s/iter; left time: 7905.5663s
	iters: 200, epoch: 20 | loss: 0.2509635
	speed: 0.0567s/iter; left time: 1683.4981s
	iters: 300, epoch: 20 | loss: 0.3053923
	speed: 0.0577s/iter; left time: 1706.4390s
Epoch: 20 cost time: 21.025306701660156
Epoch: 20, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.748 Vali Acc: 0.635 Test Loss: 1.748 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0954695
	speed: 0.2543s/iter; left time: 7483.0718s
	iters: 200, epoch: 21 | loss: 0.0022405
	speed: 0.0691s/iter; left time: 2026.9445s
	iters: 300, epoch: 21 | loss: 0.1477475
	speed: 0.0579s/iter; left time: 1690.9370s
Epoch: 21 cost time: 24.278197050094604
Epoch: 21, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.860 Vali Acc: 0.645 Test Loss: 1.860 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6467082860385925
model parameter : 57890
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6325887
	speed: 0.0834s/iter; left time: 3069.6082s
	iters: 200, epoch: 1 | loss: 1.1154410
	speed: 0.0570s/iter; left time: 2092.8156s
	iters: 300, epoch: 1 | loss: 0.9376572
	speed: 0.0474s/iter; left time: 1734.4953s
Epoch: 1 cost time: 22.050304174423218
Epoch: 1, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.928 Vali Acc: 0.642 Test Loss: 0.928 Test Acc: 0.642
Validation loss decreased (inf --> -0.642442).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6744987
	speed: 0.2485s/iter; left time: 9052.7462s
	iters: 200, epoch: 2 | loss: 1.0473247
	speed: 0.0453s/iter; left time: 1645.0618s
	iters: 300, epoch: 2 | loss: 0.3314396
	speed: 0.0468s/iter; left time: 1696.4465s
Epoch: 2 cost time: 17.79281520843506
Epoch: 2, Steps: 369 | Train Loss: 0.647 Vali Loss: 1.167 Vali Acc: 0.635 Test Loss: 1.167 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7082641
	speed: 0.2379s/iter; left time: 8578.2040s
	iters: 200, epoch: 3 | loss: 1.1143870
	speed: 0.0539s/iter; left time: 1938.4832s
	iters: 300, epoch: 3 | loss: 0.2625977
	speed: 0.0640s/iter; left time: 2295.9116s
Epoch: 3 cost time: 22.33760929107666
Epoch: 3, Steps: 369 | Train Loss: 0.653 Vali Loss: 1.063 Vali Acc: 0.672 Test Loss: 1.063 Test Acc: 0.672
Validation loss decreased (-0.642442 --> -0.672237).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9400785
	speed: 0.2762s/iter; left time: 9859.3385s
	iters: 200, epoch: 4 | loss: 0.9390867
	speed: 0.0651s/iter; left time: 2316.6395s
	iters: 300, epoch: 4 | loss: 0.2181076
	speed: 0.0648s/iter; left time: 2301.2583s
Epoch: 4 cost time: 23.479636907577515
Epoch: 4, Steps: 369 | Train Loss: 0.614 Vali Loss: 1.189 Vali Acc: 0.656 Test Loss: 1.189 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0174063
	speed: 0.2795s/iter; left time: 9874.3034s
	iters: 200, epoch: 5 | loss: 0.4979925
	speed: 0.0659s/iter; left time: 2321.2966s
	iters: 300, epoch: 5 | loss: 0.3574477
	speed: 0.0542s/iter; left time: 1903.5326s
Epoch: 5 cost time: 23.138083934783936
Epoch: 5, Steps: 369 | Train Loss: 0.549 Vali Loss: 1.175 Vali Acc: 0.658 Test Loss: 1.175 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9940081
	speed: 0.2646s/iter; left time: 9249.1633s
	iters: 200, epoch: 6 | loss: 0.4007274
	speed: 0.0547s/iter; left time: 1906.5589s
	iters: 300, epoch: 6 | loss: 0.2972949
	speed: 0.0557s/iter; left time: 1936.5077s
Epoch: 6 cost time: 21.703953742980957
Epoch: 6, Steps: 369 | Train Loss: 0.453 Vali Loss: 1.222 Vali Acc: 0.661 Test Loss: 1.222 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4730164
	speed: 0.2701s/iter; left time: 9341.9506s
	iters: 200, epoch: 7 | loss: 0.1455228
	speed: 0.0527s/iter; left time: 1817.8719s
	iters: 300, epoch: 7 | loss: 0.3877850
	speed: 0.0572s/iter; left time: 1967.9778s
Epoch: 7 cost time: 21.695892095565796
Epoch: 7, Steps: 369 | Train Loss: 0.399 Vali Loss: 1.170 Vali Acc: 0.649 Test Loss: 1.170 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6116507
	speed: 0.2504s/iter; left time: 8568.6991s
	iters: 200, epoch: 8 | loss: 0.3551616
	speed: 0.0594s/iter; left time: 2026.2782s
	iters: 300, epoch: 8 | loss: 0.0364646
	speed: 0.0573s/iter; left time: 1947.7788s
Epoch: 8 cost time: 20.7831552028656
Epoch: 8, Steps: 369 | Train Loss: 0.343 Vali Loss: 1.117 Vali Acc: 0.654 Test Loss: 1.117 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4456784
	speed: 0.2675s/iter; left time: 9056.0594s
	iters: 200, epoch: 9 | loss: 0.2791680
	speed: 0.0544s/iter; left time: 1837.1421s
	iters: 300, epoch: 9 | loss: 0.1642273
	speed: 0.0509s/iter; left time: 1712.1348s
Epoch: 9 cost time: 20.39547562599182
Epoch: 9, Steps: 369 | Train Loss: 0.301 Vali Loss: 1.207 Vali Acc: 0.636 Test Loss: 1.207 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1956351
	speed: 0.2283s/iter; left time: 7642.0217s
	iters: 200, epoch: 10 | loss: 0.5134871
	speed: 0.0466s/iter; left time: 1557.1513s
	iters: 300, epoch: 10 | loss: 0.1842505
	speed: 0.0468s/iter; left time: 1556.4991s
Epoch: 10 cost time: 18.052866458892822
Epoch: 10, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.135 Vali Acc: 0.660 Test Loss: 1.135 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2041216
	speed: 0.2450s/iter; left time: 8111.5378s
	iters: 200, epoch: 11 | loss: 0.3032796
	speed: 0.0509s/iter; left time: 1680.7576s
	iters: 300, epoch: 11 | loss: 0.1344879
	speed: 0.0603s/iter; left time: 1983.0201s
Epoch: 11 cost time: 20.230568408966064
Epoch: 11, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6237880
	speed: 0.2552s/iter; left time: 8356.5414s
	iters: 200, epoch: 12 | loss: 0.2164542
	speed: 0.0574s/iter; left time: 1874.0960s
	iters: 300, epoch: 12 | loss: 0.0647718
	speed: 0.0548s/iter; left time: 1783.5039s
Epoch: 12 cost time: 20.769794940948486
Epoch: 12, Steps: 369 | Train Loss: 0.211 Vali Loss: 1.264 Vali Acc: 0.645 Test Loss: 1.264 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2967958
	speed: 0.2675s/iter; left time: 8659.7712s
	iters: 200, epoch: 13 | loss: 0.1806705
	speed: 0.0651s/iter; left time: 2100.9056s
	iters: 300, epoch: 13 | loss: 0.1081298
	speed: 0.0523s/iter; left time: 1681.6516s
Epoch: 13 cost time: 22.662535667419434
Epoch: 13, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.320 Vali Acc: 0.629 Test Loss: 1.320 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6722474460839954
model parameter : 48722
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6374843
	speed: 0.2949s/iter; left time: 10853.4714s
	iters: 200, epoch: 1 | loss: 2.8727977
	speed: 0.2468s/iter; left time: 9056.5237s
	iters: 300, epoch: 1 | loss: 1.3628510
	speed: 0.2655s/iter; left time: 9718.5381s
Epoch: 1 cost time: 96.29715085029602
Epoch: 1, Steps: 369 | Train Loss: 1.459 Vali Loss: 0.958 Vali Acc: 0.656 Test Loss: 0.958 Test Acc: 0.656
Validation loss decreased (inf --> -0.655496).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5850738
	speed: 0.7278s/iter; left time: 26516.8639s
	iters: 200, epoch: 2 | loss: 1.5952302
	speed: 0.1995s/iter; left time: 7247.0512s
	iters: 300, epoch: 2 | loss: 0.6285656
	speed: 0.1814s/iter; left time: 6572.7789s
Epoch: 2 cost time: 70.31284689903259
Epoch: 2, Steps: 369 | Train Loss: 1.593 Vali Loss: 1.769 Vali Acc: 0.644 Test Loss: 1.769 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.5504446
	speed: 0.5861s/iter; left time: 21135.0024s
	iters: 200, epoch: 3 | loss: 2.5675366
	speed: 0.1578s/iter; left time: 5676.0201s
	iters: 300, epoch: 3 | loss: 0.9598188
	speed: 0.1641s/iter; left time: 5886.5219s
Epoch: 3 cost time: 63.8237087726593
Epoch: 3, Steps: 369 | Train Loss: 1.756 Vali Loss: 2.838 Vali Acc: 0.629 Test Loss: 2.838 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5051684
	speed: 0.8152s/iter; left time: 29098.9965s
	iters: 200, epoch: 4 | loss: 2.2571728
	speed: 0.2401s/iter; left time: 8546.0794s
	iters: 300, epoch: 4 | loss: 0.9913233
	speed: 0.2595s/iter; left time: 9209.5565s
Epoch: 4 cost time: 94.04650783538818
Epoch: 4, Steps: 369 | Train Loss: 1.605 Vali Loss: 3.136 Vali Acc: 0.637 Test Loss: 3.136 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0452554
	speed: 0.8322s/iter; left time: 29397.2131s
	iters: 200, epoch: 5 | loss: 0.1242196
	speed: 0.2219s/iter; left time: 7816.5410s
	iters: 300, epoch: 5 | loss: 0.7413043
	speed: 0.2215s/iter; left time: 7778.5917s
Epoch: 5 cost time: 80.02641677856445
Epoch: 5, Steps: 369 | Train Loss: 1.028 Vali Loss: 2.298 Vali Acc: 0.634 Test Loss: 2.298 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7052029
	speed: 0.7414s/iter; left time: 25915.5235s
	iters: 200, epoch: 6 | loss: 0.3436114
	speed: 0.2047s/iter; left time: 7134.8084s
	iters: 300, epoch: 6 | loss: 0.0310209
	speed: 0.1992s/iter; left time: 6924.6776s
Epoch: 6 cost time: 79.9326708316803
Epoch: 6, Steps: 369 | Train Loss: 0.484 Vali Loss: 2.192 Vali Acc: 0.633 Test Loss: 2.192 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.4594736
	speed: 0.8164s/iter; left time: 28238.4654s
	iters: 200, epoch: 7 | loss: 0.1464300
	speed: 0.2406s/iter; left time: 8296.0263s
	iters: 300, epoch: 7 | loss: 0.1726467
	speed: 0.2655s/iter; left time: 9131.1803s
Epoch: 7 cost time: 94.01490306854248
Epoch: 7, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.721 Vali Acc: 0.629 Test Loss: 1.721 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0071001
	speed: 0.8635s/iter; left time: 29547.9165s
	iters: 200, epoch: 8 | loss: 0.4895450
	speed: 0.2703s/iter; left time: 9220.7811s
	iters: 300, epoch: 8 | loss: 0.2638348
	speed: 0.2362s/iter; left time: 8034.8867s
Epoch: 8 cost time: 89.90024042129517
Epoch: 8, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.819 Vali Acc: 0.638 Test Loss: 1.819 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.1542917
	speed: 0.7400s/iter; left time: 25047.9571s
	iters: 200, epoch: 9 | loss: 0.0573568
	speed: 0.2091s/iter; left time: 7058.0096s
	iters: 300, epoch: 9 | loss: 0.1847611
	speed: 0.1769s/iter; left time: 5951.9550s
Epoch: 9 cost time: 75.99294304847717
Epoch: 9, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.745 Vali Acc: 0.633 Test Loss: 1.745 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0093119
	speed: 0.7627s/iter; left time: 25535.9096s
	iters: 200, epoch: 10 | loss: 0.4571561
	speed: 0.2348s/iter; left time: 7837.3820s
	iters: 300, epoch: 10 | loss: 0.0071583
	speed: 0.2568s/iter; left time: 8547.6697s
Epoch: 10 cost time: 89.32470893859863
Epoch: 10, Steps: 369 | Train Loss: 0.080 Vali Loss: 1.921 Vali Acc: 0.628 Test Loss: 1.921 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0047152
	speed: 0.8665s/iter; left time: 28689.2940s
	iters: 200, epoch: 11 | loss: 0.0728427
	speed: 0.2552s/iter; left time: 8424.4628s
	iters: 300, epoch: 11 | loss: 0.0060978
	speed: 0.2288s/iter; left time: 7531.2135s
Epoch: 11 cost time: 88.25502753257751
Epoch: 11, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.145 Vali Acc: 0.626 Test Loss: 2.145 Test Acc: 0.626
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6555051078320091
model parameter : 295602
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9932419
	speed: 0.1250s/iter; left time: 4600.0296s
	iters: 200, epoch: 1 | loss: 1.8350694
	speed: 0.1562s/iter; left time: 5732.0567s
	iters: 300, epoch: 1 | loss: 1.4294692
	speed: 0.1534s/iter; left time: 5614.9405s
Epoch: 1 cost time: 53.51053309440613
Epoch: 1, Steps: 369 | Train Loss: 1.007 Vali Loss: 1.377 Vali Acc: 0.638 Test Loss: 1.377 Test Acc: 0.638
Validation loss decreased (inf --> -0.638181).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2289495
	speed: 0.5496s/iter; left time: 20021.7413s
	iters: 200, epoch: 2 | loss: 0.8008704
	speed: 0.1410s/iter; left time: 5123.6229s
	iters: 300, epoch: 2 | loss: 2.4286497
	speed: 0.1466s/iter; left time: 5313.3881s
Epoch: 2 cost time: 57.08259129524231
Epoch: 2, Steps: 369 | Train Loss: 1.100 Vali Loss: 1.759 Vali Acc: 0.654 Test Loss: 1.759 Test Acc: 0.654
Validation loss decreased (-0.638181 --> -0.654352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9410239
	speed: 0.5713s/iter; left time: 20601.1700s
	iters: 200, epoch: 3 | loss: 1.2662019
	speed: 0.1487s/iter; left time: 5348.5210s
	iters: 300, epoch: 3 | loss: 0.0763710
	speed: 0.1274s/iter; left time: 4568.1024s
Epoch: 3 cost time: 49.79646682739258
Epoch: 3, Steps: 369 | Train Loss: 1.244 Vali Loss: 2.206 Vali Acc: 0.646 Test Loss: 2.206 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3017330
	speed: 0.4598s/iter; left time: 16411.5742s
	iters: 200, epoch: 4 | loss: 0.7354982
	speed: 0.1384s/iter; left time: 4925.3718s
	iters: 300, epoch: 4 | loss: 0.5512911
	speed: 0.1048s/iter; left time: 3718.5200s
Epoch: 4 cost time: 42.4350004196167
Epoch: 4, Steps: 369 | Train Loss: 1.075 Vali Loss: 2.289 Vali Acc: 0.643 Test Loss: 2.289 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7615707
	speed: 0.4595s/iter; left time: 16233.4465s
	iters: 200, epoch: 5 | loss: 0.5805335
	speed: 0.1338s/iter; left time: 4712.0277s
	iters: 300, epoch: 5 | loss: 1.3549031
	speed: 0.1077s/iter; left time: 3784.4839s
Epoch: 5 cost time: 46.324865102767944
Epoch: 5, Steps: 369 | Train Loss: 0.769 Vali Loss: 2.392 Vali Acc: 0.631 Test Loss: 2.392 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2544854
	speed: 0.5048s/iter; left time: 17644.4283s
	iters: 200, epoch: 6 | loss: 0.4037701
	speed: 0.1312s/iter; left time: 4574.1675s
	iters: 300, epoch: 6 | loss: 0.6258316
	speed: 0.1548s/iter; left time: 5380.4520s
Epoch: 6 cost time: 54.94863843917847
Epoch: 6, Steps: 369 | Train Loss: 0.486 Vali Loss: 2.193 Vali Acc: 0.622 Test Loss: 2.193 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0806838
	speed: 0.5610s/iter; left time: 19401.9278s
	iters: 200, epoch: 7 | loss: 0.4047035
	speed: 0.1592s/iter; left time: 5488.7007s
	iters: 300, epoch: 7 | loss: 0.0804507
	speed: 0.1518s/iter; left time: 5220.3803s
Epoch: 7 cost time: 55.326088190078735
Epoch: 7, Steps: 369 | Train Loss: 0.317 Vali Loss: 1.489 Vali Acc: 0.635 Test Loss: 1.489 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7869498
	speed: 0.5727s/iter; left time: 19595.6978s
	iters: 200, epoch: 8 | loss: 0.2171006
	speed: 0.1436s/iter; left time: 4898.8633s
	iters: 300, epoch: 8 | loss: 0.2832714
	speed: 0.1317s/iter; left time: 4478.7977s
Epoch: 8 cost time: 51.841763496398926
Epoch: 8, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.606 Vali Acc: 0.627 Test Loss: 1.606 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0411712
	speed: 0.4113s/iter; left time: 13923.6966s
	iters: 200, epoch: 9 | loss: 0.0892323
	speed: 0.1298s/iter; left time: 4380.1163s
	iters: 300, epoch: 9 | loss: 0.3212941
	speed: 0.1008s/iter; left time: 3390.7059s
Epoch: 9 cost time: 41.97641444206238
Epoch: 9, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.625 Vali Acc: 0.634 Test Loss: 1.625 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1476212
	speed: 0.4901s/iter; left time: 16409.8882s
	iters: 200, epoch: 10 | loss: 0.0892924
	speed: 0.1127s/iter; left time: 3761.0061s
	iters: 300, epoch: 10 | loss: 0.1112559
	speed: 0.1096s/iter; left time: 3645.9109s
Epoch: 10 cost time: 46.76961970329285
Epoch: 10, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.696 Vali Acc: 0.635 Test Loss: 1.696 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1649925
	speed: 0.4866s/iter; left time: 16112.8892s
	iters: 200, epoch: 11 | loss: 0.0359195
	speed: 0.1137s/iter; left time: 3751.7987s
	iters: 300, epoch: 11 | loss: 0.0008998
	speed: 0.1701s/iter; left time: 5597.8219s
Epoch: 11 cost time: 51.262073040008545
Epoch: 11, Steps: 369 | Train Loss: 0.091 Vali Loss: 1.904 Vali Acc: 0.630 Test Loss: 1.904 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0418554
	speed: 0.5503s/iter; left time: 18018.9583s
	iters: 200, epoch: 12 | loss: 0.1830356
	speed: 0.1646s/iter; left time: 5373.0661s
	iters: 300, epoch: 12 | loss: 0.1321794
	speed: 0.1339s/iter; left time: 4355.8316s
Epoch: 12 cost time: 57.10278844833374
Epoch: 12, Steps: 369 | Train Loss: 0.078 Vali Loss: 1.986 Vali Acc: 0.636 Test Loss: 1.986 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6543700340522134
model parameter : 152786
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7595313
	speed: 0.1324s/iter; left time: 4872.2415s
	iters: 200, epoch: 1 | loss: 0.4550476
	speed: 0.0807s/iter; left time: 2962.6308s
	iters: 300, epoch: 1 | loss: 0.4007124
	speed: 0.0952s/iter; left time: 3486.0786s
Epoch: 1 cost time: 38.955650806427
Epoch: 1, Steps: 369 | Train Loss: 0.919 Vali Loss: 1.194 Vali Acc: 0.617 Test Loss: 1.194 Test Acc: 0.617
Validation loss decreased (inf --> -0.616617).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2204257
	speed: 0.3990s/iter; left time: 14536.2500s
	iters: 200, epoch: 2 | loss: 1.1034275
	speed: 0.0839s/iter; left time: 3046.8626s
	iters: 300, epoch: 2 | loss: 0.3118097
	speed: 0.0770s/iter; left time: 2789.8152s
Epoch: 2 cost time: 36.85407018661499
Epoch: 2, Steps: 369 | Train Loss: 0.995 Vali Loss: 1.294 Vali Acc: 0.640 Test Loss: 1.294 Test Acc: 0.640
Validation loss decreased (-0.616617 --> -0.639601).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5955186
	speed: 0.4328s/iter; left time: 15607.4153s
	iters: 200, epoch: 3 | loss: 0.8266535
	speed: 0.1135s/iter; left time: 4080.4586s
	iters: 300, epoch: 3 | loss: 0.1816481
	speed: 0.1204s/iter; left time: 4316.6489s
Epoch: 3 cost time: 48.36708402633667
Epoch: 3, Steps: 369 | Train Loss: 0.961 Vali Loss: 1.803 Vali Acc: 0.646 Test Loss: 1.803 Test Acc: 0.646
Validation loss decreased (-0.639601 --> -0.646123).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2064448
	speed: 0.3503s/iter; left time: 12502.1626s
	iters: 200, epoch: 4 | loss: 0.6233307
	speed: 0.0485s/iter; left time: 1726.6271s
	iters: 300, epoch: 4 | loss: 1.0447628
	speed: 0.0568s/iter; left time: 2014.5070s
Epoch: 4 cost time: 23.29807186126709
Epoch: 4, Steps: 369 | Train Loss: 0.823 Vali Loss: 2.356 Vali Acc: 0.630 Test Loss: 2.356 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9774641
	speed: 0.2957s/iter; left time: 10445.4291s
	iters: 200, epoch: 5 | loss: 0.4372138
	speed: 0.0499s/iter; left time: 1757.0997s
	iters: 300, epoch: 5 | loss: 0.7502463
	speed: 0.0502s/iter; left time: 1761.8114s
Epoch: 5 cost time: 22.493053913116455
Epoch: 5, Steps: 369 | Train Loss: 0.617 Vali Loss: 1.844 Vali Acc: 0.621 Test Loss: 1.844 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0729023
	speed: 0.2878s/iter; left time: 10061.9156s
	iters: 200, epoch: 6 | loss: 0.5584651
	speed: 0.1234s/iter; left time: 4300.1907s
	iters: 300, epoch: 6 | loss: 0.0864786
	speed: 0.1017s/iter; left time: 3533.2169s
Epoch: 6 cost time: 39.44221544265747
Epoch: 6, Steps: 369 | Train Loss: 0.424 Vali Loss: 1.728 Vali Acc: 0.641 Test Loss: 1.728 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7621742
	speed: 0.4503s/iter; left time: 15574.7568s
	iters: 200, epoch: 7 | loss: 0.3799987
	speed: 0.1108s/iter; left time: 3820.4535s
	iters: 300, epoch: 7 | loss: 0.4072862
	speed: 0.0991s/iter; left time: 3409.1693s
Epoch: 7 cost time: 42.30054450035095
Epoch: 7, Steps: 369 | Train Loss: 0.302 Vali Loss: 1.426 Vali Acc: 0.641 Test Loss: 1.426 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4106818
	speed: 0.3245s/iter; left time: 11104.8220s
	iters: 200, epoch: 8 | loss: 0.3374274
	speed: 0.0603s/iter; left time: 2056.3728s
	iters: 300, epoch: 8 | loss: 0.2870109
	speed: 0.0616s/iter; left time: 2095.2272s
Epoch: 8 cost time: 23.625197410583496
Epoch: 8, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.458 Vali Acc: 0.636 Test Loss: 1.458 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0398503
	speed: 0.3152s/iter; left time: 10669.6996s
	iters: 200, epoch: 9 | loss: 0.0321376
	speed: 0.0692s/iter; left time: 2336.4011s
	iters: 300, epoch: 9 | loss: 0.2018404
	speed: 0.0681s/iter; left time: 2290.2093s
Epoch: 9 cost time: 30.71505570411682
Epoch: 9, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.582 Vali Acc: 0.644 Test Loss: 1.582 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2905603
	speed: 0.3664s/iter; left time: 12266.4947s
	iters: 200, epoch: 10 | loss: 0.0197227
	speed: 0.0813s/iter; left time: 2713.6193s
	iters: 300, epoch: 10 | loss: 0.1882585
	speed: 0.0885s/iter; left time: 2943.7091s
Epoch: 10 cost time: 36.49150323867798
Epoch: 10, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.620 Vali Acc: 0.649 Test Loss: 1.620 Test Acc: 0.649
Validation loss decreased (-0.646123 --> -0.649246).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1060236
	speed: 0.4323s/iter; left time: 14313.1112s
	iters: 200, epoch: 11 | loss: 0.3138912
	speed: 0.1240s/iter; left time: 4091.7179s
	iters: 300, epoch: 11 | loss: 0.0562334
	speed: 0.1056s/iter; left time: 3474.9873s
Epoch: 11 cost time: 43.75562882423401
Epoch: 11, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.761 Vali Acc: 0.642 Test Loss: 1.761 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0902231
	speed: 0.4436s/iter; left time: 14525.8467s
	iters: 200, epoch: 12 | loss: 0.0161720
	speed: 0.0892s/iter; left time: 2911.3452s
	iters: 300, epoch: 12 | loss: 0.0291463
	speed: 0.0707s/iter; left time: 2300.9989s
Epoch: 12 cost time: 34.2266263961792
Epoch: 12, Steps: 369 | Train Loss: 0.081 Vali Loss: 1.813 Vali Acc: 0.644 Test Loss: 1.813 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0109116
	speed: 0.3211s/iter; left time: 10394.0401s
	iters: 200, epoch: 13 | loss: 0.0807609
	speed: 0.0981s/iter; left time: 3167.2209s
	iters: 300, epoch: 13 | loss: 0.2105967
	speed: 0.0804s/iter; left time: 2585.7263s
Epoch: 13 cost time: 30.288243293762207
Epoch: 13, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.879 Vali Acc: 0.630 Test Loss: 1.879 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0044968
	speed: 0.3290s/iter; left time: 10529.1241s
	iters: 200, epoch: 14 | loss: 0.2253516
	speed: 0.0710s/iter; left time: 2265.6292s
	iters: 300, epoch: 14 | loss: 0.0386385
	speed: 0.1005s/iter; left time: 3195.1118s
Epoch: 14 cost time: 32.113648891448975
Epoch: 14, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.078 Vali Acc: 0.632 Test Loss: 2.078 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0458586
	speed: 0.4015s/iter; left time: 12702.4281s
	iters: 200, epoch: 15 | loss: 0.0085611
	speed: 0.1004s/iter; left time: 3166.0556s
	iters: 300, epoch: 15 | loss: 0.4451635
	speed: 0.1338s/iter; left time: 4206.9699s
Epoch: 15 cost time: 43.34148168563843
Epoch: 15, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.195 Vali Acc: 0.622 Test Loss: 2.195 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0518908
	speed: 0.4325s/iter; left time: 13523.2130s
	iters: 200, epoch: 16 | loss: 0.0118324
	speed: 0.1173s/iter; left time: 3656.9964s
	iters: 300, epoch: 16 | loss: 0.0458669
	speed: 0.1157s/iter; left time: 3593.6962s
Epoch: 16 cost time: 39.67770600318909
Epoch: 16, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.131 Vali Acc: 0.633 Test Loss: 2.131 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0120983
	speed: 0.3458s/iter; left time: 10684.7421s
	iters: 200, epoch: 17 | loss: 0.0095296
	speed: 0.0697s/iter; left time: 2145.3845s
	iters: 300, epoch: 17 | loss: 0.0092089
	speed: 0.0870s/iter; left time: 2671.1261s
Epoch: 17 cost time: 29.85462522506714
Epoch: 17, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.237 Vali Acc: 0.641 Test Loss: 2.237 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0168591
	speed: 0.3652s/iter; left time: 11149.7676s
	iters: 200, epoch: 18 | loss: 0.0663644
	speed: 0.0701s/iter; left time: 2132.3862s
	iters: 300, epoch: 18 | loss: 0.0071280
	speed: 0.0822s/iter; left time: 2493.0761s
Epoch: 18 cost time: 32.47597670555115
Epoch: 18, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.224 Vali Acc: 0.633 Test Loss: 2.224 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.4319136
	speed: 0.4035s/iter; left time: 12167.7993s
	iters: 200, epoch: 19 | loss: 0.0009502
	speed: 0.1053s/iter; left time: 3165.6315s
	iters: 300, epoch: 19 | loss: 0.0169424
	speed: 0.1218s/iter; left time: 3648.7157s
Epoch: 19 cost time: 45.51973223686218
Epoch: 19, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.295 Vali Acc: 0.635 Test Loss: 2.295 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0055663
	speed: 0.4512s/iter; left time: 13440.0258s
	iters: 200, epoch: 20 | loss: 0.1476211
	speed: 0.0980s/iter; left time: 2908.8301s
	iters: 300, epoch: 20 | loss: 0.0700104
	speed: 0.1316s/iter; left time: 3893.3148s
Epoch: 20 cost time: 42.918758392333984
Epoch: 20, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.239 Vali Acc: 0.635 Test Loss: 2.239 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6492622020431328
model parameter : 106722
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6887948
	speed: 0.1086s/iter; left time: 3995.1546s
	iters: 200, epoch: 1 | loss: 0.8850251
	speed: 0.0530s/iter; left time: 1943.3914s
	iters: 300, epoch: 1 | loss: 0.8203403
	speed: 0.0529s/iter; left time: 1934.7825s
Epoch: 1 cost time: 25.43120813369751
Epoch: 1, Steps: 369 | Train Loss: 0.826 Vali Loss: 1.301 Vali Acc: 0.614 Test Loss: 1.301 Test Acc: 0.614
Validation loss decreased (inf --> -0.614346).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2039099
	speed: 0.2476s/iter; left time: 9019.0265s
	iters: 200, epoch: 2 | loss: 1.2151521
	speed: 0.0452s/iter; left time: 1642.2180s
	iters: 300, epoch: 2 | loss: 1.0482857
	speed: 0.0688s/iter; left time: 2492.8047s
Epoch: 2 cost time: 22.68479633331299
Epoch: 2, Steps: 369 | Train Loss: 0.819 Vali Loss: 1.408 Vali Acc: 0.638 Test Loss: 1.408 Test Acc: 0.638
Validation loss decreased (-0.614346 --> -0.638465).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0989404
	speed: 0.3065s/iter; left time: 11053.8989s
	iters: 200, epoch: 3 | loss: 0.5385286
	speed: 0.0741s/iter; left time: 2665.1886s
	iters: 300, epoch: 3 | loss: 0.5909202
	speed: 0.0725s/iter; left time: 2600.7980s
Epoch: 3 cost time: 28.538968324661255
Epoch: 3, Steps: 369 | Train Loss: 0.807 Vali Loss: 1.854 Vali Acc: 0.618 Test Loss: 1.854 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8200485
	speed: 0.3118s/iter; left time: 11129.0222s
	iters: 200, epoch: 4 | loss: 1.4041173
	speed: 0.0638s/iter; left time: 2271.1547s
	iters: 300, epoch: 4 | loss: 0.2916448
	speed: 0.0821s/iter; left time: 2915.5672s
Epoch: 4 cost time: 28.07042932510376
Epoch: 4, Steps: 369 | Train Loss: 0.723 Vali Loss: 1.680 Vali Acc: 0.667 Test Loss: 1.680 Test Acc: 0.667
Validation loss decreased (-0.638465 --> -0.667123).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4545893
	speed: 0.3112s/iter; left time: 10994.6886s
	iters: 200, epoch: 5 | loss: 0.3474642
	speed: 0.0529s/iter; left time: 1862.7230s
	iters: 300, epoch: 5 | loss: 0.4247924
	speed: 0.0557s/iter; left time: 1956.6858s
Epoch: 5 cost time: 22.948233127593994
Epoch: 5, Steps: 369 | Train Loss: 0.599 Vali Loss: 1.611 Vali Acc: 0.644 Test Loss: 1.611 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8163270
	speed: 0.2889s/iter; left time: 10097.5921s
	iters: 200, epoch: 6 | loss: 0.2159998
	speed: 0.0936s/iter; left time: 3264.0319s
	iters: 300, epoch: 6 | loss: 0.6934930
	speed: 0.0516s/iter; left time: 1791.8952s
Epoch: 6 cost time: 26.52079176902771
Epoch: 6, Steps: 369 | Train Loss: 0.456 Vali Loss: 1.624 Vali Acc: 0.638 Test Loss: 1.624 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1183688
	speed: 0.3028s/iter; left time: 10474.2366s
	iters: 200, epoch: 7 | loss: 0.0955340
	speed: 0.1029s/iter; left time: 3550.3038s
	iters: 300, epoch: 7 | loss: 0.5386869
	speed: 0.1076s/iter; left time: 3699.3932s
Epoch: 7 cost time: 35.59422945976257
Epoch: 7, Steps: 369 | Train Loss: 0.338 Vali Loss: 1.570 Vali Acc: 0.632 Test Loss: 1.570 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1391806
	speed: 0.3508s/iter; left time: 12005.2216s
	iters: 200, epoch: 8 | loss: 0.2733085
	speed: 0.0800s/iter; left time: 2729.2515s
	iters: 300, epoch: 8 | loss: 0.0758836
	speed: 0.0986s/iter; left time: 3354.7492s
Epoch: 8 cost time: 35.950355768203735
Epoch: 8, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.387 Vali Acc: 0.636 Test Loss: 1.387 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1774776
	speed: 0.3546s/iter; left time: 12003.7536s
	iters: 200, epoch: 9 | loss: 0.0598703
	speed: 0.0728s/iter; left time: 2458.4646s
	iters: 300, epoch: 9 | loss: 0.1129442
	speed: 0.0527s/iter; left time: 1773.4713s
Epoch: 9 cost time: 25.639926433563232
Epoch: 9, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.468 Vali Acc: 0.634 Test Loss: 1.468 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0840206
	speed: 0.2650s/iter; left time: 8873.7121s
	iters: 200, epoch: 10 | loss: 0.1524435
	speed: 0.0519s/iter; left time: 1733.5550s
	iters: 300, epoch: 10 | loss: 0.0480168
	speed: 0.0503s/iter; left time: 1673.4402s
Epoch: 10 cost time: 21.867047786712646
Epoch: 10, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.589 Vali Acc: 0.637 Test Loss: 1.589 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1210875
	speed: 0.2873s/iter; left time: 9514.0078s
	iters: 200, epoch: 11 | loss: 0.0712787
	speed: 0.0940s/iter; left time: 3103.2110s
	iters: 300, epoch: 11 | loss: 0.0276159
	speed: 0.0610s/iter; left time: 2007.4279s
Epoch: 11 cost time: 26.61547327041626
Epoch: 11, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.607 Vali Acc: 0.642 Test Loss: 1.607 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1896376
	speed: 0.3198s/iter; left time: 10470.6261s
	iters: 200, epoch: 12 | loss: 0.2897003
	speed: 0.1033s/iter; left time: 3372.5849s
	iters: 300, epoch: 12 | loss: 0.1246965
	speed: 0.1012s/iter; left time: 3294.4238s
Epoch: 12 cost time: 36.30532193183899
Epoch: 12, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.648 Vali Acc: 0.641 Test Loss: 1.648 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0031223
	speed: 0.3666s/iter; left time: 11868.3260s
	iters: 200, epoch: 13 | loss: 0.0589944
	speed: 0.0801s/iter; left time: 2584.4622s
	iters: 300, epoch: 13 | loss: 0.1613805
	speed: 0.0989s/iter; left time: 3180.3580s
Epoch: 13 cost time: 35.80625033378601
Epoch: 13, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.797 Vali Acc: 0.633 Test Loss: 1.797 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0143062
	speed: 0.3781s/iter; left time: 12100.4715s
	iters: 200, epoch: 14 | loss: 0.0445070
	speed: 0.0558s/iter; left time: 1781.6730s
	iters: 300, epoch: 14 | loss: 0.3277027
	speed: 0.0534s/iter; left time: 1699.4516s
Epoch: 14 cost time: 24.407269716262817
Epoch: 14, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.866 Vali Acc: 0.647 Test Loss: 1.866 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6671396140749148
model parameter : 79106
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0519880
	speed: 0.0775s/iter; left time: 2850.3575s
	iters: 200, epoch: 1 | loss: 0.4674454
	speed: 0.1035s/iter; left time: 3799.8172s
	iters: 300, epoch: 1 | loss: 0.8221477
	speed: 0.0788s/iter; left time: 2883.1139s
Epoch: 1 cost time: 30.820680618286133
Epoch: 1, Steps: 369 | Train Loss: 0.775 Vali Loss: 1.071 Vali Acc: 0.655 Test Loss: 1.071 Test Acc: 0.655
Validation loss decreased (inf --> -0.654927).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2426817
	speed: 0.3062s/iter; left time: 11155.4584s
	iters: 200, epoch: 2 | loss: 0.4064257
	speed: 0.0685s/iter; left time: 2487.6710s
	iters: 300, epoch: 2 | loss: 0.0842352
	speed: 0.0784s/iter; left time: 2839.0193s
Epoch: 2 cost time: 30.24021816253662
Epoch: 2, Steps: 369 | Train Loss: 0.752 Vali Loss: 1.319 Vali Acc: 0.654 Test Loss: 1.319 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7387372
	speed: 0.3258s/iter; left time: 11750.3270s
	iters: 200, epoch: 3 | loss: 0.4697944
	speed: 0.1027s/iter; left time: 3691.9868s
	iters: 300, epoch: 3 | loss: 0.4886820
	speed: 0.0382s/iter; left time: 1371.5371s
Epoch: 3 cost time: 25.90263342857361
Epoch: 3, Steps: 369 | Train Loss: 0.728 Vali Loss: 1.526 Vali Acc: 0.646 Test Loss: 1.526 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2941581
	speed: 0.2601s/iter; left time: 9285.6903s
	iters: 200, epoch: 4 | loss: 0.2685784
	speed: 0.0417s/iter; left time: 1485.6550s
	iters: 300, epoch: 4 | loss: 0.7231681
	speed: 0.0419s/iter; left time: 1488.5149s
Epoch: 4 cost time: 18.90518569946289
Epoch: 4, Steps: 369 | Train Loss: 0.698 Vali Loss: 1.758 Vali Acc: 0.626 Test Loss: 1.758 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6748749
	speed: 0.2339s/iter; left time: 8261.5761s
	iters: 200, epoch: 5 | loss: 0.7687705
	speed: 0.0446s/iter; left time: 1570.8628s
	iters: 300, epoch: 5 | loss: 0.2312625
	speed: 0.0435s/iter; left time: 1529.6209s
Epoch: 5 cost time: 17.440396308898926
Epoch: 5, Steps: 369 | Train Loss: 0.590 Vali Loss: 1.662 Vali Acc: 0.640 Test Loss: 1.662 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1040688
	speed: 0.2137s/iter; left time: 7469.9728s
	iters: 200, epoch: 6 | loss: 0.0312732
	speed: 0.0421s/iter; left time: 1468.6763s
	iters: 300, epoch: 6 | loss: 0.6911900
	speed: 0.0395s/iter; left time: 1372.3670s
Epoch: 6 cost time: 16.122568130493164
Epoch: 6, Steps: 369 | Train Loss: 0.483 Vali Loss: 1.505 Vali Acc: 0.638 Test Loss: 1.505 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1023931
	speed: 0.2443s/iter; left time: 8451.0332s
	iters: 200, epoch: 7 | loss: 0.3063414
	speed: 0.0648s/iter; left time: 2234.2472s
	iters: 300, epoch: 7 | loss: 0.2926935
	speed: 0.0651s/iter; left time: 2239.5446s
Epoch: 7 cost time: 24.961084365844727
Epoch: 7, Steps: 369 | Train Loss: 0.366 Vali Loss: 1.447 Vali Acc: 0.653 Test Loss: 1.447 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.1627514
	speed: 0.3151s/iter; left time: 10782.6136s
	iters: 200, epoch: 8 | loss: 0.0637718
	speed: 0.0728s/iter; left time: 2483.0454s
	iters: 300, epoch: 8 | loss: 0.2434386
	speed: 0.0721s/iter; left time: 2454.2239s
Epoch: 8 cost time: 30.46383047103882
Epoch: 8, Steps: 369 | Train Loss: 0.299 Vali Loss: 1.298 Vali Acc: 0.653 Test Loss: 1.298 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.2948580
	speed: 0.2758s/iter; left time: 9335.7086s
	iters: 200, epoch: 9 | loss: 0.1329266
	speed: 0.0483s/iter; left time: 1630.0236s
	iters: 300, epoch: 9 | loss: 0.0748765
	speed: 0.0541s/iter; left time: 1819.9703s
Epoch: 9 cost time: 18.85899019241333
Epoch: 9, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.376 Vali Acc: 0.651 Test Loss: 1.376 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.2080722
	speed: 0.2582s/iter; left time: 8645.5841s
	iters: 200, epoch: 10 | loss: 0.3243200
	speed: 0.0544s/iter; left time: 1815.1199s
	iters: 300, epoch: 10 | loss: 0.1736572
	speed: 0.0397s/iter; left time: 1320.2166s
Epoch: 10 cost time: 20.09983253479004
Epoch: 10, Steps: 369 | Train Loss: 0.211 Vali Loss: 1.493 Vali Acc: 0.633 Test Loss: 1.493 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.1021811
	speed: 0.2421s/iter; left time: 8015.9803s
	iters: 200, epoch: 11 | loss: 0.0905082
	speed: 0.0453s/iter; left time: 1495.1029s
	iters: 300, epoch: 11 | loss: 0.0318024
	speed: 0.0547s/iter; left time: 1798.6441s
Epoch: 11 cost time: 20.684191465377808
Epoch: 11, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.464 Vali Acc: 0.648 Test Loss: 1.464 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6549375709421112
model parameter : 65330
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6151540
	speed: 0.0953s/iter; left time: 3508.4926s
	iters: 200, epoch: 1 | loss: 0.5883926
	speed: 0.0856s/iter; left time: 3141.6651s
	iters: 300, epoch: 1 | loss: 0.8973188
	speed: 0.0770s/iter; left time: 2819.5515s
Epoch: 1 cost time: 30.316633224487305
Epoch: 1, Steps: 369 | Train Loss: 0.725 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
Validation loss decreased (inf --> -0.625416).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9372878
	speed: 0.2518s/iter; left time: 9175.0085s
	iters: 200, epoch: 2 | loss: 1.0488065
	speed: 0.0419s/iter; left time: 1523.4110s
	iters: 300, epoch: 2 | loss: 1.1177174
	speed: 0.0393s/iter; left time: 1422.7481s
Epoch: 2 cost time: 16.960843801498413
Epoch: 2, Steps: 369 | Train Loss: 0.722 Vali Loss: 1.212 Vali Acc: 0.647 Test Loss: 1.212 Test Acc: 0.647
Validation loss decreased (-0.625416 --> -0.646696).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1924859
	speed: 0.2177s/iter; left time: 7852.1824s
	iters: 200, epoch: 3 | loss: 0.8343669
	speed: 0.0413s/iter; left time: 1485.1890s
	iters: 300, epoch: 3 | loss: 1.4028920
	speed: 0.0397s/iter; left time: 1422.2249s
Epoch: 3 cost time: 16.041371822357178
Epoch: 3, Steps: 369 | Train Loss: 0.697 Vali Loss: 1.260 Vali Acc: 0.644 Test Loss: 1.260 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3856876
	speed: 0.2031s/iter; left time: 7248.5750s
	iters: 200, epoch: 4 | loss: 1.2049191
	speed: 0.0398s/iter; left time: 1417.3037s
	iters: 300, epoch: 4 | loss: 1.1293666
	speed: 0.0409s/iter; left time: 1450.6123s
Epoch: 4 cost time: 16.889942169189453
Epoch: 4, Steps: 369 | Train Loss: 0.645 Vali Loss: 1.374 Vali Acc: 0.653 Test Loss: 1.374 Test Acc: 0.653
Validation loss decreased (-0.646696 --> -0.653221).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8460600
	speed: 0.2225s/iter; left time: 7861.3317s
	iters: 200, epoch: 5 | loss: 0.2430566
	speed: 0.0512s/iter; left time: 1804.7553s
	iters: 300, epoch: 5 | loss: 1.4218600
	speed: 0.0532s/iter; left time: 1870.1771s
Epoch: 5 cost time: 19.894169092178345
Epoch: 5, Steps: 369 | Train Loss: 0.546 Vali Loss: 1.373 Vali Acc: 0.631 Test Loss: 1.373 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0477922
	speed: 0.2914s/iter; left time: 10187.5472s
	iters: 200, epoch: 6 | loss: 0.3164941
	speed: 0.0616s/iter; left time: 2148.2846s
	iters: 300, epoch: 6 | loss: 0.9047422
	speed: 0.0584s/iter; left time: 2030.9063s
Epoch: 6 cost time: 25.02965211868286
Epoch: 6, Steps: 369 | Train Loss: 0.461 Vali Loss: 1.347 Vali Acc: 0.646 Test Loss: 1.347 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2049216
	speed: 0.2733s/iter; left time: 9452.8671s
	iters: 200, epoch: 7 | loss: 1.3584387
	speed: 0.0667s/iter; left time: 2299.5424s
	iters: 300, epoch: 7 | loss: 0.2472325
	speed: 0.0824s/iter; left time: 2835.0334s
Epoch: 7 cost time: 27.513429164886475
Epoch: 7, Steps: 369 | Train Loss: 0.391 Vali Loss: 1.295 Vali Acc: 0.638 Test Loss: 1.295 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2906263
	speed: 0.2625s/iter; left time: 8981.7323s
	iters: 200, epoch: 8 | loss: 0.3992414
	speed: 0.0464s/iter; left time: 1581.4127s
	iters: 300, epoch: 8 | loss: 0.3821386
	speed: 0.0420s/iter; left time: 1430.1141s
Epoch: 8 cost time: 18.432748556137085
Epoch: 8, Steps: 369 | Train Loss: 0.312 Vali Loss: 1.221 Vali Acc: 0.656 Test Loss: 1.221 Test Acc: 0.656
Validation loss decreased (-0.653221 --> -0.655777).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3149765
	speed: 0.2329s/iter; left time: 7884.7834s
	iters: 200, epoch: 9 | loss: 0.2099036
	speed: 0.0403s/iter; left time: 1361.0404s
	iters: 300, epoch: 9 | loss: 0.2522702
	speed: 0.0369s/iter; left time: 1241.0792s
Epoch: 9 cost time: 15.915526866912842
Epoch: 9, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.277 Vali Acc: 0.632 Test Loss: 1.277 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1413052
	speed: 0.2201s/iter; left time: 7367.4145s
	iters: 200, epoch: 10 | loss: 0.1145274
	speed: 0.0403s/iter; left time: 1343.9502s
	iters: 300, epoch: 10 | loss: 0.0841428
	speed: 0.0555s/iter; left time: 1847.2117s
Epoch: 10 cost time: 18.985112190246582
Epoch: 10, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.323 Vali Acc: 0.642 Test Loss: 1.323 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0219022
	speed: 0.2412s/iter; left time: 7985.5721s
	iters: 200, epoch: 11 | loss: 0.1757147
	speed: 0.0890s/iter; left time: 2938.5373s
	iters: 300, epoch: 11 | loss: 0.1692319
	speed: 0.0677s/iter; left time: 2228.1893s
Epoch: 11 cost time: 26.845536470413208
Epoch: 11, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.311 Vali Acc: 0.639 Test Loss: 1.311 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0745161
	speed: 0.2642s/iter; left time: 8650.6061s
	iters: 200, epoch: 12 | loss: 0.0597221
	speed: 0.0618s/iter; left time: 2018.0386s
	iters: 300, epoch: 12 | loss: 0.4710118
	speed: 0.0594s/iter; left time: 1934.4188s
Epoch: 12 cost time: 23.366631507873535
Epoch: 12, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.377 Vali Acc: 0.636 Test Loss: 1.377 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0098404
	speed: 0.2581s/iter; left time: 8356.1875s
	iters: 200, epoch: 13 | loss: 0.0540858
	speed: 0.0596s/iter; left time: 1925.0363s
	iters: 300, epoch: 13 | loss: 0.1127232
	speed: 0.0321s/iter; left time: 1032.0712s
Epoch: 13 cost time: 20.06505513191223
Epoch: 13, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.451 Vali Acc: 0.636 Test Loss: 1.451 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0190968
	speed: 0.2238s/iter; left time: 7163.2317s
	iters: 200, epoch: 14 | loss: 0.0714073
	speed: 0.0636s/iter; left time: 2029.7777s
	iters: 300, epoch: 14 | loss: 0.2508235
	speed: 0.0504s/iter; left time: 1602.6701s
Epoch: 14 cost time: 19.635501384735107
Epoch: 14, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.524 Vali Acc: 0.631 Test Loss: 1.524 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0765325
	speed: 0.2276s/iter; left time: 7200.4320s
	iters: 200, epoch: 15 | loss: 0.4756984
	speed: 0.0421s/iter; left time: 1326.9062s
	iters: 300, epoch: 15 | loss: 0.1735869
	speed: 0.0416s/iter; left time: 1308.0040s
Epoch: 15 cost time: 17.703596830368042
Epoch: 15, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.567 Vali Acc: 0.638 Test Loss: 1.567 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1710884
	speed: 0.2220s/iter; left time: 6942.1469s
	iters: 200, epoch: 16 | loss: 0.2715769
	speed: 0.0505s/iter; left time: 1574.3409s
	iters: 300, epoch: 16 | loss: 0.5601131
	speed: 0.0588s/iter; left time: 1826.3380s
Epoch: 16 cost time: 19.34264874458313
Epoch: 16, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.554 Vali Acc: 0.641 Test Loss: 1.554 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1998879
	speed: 0.2847s/iter; left time: 8795.0949s
	iters: 200, epoch: 17 | loss: 0.1431313
	speed: 0.0686s/iter; left time: 2111.4272s
	iters: 300, epoch: 17 | loss: 0.2742366
	speed: 0.0743s/iter; left time: 2281.7945s
Epoch: 17 cost time: 29.732480764389038
Epoch: 17, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.685 Vali Acc: 0.622 Test Loss: 1.685 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0096608
	speed: 0.3423s/iter; left time: 10449.0368s
	iters: 200, epoch: 18 | loss: 0.1961799
	speed: 0.0681s/iter; left time: 2072.3682s
	iters: 300, epoch: 18 | loss: 0.1389175
	speed: 0.0660s/iter; left time: 2000.1993s
Epoch: 18 cost time: 28.512735605239868
Epoch: 18, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.737 Vali Acc: 0.643 Test Loss: 1.737 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.655788876276958
model parameter : 51554
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8018686
	speed: 0.0746s/iter; left time: 2746.1091s
	iters: 200, epoch: 1 | loss: 0.6969126
	speed: 0.0393s/iter; left time: 1443.0442s
	iters: 300, epoch: 1 | loss: 0.4810477
	speed: 0.0448s/iter; left time: 1640.6961s
Epoch: 1 cost time: 20.24643611907959
Epoch: 1, Steps: 369 | Train Loss: 0.707 Vali Loss: 1.015 Vali Acc: 0.618 Test Loss: 1.015 Test Acc: 0.618
Validation loss decreased (inf --> -0.617754).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6860027
	speed: 0.2264s/iter; left time: 8249.4331s
	iters: 200, epoch: 2 | loss: 0.6792070
	speed: 0.0569s/iter; left time: 2067.0987s
	iters: 300, epoch: 2 | loss: 0.6357982
	speed: 0.0460s/iter; left time: 1665.9432s
Epoch: 2 cost time: 19.90461564064026
Epoch: 2, Steps: 369 | Train Loss: 0.678 Vali Loss: 1.107 Vali Acc: 0.635 Test Loss: 1.107 Test Acc: 0.635
Validation loss decreased (-0.617754 --> -0.634495).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4956441
	speed: 0.2663s/iter; left time: 9604.0301s
	iters: 200, epoch: 3 | loss: 0.7161278
	speed: 0.0582s/iter; left time: 2093.8879s
	iters: 300, epoch: 3 | loss: 0.7408933
	speed: 0.0602s/iter; left time: 2158.8920s
Epoch: 3 cost time: 25.171369075775146
Epoch: 3, Steps: 369 | Train Loss: 0.641 Vali Loss: 1.421 Vali Acc: 0.644 Test Loss: 1.421 Test Acc: 0.644
Validation loss decreased (-0.634495 --> -0.644140).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3015842
	speed: 0.2891s/iter; left time: 10317.5856s
	iters: 200, epoch: 4 | loss: 0.4824280
	speed: 0.0800s/iter; left time: 2847.1594s
	iters: 300, epoch: 4 | loss: 0.5088201
	speed: 0.0625s/iter; left time: 2217.6322s
Epoch: 4 cost time: 26.521707773208618
Epoch: 4, Steps: 369 | Train Loss: 0.597 Vali Loss: 1.344 Vali Acc: 0.641 Test Loss: 1.344 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0629000
	speed: 0.2239s/iter; left time: 7910.8492s
	iters: 200, epoch: 5 | loss: 0.3321759
	speed: 0.0376s/iter; left time: 1324.7494s
	iters: 300, epoch: 5 | loss: 0.3254885
	speed: 0.0444s/iter; left time: 1558.0624s
Epoch: 5 cost time: 16.866625785827637
Epoch: 5, Steps: 369 | Train Loss: 0.516 Vali Loss: 1.248 Vali Acc: 0.656 Test Loss: 1.248 Test Acc: 0.656
Validation loss decreased (-0.644140 --> -0.655493).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6659248
	speed: 0.2296s/iter; left time: 8025.1820s
	iters: 200, epoch: 6 | loss: 0.5364152
	speed: 0.0563s/iter; left time: 1961.6359s
	iters: 300, epoch: 6 | loss: 0.5939474
	speed: 0.0339s/iter; left time: 1178.5857s
Epoch: 6 cost time: 17.167442798614502
Epoch: 6, Steps: 369 | Train Loss: 0.456 Vali Loss: 1.225 Vali Acc: 0.645 Test Loss: 1.225 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4304103
	speed: 0.2037s/iter; left time: 7045.7043s
	iters: 200, epoch: 7 | loss: 0.4964916
	speed: 0.0374s/iter; left time: 1288.4489s
	iters: 300, epoch: 7 | loss: 0.2461611
	speed: 0.0382s/iter; left time: 1312.1263s
Epoch: 7 cost time: 15.438056707382202
Epoch: 7, Steps: 369 | Train Loss: 0.372 Vali Loss: 1.203 Vali Acc: 0.653 Test Loss: 1.203 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2645032
	speed: 0.2094s/iter; left time: 7164.4820s
	iters: 200, epoch: 8 | loss: 1.0465624
	speed: 0.0323s/iter; left time: 1100.3158s
	iters: 300, epoch: 8 | loss: 0.3440279
	speed: 0.0342s/iter; left time: 1164.2500s
Epoch: 8 cost time: 15.290567874908447
Epoch: 8, Steps: 369 | Train Loss: 0.351 Vali Loss: 1.141 Vali Acc: 0.648 Test Loss: 1.141 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0863120
	speed: 0.2357s/iter; left time: 7979.4023s
	iters: 200, epoch: 9 | loss: 0.2677865
	speed: 0.0332s/iter; left time: 1120.3811s
	iters: 300, epoch: 9 | loss: 0.2012510
	speed: 0.0277s/iter; left time: 931.2292s
Epoch: 9 cost time: 14.624961853027344
Epoch: 9, Steps: 369 | Train Loss: 0.300 Vali Loss: 1.142 Vali Acc: 0.665 Test Loss: 1.142 Test Acc: 0.665
Validation loss decreased (-0.655493 --> -0.665426).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2414291
	speed: 0.1856s/iter; left time: 6214.2277s
	iters: 200, epoch: 10 | loss: 0.3559558
	speed: 0.0347s/iter; left time: 1156.9183s
	iters: 300, epoch: 10 | loss: 0.5624599
	speed: 0.0326s/iter; left time: 1085.7525s
Epoch: 10 cost time: 13.077153205871582
Epoch: 10, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.180 Vali Acc: 0.661 Test Loss: 1.180 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4824109
	speed: 0.1730s/iter; left time: 5728.9983s
	iters: 200, epoch: 11 | loss: 0.2096303
	speed: 0.0294s/iter; left time: 971.9983s
	iters: 300, epoch: 11 | loss: 0.1846648
	speed: 0.0337s/iter; left time: 1109.9621s
Epoch: 11 cost time: 12.985398769378662
Epoch: 11, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.230 Vali Acc: 0.652 Test Loss: 1.230 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1594894
	speed: 0.1923s/iter; left time: 6294.9404s
	iters: 200, epoch: 12 | loss: 0.1249773
	speed: 0.0353s/iter; left time: 1153.8901s
	iters: 300, epoch: 12 | loss: 0.1432310
	speed: 0.0342s/iter; left time: 1111.6461s
Epoch: 12 cost time: 13.511484622955322
Epoch: 12, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.230 Vali Acc: 0.657 Test Loss: 1.230 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0485377
	speed: 0.1821s/iter; left time: 5894.1578s
	iters: 200, epoch: 13 | loss: 0.1667551
	speed: 0.0393s/iter; left time: 1268.5554s
	iters: 300, epoch: 13 | loss: 0.4084935
	speed: 0.0565s/iter; left time: 1819.3242s
Epoch: 13 cost time: 18.466258764266968
Epoch: 13, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.332 Vali Acc: 0.640 Test Loss: 1.332 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1319608
	speed: 0.2524s/iter; left time: 8076.4849s
	iters: 200, epoch: 14 | loss: 0.1412923
	speed: 0.0676s/iter; left time: 2158.0384s
	iters: 300, epoch: 14 | loss: 0.1008098
	speed: 0.0710s/iter; left time: 2258.2323s
Epoch: 14 cost time: 24.306639432907104
Epoch: 14, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.304 Vali Acc: 0.657 Test Loss: 1.304 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1266712
	speed: 0.2588s/iter; left time: 8187.1067s
	iters: 200, epoch: 15 | loss: 0.2835122
	speed: 0.0447s/iter; left time: 1409.2279s
	iters: 300, epoch: 15 | loss: 0.0807835
	speed: 0.0368s/iter; left time: 1156.6946s
Epoch: 15 cost time: 18.351425409317017
Epoch: 15, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.397 Vali Acc: 0.646 Test Loss: 1.397 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0429963
	speed: 0.2032s/iter; left time: 6353.7958s
	iters: 200, epoch: 16 | loss: 0.2009151
	speed: 0.0364s/iter; left time: 1133.4755s
	iters: 300, epoch: 16 | loss: 0.0739725
	speed: 0.0398s/iter; left time: 1236.9485s
Epoch: 16 cost time: 15.086234331130981
Epoch: 16, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.487 Vali Acc: 0.649 Test Loss: 1.487 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0545034
	speed: 0.2155s/iter; left time: 6659.2045s
	iters: 200, epoch: 17 | loss: 0.0772930
	speed: 0.0468s/iter; left time: 1442.3337s
	iters: 300, epoch: 17 | loss: 0.0677276
	speed: 0.0467s/iter; left time: 1432.7464s
Epoch: 17 cost time: 16.07950186729431
Epoch: 17, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.503 Vali Acc: 0.653 Test Loss: 1.503 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1755796
	speed: 0.2148s/iter; left time: 6558.2953s
	iters: 200, epoch: 18 | loss: 0.6066603
	speed: 0.0444s/iter; left time: 1351.5982s
	iters: 300, epoch: 18 | loss: 0.1295029
	speed: 0.0355s/iter; left time: 1076.0614s
Epoch: 18 cost time: 16.24020743370056
Epoch: 18, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.554 Vali Acc: 0.651 Test Loss: 1.554 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1886429
	speed: 0.2364s/iter; left time: 7128.3213s
	iters: 200, epoch: 19 | loss: 0.0438585
	speed: 0.0553s/iter; left time: 1662.0937s
	iters: 300, epoch: 19 | loss: 0.2004574
	speed: 0.0564s/iter; left time: 1689.3948s
Epoch: 19 cost time: 23.776615142822266
Epoch: 19, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.577 Vali Acc: 0.653 Test Loss: 1.577 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 42386
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 9.4371643
	speed: 0.5015s/iter; left time: 18455.3095s
	iters: 200, epoch: 1 | loss: 1.9394759
	speed: 0.4513s/iter; left time: 16564.5868s
	iters: 300, epoch: 1 | loss: 5.2393703
	speed: 0.5192s/iter; left time: 19003.5191s
Epoch: 1 cost time: 188.22268772125244
Epoch: 1, Steps: 369 | Train Loss: 3.739 Vali Loss: 3.123 Vali Acc: 0.601 Test Loss: 3.123 Test Acc: 0.601
Validation loss decreased (inf --> -0.600707).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9088771
	speed: 1.6111s/iter; left time: 58696.5665s
	iters: 200, epoch: 2 | loss: 2.1613464
	speed: 0.4995s/iter; left time: 18147.2836s
	iters: 300, epoch: 2 | loss: 3.3586469
	speed: 0.5973s/iter; left time: 21642.7349s
Epoch: 2 cost time: 196.8176884651184
Epoch: 2, Steps: 369 | Train Loss: 5.071 Vali Loss: 4.748 Vali Acc: 0.646 Test Loss: 4.748 Test Acc: 0.646
Validation loss decreased (-0.600707 --> -0.645810).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.4157028
	speed: 1.6165s/iter; left time: 58295.9247s
	iters: 200, epoch: 3 | loss: 12.2156286
	speed: 0.5358s/iter; left time: 19268.5479s
	iters: 300, epoch: 3 | loss: 6.5148363
	speed: 0.5920s/iter; left time: 21230.6966s
Epoch: 3 cost time: 199.18370079994202
Epoch: 3, Steps: 369 | Train Loss: 7.512 Vali Loss: 6.110 Vali Acc: 0.617 Test Loss: 6.110 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 6.2590332
	speed: 1.5761s/iter; left time: 56258.4953s
	iters: 200, epoch: 4 | loss: 6.0973072
	speed: 0.5917s/iter; left time: 21059.6337s
	iters: 300, epoch: 4 | loss: 17.4854317
	speed: 0.5722s/iter; left time: 20309.4393s
Epoch: 4 cost time: 198.27924180030823
Epoch: 4, Steps: 369 | Train Loss: 9.149 Vali Loss: 10.503 Vali Acc: 0.644 Test Loss: 10.503 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 6.8949981
	speed: 1.5018s/iter; left time: 53050.3623s
	iters: 200, epoch: 5 | loss: 2.9166636
	speed: 0.5993s/iter; left time: 21110.1091s
	iters: 300, epoch: 5 | loss: 10.5730495
	speed: 0.5298s/iter; left time: 18608.7008s
Epoch: 5 cost time: 197.87300777435303
Epoch: 5, Steps: 369 | Train Loss: 8.768 Vali Loss: 10.050 Vali Acc: 0.633 Test Loss: 10.050 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.6870766
	speed: 1.5840s/iter; left time: 55371.0085s
	iters: 200, epoch: 6 | loss: 10.8525887
	speed: 0.5802s/iter; left time: 20223.9678s
	iters: 300, epoch: 6 | loss: 0.5103770
	speed: 0.4656s/iter; left time: 16183.7349s
Epoch: 6 cost time: 194.53482484817505
Epoch: 6, Steps: 369 | Train Loss: 9.297 Vali Loss: 13.660 Vali Acc: 0.655 Test Loss: 13.660 Test Acc: 0.655
Validation loss decreased (-0.645810 --> -0.654517).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9352410
	speed: 1.6593s/iter; left time: 57388.5295s
	iters: 200, epoch: 7 | loss: 10.1822596
	speed: 0.5547s/iter; left time: 19130.1412s
	iters: 300, epoch: 7 | loss: 6.3573437
	speed: 0.4560s/iter; left time: 15680.8042s
Epoch: 7 cost time: 189.95126008987427
Epoch: 7, Steps: 369 | Train Loss: 8.609 Vali Loss: 11.846 Vali Acc: 0.642 Test Loss: 11.846 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 21.2450333
	speed: 1.6647s/iter; left time: 56962.1157s
	iters: 200, epoch: 8 | loss: 0.2690091
	speed: 0.5211s/iter; left time: 17778.1089s
	iters: 300, epoch: 8 | loss: 10.0948868
	speed: 0.4813s/iter; left time: 16373.2347s
Epoch: 8 cost time: 195.45491695404053
Epoch: 8, Steps: 369 | Train Loss: 8.325 Vali Loss: 15.301 Vali Acc: 0.636 Test Loss: 15.301 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 19.9694061
	speed: 1.7376s/iter; left time: 58814.3924s
	iters: 200, epoch: 9 | loss: 7.6361957
	speed: 0.4705s/iter; left time: 15879.7403s
	iters: 300, epoch: 9 | loss: 9.7544031
	speed: 0.4631s/iter; left time: 15582.9201s
Epoch: 9 cost time: 181.98402500152588
Epoch: 9, Steps: 369 | Train Loss: 6.649 Vali Loss: 18.710 Vali Acc: 0.629 Test Loss: 18.710 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 10.2325993
	speed: 1.7191s/iter; left time: 57554.2923s
	iters: 200, epoch: 10 | loss: 0.3497519
	speed: 0.4745s/iter; left time: 15840.1752s
	iters: 300, epoch: 10 | loss: 6.9561248
	speed: 0.5076s/iter; left time: 16893.4788s
Epoch: 10 cost time: 192.7889120578766
Epoch: 10, Steps: 369 | Train Loss: 5.136 Vali Loss: 16.707 Vali Acc: 0.634 Test Loss: 16.707 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3173701
	speed: 1.7143s/iter; left time: 56763.3438s
	iters: 200, epoch: 11 | loss: 1.0518512
	speed: 0.5006s/iter; left time: 16524.5437s
	iters: 300, epoch: 11 | loss: 5.4123416
	speed: 0.5583s/iter; left time: 18375.1283s
Epoch: 11 cost time: 195.71443223953247
Epoch: 11, Steps: 369 | Train Loss: 4.403 Vali Loss: 18.607 Vali Acc: 0.619 Test Loss: 18.607 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.0343709
	speed: 1.6660s/iter; left time: 54549.5302s
	iters: 200, epoch: 12 | loss: 10.4181719
	speed: 0.5191s/iter; left time: 16944.0180s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.5654s/iter; left time: 18399.6567s
Epoch: 12 cost time: 198.88514924049377
Epoch: 12, Steps: 369 | Train Loss: 3.259 Vali Loss: 15.351 Vali Acc: 0.627 Test Loss: 15.351 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 7.3804240
	speed: 1.5611s/iter; left time: 50537.8368s
	iters: 200, epoch: 13 | loss: 3.4816618
	speed: 0.4879s/iter; left time: 15746.9353s
	iters: 300, epoch: 13 | loss: 4.6591768
	speed: 0.4274s/iter; left time: 13750.9098s
Epoch: 13 cost time: 178.0441255569458
Epoch: 13, Steps: 369 | Train Loss: 2.304 Vali Loss: 19.090 Vali Acc: 0.634 Test Loss: 19.090 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.8604431
	speed: 1.6760s/iter; left time: 53638.7205s
	iters: 200, epoch: 14 | loss: 0.8585010
	speed: 0.4610s/iter; left time: 14708.2604s
	iters: 300, epoch: 14 | loss: 1.4264662
	speed: 0.5537s/iter; left time: 17610.2145s
Epoch: 14 cost time: 190.2466070652008
Epoch: 14, Steps: 369 | Train Loss: 2.035 Vali Loss: 17.854 Vali Acc: 0.623 Test Loss: 17.854 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7634060
	speed: 1.6005s/iter; left time: 50632.7833s
	iters: 200, epoch: 15 | loss: 1.3602666
	speed: 0.5803s/iter; left time: 18299.3354s
	iters: 300, epoch: 15 | loss: 1.7758851
	speed: 0.5945s/iter; left time: 18688.5342s
Epoch: 15 cost time: 197.89004945755005
Epoch: 15, Steps: 369 | Train Loss: 1.482 Vali Loss: 14.808 Vali Acc: 0.649 Test Loss: 14.808 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.2650602
	speed: 1.5583s/iter; left time: 48720.7812s
	iters: 200, epoch: 16 | loss: 0.0000069
	speed: 0.5661s/iter; left time: 17643.7729s
	iters: 300, epoch: 16 | loss: 0.7377239
	speed: 0.4528s/iter; left time: 14066.9245s
Epoch: 16 cost time: 190.02093648910522
Epoch: 16, Steps: 369 | Train Loss: 1.062 Vali Loss: 13.409 Vali Acc: 0.633 Test Loss: 13.409 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6546538024971623
model parameter : 2551042
model size : 12.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.9753187
	speed: 0.2238s/iter; left time: 8237.1704s
	iters: 200, epoch: 1 | loss: 1.9006528
	speed: 0.2342s/iter; left time: 8595.7796s
	iters: 300, epoch: 1 | loss: 2.0362673
	speed: 0.2624s/iter; left time: 9602.4153s
Epoch: 1 cost time: 90.76793599128723
Epoch: 1, Steps: 369 | Train Loss: 2.209 Vali Loss: 1.825 Vali Acc: 0.649 Test Loss: 1.825 Test Acc: 0.649
Validation loss decreased (inf --> -0.648676).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3611507
	speed: 0.8865s/iter; left time: 32296.0898s
	iters: 200, epoch: 2 | loss: 4.9432368
	speed: 0.2104s/iter; left time: 7643.7195s
	iters: 300, epoch: 2 | loss: 0.0031706
	speed: 0.2094s/iter; left time: 7588.0394s
Epoch: 2 cost time: 75.91317462921143
Epoch: 2, Steps: 369 | Train Loss: 3.525 Vali Loss: 2.404 Vali Acc: 0.631 Test Loss: 2.404 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 6.6466112
	speed: 0.8477s/iter; left time: 30571.6484s
	iters: 200, epoch: 3 | loss: 1.9958938
	speed: 0.2688s/iter; left time: 9665.3948s
	iters: 300, epoch: 3 | loss: 9.0074368
	speed: 0.2858s/iter; left time: 10249.2423s
Epoch: 3 cost time: 101.4503743648529
Epoch: 3, Steps: 369 | Train Loss: 5.039 Vali Loss: 7.554 Vali Acc: 0.656 Test Loss: 7.554 Test Acc: 0.656
Validation loss decreased (-0.648676 --> -0.656281).  Saving model ...
	iters: 100, epoch: 4 | loss: 7.1247663
	speed: 0.8363s/iter; left time: 29850.4550s
	iters: 200, epoch: 4 | loss: 10.3187456
	speed: 0.2163s/iter; left time: 7699.1229s
	iters: 300, epoch: 4 | loss: 6.6218653
	speed: 0.2029s/iter; left time: 7201.1342s
Epoch: 4 cost time: 85.16501832008362
Epoch: 4, Steps: 369 | Train Loss: 6.087 Vali Loss: 5.675 Vali Acc: 0.662 Test Loss: 5.675 Test Acc: 0.662
Validation loss decreased (-0.656281 --> -0.661975).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.8013802
	speed: 0.9377s/iter; left time: 33125.5535s
	iters: 200, epoch: 5 | loss: 9.7775784
	speed: 0.2185s/iter; left time: 7694.9353s
	iters: 300, epoch: 5 | loss: 6.7354531
	speed: 0.2195s/iter; left time: 7711.2924s
Epoch: 5 cost time: 83.87240648269653
Epoch: 5, Steps: 369 | Train Loss: 6.855 Vali Loss: 7.241 Vali Acc: 0.648 Test Loss: 7.241 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.7107992
	speed: 0.7814s/iter; left time: 27313.3777s
	iters: 200, epoch: 6 | loss: 5.6636696
	speed: 0.2674s/iter; left time: 9321.8339s
	iters: 300, epoch: 6 | loss: 7.6525135
	speed: 0.2731s/iter; left time: 9491.5389s
Epoch: 6 cost time: 95.98588228225708
Epoch: 6, Steps: 369 | Train Loss: 6.963 Vali Loss: 7.921 Vali Acc: 0.657 Test Loss: 7.921 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 10.2539692
	speed: 0.8721s/iter; left time: 30163.0268s
	iters: 200, epoch: 7 | loss: 10.6591816
	speed: 0.2022s/iter; left time: 6973.2013s
	iters: 300, epoch: 7 | loss: 8.1223421
	speed: 0.1920s/iter; left time: 6603.3249s
Epoch: 7 cost time: 76.61806559562683
Epoch: 7, Steps: 369 | Train Loss: 7.248 Vali Loss: 8.415 Vali Acc: 0.648 Test Loss: 8.415 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 16.9926033
	speed: 0.8147s/iter; left time: 27879.1121s
	iters: 200, epoch: 8 | loss: 6.0485177
	speed: 0.2548s/iter; left time: 8692.4623s
	iters: 300, epoch: 8 | loss: 9.7127466
	speed: 0.2174s/iter; left time: 7395.5298s
Epoch: 8 cost time: 87.55459213256836
Epoch: 8, Steps: 369 | Train Loss: 6.773 Vali Loss: 9.114 Vali Acc: 0.656 Test Loss: 9.114 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.2982831
	speed: 0.7805s/iter; left time: 26417.6731s
	iters: 200, epoch: 9 | loss: 2.9852252
	speed: 0.2147s/iter; left time: 7246.4336s
	iters: 300, epoch: 9 | loss: 14.9388847
	speed: 0.2624s/iter; left time: 8828.4191s
Epoch: 9 cost time: 90.39373707771301
Epoch: 9, Steps: 369 | Train Loss: 5.875 Vali Loss: 9.203 Vali Acc: 0.630 Test Loss: 9.203 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 7.3787136
	speed: 0.9015s/iter; left time: 30183.0013s
	iters: 200, epoch: 10 | loss: 2.3933768
	speed: 0.2180s/iter; left time: 7277.9637s
	iters: 300, epoch: 10 | loss: 10.9106159
	speed: 0.2204s/iter; left time: 7335.1207s
Epoch: 10 cost time: 79.9458794593811
Epoch: 10, Steps: 369 | Train Loss: 5.222 Vali Loss: 7.825 Vali Acc: 0.651 Test Loss: 7.825 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 5.1266289
	speed: 0.8641s/iter; left time: 28611.2067s
	iters: 200, epoch: 11 | loss: 4.3987408
	speed: 0.2504s/iter; left time: 8266.5336s
	iters: 300, epoch: 11 | loss: 0.6256233
	speed: 0.2606s/iter; left time: 8578.1223s
Epoch: 11 cost time: 93.89650964736938
Epoch: 11, Steps: 369 | Train Loss: 4.107 Vali Loss: 6.417 Vali Acc: 0.640 Test Loss: 6.417 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4603747
	speed: 0.7936s/iter; left time: 25982.4190s
	iters: 200, epoch: 12 | loss: 1.6657504
	speed: 0.1898s/iter; left time: 6196.9986s
	iters: 300, epoch: 12 | loss: 3.4110689
	speed: 0.2169s/iter; left time: 7059.4494s
Epoch: 12 cost time: 78.84509491920471
Epoch: 12, Steps: 369 | Train Loss: 3.096 Vali Loss: 4.414 Vali Acc: 0.645 Test Loss: 4.414 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.2380122
	speed: 0.9338s/iter; left time: 30229.9527s
	iters: 200, epoch: 13 | loss: 1.7134974
	speed: 0.2173s/iter; left time: 7012.5918s
	iters: 300, epoch: 13 | loss: 1.5788496
	speed: 0.1998s/iter; left time: 6429.2365s
Epoch: 13 cost time: 86.1652500629425
Epoch: 13, Steps: 369 | Train Loss: 1.782 Vali Loss: 4.016 Vali Acc: 0.647 Test Loss: 4.016 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0537391
	speed: 0.7962s/iter; left time: 25481.5397s
	iters: 200, epoch: 14 | loss: 0.3610414
	speed: 0.2618s/iter; left time: 8350.9392s
	iters: 300, epoch: 14 | loss: 1.2898806
	speed: 0.2653s/iter; left time: 8437.0084s
Epoch: 14 cost time: 95.92267179489136
Epoch: 14, Steps: 369 | Train Loss: 0.988 Vali Loss: 2.964 Vali Acc: 0.639 Test Loss: 2.964 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6620317820658342
model parameter : 1408514
model size : 7.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 5.0454273
	speed: 0.1634s/iter; left time: 6014.6108s
	iters: 200, epoch: 1 | loss: 0.8506432
	speed: 0.1259s/iter; left time: 4618.9008s
	iters: 300, epoch: 1 | loss: 2.2315953
	speed: 0.1445s/iter; left time: 5287.1762s
Epoch: 1 cost time: 52.56622838973999
Epoch: 1, Steps: 369 | Train Loss: 1.905 Vali Loss: 1.249 Vali Acc: 0.665 Test Loss: 1.249 Test Acc: 0.665
Validation loss decreased (inf --> -0.665425).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4615346
	speed: 0.6324s/iter; left time: 23039.5565s
	iters: 200, epoch: 2 | loss: 3.0578022
	speed: 0.2010s/iter; left time: 7302.3462s
	iters: 300, epoch: 2 | loss: 1.5744627
	speed: 0.1901s/iter; left time: 6888.5136s
Epoch: 2 cost time: 72.03141283988953
Epoch: 2, Steps: 369 | Train Loss: 2.911 Vali Loss: 2.023 Vali Acc: 0.638 Test Loss: 2.023 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0484409
	speed: 0.6246s/iter; left time: 22523.6843s
	iters: 200, epoch: 3 | loss: 4.8925781
	speed: 0.1562s/iter; left time: 5616.8147s
	iters: 300, epoch: 3 | loss: 4.1241908
	speed: 0.1651s/iter; left time: 5919.1957s
Epoch: 3 cost time: 60.533817768096924
Epoch: 3, Steps: 369 | Train Loss: 4.321 Vali Loss: 3.135 Vali Acc: 0.652 Test Loss: 3.135 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 8.3541260
	speed: 0.6752s/iter; left time: 24099.2765s
	iters: 200, epoch: 4 | loss: 3.8767407
	speed: 0.2006s/iter; left time: 7140.1729s
	iters: 300, epoch: 4 | loss: 12.1644726
	speed: 0.1763s/iter; left time: 6257.7622s
Epoch: 4 cost time: 68.87202382087708
Epoch: 4, Steps: 369 | Train Loss: 5.079 Vali Loss: 5.642 Vali Acc: 0.629 Test Loss: 5.642 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 9.2586479
	speed: 0.5939s/iter; left time: 20980.3236s
	iters: 200, epoch: 5 | loss: 4.9129224
	speed: 0.1466s/iter; left time: 5165.2035s
	iters: 300, epoch: 5 | loss: 0.8939837
	speed: 0.1628s/iter; left time: 5718.1498s
Epoch: 5 cost time: 59.120521545410156
Epoch: 5, Steps: 369 | Train Loss: 5.204 Vali Loss: 6.311 Vali Acc: 0.622 Test Loss: 6.311 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 5.0599055
	speed: 0.6862s/iter; left time: 23986.9985s
	iters: 200, epoch: 6 | loss: 5.6330709
	speed: 0.2039s/iter; left time: 7108.3300s
	iters: 300, epoch: 6 | loss: 4.8544917
	speed: 0.1727s/iter; left time: 6002.7292s
Epoch: 6 cost time: 71.91650772094727
Epoch: 6, Steps: 369 | Train Loss: 5.806 Vali Loss: 9.509 Vali Acc: 0.617 Test Loss: 9.509 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 7.2252774
	speed: 0.6082s/iter; left time: 21037.2640s
	iters: 200, epoch: 7 | loss: 4.6855779
	speed: 0.1612s/iter; left time: 5559.8962s
	iters: 300, epoch: 7 | loss: 9.8786650
	speed: 0.1516s/iter; left time: 5212.5276s
Epoch: 7 cost time: 60.64472484588623
Epoch: 7, Steps: 369 | Train Loss: 5.884 Vali Loss: 4.860 Vali Acc: 0.647 Test Loss: 4.860 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.1909788
	speed: 0.6652s/iter; left time: 22761.2246s
	iters: 200, epoch: 8 | loss: 1.3383747
	speed: 0.1966s/iter; left time: 6707.1556s
	iters: 300, epoch: 8 | loss: 12.9926186
	speed: 0.1468s/iter; left time: 4994.5773s
Epoch: 8 cost time: 67.25499534606934
Epoch: 8, Steps: 369 | Train Loss: 5.442 Vali Loss: 7.230 Vali Acc: 0.639 Test Loss: 7.230 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 3.4734740
	speed: 0.5943s/iter; left time: 20116.6078s
	iters: 200, epoch: 9 | loss: 9.8178988
	speed: 0.1585s/iter; left time: 5349.8937s
	iters: 300, epoch: 9 | loss: 5.1931477
	speed: 0.1675s/iter; left time: 5635.5071s
Epoch: 9 cost time: 63.13090920448303
Epoch: 9, Steps: 369 | Train Loss: 4.778 Vali Loss: 6.110 Vali Acc: 0.647 Test Loss: 6.110 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 4.8021317
	speed: 0.7055s/iter; left time: 23620.0394s
	iters: 200, epoch: 10 | loss: 2.8257258
	speed: 0.1722s/iter; left time: 5748.4958s
	iters: 300, epoch: 10 | loss: 4.7345881
	speed: 0.1647s/iter; left time: 5480.2466s
Epoch: 10 cost time: 65.30514645576477
Epoch: 10, Steps: 369 | Train Loss: 4.206 Vali Loss: 7.714 Vali Acc: 0.642 Test Loss: 7.714 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.4985299
	speed: 0.5774s/iter; left time: 19119.6775s
	iters: 200, epoch: 11 | loss: 4.7461472
	speed: 0.1734s/iter; left time: 5722.6894s
	iters: 300, epoch: 11 | loss: 3.3602755
	speed: 0.1792s/iter; left time: 5896.5911s
Epoch: 11 cost time: 66.97641205787659
Epoch: 11, Steps: 369 | Train Loss: 3.323 Vali Loss: 5.044 Vali Acc: 0.661 Test Loss: 5.044 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 1040002
model size : 6.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.7380786
	speed: 0.1668s/iter; left time: 6137.8775s
	iters: 200, epoch: 1 | loss: 1.5649735
	speed: 0.1630s/iter; left time: 5982.9063s
	iters: 300, epoch: 1 | loss: 1.1069567
	speed: 0.1424s/iter; left time: 5212.0418s
Epoch: 1 cost time: 57.786619424819946
Epoch: 1, Steps: 369 | Train Loss: 1.679 Vali Loss: 1.372 Vali Acc: 0.663 Test Loss: 1.372 Test Acc: 0.663
Validation loss decreased (inf --> -0.663153).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9440476
	speed: 0.4691s/iter; left time: 17089.7725s
	iters: 200, epoch: 2 | loss: 1.2543885
	speed: 0.1097s/iter; left time: 3986.3805s
	iters: 300, epoch: 2 | loss: 1.5778854
	speed: 0.1271s/iter; left time: 4605.1592s
Epoch: 2 cost time: 44.153679847717285
Epoch: 2, Steps: 369 | Train Loss: 2.499 Vali Loss: 3.185 Vali Acc: 0.630 Test Loss: 3.185 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2453828
	speed: 0.4485s/iter; left time: 16172.9870s
	iters: 200, epoch: 3 | loss: 4.2863097
	speed: 0.1547s/iter; left time: 5561.7228s
	iters: 300, epoch: 3 | loss: 0.0965145
	speed: 0.1441s/iter; left time: 5169.4536s
Epoch: 3 cost time: 55.43422293663025
Epoch: 3, Steps: 369 | Train Loss: 3.543 Vali Loss: 3.320 Vali Acc: 0.654 Test Loss: 3.320 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3643050
	speed: 0.5418s/iter; left time: 19340.6215s
	iters: 200, epoch: 4 | loss: 1.4472209
	speed: 0.1073s/iter; left time: 3820.4974s
	iters: 300, epoch: 4 | loss: 2.9634607
	speed: 0.1070s/iter; left time: 3797.2502s
Epoch: 4 cost time: 43.11042356491089
Epoch: 4, Steps: 369 | Train Loss: 4.135 Vali Loss: 5.884 Vali Acc: 0.632 Test Loss: 5.884 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.7905192
	speed: 0.4223s/iter; left time: 14918.9703s
	iters: 200, epoch: 5 | loss: 5.4477544
	speed: 0.1322s/iter; left time: 4655.9520s
	iters: 300, epoch: 5 | loss: 6.1161079
	speed: 0.1174s/iter; left time: 4123.4866s
Epoch: 5 cost time: 49.7455153465271
Epoch: 5, Steps: 369 | Train Loss: 4.450 Vali Loss: 4.348 Vali Acc: 0.618 Test Loss: 4.348 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 4.6027298
	speed: 0.5759s/iter; left time: 20129.4374s
	iters: 200, epoch: 6 | loss: 6.8757753
	speed: 0.1584s/iter; left time: 5522.0293s
	iters: 300, epoch: 6 | loss: 3.7805309
	speed: 0.1391s/iter; left time: 4834.3604s
Epoch: 6 cost time: 55.19865965843201
Epoch: 6, Steps: 369 | Train Loss: 4.856 Vali Loss: 6.164 Vali Acc: 0.648 Test Loss: 6.164 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 7.1393614
	speed: 0.4882s/iter; left time: 16885.8561s
	iters: 200, epoch: 7 | loss: 6.5106025
	speed: 0.1263s/iter; left time: 4357.4080s
	iters: 300, epoch: 7 | loss: 8.7859077
	speed: 0.1111s/iter; left time: 3818.8230s
Epoch: 7 cost time: 46.49321985244751
Epoch: 7, Steps: 369 | Train Loss: 4.401 Vali Loss: 7.266 Vali Acc: 0.656 Test Loss: 7.266 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 4.9111762
	speed: 0.5387s/iter; left time: 18432.7884s
	iters: 200, epoch: 8 | loss: 2.1235118
	speed: 0.1596s/iter; left time: 5443.7659s
	iters: 300, epoch: 8 | loss: 8.9601765
	speed: 0.1567s/iter; left time: 5331.4469s
Epoch: 8 cost time: 59.360788345336914
Epoch: 8, Steps: 369 | Train Loss: 4.174 Vali Loss: 5.722 Vali Acc: 0.627 Test Loss: 5.722 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7533098
	speed: 0.5304s/iter; left time: 17952.3454s
	iters: 200, epoch: 9 | loss: 2.7900102
	speed: 0.1265s/iter; left time: 4268.4626s
	iters: 300, epoch: 9 | loss: 4.0299683
	speed: 0.1215s/iter; left time: 4089.3122s
Epoch: 9 cost time: 48.49332547187805
Epoch: 9, Steps: 369 | Train Loss: 3.949 Vali Loss: 6.191 Vali Acc: 0.636 Test Loss: 6.191 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 4.5028515
	speed: 0.5057s/iter; left time: 16929.6193s
	iters: 200, epoch: 10 | loss: 5.9388490
	speed: 0.1488s/iter; left time: 4967.4018s
	iters: 300, epoch: 10 | loss: 3.0641744
	speed: 0.1556s/iter; left time: 5179.9835s
Epoch: 10 cost time: 55.79351544380188
Epoch: 10, Steps: 369 | Train Loss: 3.337 Vali Loss: 5.489 Vali Acc: 0.651 Test Loss: 5.489 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 4.9548130
	speed: 0.5717s/iter; left time: 18930.9514s
	iters: 200, epoch: 11 | loss: 1.5851654
	speed: 0.1128s/iter; left time: 3723.0092s
	iters: 300, epoch: 11 | loss: 6.3972230
	speed: 0.1331s/iter; left time: 4381.9189s
Epoch: 11 cost time: 50.36578917503357
Epoch: 11, Steps: 369 | Train Loss: 2.998 Vali Loss: 4.987 Vali Acc: 0.643 Test Loss: 4.987 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.66316685584563
model parameter : 819074
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.2015517
	speed: 0.1127s/iter; left time: 4146.6923s
	iters: 200, epoch: 1 | loss: 0.5956510
	speed: 0.0856s/iter; left time: 3140.4394s
	iters: 300, epoch: 1 | loss: 2.6380723
	speed: 0.0893s/iter; left time: 3267.2473s
Epoch: 1 cost time: 35.141844511032104
Epoch: 1, Steps: 369 | Train Loss: 1.611 Vali Loss: 1.196 Vali Acc: 0.631 Test Loss: 1.196 Test Acc: 0.631
Validation loss decreased (inf --> -0.631373).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9731927
	speed: 0.3522s/iter; left time: 12830.8621s
	iters: 200, epoch: 2 | loss: 3.1662829
	speed: 0.1155s/iter; left time: 4197.4575s
	iters: 300, epoch: 2 | loss: 2.0287080
	speed: 0.1280s/iter; left time: 4636.5511s
Epoch: 2 cost time: 43.94036316871643
Epoch: 2, Steps: 369 | Train Loss: 2.249 Vali Loss: 3.124 Vali Acc: 0.621 Test Loss: 3.124 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.7382644
	speed: 0.4730s/iter; left time: 17057.6115s
	iters: 200, epoch: 3 | loss: 2.3175097
	speed: 0.1296s/iter; left time: 4660.0159s
	iters: 300, epoch: 3 | loss: 2.4229555
	speed: 0.1009s/iter; left time: 3619.9163s
Epoch: 3 cost time: 42.356281757354736
Epoch: 3, Steps: 369 | Train Loss: 3.065 Vali Loss: 1.911 Vali Acc: 0.648 Test Loss: 1.911 Test Acc: 0.648
Validation loss decreased (-0.631373 --> -0.648392).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0799000
	speed: 0.4119s/iter; left time: 14702.5944s
	iters: 200, epoch: 4 | loss: 6.1514883
	speed: 0.0993s/iter; left time: 3536.0930s
	iters: 300, epoch: 4 | loss: 3.2706249
	speed: 0.0986s/iter; left time: 3498.3798s
Epoch: 4 cost time: 39.478017807006836
Epoch: 4, Steps: 369 | Train Loss: 3.571 Vali Loss: 6.093 Vali Acc: 0.639 Test Loss: 6.093 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4797748
	speed: 0.4273s/iter; left time: 15094.6889s
	iters: 200, epoch: 5 | loss: 6.5920024
	speed: 0.1304s/iter; left time: 4594.6702s
	iters: 300, epoch: 5 | loss: 2.7760949
	speed: 0.1333s/iter; left time: 4681.5676s
Epoch: 5 cost time: 47.752687215805054
Epoch: 5, Steps: 369 | Train Loss: 3.946 Vali Loss: 3.668 Vali Acc: 0.627 Test Loss: 3.668 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.1906796
	speed: 0.4820s/iter; left time: 16848.9275s
	iters: 200, epoch: 6 | loss: 5.4316359
	speed: 0.0981s/iter; left time: 3417.9062s
	iters: 300, epoch: 6 | loss: 1.6753144
	speed: 0.0973s/iter; left time: 3380.3833s
Epoch: 6 cost time: 41.65979361534119
Epoch: 6, Steps: 369 | Train Loss: 4.265 Vali Loss: 4.088 Vali Acc: 0.663 Test Loss: 4.088 Test Acc: 0.663
Validation loss decreased (-0.648392 --> -0.662842).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0878663
	speed: 0.4046s/iter; left time: 13995.5001s
	iters: 200, epoch: 7 | loss: 5.2957578
	speed: 0.1031s/iter; left time: 3555.5534s
	iters: 300, epoch: 7 | loss: 6.1862459
	speed: 0.0965s/iter; left time: 3318.8382s
Epoch: 7 cost time: 35.11546778678894
Epoch: 7, Steps: 369 | Train Loss: 3.906 Vali Loss: 7.341 Vali Acc: 0.623 Test Loss: 7.341 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 4.0675492
	speed: 0.4000s/iter; left time: 13687.7063s
	iters: 200, epoch: 8 | loss: 1.7480587
	speed: 0.1193s/iter; left time: 4068.8170s
	iters: 300, epoch: 8 | loss: 6.9739833
	speed: 0.1192s/iter; left time: 4053.9443s
Epoch: 8 cost time: 44.10664463043213
Epoch: 8, Steps: 369 | Train Loss: 4.179 Vali Loss: 5.789 Vali Acc: 0.639 Test Loss: 5.789 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.2397211
	speed: 0.4645s/iter; left time: 15722.9796s
	iters: 200, epoch: 9 | loss: 6.3454790
	speed: 0.1298s/iter; left time: 4381.6632s
	iters: 300, epoch: 9 | loss: 2.6492796
	speed: 0.0973s/iter; left time: 3274.5395s
Epoch: 9 cost time: 41.77431607246399
Epoch: 9, Steps: 369 | Train Loss: 3.972 Vali Loss: 4.184 Vali Acc: 0.629 Test Loss: 4.184 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.8293211
	speed: 0.4068s/iter; left time: 13620.0106s
	iters: 200, epoch: 10 | loss: 2.9614244
	speed: 0.0912s/iter; left time: 3044.5012s
	iters: 300, epoch: 10 | loss: 3.8235455
	speed: 0.0877s/iter; left time: 2918.3379s
Epoch: 10 cost time: 37.9819598197937
Epoch: 10, Steps: 369 | Train Loss: 3.437 Vali Loss: 5.369 Vali Acc: 0.629 Test Loss: 5.369 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.8287811
	speed: 0.4051s/iter; left time: 13414.5439s
	iters: 200, epoch: 11 | loss: 2.8280983
	speed: 0.0993s/iter; left time: 3277.1616s
	iters: 300, epoch: 11 | loss: 2.6097753
	speed: 0.1224s/iter; left time: 4027.8763s
Epoch: 11 cost time: 38.953238010406494
Epoch: 11, Steps: 369 | Train Loss: 2.624 Vali Loss: 4.537 Vali Acc: 0.636 Test Loss: 4.537 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2248886
	speed: 0.3500s/iter; left time: 11459.1687s
	iters: 200, epoch: 12 | loss: 1.5107651
	speed: 0.0955s/iter; left time: 3115.9797s
	iters: 300, epoch: 12 | loss: 0.2243205
	speed: 0.0815s/iter; left time: 2652.7283s
Epoch: 12 cost time: 31.509464502334595
Epoch: 12, Steps: 369 | Train Loss: 1.833 Vali Loss: 3.322 Vali Acc: 0.622 Test Loss: 3.322 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.3440068
	speed: 0.3435s/iter; left time: 11119.3982s
	iters: 200, epoch: 13 | loss: 0.5000228
	speed: 0.1038s/iter; left time: 3351.2707s
	iters: 300, epoch: 13 | loss: 1.6025285
	speed: 0.1019s/iter; left time: 3279.2923s
Epoch: 13 cost time: 39.5450758934021
Epoch: 13, Steps: 369 | Train Loss: 1.299 Vali Loss: 1.491 Vali Acc: 0.624 Test Loss: 1.491 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1759810
	speed: 0.4096s/iter; left time: 13109.0590s
	iters: 200, epoch: 14 | loss: 0.4471937
	speed: 0.1056s/iter; left time: 3369.6506s
	iters: 300, epoch: 14 | loss: 0.6262637
	speed: 0.1081s/iter; left time: 3436.8039s
Epoch: 14 cost time: 38.674001693725586
Epoch: 14, Steps: 369 | Train Loss: 0.570 Vali Loss: 1.021 Vali Acc: 0.648 Test Loss: 1.021 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2788830
	speed: 0.4030s/iter; left time: 12748.6893s
	iters: 200, epoch: 15 | loss: 0.4017455
	speed: 0.1010s/iter; left time: 3185.6036s
	iters: 300, epoch: 15 | loss: 0.4325093
	speed: 0.0853s/iter; left time: 2681.2435s
Epoch: 15 cost time: 36.139050006866455
Epoch: 15, Steps: 369 | Train Loss: 0.334 Vali Loss: 1.075 Vali Acc: 0.652 Test Loss: 1.075 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3396543
	speed: 0.4011s/iter; left time: 12540.8247s
	iters: 200, epoch: 16 | loss: 0.1519057
	speed: 0.0879s/iter; left time: 2739.5866s
	iters: 300, epoch: 16 | loss: 0.4542336
	speed: 0.0933s/iter; left time: 2897.7793s
Epoch: 16 cost time: 38.22326612472534
Epoch: 16, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.137 Vali Acc: 0.666 Test Loss: 1.137 Test Acc: 0.666
Validation loss decreased (-0.662842 --> -0.665709).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2924505
	speed: 0.4190s/iter; left time: 12945.1934s
	iters: 200, epoch: 17 | loss: 0.0835305
	speed: 0.1056s/iter; left time: 3252.1116s
	iters: 300, epoch: 17 | loss: 0.0921843
	speed: 0.1131s/iter; left time: 3472.8050s
Epoch: 17 cost time: 40.29707312583923
Epoch: 17, Steps: 369 | Train Loss: 0.258 Vali Loss: 1.146 Vali Acc: 0.648 Test Loss: 1.146 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1677855
	speed: 0.4032s/iter; left time: 12309.4977s
	iters: 200, epoch: 18 | loss: 0.2007670
	speed: 0.1056s/iter; left time: 3212.6755s
	iters: 300, epoch: 18 | loss: 0.1254985
	speed: 0.0916s/iter; left time: 2777.0084s
Epoch: 18 cost time: 38.1254608631134
Epoch: 18, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.286 Vali Acc: 0.652 Test Loss: 1.286 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0746417
	speed: 0.4037s/iter; left time: 12175.3626s
	iters: 200, epoch: 19 | loss: 0.1551662
	speed: 0.0897s/iter; left time: 2695.2036s
	iters: 300, epoch: 19 | loss: 0.0611314
	speed: 0.1039s/iter; left time: 3112.5603s
Epoch: 19 cost time: 37.62934684753418
Epoch: 19, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.325 Vali Acc: 0.649 Test Loss: 1.325 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0448812
	speed: 0.4033s/iter; left time: 12015.1282s
	iters: 200, epoch: 20 | loss: 0.0225462
	speed: 0.1126s/iter; left time: 3343.0760s
	iters: 300, epoch: 20 | loss: 0.0411262
	speed: 0.1052s/iter; left time: 3113.1378s
Epoch: 20 cost time: 39.858285903930664
Epoch: 20, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.342 Vali Acc: 0.640 Test Loss: 1.342 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1289065
	speed: 0.3672s/iter; left time: 10804.1105s
	iters: 200, epoch: 21 | loss: 0.0594282
	speed: 0.0918s/iter; left time: 2690.4892s
	iters: 300, epoch: 21 | loss: 0.5413494
	speed: 0.1115s/iter; left time: 3258.6677s
Epoch: 21 cost time: 36.92620277404785
Epoch: 21, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.328 Vali Acc: 0.642 Test Loss: 1.328 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2570894
	speed: 0.3864s/iter; left time: 11224.3629s
	iters: 200, epoch: 22 | loss: 0.4307653
	speed: 0.1019s/iter; left time: 2951.3262s
	iters: 300, epoch: 22 | loss: 0.5881882
	speed: 0.0961s/iter; left time: 2773.8626s
Epoch: 22 cost time: 35.49517273902893
Epoch: 22, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.501 Vali Acc: 0.641 Test Loss: 1.501 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0739576
	speed: 0.3959s/iter; left time: 11356.8050s
	iters: 200, epoch: 23 | loss: 0.0167351
	speed: 0.0926s/iter; left time: 2647.8605s
	iters: 300, epoch: 23 | loss: 0.5252236
	speed: 0.0924s/iter; left time: 2632.8857s
Epoch: 23 cost time: 37.376497745513916
Epoch: 23, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.470 Vali Acc: 0.627 Test Loss: 1.470 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4698938
	speed: 0.4065s/iter; left time: 11509.6747s
	iters: 200, epoch: 24 | loss: 0.1691073
	speed: 0.0975s/iter; left time: 2752.2398s
	iters: 300, epoch: 24 | loss: 0.0450483
	speed: 0.1021s/iter; left time: 2871.5024s
Epoch: 24 cost time: 39.42691445350647
Epoch: 24, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.811 Vali Acc: 0.633 Test Loss: 1.811 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0530878
	speed: 0.3990s/iter; left time: 11148.7398s
	iters: 200, epoch: 25 | loss: 0.0716266
	speed: 0.0873s/iter; left time: 2431.0355s
	iters: 300, epoch: 25 | loss: 0.0675926
	speed: 0.1010s/iter; left time: 2802.2834s
Epoch: 25 cost time: 36.60433006286621
Epoch: 25, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.748 Vali Acc: 0.638 Test Loss: 1.748 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1123077
	speed: 0.3826s/iter; left time: 10549.9514s
	iters: 200, epoch: 26 | loss: 0.0728443
	speed: 0.0904s/iter; left time: 2484.7970s
	iters: 300, epoch: 26 | loss: 0.0576492
	speed: 0.1119s/iter; left time: 3063.5918s
Epoch: 26 cost time: 36.56989526748657
Epoch: 26, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.786 Vali Acc: 0.644 Test Loss: 1.786 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6657207718501703
model parameter : 708866
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8396205
	speed: 0.1153s/iter; left time: 4243.0023s
	iters: 200, epoch: 1 | loss: 1.1481167
	speed: 0.0755s/iter; left time: 2769.9318s
	iters: 300, epoch: 1 | loss: 1.8467282
	speed: 0.0932s/iter; left time: 3411.0767s
Epoch: 1 cost time: 34.409034967422485
Epoch: 1, Steps: 369 | Train Loss: 1.319 Vali Loss: 1.143 Vali Acc: 0.623 Test Loss: 1.143 Test Acc: 0.623
Validation loss decreased (inf --> -0.622860).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2754352
	speed: 0.3438s/iter; left time: 12523.8461s
	iters: 200, epoch: 2 | loss: 0.2368756
	speed: 0.0808s/iter; left time: 2934.0167s
	iters: 300, epoch: 2 | loss: 1.3145396
	speed: 0.0955s/iter; left time: 3459.0377s
Epoch: 2 cost time: 33.334068298339844
Epoch: 2, Steps: 369 | Train Loss: 1.945 Vali Loss: 2.502 Vali Acc: 0.564 Test Loss: 2.502 Test Acc: 0.564
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8134042
	speed: 0.3555s/iter; left time: 12822.0514s
	iters: 200, epoch: 3 | loss: 3.2693391
	speed: 0.0821s/iter; left time: 2952.5789s
	iters: 300, epoch: 3 | loss: 3.3048139
	speed: 0.0817s/iter; left time: 2928.2833s
Epoch: 3 cost time: 31.32853889465332
Epoch: 3, Steps: 369 | Train Loss: 2.540 Vali Loss: 2.181 Vali Acc: 0.648 Test Loss: 2.181 Test Acc: 0.648
Validation loss decreased (-0.622860 --> -0.648389).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9567859
	speed: 0.3005s/iter; left time: 10724.3664s
	iters: 200, epoch: 4 | loss: 5.0119786
	speed: 0.0748s/iter; left time: 2661.8575s
	iters: 300, epoch: 4 | loss: 3.0320828
	speed: 0.0843s/iter; left time: 2992.0478s
Epoch: 4 cost time: 30.106603860855103
Epoch: 4, Steps: 369 | Train Loss: 3.141 Vali Loss: 4.927 Vali Acc: 0.635 Test Loss: 4.927 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5412641
	speed: 0.3480s/iter; left time: 12291.9956s
	iters: 200, epoch: 5 | loss: 2.2718258
	speed: 0.0712s/iter; left time: 2508.9212s
	iters: 300, epoch: 5 | loss: 5.9668512
	speed: 0.0737s/iter; left time: 2587.2602s
Epoch: 5 cost time: 29.65355896949768
Epoch: 5, Steps: 369 | Train Loss: 3.443 Vali Loss: 4.109 Vali Acc: 0.633 Test Loss: 4.109 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.0079763
	speed: 0.3576s/iter; left time: 12500.6481s
	iters: 200, epoch: 6 | loss: 5.0563536
	speed: 0.0896s/iter; left time: 3122.9833s
	iters: 300, epoch: 6 | loss: 5.6372218
	speed: 0.0789s/iter; left time: 2742.6917s
Epoch: 6 cost time: 33.16856908798218
Epoch: 6, Steps: 369 | Train Loss: 3.376 Vali Loss: 3.574 Vali Acc: 0.663 Test Loss: 3.574 Test Acc: 0.663
Validation loss decreased (-0.648389 --> -0.663415).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9808042
	speed: 0.2820s/iter; left time: 9753.4073s
	iters: 200, epoch: 7 | loss: 4.4667959
	speed: 0.0779s/iter; left time: 2686.1313s
	iters: 300, epoch: 7 | loss: 4.0021605
	speed: 0.0792s/iter; left time: 2724.9122s
Epoch: 7 cost time: 29.87942147254944
Epoch: 7, Steps: 369 | Train Loss: 3.481 Vali Loss: 8.051 Vali Acc: 0.629 Test Loss: 8.051 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1016570
	speed: 0.2885s/iter; left time: 9872.0756s
	iters: 200, epoch: 8 | loss: 2.3295708
	speed: 0.0798s/iter; left time: 2723.4494s
	iters: 300, epoch: 8 | loss: 4.2415681
	speed: 0.0810s/iter; left time: 2753.9968s
Epoch: 8 cost time: 31.207437753677368
Epoch: 8, Steps: 369 | Train Loss: 3.240 Vali Loss: 5.817 Vali Acc: 0.636 Test Loss: 5.817 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.6668379
	speed: 0.2829s/iter; left time: 9574.3856s
	iters: 200, epoch: 9 | loss: 2.5861783
	speed: 0.0763s/iter; left time: 2574.4919s
	iters: 300, epoch: 9 | loss: 1.0361929
	speed: 0.0760s/iter; left time: 2557.6152s
Epoch: 9 cost time: 28.897052526474
Epoch: 9, Steps: 369 | Train Loss: 3.228 Vali Loss: 5.369 Vali Acc: 0.609 Test Loss: 5.369 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.0217731
	speed: 0.2730s/iter; left time: 9139.6348s
	iters: 200, epoch: 10 | loss: 0.4209626
	speed: 0.0750s/iter; left time: 2503.5820s
	iters: 300, epoch: 10 | loss: 1.6528031
	speed: 0.0735s/iter; left time: 2447.1359s
Epoch: 10 cost time: 28.5457546710968
Epoch: 10, Steps: 369 | Train Loss: 2.779 Vali Loss: 4.048 Vali Acc: 0.620 Test Loss: 4.048 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7377136
	speed: 0.2785s/iter; left time: 9219.9357s
	iters: 200, epoch: 11 | loss: 1.0332351
	speed: 0.0754s/iter; left time: 2488.7309s
	iters: 300, epoch: 11 | loss: 4.8128271
	speed: 0.0757s/iter; left time: 2490.1544s
Epoch: 11 cost time: 28.583502769470215
Epoch: 11, Steps: 369 | Train Loss: 2.316 Vali Loss: 3.267 Vali Acc: 0.654 Test Loss: 3.267 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.5527885
	speed: 0.2795s/iter; left time: 9152.1964s
	iters: 200, epoch: 12 | loss: 1.6036260
	speed: 0.0706s/iter; left time: 2303.6003s
	iters: 300, epoch: 12 | loss: 0.7100984
	speed: 0.0716s/iter; left time: 2330.1065s
Epoch: 12 cost time: 27.450700283050537
Epoch: 12, Steps: 369 | Train Loss: 1.919 Vali Loss: 2.129 Vali Acc: 0.642 Test Loss: 2.129 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6316831
	speed: 0.2735s/iter; left time: 8852.3997s
	iters: 200, epoch: 13 | loss: 1.8510352
	speed: 0.0743s/iter; left time: 2396.6565s
	iters: 300, epoch: 13 | loss: 1.3687384
	speed: 0.0745s/iter; left time: 2397.4924s
Epoch: 13 cost time: 28.516847848892212
Epoch: 13, Steps: 369 | Train Loss: 1.142 Vali Loss: 1.516 Vali Acc: 0.650 Test Loss: 1.516 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3547232
	speed: 0.2716s/iter; left time: 8691.7628s
	iters: 200, epoch: 14 | loss: 0.2168999
	speed: 0.0732s/iter; left time: 2336.1253s
	iters: 300, epoch: 14 | loss: 0.5062744
	speed: 0.0777s/iter; left time: 2472.2776s
Epoch: 14 cost time: 28.930448293685913
Epoch: 14, Steps: 369 | Train Loss: 0.609 Vali Loss: 1.004 Vali Acc: 0.648 Test Loss: 1.004 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3344587
	speed: 0.2910s/iter; left time: 9206.3104s
	iters: 200, epoch: 15 | loss: 0.5558061
	speed: 0.0718s/iter; left time: 2265.1510s
	iters: 300, epoch: 15 | loss: 0.3354904
	speed: 0.0725s/iter; left time: 2278.5234s
Epoch: 15 cost time: 27.935720443725586
Epoch: 15, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.945 Vali Acc: 0.656 Test Loss: 0.945 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1472824
	speed: 0.2902s/iter; left time: 9074.8013s
	iters: 200, epoch: 16 | loss: 0.2825394
	speed: 0.0740s/iter; left time: 2307.4535s
	iters: 300, epoch: 16 | loss: 0.2232035
	speed: 0.0750s/iter; left time: 2328.6792s
Epoch: 16 cost time: 28.773767948150635
Epoch: 16, Steps: 369 | Train Loss: 0.281 Vali Loss: 1.103 Vali Acc: 0.638 Test Loss: 1.103 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6634506242905789
model parameter : 598658
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7418959
	speed: 0.0802s/iter; left time: 2949.8041s
	iters: 200, epoch: 1 | loss: 0.6981727
	speed: 0.0594s/iter; left time: 2179.7761s
	iters: 300, epoch: 1 | loss: 1.3838824
	speed: 0.0577s/iter; left time: 2112.3000s
Epoch: 1 cost time: 23.75415062904358
Epoch: 1, Steps: 369 | Train Loss: 1.211 Vali Loss: 0.895 Vali Acc: 0.648 Test Loss: 0.895 Test Acc: 0.648
Validation loss decreased (inf --> -0.647834).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7300390
	speed: 0.2441s/iter; left time: 8891.8856s
	iters: 200, epoch: 2 | loss: 1.8998598
	speed: 0.0625s/iter; left time: 2269.3029s
	iters: 300, epoch: 2 | loss: 1.6023395
	speed: 0.0624s/iter; left time: 2259.6836s
Epoch: 2 cost time: 23.855385065078735
Epoch: 2, Steps: 369 | Train Loss: 1.715 Vali Loss: 1.508 Vali Acc: 0.669 Test Loss: 1.508 Test Acc: 0.669
Validation loss decreased (-0.647834 --> -0.669111).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6340342
	speed: 0.2453s/iter; left time: 8846.2649s
	iters: 200, epoch: 3 | loss: 2.2010167
	speed: 0.0644s/iter; left time: 2317.3929s
	iters: 300, epoch: 3 | loss: 1.6894314
	speed: 0.0633s/iter; left time: 2269.8046s
Epoch: 3 cost time: 24.31502413749695
Epoch: 3, Steps: 369 | Train Loss: 2.170 Vali Loss: 3.990 Vali Acc: 0.610 Test Loss: 3.990 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5135679
	speed: 0.2465s/iter; left time: 8797.5134s
	iters: 200, epoch: 4 | loss: 1.9510149
	speed: 0.0629s/iter; left time: 2237.4460s
	iters: 300, epoch: 4 | loss: 4.3943863
	speed: 0.0625s/iter; left time: 2219.3936s
Epoch: 4 cost time: 23.67975878715515
Epoch: 4, Steps: 369 | Train Loss: 2.723 Vali Loss: 3.688 Vali Acc: 0.667 Test Loss: 3.688 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.1996150
	speed: 0.2437s/iter; left time: 8607.5291s
	iters: 200, epoch: 5 | loss: 0.2069083
	speed: 0.0624s/iter; left time: 2198.4978s
	iters: 300, epoch: 5 | loss: 3.4335012
	speed: 0.0618s/iter; left time: 2171.3736s
Epoch: 5 cost time: 23.318557739257812
Epoch: 5, Steps: 369 | Train Loss: 2.898 Vali Loss: 3.414 Vali Acc: 0.653 Test Loss: 3.414 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.7059743
	speed: 0.2428s/iter; left time: 8485.5840s
	iters: 200, epoch: 6 | loss: 4.8137083
	speed: 0.0661s/iter; left time: 2305.1981s
	iters: 300, epoch: 6 | loss: 5.3279014
	speed: 0.0660s/iter; left time: 2292.8671s
Epoch: 6 cost time: 25.06682300567627
Epoch: 6, Steps: 369 | Train Loss: 3.007 Vali Loss: 3.982 Vali Acc: 0.647 Test Loss: 3.982 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 6.4574947
	speed: 0.2431s/iter; left time: 8409.2361s
	iters: 200, epoch: 7 | loss: 3.4210548
	speed: 0.0665s/iter; left time: 2294.6165s
	iters: 300, epoch: 7 | loss: 4.7533741
	speed: 0.0664s/iter; left time: 2283.8143s
Epoch: 7 cost time: 25.475126266479492
Epoch: 7, Steps: 369 | Train Loss: 2.824 Vali Loss: 5.961 Vali Acc: 0.608 Test Loss: 5.961 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.8018110
	speed: 0.2372s/iter; left time: 8115.5024s
	iters: 200, epoch: 8 | loss: 0.0017960
	speed: 0.0656s/iter; left time: 2237.5587s
	iters: 300, epoch: 8 | loss: 8.2737074
	speed: 0.0620s/iter; left time: 2110.3646s
Epoch: 8 cost time: 24.690483331680298
Epoch: 8, Steps: 369 | Train Loss: 2.761 Vali Loss: 4.155 Vali Acc: 0.660 Test Loss: 4.155 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.5605810
	speed: 0.2518s/iter; left time: 8522.3133s
	iters: 200, epoch: 9 | loss: 3.3902924
	speed: 0.0621s/iter; left time: 2095.5100s
	iters: 300, epoch: 9 | loss: 2.1607325
	speed: 0.0628s/iter; left time: 2114.1858s
Epoch: 9 cost time: 23.699472904205322
Epoch: 9, Steps: 369 | Train Loss: 2.496 Vali Loss: 4.792 Vali Acc: 0.646 Test Loss: 4.792 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.7149980
	speed: 0.2473s/iter; left time: 8280.7949s
	iters: 200, epoch: 10 | loss: 0.8654676
	speed: 0.0659s/iter; left time: 2198.7491s
	iters: 300, epoch: 10 | loss: 0.2298730
	speed: 0.0664s/iter; left time: 2208.6391s
Epoch: 10 cost time: 25.069901704788208
Epoch: 10, Steps: 369 | Train Loss: 2.125 Vali Loss: 4.629 Vali Acc: 0.639 Test Loss: 4.629 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.5638421
	speed: 0.2605s/iter; left time: 8624.6344s
	iters: 200, epoch: 11 | loss: 2.0433114
	speed: 0.0672s/iter; left time: 2217.7467s
	iters: 300, epoch: 11 | loss: 0.9963157
	speed: 0.0657s/iter; left time: 2161.0571s
Epoch: 11 cost time: 25.064685344696045
Epoch: 11, Steps: 369 | Train Loss: 1.927 Vali Loss: 3.052 Vali Acc: 0.618 Test Loss: 3.052 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.8358921
	speed: 0.2502s/iter; left time: 8193.2266s
	iters: 200, epoch: 12 | loss: 0.8330333
	speed: 0.0653s/iter; left time: 2130.9055s
	iters: 300, epoch: 12 | loss: 4.3814001
	speed: 0.0646s/iter; left time: 2102.9083s
Epoch: 12 cost time: 24.204882860183716
Epoch: 12, Steps: 369 | Train Loss: 1.428 Vali Loss: 3.486 Vali Acc: 0.631 Test Loss: 3.486 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6691259931895573
model parameter : 525314
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0301909
	speed: 0.4179s/iter; left time: 15378.6834s
	iters: 200, epoch: 1 | loss: 0.7794884
	speed: 0.3971s/iter; left time: 14574.7370s
	iters: 300, epoch: 1 | loss: 4.4694676
	speed: 0.3914s/iter; left time: 14324.0242s
Epoch: 1 cost time: 147.58302187919617
Epoch: 1, Steps: 369 | Train Loss: 3.703 Vali Loss: 3.737 Vali Acc: 0.580 Test Loss: 3.737 Test Acc: 0.580
Validation loss decreased (inf --> -0.580269).  Saving model ...
	iters: 100, epoch: 2 | loss: 7.7042522
	speed: 1.2556s/iter; left time: 45743.2248s
	iters: 200, epoch: 2 | loss: 2.8590171
	speed: 0.3771s/iter; left time: 13699.1886s
	iters: 300, epoch: 2 | loss: 2.8854418
	speed: 0.3703s/iter; left time: 13418.3433s
Epoch: 2 cost time: 139.11793971061707
Epoch: 2, Steps: 369 | Train Loss: 5.196 Vali Loss: 4.484 Vali Acc: 0.640 Test Loss: 4.484 Test Acc: 0.640
Validation loss decreased (-0.580269 --> -0.640137).  Saving model ...
	iters: 100, epoch: 3 | loss: 8.7859812
	speed: 1.2298s/iter; left time: 44350.5919s
	iters: 200, epoch: 3 | loss: 14.0484753
	speed: 0.3805s/iter; left time: 13683.8365s
	iters: 300, epoch: 3 | loss: 4.6561012
	speed: 0.3752s/iter; left time: 13455.4695s
Epoch: 3 cost time: 140.65346360206604
Epoch: 3, Steps: 369 | Train Loss: 7.398 Vali Loss: 7.656 Vali Acc: 0.639 Test Loss: 7.656 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3243256
	speed: 1.2299s/iter; left time: 43899.1658s
	iters: 200, epoch: 4 | loss: 9.7880211
	speed: 0.3597s/iter; left time: 12804.3413s
	iters: 300, epoch: 4 | loss: 7.8677716
	speed: 0.3538s/iter; left time: 12558.6839s
Epoch: 4 cost time: 135.2885434627533
Epoch: 4, Steps: 369 | Train Loss: 8.655 Vali Loss: 9.361 Vali Acc: 0.650 Test Loss: 9.361 Test Acc: 0.650
Validation loss decreased (-0.640137 --> -0.649736).  Saving model ...
	iters: 100, epoch: 5 | loss: 14.1475744
	speed: 1.1885s/iter; left time: 41985.5095s
	iters: 200, epoch: 5 | loss: 3.4119763
	speed: 0.3827s/iter; left time: 13478.9313s
	iters: 300, epoch: 5 | loss: 18.7236137
	speed: 0.3803s/iter; left time: 13357.0444s
Epoch: 5 cost time: 139.5418939590454
Epoch: 5, Steps: 369 | Train Loss: 8.813 Vali Loss: 18.450 Vali Acc: 0.651 Test Loss: 18.450 Test Acc: 0.651
Validation loss decreased (-0.649736 --> -0.650780).  Saving model ...
	iters: 100, epoch: 6 | loss: 12.6834621
	speed: 1.1973s/iter; left time: 41854.3585s
	iters: 200, epoch: 6 | loss: 17.6787834
	speed: 0.3768s/iter; left time: 13132.4221s
	iters: 300, epoch: 6 | loss: 15.6557760
	speed: 0.3704s/iter; left time: 12873.4842s
Epoch: 6 cost time: 136.87717294692993
Epoch: 6, Steps: 369 | Train Loss: 9.567 Vali Loss: 16.553 Vali Acc: 0.647 Test Loss: 16.553 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 9.5421267
	speed: 1.1864s/iter; left time: 41033.6618s
	iters: 200, epoch: 7 | loss: 7.4457788
	speed: 0.3672s/iter; left time: 12662.2090s
	iters: 300, epoch: 7 | loss: 2.4908814
	speed: 0.3578s/iter; left time: 12302.7757s
Epoch: 7 cost time: 133.80689573287964
Epoch: 7, Steps: 369 | Train Loss: 7.928 Vali Loss: 15.745 Vali Acc: 0.641 Test Loss: 15.745 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 10.8221464
	speed: 1.2022s/iter; left time: 41135.2082s
	iters: 200, epoch: 8 | loss: 3.3269401
	speed: 0.3818s/iter; left time: 13025.6197s
	iters: 300, epoch: 8 | loss: 10.7380190
	speed: 0.3761s/iter; left time: 12795.7362s
Epoch: 8 cost time: 139.21659207344055
Epoch: 8, Steps: 369 | Train Loss: 7.087 Vali Loss: 15.295 Vali Acc: 0.650 Test Loss: 15.295 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0003834
	speed: 1.2059s/iter; left time: 40818.9613s
	iters: 200, epoch: 9 | loss: 2.8701389
	speed: 0.3749s/iter; left time: 12652.9052s
	iters: 300, epoch: 9 | loss: 5.3285866
	speed: 0.3735s/iter; left time: 12568.4561s
Epoch: 9 cost time: 138.401850938797
Epoch: 9, Steps: 369 | Train Loss: 5.385 Vali Loss: 20.031 Vali Acc: 0.644 Test Loss: 20.031 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 1.2112s/iter; left time: 40550.9293s
	iters: 200, epoch: 10 | loss: 3.6327007
	speed: 0.3761s/iter; left time: 12553.9376s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.3581s/iter; left time: 11917.5677s
Epoch: 10 cost time: 136.78378987312317
Epoch: 10, Steps: 369 | Train Loss: 4.405 Vali Loss: 22.930 Vali Acc: 0.642 Test Loss: 22.930 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 13.9006786
	speed: 1.1893s/iter; left time: 39377.9865s
	iters: 200, epoch: 11 | loss: 4.4213700
	speed: 0.3756s/iter; left time: 12397.8782s
	iters: 300, epoch: 11 | loss: 3.1146908
	speed: 0.3748s/iter; left time: 12334.8926s
Epoch: 11 cost time: 138.6028380393982
Epoch: 11, Steps: 369 | Train Loss: 4.016 Vali Loss: 18.543 Vali Acc: 0.640 Test Loss: 18.543 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0901497
	speed: 1.2105s/iter; left time: 39633.2933s
	iters: 200, epoch: 12 | loss: 3.1607008
	speed: 0.3872s/iter; left time: 12640.4749s
	iters: 300, epoch: 12 | loss: 15.7358074
	speed: 0.3779s/iter; left time: 12296.8400s
Epoch: 12 cost time: 140.92170810699463
Epoch: 12, Steps: 369 | Train Loss: 3.142 Vali Loss: 20.032 Vali Acc: 0.636 Test Loss: 20.032 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7222548
	speed: 1.1953s/iter; left time: 38693.9347s
	iters: 200, epoch: 13 | loss: 0.1313557
	speed: 0.3800s/iter; left time: 12263.0272s
	iters: 300, epoch: 13 | loss: 0.3452961
	speed: 0.3799s/iter; left time: 12221.4897s
Epoch: 13 cost time: 140.0963270664215
Epoch: 13, Steps: 369 | Train Loss: 2.621 Vali Loss: 27.282 Vali Acc: 0.640 Test Loss: 27.282 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.8953283
	speed: 1.2183s/iter; left time: 38988.9388s
	iters: 200, epoch: 14 | loss: 0.1751143
	speed: 0.3911s/iter; left time: 12478.6081s
	iters: 300, epoch: 14 | loss: 5.7575064
	speed: 0.3877s/iter; left time: 12331.0318s
Epoch: 14 cost time: 141.98663091659546
Epoch: 14, Steps: 369 | Train Loss: 1.918 Vali Loss: 16.615 Vali Acc: 0.644 Test Loss: 16.615 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.7779152
	speed: 1.1932s/iter; left time: 37746.6243s
	iters: 200, epoch: 15 | loss: 1.5123118
	speed: 0.3834s/iter; left time: 12091.6913s
	iters: 300, epoch: 15 | loss: 4.9907918
	speed: 0.3860s/iter; left time: 12132.4033s
Epoch: 15 cost time: 140.5266420841217
Epoch: 15, Steps: 369 | Train Loss: 1.520 Vali Loss: 22.104 Vali Acc: 0.640 Test Loss: 22.104 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6509648127128264
model parameter : 2485250
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 7.5039487
	speed: 0.1926s/iter; left time: 7086.1165s
	iters: 200, epoch: 1 | loss: 2.1068010
	speed: 0.1779s/iter; left time: 6528.8206s
	iters: 300, epoch: 1 | loss: 2.4250331
	speed: 0.1814s/iter; left time: 6637.7836s
Epoch: 1 cost time: 68.04727625846863
Epoch: 1, Steps: 369 | Train Loss: 2.353 Vali Loss: 2.186 Vali Acc: 0.651 Test Loss: 2.186 Test Acc: 0.651
Validation loss decreased (inf --> -0.650943).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3687620
	speed: 0.6580s/iter; left time: 23973.7793s
	iters: 200, epoch: 2 | loss: 0.8866899
	speed: 0.1700s/iter; left time: 6175.0550s
	iters: 300, epoch: 2 | loss: 7.2437000
	speed: 0.1639s/iter; left time: 5937.5066s
Epoch: 2 cost time: 62.85599493980408
Epoch: 2, Steps: 369 | Train Loss: 3.803 Vali Loss: 4.450 Vali Acc: 0.623 Test Loss: 4.450 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.7945366
	speed: 0.6365s/iter; left time: 22953.1538s
	iters: 200, epoch: 3 | loss: 9.9555502
	speed: 0.1799s/iter; left time: 6469.2643s
	iters: 300, epoch: 3 | loss: 3.1834290
	speed: 0.1772s/iter; left time: 6353.4320s
Epoch: 3 cost time: 67.19353342056274
Epoch: 3, Steps: 369 | Train Loss: 5.394 Vali Loss: 4.087 Vali Acc: 0.629 Test Loss: 4.087 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.6285043
	speed: 0.6299s/iter; left time: 22482.1624s
	iters: 200, epoch: 4 | loss: 2.7983687
	speed: 0.1739s/iter; left time: 6191.3755s
	iters: 300, epoch: 4 | loss: 2.4139588
	speed: 0.1714s/iter; left time: 6082.1770s
Epoch: 4 cost time: 65.00035405158997
Epoch: 4, Steps: 369 | Train Loss: 5.875 Vali Loss: 16.709 Vali Acc: 0.606 Test Loss: 16.709 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 11.4103727
	speed: 0.6081s/iter; left time: 21480.3082s
	iters: 200, epoch: 5 | loss: 4.7370472
	speed: 0.1740s/iter; left time: 6127.7421s
	iters: 300, epoch: 5 | loss: 0.1180361
	speed: 0.1683s/iter; left time: 5912.4036s
Epoch: 5 cost time: 64.02965235710144
Epoch: 5, Steps: 369 | Train Loss: 6.681 Vali Loss: 8.976 Vali Acc: 0.635 Test Loss: 8.976 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9821007
	speed: 0.6071s/iter; left time: 21221.1418s
	iters: 200, epoch: 6 | loss: 2.5737689
	speed: 0.1642s/iter; left time: 5723.0571s
	iters: 300, epoch: 6 | loss: 10.1535578
	speed: 0.1696s/iter; left time: 5896.3480s
Epoch: 6 cost time: 62.44246530532837
Epoch: 6, Steps: 369 | Train Loss: 6.618 Vali Loss: 7.782 Vali Acc: 0.604 Test Loss: 7.782 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.4486394
	speed: 0.6092s/iter; left time: 21072.0361s
	iters: 200, epoch: 7 | loss: 4.9131494
	speed: 0.1700s/iter; left time: 5864.2329s
	iters: 300, epoch: 7 | loss: 6.7112098
	speed: 0.1717s/iter; left time: 5903.2060s
Epoch: 7 cost time: 64.32738733291626
Epoch: 7, Steps: 369 | Train Loss: 7.053 Vali Loss: 8.626 Vali Acc: 0.613 Test Loss: 8.626 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 9.9917755
	speed: 0.6338s/iter; left time: 21687.4236s
	iters: 200, epoch: 8 | loss: 3.8341939
	speed: 0.1456s/iter; left time: 4967.0291s
	iters: 300, epoch: 8 | loss: 7.9932041
	speed: 0.2003s/iter; left time: 6814.6575s
Epoch: 8 cost time: 62.26886749267578
Epoch: 8, Steps: 369 | Train Loss: 6.532 Vali Loss: 8.324 Vali Acc: 0.646 Test Loss: 8.324 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 4.2572660
	speed: 0.6915s/iter; left time: 23408.2293s
	iters: 200, epoch: 9 | loss: 7.5951347
	speed: 0.2335s/iter; left time: 7881.5449s
	iters: 300, epoch: 9 | loss: 3.5604732
	speed: 0.2350s/iter; left time: 7906.9050s
Epoch: 9 cost time: 87.40709114074707
Epoch: 9, Steps: 369 | Train Loss: 5.560 Vali Loss: 10.413 Vali Acc: 0.645 Test Loss: 10.413 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 6.0830817
	speed: 0.8804s/iter; left time: 29475.7980s
	iters: 200, epoch: 10 | loss: 7.4024324
	speed: 0.2395s/iter; left time: 7993.8644s
	iters: 300, epoch: 10 | loss: 5.0112858
	speed: 0.2381s/iter; left time: 7924.0011s
Epoch: 10 cost time: 89.13975811004639
Epoch: 10, Steps: 369 | Train Loss: 4.539 Vali Loss: 8.959 Vali Acc: 0.643 Test Loss: 8.959 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.6040246
	speed: 0.8432s/iter; left time: 27918.8309s
	iters: 200, epoch: 11 | loss: 0.8639674
	speed: 0.2169s/iter; left time: 7161.1997s
	iters: 300, epoch: 11 | loss: 0.8265941
	speed: 0.2177s/iter; left time: 7164.6603s
Epoch: 11 cost time: 81.34590315818787
Epoch: 11, Steps: 369 | Train Loss: 4.273 Vali Loss: 11.270 Vali Acc: 0.635 Test Loss: 11.270 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6509648127128264
model parameter : 1342722
model size : 7.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.9491558
	speed: 0.1826s/iter; left time: 6719.4929s
	iters: 200, epoch: 1 | loss: 1.2936891
	speed: 0.1653s/iter; left time: 6068.3812s
	iters: 300, epoch: 1 | loss: 2.0332961
	speed: 0.1664s/iter; left time: 6091.0915s
Epoch: 1 cost time: 62.46860694885254
Epoch: 1, Steps: 369 | Train Loss: 1.997 Vali Loss: 1.432 Vali Acc: 0.660 Test Loss: 1.432 Test Acc: 0.660
Validation loss decreased (inf --> -0.660315).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9602354
	speed: 0.5668s/iter; left time: 20651.3811s
	iters: 200, epoch: 2 | loss: 2.3479648
	speed: 0.1528s/iter; left time: 5551.5538s
	iters: 300, epoch: 2 | loss: 6.8618922
	speed: 0.1505s/iter; left time: 5451.3828s
Epoch: 2 cost time: 56.540143966674805
Epoch: 2, Steps: 369 | Train Loss: 2.972 Vali Loss: 2.609 Vali Acc: 0.615 Test Loss: 2.609 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0177610
	speed: 0.5603s/iter; left time: 20207.1763s
	iters: 200, epoch: 3 | loss: 6.3973656
	speed: 0.1659s/iter; left time: 5964.7335s
	iters: 300, epoch: 3 | loss: 3.9798729
	speed: 0.1581s/iter; left time: 5668.3641s
Epoch: 3 cost time: 59.87912058830261
Epoch: 3, Steps: 369 | Train Loss: 4.090 Vali Loss: 4.443 Vali Acc: 0.663 Test Loss: 4.443 Test Acc: 0.663
Validation loss decreased (-0.660315 --> -0.663406).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1794243
	speed: 0.5975s/iter; left time: 21325.4797s
	iters: 200, epoch: 4 | loss: 5.6901584
	speed: 0.1669s/iter; left time: 5939.2949s
	iters: 300, epoch: 4 | loss: 5.1846423
	speed: 0.1641s/iter; left time: 5823.3136s
Epoch: 4 cost time: 61.913914918899536
Epoch: 4, Steps: 369 | Train Loss: 4.837 Vali Loss: 8.107 Vali Acc: 0.657 Test Loss: 8.107 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.7699471
	speed: 0.6088s/iter; left time: 21505.3657s
	iters: 200, epoch: 5 | loss: 7.2861958
	speed: 0.1676s/iter; left time: 5902.6475s
	iters: 300, epoch: 5 | loss: 4.7385302
	speed: 0.1703s/iter; left time: 5981.1492s
Epoch: 5 cost time: 63.044156312942505
Epoch: 5, Steps: 369 | Train Loss: 5.431 Vali Loss: 8.578 Vali Acc: 0.653 Test Loss: 8.578 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2361622
	speed: 0.5825s/iter; left time: 20361.9475s
	iters: 200, epoch: 6 | loss: 5.3647299
	speed: 0.1505s/iter; left time: 5246.5979s
	iters: 300, epoch: 6 | loss: 11.7751894
	speed: 0.1502s/iter; left time: 5221.7932s
Epoch: 6 cost time: 57.38046073913574
Epoch: 6, Steps: 369 | Train Loss: 5.319 Vali Loss: 8.554 Vali Acc: 0.652 Test Loss: 8.554 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.7303634
	speed: 0.5669s/iter; left time: 19608.3968s
	iters: 200, epoch: 7 | loss: 7.6177535
	speed: 0.1529s/iter; left time: 5273.9316s
	iters: 300, epoch: 7 | loss: 8.0764370
	speed: 0.1506s/iter; left time: 5177.7721s
Epoch: 7 cost time: 58.05303931236267
Epoch: 7, Steps: 369 | Train Loss: 5.264 Vali Loss: 5.914 Vali Acc: 0.652 Test Loss: 5.914 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.5683079
	speed: 0.6079s/iter; left time: 20800.3639s
	iters: 200, epoch: 8 | loss: 4.3166757
	speed: 0.1701s/iter; left time: 5803.2457s
	iters: 300, epoch: 8 | loss: 12.3929482
	speed: 0.1705s/iter; left time: 5798.3770s
Epoch: 8 cost time: 63.624229431152344
Epoch: 8, Steps: 369 | Train Loss: 4.869 Vali Loss: 6.814 Vali Acc: 0.633 Test Loss: 6.814 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 10.4183073
	speed: 0.6132s/iter; left time: 20755.3317s
	iters: 200, epoch: 9 | loss: 10.2798042
	speed: 0.1684s/iter; left time: 5682.1830s
	iters: 300, epoch: 9 | loss: 11.3066120
	speed: 0.1677s/iter; left time: 5642.0539s
Epoch: 9 cost time: 62.61812734603882
Epoch: 9, Steps: 369 | Train Loss: 4.353 Vali Loss: 10.911 Vali Acc: 0.618 Test Loss: 10.911 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.8025347
	speed: 0.5860s/iter; left time: 19618.7005s
	iters: 200, epoch: 10 | loss: 4.4139295
	speed: 0.1584s/iter; left time: 5285.8119s
	iters: 300, epoch: 10 | loss: 7.7373447
	speed: 0.1601s/iter; left time: 5328.1066s
Epoch: 10 cost time: 59.35083794593811
Epoch: 10, Steps: 369 | Train Loss: 4.064 Vali Loss: 10.062 Vali Acc: 0.635 Test Loss: 10.062 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.7080069
	speed: 0.5788s/iter; left time: 19163.0016s
	iters: 200, epoch: 11 | loss: 4.3939829
	speed: 0.1557s/iter; left time: 5139.1083s
	iters: 300, epoch: 11 | loss: 0.7490673
	speed: 0.1527s/iter; left time: 5025.6398s
Epoch: 11 cost time: 58.13604116439819
Epoch: 11, Steps: 369 | Train Loss: 3.424 Vali Loss: 7.556 Vali Acc: 0.645 Test Loss: 7.556 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.0136507
	speed: 0.5711s/iter; left time: 18697.6524s
	iters: 200, epoch: 12 | loss: 1.4537776
	speed: 0.1633s/iter; left time: 5331.1230s
	iters: 300, epoch: 12 | loss: 1.9266512
	speed: 0.1650s/iter; left time: 5368.7868s
Epoch: 12 cost time: 61.52920961380005
Epoch: 12, Steps: 369 | Train Loss: 2.562 Vali Loss: 7.988 Vali Acc: 0.620 Test Loss: 7.988 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 4.5157514
	speed: 0.6122s/iter; left time: 19818.6393s
	iters: 200, epoch: 13 | loss: 2.4794326
	speed: 0.1693s/iter; left time: 5464.2237s
	iters: 300, epoch: 13 | loss: 0.0632762
	speed: 0.1694s/iter; left time: 5449.4106s
Epoch: 13 cost time: 63.19122290611267
Epoch: 13, Steps: 369 | Train Loss: 1.947 Vali Loss: 5.151 Vali Acc: 0.634 Test Loss: 5.151 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6634506242905789
model parameter : 974210
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.3469954
	speed: 0.1408s/iter; left time: 5181.0656s
	iters: 200, epoch: 1 | loss: 2.0064352
	speed: 0.1155s/iter; left time: 4237.6159s
	iters: 300, epoch: 1 | loss: 1.0123692
	speed: 0.1191s/iter; left time: 4360.2917s
Epoch: 1 cost time: 46.10004544258118
Epoch: 1, Steps: 369 | Train Loss: 1.611 Vali Loss: 1.430 Vali Acc: 0.669 Test Loss: 1.430 Test Acc: 0.669
Validation loss decreased (inf --> -0.668828).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2124695
	speed: 0.4663s/iter; left time: 16989.6173s
	iters: 200, epoch: 2 | loss: 2.0895760
	speed: 0.1287s/iter; left time: 4677.3058s
	iters: 300, epoch: 2 | loss: 2.4510078
	speed: 0.1286s/iter; left time: 4660.4564s
Epoch: 2 cost time: 48.383896589279175
Epoch: 2, Steps: 369 | Train Loss: 2.557 Vali Loss: 2.647 Vali Acc: 0.624 Test Loss: 2.647 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2461612
	speed: 0.4790s/iter; left time: 17274.6795s
	iters: 200, epoch: 3 | loss: 0.4259871
	speed: 0.1280s/iter; left time: 4601.8830s
	iters: 300, epoch: 3 | loss: 3.4693265
	speed: 0.1294s/iter; left time: 4641.9169s
Epoch: 3 cost time: 48.242760181427
Epoch: 3, Steps: 369 | Train Loss: 3.480 Vali Loss: 4.066 Vali Acc: 0.667 Test Loss: 4.066 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3784330
	speed: 0.4801s/iter; left time: 17135.8809s
	iters: 200, epoch: 4 | loss: 1.2976302
	speed: 0.1305s/iter; left time: 4644.3048s
	iters: 300, epoch: 4 | loss: 7.1523089
	speed: 0.1196s/iter; left time: 4246.4609s
Epoch: 4 cost time: 47.143776178359985
Epoch: 4, Steps: 369 | Train Loss: 4.118 Vali Loss: 4.477 Vali Acc: 0.644 Test Loss: 4.477 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3822930
	speed: 0.4555s/iter; left time: 16092.0256s
	iters: 200, epoch: 5 | loss: 2.4139287
	speed: 0.1222s/iter; left time: 4303.2155s
	iters: 300, epoch: 5 | loss: 3.2341950
	speed: 0.1238s/iter; left time: 4349.1408s
Epoch: 5 cost time: 45.988370418548584
Epoch: 5, Steps: 369 | Train Loss: 4.351 Vali Loss: 7.629 Vali Acc: 0.598 Test Loss: 7.629 Test Acc: 0.598
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 5.8056288
	speed: 0.4517s/iter; left time: 15789.7732s
	iters: 200, epoch: 6 | loss: 6.0425024
	speed: 0.1172s/iter; left time: 4084.4737s
	iters: 300, epoch: 6 | loss: 7.0306497
	speed: 0.1141s/iter; left time: 3966.4793s
Epoch: 6 cost time: 43.60377240180969
Epoch: 6, Steps: 369 | Train Loss: 4.712 Vali Loss: 5.678 Vali Acc: 0.640 Test Loss: 5.678 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 4.7450409
	speed: 0.4492s/iter; left time: 15537.7030s
	iters: 200, epoch: 7 | loss: 6.7202711
	speed: 0.1233s/iter; left time: 4251.9937s
	iters: 300, epoch: 7 | loss: 0.6338696
	speed: 0.1231s/iter; left time: 4233.8745s
Epoch: 7 cost time: 47.02937364578247
Epoch: 7, Steps: 369 | Train Loss: 4.444 Vali Loss: 6.082 Vali Acc: 0.647 Test Loss: 6.082 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 5.2298284
	speed: 0.4728s/iter; left time: 16177.4529s
	iters: 200, epoch: 8 | loss: 3.9656892
	speed: 0.1274s/iter; left time: 4347.8123s
	iters: 300, epoch: 8 | loss: 7.0949569
	speed: 0.1276s/iter; left time: 4340.2704s
Epoch: 8 cost time: 47.85843467712402
Epoch: 8, Steps: 369 | Train Loss: 4.234 Vali Loss: 5.712 Vali Acc: 0.650 Test Loss: 5.712 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.6306684
	speed: 0.4837s/iter; left time: 16373.8670s
	iters: 200, epoch: 9 | loss: 5.2592297
	speed: 0.1287s/iter; left time: 4342.2294s
	iters: 300, epoch: 9 | loss: 3.0107338
	speed: 0.1294s/iter; left time: 4353.6264s
Epoch: 9 cost time: 48.349547386169434
Epoch: 9, Steps: 369 | Train Loss: 3.892 Vali Loss: 6.823 Vali Acc: 0.633 Test Loss: 6.823 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.5669699
	speed: 0.4637s/iter; left time: 15523.2368s
	iters: 200, epoch: 10 | loss: 0.3798921
	speed: 0.1155s/iter; left time: 3854.3551s
	iters: 300, epoch: 10 | loss: 6.1133127
	speed: 0.1148s/iter; left time: 3819.9914s
Epoch: 10 cost time: 44.47475290298462
Epoch: 10, Steps: 369 | Train Loss: 3.165 Vali Loss: 8.730 Vali Acc: 0.616 Test Loss: 8.730 Test Acc: 0.616
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.3787484
	speed: 0.4438s/iter; left time: 14694.8572s
	iters: 200, epoch: 11 | loss: 3.2195482
	speed: 0.1160s/iter; left time: 3829.3281s
	iters: 300, epoch: 11 | loss: 0.7394409
	speed: 0.1162s/iter; left time: 3824.3370s
Epoch: 11 cost time: 44.12795162200928
Epoch: 11, Steps: 369 | Train Loss: 2.928 Vali Loss: 4.655 Vali Acc: 0.647 Test Loss: 4.655 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6688422247446084
model parameter : 753282
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5313945
	speed: 0.1366s/iter; left time: 5027.7953s
	iters: 200, epoch: 1 | loss: 1.1090519
	speed: 0.1083s/iter; left time: 3973.2925s
	iters: 300, epoch: 1 | loss: 1.0745134
	speed: 0.1046s/iter; left time: 3826.8009s
Epoch: 1 cost time: 42.46196365356445
Epoch: 1, Steps: 369 | Train Loss: 1.557 Vali Loss: 1.059 Vali Acc: 0.648 Test Loss: 1.059 Test Acc: 0.648
Validation loss decreased (inf --> -0.648400).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0124011
	speed: 0.4097s/iter; left time: 14927.5771s
	iters: 200, epoch: 2 | loss: 1.2653207
	speed: 0.1019s/iter; left time: 3702.9964s
	iters: 300, epoch: 2 | loss: 1.2829070
	speed: 0.1027s/iter; left time: 3720.6797s
Epoch: 2 cost time: 39.36225700378418
Epoch: 2, Steps: 369 | Train Loss: 2.156 Vali Loss: 3.840 Vali Acc: 0.596 Test Loss: 3.840 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5872333
	speed: 0.4008s/iter; left time: 14454.4222s
	iters: 200, epoch: 3 | loss: 5.3961782
	speed: 0.0998s/iter; left time: 3588.6223s
	iters: 300, epoch: 3 | loss: 6.2276220
	speed: 0.1087s/iter; left time: 3898.1344s
Epoch: 3 cost time: 39.4303560256958
Epoch: 3, Steps: 369 | Train Loss: 3.042 Vali Loss: 3.415 Vali Acc: 0.663 Test Loss: 3.415 Test Acc: 0.663
Validation loss decreased (-0.648400 --> -0.663416).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7846578
	speed: 0.4305s/iter; left time: 15364.6337s
	iters: 200, epoch: 4 | loss: 4.6392102
	speed: 0.1092s/iter; left time: 3886.8689s
	iters: 300, epoch: 4 | loss: 5.0222378
	speed: 0.1089s/iter; left time: 3867.0247s
Epoch: 4 cost time: 40.90120506286621
Epoch: 4, Steps: 369 | Train Loss: 3.545 Vali Loss: 5.048 Vali Acc: 0.640 Test Loss: 5.048 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6126926
	speed: 0.4266s/iter; left time: 15069.4354s
	iters: 200, epoch: 5 | loss: 4.4118533
	speed: 0.1111s/iter; left time: 3915.2132s
	iters: 300, epoch: 5 | loss: 2.4861045
	speed: 0.1118s/iter; left time: 3928.3260s
Epoch: 5 cost time: 41.9961142539978
Epoch: 5, Steps: 369 | Train Loss: 3.840 Vali Loss: 3.343 Vali Acc: 0.673 Test Loss: 3.343 Test Acc: 0.673
Validation loss decreased (-0.663416 --> -0.672782).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.8888049
	speed: 0.4151s/iter; left time: 14510.6519s
	iters: 200, epoch: 6 | loss: 4.5910287
	speed: 0.1043s/iter; left time: 3634.2139s
	iters: 300, epoch: 6 | loss: 5.7471204
	speed: 0.1033s/iter; left time: 3589.2416s
Epoch: 6 cost time: 39.67794895172119
Epoch: 6, Steps: 369 | Train Loss: 3.950 Vali Loss: 5.224 Vali Acc: 0.636 Test Loss: 5.224 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9782484
	speed: 0.4003s/iter; left time: 13844.9683s
	iters: 200, epoch: 7 | loss: 6.2605381
	speed: 0.1049s/iter; left time: 3619.3730s
	iters: 300, epoch: 7 | loss: 6.7588038
	speed: 0.1023s/iter; left time: 3517.0020s
Epoch: 7 cost time: 39.39140486717224
Epoch: 7, Steps: 369 | Train Loss: 3.958 Vali Loss: 5.832 Vali Acc: 0.632 Test Loss: 5.832 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.4299421
	speed: 0.3965s/iter; left time: 13565.8229s
	iters: 200, epoch: 8 | loss: 3.4221139
	speed: 0.1019s/iter; left time: 3477.4087s
	iters: 300, epoch: 8 | loss: 0.0766028
	speed: 0.1060s/iter; left time: 3606.7499s
Epoch: 8 cost time: 39.27944374084473
Epoch: 8, Steps: 369 | Train Loss: 3.450 Vali Loss: 6.817 Vali Acc: 0.631 Test Loss: 6.817 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 10.0424318
	speed: 0.4032s/iter; left time: 13648.3835s
	iters: 200, epoch: 9 | loss: 3.2265091
	speed: 0.1113s/iter; left time: 3756.9821s
	iters: 300, epoch: 9 | loss: 8.1830397
	speed: 0.1113s/iter; left time: 3745.3656s
Epoch: 9 cost time: 42.01895713806152
Epoch: 9, Steps: 369 | Train Loss: 3.167 Vali Loss: 5.545 Vali Acc: 0.641 Test Loss: 5.545 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0782143
	speed: 0.4300s/iter; left time: 14397.7715s
	iters: 200, epoch: 10 | loss: 4.6461039
	speed: 0.1085s/iter; left time: 3620.0705s
	iters: 300, epoch: 10 | loss: 1.3338331
	speed: 0.1089s/iter; left time: 3625.6357s
Epoch: 10 cost time: 41.12251353263855
Epoch: 10, Steps: 369 | Train Loss: 2.699 Vali Loss: 6.016 Vali Acc: 0.645 Test Loss: 6.016 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.7234566
	speed: 0.4382s/iter; left time: 14510.6506s
	iters: 200, epoch: 11 | loss: 1.2742875
	speed: 0.1099s/iter; left time: 3628.8933s
	iters: 300, epoch: 11 | loss: 2.7303658
	speed: 0.1096s/iter; left time: 3606.1415s
Epoch: 11 cost time: 41.37098932266235
Epoch: 11, Steps: 369 | Train Loss: 2.390 Vali Loss: 5.987 Vali Acc: 0.643 Test Loss: 5.987 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0520509
	speed: 0.4212s/iter; left time: 13791.1583s
	iters: 200, epoch: 12 | loss: 1.2797830
	speed: 0.1085s/iter; left time: 3540.6443s
	iters: 300, epoch: 12 | loss: 1.4407643
	speed: 0.1064s/iter; left time: 3461.0340s
Epoch: 12 cost time: 40.35786414146423
Epoch: 12, Steps: 369 | Train Loss: 1.852 Vali Loss: 5.849 Vali Acc: 0.631 Test Loss: 5.849 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6961119
	speed: 0.3920s/iter; left time: 12691.7140s
	iters: 200, epoch: 13 | loss: 0.5033067
	speed: 0.1029s/iter; left time: 3322.3074s
	iters: 300, epoch: 13 | loss: 0.9407337
	speed: 0.1046s/iter; left time: 3366.2863s
Epoch: 13 cost time: 38.56582283973694
Epoch: 13, Steps: 369 | Train Loss: 1.551 Vali Loss: 4.406 Vali Acc: 0.639 Test Loss: 4.406 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2378546
	speed: 0.3966s/iter; left time: 12693.1479s
	iters: 200, epoch: 14 | loss: 2.3388903
	speed: 0.1053s/iter; left time: 3360.9973s
	iters: 300, epoch: 14 | loss: 2.7964363
	speed: 0.1015s/iter; left time: 3228.8933s
Epoch: 14 cost time: 39.116079568862915
Epoch: 14, Steps: 369 | Train Loss: 1.127 Vali Loss: 3.317 Vali Acc: 0.631 Test Loss: 3.317 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.0627332
	speed: 0.4313s/iter; left time: 13645.4032s
	iters: 200, epoch: 15 | loss: 0.8975269
	speed: 0.1113s/iter; left time: 3509.7087s
	iters: 300, epoch: 15 | loss: 1.2252679
	speed: 0.1114s/iter; left time: 3501.1542s
Epoch: 15 cost time: 42.09895586967468
Epoch: 15, Steps: 369 | Train Loss: 0.745 Vali Loss: 2.304 Vali Acc: 0.641 Test Loss: 2.304 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 643074
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.1543474
	speed: 0.1118s/iter; left time: 4112.5544s
	iters: 200, epoch: 1 | loss: 1.2195383
	speed: 0.0864s/iter; left time: 3171.5783s
	iters: 300, epoch: 1 | loss: 1.3862638
	speed: 0.0863s/iter; left time: 3158.2311s
Epoch: 1 cost time: 34.5631058216095
Epoch: 1, Steps: 369 | Train Loss: 1.302 Vali Loss: 0.894 Vali Acc: 0.656 Test Loss: 0.894 Test Acc: 0.656
Validation loss decreased (inf --> -0.655780).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3917781
	speed: 0.3398s/iter; left time: 12380.3934s
	iters: 200, epoch: 2 | loss: 1.4186361
	speed: 0.0802s/iter; left time: 2913.8223s
	iters: 300, epoch: 2 | loss: 3.4940186
	speed: 0.0840s/iter; left time: 3043.9129s
Epoch: 2 cost time: 31.75398564338684
Epoch: 2, Steps: 369 | Train Loss: 1.851 Vali Loss: 2.209 Vali Acc: 0.659 Test Loss: 2.209 Test Acc: 0.659
Validation loss decreased (-0.655780 --> -0.659456).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6448035
	speed: 0.3341s/iter; left time: 12050.3252s
	iters: 200, epoch: 3 | loss: 2.0640702
	speed: 0.0876s/iter; left time: 3150.9791s
	iters: 300, epoch: 3 | loss: 2.6689689
	speed: 0.0875s/iter; left time: 3137.0406s
Epoch: 3 cost time: 33.112060546875
Epoch: 3, Steps: 369 | Train Loss: 2.615 Vali Loss: 2.597 Vali Acc: 0.636 Test Loss: 2.597 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6365293
	speed: 0.3323s/iter; left time: 11862.7421s
	iters: 200, epoch: 4 | loss: 6.8885922
	speed: 0.0933s/iter; left time: 3319.8326s
	iters: 300, epoch: 4 | loss: 2.8290832
	speed: 0.0918s/iter; left time: 3257.6589s
Epoch: 4 cost time: 34.81931161880493
Epoch: 4, Steps: 369 | Train Loss: 3.244 Vali Loss: 2.706 Vali Acc: 0.622 Test Loss: 2.706 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.8409474
	speed: 0.3524s/iter; left time: 12450.0179s
	iters: 200, epoch: 5 | loss: 1.1224245
	speed: 0.0927s/iter; left time: 3267.0292s
	iters: 300, epoch: 5 | loss: 1.8610039
	speed: 0.0929s/iter; left time: 3262.0911s
Epoch: 5 cost time: 35.19114804267883
Epoch: 5, Steps: 369 | Train Loss: 3.328 Vali Loss: 3.465 Vali Acc: 0.650 Test Loss: 3.465 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.6688676
	speed: 0.3594s/iter; left time: 12562.0085s
	iters: 200, epoch: 6 | loss: 1.6783253
	speed: 0.0938s/iter; left time: 3269.8985s
	iters: 300, epoch: 6 | loss: 0.6842099
	speed: 0.0941s/iter; left time: 3270.2552s
Epoch: 6 cost time: 35.34251666069031
Epoch: 6, Steps: 369 | Train Loss: 3.487 Vali Loss: 4.221 Vali Acc: 0.650 Test Loss: 4.221 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 5.3629699
	speed: 0.3586s/iter; left time: 12402.6306s
	iters: 200, epoch: 7 | loss: 5.0455322
	speed: 0.0873s/iter; left time: 3011.2691s
	iters: 300, epoch: 7 | loss: 5.6880603
	speed: 0.0915s/iter; left time: 3145.3456s
Epoch: 7 cost time: 34.45996809005737
Epoch: 7, Steps: 369 | Train Loss: 3.286 Vali Loss: 6.281 Vali Acc: 0.648 Test Loss: 6.281 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.9182723
	speed: 0.3504s/iter; left time: 11988.7085s
	iters: 200, epoch: 8 | loss: 0.5283937
	speed: 0.0927s/iter; left time: 3161.5586s
	iters: 300, epoch: 8 | loss: 2.0409493
	speed: 0.0902s/iter; left time: 3067.4437s
Epoch: 8 cost time: 34.334917068481445
Epoch: 8, Steps: 369 | Train Loss: 3.099 Vali Loss: 4.601 Vali Acc: 0.633 Test Loss: 4.601 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.8720716
	speed: 0.3565s/iter; left time: 12065.8014s
	iters: 200, epoch: 9 | loss: 0.4918738
	speed: 0.0857s/iter; left time: 2893.3492s
	iters: 300, epoch: 9 | loss: 4.7163234
	speed: 0.0849s/iter; left time: 2855.5024s
Epoch: 9 cost time: 33.111425161361694
Epoch: 9, Steps: 369 | Train Loss: 2.822 Vali Loss: 5.858 Vali Acc: 0.634 Test Loss: 5.858 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.4429491
	speed: 0.3570s/iter; left time: 11953.0981s
	iters: 200, epoch: 10 | loss: 1.8124053
	speed: 0.0956s/iter; left time: 3190.4841s
	iters: 300, epoch: 10 | loss: 4.4103107
	speed: 0.0926s/iter; left time: 3080.2391s
Epoch: 10 cost time: 34.82161808013916
Epoch: 10, Steps: 369 | Train Loss: 2.420 Vali Loss: 5.076 Vali Acc: 0.639 Test Loss: 5.076 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.0506144
	speed: 0.3695s/iter; left time: 12235.7097s
	iters: 200, epoch: 11 | loss: 2.2240784
	speed: 0.0923s/iter; left time: 3045.6607s
	iters: 300, epoch: 11 | loss: 1.6962826
	speed: 0.0930s/iter; left time: 3062.2964s
Epoch: 11 cost time: 35.50395584106445
Epoch: 11, Steps: 369 | Train Loss: 1.990 Vali Loss: 5.248 Vali Acc: 0.618 Test Loss: 5.248 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.8868874
	speed: 0.3575s/iter; left time: 11705.6146s
	iters: 200, epoch: 12 | loss: 2.3419485
	speed: 0.0962s/iter; left time: 3139.0303s
	iters: 300, epoch: 12 | loss: 0.8560004
	speed: 0.0960s/iter; left time: 3123.9903s
Epoch: 12 cost time: 36.40254068374634
Epoch: 12, Steps: 369 | Train Loss: 1.626 Vali Loss: 4.734 Vali Acc: 0.635 Test Loss: 4.734 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.659477866061294
model parameter : 532866
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9507811
	speed: 0.0999s/iter; left time: 3678.0021s
	iters: 200, epoch: 1 | loss: 1.8419157
	speed: 0.0764s/iter; left time: 2804.1679s
	iters: 300, epoch: 1 | loss: 1.1154616
	speed: 0.0719s/iter; left time: 2630.0302s
Epoch: 1 cost time: 30.19913411140442
Epoch: 1, Steps: 369 | Train Loss: 1.259 Vali Loss: 1.038 Vali Acc: 0.641 Test Loss: 1.038 Test Acc: 0.641
Validation loss decreased (inf --> -0.641306).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1924701
	speed: 0.3087s/iter; left time: 11246.3978s
	iters: 200, epoch: 2 | loss: 1.5551307
	speed: 0.0769s/iter; left time: 2794.4571s
	iters: 300, epoch: 2 | loss: 2.1357300
	speed: 0.0757s/iter; left time: 2742.7134s
Epoch: 2 cost time: 29.105334520339966
Epoch: 2, Steps: 369 | Train Loss: 1.656 Vali Loss: 2.351 Vali Acc: 0.646 Test Loss: 2.351 Test Acc: 0.646
Validation loss decreased (-0.641306 --> -0.646401).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.6457424
	speed: 0.3081s/iter; left time: 11109.4324s
	iters: 200, epoch: 3 | loss: 3.7211010
	speed: 0.0765s/iter; left time: 2752.0678s
	iters: 300, epoch: 3 | loss: 2.8293431
	speed: 0.0775s/iter; left time: 2778.8738s
Epoch: 3 cost time: 29.03321623802185
Epoch: 3, Steps: 369 | Train Loss: 2.282 Vali Loss: 4.169 Vali Acc: 0.591 Test Loss: 4.169 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5486443
	speed: 0.3227s/iter; left time: 11519.8070s
	iters: 200, epoch: 4 | loss: 5.1318564
	speed: 0.0786s/iter; left time: 2796.0671s
	iters: 300, epoch: 4 | loss: 2.3414142
	speed: 0.0775s/iter; left time: 2751.2234s
Epoch: 4 cost time: 29.84227466583252
Epoch: 4, Steps: 369 | Train Loss: 2.720 Vali Loss: 2.687 Vali Acc: 0.637 Test Loss: 2.687 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.2226665
	speed: 0.3365s/iter; left time: 11888.2623s
	iters: 200, epoch: 5 | loss: 1.4151559
	speed: 0.0781s/iter; left time: 2750.6836s
	iters: 300, epoch: 5 | loss: 1.2455595
	speed: 0.0724s/iter; left time: 2542.6456s
Epoch: 5 cost time: 29.236579179763794
Epoch: 5, Steps: 369 | Train Loss: 2.879 Vali Loss: 4.274 Vali Acc: 0.641 Test Loss: 4.274 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 7.5448303
	speed: 0.3193s/iter; left time: 11161.9595s
	iters: 200, epoch: 6 | loss: 0.8881278
	speed: 0.0769s/iter; left time: 2681.9072s
	iters: 300, epoch: 6 | loss: 1.8992615
	speed: 0.0749s/iter; left time: 2602.0221s
Epoch: 6 cost time: 29.051199436187744
Epoch: 6, Steps: 369 | Train Loss: 2.779 Vali Loss: 4.725 Vali Acc: 0.631 Test Loss: 4.725 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.0888796
	speed: 0.3148s/iter; left time: 10889.4934s
	iters: 200, epoch: 7 | loss: 0.4001061
	speed: 0.0714s/iter; left time: 2460.7617s
	iters: 300, epoch: 7 | loss: 3.9721949
	speed: 0.0712s/iter; left time: 2447.5266s
Epoch: 7 cost time: 27.4016432762146
Epoch: 7, Steps: 369 | Train Loss: 2.731 Vali Loss: 4.107 Vali Acc: 0.648 Test Loss: 4.107 Test Acc: 0.648
Validation loss decreased (-0.646401 --> -0.647519).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1894958
	speed: 0.3168s/iter; left time: 10839.4201s
	iters: 200, epoch: 8 | loss: 5.7806644
	speed: 0.0718s/iter; left time: 2448.3830s
	iters: 300, epoch: 8 | loss: 1.3130494
	speed: 0.0722s/iter; left time: 2456.4279s
Epoch: 8 cost time: 27.487287759780884
Epoch: 8, Steps: 369 | Train Loss: 2.438 Vali Loss: 4.841 Vali Acc: 0.630 Test Loss: 4.841 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 5.6300926
	speed: 0.3346s/iter; left time: 11326.0643s
	iters: 200, epoch: 9 | loss: 7.0510106
	speed: 0.0864s/iter; left time: 2916.8360s
	iters: 300, epoch: 9 | loss: 0.0897250
	speed: 0.0866s/iter; left time: 2913.4184s
Epoch: 9 cost time: 33.07833433151245
Epoch: 9, Steps: 369 | Train Loss: 2.268 Vali Loss: 5.934 Vali Acc: 0.632 Test Loss: 5.934 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7247677
	speed: 0.2847s/iter; left time: 9533.1247s
	iters: 200, epoch: 10 | loss: 5.4810638
	speed: 0.0452s/iter; left time: 1509.5844s
	iters: 300, epoch: 10 | loss: 1.6673902
	speed: 0.0474s/iter; left time: 1578.0058s
Epoch: 10 cost time: 18.009515047073364
Epoch: 10, Steps: 369 | Train Loss: 1.926 Vali Loss: 5.676 Vali Acc: 0.650 Test Loss: 5.676 Test Acc: 0.650
Validation loss decreased (-0.647519 --> -0.650341).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9238678
	speed: 0.2144s/iter; left time: 7098.0185s
	iters: 200, epoch: 11 | loss: 1.4033816
	speed: 0.0568s/iter; left time: 1875.3578s
	iters: 300, epoch: 11 | loss: 3.9585347
	speed: 0.0684s/iter; left time: 2250.6607s
Epoch: 11 cost time: 22.491477966308594
Epoch: 11, Steps: 369 | Train Loss: 1.572 Vali Loss: 5.462 Vali Acc: 0.641 Test Loss: 5.462 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8473755
	speed: 0.2991s/iter; left time: 9792.4695s
	iters: 200, epoch: 12 | loss: 2.5358415
	speed: 0.0680s/iter; left time: 2219.0017s
	iters: 300, epoch: 12 | loss: 0.3188798
	speed: 0.0676s/iter; left time: 2199.6809s
Epoch: 12 cost time: 25.98955464363098
Epoch: 12, Steps: 369 | Train Loss: 1.283 Vali Loss: 5.192 Vali Acc: 0.633 Test Loss: 5.192 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0098743
	speed: 0.2975s/iter; left time: 9629.7759s
	iters: 200, epoch: 13 | loss: 0.1840677
	speed: 0.0681s/iter; left time: 2197.7267s
	iters: 300, epoch: 13 | loss: 1.6118896
	speed: 0.0688s/iter; left time: 2213.2409s
Epoch: 13 cost time: 26.456054210662842
Epoch: 13, Steps: 369 | Train Loss: 0.997 Vali Loss: 4.596 Vali Acc: 0.638 Test Loss: 4.596 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8566647
	speed: 0.2975s/iter; left time: 9520.3553s
	iters: 200, epoch: 14 | loss: 1.9904326
	speed: 0.0622s/iter; left time: 1984.8387s
	iters: 300, epoch: 14 | loss: 2.2630925
	speed: 0.0611s/iter; left time: 1941.9848s
Epoch: 14 cost time: 24.179274559020996
Epoch: 14, Steps: 369 | Train Loss: 0.849 Vali Loss: 3.496 Vali Acc: 0.651 Test Loss: 3.496 Test Acc: 0.651
Validation loss decreased (-0.650341 --> -0.650930).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4682061
	speed: 0.2913s/iter; left time: 9215.9566s
	iters: 200, epoch: 15 | loss: 2.2938788
	speed: 0.0672s/iter; left time: 2120.4246s
	iters: 300, epoch: 15 | loss: 0.0177217
	speed: 0.0663s/iter; left time: 2082.9436s
Epoch: 15 cost time: 25.73577904701233
Epoch: 15, Steps: 369 | Train Loss: 0.721 Vali Loss: 3.382 Vali Acc: 0.642 Test Loss: 3.382 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3335246
	speed: 0.2711s/iter; left time: 8475.4572s
	iters: 200, epoch: 16 | loss: 0.8661498
	speed: 0.0690s/iter; left time: 2150.4814s
	iters: 300, epoch: 16 | loss: 0.0413611
	speed: 0.0693s/iter; left time: 2151.5442s
Epoch: 16 cost time: 25.80494475364685
Epoch: 16, Steps: 369 | Train Loss: 0.515 Vali Loss: 3.107 Vali Acc: 0.653 Test Loss: 3.107 Test Acc: 0.653
Validation loss decreased (-0.650930 --> -0.652636).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0858564
	speed: 0.2937s/iter; left time: 9075.3963s
	iters: 200, epoch: 17 | loss: 0.9271792
	speed: 0.0691s/iter; left time: 2127.2219s
	iters: 300, epoch: 17 | loss: 0.3951860
	speed: 0.0703s/iter; left time: 2156.9598s
Epoch: 17 cost time: 26.651103258132935
Epoch: 17, Steps: 369 | Train Loss: 0.401 Vali Loss: 2.577 Vali Acc: 0.635 Test Loss: 2.577 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0343438
	speed: 0.2943s/iter; left time: 8983.1613s
	iters: 200, epoch: 18 | loss: 0.2246362
	speed: 0.0695s/iter; left time: 2116.0383s
	iters: 300, epoch: 18 | loss: 0.3502310
	speed: 0.0700s/iter; left time: 2122.8176s
Epoch: 18 cost time: 26.83814764022827
Epoch: 18, Steps: 369 | Train Loss: 0.294 Vali Loss: 2.088 Vali Acc: 0.636 Test Loss: 2.088 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2009177
	speed: 0.2910s/iter; left time: 8775.2259s
	iters: 200, epoch: 19 | loss: 0.0011575
	speed: 0.0653s/iter; left time: 1963.4070s
	iters: 300, epoch: 19 | loss: 0.0832102
	speed: 0.0643s/iter; left time: 1926.3233s
Epoch: 19 cost time: 25.27329921722412
Epoch: 19, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.851 Vali Acc: 0.639 Test Loss: 1.851 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1332709
	speed: 0.2821s/iter; left time: 8404.7565s
	iters: 200, epoch: 20 | loss: 0.0457900
	speed: 0.0628s/iter; left time: 1865.9764s
	iters: 300, epoch: 20 | loss: 0.0606915
	speed: 0.0640s/iter; left time: 1894.8749s
Epoch: 20 cost time: 24.78579807281494
Epoch: 20, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.806 Vali Acc: 0.651 Test Loss: 1.806 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0780122
	speed: 0.2882s/iter; left time: 8479.3150s
	iters: 200, epoch: 21 | loss: 0.0873103
	speed: 0.0618s/iter; left time: 1811.5238s
	iters: 300, epoch: 21 | loss: 0.0072055
	speed: 0.0692s/iter; left time: 2023.0946s
Epoch: 21 cost time: 25.229197025299072
Epoch: 21, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.720 Vali Acc: 0.646 Test Loss: 1.720 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.1277290
	speed: 0.3014s/iter; left time: 8757.7102s
	iters: 200, epoch: 22 | loss: 0.0928563
	speed: 0.0693s/iter; left time: 2007.2625s
	iters: 300, epoch: 22 | loss: 0.1475467
	speed: 0.0688s/iter; left time: 1986.0939s
Epoch: 22 cost time: 26.49354076385498
Epoch: 22, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.734 Vali Acc: 0.659 Test Loss: 1.734 Test Acc: 0.659
Validation loss decreased (-0.652636 --> -0.659461).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1046967
	speed: 0.3050s/iter; left time: 8749.0523s
	iters: 200, epoch: 23 | loss: 0.2140100
	speed: 0.0682s/iter; left time: 1949.6511s
	iters: 300, epoch: 23 | loss: 0.0337776
	speed: 0.0690s/iter; left time: 1966.3423s
Epoch: 23 cost time: 26.507004976272583
Epoch: 23, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.819 Vali Acc: 0.639 Test Loss: 1.819 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0461322
	speed: 0.2839s/iter; left time: 8037.3467s
	iters: 200, epoch: 24 | loss: 0.0036773
	speed: 0.0655s/iter; left time: 1848.3726s
	iters: 300, epoch: 24 | loss: 0.2234607
	speed: 0.0654s/iter; left time: 1837.4218s
Epoch: 24 cost time: 25.381689310073853
Epoch: 24, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.951 Vali Acc: 0.645 Test Loss: 1.951 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0194596
	speed: 0.2758s/iter; left time: 7707.2379s
	iters: 200, epoch: 25 | loss: 0.0886325
	speed: 0.0649s/iter; left time: 1807.6909s
	iters: 300, epoch: 25 | loss: 0.0375434
	speed: 0.0639s/iter; left time: 1772.0384s
Epoch: 25 cost time: 25.188560485839844
Epoch: 25, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.860 Vali Acc: 0.643 Test Loss: 1.860 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1102427
	speed: 0.2866s/iter; left time: 7903.7133s
	iters: 200, epoch: 26 | loss: 0.0503585
	speed: 0.0719s/iter; left time: 1975.4205s
	iters: 300, epoch: 26 | loss: 0.0578468
	speed: 0.0710s/iter; left time: 1944.8127s
Epoch: 26 cost time: 26.445236921310425
Epoch: 26, Steps: 369 | Train Loss: 0.130 Vali Loss: 2.030 Vali Acc: 0.645 Test Loss: 2.030 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0533512
	speed: 0.3002s/iter; left time: 8167.5374s
	iters: 200, epoch: 27 | loss: 0.0004730
	speed: 0.0699s/iter; left time: 1895.0604s
	iters: 300, epoch: 27 | loss: 0.0106823
	speed: 0.0700s/iter; left time: 1891.2418s
Epoch: 27 cost time: 26.888568878173828
Epoch: 27, Steps: 369 | Train Loss: 0.105 Vali Loss: 2.007 Vali Acc: 0.644 Test Loss: 2.007 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0261150
	speed: 0.3010s/iter; left time: 8077.4175s
	iters: 200, epoch: 28 | loss: 0.0143598
	speed: 0.0709s/iter; left time: 1896.2435s
	iters: 300, epoch: 28 | loss: 0.7571862
	speed: 0.0712s/iter; left time: 1896.7074s
Epoch: 28 cost time: 27.092698335647583
Epoch: 28, Steps: 369 | Train Loss: 0.112 Vali Loss: 2.129 Vali Acc: 0.642 Test Loss: 2.129 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0235299
	speed: 0.2849s/iter; left time: 7541.9594s
	iters: 200, epoch: 29 | loss: 0.0687031
	speed: 0.0647s/iter; left time: 1706.1616s
	iters: 300, epoch: 29 | loss: 0.1905960
	speed: 0.0643s/iter; left time: 1688.1137s
Epoch: 29 cost time: 25.042977809906006
Epoch: 29, Steps: 369 | Train Loss: 0.123 Vali Loss: 2.033 Vali Acc: 0.652 Test Loss: 2.033 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0034112
	speed: 0.2923s/iter; left time: 7629.8408s
	iters: 200, epoch: 30 | loss: 0.0805803
	speed: 0.0626s/iter; left time: 1627.3254s
	iters: 300, epoch: 30 | loss: 0.0033393
	speed: 0.0620s/iter; left time: 1606.1427s
Epoch: 30 cost time: 24.48787260055542
Epoch: 30, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.961 Vali Acc: 0.642 Test Loss: 1.961 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.1230606
	speed: 0.2806s/iter; left time: 7219.9537s
	iters: 200, epoch: 31 | loss: 0.0791949
	speed: 0.0567s/iter; left time: 1454.2982s
	iters: 300, epoch: 31 | loss: 0.0447810
	speed: 0.0684s/iter; left time: 1746.1033s
Epoch: 31 cost time: 24.9018816947937
Epoch: 31, Steps: 369 | Train Loss: 0.114 Vali Loss: 2.051 Vali Acc: 0.650 Test Loss: 2.051 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0477301
	speed: 0.3034s/iter; left time: 7695.6934s
	iters: 200, epoch: 32 | loss: 0.0025224
	speed: 0.0689s/iter; left time: 1739.4361s
	iters: 300, epoch: 32 | loss: 0.1843771
	speed: 0.0698s/iter; left time: 1757.0543s
Epoch: 32 cost time: 26.732341527938843
Epoch: 32, Steps: 369 | Train Loss: 0.109 Vali Loss: 2.033 Vali Acc: 0.652 Test Loss: 2.033 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.659477866061294
model parameter : 459522
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 16.3286762
	speed: 0.4428s/iter; left time: 16294.2913s
	iters: 200, epoch: 1 | loss: 3.5658667
	speed: 0.4262s/iter; left time: 15640.4089s
	iters: 300, epoch: 1 | loss: 4.7975817
	speed: 0.4211s/iter; left time: 15413.1819s
Epoch: 1 cost time: 156.69856309890747
Epoch: 1, Steps: 369 | Train Loss: 3.863 Vali Loss: 2.397 Vali Acc: 0.640 Test Loss: 2.397 Test Acc: 0.640
Validation loss decreased (inf --> -0.640441).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.6082716
	speed: 1.3056s/iter; left time: 47564.3602s
	iters: 200, epoch: 2 | loss: 7.6774549
	speed: 0.3971s/iter; left time: 14427.1359s
	iters: 300, epoch: 2 | loss: 6.5327501
	speed: 0.3981s/iter; left time: 14423.0593s
Epoch: 2 cost time: 146.25639724731445
Epoch: 2, Steps: 369 | Train Loss: 5.426 Vali Loss: 5.742 Vali Acc: 0.641 Test Loss: 5.742 Test Acc: 0.641
Validation loss decreased (-0.640441 --> -0.640692).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.2037158
	speed: 1.3145s/iter; left time: 47404.3147s
	iters: 200, epoch: 3 | loss: 11.4202423
	speed: 0.3822s/iter; left time: 13743.5081s
	iters: 300, epoch: 3 | loss: 1.2227970
	speed: 0.4037s/iter; left time: 14479.1523s
Epoch: 3 cost time: 143.98701786994934
Epoch: 3, Steps: 369 | Train Loss: 7.481 Vali Loss: 11.286 Vali Acc: 0.611 Test Loss: 11.286 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9816978
	speed: 1.3129s/iter; left time: 46861.3614s
	iters: 200, epoch: 4 | loss: 9.1888256
	speed: 0.3604s/iter; left time: 12828.2094s
	iters: 300, epoch: 4 | loss: 13.3014851
	speed: 0.3668s/iter; left time: 13018.1633s
Epoch: 4 cost time: 137.36125421524048
Epoch: 4, Steps: 369 | Train Loss: 8.663 Vali Loss: 9.331 Vali Acc: 0.665 Test Loss: 9.331 Test Acc: 0.665
Validation loss decreased (-0.640692 --> -0.664492).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1971586
	speed: 1.3025s/iter; left time: 46010.4958s
	iters: 200, epoch: 5 | loss: 3.9923718
	speed: 0.3855s/iter; left time: 13580.6189s
	iters: 300, epoch: 5 | loss: 5.8777876
	speed: 0.3810s/iter; left time: 13382.1283s
Epoch: 5 cost time: 141.12962245941162
Epoch: 5, Steps: 369 | Train Loss: 9.109 Vali Loss: 13.391 Vali Acc: 0.639 Test Loss: 13.391 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3195540
	speed: 1.2730s/iter; left time: 44498.4386s
	iters: 200, epoch: 6 | loss: 21.3521824
	speed: 0.3869s/iter; left time: 13485.5592s
	iters: 300, epoch: 6 | loss: 9.4362907
	speed: 0.3878s/iter; left time: 13479.1619s
Epoch: 6 cost time: 143.91800618171692
Epoch: 6, Steps: 369 | Train Loss: 8.327 Vali Loss: 20.256 Vali Acc: 0.637 Test Loss: 20.256 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 5.0503573
	speed: 1.2898s/iter; left time: 44611.3916s
	iters: 200, epoch: 7 | loss: 6.7557769
	speed: 0.3758s/iter; left time: 12959.1444s
	iters: 300, epoch: 7 | loss: 3.7266712
	speed: 0.3815s/iter; left time: 13117.8421s
Epoch: 7 cost time: 140.08682465553284
Epoch: 7, Steps: 369 | Train Loss: 7.905 Vali Loss: 17.404 Vali Acc: 0.624 Test Loss: 17.404 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 7.8939452
	speed: 1.2896s/iter; left time: 44127.0436s
	iters: 200, epoch: 8 | loss: 2.3172810
	speed: 0.3554s/iter; left time: 12124.0915s
	iters: 300, epoch: 8 | loss: 6.9575362
	speed: 0.3595s/iter; left time: 12231.0134s
Epoch: 8 cost time: 132.56813526153564
Epoch: 8, Steps: 369 | Train Loss: 7.333 Vali Loss: 20.485 Vali Acc: 0.622 Test Loss: 20.485 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 12.4906521
	speed: 1.3086s/iter; left time: 44296.3082s
	iters: 200, epoch: 9 | loss: 7.2613153
	speed: 0.3858s/iter; left time: 13020.3834s
	iters: 300, epoch: 9 | loss: 16.3226852
	speed: 0.3658s/iter; left time: 12308.2432s
Epoch: 9 cost time: 140.09406518936157
Epoch: 9, Steps: 369 | Train Loss: 5.497 Vali Loss: 23.152 Vali Acc: 0.644 Test Loss: 23.152 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.9144444
	speed: 1.2884s/iter; left time: 43134.7682s
	iters: 200, epoch: 10 | loss: 3.2467413
	speed: 0.3910s/iter; left time: 13051.0821s
	iters: 300, epoch: 10 | loss: 0.0034811
	speed: 0.3866s/iter; left time: 12864.4616s
Epoch: 10 cost time: 144.73874163627625
Epoch: 10, Steps: 369 | Train Loss: 4.985 Vali Loss: 22.682 Vali Acc: 0.650 Test Loss: 22.682 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000011
	speed: 1.2892s/iter; left time: 42688.0147s
	iters: 200, epoch: 11 | loss: 6.5834188
	speed: 0.3947s/iter; left time: 13028.0943s
	iters: 300, epoch: 11 | loss: 7.4107380
	speed: 0.3937s/iter; left time: 12956.0884s
Epoch: 11 cost time: 143.8749601840973
Epoch: 11, Steps: 369 | Train Loss: 3.892 Vali Loss: 22.329 Vali Acc: 0.633 Test Loss: 22.329 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7715068
	speed: 1.2968s/iter; left time: 42458.8747s
	iters: 200, epoch: 12 | loss: 3.2300754
	speed: 0.3640s/iter; left time: 11881.7286s
	iters: 300, epoch: 12 | loss: 1.7292094
	speed: 0.3661s/iter; left time: 11913.0156s
Epoch: 12 cost time: 128.05574440956116
Epoch: 12, Steps: 369 | Train Loss: 3.088 Vali Loss: 22.034 Vali Acc: 0.616 Test Loss: 22.034 Test Acc: 0.616
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 9.7447453
	speed: 1.0588s/iter; left time: 34277.5481s
	iters: 200, epoch: 13 | loss: 3.1614139
	speed: 0.3537s/iter; left time: 11414.8879s
	iters: 300, epoch: 13 | loss: 6.0997887
	speed: 0.3730s/iter; left time: 12001.9652s
Epoch: 13 cost time: 125.9433114528656
Epoch: 13, Steps: 369 | Train Loss: 2.246 Vali Loss: 24.143 Vali Acc: 0.633 Test Loss: 24.143 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 1.2367s/iter; left time: 39580.1789s
	iters: 200, epoch: 14 | loss: 0.9085956
	speed: 0.3458s/iter; left time: 11031.3081s
	iters: 300, epoch: 14 | loss: 6.5126629
	speed: 0.3576s/iter; left time: 11373.3819s
Epoch: 14 cost time: 131.10382628440857
Epoch: 14, Steps: 369 | Train Loss: 1.730 Vali Loss: 19.925 Vali Acc: 0.619 Test Loss: 19.925 Test Acc: 0.619
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6645856980703746
model parameter : 2452354
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8884862
	speed: 0.2064s/iter; left time: 7594.5018s
	iters: 200, epoch: 1 | loss: 1.7593622
	speed: 0.1895s/iter; left time: 6955.1063s
	iters: 300, epoch: 1 | loss: 3.0456476
	speed: 0.1880s/iter; left time: 6881.6947s
Epoch: 1 cost time: 71.3782947063446
Epoch: 1, Steps: 369 | Train Loss: 2.355 Vali Loss: 1.721 Vali Acc: 0.664 Test Loss: 1.721 Test Acc: 0.664
Validation loss decreased (inf --> -0.664001).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3152032
	speed: 0.7097s/iter; left time: 25854.7928s
	iters: 200, epoch: 2 | loss: 4.8480682
	speed: 0.1899s/iter; left time: 6897.6729s
	iters: 300, epoch: 2 | loss: 6.3595972
	speed: 0.1906s/iter; left time: 6905.5255s
Epoch: 2 cost time: 71.398610830307
Epoch: 2, Steps: 369 | Train Loss: 3.781 Vali Loss: 3.726 Vali Acc: 0.626 Test Loss: 3.726 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.6781254
	speed: 0.6991s/iter; left time: 25210.6821s
	iters: 200, epoch: 3 | loss: 6.1412396
	speed: 0.1691s/iter; left time: 6081.9121s
	iters: 300, epoch: 3 | loss: 3.0063348
	speed: 0.1774s/iter; left time: 6362.9907s
Epoch: 3 cost time: 66.54646182060242
Epoch: 3, Steps: 369 | Train Loss: 5.202 Vali Loss: 4.894 Vali Acc: 0.659 Test Loss: 4.894 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.8578089
	speed: 0.6943s/iter; left time: 24781.2697s
	iters: 200, epoch: 4 | loss: 4.2229514
	speed: 0.1915s/iter; left time: 6815.9460s
	iters: 300, epoch: 4 | loss: 3.1117213
	speed: 0.1915s/iter; left time: 6797.9742s
Epoch: 4 cost time: 71.92369484901428
Epoch: 4, Steps: 369 | Train Loss: 6.181 Vali Loss: 7.357 Vali Acc: 0.669 Test Loss: 7.357 Test Acc: 0.669
Validation loss decreased (-0.664001 --> -0.668769).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.0191274
	speed: 0.7065s/iter; left time: 24956.6612s
	iters: 200, epoch: 5 | loss: 4.2111826
	speed: 0.1799s/iter; left time: 6338.5238s
	iters: 300, epoch: 5 | loss: 7.7664733
	speed: 0.1850s/iter; left time: 6496.6937s
Epoch: 5 cost time: 68.97493267059326
Epoch: 5, Steps: 369 | Train Loss: 6.903 Vali Loss: 10.206 Vali Acc: 0.665 Test Loss: 10.206 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0925905
	speed: 0.7038s/iter; left time: 24602.3807s
	iters: 200, epoch: 6 | loss: 3.3382518
	speed: 0.1902s/iter; left time: 6629.2380s
	iters: 300, epoch: 6 | loss: 5.7183418
	speed: 0.1902s/iter; left time: 6610.9234s
Epoch: 6 cost time: 71.48217010498047
Epoch: 6, Steps: 369 | Train Loss: 6.836 Vali Loss: 8.484 Vali Acc: 0.642 Test Loss: 8.484 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 9.6782713
	speed: 0.6859s/iter; left time: 23723.0599s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1808s/iter; left time: 6235.6389s
	iters: 300, epoch: 7 | loss: 7.2153053
	speed: 0.1717s/iter; left time: 5905.6909s
Epoch: 7 cost time: 65.8524079322815
Epoch: 7, Steps: 369 | Train Loss: 6.206 Vali Loss: 8.674 Vali Acc: 0.636 Test Loss: 8.674 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 4.8102984
	speed: 0.6945s/iter; left time: 23765.1694s
	iters: 200, epoch: 8 | loss: 4.6099362
	speed: 0.1896s/iter; left time: 6467.1006s
	iters: 300, epoch: 8 | loss: 16.6241951
	speed: 0.1929s/iter; left time: 6560.8635s
Epoch: 8 cost time: 72.50130891799927
Epoch: 8, Steps: 369 | Train Loss: 5.414 Vali Loss: 12.558 Vali Acc: 0.610 Test Loss: 12.558 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 7.4382067
	speed: 0.6926s/iter; left time: 23443.1896s
	iters: 200, epoch: 9 | loss: 3.9248531
	speed: 0.1816s/iter; left time: 6128.4752s
	iters: 300, epoch: 9 | loss: 6.1316528
	speed: 0.1796s/iter; left time: 6042.5643s
Epoch: 9 cost time: 67.78735899925232
Epoch: 9, Steps: 369 | Train Loss: 4.784 Vali Loss: 11.538 Vali Acc: 0.633 Test Loss: 11.538 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.9574547
	speed: 0.7020s/iter; left time: 23502.6430s
	iters: 200, epoch: 10 | loss: 2.8992016
	speed: 0.1894s/iter; left time: 6323.2585s
	iters: 300, epoch: 10 | loss: 3.8297272
	speed: 0.1906s/iter; left time: 6342.9617s
Epoch: 10 cost time: 71.84981155395508
Epoch: 10, Steps: 369 | Train Loss: 4.097 Vali Loss: 10.926 Vali Acc: 0.631 Test Loss: 10.926 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 4.2905612
	speed: 0.6953s/iter; left time: 23022.3370s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1763s/iter; left time: 5820.3316s
	iters: 300, epoch: 11 | loss: 1.1195805
	speed: 0.1795s/iter; left time: 5907.9585s
Epoch: 11 cost time: 67.16163396835327
Epoch: 11, Steps: 369 | Train Loss: 3.181 Vali Loss: 9.009 Vali Acc: 0.610 Test Loss: 9.009 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4858984
	speed: 0.6927s/iter; left time: 22680.0860s
	iters: 200, epoch: 12 | loss: 1.0712649
	speed: 0.1919s/iter; left time: 6263.5129s
	iters: 300, epoch: 12 | loss: 0.7730500
	speed: 0.1911s/iter; left time: 6220.1418s
Epoch: 12 cost time: 71.7663848400116
Epoch: 12, Steps: 369 | Train Loss: 2.527 Vali Loss: 11.025 Vali Acc: 0.629 Test Loss: 11.025 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3987727
	speed: 0.7099s/iter; left time: 22980.7910s
	iters: 200, epoch: 13 | loss: 1.3327211
	speed: 0.1856s/iter; left time: 5989.6431s
	iters: 300, epoch: 13 | loss: 5.5486016
	speed: 0.1856s/iter; left time: 5972.3779s
Epoch: 13 cost time: 70.44472646713257
Epoch: 13, Steps: 369 | Train Loss: 1.831 Vali Loss: 8.490 Vali Acc: 0.635 Test Loss: 8.490 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.8397865
	speed: 0.6918s/iter; left time: 22140.3083s
	iters: 200, epoch: 14 | loss: 0.4370374
	speed: 0.1797s/iter; left time: 5734.7376s
	iters: 300, epoch: 14 | loss: 0.8136520
	speed: 0.1839s/iter; left time: 5848.3995s
Epoch: 14 cost time: 68.80375146865845
Epoch: 14, Steps: 369 | Train Loss: 1.365 Vali Loss: 8.601 Vali Acc: 0.611 Test Loss: 8.601 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6688422247446084
model parameter : 1309826
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 5.0054035
	speed: 0.1656s/iter; left time: 6093.0302s
	iters: 200, epoch: 1 | loss: 1.3740774
	speed: 0.1396s/iter; left time: 5125.1303s
	iters: 300, epoch: 1 | loss: 1.8822231
	speed: 0.1357s/iter; left time: 4968.3548s
Epoch: 1 cost time: 53.69426131248474
Epoch: 1, Steps: 369 | Train Loss: 2.113 Vali Loss: 2.931 Vali Acc: 0.559 Test Loss: 2.931 Test Acc: 0.559
Validation loss decreased (inf --> -0.558995).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8867476
	speed: 0.4865s/iter; left time: 17723.4822s
	iters: 200, epoch: 2 | loss: 1.5594894
	speed: 0.1233s/iter; left time: 4478.7929s
	iters: 300, epoch: 2 | loss: 5.2919068
	speed: 0.1222s/iter; left time: 4426.3083s
Epoch: 2 cost time: 46.08780813217163
Epoch: 2, Steps: 369 | Train Loss: 3.137 Vali Loss: 3.905 Vali Acc: 0.658 Test Loss: 3.905 Test Acc: 0.658
Validation loss decreased (-0.558995 --> -0.658304).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0489726
	speed: 0.4874s/iter; left time: 17577.9522s
	iters: 200, epoch: 3 | loss: 5.5231805
	speed: 0.1315s/iter; left time: 4728.1093s
	iters: 300, epoch: 3 | loss: 2.9626634
	speed: 0.1328s/iter; left time: 4763.9214s
Epoch: 3 cost time: 50.044848918914795
Epoch: 3, Steps: 369 | Train Loss: 4.390 Vali Loss: 3.712 Vali Acc: 0.654 Test Loss: 3.712 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.2621665
	speed: 0.5059s/iter; left time: 18056.3186s
	iters: 200, epoch: 4 | loss: 3.8135023
	speed: 0.1326s/iter; left time: 4720.0927s
	iters: 300, epoch: 4 | loss: 5.8469825
	speed: 0.1306s/iter; left time: 4635.1915s
Epoch: 4 cost time: 50.14344906806946
Epoch: 4, Steps: 369 | Train Loss: 4.912 Vali Loss: 7.521 Vali Acc: 0.601 Test Loss: 7.521 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.8711591
	speed: 0.5049s/iter; left time: 17835.5872s
	iters: 200, epoch: 5 | loss: 1.6633137
	speed: 0.1335s/iter; left time: 4703.9092s
	iters: 300, epoch: 5 | loss: 6.5955172
	speed: 0.1314s/iter; left time: 4614.6210s
Epoch: 5 cost time: 49.77517104148865
Epoch: 5, Steps: 369 | Train Loss: 5.334 Vali Loss: 5.088 Vali Acc: 0.639 Test Loss: 5.088 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 5.8379970
	speed: 0.4872s/iter; left time: 17028.8357s
	iters: 200, epoch: 6 | loss: 1.7359926
	speed: 0.1004s/iter; left time: 3500.5201s
	iters: 300, epoch: 6 | loss: 5.0280032
	speed: 0.1003s/iter; left time: 3485.5379s
Epoch: 6 cost time: 38.353373765945435
Epoch: 6, Steps: 369 | Train Loss: 5.613 Vali Loss: 7.635 Vali Acc: 0.629 Test Loss: 7.635 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.8194439
	speed: 0.3994s/iter; left time: 13815.2208s
	iters: 200, epoch: 7 | loss: 6.8425131
	speed: 0.0992s/iter; left time: 3422.1365s
	iters: 300, epoch: 7 | loss: 5.5075240
	speed: 0.0990s/iter; left time: 3404.3919s
Epoch: 7 cost time: 38.00291728973389
Epoch: 7, Steps: 369 | Train Loss: 5.807 Vali Loss: 7.927 Vali Acc: 0.656 Test Loss: 7.927 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 5.2632246
	speed: 0.4055s/iter; left time: 13874.3450s
	iters: 200, epoch: 8 | loss: 0.5266095
	speed: 0.0993s/iter; left time: 3386.3254s
	iters: 300, epoch: 8 | loss: 8.3786869
	speed: 0.0992s/iter; left time: 3374.4749s
Epoch: 8 cost time: 39.714661598205566
Epoch: 8, Steps: 369 | Train Loss: 4.891 Vali Loss: 8.058 Vali Acc: 0.639 Test Loss: 8.058 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.4378319
	speed: 0.4941s/iter; left time: 16724.7450s
	iters: 200, epoch: 9 | loss: 2.4845366
	speed: 0.1308s/iter; left time: 4412.7002s
	iters: 300, epoch: 9 | loss: 9.5072041
	speed: 0.1313s/iter; left time: 4419.0741s
Epoch: 9 cost time: 49.31796669960022
Epoch: 9, Steps: 369 | Train Loss: 4.429 Vali Loss: 6.006 Vali Acc: 0.648 Test Loss: 6.006 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 4.5589290
	speed: 0.4828s/iter; left time: 16163.2596s
	iters: 200, epoch: 10 | loss: 3.9826055
	speed: 0.1258s/iter; left time: 4198.4088s
	iters: 300, epoch: 10 | loss: 4.5188713
	speed: 0.1227s/iter; left time: 4082.6110s
Epoch: 10 cost time: 47.34142065048218
Epoch: 10, Steps: 369 | Train Loss: 3.549 Vali Loss: 6.754 Vali Acc: 0.640 Test Loss: 6.754 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6156881
	speed: 0.4857s/iter; left time: 16082.0727s
	iters: 200, epoch: 11 | loss: 1.4289927
	speed: 0.1320s/iter; left time: 4355.8647s
	iters: 300, epoch: 11 | loss: 2.3551717
	speed: 0.1305s/iter; left time: 4296.4247s
Epoch: 11 cost time: 49.5647976398468
Epoch: 11, Steps: 369 | Train Loss: 2.881 Vali Loss: 6.016 Vali Acc: 0.620 Test Loss: 6.016 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.3444855
	speed: 0.5067s/iter; left time: 16591.3805s
	iters: 200, epoch: 12 | loss: 0.8366196
	speed: 0.1311s/iter; left time: 4280.7116s
	iters: 300, epoch: 12 | loss: 4.1385803
	speed: 0.1226s/iter; left time: 3988.3592s
Epoch: 12 cost time: 48.365200996398926
Epoch: 12, Steps: 369 | Train Loss: 2.209 Vali Loss: 5.689 Vali Acc: 0.630 Test Loss: 5.689 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6583427922814983
model parameter : 941314
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.7545309
	speed: 0.1230s/iter; left time: 4524.9788s
	iters: 200, epoch: 1 | loss: 0.9607980
	speed: 0.0940s/iter; left time: 3449.5818s
	iters: 300, epoch: 1 | loss: 1.6533065
	speed: 0.0950s/iter; left time: 3476.1203s
Epoch: 1 cost time: 38.28435778617859
Epoch: 1, Steps: 369 | Train Loss: 1.609 Vali Loss: 1.945 Vali Acc: 0.597 Test Loss: 1.945 Test Acc: 0.597
Validation loss decreased (inf --> -0.597313).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9371738
	speed: 0.3677s/iter; left time: 13396.1756s
	iters: 200, epoch: 2 | loss: 3.6534855
	speed: 0.0966s/iter; left time: 3510.6445s
	iters: 300, epoch: 2 | loss: 3.1951640
	speed: 0.0950s/iter; left time: 3440.5314s
Epoch: 2 cost time: 35.983551025390625
Epoch: 2, Steps: 369 | Train Loss: 2.620 Vali Loss: 2.916 Vali Acc: 0.656 Test Loss: 2.916 Test Acc: 0.656
Validation loss decreased (-0.597313 --> -0.656327).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7535734
	speed: 0.3878s/iter; left time: 13983.5827s
	iters: 200, epoch: 3 | loss: 1.7804511
	speed: 0.0984s/iter; left time: 3538.3462s
	iters: 300, epoch: 3 | loss: 5.0368328
	speed: 0.0979s/iter; left time: 3512.4038s
Epoch: 3 cost time: 37.23489785194397
Epoch: 3, Steps: 369 | Train Loss: 3.555 Vali Loss: 4.737 Vali Acc: 0.594 Test Loss: 4.737 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.6472502
	speed: 0.3911s/iter; left time: 13959.8582s
	iters: 200, epoch: 4 | loss: 5.2297893
	speed: 0.0928s/iter; left time: 3302.8616s
	iters: 300, epoch: 4 | loss: 2.7226636
	speed: 0.0942s/iter; left time: 3342.9717s
Epoch: 4 cost time: 36.10467338562012
Epoch: 4, Steps: 369 | Train Loss: 4.080 Vali Loss: 5.230 Vali Acc: 0.630 Test Loss: 5.230 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.8060675
	speed: 0.3753s/iter; left time: 13256.1191s
	iters: 200, epoch: 5 | loss: 0.6017235
	speed: 0.0904s/iter; left time: 3185.2222s
	iters: 300, epoch: 5 | loss: 0.8282061
	speed: 0.0921s/iter; left time: 3234.9141s
Epoch: 5 cost time: 34.24756121635437
Epoch: 5, Steps: 369 | Train Loss: 4.355 Vali Loss: 6.061 Vali Acc: 0.638 Test Loss: 6.061 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.4768810
	speed: 0.3804s/iter; left time: 13297.0352s
	iters: 200, epoch: 6 | loss: 3.2873614
	speed: 0.0999s/iter; left time: 3480.5507s
	iters: 300, epoch: 6 | loss: 7.3289604
	speed: 0.1001s/iter; left time: 3480.1287s
Epoch: 6 cost time: 37.88216161727905
Epoch: 6, Steps: 369 | Train Loss: 4.469 Vali Loss: 7.775 Vali Acc: 0.644 Test Loss: 7.775 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 6.2333517
	speed: 0.4026s/iter; left time: 13924.4246s
	iters: 200, epoch: 7 | loss: 3.4265587
	speed: 0.0992s/iter; left time: 3419.6371s
	iters: 300, epoch: 7 | loss: 3.6583960
	speed: 0.1006s/iter; left time: 3458.5044s
Epoch: 7 cost time: 37.197617053985596
Epoch: 7, Steps: 369 | Train Loss: 4.270 Vali Loss: 6.994 Vali Acc: 0.621 Test Loss: 6.994 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.4000418
	speed: 0.3726s/iter; left time: 12748.7274s
	iters: 200, epoch: 8 | loss: 1.5280877
	speed: 0.0935s/iter; left time: 3188.6502s
	iters: 300, epoch: 8 | loss: 0.9749065
	speed: 0.0958s/iter; left time: 3258.1519s
Epoch: 8 cost time: 36.09787058830261
Epoch: 8, Steps: 369 | Train Loss: 4.052 Vali Loss: 6.098 Vali Acc: 0.634 Test Loss: 6.098 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.9134588
	speed: 0.3652s/iter; left time: 12363.1362s
	iters: 200, epoch: 9 | loss: 2.4694898
	speed: 0.0999s/iter; left time: 3370.2912s
	iters: 300, epoch: 9 | loss: 1.8333263
	speed: 0.0973s/iter; left time: 3273.1152s
Epoch: 9 cost time: 36.90805792808533
Epoch: 9, Steps: 369 | Train Loss: 3.424 Vali Loss: 6.893 Vali Acc: 0.637 Test Loss: 6.893 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.2745302
	speed: 0.3819s/iter; left time: 12787.2605s
	iters: 200, epoch: 10 | loss: 4.2810330
	speed: 0.0966s/iter; left time: 3224.3912s
	iters: 300, epoch: 10 | loss: 1.5437611
	speed: 0.0958s/iter; left time: 3188.7169s
Epoch: 10 cost time: 36.599687814712524
Epoch: 10, Steps: 369 | Train Loss: 2.786 Vali Loss: 6.854 Vali Acc: 0.626 Test Loss: 6.854 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.4651353
	speed: 0.3568s/iter; left time: 11813.0947s
	iters: 200, epoch: 11 | loss: 1.2252984
	speed: 0.0894s/iter; left time: 2950.5088s
	iters: 300, epoch: 11 | loss: 4.1094766
	speed: 0.0903s/iter; left time: 2972.0562s
Epoch: 11 cost time: 33.74681329727173
Epoch: 11, Steps: 369 | Train Loss: 2.482 Vali Loss: 6.596 Vali Acc: 0.636 Test Loss: 6.596 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.7774969
	speed: 0.3521s/iter; left time: 11529.7996s
	iters: 200, epoch: 12 | loss: 1.5275278
	speed: 0.0881s/iter; left time: 2874.7892s
	iters: 300, epoch: 12 | loss: 1.5738046
	speed: 0.0849s/iter; left time: 2761.3877s
Epoch: 12 cost time: 33.3968288898468
Epoch: 12, Steps: 369 | Train Loss: 1.867 Vali Loss: 5.892 Vali Acc: 0.638 Test Loss: 5.892 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6563564131668559
model parameter : 720386
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0658798
	speed: 0.1061s/iter; left time: 3904.4676s
	iters: 200, epoch: 1 | loss: 1.0475754
	speed: 0.0812s/iter; left time: 2979.2504s
	iters: 300, epoch: 1 | loss: 2.4144604
	speed: 0.0815s/iter; left time: 2981.5591s
Epoch: 1 cost time: 32.66620087623596
Epoch: 1, Steps: 369 | Train Loss: 1.522 Vali Loss: 1.447 Vali Acc: 0.630 Test Loss: 1.447 Test Acc: 0.630
Validation loss decreased (inf --> -0.629951).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8265394
	speed: 0.3374s/iter; left time: 12293.4204s
	iters: 200, epoch: 2 | loss: 1.5653185
	speed: 0.0791s/iter; left time: 2873.4704s
	iters: 300, epoch: 2 | loss: 1.5731319
	speed: 0.0794s/iter; left time: 2876.4831s
Epoch: 2 cost time: 30.589691162109375
Epoch: 2, Steps: 369 | Train Loss: 2.224 Vali Loss: 2.618 Vali Acc: 0.636 Test Loss: 2.618 Test Acc: 0.636
Validation loss decreased (-0.629951 --> -0.636466).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.8350964
	speed: 0.3394s/iter; left time: 12238.6658s
	iters: 200, epoch: 3 | loss: 4.9215546
	speed: 0.0842s/iter; left time: 3027.1197s
	iters: 300, epoch: 3 | loss: 1.9752970
	speed: 0.0833s/iter; left time: 2985.9045s
Epoch: 3 cost time: 32.08520150184631
Epoch: 3, Steps: 369 | Train Loss: 3.175 Vali Loss: 3.406 Vali Acc: 0.637 Test Loss: 3.406 Test Acc: 0.637
Validation loss decreased (-0.636466 --> -0.637310).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2717347
	speed: 0.3522s/iter; left time: 12569.9418s
	iters: 200, epoch: 4 | loss: 3.7410815
	speed: 0.0778s/iter; left time: 2767.5308s
	iters: 300, epoch: 4 | loss: 2.6231999
	speed: 0.0812s/iter; left time: 2882.3650s
Epoch: 4 cost time: 31.492199182510376
Epoch: 4, Steps: 369 | Train Loss: 3.373 Vali Loss: 4.064 Vali Acc: 0.628 Test Loss: 4.064 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.8789382
	speed: 0.3442s/iter; left time: 12160.5630s
	iters: 200, epoch: 5 | loss: 3.8552110
	speed: 0.0856s/iter; left time: 3013.7422s
	iters: 300, epoch: 5 | loss: 3.9311984
	speed: 0.0840s/iter; left time: 2950.2069s
Epoch: 5 cost time: 31.261765241622925
Epoch: 5, Steps: 369 | Train Loss: 3.801 Vali Loss: 4.674 Vali Acc: 0.642 Test Loss: 4.674 Test Acc: 0.642
Validation loss decreased (-0.637310 --> -0.642121).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.1112323
	speed: 0.3342s/iter; left time: 11681.5080s
	iters: 200, epoch: 6 | loss: 2.9432762
	speed: 0.0832s/iter; left time: 2901.1073s
	iters: 300, epoch: 6 | loss: 4.2746277
	speed: 0.0836s/iter; left time: 2905.8447s
Epoch: 6 cost time: 32.064409255981445
Epoch: 6, Steps: 369 | Train Loss: 3.833 Vali Loss: 6.182 Vali Acc: 0.629 Test Loss: 6.182 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 6.5972080
	speed: 0.3515s/iter; left time: 12155.8136s
	iters: 200, epoch: 7 | loss: 5.3067675
	speed: 0.0831s/iter; left time: 2866.4867s
	iters: 300, epoch: 7 | loss: 0.7891803
	speed: 0.0828s/iter; left time: 2846.1545s
Epoch: 7 cost time: 31.956506967544556
Epoch: 7, Steps: 369 | Train Loss: 3.672 Vali Loss: 6.976 Vali Acc: 0.649 Test Loss: 6.976 Test Acc: 0.649
Validation loss decreased (-0.642121 --> -0.649192).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.5251584
	speed: 0.3324s/iter; left time: 11372.8824s
	iters: 200, epoch: 8 | loss: 0.0051261
	speed: 0.0766s/iter; left time: 2612.9430s
	iters: 300, epoch: 8 | loss: 3.3066847
	speed: 0.0794s/iter; left time: 2699.8135s
Epoch: 8 cost time: 29.882885456085205
Epoch: 8, Steps: 369 | Train Loss: 3.505 Vali Loss: 7.583 Vali Acc: 0.646 Test Loss: 7.583 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1305587
	speed: 0.3362s/iter; left time: 11378.6968s
	iters: 200, epoch: 9 | loss: 6.0069184
	speed: 0.0786s/iter; left time: 2654.0238s
	iters: 300, epoch: 9 | loss: 4.0135975
	speed: 0.0758s/iter; left time: 2549.5657s
Epoch: 9 cost time: 30.301892518997192
Epoch: 9, Steps: 369 | Train Loss: 2.917 Vali Loss: 7.499 Vali Acc: 0.635 Test Loss: 7.499 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 3.3574433
	speed: 0.3349s/iter; left time: 11213.0396s
	iters: 200, epoch: 10 | loss: 0.9244214
	speed: 0.0875s/iter; left time: 2919.7382s
	iters: 300, epoch: 10 | loss: 1.8167707
	speed: 0.0868s/iter; left time: 2889.4608s
Epoch: 10 cost time: 32.94795227050781
Epoch: 10, Steps: 369 | Train Loss: 2.429 Vali Loss: 6.094 Vali Acc: 0.644 Test Loss: 6.094 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8133147
	speed: 0.3494s/iter; left time: 11569.7336s
	iters: 200, epoch: 11 | loss: 3.4757872
	speed: 0.0811s/iter; left time: 2676.0417s
	iters: 300, epoch: 11 | loss: 0.3600290
	speed: 0.0806s/iter; left time: 2652.2180s
Epoch: 11 cost time: 31.23194694519043
Epoch: 11, Steps: 369 | Train Loss: 2.125 Vali Loss: 6.507 Vali Acc: 0.625 Test Loss: 6.507 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.8452383
	speed: 0.3379s/iter; left time: 11063.3617s
	iters: 200, epoch: 12 | loss: 2.8980296
	speed: 0.0845s/iter; left time: 2759.3284s
	iters: 300, epoch: 12 | loss: 1.9213943
	speed: 0.0827s/iter; left time: 2689.7678s
Epoch: 12 cost time: 31.724145650863647
Epoch: 12, Steps: 369 | Train Loss: 1.889 Vali Loss: 6.108 Vali Acc: 0.643 Test Loss: 6.108 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2994655
	speed: 0.3483s/iter; left time: 11274.3580s
	iters: 200, epoch: 13 | loss: 1.3044678
	speed: 0.0880s/iter; left time: 2840.5495s
	iters: 300, epoch: 13 | loss: 0.5134979
	speed: 0.0872s/iter; left time: 2804.9771s
Epoch: 13 cost time: 33.54785919189453
Epoch: 13, Steps: 369 | Train Loss: 1.369 Vali Loss: 5.457 Vali Acc: 0.651 Test Loss: 5.457 Test Acc: 0.651
Validation loss decreased (-0.649192 --> -0.651194).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6124529
	speed: 0.3532s/iter; left time: 11302.9115s
	iters: 200, epoch: 14 | loss: 0.1397416
	speed: 0.0877s/iter; left time: 2798.2132s
	iters: 300, epoch: 14 | loss: 1.2244058
	speed: 0.0866s/iter; left time: 2753.0266s
Epoch: 14 cost time: 33.288405656814575
Epoch: 14, Steps: 369 | Train Loss: 0.967 Vali Loss: 4.939 Vali Acc: 0.650 Test Loss: 4.939 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6678464
	speed: 0.3417s/iter; left time: 10809.8764s
	iters: 200, epoch: 15 | loss: 2.1079450
	speed: 0.0790s/iter; left time: 2490.0079s
	iters: 300, epoch: 15 | loss: 0.9062361
	speed: 0.0778s/iter; left time: 2446.5696s
Epoch: 15 cost time: 30.222052574157715
Epoch: 15, Steps: 369 | Train Loss: 0.794 Vali Loss: 4.256 Vali Acc: 0.644 Test Loss: 4.256 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0952632
	speed: 0.3340s/iter; left time: 10441.4395s
	iters: 200, epoch: 16 | loss: 0.0629839
	speed: 0.0792s/iter; left time: 2468.1895s
	iters: 300, epoch: 16 | loss: 0.0681123
	speed: 0.0800s/iter; left time: 2483.7975s
Epoch: 16 cost time: 29.758205890655518
Epoch: 16, Steps: 369 | Train Loss: 0.556 Vali Loss: 3.520 Vali Acc: 0.653 Test Loss: 3.520 Test Acc: 0.653
Validation loss decreased (-0.651194 --> -0.653200).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8250107
	speed: 0.2849s/iter; left time: 8802.6588s
	iters: 200, epoch: 17 | loss: 0.0462656
	speed: 0.0655s/iter; left time: 2015.9063s
	iters: 300, epoch: 17 | loss: 0.2041613
	speed: 0.0950s/iter; left time: 2915.4418s
Epoch: 17 cost time: 30.261847496032715
Epoch: 17, Steps: 369 | Train Loss: 0.418 Vali Loss: 2.856 Vali Acc: 0.644 Test Loss: 2.856 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001949
	speed: 0.3256s/iter; left time: 9940.0180s
	iters: 200, epoch: 18 | loss: 0.3247970
	speed: 0.0631s/iter; left time: 1920.6504s
	iters: 300, epoch: 18 | loss: 0.0144703
	speed: 0.0644s/iter; left time: 1951.8079s
Epoch: 18 cost time: 24.577486038208008
Epoch: 18, Steps: 369 | Train Loss: 0.296 Vali Loss: 2.387 Vali Acc: 0.653 Test Loss: 2.387 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1228595
	speed: 0.2766s/iter; left time: 8340.6357s
	iters: 200, epoch: 19 | loss: 0.1585504
	speed: 0.0648s/iter; left time: 1947.0024s
	iters: 300, epoch: 19 | loss: 0.0781824
	speed: 0.0653s/iter; left time: 1956.2212s
Epoch: 19 cost time: 24.45568346977234
Epoch: 19, Steps: 369 | Train Loss: 0.180 Vali Loss: 2.154 Vali Acc: 0.651 Test Loss: 2.154 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0070754
	speed: 0.2648s/iter; left time: 7889.7878s
	iters: 200, epoch: 20 | loss: 0.2297533
	speed: 0.0672s/iter; left time: 1996.0840s
	iters: 300, epoch: 20 | loss: 0.2107515
	speed: 0.0652s/iter; left time: 1929.4800s
Epoch: 20 cost time: 24.60965394973755
Epoch: 20, Steps: 369 | Train Loss: 0.144 Vali Loss: 2.058 Vali Acc: 0.655 Test Loss: 2.058 Test Acc: 0.655
Validation loss decreased (-0.653200 --> -0.654633).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0204256
	speed: 0.2742s/iter; left time: 8067.5074s
	iters: 200, epoch: 21 | loss: 0.0329509
	speed: 0.0646s/iter; left time: 1893.2041s
	iters: 300, epoch: 21 | loss: 0.6673744
	speed: 0.0642s/iter; left time: 1876.3495s
Epoch: 21 cost time: 24.263641595840454
Epoch: 21, Steps: 369 | Train Loss: 0.140 Vali Loss: 2.073 Vali Acc: 0.640 Test Loss: 2.073 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0065328
	speed: 0.3068s/iter; left time: 8912.9487s
	iters: 200, epoch: 22 | loss: 0.0571543
	speed: 0.0816s/iter; left time: 2362.9957s
	iters: 300, epoch: 22 | loss: 0.0121355
	speed: 0.0815s/iter; left time: 2351.3734s
Epoch: 22 cost time: 31.553707361221313
Epoch: 22, Steps: 369 | Train Loss: 0.141 Vali Loss: 2.046 Vali Acc: 0.644 Test Loss: 2.046 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0182224
	speed: 0.3291s/iter; left time: 9438.6908s
	iters: 200, epoch: 23 | loss: 0.1878484
	speed: 0.0829s/iter; left time: 2370.0184s
	iters: 300, epoch: 23 | loss: 0.0233079
	speed: 0.0824s/iter; left time: 2347.5409s
Epoch: 23 cost time: 31.485875368118286
Epoch: 23, Steps: 369 | Train Loss: 0.100 Vali Loss: 2.111 Vali Acc: 0.655 Test Loss: 2.111 Test Acc: 0.655
Validation loss decreased (-0.654633 --> -0.654916).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0387908
	speed: 0.3320s/iter; left time: 9400.0126s
	iters: 200, epoch: 24 | loss: 0.1472264
	speed: 0.0783s/iter; left time: 2208.9343s
	iters: 300, epoch: 24 | loss: 0.0154885
	speed: 0.0717s/iter; left time: 2015.2689s
Epoch: 24 cost time: 29.07646131515503
Epoch: 24, Steps: 369 | Train Loss: 0.090 Vali Loss: 2.100 Vali Acc: 0.661 Test Loss: 2.100 Test Acc: 0.661
Validation loss decreased (-0.654916 --> -0.660876).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0459630
	speed: 0.3206s/iter; left time: 8960.0483s
	iters: 200, epoch: 25 | loss: 0.0092102
	speed: 0.0735s/iter; left time: 2045.3551s
	iters: 300, epoch: 25 | loss: 0.0288899
	speed: 0.0810s/iter; left time: 2248.3188s
Epoch: 25 cost time: 29.49997353553772
Epoch: 25, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.170 Vali Acc: 0.659 Test Loss: 2.170 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0055961
	speed: 0.3420s/iter; left time: 9431.0044s
	iters: 200, epoch: 26 | loss: 0.1730653
	speed: 0.0819s/iter; left time: 2250.1581s
	iters: 300, epoch: 26 | loss: 0.2278728
	speed: 0.0820s/iter; left time: 2245.4095s
Epoch: 26 cost time: 31.49397587776184
Epoch: 26, Steps: 369 | Train Loss: 0.123 Vali Loss: 2.061 Vali Acc: 0.644 Test Loss: 2.061 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0060345
	speed: 0.3328s/iter; left time: 9054.9611s
	iters: 200, epoch: 27 | loss: 0.0066000
	speed: 0.0778s/iter; left time: 2109.1212s
	iters: 300, epoch: 27 | loss: 0.1945515
	speed: 0.0822s/iter; left time: 2219.3216s
Epoch: 27 cost time: 30.6565945148468
Epoch: 27, Steps: 369 | Train Loss: 0.118 Vali Loss: 2.088 Vali Acc: 0.654 Test Loss: 2.088 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0224282
	speed: 0.3245s/iter; left time: 8708.5549s
	iters: 200, epoch: 28 | loss: 0.1667191
	speed: 0.0757s/iter; left time: 2023.9332s
	iters: 300, epoch: 28 | loss: 0.2981102
	speed: 0.0829s/iter; left time: 2209.5780s
Epoch: 28 cost time: 30.636967182159424
Epoch: 28, Steps: 369 | Train Loss: 0.107 Vali Loss: 2.168 Vali Acc: 0.647 Test Loss: 2.168 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0020068
	speed: 0.3360s/iter; left time: 8893.6138s
	iters: 200, epoch: 29 | loss: 0.0205545
	speed: 0.0828s/iter; left time: 2183.2049s
	iters: 300, epoch: 29 | loss: 0.0820967
	speed: 0.0826s/iter; left time: 2169.0832s
Epoch: 29 cost time: 31.651875495910645
Epoch: 29, Steps: 369 | Train Loss: 0.097 Vali Loss: 2.242 Vali Acc: 0.648 Test Loss: 2.242 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0289167
	speed: 0.3243s/iter; left time: 8464.6984s
	iters: 200, epoch: 30 | loss: 0.2155077
	speed: 0.0750s/iter; left time: 1949.5840s
	iters: 300, epoch: 30 | loss: 0.5656571
	speed: 0.0776s/iter; left time: 2010.4655s
Epoch: 30 cost time: 28.270181894302368
Epoch: 30, Steps: 369 | Train Loss: 0.090 Vali Loss: 2.325 Vali Acc: 0.644 Test Loss: 2.325 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0421506
	speed: 0.3112s/iter; left time: 8008.6912s
	iters: 200, epoch: 31 | loss: 0.0190375
	speed: 0.0716s/iter; left time: 1833.9851s
	iters: 300, epoch: 31 | loss: 0.0114148
	speed: 0.0730s/iter; left time: 1863.5552s
Epoch: 31 cost time: 27.57647395133972
Epoch: 31, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.165 Vali Acc: 0.654 Test Loss: 2.165 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0109142
	speed: 0.3251s/iter; left time: 8244.3754s
	iters: 200, epoch: 32 | loss: 0.6905133
	speed: 0.0766s/iter; left time: 1935.5452s
	iters: 300, epoch: 32 | loss: 0.6239967
	speed: 0.0770s/iter; left time: 1938.2717s
Epoch: 32 cost time: 29.610045909881592
Epoch: 32, Steps: 369 | Train Loss: 0.096 Vali Loss: 2.406 Vali Acc: 0.657 Test Loss: 2.406 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0030294
	speed: 0.3273s/iter; left time: 8180.4685s
	iters: 200, epoch: 33 | loss: 0.0003890
	speed: 0.0729s/iter; left time: 1814.9940s
	iters: 300, epoch: 33 | loss: 0.0060114
	speed: 0.0693s/iter; left time: 1717.2106s
Epoch: 33 cost time: 27.681123971939087
Epoch: 33, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.529 Vali Acc: 0.646 Test Loss: 2.529 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0015619
	speed: 0.3071s/iter; left time: 7562.3620s
	iters: 200, epoch: 34 | loss: 0.3222222
	speed: 0.0677s/iter; left time: 1659.5568s
	iters: 300, epoch: 34 | loss: 0.1114487
	speed: 0.0662s/iter; left time: 1616.5816s
Epoch: 34 cost time: 26.700538158416748
Epoch: 34, Steps: 369 | Train Loss: 0.091 Vali Loss: 2.398 Vali Acc: 0.660 Test Loss: 2.398 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6608967082860386
model parameter : 610178
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.4573088
	speed: 0.0828s/iter; left time: 3045.3200s
	iters: 200, epoch: 1 | loss: 1.0849805
	speed: 0.0632s/iter; left time: 2318.4277s
	iters: 300, epoch: 1 | loss: 0.7493566
	speed: 0.0600s/iter; left time: 2195.2955s
Epoch: 1 cost time: 25.028220891952515
Epoch: 1, Steps: 369 | Train Loss: 1.376 Vali Loss: 0.951 Vali Acc: 0.655 Test Loss: 0.951 Test Acc: 0.655
Validation loss decreased (inf --> -0.654644).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0486763
	speed: 0.2674s/iter; left time: 9743.3706s
	iters: 200, epoch: 2 | loss: 0.6994399
	speed: 0.0610s/iter; left time: 2215.2734s
	iters: 300, epoch: 2 | loss: 2.1383424
	speed: 0.0596s/iter; left time: 2159.3528s
Epoch: 2 cost time: 23.167484283447266
Epoch: 2, Steps: 369 | Train Loss: 1.938 Vali Loss: 2.055 Vali Acc: 0.656 Test Loss: 2.055 Test Acc: 0.656
Validation loss decreased (-0.654644 --> -0.656052).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6132503
	speed: 0.2663s/iter; left time: 9603.3592s
	iters: 200, epoch: 3 | loss: 4.3357515
	speed: 0.0691s/iter; left time: 2485.5466s
	iters: 300, epoch: 3 | loss: 6.6623945
	speed: 0.0686s/iter; left time: 2458.6399s
Epoch: 3 cost time: 25.882370233535767
Epoch: 3, Steps: 369 | Train Loss: 2.729 Vali Loss: 1.969 Vali Acc: 0.661 Test Loss: 1.969 Test Acc: 0.661
Validation loss decreased (-0.656052 --> -0.661445).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.4462290
	speed: 0.2806s/iter; left time: 10016.7593s
	iters: 200, epoch: 4 | loss: 2.7434113
	speed: 0.0684s/iter; left time: 2433.5932s
	iters: 300, epoch: 4 | loss: 4.6138563
	speed: 0.0678s/iter; left time: 2407.2771s
Epoch: 4 cost time: 26.063067197799683
Epoch: 4, Steps: 369 | Train Loss: 3.291 Vali Loss: 3.385 Vali Acc: 0.639 Test Loss: 3.385 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6517905
	speed: 0.2753s/iter; left time: 9726.4886s
	iters: 200, epoch: 5 | loss: 2.7265530
	speed: 0.0631s/iter; left time: 2222.9660s
	iters: 300, epoch: 5 | loss: 2.2741425
	speed: 0.0628s/iter; left time: 2206.4674s
Epoch: 5 cost time: 24.154737949371338
Epoch: 5, Steps: 369 | Train Loss: 3.206 Vali Loss: 4.055 Vali Acc: 0.639 Test Loss: 4.055 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.7757168
	speed: 0.2726s/iter; left time: 9528.8155s
	iters: 200, epoch: 6 | loss: 4.1354451
	speed: 0.0628s/iter; left time: 2188.6260s
	iters: 300, epoch: 6 | loss: 7.7886896
	speed: 0.0624s/iter; left time: 2169.4698s
Epoch: 6 cost time: 24.124974489212036
Epoch: 6, Steps: 369 | Train Loss: 3.411 Vali Loss: 5.264 Vali Acc: 0.632 Test Loss: 5.264 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 7.3560381
	speed: 0.2775s/iter; left time: 9599.1582s
	iters: 200, epoch: 7 | loss: 6.7069435
	speed: 0.0693s/iter; left time: 2390.1609s
	iters: 300, epoch: 7 | loss: 5.5159268
	speed: 0.0699s/iter; left time: 2403.4464s
Epoch: 7 cost time: 26.458526611328125
Epoch: 7, Steps: 369 | Train Loss: 3.048 Vali Loss: 3.937 Vali Acc: 0.642 Test Loss: 3.937 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 7.1655636
	speed: 0.2720s/iter; left time: 9307.8099s
	iters: 200, epoch: 8 | loss: 2.9952636
	speed: 0.0698s/iter; left time: 2380.0682s
	iters: 300, epoch: 8 | loss: 3.3928077
	speed: 0.0695s/iter; left time: 2364.1579s
Epoch: 8 cost time: 26.644593000411987
Epoch: 8, Steps: 369 | Train Loss: 2.956 Vali Loss: 3.815 Vali Acc: 0.618 Test Loss: 3.815 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.9140155
	speed: 0.2685s/iter; left time: 9088.4628s
	iters: 200, epoch: 9 | loss: 2.2016845
	speed: 0.0613s/iter; left time: 2069.4009s
	iters: 300, epoch: 9 | loss: 2.7279980
	speed: 0.0620s/iter; left time: 2087.1881s
Epoch: 9 cost time: 23.881892919540405
Epoch: 9, Steps: 369 | Train Loss: 2.630 Vali Loss: 5.312 Vali Acc: 0.619 Test Loss: 5.312 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.9239006
	speed: 0.2610s/iter; left time: 8737.2756s
	iters: 200, epoch: 10 | loss: 2.9463499
	speed: 0.0614s/iter; left time: 2048.5753s
	iters: 300, epoch: 10 | loss: 2.9620135
	speed: 0.0612s/iter; left time: 2035.3250s
Epoch: 10 cost time: 23.300023555755615
Epoch: 10, Steps: 369 | Train Loss: 2.197 Vali Loss: 5.939 Vali Acc: 0.644 Test Loss: 5.939 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.3473955
	speed: 0.2680s/iter; left time: 8872.9245s
	iters: 200, epoch: 11 | loss: 4.7456083
	speed: 0.0673s/iter; left time: 2220.9241s
	iters: 300, epoch: 11 | loss: 0.0115553
	speed: 0.0674s/iter; left time: 2218.5188s
Epoch: 11 cost time: 25.243325233459473
Epoch: 11, Steps: 369 | Train Loss: 1.837 Vali Loss: 5.457 Vali Acc: 0.638 Test Loss: 5.457 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.0849280
	speed: 0.2847s/iter; left time: 9320.3374s
	iters: 200, epoch: 12 | loss: 0.7529615
	speed: 0.0685s/iter; left time: 2235.3973s
	iters: 300, epoch: 12 | loss: 0.5222802
	speed: 0.0684s/iter; left time: 2226.9539s
Epoch: 12 cost time: 26.3626971244812
Epoch: 12, Steps: 369 | Train Loss: 1.458 Vali Loss: 4.296 Vali Acc: 0.638 Test Loss: 4.296 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.4670565
	speed: 0.2852s/iter; left time: 9231.5193s
	iters: 200, epoch: 13 | loss: 0.3697245
	speed: 0.0623s/iter; left time: 2010.4452s
	iters: 300, epoch: 13 | loss: 0.0848430
	speed: 0.0619s/iter; left time: 1991.0810s
Epoch: 13 cost time: 24.340498447418213
Epoch: 13, Steps: 369 | Train Loss: 1.232 Vali Loss: 4.102 Vali Acc: 0.623 Test Loss: 4.102 Test Acc: 0.623
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6614642451759364
model parameter : 499970
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3102624
	speed: 0.0857s/iter; left time: 3153.1498s
	iters: 200, epoch: 1 | loss: 0.9846779
	speed: 0.0595s/iter; left time: 2183.3333s
	iters: 300, epoch: 1 | loss: 2.0336664
	speed: 0.0591s/iter; left time: 2163.3568s
Epoch: 1 cost time: 24.6592698097229
Epoch: 1, Steps: 369 | Train Loss: 1.202 Vali Loss: 0.949 Vali Acc: 0.658 Test Loss: 0.949 Test Acc: 0.658
Validation loss decreased (inf --> -0.658333).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5165303
	speed: 0.2513s/iter; left time: 9153.7554s
	iters: 200, epoch: 2 | loss: 1.1786301
	speed: 0.0531s/iter; left time: 1929.4894s
	iters: 300, epoch: 2 | loss: 4.3260679
	speed: 0.0523s/iter; left time: 1894.9871s
Epoch: 2 cost time: 20.74608087539673
Epoch: 2, Steps: 369 | Train Loss: 1.707 Vali Loss: 2.491 Vali Acc: 0.652 Test Loss: 2.491 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7063897
	speed: 0.2416s/iter; left time: 8714.1553s
	iters: 200, epoch: 3 | loss: 1.5316100
	speed: 0.0518s/iter; left time: 1864.0945s
	iters: 300, epoch: 3 | loss: 3.3032067
	speed: 0.0493s/iter; left time: 1767.1864s
Epoch: 3 cost time: 19.737242221832275
Epoch: 3, Steps: 369 | Train Loss: 2.368 Vali Loss: 2.186 Vali Acc: 0.639 Test Loss: 2.186 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3680310
	speed: 0.2378s/iter; left time: 8486.9471s
	iters: 200, epoch: 4 | loss: 1.5165123
	speed: 0.0524s/iter; left time: 1865.8000s
	iters: 300, epoch: 4 | loss: 3.1052094
	speed: 0.0533s/iter; left time: 1891.6275s
Epoch: 4 cost time: 19.95940923690796
Epoch: 4, Steps: 369 | Train Loss: 2.633 Vali Loss: 3.138 Vali Acc: 0.641 Test Loss: 3.138 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.1673656
	speed: 0.2440s/iter; left time: 8620.4128s
	iters: 200, epoch: 5 | loss: 3.8763502
	speed: 0.0583s/iter; left time: 2052.9155s
	iters: 300, epoch: 5 | loss: 2.6474385
	speed: 0.0582s/iter; left time: 2045.6675s
Epoch: 5 cost time: 22.3856463432312
Epoch: 5, Steps: 369 | Train Loss: 2.697 Vali Loss: 5.789 Vali Acc: 0.630 Test Loss: 5.789 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.4376628
	speed: 0.2593s/iter; left time: 9065.3735s
	iters: 200, epoch: 6 | loss: 3.1837702
	speed: 0.0595s/iter; left time: 2074.4664s
	iters: 300, epoch: 6 | loss: 0.6163741
	speed: 0.0584s/iter; left time: 2030.3956s
Epoch: 6 cost time: 22.366652250289917
Epoch: 6, Steps: 369 | Train Loss: 2.619 Vali Loss: 4.792 Vali Acc: 0.626 Test Loss: 4.792 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.0633106
	speed: 0.2573s/iter; left time: 8898.0537s
	iters: 200, epoch: 7 | loss: 2.4006746
	speed: 0.0529s/iter; left time: 1825.4439s
	iters: 300, epoch: 7 | loss: 3.1077709
	speed: 0.0524s/iter; left time: 1801.8700s
Epoch: 7 cost time: 19.84502625465393
Epoch: 7, Steps: 369 | Train Loss: 2.602 Vali Loss: 4.782 Vali Acc: 0.618 Test Loss: 4.782 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1534315
	speed: 0.2477s/iter; left time: 8476.4088s
	iters: 200, epoch: 8 | loss: 1.4090109
	speed: 0.0497s/iter; left time: 1694.3586s
	iters: 300, epoch: 8 | loss: 1.3354172
	speed: 0.0492s/iter; left time: 1672.2069s
Epoch: 8 cost time: 19.545039415359497
Epoch: 8, Steps: 369 | Train Loss: 2.410 Vali Loss: 5.879 Vali Acc: 0.610 Test Loss: 5.879 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.3712146
	speed: 0.2619s/iter; left time: 8863.7895s
	iters: 200, epoch: 9 | loss: 1.6152604
	speed: 0.0567s/iter; left time: 1913.3562s
	iters: 300, epoch: 9 | loss: 4.8023777
	speed: 0.0571s/iter; left time: 1922.4958s
Epoch: 9 cost time: 21.982404232025146
Epoch: 9, Steps: 369 | Train Loss: 2.049 Vali Loss: 4.981 Vali Acc: 0.640 Test Loss: 4.981 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.0335789
	speed: 0.2499s/iter; left time: 8366.6113s
	iters: 200, epoch: 10 | loss: 0.0048681
	speed: 0.0582s/iter; left time: 1943.3948s
	iters: 300, epoch: 10 | loss: 1.3354824
	speed: 0.0585s/iter; left time: 1946.0479s
Epoch: 10 cost time: 22.409385681152344
Epoch: 10, Steps: 369 | Train Loss: 1.943 Vali Loss: 5.002 Vali Acc: 0.640 Test Loss: 5.002 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.0310407
	speed: 0.2536s/iter; left time: 8398.3517s
	iters: 200, epoch: 11 | loss: 2.2796764
	speed: 0.0507s/iter; left time: 1672.6969s
	iters: 300, epoch: 11 | loss: 1.3982280
	speed: 0.0509s/iter; left time: 1675.8196s
Epoch: 11 cost time: 19.819766759872437
Epoch: 11, Steps: 369 | Train Loss: 1.566 Vali Loss: 5.457 Vali Acc: 0.645 Test Loss: 5.457 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6583427922814983
model parameter : 426626
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7684413
	speed: 0.3485s/iter; left time: 12824.8039s
	iters: 200, epoch: 1 | loss: 2.7210774
	speed: 0.3173s/iter; left time: 11644.5231s
	iters: 300, epoch: 1 | loss: 0.9899822
	speed: 0.3207s/iter; left time: 11738.2760s
Epoch: 1 cost time: 119.38021278381348
Epoch: 1, Steps: 369 | Train Loss: 2.571 Vali Loss: 1.430 Vali Acc: 0.656 Test Loss: 1.430 Test Acc: 0.656
Validation loss decreased (inf --> -0.656342).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.2111416
	speed: 0.9244s/iter; left time: 33676.6203s
	iters: 200, epoch: 2 | loss: 5.8450055
	speed: 0.3269s/iter; left time: 11878.2293s
	iters: 300, epoch: 2 | loss: 2.9845884
	speed: 0.3331s/iter; left time: 12070.1142s
Epoch: 2 cost time: 118.99313116073608
Epoch: 2, Steps: 369 | Train Loss: 3.507 Vali Loss: 2.966 Vali Acc: 0.634 Test Loss: 2.966 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.5814724
	speed: 1.0581s/iter; left time: 38159.4597s
	iters: 200, epoch: 3 | loss: 0.6710719
	speed: 0.3381s/iter; left time: 12160.0008s
	iters: 300, epoch: 3 | loss: 4.8488030
	speed: 0.3300s/iter; left time: 11835.9212s
Epoch: 3 cost time: 123.29484391212463
Epoch: 3, Steps: 369 | Train Loss: 4.595 Vali Loss: 5.007 Vali Acc: 0.640 Test Loss: 5.007 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3071189
	speed: 1.0468s/iter; left time: 37365.2102s
	iters: 200, epoch: 4 | loss: 8.5355282
	speed: 0.3158s/iter; left time: 11241.5696s
	iters: 300, epoch: 4 | loss: 9.7800941
	speed: 0.3351s/iter; left time: 11894.6721s
Epoch: 4 cost time: 120.06200528144836
Epoch: 4, Steps: 369 | Train Loss: 5.389 Vali Loss: 7.724 Vali Acc: 0.640 Test Loss: 7.724 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 5.6534882
	speed: 1.0279s/iter; left time: 36312.3329s
	iters: 200, epoch: 5 | loss: 4.1850576
	speed: 0.2994s/iter; left time: 10545.6587s
	iters: 300, epoch: 5 | loss: 7.3905573
	speed: 0.3159s/iter; left time: 11097.1351s
Epoch: 5 cost time: 117.01989507675171
Epoch: 5, Steps: 369 | Train Loss: 5.095 Vali Loss: 10.808 Vali Acc: 0.638 Test Loss: 10.808 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 5.7674489
	speed: 0.9835s/iter; left time: 34379.8834s
	iters: 200, epoch: 6 | loss: 2.8844755
	speed: 0.3166s/iter; left time: 11034.5334s
	iters: 300, epoch: 6 | loss: 1.7511170
	speed: 0.2739s/iter; left time: 9519.8113s
Epoch: 6 cost time: 113.85039639472961
Epoch: 6, Steps: 369 | Train Loss: 4.547 Vali Loss: 14.123 Vali Acc: 0.627 Test Loss: 14.123 Test Acc: 0.627
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 5.3764372
	speed: 0.9653s/iter; left time: 33388.4586s
	iters: 200, epoch: 7 | loss: 2.3349724
	speed: 0.3200s/iter; left time: 11037.2097s
	iters: 300, epoch: 7 | loss: 2.1561890
	speed: 0.3302s/iter; left time: 11355.6204s
Epoch: 7 cost time: 118.9169762134552
Epoch: 7, Steps: 369 | Train Loss: 3.388 Vali Loss: 12.734 Vali Acc: 0.627 Test Loss: 12.734 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.7256503
	speed: 0.9872s/iter; left time: 33780.1104s
	iters: 200, epoch: 8 | loss: 7.3658934
	speed: 0.3284s/iter; left time: 11205.8079s
	iters: 300, epoch: 8 | loss: 0.7396708
	speed: 0.3146s/iter; left time: 10701.2568s
Epoch: 8 cost time: 119.31276178359985
Epoch: 8, Steps: 369 | Train Loss: 2.670 Vali Loss: 10.064 Vali Acc: 0.629 Test Loss: 10.064 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 3.2120993
	speed: 1.0317s/iter; left time: 34921.2109s
	iters: 200, epoch: 9 | loss: 2.1028674
	speed: 0.3216s/iter; left time: 10852.1866s
	iters: 300, epoch: 9 | loss: 3.2832744
	speed: 0.3085s/iter; left time: 10381.5350s
Epoch: 9 cost time: 121.55928373336792
Epoch: 9, Steps: 369 | Train Loss: 1.938 Vali Loss: 6.280 Vali Acc: 0.644 Test Loss: 6.280 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.1113535
	speed: 1.0358s/iter; left time: 34678.1872s
	iters: 200, epoch: 10 | loss: 1.3965924
	speed: 0.3391s/iter; left time: 11320.0931s
	iters: 300, epoch: 10 | loss: 0.8673946
	speed: 0.3399s/iter; left time: 11313.1962s
Epoch: 10 cost time: 125.40259838104248
Epoch: 10, Steps: 369 | Train Loss: 1.127 Vali Loss: 8.132 Vali Acc: 0.623 Test Loss: 8.132 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.4267915
	speed: 1.0487s/iter; left time: 34722.8584s
	iters: 200, epoch: 11 | loss: 1.3081061
	speed: 0.3420s/iter; left time: 11289.9405s
	iters: 300, epoch: 11 | loss: 0.5721810
	speed: 0.3369s/iter; left time: 11087.4102s
Epoch: 11 cost time: 125.72766661643982
Epoch: 11, Steps: 369 | Train Loss: 0.740 Vali Loss: 7.103 Vali Acc: 0.637 Test Loss: 7.103 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6563564131668559
model parameter : 1243010
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4795018
	speed: 0.1638s/iter; left time: 6028.5897s
	iters: 200, epoch: 1 | loss: 1.4641390
	speed: 0.1541s/iter; left time: 5655.4063s
	iters: 300, epoch: 1 | loss: 2.0922990
	speed: 0.1449s/iter; left time: 5303.5242s
Epoch: 1 cost time: 57.06243658065796
Epoch: 1, Steps: 369 | Train Loss: 1.941 Vali Loss: 1.914 Vali Acc: 0.617 Test Loss: 1.914 Test Acc: 0.617
Validation loss decreased (inf --> -0.617461).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7258018
	speed: 4.6298s/iter; left time: 168671.5888s
	iters: 200, epoch: 2 | loss: 1.2537841
	speed: 0.1444s/iter; left time: 5245.1068s
	iters: 300, epoch: 2 | loss: 2.4954262
	speed: 0.1462s/iter; left time: 5296.8784s
Epoch: 2 cost time: 53.264949798583984
Epoch: 2, Steps: 369 | Train Loss: 2.272 Vali Loss: 2.103 Vali Acc: 0.657 Test Loss: 2.103 Test Acc: 0.657
Validation loss decreased (-0.617461 --> -0.656619).  Saving model ...
	iters: 100, epoch: 3 | loss: 7.8550081
	speed: 1.6453s/iter; left time: 59335.5992s
	iters: 200, epoch: 3 | loss: 4.1115417
	speed: 0.1294s/iter; left time: 4652.3790s
	iters: 300, epoch: 3 | loss: 3.9523392
	speed: 0.1309s/iter; left time: 4694.1240s
Epoch: 3 cost time: 48.802375078201294
Epoch: 3, Steps: 369 | Train Loss: 3.226 Vali Loss: 4.687 Vali Acc: 0.648 Test Loss: 4.687 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.5667090
	speed: 0.4611s/iter; left time: 16456.7937s
	iters: 200, epoch: 4 | loss: 3.9385977
	speed: 0.1409s/iter; left time: 5015.8958s
	iters: 300, epoch: 4 | loss: 1.9902992
	speed: 0.1405s/iter; left time: 4987.2942s
Epoch: 4 cost time: 51.578896284103394
Epoch: 4, Steps: 369 | Train Loss: 3.720 Vali Loss: 3.265 Vali Acc: 0.654 Test Loss: 3.265 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.4421577
	speed: 0.4193s/iter; left time: 14813.2402s
	iters: 200, epoch: 5 | loss: 1.2671680
	speed: 0.1455s/iter; left time: 5126.5405s
	iters: 300, epoch: 5 | loss: 3.6575732
	speed: 0.1413s/iter; left time: 4963.9812s
Epoch: 5 cost time: 51.87381601333618
Epoch: 5, Steps: 369 | Train Loss: 3.605 Vali Loss: 6.035 Vali Acc: 0.650 Test Loss: 6.035 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5103693
	speed: 0.4862s/iter; left time: 16994.0235s
	iters: 200, epoch: 6 | loss: 4.2120442
	speed: 0.1431s/iter; left time: 4986.9932s
	iters: 300, epoch: 6 | loss: 5.6448059
	speed: 0.1460s/iter; left time: 5074.3611s
Epoch: 6 cost time: 53.73853802680969
Epoch: 6, Steps: 369 | Train Loss: 3.236 Vali Loss: 6.236 Vali Acc: 0.622 Test Loss: 6.236 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9332500
	speed: 0.4559s/iter; left time: 15766.6318s
	iters: 200, epoch: 7 | loss: 2.3416636
	speed: 0.1378s/iter; left time: 4752.0413s
	iters: 300, epoch: 7 | loss: 2.9092076
	speed: 0.1418s/iter; left time: 4877.5054s
Epoch: 7 cost time: 49.61654591560364
Epoch: 7, Steps: 369 | Train Loss: 2.778 Vali Loss: 6.280 Vali Acc: 0.642 Test Loss: 6.280 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.5872092
	speed: 0.4829s/iter; left time: 16524.9079s
	iters: 200, epoch: 8 | loss: 0.5421535
	speed: 0.1423s/iter; left time: 4854.2674s
	iters: 300, epoch: 8 | loss: 2.2734199
	speed: 0.1432s/iter; left time: 4870.0835s
Epoch: 8 cost time: 53.37324833869934
Epoch: 8, Steps: 369 | Train Loss: 2.051 Vali Loss: 4.214 Vali Acc: 0.638 Test Loss: 4.214 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 4.6122942
	speed: 0.4869s/iter; left time: 16481.0136s
	iters: 200, epoch: 9 | loss: 2.8923864
	speed: 0.1441s/iter; left time: 4864.5987s
	iters: 300, epoch: 9 | loss: 3.7247636
	speed: 0.1435s/iter; left time: 4828.0782s
Epoch: 9 cost time: 53.5234477519989
Epoch: 9, Steps: 369 | Train Loss: 1.483 Vali Loss: 4.514 Vali Acc: 0.638 Test Loss: 4.514 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.2307172
	speed: 0.4772s/iter; left time: 15976.5485s
	iters: 200, epoch: 10 | loss: 0.5508097
	speed: 0.1406s/iter; left time: 4692.5908s
	iters: 300, epoch: 10 | loss: 2.7196369
	speed: 0.1429s/iter; left time: 4756.1003s
Epoch: 10 cost time: 52.84004211425781
Epoch: 10, Steps: 369 | Train Loss: 0.969 Vali Loss: 3.683 Vali Acc: 0.619 Test Loss: 3.683 Test Acc: 0.619
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6214210
	speed: 0.4832s/iter; left time: 15997.6107s
	iters: 200, epoch: 11 | loss: 0.0320961
	speed: 0.1438s/iter; left time: 4747.1437s
	iters: 300, epoch: 11 | loss: 0.1159534
	speed: 0.1387s/iter; left time: 4566.2113s
Epoch: 11 cost time: 52.941532135009766
Epoch: 11, Steps: 369 | Train Loss: 0.560 Vali Loss: 2.668 Vali Acc: 0.644 Test Loss: 2.668 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.3404647
	speed: 0.4761s/iter; left time: 15588.6283s
	iters: 200, epoch: 12 | loss: 0.3506768
	speed: 0.1364s/iter; left time: 4453.3386s
	iters: 300, epoch: 12 | loss: 0.0051311
	speed: 0.1449s/iter; left time: 4714.4044s
Epoch: 12 cost time: 52.15823984146118
Epoch: 12, Steps: 369 | Train Loss: 0.288 Vali Loss: 2.133 Vali Acc: 0.647 Test Loss: 2.133 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6566401816118048
model parameter : 671746
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3284316
	speed: 0.0939s/iter; left time: 3455.9622s
	iters: 200, epoch: 1 | loss: 1.2848688
	speed: 0.0811s/iter; left time: 2977.8388s
	iters: 300, epoch: 1 | loss: 0.5248488
	speed: 0.0804s/iter; left time: 2944.2691s
Epoch: 1 cost time: 31.1900794506073
Epoch: 1, Steps: 369 | Train Loss: 1.477 Vali Loss: 1.323 Vali Acc: 0.635 Test Loss: 1.323 Test Acc: 0.635
Validation loss decreased (inf --> -0.635061).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7505547
	speed: 0.2785s/iter; left time: 10147.0464s
	iters: 200, epoch: 2 | loss: 0.6112626
	speed: 0.0799s/iter; left time: 2903.1467s
	iters: 300, epoch: 2 | loss: 3.6251171
	speed: 0.0808s/iter; left time: 2926.8873s
Epoch: 2 cost time: 30.299038648605347
Epoch: 2, Steps: 369 | Train Loss: 1.919 Vali Loss: 1.856 Vali Acc: 0.636 Test Loss: 1.856 Test Acc: 0.636
Validation loss decreased (-0.635061 --> -0.636474).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8589293
	speed: 0.4326s/iter; left time: 15601.4576s
	iters: 200, epoch: 3 | loss: 0.5529136
	speed: 0.1606s/iter; left time: 5774.5493s
	iters: 300, epoch: 3 | loss: 3.2155573
	speed: 0.1634s/iter; left time: 5860.4558s
Epoch: 3 cost time: 54.59843993186951
Epoch: 3, Steps: 369 | Train Loss: 2.709 Vali Loss: 3.431 Vali Acc: 0.647 Test Loss: 3.431 Test Acc: 0.647
Validation loss decreased (-0.636474 --> -0.646674).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3257080
	speed: 1.0066s/iter; left time: 35928.0354s
	iters: 200, epoch: 4 | loss: 2.9637890
	speed: 0.1742s/iter; left time: 6201.7483s
	iters: 300, epoch: 4 | loss: 5.7864733
	speed: 0.1607s/iter; left time: 5703.3154s
Epoch: 4 cost time: 62.287187576293945
Epoch: 4, Steps: 369 | Train Loss: 3.057 Vali Loss: 4.193 Vali Acc: 0.631 Test Loss: 4.193 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2567410
	speed: 0.5509s/iter; left time: 19460.9070s
	iters: 200, epoch: 5 | loss: 0.8447139
	speed: 0.1535s/iter; left time: 5406.3378s
	iters: 300, epoch: 5 | loss: 4.2584696
	speed: 0.1581s/iter; left time: 5553.0078s
Epoch: 5 cost time: 58.388176918029785
Epoch: 5, Steps: 369 | Train Loss: 2.706 Vali Loss: 4.172 Vali Acc: 0.641 Test Loss: 4.172 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7082323
	speed: 0.5412s/iter; left time: 18917.6119s
	iters: 200, epoch: 6 | loss: 3.3413379
	speed: 0.1706s/iter; left time: 5945.3625s
	iters: 300, epoch: 6 | loss: 4.5242677
	speed: 0.1777s/iter; left time: 6176.2315s
Epoch: 6 cost time: 62.839365005493164
Epoch: 6, Steps: 369 | Train Loss: 2.574 Vali Loss: 5.471 Vali Acc: 0.631 Test Loss: 5.471 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 4.8445239
	speed: 0.6662s/iter; left time: 23042.6752s
	iters: 200, epoch: 7 | loss: 2.3701663
	speed: 0.1839s/iter; left time: 6342.2904s
	iters: 300, epoch: 7 | loss: 4.7130914
	speed: 0.1845s/iter; left time: 6345.5767s
Epoch: 7 cost time: 68.81466150283813
Epoch: 7, Steps: 369 | Train Loss: 2.133 Vali Loss: 5.612 Vali Acc: 0.631 Test Loss: 5.612 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2807589
	speed: 0.6569s/iter; left time: 22476.9884s
	iters: 200, epoch: 8 | loss: 1.1323950
	speed: 0.1527s/iter; left time: 5209.8355s
	iters: 300, epoch: 8 | loss: 1.5887721
	speed: 0.1536s/iter; left time: 5224.3628s
Epoch: 8 cost time: 59.06268763542175
Epoch: 8, Steps: 369 | Train Loss: 1.715 Vali Loss: 5.155 Vali Acc: 0.639 Test Loss: 5.155 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.9679269
	speed: 0.5457s/iter; left time: 18471.4709s
	iters: 200, epoch: 9 | loss: 1.4792668
	speed: 0.1380s/iter; left time: 4659.0026s
	iters: 300, epoch: 9 | loss: 0.0005449
	speed: 0.1386s/iter; left time: 4662.5507s
Epoch: 9 cost time: 51.51820087432861
Epoch: 9, Steps: 369 | Train Loss: 1.191 Vali Loss: 4.702 Vali Acc: 0.648 Test Loss: 4.702 Test Acc: 0.648
Validation loss decreased (-0.646674 --> -0.648364).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4067630
	speed: 0.5388s/iter; left time: 18040.3827s
	iters: 200, epoch: 10 | loss: 0.0567362
	speed: 0.1711s/iter; left time: 5712.2444s
	iters: 300, epoch: 10 | loss: 0.1351556
	speed: 0.1736s/iter; left time: 5778.1099s
Epoch: 10 cost time: 61.62039136886597
Epoch: 10, Steps: 369 | Train Loss: 0.793 Vali Loss: 3.652 Vali Acc: 0.634 Test Loss: 3.652 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7614108
	speed: 0.6457s/iter; left time: 21381.4131s
	iters: 200, epoch: 11 | loss: 0.0098236
	speed: 0.1766s/iter; left time: 5828.5100s
	iters: 300, epoch: 11 | loss: 0.0852084
	speed: 0.1777s/iter; left time: 5847.8987s
Epoch: 11 cost time: 66.14903426170349
Epoch: 11, Steps: 369 | Train Loss: 0.440 Vali Loss: 3.285 Vali Acc: 0.626 Test Loss: 3.285 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4148514
	speed: 0.6331s/iter; left time: 20727.6180s
	iters: 200, epoch: 12 | loss: 0.1463561
	speed: 0.1528s/iter; left time: 4986.3622s
	iters: 300, epoch: 12 | loss: 0.0110082
	speed: 0.1527s/iter; left time: 4969.4135s
Epoch: 12 cost time: 57.620667457580566
Epoch: 12, Steps: 369 | Train Loss: 0.238 Vali Loss: 2.071 Vali Acc: 0.638 Test Loss: 2.071 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1583201
	speed: 0.5625s/iter; left time: 18209.2085s
	iters: 200, epoch: 13 | loss: 0.0634114
	speed: 0.1461s/iter; left time: 4715.8344s
	iters: 300, epoch: 13 | loss: 0.4078129
	speed: 0.1457s/iter; left time: 4687.9088s
Epoch: 13 cost time: 55.45985770225525
Epoch: 13, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.988 Vali Acc: 0.640 Test Loss: 1.988 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1040942
	speed: 0.5731s/iter; left time: 18342.9284s
	iters: 200, epoch: 14 | loss: 0.2565666
	speed: 0.1755s/iter; left time: 5599.9190s
	iters: 300, epoch: 14 | loss: 0.0153013
	speed: 0.1762s/iter; left time: 5603.5474s
Epoch: 14 cost time: 63.82048773765564
Epoch: 14, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.195 Vali Acc: 0.630 Test Loss: 2.195 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0389722
	speed: 0.6590s/iter; left time: 20847.7835s
	iters: 200, epoch: 15 | loss: 0.0165698
	speed: 0.1813s/iter; left time: 5718.6059s
	iters: 300, epoch: 15 | loss: 0.0472859
	speed: 0.1853s/iter; left time: 5825.2041s
Epoch: 15 cost time: 68.22291231155396
Epoch: 15, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.263 Vali Acc: 0.627 Test Loss: 2.263 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0055350
	speed: 0.6364s/iter; left time: 19897.5108s
	iters: 200, epoch: 16 | loss: 0.1131741
	speed: 0.1536s/iter; left time: 4787.3941s
	iters: 300, epoch: 16 | loss: 0.0235442
	speed: 0.1544s/iter; left time: 4795.1514s
Epoch: 16 cost time: 57.13570976257324
Epoch: 16, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.304 Vali Acc: 0.645 Test Loss: 2.304 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0860207
	speed: 0.5681s/iter; left time: 17551.0467s
	iters: 200, epoch: 17 | loss: 0.0085031
	speed: 0.1495s/iter; left time: 4605.1803s
	iters: 300, epoch: 17 | loss: 0.0045026
	speed: 0.1468s/iter; left time: 4505.9540s
Epoch: 17 cost time: 56.01717185974121
Epoch: 17, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.378 Vali Acc: 0.650 Test Loss: 2.378 Test Acc: 0.650
Validation loss decreased (-0.648364 --> -0.650090).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1155211
	speed: 0.5859s/iter; left time: 17886.8866s
	iters: 200, epoch: 18 | loss: 0.0031158
	speed: 0.1710s/iter; left time: 5203.2102s
	iters: 300, epoch: 18 | loss: 0.1076987
	speed: 0.1717s/iter; left time: 5207.5729s
Epoch: 18 cost time: 65.0322859287262
Epoch: 18, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.333 Vali Acc: 0.640 Test Loss: 2.333 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0101894
	speed: 0.6342s/iter; left time: 19126.8518s
	iters: 200, epoch: 19 | loss: 0.0745339
	speed: 0.1730s/iter; left time: 5200.8051s
	iters: 300, epoch: 19 | loss: 0.0110552
	speed: 0.1752s/iter; left time: 5249.1588s
Epoch: 19 cost time: 65.16566348075867
Epoch: 19, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.407 Vali Acc: 0.634 Test Loss: 2.407 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0267601
	speed: 0.6106s/iter; left time: 18188.4271s
	iters: 200, epoch: 20 | loss: 0.1358782
	speed: 0.1484s/iter; left time: 4407.1574s
	iters: 300, epoch: 20 | loss: 0.3109543
	speed: 0.1527s/iter; left time: 4519.0393s
Epoch: 20 cost time: 55.929927349090576
Epoch: 20, Steps: 369 | Train Loss: 0.074 Vali Loss: 2.343 Vali Acc: 0.623 Test Loss: 2.343 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0027064
	speed: 0.5679s/iter; left time: 16707.9522s
	iters: 200, epoch: 21 | loss: 0.0822420
	speed: 0.1551s/iter; left time: 4548.5900s
	iters: 300, epoch: 21 | loss: 0.0082242
	speed: 0.1492s/iter; left time: 4360.9416s
Epoch: 21 cost time: 57.42139530181885
Epoch: 21, Steps: 369 | Train Loss: 0.051 Vali Loss: 2.391 Vali Acc: 0.634 Test Loss: 2.391 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0354969
	speed: 0.5817s/iter; left time: 16898.3084s
	iters: 200, epoch: 22 | loss: 0.0033182
	speed: 0.1721s/iter; left time: 4982.9404s
	iters: 300, epoch: 22 | loss: 0.0072395
	speed: 0.1708s/iter; left time: 4927.8897s
Epoch: 22 cost time: 64.5015823841095
Epoch: 22, Steps: 369 | Train Loss: 0.045 Vali Loss: 2.461 Vali Acc: 0.629 Test Loss: 2.461 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0266209
	speed: 0.6387s/iter; left time: 18319.5004s
	iters: 200, epoch: 23 | loss: 0.0371668
	speed: 0.1767s/iter; left time: 5050.8527s
	iters: 300, epoch: 23 | loss: 0.0243410
	speed: 0.1783s/iter; left time: 5078.4303s
Epoch: 23 cost time: 66.3772804737091
Epoch: 23, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.554 Vali Acc: 0.638 Test Loss: 2.554 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0003771
	speed: 0.6069s/iter; left time: 17184.4729s
	iters: 200, epoch: 24 | loss: 0.0419006
	speed: 0.1465s/iter; left time: 4132.5070s
	iters: 300, epoch: 24 | loss: 0.0000713
	speed: 0.1482s/iter; left time: 4167.7372s
Epoch: 24 cost time: 56.08155870437622
Epoch: 24, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.623 Vali Acc: 0.634 Test Loss: 2.623 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0163738
	speed: 0.5584s/iter; left time: 15605.7264s
	iters: 200, epoch: 25 | loss: 0.0004667
	speed: 0.1520s/iter; left time: 4233.1167s
	iters: 300, epoch: 25 | loss: 0.0012394
	speed: 0.1504s/iter; left time: 4173.5857s
Epoch: 25 cost time: 56.98498868942261
Epoch: 25, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.683 Vali Acc: 0.644 Test Loss: 2.683 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0202233
	speed: 0.6077s/iter; left time: 16758.5310s
	iters: 200, epoch: 26 | loss: 0.0066716
	speed: 0.1830s/iter; left time: 5028.8916s
	iters: 300, epoch: 26 | loss: 0.0201246
	speed: 0.1822s/iter; left time: 4987.0659s
Epoch: 26 cost time: 68.42844939231873
Epoch: 26, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.801 Vali Acc: 0.644 Test Loss: 2.801 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0153104
	speed: 0.6606s/iter; left time: 17973.1130s
	iters: 200, epoch: 27 | loss: 0.0058750
	speed: 0.1799s/iter; left time: 4877.5925s
	iters: 300, epoch: 27 | loss: 0.1626876
	speed: 0.1830s/iter; left time: 4941.2921s
Epoch: 27 cost time: 67.57746076583862
Epoch: 27, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.903 Vali Acc: 0.641 Test Loss: 2.903 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6501135073779796
model parameter : 487490
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7622467
	speed: 0.1336s/iter; left time: 4915.6001s
	iters: 200, epoch: 1 | loss: 1.9746166
	speed: 0.1041s/iter; left time: 3819.3635s
	iters: 300, epoch: 1 | loss: 1.2706815
	speed: 0.1041s/iter; left time: 3808.6978s
Epoch: 1 cost time: 41.641804218292236
Epoch: 1, Steps: 369 | Train Loss: 1.247 Vali Loss: 0.897 Vali Acc: 0.654 Test Loss: 0.897 Test Acc: 0.654
Validation loss decreased (inf --> -0.653794).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1505057
	speed: 0.4331s/iter; left time: 15777.1585s
	iters: 200, epoch: 2 | loss: 2.2131953
	speed: 0.1297s/iter; left time: 4711.0365s
	iters: 300, epoch: 2 | loss: 3.8398204
	speed: 0.1297s/iter; left time: 4699.7755s
Epoch: 2 cost time: 48.55988168716431
Epoch: 2, Steps: 369 | Train Loss: 1.552 Vali Loss: 2.152 Vali Acc: 0.642 Test Loss: 2.152 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5870326
	speed: 0.4852s/iter; left time: 17496.3436s
	iters: 200, epoch: 3 | loss: 2.0150871
	speed: 0.1309s/iter; left time: 4706.5574s
	iters: 300, epoch: 3 | loss: 3.4047003
	speed: 0.1320s/iter; left time: 4733.0770s
Epoch: 3 cost time: 49.1938681602478
Epoch: 3, Steps: 369 | Train Loss: 2.181 Vali Loss: 3.197 Vali Acc: 0.656 Test Loss: 3.197 Test Acc: 0.656
Validation loss decreased (-0.653794 --> -0.655473).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0862463
	speed: 0.4954s/iter; left time: 17681.5492s
	iters: 200, epoch: 4 | loss: 1.1207546
	speed: 0.1325s/iter; left time: 4716.2370s
	iters: 300, epoch: 4 | loss: 2.2634239
	speed: 0.1122s/iter; left time: 3981.1685s
Epoch: 4 cost time: 45.994993925094604
Epoch: 4, Steps: 369 | Train Loss: 2.523 Vali Loss: 2.327 Vali Acc: 0.657 Test Loss: 2.327 Test Acc: 0.657
Validation loss decreased (-0.655473 --> -0.656617).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1488091
	speed: 0.4166s/iter; left time: 14715.8889s
	iters: 200, epoch: 5 | loss: 3.6728475
	speed: 0.1063s/iter; left time: 3744.4057s
	iters: 300, epoch: 5 | loss: 4.0960984
	speed: 0.1054s/iter; left time: 3701.9719s
Epoch: 5 cost time: 40.555880308151245
Epoch: 5, Steps: 369 | Train Loss: 2.468 Vali Loss: 4.768 Vali Acc: 0.636 Test Loss: 4.768 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9281535
	speed: 0.4009s/iter; left time: 14013.1475s
	iters: 200, epoch: 6 | loss: 2.0662253
	speed: 0.1038s/iter; left time: 3618.3455s
	iters: 300, epoch: 6 | loss: 1.5106906
	speed: 0.1038s/iter; left time: 3605.9524s
Epoch: 6 cost time: 39.631072998046875
Epoch: 6, Steps: 369 | Train Loss: 2.234 Vali Loss: 3.819 Vali Acc: 0.655 Test Loss: 3.819 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1515414
	speed: 0.4213s/iter; left time: 14571.9653s
	iters: 200, epoch: 7 | loss: 0.2980560
	speed: 0.1309s/iter; left time: 4513.4085s
	iters: 300, epoch: 7 | loss: 3.9409723
	speed: 0.1309s/iter; left time: 4502.6147s
Epoch: 7 cost time: 49.61251711845398
Epoch: 7, Steps: 369 | Train Loss: 1.933 Vali Loss: 3.644 Vali Acc: 0.635 Test Loss: 3.644 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0125751
	speed: 0.4862s/iter; left time: 16637.7344s
	iters: 200, epoch: 8 | loss: 1.6529059
	speed: 0.1312s/iter; left time: 4476.7447s
	iters: 300, epoch: 8 | loss: 3.9724648
	speed: 0.1322s/iter; left time: 4497.3835s
Epoch: 8 cost time: 49.52552771568298
Epoch: 8, Steps: 369 | Train Loss: 1.496 Vali Loss: 4.370 Vali Acc: 0.647 Test Loss: 4.370 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.3454115
	speed: 0.4937s/iter; left time: 16710.9182s
	iters: 200, epoch: 9 | loss: 0.6059434
	speed: 0.1336s/iter; left time: 4510.3334s
	iters: 300, epoch: 9 | loss: 0.9512485
	speed: 0.1322s/iter; left time: 4446.7866s
Epoch: 9 cost time: 48.11597919464111
Epoch: 9, Steps: 369 | Train Loss: 1.085 Vali Loss: 3.266 Vali Acc: 0.648 Test Loss: 3.266 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0035325
	speed: 0.4164s/iter; left time: 13942.2532s
	iters: 200, epoch: 10 | loss: 0.5355961
	speed: 0.1104s/iter; left time: 3685.5256s
	iters: 300, epoch: 10 | loss: 0.0227917
	speed: 0.1109s/iter; left time: 3690.0634s
Epoch: 10 cost time: 41.61241960525513
Epoch: 10, Steps: 369 | Train Loss: 0.683 Vali Loss: 2.703 Vali Acc: 0.619 Test Loss: 2.703 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0515690
	speed: 0.4115s/iter; left time: 13623.8555s
	iters: 200, epoch: 11 | loss: 0.0457985
	speed: 0.1096s/iter; left time: 3617.1905s
	iters: 300, epoch: 11 | loss: 1.2704109
	speed: 0.1073s/iter; left time: 3530.1566s
Epoch: 11 cost time: 41.30878448486328
Epoch: 11, Steps: 369 | Train Loss: 0.391 Vali Loss: 2.229 Vali Acc: 0.647 Test Loss: 2.229 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6033902
	speed: 0.4051s/iter; left time: 13262.4497s
	iters: 200, epoch: 12 | loss: 0.1187677
	speed: 0.1355s/iter; left time: 4422.8106s
	iters: 300, epoch: 12 | loss: 0.0203581
	speed: 0.1351s/iter; left time: 4396.4701s
Epoch: 12 cost time: 47.83960676193237
Epoch: 12, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.918 Vali Acc: 0.640 Test Loss: 1.918 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0208180
	speed: 0.5007s/iter; left time: 16209.4876s
	iters: 200, epoch: 13 | loss: 0.0731794
	speed: 0.1355s/iter; left time: 4373.3206s
	iters: 300, epoch: 13 | loss: 0.0323498
	speed: 0.1354s/iter; left time: 4355.9025s
Epoch: 13 cost time: 50.85285949707031
Epoch: 13, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.653 Vali Acc: 0.644 Test Loss: 1.653 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0177403
	speed: 0.5035s/iter; left time: 16112.5331s
	iters: 200, epoch: 14 | loss: 0.0313653
	speed: 0.1393s/iter; left time: 4442.7162s
	iters: 300, epoch: 14 | loss: 0.0334032
	speed: 0.1405s/iter; left time: 4469.0289s
Epoch: 14 cost time: 52.21902298927307
Epoch: 14, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.969 Vali Acc: 0.640 Test Loss: 1.969 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6566401816118048
model parameter : 377026
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1837834
	speed: 0.1143s/iter; left time: 4208.1183s
	iters: 200, epoch: 1 | loss: 1.9373618
	speed: 0.0885s/iter; left time: 3249.5603s
	iters: 300, epoch: 1 | loss: 0.9156783
	speed: 0.0869s/iter; left time: 3179.2565s
Epoch: 1 cost time: 34.91491103172302
Epoch: 1, Steps: 369 | Train Loss: 1.180 Vali Loss: 0.948 Vali Acc: 0.643 Test Loss: 0.948 Test Acc: 0.643
Validation loss decreased (inf --> -0.643010).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9820382
	speed: 0.3404s/iter; left time: 12401.6201s
	iters: 200, epoch: 2 | loss: 1.3878559
	speed: 0.1074s/iter; left time: 3902.4579s
	iters: 300, epoch: 2 | loss: 0.7847717
	speed: 0.1063s/iter; left time: 3850.3139s
Epoch: 2 cost time: 38.820632219314575
Epoch: 2, Steps: 369 | Train Loss: 1.487 Vali Loss: 2.209 Vali Acc: 0.638 Test Loss: 2.209 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8351332
	speed: 0.4033s/iter; left time: 14543.9835s
	iters: 200, epoch: 3 | loss: 3.2790661
	speed: 0.1076s/iter; left time: 3868.4838s
	iters: 300, epoch: 3 | loss: 4.8936892
	speed: 0.1085s/iter; left time: 3892.2157s
Epoch: 3 cost time: 40.92380690574646
Epoch: 3, Steps: 369 | Train Loss: 1.873 Vali Loss: 2.310 Vali Acc: 0.662 Test Loss: 2.310 Test Acc: 0.662
Validation loss decreased (-0.643010 --> -0.662292).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9194622
	speed: 0.4045s/iter; left time: 14436.8784s
	iters: 200, epoch: 4 | loss: 1.3080242
	speed: 0.1092s/iter; left time: 3887.2414s
	iters: 300, epoch: 4 | loss: 3.1180167
	speed: 0.1081s/iter; left time: 3836.4634s
Epoch: 4 cost time: 40.970754623413086
Epoch: 4, Steps: 369 | Train Loss: 2.149 Vali Loss: 2.446 Vali Acc: 0.609 Test Loss: 2.446 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.5297899
	speed: 0.3999s/iter; left time: 14126.5234s
	iters: 200, epoch: 5 | loss: 2.8242793
	speed: 0.0911s/iter; left time: 3210.6992s
	iters: 300, epoch: 5 | loss: 4.3619266
	speed: 0.0913s/iter; left time: 3206.5627s
Epoch: 5 cost time: 34.78983688354492
Epoch: 5, Steps: 369 | Train Loss: 2.175 Vali Loss: 2.284 Vali Acc: 0.653 Test Loss: 2.284 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.5605175
	speed: 0.3696s/iter; left time: 12921.1394s
	iters: 200, epoch: 6 | loss: 3.1715508
	speed: 0.0976s/iter; left time: 3400.2561s
	iters: 300, epoch: 6 | loss: 1.4289094
	speed: 0.0935s/iter; left time: 3250.7821s
Epoch: 6 cost time: 35.34551501274109
Epoch: 6, Steps: 369 | Train Loss: 2.019 Vali Loss: 5.425 Vali Acc: 0.608 Test Loss: 5.425 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9567557
	speed: 0.3524s/iter; left time: 12188.1925s
	iters: 200, epoch: 7 | loss: 1.8069618
	speed: 0.0911s/iter; left time: 3143.0543s
	iters: 300, epoch: 7 | loss: 2.3018973
	speed: 0.0897s/iter; left time: 3083.0929s
Epoch: 7 cost time: 34.41578936576843
Epoch: 7, Steps: 369 | Train Loss: 1.704 Vali Loss: 4.538 Vali Acc: 0.631 Test Loss: 4.538 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.0634816
	speed: 0.3753s/iter; left time: 12843.3129s
	iters: 200, epoch: 8 | loss: 0.1293519
	speed: 0.1109s/iter; left time: 3784.0068s
	iters: 300, epoch: 8 | loss: 0.4045752
	speed: 0.1099s/iter; left time: 3737.2989s
Epoch: 8 cost time: 42.10642433166504
Epoch: 8, Steps: 369 | Train Loss: 1.276 Vali Loss: 4.794 Vali Acc: 0.644 Test Loss: 4.794 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.4409080
	speed: 0.4149s/iter; left time: 14042.6614s
	iters: 200, epoch: 9 | loss: 1.5446000
	speed: 0.1099s/iter; left time: 3710.0516s
	iters: 300, epoch: 9 | loss: 1.4072460
	speed: 0.1105s/iter; left time: 3717.1594s
Epoch: 9 cost time: 41.47666335105896
Epoch: 9, Steps: 369 | Train Loss: 0.976 Vali Loss: 3.690 Vali Acc: 0.630 Test Loss: 3.690 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0019165
	speed: 0.4151s/iter; left time: 13897.9367s
	iters: 200, epoch: 10 | loss: 1.2983946
	speed: 0.1135s/iter; left time: 3788.1812s
	iters: 300, epoch: 10 | loss: 0.3470303
	speed: 0.1159s/iter; left time: 3857.9342s
Epoch: 10 cost time: 43.03161811828613
Epoch: 10, Steps: 369 | Train Loss: 0.601 Vali Loss: 3.041 Vali Acc: 0.621 Test Loss: 3.041 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2370733
	speed: 0.3855s/iter; left time: 12763.9655s
	iters: 200, epoch: 11 | loss: 1.5028908
	speed: 0.0932s/iter; left time: 3076.9487s
	iters: 300, epoch: 11 | loss: 0.1945801
	speed: 0.0951s/iter; left time: 3130.5022s
Epoch: 11 cost time: 35.346022605895996
Epoch: 11, Steps: 369 | Train Loss: 0.376 Vali Loss: 2.442 Vali Acc: 0.633 Test Loss: 2.442 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1099570
	speed: 0.3465s/iter; left time: 11343.6748s
	iters: 200, epoch: 12 | loss: 0.1895556
	speed: 0.0879s/iter; left time: 2868.7778s
	iters: 300, epoch: 12 | loss: 0.3464209
	speed: 0.0841s/iter; left time: 2737.8547s
Epoch: 12 cost time: 33.31202697753906
Epoch: 12, Steps: 369 | Train Loss: 0.241 Vali Loss: 2.093 Vali Acc: 0.629 Test Loss: 2.093 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2291575
	speed: 0.3331s/iter; left time: 10782.4364s
	iters: 200, epoch: 13 | loss: 0.0187026
	speed: 0.0890s/iter; left time: 2873.4138s
	iters: 300, epoch: 13 | loss: 0.0740667
	speed: 0.0883s/iter; left time: 2840.6448s
Epoch: 13 cost time: 33.51800346374512
Epoch: 13, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.871 Vali Acc: 0.639 Test Loss: 1.871 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6623155505107832
model parameter : 321922
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0128218
	speed: 0.1177s/iter; left time: 4330.7950s
	iters: 200, epoch: 1 | loss: 1.9154669
	speed: 0.0954s/iter; left time: 3501.5277s
	iters: 300, epoch: 1 | loss: 0.7760718
	speed: 0.0956s/iter; left time: 3498.2254s
Epoch: 1 cost time: 37.529876947402954
Epoch: 1, Steps: 369 | Train Loss: 1.089 Vali Loss: 0.922 Vali Acc: 0.650 Test Loss: 0.922 Test Acc: 0.650
Validation loss decreased (inf --> -0.649537).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6147751
	speed: 0.3675s/iter; left time: 13388.7826s
	iters: 200, epoch: 2 | loss: 1.6245869
	speed: 0.0957s/iter; left time: 3476.9427s
	iters: 300, epoch: 2 | loss: 2.5032125
	speed: 0.0956s/iter; left time: 3462.0864s
Epoch: 2 cost time: 36.04849338531494
Epoch: 2, Steps: 369 | Train Loss: 1.238 Vali Loss: 1.718 Vali Acc: 0.656 Test Loss: 1.718 Test Acc: 0.656
Validation loss decreased (-0.649537 --> -0.655488).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9139428
	speed: 0.3475s/iter; left time: 12532.4968s
	iters: 200, epoch: 3 | loss: 0.4252802
	speed: 0.0789s/iter; left time: 2838.5326s
	iters: 300, epoch: 3 | loss: 1.9871538
	speed: 0.0798s/iter; left time: 2862.0934s
Epoch: 3 cost time: 30.272868633270264
Epoch: 3, Steps: 369 | Train Loss: 1.669 Vali Loss: 2.240 Vali Acc: 0.650 Test Loss: 2.240 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4913138
	speed: 0.3080s/iter; left time: 10993.9731s
	iters: 200, epoch: 4 | loss: 2.9346581
	speed: 0.0779s/iter; left time: 2771.7966s
	iters: 300, epoch: 4 | loss: 2.2849116
	speed: 0.0778s/iter; left time: 2759.9025s
Epoch: 4 cost time: 29.772814512252808
Epoch: 4, Steps: 369 | Train Loss: 1.784 Vali Loss: 3.515 Vali Acc: 0.629 Test Loss: 3.515 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.1223514
	speed: 0.2984s/iter; left time: 10540.5505s
	iters: 200, epoch: 5 | loss: 2.2532072
	speed: 0.0830s/iter; left time: 2922.4902s
	iters: 300, epoch: 5 | loss: 1.4094419
	speed: 0.0758s/iter; left time: 2662.7009s
Epoch: 5 cost time: 30.529493808746338
Epoch: 5, Steps: 369 | Train Loss: 1.763 Vali Loss: 2.870 Vali Acc: 0.646 Test Loss: 2.870 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0040222
	speed: 0.3085s/iter; left time: 10784.0087s
	iters: 200, epoch: 6 | loss: 0.9206717
	speed: 0.0768s/iter; left time: 2675.7211s
	iters: 300, epoch: 6 | loss: 4.2770567
	speed: 0.0952s/iter; left time: 3310.3293s
Epoch: 6 cost time: 32.63673710823059
Epoch: 6, Steps: 369 | Train Loss: 1.637 Vali Loss: 3.666 Vali Acc: 0.643 Test Loss: 3.666 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.1492333
	speed: 0.3652s/iter; left time: 12632.6303s
	iters: 200, epoch: 7 | loss: 0.6893260
	speed: 0.0964s/iter; left time: 3324.4745s
	iters: 300, epoch: 7 | loss: 1.4049516
	speed: 0.0965s/iter; left time: 3319.5597s
Epoch: 7 cost time: 36.39366936683655
Epoch: 7, Steps: 369 | Train Loss: 1.374 Vali Loss: 3.838 Vali Acc: 0.631 Test Loss: 3.838 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.3924947
	speed: 0.3618s/iter; left time: 12380.5369s
	iters: 200, epoch: 8 | loss: 1.2676845
	speed: 0.0979s/iter; left time: 3341.3563s
	iters: 300, epoch: 8 | loss: 2.2045248
	speed: 0.0984s/iter; left time: 3348.4457s
Epoch: 8 cost time: 36.74330425262451
Epoch: 8, Steps: 369 | Train Loss: 1.078 Vali Loss: 3.802 Vali Acc: 0.627 Test Loss: 3.802 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7383792
	speed: 0.3700s/iter; left time: 12525.6334s
	iters: 200, epoch: 9 | loss: 0.1846502
	speed: 0.0979s/iter; left time: 3302.9433s
	iters: 300, epoch: 9 | loss: 0.8179892
	speed: 0.0977s/iter; left time: 3286.1721s
Epoch: 9 cost time: 35.304959535598755
Epoch: 9, Steps: 369 | Train Loss: 0.822 Vali Loss: 3.323 Vali Acc: 0.651 Test Loss: 3.323 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5925361
	speed: 0.3146s/iter; left time: 10533.7601s
	iters: 200, epoch: 10 | loss: 0.0631636
	speed: 0.0780s/iter; left time: 2604.8875s
	iters: 300, epoch: 10 | loss: 0.3972506
	speed: 0.0786s/iter; left time: 2617.1472s
Epoch: 10 cost time: 30.048046350479126
Epoch: 10, Steps: 369 | Train Loss: 0.601 Vali Loss: 3.022 Vali Acc: 0.644 Test Loss: 3.022 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2531859
	speed: 0.3105s/iter; left time: 10280.3750s
	iters: 200, epoch: 11 | loss: 0.0231360
	speed: 0.0710s/iter; left time: 2344.6314s
	iters: 300, epoch: 11 | loss: 0.0012951
	speed: 0.0783s/iter; left time: 2576.8176s
Epoch: 11 cost time: 28.920868158340454
Epoch: 11, Steps: 369 | Train Loss: 0.388 Vali Loss: 2.481 Vali Acc: 0.631 Test Loss: 2.481 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2002785
	speed: 0.3135s/iter; left time: 10265.5586s
	iters: 200, epoch: 12 | loss: 0.4215688
	speed: 0.0797s/iter; left time: 2600.6036s
	iters: 300, epoch: 12 | loss: 0.3808535
	speed: 0.0770s/iter; left time: 2504.7547s
Epoch: 12 cost time: 29.943192958831787
Epoch: 12, Steps: 369 | Train Loss: 0.294 Vali Loss: 2.257 Vali Acc: 0.645 Test Loss: 2.257 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6555051078320091
model parameter : 266818
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4108843
	speed: 0.1061s/iter; left time: 3903.1478s
	iters: 200, epoch: 1 | loss: 0.8510928
	speed: 0.0800s/iter; left time: 2934.8803s
	iters: 300, epoch: 1 | loss: 1.2299182
	speed: 0.0797s/iter; left time: 2917.1142s
Epoch: 1 cost time: 32.20942807197571
Epoch: 1, Steps: 369 | Train Loss: 0.979 Vali Loss: 0.862 Vali Acc: 0.661 Test Loss: 0.862 Test Acc: 0.661
Validation loss decreased (inf --> -0.660604).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0394890
	speed: 0.3227s/iter; left time: 11755.1198s
	iters: 200, epoch: 2 | loss: 0.8124991
	speed: 0.0799s/iter; left time: 2901.6186s
	iters: 300, epoch: 2 | loss: 0.9353587
	speed: 0.0802s/iter; left time: 2904.1509s
Epoch: 2 cost time: 30.40237522125244
Epoch: 2, Steps: 369 | Train Loss: 1.101 Vali Loss: 1.503 Vali Acc: 0.672 Test Loss: 1.503 Test Acc: 0.672
Validation loss decreased (-0.660604 --> -0.671949).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0641685
	speed: 0.2920s/iter; left time: 10530.0825s
	iters: 200, epoch: 3 | loss: 1.8904691
	speed: 0.0665s/iter; left time: 2391.2554s
	iters: 300, epoch: 3 | loss: 1.0882925
	speed: 0.0640s/iter; left time: 2296.2132s
Epoch: 3 cost time: 24.74008274078369
Epoch: 3, Steps: 369 | Train Loss: 1.446 Vali Loss: 2.227 Vali Acc: 0.622 Test Loss: 2.227 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3333216
	speed: 0.2742s/iter; left time: 9788.2071s
	iters: 200, epoch: 4 | loss: 0.4136829
	speed: 0.0674s/iter; left time: 2397.8053s
	iters: 300, epoch: 4 | loss: 0.4235452
	speed: 0.0645s/iter; left time: 2289.3131s
Epoch: 4 cost time: 24.82014274597168
Epoch: 4, Steps: 369 | Train Loss: 1.544 Vali Loss: 2.555 Vali Acc: 0.640 Test Loss: 2.555 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5953512
	speed: 0.2641s/iter; left time: 9329.6312s
	iters: 200, epoch: 5 | loss: 1.7736288
	speed: 0.0640s/iter; left time: 2252.9842s
	iters: 300, epoch: 5 | loss: 2.0076392
	speed: 0.0616s/iter; left time: 2162.9939s
Epoch: 5 cost time: 24.368815422058105
Epoch: 5, Steps: 369 | Train Loss: 1.516 Vali Loss: 2.848 Vali Acc: 0.630 Test Loss: 2.848 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5874848
	speed: 0.2693s/iter; left time: 9413.3175s
	iters: 200, epoch: 6 | loss: 1.6173967
	speed: 0.0629s/iter; left time: 2193.7277s
	iters: 300, epoch: 6 | loss: 5.1716299
	speed: 0.0611s/iter; left time: 2124.1642s
Epoch: 6 cost time: 24.11417269706726
Epoch: 6, Steps: 369 | Train Loss: 1.399 Vali Loss: 3.391 Vali Acc: 0.629 Test Loss: 3.391 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1101149
	speed: 0.2992s/iter; left time: 10346.9645s
	iters: 200, epoch: 7 | loss: 0.5397384
	speed: 0.0766s/iter; left time: 2641.1334s
	iters: 300, epoch: 7 | loss: 0.5143377
	speed: 0.0771s/iter; left time: 2652.4695s
Epoch: 7 cost time: 29.525795459747314
Epoch: 7, Steps: 369 | Train Loss: 1.149 Vali Loss: 3.507 Vali Acc: 0.643 Test Loss: 3.507 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.2271161
	speed: 0.3216s/iter; left time: 11005.6357s
	iters: 200, epoch: 8 | loss: 0.0175379
	speed: 0.0775s/iter; left time: 2643.3085s
	iters: 300, epoch: 8 | loss: 0.9699289
	speed: 0.0772s/iter; left time: 2626.9585s
Epoch: 8 cost time: 29.735459089279175
Epoch: 8, Steps: 369 | Train Loss: 0.875 Vali Loss: 3.175 Vali Acc: 0.631 Test Loss: 3.175 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0039714
	speed: 0.3165s/iter; left time: 10711.6975s
	iters: 200, epoch: 9 | loss: 1.0512675
	speed: 0.0796s/iter; left time: 2685.0232s
	iters: 300, epoch: 9 | loss: 0.4171368
	speed: 0.0801s/iter; left time: 2696.1975s
Epoch: 9 cost time: 30.350268602371216
Epoch: 9, Steps: 369 | Train Loss: 0.726 Vali Loss: 2.982 Vali Acc: 0.637 Test Loss: 2.982 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0175628
	speed: 0.3151s/iter; left time: 10548.9904s
	iters: 200, epoch: 10 | loss: 0.3241799
	speed: 0.0661s/iter; left time: 2207.4063s
	iters: 300, epoch: 10 | loss: 1.6865444
	speed: 0.0651s/iter; left time: 2167.6621s
Epoch: 10 cost time: 26.6650607585907
Epoch: 10, Steps: 369 | Train Loss: 0.507 Vali Loss: 2.790 Vali Acc: 0.636 Test Loss: 2.790 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1850834
	speed: 0.2804s/iter; left time: 9283.0390s
	iters: 200, epoch: 11 | loss: 0.4158927
	speed: 0.0644s/iter; left time: 2127.3382s
	iters: 300, epoch: 11 | loss: 0.5630633
	speed: 0.0640s/iter; left time: 2104.7158s
Epoch: 11 cost time: 24.933040380477905
Epoch: 11, Steps: 369 | Train Loss: 0.381 Vali Loss: 3.050 Vali Acc: 0.644 Test Loss: 3.050 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0428324
	speed: 0.2770s/iter; left time: 9069.3674s
	iters: 200, epoch: 12 | loss: 0.2828907
	speed: 0.0662s/iter; left time: 2160.5698s
	iters: 300, epoch: 12 | loss: 0.0716523
	speed: 0.0642s/iter; left time: 2090.7000s
Epoch: 12 cost time: 24.372936248779297
Epoch: 12, Steps: 369 | Train Loss: 0.269 Vali Loss: 2.693 Vali Acc: 0.645 Test Loss: 2.693 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6719636776390465
model parameter : 230146
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 9.2298489
	speed: 0.3911s/iter; left time: 14393.2595s
	iters: 200, epoch: 1 | loss: 0.5052840
	speed: 0.2086s/iter; left time: 7654.8926s
	iters: 300, epoch: 1 | loss: 2.6497869
	speed: 0.2087s/iter; left time: 7639.1297s
Epoch: 1 cost time: 94.92541742324829
Epoch: 1, Steps: 369 | Train Loss: 2.746 Vali Loss: 1.467 Vali Acc: 0.660 Test Loss: 1.467 Test Acc: 0.660
Validation loss decreased (inf --> -0.660031).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1999393
	speed: 0.8310s/iter; left time: 30274.7224s
	iters: 200, epoch: 2 | loss: 4.0467172
	speed: 0.3624s/iter; left time: 13165.9939s
	iters: 300, epoch: 2 | loss: 4.1660032
	speed: 0.3615s/iter; left time: 13097.8459s
Epoch: 2 cost time: 129.66029167175293
Epoch: 2, Steps: 369 | Train Loss: 3.498 Vali Loss: 4.231 Vali Acc: 0.635 Test Loss: 4.231 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.0420284
	speed: 1.0493s/iter; left time: 37841.5092s
	iters: 200, epoch: 3 | loss: 3.0961440
	speed: 0.2689s/iter; left time: 9670.5023s
	iters: 300, epoch: 3 | loss: 2.9166200
	speed: 0.2771s/iter; left time: 9939.2478s
Epoch: 3 cost time: 107.18533182144165
Epoch: 3, Steps: 369 | Train Loss: 4.570 Vali Loss: 5.697 Vali Acc: 0.656 Test Loss: 5.697 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1537875
	speed: 1.1716s/iter; left time: 41818.9385s
	iters: 200, epoch: 4 | loss: 4.0811114
	speed: 0.2923s/iter; left time: 10402.5680s
	iters: 300, epoch: 4 | loss: 4.4883504
	speed: 0.2794s/iter; left time: 9916.0970s
Epoch: 4 cost time: 111.9953088760376
Epoch: 4, Steps: 369 | Train Loss: 5.136 Vali Loss: 7.109 Vali Acc: 0.639 Test Loss: 7.109 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.6351705
	speed: 1.0310s/iter; left time: 36421.4478s
	iters: 200, epoch: 5 | loss: 7.0312734
	speed: 0.3404s/iter; left time: 11991.2638s
	iters: 300, epoch: 5 | loss: 2.0424163
	speed: 0.3377s/iter; left time: 11860.7410s
Epoch: 5 cost time: 126.60107660293579
Epoch: 5, Steps: 369 | Train Loss: 4.847 Vali Loss: 8.368 Vali Acc: 0.636 Test Loss: 8.368 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 8.7322741
	speed: 0.9965s/iter; left time: 34833.1355s
	iters: 200, epoch: 6 | loss: 8.3490267
	speed: 0.2812s/iter; left time: 9800.5087s
	iters: 300, epoch: 6 | loss: 8.8513479
	speed: 0.3058s/iter; left time: 10629.4135s
Epoch: 6 cost time: 111.27955770492554
Epoch: 6, Steps: 369 | Train Loss: 3.979 Vali Loss: 9.050 Vali Acc: 0.633 Test Loss: 9.050 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 4.7950439
	speed: 1.1951s/iter; left time: 41335.6236s
	iters: 200, epoch: 7 | loss: 3.9223018
	speed: 0.2967s/iter; left time: 10233.9313s
	iters: 300, epoch: 7 | loss: 6.2745709
	speed: 0.2864s/iter; left time: 9848.2879s
Epoch: 7 cost time: 114.25043630599976
Epoch: 7, Steps: 369 | Train Loss: 3.036 Vali Loss: 9.413 Vali Acc: 0.625 Test Loss: 9.413 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.1171473
	speed: 1.0724s/iter; left time: 36695.1837s
	iters: 200, epoch: 8 | loss: 0.5127681
	speed: 0.3565s/iter; left time: 12164.0960s
	iters: 300, epoch: 8 | loss: 2.8228738
	speed: 0.3589s/iter; left time: 12210.1221s
Epoch: 8 cost time: 130.35676884651184
Epoch: 8, Steps: 369 | Train Loss: 2.469 Vali Loss: 11.516 Vali Acc: 0.623 Test Loss: 11.516 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6363309
	speed: 1.0130s/iter; left time: 34289.6004s
	iters: 200, epoch: 9 | loss: 1.6673647
	speed: 0.2809s/iter; left time: 9480.8939s
	iters: 300, epoch: 9 | loss: 6.5129423
	speed: 0.3345s/iter; left time: 11255.7276s
Epoch: 9 cost time: 114.75508236885071
Epoch: 9, Steps: 369 | Train Loss: 1.765 Vali Loss: 10.443 Vali Acc: 0.634 Test Loss: 10.443 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.5508178
	speed: 1.1407s/iter; left time: 38190.7712s
	iters: 200, epoch: 10 | loss: 0.5788238
	speed: 0.2819s/iter; left time: 9410.2478s
	iters: 300, epoch: 10 | loss: 2.0857873
	speed: 0.2780s/iter; left time: 9250.2571s
Epoch: 10 cost time: 108.81482410430908
Epoch: 10, Steps: 369 | Train Loss: 1.218 Vali Loss: 10.356 Vali Acc: 0.620 Test Loss: 10.356 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0019115
	speed: 1.0998s/iter; left time: 36414.6465s
	iters: 200, epoch: 11 | loss: 2.6383910
	speed: 0.3672s/iter; left time: 12123.0101s
	iters: 300, epoch: 11 | loss: 0.0005060
	speed: 0.3756s/iter; left time: 12362.8995s
Epoch: 11 cost time: 132.36670088768005
Epoch: 11, Steps: 369 | Train Loss: 0.868 Vali Loss: 11.550 Vali Acc: 0.621 Test Loss: 11.550 Test Acc: 0.621
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6600454029511919
model parameter : 1209986
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5552716
	speed: 0.1976s/iter; left time: 7271.3440s
	iters: 200, epoch: 1 | loss: 1.7377150
	speed: 0.1770s/iter; left time: 6495.1863s
	iters: 300, epoch: 1 | loss: 0.9385396
	speed: 0.1761s/iter; left time: 6444.9577s
Epoch: 1 cost time: 67.40452098846436
Epoch: 1, Steps: 369 | Train Loss: 1.913 Vali Loss: 1.429 Vali Acc: 0.655 Test Loss: 1.429 Test Acc: 0.655
Validation loss decreased (inf --> -0.655207).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5285177
	speed: 0.6296s/iter; left time: 22935.8106s
	iters: 200, epoch: 2 | loss: 2.1534047
	speed: 0.1466s/iter; left time: 5325.4122s
	iters: 300, epoch: 2 | loss: 3.0529933
	speed: 0.1477s/iter; left time: 5351.6635s
Epoch: 2 cost time: 54.34980058670044
Epoch: 2, Steps: 369 | Train Loss: 2.310 Vali Loss: 3.085 Vali Acc: 0.645 Test Loss: 3.085 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 7.1249104
	speed: 0.5710s/iter; left time: 20590.3647s
	iters: 200, epoch: 3 | loss: 1.7216398
	speed: 0.1869s/iter; left time: 6719.8431s
	iters: 300, epoch: 3 | loss: 5.7089415
	speed: 0.1918s/iter; left time: 6877.1654s
Epoch: 3 cost time: 66.60045289993286
Epoch: 3, Steps: 369 | Train Loss: 3.224 Vali Loss: 3.057 Vali Acc: 0.644 Test Loss: 3.057 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.3424678
	speed: 0.7222s/iter; left time: 25777.0019s
	iters: 200, epoch: 4 | loss: 3.8510790
	speed: 0.1950s/iter; left time: 6941.1078s
	iters: 300, epoch: 4 | loss: 5.2253728
	speed: 0.1608s/iter; left time: 5705.6812s
Epoch: 4 cost time: 66.91849184036255
Epoch: 4, Steps: 369 | Train Loss: 3.563 Vali Loss: 2.593 Vali Acc: 0.648 Test Loss: 2.593 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.8200324
	speed: 0.6061s/iter; left time: 21408.9858s
	iters: 200, epoch: 5 | loss: 1.8143353
	speed: 0.1597s/iter; left time: 5624.9982s
	iters: 300, epoch: 5 | loss: 2.8153031
	speed: 0.1581s/iter; left time: 5553.1859s
Epoch: 5 cost time: 62.1311240196228
Epoch: 5, Steps: 369 | Train Loss: 3.704 Vali Loss: 3.608 Vali Acc: 0.646 Test Loss: 3.608 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1775134
	speed: 0.7485s/iter; left time: 26164.4060s
	iters: 200, epoch: 6 | loss: 1.3555409
	speed: 0.2002s/iter; left time: 6978.8325s
	iters: 300, epoch: 6 | loss: 4.7707133
	speed: 0.2016s/iter; left time: 7005.8560s
Epoch: 6 cost time: 74.9403645992279
Epoch: 6, Steps: 369 | Train Loss: 3.309 Vali Loss: 6.432 Vali Acc: 0.645 Test Loss: 6.432 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.4747506
	speed: 0.6689s/iter; left time: 23135.0010s
	iters: 200, epoch: 7 | loss: 4.6148987
	speed: 0.1607s/iter; left time: 5543.6669s
	iters: 300, epoch: 7 | loss: 4.5583143
	speed: 0.1640s/iter; left time: 5639.1616s
Epoch: 7 cost time: 61.77663207054138
Epoch: 7, Steps: 369 | Train Loss: 2.520 Vali Loss: 7.302 Vali Acc: 0.629 Test Loss: 7.302 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.6819479
	speed: 0.7063s/iter; left time: 24166.9557s
	iters: 200, epoch: 8 | loss: 0.0909491
	speed: 0.2016s/iter; left time: 6879.3450s
	iters: 300, epoch: 8 | loss: 1.5488193
	speed: 0.2002s/iter; left time: 6810.7991s
Epoch: 8 cost time: 74.92271304130554
Epoch: 8, Steps: 369 | Train Loss: 1.930 Vali Loss: 6.224 Vali Acc: 0.626 Test Loss: 6.224 Test Acc: 0.626
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.2214279
	speed: 0.6985s/iter; left time: 23642.2684s
	iters: 200, epoch: 9 | loss: 0.2023333
	speed: 0.1589s/iter; left time: 5363.5514s
	iters: 300, epoch: 9 | loss: 1.2360337
	speed: 0.1593s/iter; left time: 5358.8462s
Epoch: 9 cost time: 59.10084772109985
Epoch: 9, Steps: 369 | Train Loss: 1.442 Vali Loss: 7.133 Vali Acc: 0.626 Test Loss: 7.133 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.1024880
	speed: 0.6368s/iter; left time: 21319.7466s
	iters: 200, epoch: 10 | loss: 1.4868679
	speed: 0.2059s/iter; left time: 6873.9127s
	iters: 300, epoch: 10 | loss: 0.8870913
	speed: 0.2063s/iter; left time: 6866.7615s
Epoch: 10 cost time: 73.47734785079956
Epoch: 10, Steps: 369 | Train Loss: 0.939 Vali Loss: 4.902 Vali Acc: 0.633 Test Loss: 4.902 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.2336402
	speed: 0.7805s/iter; left time: 25844.3048s
	iters: 200, epoch: 11 | loss: 0.8435562
	speed: 0.1847s/iter; left time: 6096.0133s
	iters: 300, epoch: 11 | loss: 0.2853370
	speed: 0.1674s/iter; left time: 5507.8391s
Epoch: 11 cost time: 68.1264865398407
Epoch: 11, Steps: 369 | Train Loss: 0.645 Vali Loss: 4.044 Vali Acc: 0.638 Test Loss: 4.044 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6552213393870602
model parameter : 638722
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.8057852
	speed: 0.1643s/iter; left time: 6045.0776s
	iters: 200, epoch: 1 | loss: 1.6376450
	speed: 0.1094s/iter; left time: 4016.1541s
	iters: 300, epoch: 1 | loss: 0.8966381
	speed: 0.1089s/iter; left time: 3986.6114s
Epoch: 1 cost time: 46.073246717453
Epoch: 1, Steps: 369 | Train Loss: 1.631 Vali Loss: 0.991 Vali Acc: 0.655 Test Loss: 0.991 Test Acc: 0.655
Validation loss decreased (inf --> -0.654644).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2085850
	speed: 0.4450s/iter; left time: 16212.3989s
	iters: 200, epoch: 2 | loss: 1.1213887
	speed: 0.1127s/iter; left time: 4095.8146s
	iters: 300, epoch: 2 | loss: 2.4857247
	speed: 0.1134s/iter; left time: 4106.9641s
Epoch: 2 cost time: 43.3766770362854
Epoch: 2, Steps: 369 | Train Loss: 1.979 Vali Loss: 1.594 Vali Acc: 0.646 Test Loss: 1.594 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.9058681
	speed: 0.4968s/iter; left time: 17917.6641s
	iters: 200, epoch: 3 | loss: 0.0754529
	speed: 0.1420s/iter; left time: 5107.0033s
	iters: 300, epoch: 3 | loss: 3.0388746
	speed: 0.1426s/iter; left time: 5114.0618s
Epoch: 3 cost time: 53.49890661239624
Epoch: 3, Steps: 369 | Train Loss: 2.598 Vali Loss: 2.890 Vali Acc: 0.657 Test Loss: 2.890 Test Acc: 0.657
Validation loss decreased (-0.654644 --> -0.656895).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4591373
	speed: 0.5512s/iter; left time: 19675.7517s
	iters: 200, epoch: 4 | loss: 0.7814341
	speed: 0.1278s/iter; left time: 4547.6727s
	iters: 300, epoch: 4 | loss: 1.9327137
	speed: 0.1149s/iter; left time: 4078.6808s
Epoch: 4 cost time: 47.59905982017517
Epoch: 4, Steps: 369 | Train Loss: 2.772 Vali Loss: 2.950 Vali Acc: 0.668 Test Loss: 2.950 Test Acc: 0.668
Validation loss decreased (-0.656895 --> -0.667961).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8500705
	speed: 0.4509s/iter; left time: 15929.4769s
	iters: 200, epoch: 5 | loss: 2.9444387
	speed: 0.1211s/iter; left time: 4266.6809s
	iters: 300, epoch: 5 | loss: 1.8264760
	speed: 0.1187s/iter; left time: 4167.7753s
Epoch: 5 cost time: 44.68133497238159
Epoch: 5, Steps: 369 | Train Loss: 2.866 Vali Loss: 4.035 Vali Acc: 0.652 Test Loss: 4.035 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9464789
	speed: 0.4864s/iter; left time: 17001.0735s
	iters: 200, epoch: 6 | loss: 2.5797646
	speed: 0.1131s/iter; left time: 3942.0073s
	iters: 300, epoch: 6 | loss: 3.4130971
	speed: 0.0820s/iter; left time: 2850.4532s
Epoch: 6 cost time: 39.97903394699097
Epoch: 6, Steps: 369 | Train Loss: 2.386 Vali Loss: 4.796 Vali Acc: 0.653 Test Loss: 4.796 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.5410566
	speed: 0.4140s/iter; left time: 14319.6536s
	iters: 200, epoch: 7 | loss: 1.6734424
	speed: 0.1386s/iter; left time: 4779.8121s
	iters: 300, epoch: 7 | loss: 5.0203681
	speed: 0.1401s/iter; left time: 4817.6876s
Epoch: 7 cost time: 52.631373167037964
Epoch: 7, Steps: 369 | Train Loss: 2.055 Vali Loss: 4.969 Vali Acc: 0.652 Test Loss: 4.969 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5524325
	speed: 0.5296s/iter; left time: 18121.1580s
	iters: 200, epoch: 8 | loss: 3.3633032
	speed: 0.1145s/iter; left time: 3905.2715s
	iters: 300, epoch: 8 | loss: 1.4210507
	speed: 0.1160s/iter; left time: 3946.6361s
Epoch: 8 cost time: 45.20699334144592
Epoch: 8, Steps: 369 | Train Loss: 1.701 Vali Loss: 5.185 Vali Acc: 0.623 Test Loss: 5.185 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.8601650
	speed: 0.4344s/iter; left time: 14705.1082s
	iters: 200, epoch: 9 | loss: 0.5787795
	speed: 0.1092s/iter; left time: 3683.8695s
	iters: 300, epoch: 9 | loss: 1.3930316
	speed: 0.1141s/iter; left time: 3837.8308s
Epoch: 9 cost time: 44.32355308532715
Epoch: 9, Steps: 369 | Train Loss: 1.228 Vali Loss: 4.615 Vali Acc: 0.632 Test Loss: 4.615 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4000582
	speed: 0.5270s/iter; left time: 17643.9897s
	iters: 200, epoch: 10 | loss: 0.7965760
	speed: 0.1373s/iter; left time: 4582.5869s
	iters: 300, epoch: 10 | loss: 0.0018021
	speed: 0.1370s/iter; left time: 4557.8661s
Epoch: 10 cost time: 51.832340240478516
Epoch: 10, Steps: 369 | Train Loss: 0.902 Vali Loss: 3.990 Vali Acc: 0.645 Test Loss: 3.990 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.5968369
	speed: 0.4588s/iter; left time: 15192.9782s
	iters: 200, epoch: 11 | loss: 0.9216987
	speed: 0.1105s/iter; left time: 3646.6418s
	iters: 300, epoch: 11 | loss: 0.0867076
	speed: 0.1072s/iter; left time: 3529.4702s
Epoch: 11 cost time: 41.56810426712036
Epoch: 11, Steps: 369 | Train Loss: 0.471 Vali Loss: 3.137 Vali Acc: 0.638 Test Loss: 3.137 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3153201
	speed: 0.4513s/iter; left time: 14776.6148s
	iters: 200, epoch: 12 | loss: 0.3566938
	speed: 0.1322s/iter; left time: 4316.2341s
	iters: 300, epoch: 12 | loss: 0.3287074
	speed: 0.1320s/iter; left time: 4296.9866s
Epoch: 12 cost time: 50.1607551574707
Epoch: 12, Steps: 369 | Train Loss: 0.295 Vali Loss: 2.634 Vali Acc: 0.634 Test Loss: 2.634 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3225852
	speed: 0.5209s/iter; left time: 16863.0543s
	iters: 200, epoch: 13 | loss: 0.1045084
	speed: 0.1127s/iter; left time: 3638.4609s
	iters: 300, epoch: 13 | loss: 0.0783864
	speed: 0.1069s/iter; left time: 3439.3832s
Epoch: 13 cost time: 44.03226590156555
Epoch: 13, Steps: 369 | Train Loss: 0.158 Vali Loss: 2.260 Vali Acc: 0.633 Test Loss: 2.260 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0387256
	speed: 0.4281s/iter; left time: 13702.2394s
	iters: 200, epoch: 14 | loss: 0.0409168
	speed: 0.1131s/iter; left time: 3607.2775s
	iters: 300, epoch: 14 | loss: 0.0294739
	speed: 0.1130s/iter; left time: 3593.2967s
Epoch: 14 cost time: 44.184863328933716
Epoch: 14, Steps: 369 | Train Loss: 0.113 Vali Loss: 2.117 Vali Acc: 0.649 Test Loss: 2.117 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 454466
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4022515
	speed: 0.1283s/iter; left time: 4720.0210s
	iters: 200, epoch: 1 | loss: 0.9103540
	speed: 0.1082s/iter; left time: 3972.2014s
	iters: 300, epoch: 1 | loss: 1.1588490
	speed: 0.1077s/iter; left time: 3943.4377s
Epoch: 1 cost time: 41.99699878692627
Epoch: 1, Steps: 369 | Train Loss: 1.280 Vali Loss: 0.905 Vali Acc: 0.667 Test Loss: 0.905 Test Acc: 0.667
Validation loss decreased (inf --> -0.666563).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6387675
	speed: 0.4367s/iter; left time: 15908.7433s
	iters: 200, epoch: 2 | loss: 0.4629116
	speed: 0.0822s/iter; left time: 2984.7070s
	iters: 300, epoch: 2 | loss: 1.8713253
	speed: 0.0839s/iter; left time: 3040.6001s
Epoch: 2 cost time: 34.11725687980652
Epoch: 2, Steps: 369 | Train Loss: 1.630 Vali Loss: 1.680 Vali Acc: 0.642 Test Loss: 1.680 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5289547
	speed: 0.3511s/iter; left time: 12662.9146s
	iters: 200, epoch: 3 | loss: 5.0847287
	speed: 0.0852s/iter; left time: 3062.7801s
	iters: 300, epoch: 3 | loss: 3.3926804
	speed: 0.0871s/iter; left time: 3123.4188s
Epoch: 3 cost time: 32.20688557624817
Epoch: 3, Steps: 369 | Train Loss: 2.165 Vali Loss: 2.458 Vali Acc: 0.652 Test Loss: 2.458 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.3778509
	speed: 0.4013s/iter; left time: 14323.5837s
	iters: 200, epoch: 4 | loss: 3.4948866
	speed: 0.1093s/iter; left time: 3892.0943s
	iters: 300, epoch: 4 | loss: 1.1485447
	speed: 0.1091s/iter; left time: 3871.8414s
Epoch: 4 cost time: 41.05507802963257
Epoch: 4, Steps: 369 | Train Loss: 2.352 Vali Loss: 3.207 Vali Acc: 0.651 Test Loss: 3.207 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5701616
	speed: 0.4465s/iter; left time: 15772.3026s
	iters: 200, epoch: 5 | loss: 3.1585817
	speed: 0.0961s/iter; left time: 3384.4504s
	iters: 300, epoch: 5 | loss: 2.8958883
	speed: 0.0888s/iter; left time: 3120.6496s
Epoch: 5 cost time: 36.345099687576294
Epoch: 5, Steps: 369 | Train Loss: 2.431 Vali Loss: 3.796 Vali Acc: 0.644 Test Loss: 3.796 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.6097600
	speed: 0.3526s/iter; left time: 12326.0632s
	iters: 200, epoch: 6 | loss: 2.7200358
	speed: 0.0829s/iter; left time: 2888.5223s
	iters: 300, epoch: 6 | loss: 5.6734619
	speed: 0.0833s/iter; left time: 2894.1139s
Epoch: 6 cost time: 31.47100806236267
Epoch: 6, Steps: 369 | Train Loss: 2.104 Vali Loss: 6.560 Vali Acc: 0.618 Test Loss: 6.560 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.2568207
	speed: 0.3854s/iter; left time: 13328.1875s
	iters: 200, epoch: 7 | loss: 0.1312588
	speed: 0.1059s/iter; left time: 3651.6432s
	iters: 300, epoch: 7 | loss: 0.6991264
	speed: 0.1068s/iter; left time: 3671.9336s
Epoch: 7 cost time: 40.126225233078
Epoch: 7, Steps: 369 | Train Loss: 1.777 Vali Loss: 4.718 Vali Acc: 0.636 Test Loss: 4.718 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.2326055
	speed: 0.4430s/iter; left time: 15158.9573s
	iters: 200, epoch: 8 | loss: 2.0334480
	speed: 0.1011s/iter; left time: 3449.0281s
	iters: 300, epoch: 8 | loss: 2.3132775
	speed: 0.0852s/iter; left time: 2897.3690s
Epoch: 8 cost time: 36.03383946418762
Epoch: 8, Steps: 369 | Train Loss: 1.338 Vali Loss: 4.302 Vali Acc: 0.638 Test Loss: 4.302 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.3100355
	speed: 0.3558s/iter; left time: 12041.8175s
	iters: 200, epoch: 9 | loss: 1.4098854
	speed: 0.0882s/iter; left time: 2975.9718s
	iters: 300, epoch: 9 | loss: 1.2152829
	speed: 0.0882s/iter; left time: 2967.5995s
Epoch: 9 cost time: 33.062838315963745
Epoch: 9, Steps: 369 | Train Loss: 0.889 Vali Loss: 4.007 Vali Acc: 0.640 Test Loss: 4.007 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.4551490
	speed: 0.4095s/iter; left time: 13709.4514s
	iters: 200, epoch: 10 | loss: 0.5583953
	speed: 0.1092s/iter; left time: 3644.0703s
	iters: 300, epoch: 10 | loss: 0.3571734
	speed: 0.1086s/iter; left time: 3613.6679s
Epoch: 10 cost time: 41.06797170639038
Epoch: 10, Steps: 369 | Train Loss: 0.630 Vali Loss: 4.011 Vali Acc: 0.631 Test Loss: 4.011 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0073866
	speed: 0.4514s/iter; left time: 14945.8978s
	iters: 200, epoch: 11 | loss: 0.4849976
	speed: 0.0946s/iter; left time: 3121.6673s
	iters: 300, epoch: 11 | loss: 1.0522954
	speed: 0.0864s/iter; left time: 2842.3041s
Epoch: 11 cost time: 35.991642236709595
Epoch: 11, Steps: 369 | Train Loss: 0.480 Vali Loss: 3.040 Vali Acc: 0.635 Test Loss: 3.040 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.666572077185017
model parameter : 344002
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3836931
	speed: 0.0918s/iter; left time: 3377.8624s
	iters: 200, epoch: 1 | loss: 1.2354577
	speed: 0.0630s/iter; left time: 2313.3627s
	iters: 300, epoch: 1 | loss: 1.0268517
	speed: 0.0670s/iter; left time: 2450.7361s
Epoch: 1 cost time: 26.884131908416748
Epoch: 1, Steps: 369 | Train Loss: 1.229 Vali Loss: 0.931 Vali Acc: 0.667 Test Loss: 0.931 Test Acc: 0.667
Validation loss decreased (inf --> -0.666563).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0395977
	speed: 0.2778s/iter; left time: 10121.4853s
	iters: 200, epoch: 2 | loss: 1.2353011
	speed: 0.0816s/iter; left time: 2965.5406s
	iters: 300, epoch: 2 | loss: 0.7889121
	speed: 0.0886s/iter; left time: 3210.2236s
Epoch: 2 cost time: 30.945293426513672
Epoch: 2, Steps: 369 | Train Loss: 1.450 Vali Loss: 1.897 Vali Acc: 0.642 Test Loss: 1.897 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5545590
	speed: 0.3399s/iter; left time: 12257.4128s
	iters: 200, epoch: 3 | loss: 2.4188976
	speed: 0.0895s/iter; left time: 3217.6919s
	iters: 300, epoch: 3 | loss: 0.6621371
	speed: 0.0894s/iter; left time: 3206.3758s
Epoch: 3 cost time: 34.01202416419983
Epoch: 3, Steps: 369 | Train Loss: 1.959 Vali Loss: 2.334 Vali Acc: 0.646 Test Loss: 2.334 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.7828536
	speed: 0.3125s/iter; left time: 11155.8026s
	iters: 200, epoch: 4 | loss: 4.5114956
	speed: 0.0676s/iter; left time: 2407.2406s
	iters: 300, epoch: 4 | loss: 2.0223861
	speed: 0.0679s/iter; left time: 2410.1630s
Epoch: 4 cost time: 25.777092695236206
Epoch: 4, Steps: 369 | Train Loss: 2.085 Vali Loss: 3.534 Vali Acc: 0.644 Test Loss: 3.534 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.7942314
	speed: 0.2790s/iter; left time: 9855.7868s
	iters: 200, epoch: 5 | loss: 2.0135314
	speed: 0.0678s/iter; left time: 2386.5550s
	iters: 300, epoch: 5 | loss: 2.6568556
	speed: 0.0680s/iter; left time: 2389.7042s
Epoch: 5 cost time: 26.14824891090393
Epoch: 5, Steps: 369 | Train Loss: 2.001 Vali Loss: 3.380 Vali Acc: 0.658 Test Loss: 3.380 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.8750517
	speed: 0.2988s/iter; left time: 10444.4890s
	iters: 200, epoch: 6 | loss: 1.3827299
	speed: 0.0910s/iter; left time: 3172.0369s
	iters: 300, epoch: 6 | loss: 1.9824758
	speed: 0.0907s/iter; left time: 3151.1313s
Epoch: 6 cost time: 34.20210552215576
Epoch: 6, Steps: 369 | Train Loss: 1.748 Vali Loss: 4.023 Vali Acc: 0.649 Test Loss: 4.023 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7079151
	speed: 0.3378s/iter; left time: 11683.2457s
	iters: 200, epoch: 7 | loss: 0.0032279
	speed: 0.0894s/iter; left time: 3082.0833s
	iters: 300, epoch: 7 | loss: 1.2716728
	speed: 0.0896s/iter; left time: 3082.1669s
Epoch: 7 cost time: 33.82961177825928
Epoch: 7, Steps: 369 | Train Loss: 1.478 Vali Loss: 3.845 Vali Acc: 0.636 Test Loss: 3.845 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7297162
	speed: 0.3000s/iter; left time: 10266.4461s
	iters: 200, epoch: 8 | loss: 0.6215751
	speed: 0.0667s/iter; left time: 2275.8711s
	iters: 300, epoch: 8 | loss: 0.8425314
	speed: 0.0676s/iter; left time: 2299.7311s
Epoch: 8 cost time: 25.40939474105835
Epoch: 8, Steps: 369 | Train Loss: 1.164 Vali Loss: 3.440 Vali Acc: 0.640 Test Loss: 3.440 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0001530
	speed: 0.2842s/iter; left time: 9621.4665s
	iters: 200, epoch: 9 | loss: 0.0652256
	speed: 0.0665s/iter; left time: 2245.3559s
	iters: 300, epoch: 9 | loss: 0.4522514
	speed: 0.0669s/iter; left time: 2251.0698s
Epoch: 9 cost time: 25.595986366271973
Epoch: 9, Steps: 369 | Train Loss: 0.862 Vali Loss: 4.114 Vali Acc: 0.648 Test Loss: 4.114 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.2808023
	speed: 0.3218s/iter; left time: 10775.1223s
	iters: 200, epoch: 10 | loss: 0.7017018
	speed: 0.0881s/iter; left time: 2939.4469s
	iters: 300, epoch: 10 | loss: 0.0796943
	speed: 0.0883s/iter; left time: 2937.9500s
Epoch: 10 cost time: 33.637686014175415
Epoch: 10, Steps: 369 | Train Loss: 0.666 Vali Loss: 3.788 Vali Acc: 0.626 Test Loss: 3.788 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0299113
	speed: 0.3398s/iter; left time: 11250.7090s
	iters: 200, epoch: 11 | loss: 0.3886892
	speed: 0.0910s/iter; left time: 3003.0759s
	iters: 300, epoch: 11 | loss: 0.3669863
	speed: 0.0912s/iter; left time: 3002.5902s
Epoch: 11 cost time: 33.647040367126465
Epoch: 11, Steps: 369 | Train Loss: 0.435 Vali Loss: 3.608 Vali Acc: 0.640 Test Loss: 3.608 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.666572077185017
model parameter : 288898
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7186971
	speed: 0.1015s/iter; left time: 3734.7330s
	iters: 200, epoch: 1 | loss: 2.0784404
	speed: 0.0790s/iter; left time: 2897.6834s
	iters: 300, epoch: 1 | loss: 0.7885353
	speed: 0.0606s/iter; left time: 2218.6384s
Epoch: 1 cost time: 28.52165460586548
Epoch: 1, Steps: 369 | Train Loss: 1.104 Vali Loss: 0.888 Vali Acc: 0.654 Test Loss: 0.888 Test Acc: 0.654
Validation loss decreased (inf --> -0.653794).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0087979
	speed: 0.2411s/iter; left time: 8782.1178s
	iters: 200, epoch: 2 | loss: 1.5093777
	speed: 0.0580s/iter; left time: 2105.6640s
	iters: 300, epoch: 2 | loss: 1.7183871
	speed: 0.0552s/iter; left time: 2001.3028s
Epoch: 2 cost time: 21.907554626464844
Epoch: 2, Steps: 369 | Train Loss: 1.259 Vali Loss: 1.693 Vali Acc: 0.629 Test Loss: 1.693 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4727609
	speed: 0.2389s/iter; left time: 8616.1640s
	iters: 200, epoch: 3 | loss: 1.0130978
	speed: 0.0590s/iter; left time: 2121.5443s
	iters: 300, epoch: 3 | loss: 2.3552794
	speed: 0.0593s/iter; left time: 2127.4893s
Epoch: 3 cost time: 22.352158308029175
Epoch: 3, Steps: 369 | Train Loss: 1.589 Vali Loss: 2.143 Vali Acc: 0.660 Test Loss: 2.143 Test Acc: 0.660
Validation loss decreased (-0.653794 --> -0.660024).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5100734
	speed: 0.2937s/iter; left time: 10483.8294s
	iters: 200, epoch: 4 | loss: 0.1637172
	speed: 0.0755s/iter; left time: 2686.1463s
	iters: 300, epoch: 4 | loss: 2.3465135
	speed: 0.0747s/iter; left time: 2651.4786s
Epoch: 4 cost time: 28.675421237945557
Epoch: 4, Steps: 369 | Train Loss: 1.772 Vali Loss: 2.487 Vali Acc: 0.662 Test Loss: 2.487 Test Acc: 0.662
Validation loss decreased (-0.660024 --> -0.662007).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6482249
	speed: 0.3048s/iter; left time: 10765.5716s
	iters: 200, epoch: 5 | loss: 0.5622862
	speed: 0.0767s/iter; left time: 2701.4291s
	iters: 300, epoch: 5 | loss: 0.2516707
	speed: 0.0765s/iter; left time: 2686.2953s
Epoch: 5 cost time: 29.049592971801758
Epoch: 5, Steps: 369 | Train Loss: 1.719 Vali Loss: 3.782 Vali Acc: 0.645 Test Loss: 3.782 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2534614
	speed: 0.2580s/iter; left time: 9019.0017s
	iters: 200, epoch: 6 | loss: 3.0217395
	speed: 0.0622s/iter; left time: 2166.3757s
	iters: 300, epoch: 6 | loss: 2.1660857
	speed: 0.0623s/iter; left time: 2163.7874s
Epoch: 6 cost time: 23.569984674453735
Epoch: 6, Steps: 369 | Train Loss: 1.444 Vali Loss: 3.897 Vali Acc: 0.627 Test Loss: 3.897 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9713995
	speed: 0.2446s/iter; left time: 8458.5835s
	iters: 200, epoch: 7 | loss: 1.2824128
	speed: 0.0598s/iter; left time: 2061.3867s
	iters: 300, epoch: 7 | loss: 2.2674277
	speed: 0.0594s/iter; left time: 2042.2703s
Epoch: 7 cost time: 23.154369831085205
Epoch: 7, Steps: 369 | Train Loss: 1.280 Vali Loss: 4.318 Vali Acc: 0.638 Test Loss: 4.318 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6460428
	speed: 0.2894s/iter; left time: 9902.4479s
	iters: 200, epoch: 8 | loss: 1.9344175
	speed: 0.0770s/iter; left time: 2628.2555s
	iters: 300, epoch: 8 | loss: 0.5936072
	speed: 0.0782s/iter; left time: 2661.7328s
Epoch: 8 cost time: 29.563568353652954
Epoch: 8, Steps: 369 | Train Loss: 1.027 Vali Loss: 4.019 Vali Acc: 0.636 Test Loss: 4.019 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0670107
	speed: 0.3123s/iter; left time: 10570.4077s
	iters: 200, epoch: 9 | loss: 1.1897655
	speed: 0.0769s/iter; left time: 2595.8053s
	iters: 300, epoch: 9 | loss: 1.2288680
	speed: 0.0769s/iter; left time: 2587.0540s
Epoch: 9 cost time: 29.519375801086426
Epoch: 9, Steps: 369 | Train Loss: 0.798 Vali Loss: 3.922 Vali Acc: 0.630 Test Loss: 3.922 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1695299
	speed: 0.2709s/iter; left time: 9069.4545s
	iters: 200, epoch: 10 | loss: 0.6277258
	speed: 0.0625s/iter; left time: 2087.8664s
	iters: 300, epoch: 10 | loss: 0.0754091
	speed: 0.0633s/iter; left time: 2105.0208s
Epoch: 10 cost time: 24.081107139587402
Epoch: 10, Steps: 369 | Train Loss: 0.547 Vali Loss: 3.720 Vali Acc: 0.643 Test Loss: 3.720 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1764659
	speed: 0.2482s/iter; left time: 8217.9075s
	iters: 200, epoch: 11 | loss: 0.9652030
	speed: 0.0613s/iter; left time: 2025.1397s
	iters: 300, epoch: 11 | loss: 0.0073300
	speed: 0.0604s/iter; left time: 1989.4232s
Epoch: 11 cost time: 23.68687653541565
Epoch: 11, Steps: 369 | Train Loss: 0.419 Vali Loss: 3.321 Vali Acc: 0.644 Test Loss: 3.321 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0330832
	speed: 0.2800s/iter; left time: 9169.0217s
	iters: 200, epoch: 12 | loss: 0.0021538
	speed: 0.0764s/iter; left time: 2495.0176s
	iters: 300, epoch: 12 | loss: 0.1622163
	speed: 0.0762s/iter; left time: 2480.0688s
Epoch: 12 cost time: 29.115930318832397
Epoch: 12, Steps: 369 | Train Loss: 0.307 Vali Loss: 3.076 Vali Acc: 0.635 Test Loss: 3.076 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.4529981
	speed: 0.3092s/iter; left time: 10008.3313s
	iters: 200, epoch: 13 | loss: 0.0279753
	speed: 0.0755s/iter; left time: 2436.2415s
	iters: 300, epoch: 13 | loss: 0.8009387
	speed: 0.0763s/iter; left time: 2453.5112s
Epoch: 13 cost time: 29.04117512702942
Epoch: 13, Steps: 369 | Train Loss: 0.231 Vali Loss: 2.747 Vali Acc: 0.636 Test Loss: 2.747 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0759527
	speed: 0.2778s/iter; left time: 8891.8020s
	iters: 200, epoch: 14 | loss: 0.2133762
	speed: 0.0590s/iter; left time: 1882.1066s
	iters: 300, epoch: 14 | loss: 0.0765092
	speed: 0.0597s/iter; left time: 1898.6271s
Epoch: 14 cost time: 22.99537968635559
Epoch: 14, Steps: 369 | Train Loss: 0.196 Vali Loss: 2.772 Vali Acc: 0.642 Test Loss: 2.772 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6620317820658342
model parameter : 233794
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1240878
	speed: 0.0753s/iter; left time: 2772.2414s
	iters: 200, epoch: 1 | loss: 1.2274430
	speed: 0.0490s/iter; left time: 1799.0996s
	iters: 300, epoch: 1 | loss: 1.2461983
	speed: 0.0504s/iter; left time: 1843.8143s
Epoch: 1 cost time: 21.03236699104309
Epoch: 1, Steps: 369 | Train Loss: 0.941 Vali Loss: 0.964 Vali Acc: 0.630 Test Loss: 0.964 Test Acc: 0.630
Validation loss decreased (inf --> -0.629673).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4442067
	speed: 0.2446s/iter; left time: 8911.9023s
	iters: 200, epoch: 2 | loss: 0.4457871
	speed: 0.0651s/iter; left time: 2366.0082s
	iters: 300, epoch: 2 | loss: 0.5194383
	speed: 0.0653s/iter; left time: 2366.8387s
Epoch: 2 cost time: 24.992324352264404
Epoch: 2, Steps: 369 | Train Loss: 1.165 Vali Loss: 1.476 Vali Acc: 0.655 Test Loss: 1.476 Test Acc: 0.655
Validation loss decreased (-0.629673 --> -0.655207).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8756502
	speed: 0.2738s/iter; left time: 9875.1952s
	iters: 200, epoch: 3 | loss: 2.2090666
	speed: 0.0653s/iter; left time: 2349.1454s
	iters: 300, epoch: 3 | loss: 0.3497569
	speed: 0.0655s/iter; left time: 2349.1234s
Epoch: 3 cost time: 25.22197985649109
Epoch: 3, Steps: 369 | Train Loss: 1.386 Vali Loss: 1.987 Vali Acc: 0.648 Test Loss: 1.987 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8037522
	speed: 0.2568s/iter; left time: 9165.7689s
	iters: 200, epoch: 4 | loss: 0.8445564
	speed: 0.0500s/iter; left time: 1780.5962s
	iters: 300, epoch: 4 | loss: 2.2885971
	speed: 0.0493s/iter; left time: 1749.1740s
Epoch: 4 cost time: 19.561583757400513
Epoch: 4, Steps: 369 | Train Loss: 1.461 Vali Loss: 2.525 Vali Acc: 0.659 Test Loss: 2.525 Test Acc: 0.659
Validation loss decreased (-0.655207 --> -0.658601).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5677572
	speed: 0.2170s/iter; left time: 7666.0078s
	iters: 200, epoch: 5 | loss: 1.5311381
	speed: 0.0505s/iter; left time: 1780.3449s
	iters: 300, epoch: 5 | loss: 1.7571433
	speed: 0.0494s/iter; left time: 1735.2278s
Epoch: 5 cost time: 18.99858856201172
Epoch: 5, Steps: 369 | Train Loss: 1.444 Vali Loss: 2.734 Vali Acc: 0.645 Test Loss: 2.734 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.6402297
	speed: 0.2312s/iter; left time: 8082.7783s
	iters: 200, epoch: 6 | loss: 1.1241001
	speed: 0.0413s/iter; left time: 1438.1009s
	iters: 300, epoch: 6 | loss: 0.9810977
	speed: 0.0604s/iter; left time: 2099.3316s
Epoch: 6 cost time: 20.459492444992065
Epoch: 6, Steps: 369 | Train Loss: 1.307 Vali Loss: 3.662 Vali Acc: 0.641 Test Loss: 3.662 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1129990
	speed: 0.2222s/iter; left time: 7685.8232s
	iters: 200, epoch: 7 | loss: 0.3828869
	speed: 0.0375s/iter; left time: 1292.9583s
	iters: 300, epoch: 7 | loss: 1.0210434
	speed: 0.0378s/iter; left time: 1301.3884s
Epoch: 7 cost time: 14.481373071670532
Epoch: 7, Steps: 369 | Train Loss: 1.155 Vali Loss: 3.733 Vali Acc: 0.636 Test Loss: 3.733 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1665381
	speed: 0.1640s/iter; left time: 5613.0272s
	iters: 200, epoch: 8 | loss: 0.6392589
	speed: 0.0579s/iter; left time: 1973.8041s
	iters: 300, epoch: 8 | loss: 1.4349108
	speed: 0.0629s/iter; left time: 2141.2652s
Epoch: 8 cost time: 20.837990760803223
Epoch: 8, Steps: 369 | Train Loss: 0.885 Vali Loss: 3.213 Vali Acc: 0.646 Test Loss: 3.213 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3194501
	speed: 0.2581s/iter; left time: 8736.7739s
	iters: 200, epoch: 9 | loss: 0.6797405
	speed: 0.0637s/iter; left time: 2148.6101s
	iters: 300, epoch: 9 | loss: 1.2227881
	speed: 0.0632s/iter; left time: 2127.1644s
Epoch: 9 cost time: 24.10958242416382
Epoch: 9, Steps: 369 | Train Loss: 0.672 Vali Loss: 3.335 Vali Acc: 0.638 Test Loss: 3.335 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.8243971
	speed: 0.2656s/iter; left time: 8892.9154s
	iters: 200, epoch: 10 | loss: 1.3679767
	speed: 0.0490s/iter; left time: 1634.6181s
	iters: 300, epoch: 10 | loss: 0.8816652
	speed: 0.0482s/iter; left time: 1605.0205s
Epoch: 10 cost time: 20.065691471099854
Epoch: 10, Steps: 369 | Train Loss: 0.500 Vali Loss: 3.062 Vali Acc: 0.652 Test Loss: 3.062 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1480964
	speed: 0.2173s/iter; left time: 7196.4745s
	iters: 200, epoch: 11 | loss: 0.1030483
	speed: 0.0456s/iter; left time: 1505.9621s
	iters: 300, epoch: 11 | loss: 0.4960407
	speed: 0.0482s/iter; left time: 1586.4221s
Epoch: 11 cost time: 18.450108289718628
Epoch: 11, Steps: 369 | Train Loss: 0.406 Vali Loss: 2.998 Vali Acc: 0.628 Test Loss: 2.998 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1174352
	speed: 0.2131s/iter; left time: 6977.7633s
	iters: 200, epoch: 12 | loss: 0.2656066
	speed: 0.0482s/iter; left time: 1572.4173s
	iters: 300, epoch: 12 | loss: 0.1203481
	speed: 0.0578s/iter; left time: 1880.2335s
Epoch: 12 cost time: 20.56616497039795
Epoch: 12, Steps: 369 | Train Loss: 0.319 Vali Loss: 2.499 Vali Acc: 0.646 Test Loss: 2.499 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3996676
	speed: 0.2639s/iter; left time: 8541.9802s
	iters: 200, epoch: 13 | loss: 0.0183345
	speed: 0.0648s/iter; left time: 2091.8150s
	iters: 300, epoch: 13 | loss: 0.0569515
	speed: 0.0644s/iter; left time: 2072.2293s
Epoch: 13 cost time: 24.610718488693237
Epoch: 13, Steps: 369 | Train Loss: 0.205 Vali Loss: 2.679 Vali Acc: 0.644 Test Loss: 2.679 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2985689
	speed: 0.2577s/iter; left time: 8247.9552s
	iters: 200, epoch: 14 | loss: 0.2270001
	speed: 0.0628s/iter; left time: 2004.6242s
	iters: 300, epoch: 14 | loss: 0.1414453
	speed: 0.0515s/iter; left time: 1639.0090s
Epoch: 14 cost time: 21.874867916107178
Epoch: 14, Steps: 369 | Train Loss: 0.199 Vali Loss: 2.675 Vali Acc: 0.641 Test Loss: 2.675 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6586265607264472
model parameter : 197122
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5448266
	speed: 0.2949s/iter; left time: 10851.8717s
	iters: 200, epoch: 1 | loss: 1.1164116
	speed: 0.2555s/iter; left time: 9376.7101s
	iters: 300, epoch: 1 | loss: 2.8568058
	speed: 0.2574s/iter; left time: 9419.4264s
Epoch: 1 cost time: 101.40556693077087
Epoch: 1, Steps: 369 | Train Loss: 2.801 Vali Loss: 1.661 Vali Acc: 0.640 Test Loss: 1.661 Test Acc: 0.640
Validation loss decreased (inf --> -0.639881).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9163119
	speed: 1.1041s/iter; left time: 40223.4204s
	iters: 200, epoch: 2 | loss: 4.8050356
	speed: 0.2610s/iter; left time: 9483.5912s
	iters: 300, epoch: 2 | loss: 3.5087898
	speed: 0.2614s/iter; left time: 9471.3899s
Epoch: 2 cost time: 102.35000276565552
Epoch: 2, Steps: 369 | Train Loss: 3.637 Vali Loss: 4.448 Vali Acc: 0.641 Test Loss: 4.448 Test Acc: 0.641
Validation loss decreased (-0.639881 --> -0.641272).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6464500
	speed: 1.0520s/iter; left time: 37939.1743s
	iters: 200, epoch: 3 | loss: 4.7159491
	speed: 0.2705s/iter; left time: 9726.4965s
	iters: 300, epoch: 3 | loss: 8.6122427
	speed: 0.2601s/iter; left time: 9328.2255s
Epoch: 3 cost time: 104.46923327445984
Epoch: 3, Steps: 369 | Train Loss: 4.728 Vali Loss: 6.931 Vali Acc: 0.650 Test Loss: 6.931 Test Acc: 0.650
Validation loss decreased (-0.641272 --> -0.649477).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8160090
	speed: 1.0162s/iter; left time: 36272.7206s
	iters: 200, epoch: 4 | loss: 3.1220484
	speed: 0.2978s/iter; left time: 10598.7526s
	iters: 300, epoch: 4 | loss: 8.2236176
	speed: 0.2569s/iter; left time: 9117.5411s
Epoch: 4 cost time: 105.51858520507812
Epoch: 4, Steps: 369 | Train Loss: 5.068 Vali Loss: 5.482 Vali Acc: 0.659 Test Loss: 5.482 Test Acc: 0.659
Validation loss decreased (-0.649477 --> -0.659139).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.8984966
	speed: 0.9963s/iter; left time: 35192.7099s
	iters: 200, epoch: 5 | loss: 6.4399400
	speed: 0.3206s/iter; left time: 11293.3402s
	iters: 300, epoch: 5 | loss: 4.9393935
	speed: 0.2564s/iter; left time: 9006.0173s
Epoch: 5 cost time: 106.66626596450806
Epoch: 5, Steps: 369 | Train Loss: 4.764 Vali Loss: 8.255 Vali Acc: 0.642 Test Loss: 8.255 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 6.6367888
	speed: 0.9318s/iter; left time: 32573.7349s
	iters: 200, epoch: 6 | loss: 5.5510178
	speed: 0.3059s/iter; left time: 10663.8492s
	iters: 300, epoch: 6 | loss: 0.0051004
	speed: 0.2854s/iter; left time: 9917.7988s
Epoch: 6 cost time: 106.8302252292633
Epoch: 6, Steps: 369 | Train Loss: 4.041 Vali Loss: 10.472 Vali Acc: 0.641 Test Loss: 10.472 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0889394
	speed: 0.8869s/iter; left time: 30676.6633s
	iters: 200, epoch: 7 | loss: 1.9983077
	speed: 0.3062s/iter; left time: 10558.6139s
	iters: 300, epoch: 7 | loss: 0.5595129
	speed: 0.3131s/iter; left time: 10766.9020s
Epoch: 7 cost time: 110.55270910263062
Epoch: 7, Steps: 369 | Train Loss: 3.701 Vali Loss: 11.087 Vali Acc: 0.624 Test Loss: 11.087 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0005552
	speed: 0.8730s/iter; left time: 29871.2148s
	iters: 200, epoch: 8 | loss: 4.0197124
	speed: 0.3173s/iter; left time: 10824.8254s
	iters: 300, epoch: 8 | loss: 6.4766750
	speed: 0.3226s/iter; left time: 10975.5511s
Epoch: 8 cost time: 111.7841272354126
Epoch: 8, Steps: 369 | Train Loss: 2.646 Vali Loss: 9.909 Vali Acc: 0.640 Test Loss: 9.909 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.3035207
	speed: 0.9336s/iter; left time: 31600.9521s
	iters: 200, epoch: 9 | loss: 0.0121703
	speed: 0.2903s/iter; left time: 9795.6802s
	iters: 300, epoch: 9 | loss: 0.9841447
	speed: 0.3166s/iter; left time: 10653.2527s
Epoch: 9 cost time: 108.76480197906494
Epoch: 9, Steps: 369 | Train Loss: 1.678 Vali Loss: 8.800 Vali Acc: 0.627 Test Loss: 8.800 Test Acc: 0.627
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.9614997
	speed: 0.9342s/iter; left time: 31278.1439s
	iters: 200, epoch: 10 | loss: 0.0000010
	speed: 0.2474s/iter; left time: 8258.7837s
	iters: 300, epoch: 10 | loss: 2.9423888
	speed: 0.3132s/iter; left time: 10422.1646s
Epoch: 10 cost time: 103.5324068069458
Epoch: 10, Steps: 369 | Train Loss: 1.182 Vali Loss: 8.999 Vali Acc: 0.632 Test Loss: 8.999 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4658279
	speed: 0.9456s/iter; left time: 31309.4699s
	iters: 200, epoch: 11 | loss: 0.7501384
	speed: 0.2390s/iter; left time: 7889.5650s
	iters: 300, epoch: 11 | loss: 0.2762124
	speed: 0.2734s/iter; left time: 8996.2316s
Epoch: 11 cost time: 97.42989897727966
Epoch: 11, Steps: 369 | Train Loss: 0.751 Vali Loss: 6.510 Vali Acc: 0.628 Test Loss: 6.510 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0073017
	speed: 1.0242s/iter; left time: 33533.8620s
	iters: 200, epoch: 12 | loss: 0.0000027
	speed: 0.2460s/iter; left time: 8028.4314s
	iters: 300, epoch: 12 | loss: 0.0405718
	speed: 0.2505s/iter; left time: 8152.1896s
Epoch: 12 cost time: 94.2873170375824
Epoch: 12, Steps: 369 | Train Loss: 0.505 Vali Loss: 6.651 Vali Acc: 0.627 Test Loss: 6.651 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0029593
	speed: 1.0433s/iter; left time: 33774.0003s
	iters: 200, epoch: 13 | loss: 1.1164058
	speed: 0.2532s/iter; left time: 8170.6330s
	iters: 300, epoch: 13 | loss: 1.1136476
	speed: 0.2538s/iter; left time: 8165.0180s
Epoch: 13 cost time: 99.91229915618896
Epoch: 13, Steps: 369 | Train Loss: 0.308 Vali Loss: 5.402 Vali Acc: 0.642 Test Loss: 5.402 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000471
	speed: 1.0620s/iter; left time: 33987.7465s
	iters: 200, epoch: 14 | loss: 0.0002468
	speed: 0.2702s/iter; left time: 8621.4471s
	iters: 300, epoch: 14 | loss: 0.1367432
	speed: 0.2637s/iter; left time: 8386.2772s
Epoch: 14 cost time: 104.93643236160278
Epoch: 14, Steps: 369 | Train Loss: 0.160 Vali Loss: 4.776 Vali Acc: 0.622 Test Loss: 4.776 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6591940976163451
model parameter : 1193474
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.6485672
	speed: 0.1494s/iter; left time: 5496.5908s
	iters: 200, epoch: 1 | loss: 1.2717866
	speed: 0.1351s/iter; left time: 4957.7378s
	iters: 300, epoch: 1 | loss: 1.1607406
	speed: 0.1390s/iter; left time: 5086.6907s
Epoch: 1 cost time: 54.284199953079224
Epoch: 1, Steps: 369 | Train Loss: 1.850 Vali Loss: 1.181 Vali Acc: 0.644 Test Loss: 1.181 Test Acc: 0.644
Validation loss decreased (inf --> -0.644426).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9768711
	speed: 0.6809s/iter; left time: 24808.0186s
	iters: 200, epoch: 2 | loss: 3.0839336
	speed: 0.1866s/iter; left time: 6778.4704s
	iters: 300, epoch: 2 | loss: 1.9601730
	speed: 0.1494s/iter; left time: 5413.2942s
Epoch: 2 cost time: 62.967090368270874
Epoch: 2, Steps: 369 | Train Loss: 2.395 Vali Loss: 2.846 Vali Acc: 0.657 Test Loss: 2.846 Test Acc: 0.657
Validation loss decreased (-0.644426 --> -0.656612).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5113769
	speed: 0.5407s/iter; left time: 19500.7567s
	iters: 200, epoch: 3 | loss: 2.5452545
	speed: 0.1384s/iter; left time: 4977.1202s
	iters: 300, epoch: 3 | loss: 5.3221383
	speed: 0.1306s/iter; left time: 4684.8868s
Epoch: 3 cost time: 53.38556694984436
Epoch: 3, Steps: 369 | Train Loss: 3.310 Vali Loss: 2.958 Vali Acc: 0.650 Test Loss: 2.958 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.0880609
	speed: 0.4774s/iter; left time: 17040.7620s
	iters: 200, epoch: 4 | loss: 1.5896375
	speed: 0.1119s/iter; left time: 3983.8479s
	iters: 300, epoch: 4 | loss: 2.4407108
	speed: 0.1084s/iter; left time: 3848.5436s
Epoch: 4 cost time: 40.82281517982483
Epoch: 4, Steps: 369 | Train Loss: 3.607 Vali Loss: 7.576 Vali Acc: 0.549 Test Loss: 7.576 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 5.0477653
	speed: 0.5776s/iter; left time: 20402.1380s
	iters: 200, epoch: 5 | loss: 4.2238679
	speed: 0.1804s/iter; left time: 6353.4661s
	iters: 300, epoch: 5 | loss: 7.1878500
	speed: 0.1802s/iter; left time: 6330.8317s
Epoch: 5 cost time: 65.1311936378479
Epoch: 5, Steps: 369 | Train Loss: 3.327 Vali Loss: 5.899 Vali Acc: 0.651 Test Loss: 5.899 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5080212
	speed: 0.5442s/iter; left time: 19023.2478s
	iters: 200, epoch: 6 | loss: 2.8151076
	speed: 0.1408s/iter; left time: 4908.2723s
	iters: 300, epoch: 6 | loss: 7.8780351
	speed: 0.1617s/iter; left time: 5619.3118s
Epoch: 6 cost time: 57.717397689819336
Epoch: 6, Steps: 369 | Train Loss: 2.933 Vali Loss: 5.511 Vali Acc: 0.638 Test Loss: 5.511 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6040836
	speed: 0.6699s/iter; left time: 23169.0374s
	iters: 200, epoch: 7 | loss: 3.5086453
	speed: 0.1440s/iter; left time: 4966.7042s
	iters: 300, epoch: 7 | loss: 2.0541825
	speed: 0.1413s/iter; left time: 4857.4343s
Epoch: 7 cost time: 56.98130011558533
Epoch: 7, Steps: 369 | Train Loss: 2.279 Vali Loss: 7.743 Vali Acc: 0.626 Test Loss: 7.743 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 6.0107498
	speed: 0.5428s/iter; left time: 18572.8508s
	iters: 200, epoch: 8 | loss: 0.0243525
	speed: 0.1790s/iter; left time: 6108.3648s
	iters: 300, epoch: 8 | loss: 3.5346680
	speed: 0.1789s/iter; left time: 6085.2823s
Epoch: 8 cost time: 64.3265151977539
Epoch: 8, Steps: 369 | Train Loss: 1.948 Vali Loss: 8.030 Vali Acc: 0.634 Test Loss: 8.030 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.5193965
	speed: 0.6019s/iter; left time: 20372.5911s
	iters: 200, epoch: 9 | loss: 1.1723143
	speed: 0.1370s/iter; left time: 4622.0380s
	iters: 300, epoch: 9 | loss: 2.0274868
	speed: 0.1341s/iter; left time: 4512.6110s
Epoch: 9 cost time: 51.3489727973938
Epoch: 9, Steps: 369 | Train Loss: 1.280 Vali Loss: 7.072 Vali Acc: 0.628 Test Loss: 7.072 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2510117
	speed: 0.6103s/iter; left time: 20432.0446s
	iters: 200, epoch: 10 | loss: 0.9639223
	speed: 0.1808s/iter; left time: 6033.7751s
	iters: 300, epoch: 10 | loss: 0.0554344
	speed: 0.1837s/iter; left time: 6112.3628s
Epoch: 10 cost time: 67.74150586128235
Epoch: 10, Steps: 369 | Train Loss: 0.985 Vali Loss: 5.615 Vali Acc: 0.603 Test Loss: 5.615 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1656813
	speed: 0.5702s/iter; left time: 18880.9325s
	iters: 200, epoch: 11 | loss: 0.9662982
	speed: 0.1369s/iter; left time: 4518.9320s
	iters: 300, epoch: 11 | loss: 0.9431106
	speed: 0.1398s/iter; left time: 4600.8299s
Epoch: 11 cost time: 54.73500370979309
Epoch: 11, Steps: 369 | Train Loss: 0.544 Vali Loss: 4.903 Vali Acc: 0.626 Test Loss: 4.903 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.5317526
	speed: 0.6615s/iter; left time: 21659.3294s
	iters: 200, epoch: 12 | loss: 0.0479503
	speed: 0.1573s/iter; left time: 5133.1691s
	iters: 300, epoch: 12 | loss: 0.0001562
	speed: 0.1332s/iter; left time: 4335.0679s
Epoch: 12 cost time: 56.40836262702942
Epoch: 12, Steps: 369 | Train Loss: 0.344 Vali Loss: 3.704 Vali Acc: 0.634 Test Loss: 3.704 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6566401816118048
model parameter : 622210
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3666918
	speed: 0.1199s/iter; left time: 4411.1876s
	iters: 200, epoch: 1 | loss: 1.5104960
	speed: 0.0954s/iter; left time: 3500.4957s
	iters: 300, epoch: 1 | loss: 0.8320366
	speed: 0.0987s/iter; left time: 3614.2233s
Epoch: 1 cost time: 38.095176219940186
Epoch: 1, Steps: 369 | Train Loss: 1.513 Vali Loss: 1.020 Vali Acc: 0.630 Test Loss: 1.020 Test Acc: 0.630
Validation loss decreased (inf --> -0.629672).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7644885
	speed: 0.3786s/iter; left time: 13791.6512s
	iters: 200, epoch: 2 | loss: 2.3933356
	speed: 0.1173s/iter; left time: 4263.4259s
	iters: 300, epoch: 2 | loss: 3.3258107
	speed: 0.1346s/iter; left time: 4877.7514s
Epoch: 2 cost time: 45.41114783287048
Epoch: 2, Steps: 369 | Train Loss: 1.973 Vali Loss: 2.522 Vali Acc: 0.633 Test Loss: 2.522 Test Acc: 0.633
Validation loss decreased (-0.629672 --> -0.633346).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3208342
	speed: 0.4853s/iter; left time: 17502.5997s
	iters: 200, epoch: 3 | loss: 1.6820102
	speed: 0.1186s/iter; left time: 4264.1521s
	iters: 300, epoch: 3 | loss: 3.2727959
	speed: 0.0988s/iter; left time: 3544.3702s
Epoch: 3 cost time: 42.89316654205322
Epoch: 3, Steps: 369 | Train Loss: 2.682 Vali Loss: 3.423 Vali Acc: 0.642 Test Loss: 3.423 Test Acc: 0.642
Validation loss decreased (-0.633346 --> -0.642134).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0470867
	speed: 0.3786s/iter; left time: 13515.0178s
	iters: 200, epoch: 4 | loss: 4.2230349
	speed: 0.0965s/iter; left time: 3436.4362s
	iters: 300, epoch: 4 | loss: 2.5964022
	speed: 0.0971s/iter; left time: 3445.8813s
Epoch: 4 cost time: 37.76301455497742
Epoch: 4, Steps: 369 | Train Loss: 2.892 Vali Loss: 3.654 Vali Acc: 0.646 Test Loss: 3.654 Test Acc: 0.646
Validation loss decreased (-0.642134 --> -0.645537).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.4168072
	speed: 0.4670s/iter; left time: 16497.0976s
	iters: 200, epoch: 5 | loss: 1.6181829
	speed: 0.1330s/iter; left time: 4684.5733s
	iters: 300, epoch: 5 | loss: 2.7369266
	speed: 0.1329s/iter; left time: 4668.4311s
Epoch: 5 cost time: 48.38782358169556
Epoch: 5, Steps: 369 | Train Loss: 2.925 Vali Loss: 8.416 Vali Acc: 0.621 Test Loss: 8.416 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4764248
	speed: 0.3960s/iter; left time: 13842.9805s
	iters: 200, epoch: 6 | loss: 2.7495821
	speed: 0.1013s/iter; left time: 3532.3110s
	iters: 300, epoch: 6 | loss: 3.9086771
	speed: 0.0996s/iter; left time: 3460.7938s
Epoch: 6 cost time: 37.94477128982544
Epoch: 6, Steps: 369 | Train Loss: 2.504 Vali Loss: 4.818 Vali Acc: 0.661 Test Loss: 4.818 Test Acc: 0.661
Validation loss decreased (-0.645537 --> -0.660849).  Saving model ...
	iters: 100, epoch: 7 | loss: 4.2639284
	speed: 0.4425s/iter; left time: 15303.0220s
	iters: 200, epoch: 7 | loss: 1.6986964
	speed: 0.1340s/iter; left time: 4620.1894s
	iters: 300, epoch: 7 | loss: 2.8669512
	speed: 0.1346s/iter; left time: 4629.5568s
Epoch: 7 cost time: 50.295002460479736
Epoch: 7, Steps: 369 | Train Loss: 2.011 Vali Loss: 6.553 Vali Acc: 0.626 Test Loss: 6.553 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5766239
	speed: 0.4323s/iter; left time: 14792.7271s
	iters: 200, epoch: 8 | loss: 0.3159859
	speed: 0.1030s/iter; left time: 3513.8406s
	iters: 300, epoch: 8 | loss: 0.5211613
	speed: 0.1006s/iter; left time: 3423.2975s
Epoch: 8 cost time: 38.64126634597778
Epoch: 8, Steps: 369 | Train Loss: 1.442 Vali Loss: 5.115 Vali Acc: 0.639 Test Loss: 5.115 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5163018
	speed: 0.4247s/iter; left time: 14376.4950s
	iters: 200, epoch: 9 | loss: 0.0005461
	speed: 0.1321s/iter; left time: 4457.6791s
	iters: 300, epoch: 9 | loss: 0.8508757
	speed: 0.1301s/iter; left time: 4377.5404s
Epoch: 9 cost time: 49.89778542518616
Epoch: 9, Steps: 369 | Train Loss: 1.131 Vali Loss: 4.747 Vali Acc: 0.629 Test Loss: 4.747 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0178525
	speed: 0.4475s/iter; left time: 14983.5999s
	iters: 200, epoch: 10 | loss: 0.1761314
	speed: 0.0973s/iter; left time: 3247.7479s
	iters: 300, epoch: 10 | loss: 0.1658547
	speed: 0.0960s/iter; left time: 3193.8320s
Epoch: 10 cost time: 36.46157169342041
Epoch: 10, Steps: 369 | Train Loss: 0.658 Vali Loss: 4.469 Vali Acc: 0.632 Test Loss: 4.469 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.0508059
	speed: 0.3861s/iter; left time: 12782.7846s
	iters: 200, epoch: 11 | loss: 0.5566310
	speed: 0.1150s/iter; left time: 3794.9118s
	iters: 300, epoch: 11 | loss: 1.1599764
	speed: 0.1316s/iter; left time: 4331.7291s
Epoch: 11 cost time: 44.83178400993347
Epoch: 11, Steps: 369 | Train Loss: 0.485 Vali Loss: 3.196 Vali Acc: 0.633 Test Loss: 3.196 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2111524
	speed: 0.4923s/iter; left time: 16120.4046s
	iters: 200, epoch: 12 | loss: 0.2239473
	speed: 0.1157s/iter; left time: 3775.5070s
	iters: 300, epoch: 12 | loss: 0.0865582
	speed: 0.1007s/iter; left time: 3276.6470s
Epoch: 12 cost time: 43.138463735580444
Epoch: 12, Steps: 369 | Train Loss: 0.327 Vali Loss: 2.509 Vali Acc: 0.633 Test Loss: 2.509 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4310774
	speed: 0.3921s/iter; left time: 12693.1900s
	iters: 200, epoch: 13 | loss: 0.9036884
	speed: 0.1026s/iter; left time: 3312.4081s
	iters: 300, epoch: 13 | loss: 0.0160956
	speed: 0.1143s/iter; left time: 3677.3554s
Epoch: 13 cost time: 42.02742576599121
Epoch: 13, Steps: 369 | Train Loss: 0.197 Vali Loss: 2.133 Vali Acc: 0.638 Test Loss: 2.133 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0092650
	speed: 0.4950s/iter; left time: 15840.6334s
	iters: 200, epoch: 14 | loss: 0.0178443
	speed: 0.1354s/iter; left time: 4319.7990s
	iters: 300, epoch: 14 | loss: 0.0068704
	speed: 0.1200s/iter; left time: 3815.7089s
Epoch: 14 cost time: 47.434603691101074
Epoch: 14, Steps: 369 | Train Loss: 0.133 Vali Loss: 2.107 Vali Acc: 0.631 Test Loss: 2.107 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0079190
	speed: 0.3929s/iter; left time: 12430.0968s
	iters: 200, epoch: 15 | loss: 0.0129735
	speed: 0.0997s/iter; left time: 3144.3772s
	iters: 300, epoch: 15 | loss: 0.0008085
	speed: 0.0977s/iter; left time: 3071.1057s
Epoch: 15 cost time: 37.80664348602295
Epoch: 15, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.108 Vali Acc: 0.644 Test Loss: 2.108 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0010414
	speed: 0.4574s/iter; left time: 14301.3957s
	iters: 200, epoch: 16 | loss: 0.2995567
	speed: 0.1315s/iter; left time: 4097.1072s
	iters: 300, epoch: 16 | loss: 0.0510150
	speed: 0.1320s/iter; left time: 4099.4521s
Epoch: 16 cost time: 49.679161071777344
Epoch: 16, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.328 Vali Acc: 0.638 Test Loss: 2.328 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6608967082860386
model parameter : 437954
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0874555
	speed: 0.1215s/iter; left time: 4470.0611s
	iters: 200, epoch: 1 | loss: 2.7990897
	speed: 0.1008s/iter; left time: 3699.6563s
	iters: 300, epoch: 1 | loss: 0.6200397
	speed: 0.1011s/iter; left time: 3700.4379s
Epoch: 1 cost time: 39.449771881103516
Epoch: 1, Steps: 369 | Train Loss: 1.296 Vali Loss: 0.938 Vali Acc: 0.651 Test Loss: 0.938 Test Acc: 0.651
Validation loss decreased (inf --> -0.650955).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6245077
	speed: 0.3208s/iter; left time: 11687.3632s
	iters: 200, epoch: 2 | loss: 1.3412709
	speed: 0.0757s/iter; left time: 2750.2359s
	iters: 300, epoch: 2 | loss: 2.8897674
	speed: 0.0702s/iter; left time: 2545.1080s
Epoch: 2 cost time: 27.92267870903015
Epoch: 2, Steps: 369 | Train Loss: 1.624 Vali Loss: 1.851 Vali Acc: 0.660 Test Loss: 1.851 Test Acc: 0.660
Validation loss decreased (-0.650955 --> -0.660027).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6251608
	speed: 0.3102s/iter; left time: 11187.1306s
	iters: 200, epoch: 3 | loss: 1.0888412
	speed: 0.1025s/iter; left time: 3684.5575s
	iters: 300, epoch: 3 | loss: 1.8838533
	speed: 0.1027s/iter; left time: 3684.0438s
Epoch: 3 cost time: 35.95629858970642
Epoch: 3, Steps: 369 | Train Loss: 2.252 Vali Loss: 2.965 Vali Acc: 0.646 Test Loss: 2.965 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2993004
	speed: 0.3979s/iter; left time: 14203.1972s
	iters: 200, epoch: 4 | loss: 2.3687532
	speed: 0.1008s/iter; left time: 3588.9690s
	iters: 300, epoch: 4 | loss: 3.6211090
	speed: 0.0740s/iter; left time: 2625.1136s
Epoch: 4 cost time: 33.5017249584198
Epoch: 4, Steps: 369 | Train Loss: 2.346 Vali Loss: 2.979 Vali Acc: 0.639 Test Loss: 2.979 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.1090612
	speed: 0.2997s/iter; left time: 10585.6289s
	iters: 200, epoch: 5 | loss: 2.7760487
	speed: 0.0744s/iter; left time: 2620.1170s
	iters: 300, epoch: 5 | loss: 1.1428773
	speed: 0.0729s/iter; left time: 2558.8760s
Epoch: 5 cost time: 27.7974853515625
Epoch: 5, Steps: 369 | Train Loss: 2.347 Vali Loss: 4.176 Vali Acc: 0.596 Test Loss: 4.176 Test Acc: 0.596
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0114740
	speed: 0.3387s/iter; left time: 11839.5727s
	iters: 200, epoch: 6 | loss: 1.1065379
	speed: 0.0991s/iter; left time: 3453.8814s
	iters: 300, epoch: 6 | loss: 2.1668751
	speed: 0.0994s/iter; left time: 3455.9252s
Epoch: 6 cost time: 37.62350368499756
Epoch: 6, Steps: 369 | Train Loss: 2.016 Vali Loss: 5.108 Vali Acc: 0.628 Test Loss: 5.108 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9103062
	speed: 0.3878s/iter; left time: 13412.3597s
	iters: 200, epoch: 7 | loss: 1.3690792
	speed: 0.0776s/iter; left time: 2675.8751s
	iters: 300, epoch: 7 | loss: 1.2203102
	speed: 0.0781s/iter; left time: 2684.6174s
Epoch: 7 cost time: 31.161455631256104
Epoch: 7, Steps: 369 | Train Loss: 1.688 Vali Loss: 4.104 Vali Acc: 0.637 Test Loss: 4.104 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.4550636
	speed: 0.3040s/iter; left time: 10402.5909s
	iters: 200, epoch: 8 | loss: 1.1377332
	speed: 0.0755s/iter; left time: 2576.6307s
	iters: 300, epoch: 8 | loss: 0.4670249
	speed: 0.0750s/iter; left time: 2550.4776s
Epoch: 8 cost time: 28.661855697631836
Epoch: 8, Steps: 369 | Train Loss: 1.314 Vali Loss: 4.586 Vali Acc: 0.636 Test Loss: 4.586 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.4012904
	speed: 0.3850s/iter; left time: 13032.7275s
	iters: 200, epoch: 9 | loss: 0.1069603
	speed: 0.1025s/iter; left time: 3460.6306s
	iters: 300, epoch: 9 | loss: 0.4874647
	speed: 0.1029s/iter; left time: 3463.7109s
Epoch: 9 cost time: 39.05617713928223
Epoch: 9, Steps: 369 | Train Loss: 0.971 Vali Loss: 4.419 Vali Acc: 0.625 Test Loss: 4.419 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2505980
	speed: 0.3514s/iter; left time: 11763.2646s
	iters: 200, epoch: 10 | loss: 0.9338764
	speed: 0.0781s/iter; left time: 2606.7656s
	iters: 300, epoch: 10 | loss: 1.8271894
	speed: 0.0779s/iter; left time: 2592.2038s
Epoch: 10 cost time: 29.15800905227661
Epoch: 10, Steps: 369 | Train Loss: 0.706 Vali Loss: 3.707 Vali Acc: 0.643 Test Loss: 3.707 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.3524746
	speed: 0.3056s/iter; left time: 10118.5930s
	iters: 200, epoch: 11 | loss: 0.0472113
	speed: 0.0767s/iter; left time: 2531.3748s
	iters: 300, epoch: 11 | loss: 0.5404634
	speed: 0.1022s/iter; left time: 3364.1185s
Epoch: 11 cost time: 33.195176124572754
Epoch: 11, Steps: 369 | Train Loss: 0.448 Vali Loss: 3.508 Vali Acc: 0.637 Test Loss: 3.508 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.4636005
	speed: 0.3979s/iter; left time: 13028.6480s
	iters: 200, epoch: 12 | loss: 0.8375111
	speed: 0.1021s/iter; left time: 3333.8111s
	iters: 300, epoch: 12 | loss: 0.5258268
	speed: 0.1017s/iter; left time: 3309.7805s
Epoch: 12 cost time: 36.90251874923706
Epoch: 12, Steps: 369 | Train Loss: 0.320 Vali Loss: 3.049 Vali Acc: 0.647 Test Loss: 3.049 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6600454029511919
model parameter : 327490
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3750263
	speed: 0.1065s/iter; left time: 3920.0212s
	iters: 200, epoch: 1 | loss: 1.0441043
	speed: 0.0869s/iter; left time: 3188.7359s
	iters: 300, epoch: 1 | loss: 1.5606861
	speed: 0.0844s/iter; left time: 3089.2942s
Epoch: 1 cost time: 33.77673888206482
Epoch: 1, Steps: 369 | Train Loss: 1.230 Vali Loss: 1.017 Vali Acc: 0.645 Test Loss: 1.017 Test Acc: 0.645
Validation loss decreased (inf --> -0.644712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9134438
	speed: 0.2799s/iter; left time: 10196.7286s
	iters: 200, epoch: 2 | loss: 0.5089466
	speed: 0.0613s/iter; left time: 2226.0197s
	iters: 300, epoch: 2 | loss: 1.0161529
	speed: 0.0602s/iter; left time: 2179.3663s
Epoch: 2 cost time: 22.866536140441895
Epoch: 2, Steps: 369 | Train Loss: 1.491 Vali Loss: 1.586 Vali Acc: 0.638 Test Loss: 1.586 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1866133
	speed: 0.2350s/iter; left time: 8475.5494s
	iters: 200, epoch: 3 | loss: 0.8767672
	speed: 0.0595s/iter; left time: 2140.3154s
	iters: 300, epoch: 3 | loss: 1.0017673
	speed: 0.0603s/iter; left time: 2164.1027s
Epoch: 3 cost time: 22.676458835601807
Epoch: 3, Steps: 369 | Train Loss: 1.913 Vali Loss: 2.532 Vali Acc: 0.637 Test Loss: 2.532 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1398660
	speed: 0.2218s/iter; left time: 7916.9382s
	iters: 200, epoch: 4 | loss: 2.5120308
	speed: 0.0533s/iter; left time: 1898.2720s
	iters: 300, epoch: 4 | loss: 1.2239166
	speed: 0.0751s/iter; left time: 2664.0757s
Epoch: 4 cost time: 23.426332712173462
Epoch: 4, Steps: 369 | Train Loss: 1.989 Vali Loss: 2.846 Vali Acc: 0.644 Test Loss: 2.846 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.4956174
	speed: 0.2244s/iter; left time: 7928.2253s
	iters: 200, epoch: 5 | loss: 3.0333145
	speed: 0.0463s/iter; left time: 1632.1712s
	iters: 300, epoch: 5 | loss: 1.2102108
	speed: 0.0466s/iter; left time: 1638.3292s
Epoch: 5 cost time: 17.711718559265137
Epoch: 5, Steps: 369 | Train Loss: 1.947 Vali Loss: 4.029 Vali Acc: 0.630 Test Loss: 4.029 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.5647169
	speed: 0.1824s/iter; left time: 6374.8520s
	iters: 200, epoch: 6 | loss: 1.3493621
	speed: 0.0478s/iter; left time: 1667.2140s
	iters: 300, epoch: 6 | loss: 1.2579299
	speed: 0.0654s/iter; left time: 2273.9996s
Epoch: 6 cost time: 21.504677772521973
Epoch: 6, Steps: 369 | Train Loss: 1.842 Vali Loss: 5.077 Vali Acc: 0.647 Test Loss: 5.077 Test Acc: 0.647
Validation loss decreased (-0.644712 --> -0.646658).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7079834
	speed: 0.2788s/iter; left time: 9642.6351s
	iters: 200, epoch: 7 | loss: 2.8329716
	speed: 0.0746s/iter; left time: 2572.8350s
	iters: 300, epoch: 7 | loss: 0.6171723
	speed: 0.0748s/iter; left time: 2573.5968s
Epoch: 7 cost time: 28.308096408843994
Epoch: 7, Steps: 369 | Train Loss: 1.493 Vali Loss: 4.855 Vali Acc: 0.628 Test Loss: 4.855 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4512606
	speed: 0.2531s/iter; left time: 8661.3210s
	iters: 200, epoch: 8 | loss: 0.0006286
	speed: 0.0548s/iter; left time: 1869.6495s
	iters: 300, epoch: 8 | loss: 0.4179901
	speed: 0.0543s/iter; left time: 1847.3014s
Epoch: 8 cost time: 21.323312044143677
Epoch: 8, Steps: 369 | Train Loss: 1.144 Vali Loss: 4.200 Vali Acc: 0.642 Test Loss: 4.200 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2254651
	speed: 0.2307s/iter; left time: 7809.4403s
	iters: 200, epoch: 9 | loss: 0.3825584
	speed: 0.0570s/iter; left time: 1924.7295s
	iters: 300, epoch: 9 | loss: 0.3052151
	speed: 0.0565s/iter; left time: 1900.1973s
Epoch: 9 cost time: 21.896058320999146
Epoch: 9, Steps: 369 | Train Loss: 0.852 Vali Loss: 4.397 Vali Acc: 0.635 Test Loss: 4.397 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0132748
	speed: 0.2646s/iter; left time: 8858.8515s
	iters: 200, epoch: 10 | loss: 0.0836881
	speed: 0.0738s/iter; left time: 2463.9764s
	iters: 300, epoch: 10 | loss: 0.5899022
	speed: 0.0731s/iter; left time: 2431.2914s
Epoch: 10 cost time: 27.99598526954651
Epoch: 10, Steps: 369 | Train Loss: 0.586 Vali Loss: 3.793 Vali Acc: 0.647 Test Loss: 3.793 Test Acc: 0.647
Validation loss decreased (-0.646658 --> -0.646670).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3057137
	speed: 0.2547s/iter; left time: 8432.5315s
	iters: 200, epoch: 11 | loss: 0.1064666
	speed: 0.0584s/iter; left time: 1926.3627s
	iters: 300, epoch: 11 | loss: 0.4011690
	speed: 0.0577s/iter; left time: 1900.1852s
Epoch: 11 cost time: 21.84680938720703
Epoch: 11, Steps: 369 | Train Loss: 0.417 Vali Loss: 3.076 Vali Acc: 0.642 Test Loss: 3.076 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1065389
	speed: 0.2311s/iter; left time: 7566.6650s
	iters: 200, epoch: 12 | loss: 0.0002817
	speed: 0.0582s/iter; left time: 1898.8022s
	iters: 300, epoch: 12 | loss: 0.5409687
	speed: 0.0578s/iter; left time: 1879.4391s
Epoch: 12 cost time: 22.000065326690674
Epoch: 12, Steps: 369 | Train Loss: 0.309 Vali Loss: 2.927 Vali Acc: 0.644 Test Loss: 2.927 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7714812
	speed: 0.2591s/iter; left time: 8388.3233s
	iters: 200, epoch: 13 | loss: 0.1316777
	speed: 0.0763s/iter; left time: 2463.6213s
	iters: 300, epoch: 13 | loss: 0.2953961
	speed: 0.0760s/iter; left time: 2444.2918s
Epoch: 13 cost time: 28.83337140083313
Epoch: 13, Steps: 369 | Train Loss: 0.221 Vali Loss: 2.547 Vali Acc: 0.646 Test Loss: 2.547 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0016240
	speed: 0.2808s/iter; left time: 8985.9352s
	iters: 200, epoch: 14 | loss: 0.0531106
	speed: 0.0605s/iter; left time: 1928.8370s
	iters: 300, epoch: 14 | loss: 0.0020523
	speed: 0.0607s/iter; left time: 1930.7660s
Epoch: 14 cost time: 24.628808736801147
Epoch: 14, Steps: 369 | Train Loss: 0.170 Vali Loss: 2.408 Vali Acc: 0.642 Test Loss: 2.408 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0933002
	speed: 0.2392s/iter; left time: 7566.2521s
	iters: 200, epoch: 15 | loss: 0.0184698
	speed: 0.0588s/iter; left time: 1853.4442s
	iters: 300, epoch: 15 | loss: 0.2430609
	speed: 0.0582s/iter; left time: 1828.9930s
Epoch: 15 cost time: 22.408398866653442
Epoch: 15, Steps: 369 | Train Loss: 0.117 Vali Loss: 2.425 Vali Acc: 0.647 Test Loss: 2.425 Test Acc: 0.647
Validation loss decreased (-0.646670 --> -0.647252).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1298782
	speed: 0.2616s/iter; left time: 8178.4583s
	iters: 200, epoch: 16 | loss: 0.2269189
	speed: 0.0740s/iter; left time: 2306.0202s
	iters: 300, epoch: 16 | loss: 0.0046437
	speed: 0.0738s/iter; left time: 2294.0463s
Epoch: 16 cost time: 28.10626745223999
Epoch: 16, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.227 Vali Acc: 0.658 Test Loss: 2.227 Test Acc: 0.658
Validation loss decreased (-0.647252 --> -0.658037).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0022016
	speed: 0.2783s/iter; left time: 8599.1224s
	iters: 200, epoch: 17 | loss: 0.0313220
	speed: 0.0569s/iter; left time: 1752.0643s
	iters: 300, epoch: 17 | loss: 0.0021662
	speed: 0.0582s/iter; left time: 1787.2824s
Epoch: 17 cost time: 23.65523672103882
Epoch: 17, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.381 Vali Acc: 0.643 Test Loss: 2.381 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1274285
	speed: 0.2310s/iter; left time: 7051.6031s
	iters: 200, epoch: 18 | loss: 0.0048058
	speed: 0.0572s/iter; left time: 1741.3050s
	iters: 300, epoch: 18 | loss: 0.0863829
	speed: 0.0572s/iter; left time: 1735.4234s
Epoch: 18 cost time: 21.901665449142456
Epoch: 18, Steps: 369 | Train Loss: 0.077 Vali Loss: 2.372 Vali Acc: 0.636 Test Loss: 2.372 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0953576
	speed: 0.2477s/iter; left time: 7470.4643s
	iters: 200, epoch: 19 | loss: 0.0091110
	speed: 0.0741s/iter; left time: 2228.2460s
	iters: 300, epoch: 19 | loss: 0.1904908
	speed: 0.0738s/iter; left time: 2211.7009s
Epoch: 19 cost time: 28.07922649383545
Epoch: 19, Steps: 369 | Train Loss: 0.076 Vali Loss: 2.487 Vali Acc: 0.647 Test Loss: 2.487 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0007698
	speed: 0.2773s/iter; left time: 8259.7535s
	iters: 200, epoch: 20 | loss: 0.0139633
	speed: 0.0752s/iter; left time: 2234.0893s
	iters: 300, epoch: 20 | loss: 0.0223251
	speed: 0.0567s/iter; left time: 1678.2466s
Epoch: 20 cost time: 25.455559730529785
Epoch: 20, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.356 Vali Acc: 0.650 Test Loss: 2.356 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0041058
	speed: 0.2432s/iter; left time: 7154.0421s
	iters: 200, epoch: 21 | loss: 0.0015572
	speed: 0.0550s/iter; left time: 1613.6312s
	iters: 300, epoch: 21 | loss: 0.0041229
	speed: 0.0576s/iter; left time: 1683.1779s
Epoch: 21 cost time: 21.838510990142822
Epoch: 21, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.464 Vali Acc: 0.648 Test Loss: 2.464 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0111956
	speed: 0.2411s/iter; left time: 7003.4066s
	iters: 200, epoch: 22 | loss: 0.0019808
	speed: 0.0768s/iter; left time: 2224.2353s
	iters: 300, epoch: 22 | loss: 0.0091610
	speed: 0.0763s/iter; left time: 2202.7739s
Epoch: 22 cost time: 27.93768858909607
Epoch: 22, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.379 Vali Acc: 0.649 Test Loss: 2.379 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0063876
	speed: 0.2853s/iter; left time: 8182.5174s
	iters: 200, epoch: 23 | loss: 0.1201807
	speed: 0.0752s/iter; left time: 2149.1042s
	iters: 300, epoch: 23 | loss: 0.0219596
	speed: 0.0744s/iter; left time: 2119.6673s
Epoch: 23 cost time: 27.171805381774902
Epoch: 23, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.561 Vali Acc: 0.653 Test Loss: 2.561 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0121102
	speed: 0.2386s/iter; left time: 6755.7447s
	iters: 200, epoch: 24 | loss: 0.0000416
	speed: 0.0577s/iter; left time: 1628.2614s
	iters: 300, epoch: 24 | loss: 0.4864807
	speed: 0.0552s/iter; left time: 1553.2266s
Epoch: 24 cost time: 22.05899715423584
Epoch: 24, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.481 Vali Acc: 0.659 Test Loss: 2.481 Test Acc: 0.659
Validation loss decreased (-0.658037 --> -0.658886).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0684349
	speed: 0.2386s/iter; left time: 6668.6858s
	iters: 200, epoch: 25 | loss: 0.1838864
	speed: 0.0647s/iter; left time: 1802.6773s
	iters: 300, epoch: 25 | loss: 0.2144338
	speed: 0.0745s/iter; left time: 2066.1872s
Epoch: 25 cost time: 25.113912105560303
Epoch: 25, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.546 Vali Acc: 0.647 Test Loss: 2.546 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0002659
	speed: 0.2853s/iter; left time: 7868.5814s
	iters: 200, epoch: 26 | loss: 0.0101057
	speed: 0.0754s/iter; left time: 2073.0074s
	iters: 300, epoch: 26 | loss: 0.0355616
	speed: 0.0753s/iter; left time: 2061.5679s
Epoch: 26 cost time: 28.641581296920776
Epoch: 26, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.630 Vali Acc: 0.656 Test Loss: 2.630 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.4607448
	speed: 0.2548s/iter; left time: 6932.8926s
	iters: 200, epoch: 27 | loss: 0.0003393
	speed: 0.0570s/iter; left time: 1545.8352s
	iters: 300, epoch: 27 | loss: 0.0005891
	speed: 0.0535s/iter; left time: 1445.1635s
Epoch: 27 cost time: 21.574402809143066
Epoch: 27, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.595 Vali Acc: 0.655 Test Loss: 2.595 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0003729
	speed: 0.2373s/iter; left time: 6369.3197s
	iters: 200, epoch: 28 | loss: 0.0522385
	speed: 0.0559s/iter; left time: 1495.2551s
	iters: 300, epoch: 28 | loss: 0.0400631
	speed: 0.0619s/iter; left time: 1648.4438s
Epoch: 28 cost time: 23.4441397190094
Epoch: 28, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.718 Vali Acc: 0.656 Test Loss: 2.718 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0009394
	speed: 0.2882s/iter; left time: 7627.0925s
	iters: 200, epoch: 29 | loss: 0.0131299
	speed: 0.0748s/iter; left time: 1971.9853s
	iters: 300, epoch: 29 | loss: 0.0000644
	speed: 0.0732s/iter; left time: 1923.9122s
Epoch: 29 cost time: 28.22242784500122
Epoch: 29, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.674 Vali Acc: 0.655 Test Loss: 2.674 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0001660
	speed: 0.2602s/iter; left time: 6792.1187s
	iters: 200, epoch: 30 | loss: 0.0002922
	speed: 0.0592s/iter; left time: 1539.3681s
	iters: 300, epoch: 30 | loss: 0.0139358
	speed: 0.0583s/iter; left time: 1509.6296s
Epoch: 30 cost time: 22.861063957214355
Epoch: 30, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.636 Vali Acc: 0.654 Test Loss: 2.636 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0041201
	speed: 0.2376s/iter; left time: 6113.5041s
	iters: 200, epoch: 31 | loss: 0.0000945
	speed: 0.0591s/iter; left time: 1514.1337s
	iters: 300, epoch: 31 | loss: 0.0216194
	speed: 0.0574s/iter; left time: 1464.4131s
Epoch: 31 cost time: 23.703827381134033
Epoch: 31, Steps: 369 | Train Loss: 0.037 Vali Loss: 2.731 Vali Acc: 0.659 Test Loss: 2.731 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0007300
	speed: 0.2821s/iter; left time: 7154.8431s
	iters: 200, epoch: 32 | loss: 0.0042429
	speed: 0.0750s/iter; left time: 1894.8082s
	iters: 300, epoch: 32 | loss: 0.0248665
	speed: 0.0762s/iter; left time: 1917.1982s
Epoch: 32 cost time: 28.68492579460144
Epoch: 32, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.908 Vali Acc: 0.636 Test Loss: 2.908 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0031443
	speed: 0.2594s/iter; left time: 6483.9446s
	iters: 200, epoch: 33 | loss: 0.0011944
	speed: 0.0582s/iter; left time: 1449.6540s
	iters: 300, epoch: 33 | loss: 0.0782175
	speed: 0.0565s/iter; left time: 1401.3304s
Epoch: 33 cost time: 22.120147466659546
Epoch: 33, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.855 Vali Acc: 0.651 Test Loss: 2.855 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0051933
	speed: 0.2392s/iter; left time: 5890.7246s
	iters: 200, epoch: 34 | loss: 0.0832451
	speed: 0.0582s/iter; left time: 1426.4293s
	iters: 300, epoch: 34 | loss: 0.0030830
	speed: 0.0587s/iter; left time: 1434.2909s
Epoch: 34 cost time: 22.41014337539673
Epoch: 34, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.808 Vali Acc: 0.654 Test Loss: 2.808 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6589103291713961
model parameter : 272386
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0218072
	speed: 0.0708s/iter; left time: 2605.9837s
	iters: 200, epoch: 1 | loss: 1.4836456
	speed: 0.0510s/iter; left time: 1873.0301s
	iters: 300, epoch: 1 | loss: 0.5363455
	speed: 0.0515s/iter; left time: 1883.1570s
Epoch: 1 cost time: 20.985944509506226
Epoch: 1, Steps: 369 | Train Loss: 1.086 Vali Loss: 0.825 Vali Acc: 0.658 Test Loss: 0.825 Test Acc: 0.658
Validation loss decreased (inf --> -0.657767).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1567459
	speed: 0.2050s/iter; left time: 7467.7149s
	iters: 200, epoch: 2 | loss: 1.0498686
	speed: 0.0514s/iter; left time: 1867.4453s
	iters: 300, epoch: 2 | loss: 1.2083038
	speed: 0.0523s/iter; left time: 1895.1198s
Epoch: 2 cost time: 19.651740789413452
Epoch: 2, Steps: 369 | Train Loss: 1.242 Vali Loss: 1.585 Vali Acc: 0.640 Test Loss: 1.585 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8627832
	speed: 0.2420s/iter; left time: 8726.1998s
	iters: 200, epoch: 3 | loss: 2.7969117
	speed: 0.0672s/iter; left time: 2416.2250s
	iters: 300, epoch: 3 | loss: 1.3351837
	speed: 0.0668s/iter; left time: 2396.2164s
Epoch: 3 cost time: 25.586538791656494
Epoch: 3, Steps: 369 | Train Loss: 1.617 Vali Loss: 2.918 Vali Acc: 0.639 Test Loss: 2.918 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8110045
	speed: 0.2462s/iter; left time: 8787.9119s
	iters: 200, epoch: 4 | loss: 3.9333136
	speed: 0.0518s/iter; left time: 1842.7734s
	iters: 300, epoch: 4 | loss: 2.3415551
	speed: 0.0530s/iter; left time: 1880.9481s
Epoch: 4 cost time: 20.410753965377808
Epoch: 4, Steps: 369 | Train Loss: 1.709 Vali Loss: 2.729 Vali Acc: 0.655 Test Loss: 2.729 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1519438
	speed: 0.2176s/iter; left time: 7688.3681s
	iters: 200, epoch: 5 | loss: 2.9771898
	speed: 0.0520s/iter; left time: 1832.5905s
	iters: 300, epoch: 5 | loss: 1.0434180
	speed: 0.0501s/iter; left time: 1759.5323s
Epoch: 5 cost time: 19.407783269882202
Epoch: 5, Steps: 369 | Train Loss: 1.693 Vali Loss: 2.993 Vali Acc: 0.648 Test Loss: 2.993 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.4982166
	speed: 0.2278s/iter; left time: 7963.0563s
	iters: 200, epoch: 6 | loss: 0.0561284
	speed: 0.0685s/iter; left time: 2386.2868s
	iters: 300, epoch: 6 | loss: 1.9537694
	speed: 0.0699s/iter; left time: 2428.3903s
Epoch: 6 cost time: 25.68972945213318
Epoch: 6, Steps: 369 | Train Loss: 1.597 Vali Loss: 3.171 Vali Acc: 0.650 Test Loss: 3.171 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.5025647
	speed: 0.2584s/iter; left time: 8938.0545s
	iters: 200, epoch: 7 | loss: 0.9118500
	speed: 0.0685s/iter; left time: 2360.8443s
	iters: 300, epoch: 7 | loss: 1.6047736
	speed: 0.0635s/iter; left time: 2182.9419s
Epoch: 7 cost time: 24.263527870178223
Epoch: 7, Steps: 369 | Train Loss: 1.250 Vali Loss: 3.645 Vali Acc: 0.635 Test Loss: 3.645 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.0121391
	speed: 0.2215s/iter; left time: 7578.3689s
	iters: 200, epoch: 8 | loss: 0.4408580
	speed: 0.0504s/iter; left time: 1719.2240s
	iters: 300, epoch: 8 | loss: 0.6102256
	speed: 0.0517s/iter; left time: 1758.6597s
Epoch: 8 cost time: 19.880488872528076
Epoch: 8, Steps: 369 | Train Loss: 0.990 Vali Loss: 3.819 Vali Acc: 0.633 Test Loss: 3.819 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0934527
	speed: 0.2211s/iter; left time: 7482.6389s
	iters: 200, epoch: 9 | loss: 0.2157245
	speed: 0.0671s/iter; left time: 2263.6430s
	iters: 300, epoch: 9 | loss: 1.0922940
	speed: 0.0685s/iter; left time: 2303.6598s
Epoch: 9 cost time: 24.088119983673096
Epoch: 9, Steps: 369 | Train Loss: 0.756 Vali Loss: 3.838 Vali Acc: 0.630 Test Loss: 3.838 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.4827324
	speed: 0.2596s/iter; left time: 8690.6332s
	iters: 200, epoch: 10 | loss: 0.0222400
	speed: 0.0681s/iter; left time: 2272.6469s
	iters: 300, epoch: 10 | loss: 0.6191160
	speed: 0.0677s/iter; left time: 2253.6167s
Epoch: 10 cost time: 25.860973834991455
Epoch: 10, Steps: 369 | Train Loss: 0.604 Vali Loss: 3.554 Vali Acc: 0.636 Test Loss: 3.554 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0180938
	speed: 0.2286s/iter; left time: 7569.5391s
	iters: 200, epoch: 11 | loss: 1.2726623
	speed: 0.0527s/iter; left time: 1739.1156s
	iters: 300, epoch: 11 | loss: 0.6181384
	speed: 0.0487s/iter; left time: 1603.6796s
Epoch: 11 cost time: 19.494475841522217
Epoch: 11, Steps: 369 | Train Loss: 0.455 Vali Loss: 3.014 Vali Acc: 0.639 Test Loss: 3.014 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 217282
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7953264
	speed: 0.0768s/iter; left time: 2826.8152s
	iters: 200, epoch: 1 | loss: 0.4889194
	speed: 0.0545s/iter; left time: 2000.3776s
	iters: 300, epoch: 1 | loss: 0.7718902
	speed: 0.0540s/iter; left time: 1978.0731s
Epoch: 1 cost time: 22.4701144695282
Epoch: 1, Steps: 369 | Train Loss: 0.995 Vali Loss: 0.797 Vali Acc: 0.650 Test Loss: 0.797 Test Acc: 0.650
Validation loss decreased (inf --> -0.649538).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5367445
	speed: 0.2075s/iter; left time: 7560.4473s
	iters: 200, epoch: 2 | loss: 2.2197003
	speed: 0.0422s/iter; left time: 1534.9686s
	iters: 300, epoch: 2 | loss: 0.9966958
	speed: 0.0420s/iter; left time: 1523.3044s
Epoch: 2 cost time: 16.126169681549072
Epoch: 2, Steps: 369 | Train Loss: 1.170 Vali Loss: 1.523 Vali Acc: 0.644 Test Loss: 1.523 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8404307
	speed: 0.1847s/iter; left time: 6659.6161s
	iters: 200, epoch: 3 | loss: 1.0032804
	speed: 0.0423s/iter; left time: 1521.9911s
	iters: 300, epoch: 3 | loss: 1.5283170
	speed: 0.0435s/iter; left time: 1560.9177s
Epoch: 3 cost time: 16.246455430984497
Epoch: 3, Steps: 369 | Train Loss: 1.387 Vali Loss: 2.311 Vali Acc: 0.632 Test Loss: 2.311 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4175307
	speed: 0.1822s/iter; left time: 6502.4637s
	iters: 200, epoch: 4 | loss: 1.8623501
	speed: 0.0570s/iter; left time: 2029.1259s
	iters: 300, epoch: 4 | loss: 1.9687744
	speed: 0.0571s/iter; left time: 2026.7808s
Epoch: 4 cost time: 20.2324059009552
Epoch: 4, Steps: 369 | Train Loss: 1.583 Vali Loss: 2.660 Vali Acc: 0.646 Test Loss: 2.660 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0011668
	speed: 0.2242s/iter; left time: 7920.6566s
	iters: 200, epoch: 5 | loss: 2.1934538
	speed: 0.0576s/iter; left time: 2027.2913s
	iters: 300, epoch: 5 | loss: 2.6013680
	speed: 0.0575s/iter; left time: 2018.3091s
Epoch: 5 cost time: 22.153926372528076
Epoch: 5, Steps: 369 | Train Loss: 1.443 Vali Loss: 2.763 Vali Acc: 0.629 Test Loss: 2.763 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.4928788
	speed: 0.2067s/iter; left time: 7224.8739s
	iters: 200, epoch: 6 | loss: 1.1910933
	speed: 0.0426s/iter; left time: 1484.1686s
	iters: 300, epoch: 6 | loss: 0.8966646
	speed: 0.0416s/iter; left time: 1446.1844s
Epoch: 6 cost time: 16.375945568084717
Epoch: 6, Steps: 369 | Train Loss: 1.269 Vali Loss: 3.185 Vali Acc: 0.610 Test Loss: 3.185 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.2329806
	speed: 0.1943s/iter; left time: 6721.9363s
	iters: 200, epoch: 7 | loss: 0.5920922
	speed: 0.0428s/iter; left time: 1477.0578s
	iters: 300, epoch: 7 | loss: 1.7095934
	speed: 0.0432s/iter; left time: 1486.8009s
Epoch: 7 cost time: 16.959028005599976
Epoch: 7, Steps: 369 | Train Loss: 1.040 Vali Loss: 3.689 Vali Acc: 0.643 Test Loss: 3.689 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1029117
	speed: 0.2173s/iter; left time: 7436.9747s
	iters: 200, epoch: 8 | loss: 0.3909825
	speed: 0.0582s/iter; left time: 1987.0102s
	iters: 300, epoch: 8 | loss: 0.5334653
	speed: 0.0584s/iter; left time: 1985.0759s
Epoch: 8 cost time: 22.450042247772217
Epoch: 8, Steps: 369 | Train Loss: 0.881 Vali Loss: 3.507 Vali Acc: 0.632 Test Loss: 3.507 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.1591635
	speed: 0.2315s/iter; left time: 7835.6880s
	iters: 200, epoch: 9 | loss: 0.7807232
	speed: 0.0568s/iter; left time: 1917.7827s
	iters: 300, epoch: 9 | loss: 1.1691531
	speed: 0.0528s/iter; left time: 1777.3015s
Epoch: 9 cost time: 20.263848304748535
Epoch: 9, Steps: 369 | Train Loss: 0.642 Vali Loss: 3.429 Vali Acc: 0.654 Test Loss: 3.429 Test Acc: 0.654
Validation loss decreased (-0.649538 --> -0.653768).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0413886
	speed: 0.1915s/iter; left time: 6410.0179s
	iters: 200, epoch: 10 | loss: 1.3960197
	speed: 0.0416s/iter; left time: 1387.9954s
	iters: 300, epoch: 10 | loss: 0.0444197
	speed: 0.0417s/iter; left time: 1387.5336s
Epoch: 10 cost time: 16.16987156867981
Epoch: 10, Steps: 369 | Train Loss: 0.502 Vali Loss: 3.237 Vali Acc: 0.635 Test Loss: 3.237 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5957295
	speed: 0.1956s/iter; left time: 6478.0688s
	iters: 200, epoch: 11 | loss: 0.0960451
	speed: 0.0415s/iter; left time: 1370.5845s
	iters: 300, epoch: 11 | loss: 0.5063446
	speed: 0.0408s/iter; left time: 1341.2086s
Epoch: 11 cost time: 15.709197759628296
Epoch: 11, Steps: 369 | Train Loss: 0.400 Vali Loss: 2.974 Vali Acc: 0.647 Test Loss: 2.974 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2481829
	speed: 0.1878s/iter; left time: 6150.0846s
	iters: 200, epoch: 12 | loss: 0.0522104
	speed: 0.0330s/iter; left time: 1078.6462s
	iters: 300, epoch: 12 | loss: 0.0172853
	speed: 0.0334s/iter; left time: 1088.4068s
Epoch: 12 cost time: 14.40292477607727
Epoch: 12, Steps: 369 | Train Loss: 0.301 Vali Loss: 2.717 Vali Acc: 0.638 Test Loss: 2.717 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6046584
	speed: 0.1612s/iter; left time: 5217.7386s
	iters: 200, epoch: 13 | loss: 0.1895972
	speed: 0.0334s/iter; left time: 1078.8926s
	iters: 300, epoch: 13 | loss: 0.1632688
	speed: 0.0331s/iter; left time: 1065.1447s
Epoch: 13 cost time: 13.07913327217102
Epoch: 13, Steps: 369 | Train Loss: 0.227 Vali Loss: 2.649 Vali Acc: 0.652 Test Loss: 2.649 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.7424953
	speed: 0.1573s/iter; left time: 5035.7900s
	iters: 200, epoch: 14 | loss: 0.0895883
	speed: 0.0558s/iter; left time: 1780.1622s
	iters: 300, epoch: 14 | loss: 0.4391190
	speed: 0.0553s/iter; left time: 1759.3786s
Epoch: 14 cost time: 19.19671940803528
Epoch: 14, Steps: 369 | Train Loss: 0.192 Vali Loss: 2.551 Vali Acc: 0.647 Test Loss: 2.551 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0517749
	speed: 0.2209s/iter; left time: 6988.0760s
	iters: 200, epoch: 15 | loss: 0.5611432
	speed: 0.0566s/iter; left time: 1785.4378s
	iters: 300, epoch: 15 | loss: 0.0428296
	speed: 0.0567s/iter; left time: 1781.3722s
Epoch: 15 cost time: 21.569080591201782
Epoch: 15, Steps: 369 | Train Loss: 0.148 Vali Loss: 2.593 Vali Acc: 0.631 Test Loss: 2.593 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1408172
	speed: 0.2021s/iter; left time: 6317.5987s
	iters: 200, epoch: 16 | loss: 0.4709828
	speed: 0.0432s/iter; left time: 1346.2264s
	iters: 300, epoch: 16 | loss: 0.0138486
	speed: 0.0431s/iter; left time: 1340.4622s
Epoch: 16 cost time: 16.389599800109863
Epoch: 16, Steps: 369 | Train Loss: 0.141 Vali Loss: 2.405 Vali Acc: 0.633 Test Loss: 2.405 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.1587369
	speed: 0.1821s/iter; left time: 5625.7803s
	iters: 200, epoch: 17 | loss: 0.1056684
	speed: 0.0447s/iter; left time: 1376.1248s
	iters: 300, epoch: 17 | loss: 0.0033971
	speed: 0.0432s/iter; left time: 1327.5927s
Epoch: 17 cost time: 17.072070121765137
Epoch: 17, Steps: 369 | Train Loss: 0.110 Vali Loss: 2.443 Vali Acc: 0.645 Test Loss: 2.443 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0011936
	speed: 0.2032s/iter; left time: 6204.7837s
	iters: 200, epoch: 18 | loss: 0.1133426
	speed: 0.0581s/iter; left time: 1767.4412s
	iters: 300, epoch: 18 | loss: 0.0111650
	speed: 0.0568s/iter; left time: 1723.5305s
Epoch: 18 cost time: 21.922435760498047
Epoch: 18, Steps: 369 | Train Loss: 0.097 Vali Loss: 2.477 Vali Acc: 0.638 Test Loss: 2.477 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0063239
	speed: 0.2260s/iter; left time: 6815.1434s
	iters: 200, epoch: 19 | loss: 0.0147833
	speed: 0.0551s/iter; left time: 1655.7709s
	iters: 300, epoch: 19 | loss: 0.0273938
	speed: 0.0466s/iter; left time: 1395.6408s
Epoch: 19 cost time: 19.23388671875
Epoch: 19, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.304 Vali Acc: 0.635 Test Loss: 2.304 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 180610
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 5.0915298
	speed: 0.1877s/iter; left time: 6906.8969s
	iters: 200, epoch: 1 | loss: 1.2792100
	speed: 0.1704s/iter; left time: 6252.0266s
	iters: 300, epoch: 1 | loss: 0.5674281
	speed: 0.1488s/iter; left time: 5447.0498s
Epoch: 1 cost time: 60.490901708602905
Epoch: 1, Steps: 369 | Train Loss: 1.973 Vali Loss: 1.919 Vali Acc: 0.617 Test Loss: 1.919 Test Acc: 0.617
Validation loss decreased (inf --> -0.616610).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8055043
	speed: 0.4910s/iter; left time: 17887.4588s
	iters: 200, epoch: 2 | loss: 3.2443600
	speed: 0.1460s/iter; left time: 5305.1935s
	iters: 300, epoch: 2 | loss: 2.8706295
	speed: 0.1686s/iter; left time: 6109.5559s
Epoch: 2 cost time: 57.824798822402954
Epoch: 2, Steps: 369 | Train Loss: 2.361 Vali Loss: 2.405 Vali Acc: 0.645 Test Loss: 2.405 Test Acc: 0.645
Validation loss decreased (-0.616610 --> -0.645265).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.3896995
	speed: 0.5698s/iter; left time: 20547.0667s
	iters: 200, epoch: 3 | loss: 1.2089351
	speed: 0.1487s/iter; left time: 5348.2553s
	iters: 300, epoch: 3 | loss: 5.2972322
	speed: 0.1434s/iter; left time: 5141.8447s
Epoch: 3 cost time: 56.35089445114136
Epoch: 3, Steps: 369 | Train Loss: 2.899 Vali Loss: 4.293 Vali Acc: 0.628 Test Loss: 4.293 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.0034065
	speed: 0.5442s/iter; left time: 19424.2971s
	iters: 200, epoch: 4 | loss: 7.2600317
	speed: 0.1739s/iter; left time: 6190.8153s
	iters: 300, epoch: 4 | loss: 5.0811224
	speed: 0.1729s/iter; left time: 6136.4331s
Epoch: 4 cost time: 64.70000696182251
Epoch: 4, Steps: 369 | Train Loss: 2.941 Vali Loss: 5.592 Vali Acc: 0.642 Test Loss: 5.592 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.8545496
	speed: 0.5210s/iter; left time: 18404.5467s
	iters: 200, epoch: 5 | loss: 0.0013775
	speed: 0.1404s/iter; left time: 4946.7453s
	iters: 300, epoch: 5 | loss: 0.3200465
	speed: 0.1440s/iter; left time: 5059.4359s
Epoch: 5 cost time: 54.75084567070007
Epoch: 5, Steps: 369 | Train Loss: 2.484 Vali Loss: 5.256 Vali Acc: 0.646 Test Loss: 5.256 Test Acc: 0.646
Validation loss decreased (-0.645265 --> -0.646088).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5459528
	speed: 0.5707s/iter; left time: 19948.8918s
	iters: 200, epoch: 6 | loss: 5.0108366
	speed: 0.1607s/iter; left time: 5599.8139s
	iters: 300, epoch: 6 | loss: 1.5294596
	speed: 0.1390s/iter; left time: 4830.9534s
Epoch: 6 cost time: 57.140509605407715
Epoch: 6, Steps: 369 | Train Loss: 1.835 Vali Loss: 7.020 Vali Acc: 0.632 Test Loss: 7.020 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8571347
	speed: 0.5082s/iter; left time: 17577.3042s
	iters: 200, epoch: 7 | loss: 2.5090215
	speed: 0.1732s/iter; left time: 5974.3736s
	iters: 300, epoch: 7 | loss: 1.1344787
	speed: 0.1727s/iter; left time: 5937.2652s
Epoch: 7 cost time: 62.890458822250366
Epoch: 7, Steps: 369 | Train Loss: 1.263 Vali Loss: 3.890 Vali Acc: 0.634 Test Loss: 3.890 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2201936
	speed: 0.5472s/iter; left time: 18725.7058s
	iters: 200, epoch: 8 | loss: 0.2604484
	speed: 0.1401s/iter; left time: 4781.4637s
	iters: 300, epoch: 8 | loss: 0.5625044
	speed: 0.1443s/iter; left time: 4909.5244s
Epoch: 8 cost time: 53.72448205947876
Epoch: 8, Steps: 369 | Train Loss: 0.572 Vali Loss: 3.602 Vali Acc: 0.623 Test Loss: 3.602 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0190464
	speed: 0.5573s/iter; left time: 18863.9576s
	iters: 200, epoch: 9 | loss: 0.0204586
	speed: 0.1731s/iter; left time: 5843.4438s
	iters: 300, epoch: 9 | loss: 0.2256743
	speed: 0.1737s/iter; left time: 5843.7891s
Epoch: 9 cost time: 62.47378873825073
Epoch: 9, Steps: 369 | Train Loss: 0.318 Vali Loss: 2.577 Vali Acc: 0.641 Test Loss: 2.577 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3194780
	speed: 0.4843s/iter; left time: 16215.1482s
	iters: 200, epoch: 10 | loss: 0.0197650
	speed: 0.1327s/iter; left time: 4431.0048s
	iters: 300, epoch: 10 | loss: 0.0407876
	speed: 0.1585s/iter; left time: 5274.4721s
Epoch: 10 cost time: 54.46773600578308
Epoch: 10, Steps: 369 | Train Loss: 0.183 Vali Loss: 2.199 Vali Acc: 0.639 Test Loss: 2.199 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4511010
	speed: 0.5512s/iter; left time: 18249.8700s
	iters: 200, epoch: 11 | loss: 0.0957608
	speed: 0.1382s/iter; left time: 4561.3013s
	iters: 300, epoch: 11 | loss: 0.1600484
	speed: 0.1393s/iter; left time: 4584.4551s
Epoch: 11 cost time: 54.50767540931702
Epoch: 11, Steps: 369 | Train Loss: 0.100 Vali Loss: 2.000 Vali Acc: 0.628 Test Loss: 2.000 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1307434
	speed: 0.5152s/iter; left time: 16867.5111s
	iters: 200, epoch: 12 | loss: 0.0106548
	speed: 0.1667s/iter; left time: 5442.5223s
	iters: 300, epoch: 12 | loss: 0.3627469
	speed: 0.1660s/iter; left time: 5402.5370s
Epoch: 12 cost time: 62.42177152633667
Epoch: 12, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.100 Vali Acc: 0.639 Test Loss: 2.100 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0643879
	speed: 0.5261s/iter; left time: 17031.0355s
	iters: 200, epoch: 13 | loss: 0.0971948
	speed: 0.1345s/iter; left time: 4341.8521s
	iters: 300, epoch: 13 | loss: 0.0119659
	speed: 0.1367s/iter; left time: 4397.7441s
Epoch: 13 cost time: 51.61426782608032
Epoch: 13, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.233 Vali Acc: 0.625 Test Loss: 2.233 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0023342
	speed: 0.5526s/iter; left time: 17686.8077s
	iters: 200, epoch: 14 | loss: 0.0015049
	speed: 0.1702s/iter; left time: 5429.6589s
	iters: 300, epoch: 14 | loss: 0.0407101
	speed: 0.1604s/iter; left time: 5102.7631s
Epoch: 14 cost time: 60.469523429870605
Epoch: 14, Steps: 369 | Train Loss: 0.037 Vali Loss: 2.596 Vali Acc: 0.623 Test Loss: 2.596 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0004194
	speed: 0.4934s/iter; left time: 15607.5433s
	iters: 200, epoch: 15 | loss: 0.0010774
	speed: 0.1461s/iter; left time: 4607.2302s
	iters: 300, epoch: 15 | loss: 0.0033630
	speed: 0.1628s/iter; left time: 5117.3221s
Epoch: 15 cost time: 56.96998953819275
Epoch: 15, Steps: 369 | Train Loss: 0.033 Vali Loss: 2.774 Vali Acc: 0.644 Test Loss: 2.774 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6461407491486947
model parameter : 613570
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7928511
	speed: 0.0868s/iter; left time: 3195.5798s
	iters: 200, epoch: 1 | loss: 1.1504093
	speed: 0.0762s/iter; left time: 2797.6367s
	iters: 300, epoch: 1 | loss: 0.5578040
	speed: 0.0772s/iter; left time: 2825.4696s
Epoch: 1 cost time: 29.603224515914917
Epoch: 1, Steps: 369 | Train Loss: 1.426 Vali Loss: 1.415 Vali Acc: 0.619 Test Loss: 1.415 Test Acc: 0.619
Validation loss decreased (inf --> -0.618601).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5321132
	speed: 0.3090s/iter; left time: 11258.2278s
	iters: 200, epoch: 2 | loss: 1.3206563
	speed: 0.0784s/iter; left time: 2848.9379s
	iters: 300, epoch: 2 | loss: 1.4509897
	speed: 0.0789s/iter; left time: 2859.7866s
Epoch: 2 cost time: 28.824705362319946
Epoch: 2, Steps: 369 | Train Loss: 1.618 Vali Loss: 1.711 Vali Acc: 0.641 Test Loss: 1.711 Test Acc: 0.641
Validation loss decreased (-0.618601 --> -0.640732).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4614704
	speed: 0.2613s/iter; left time: 9423.6764s
	iters: 200, epoch: 3 | loss: 5.2453475
	speed: 0.0653s/iter; left time: 2349.7096s
	iters: 300, epoch: 3 | loss: 2.7409954
	speed: 0.0682s/iter; left time: 2446.3342s
Epoch: 3 cost time: 25.364591360092163
Epoch: 3, Steps: 369 | Train Loss: 1.941 Vali Loss: 2.647 Vali Acc: 0.655 Test Loss: 2.647 Test Acc: 0.655
Validation loss decreased (-0.640732 --> -0.654911).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3419814
	speed: 0.2815s/iter; left time: 10047.6789s
	iters: 200, epoch: 4 | loss: 3.3265834
	speed: 0.0803s/iter; left time: 2856.4762s
	iters: 300, epoch: 4 | loss: 2.3112345
	speed: 0.0791s/iter; left time: 2809.3422s
Epoch: 4 cost time: 30.192352533340454
Epoch: 4, Steps: 369 | Train Loss: 1.953 Vali Loss: 3.602 Vali Acc: 0.615 Test Loss: 3.602 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8305719
	speed: 0.3092s/iter; left time: 10921.4728s
	iters: 200, epoch: 5 | loss: 0.5264243
	speed: 0.0808s/iter; left time: 2846.4019s
	iters: 300, epoch: 5 | loss: 1.3667427
	speed: 0.0681s/iter; left time: 2392.2797s
Epoch: 5 cost time: 28.051218032836914
Epoch: 5, Steps: 369 | Train Loss: 1.743 Vali Loss: 3.068 Vali Acc: 0.645 Test Loss: 3.068 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8810277
	speed: 0.2631s/iter; left time: 9197.4691s
	iters: 200, epoch: 6 | loss: 2.8831108
	speed: 0.0709s/iter; left time: 2471.8895s
	iters: 300, epoch: 6 | loss: 0.6748836
	speed: 0.0680s/iter; left time: 2362.5385s
Epoch: 6 cost time: 26.046122789382935
Epoch: 6, Steps: 369 | Train Loss: 1.271 Vali Loss: 3.544 Vali Acc: 0.633 Test Loss: 3.544 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0398998
	speed: 0.2967s/iter; left time: 10262.7780s
	iters: 200, epoch: 7 | loss: 2.2254755
	speed: 0.0816s/iter; left time: 2813.5856s
	iters: 300, epoch: 7 | loss: 0.2861947
	speed: 0.0815s/iter; left time: 2801.5784s
Epoch: 7 cost time: 30.86562752723694
Epoch: 7, Steps: 369 | Train Loss: 0.842 Vali Loss: 2.907 Vali Acc: 0.623 Test Loss: 2.907 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3922200
	speed: 0.3168s/iter; left time: 10840.0218s
	iters: 200, epoch: 8 | loss: 0.0751688
	speed: 0.0711s/iter; left time: 2425.2261s
	iters: 300, epoch: 8 | loss: 0.4292960
	speed: 0.0670s/iter; left time: 2280.3281s
Epoch: 8 cost time: 27.440399408340454
Epoch: 8, Steps: 369 | Train Loss: 0.473 Vali Loss: 2.607 Vali Acc: 0.631 Test Loss: 2.607 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5775706
	speed: 0.2714s/iter; left time: 9185.5006s
	iters: 200, epoch: 9 | loss: 0.0206661
	speed: 0.0667s/iter; left time: 2251.6905s
	iters: 300, epoch: 9 | loss: 0.2850228
	speed: 0.0660s/iter; left time: 2222.3390s
Epoch: 9 cost time: 25.673907041549683
Epoch: 9, Steps: 369 | Train Loss: 0.286 Vali Loss: 2.120 Vali Acc: 0.634 Test Loss: 2.120 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2373774
	speed: 0.3026s/iter; left time: 10130.3058s
	iters: 200, epoch: 10 | loss: 0.0825748
	speed: 0.0801s/iter; left time: 2673.1542s
	iters: 300, epoch: 10 | loss: 0.6001235
	speed: 0.0806s/iter; left time: 2681.1261s
Epoch: 10 cost time: 30.485200881958008
Epoch: 10, Steps: 369 | Train Loss: 0.192 Vali Loss: 2.094 Vali Acc: 0.626 Test Loss: 2.094 Test Acc: 0.626
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1488752
	speed: 0.3043s/iter; left time: 10074.6346s
	iters: 200, epoch: 11 | loss: 0.0103281
	speed: 0.0687s/iter; left time: 2267.5880s
	iters: 300, epoch: 11 | loss: 0.0577895
	speed: 0.0685s/iter; left time: 2254.4545s
Epoch: 11 cost time: 25.777016639709473
Epoch: 11, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.794 Vali Acc: 0.623 Test Loss: 1.794 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1998062
	speed: 0.2666s/iter; left time: 8728.1565s
	iters: 200, epoch: 12 | loss: 0.0176652
	speed: 0.0673s/iter; left time: 2197.8713s
	iters: 300, epoch: 12 | loss: 0.0082123
	speed: 0.0645s/iter; left time: 2097.5296s
Epoch: 12 cost time: 26.2079074382782
Epoch: 12, Steps: 369 | Train Loss: 0.077 Vali Loss: 1.641 Vali Acc: 0.635 Test Loss: 1.641 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0130837
	speed: 0.3203s/iter; left time: 10369.0847s
	iters: 200, epoch: 13 | loss: 0.0928419
	speed: 0.0803s/iter; left time: 2591.4729s
	iters: 300, epoch: 13 | loss: 0.0021850
	speed: 0.0821s/iter; left time: 2640.1754s
Epoch: 13 cost time: 30.82224464416504
Epoch: 13, Steps: 369 | Train Loss: 0.058 Vali Loss: 1.926 Vali Acc: 0.628 Test Loss: 1.926 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6549375709421112
model parameter : 327938
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.2863486
	speed: 0.0782s/iter; left time: 2878.7278s
	iters: 200, epoch: 1 | loss: 2.0855801
	speed: 0.0615s/iter; left time: 2257.3936s
	iters: 300, epoch: 1 | loss: 0.9235832
	speed: 0.0622s/iter; left time: 2276.6688s
Epoch: 1 cost time: 24.576601028442383
Epoch: 1, Steps: 369 | Train Loss: 1.277 Vali Loss: 1.359 Vali Acc: 0.589 Test Loss: 1.359 Test Acc: 0.589
Validation loss decreased (inf --> -0.589090).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9176990
	speed: 0.2460s/iter; left time: 8960.7190s
	iters: 200, epoch: 2 | loss: 0.8592793
	speed: 0.0612s/iter; left time: 2224.0825s
	iters: 300, epoch: 2 | loss: 2.0986574
	speed: 0.0618s/iter; left time: 2239.9367s
Epoch: 2 cost time: 22.337738275527954
Epoch: 2, Steps: 369 | Train Loss: 1.294 Vali Loss: 1.398 Vali Acc: 0.655 Test Loss: 1.398 Test Acc: 0.655
Validation loss decreased (-0.589090 --> -0.654640).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5747144
	speed: 0.2149s/iter; left time: 7748.3073s
	iters: 200, epoch: 3 | loss: 1.2087208
	speed: 0.0521s/iter; left time: 1872.0745s
	iters: 300, epoch: 3 | loss: 0.4663178
	speed: 0.0502s/iter; left time: 1798.6055s
Epoch: 3 cost time: 19.538598775863647
Epoch: 3, Steps: 369 | Train Loss: 1.721 Vali Loss: 2.328 Vali Acc: 0.651 Test Loss: 2.328 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0094155
	speed: 0.2143s/iter; left time: 7650.3947s
	iters: 200, epoch: 4 | loss: 0.6718554
	speed: 0.0431s/iter; left time: 1535.3501s
	iters: 300, epoch: 4 | loss: 4.3904638
	speed: 0.0564s/iter; left time: 2002.6485s
Epoch: 4 cost time: 20.035392999649048
Epoch: 4, Steps: 369 | Train Loss: 1.633 Vali Loss: 2.167 Vali Acc: 0.642 Test Loss: 2.167 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6799993
	speed: 0.2013s/iter; left time: 7111.5919s
	iters: 200, epoch: 5 | loss: 1.3294637
	speed: 0.0420s/iter; left time: 1477.9104s
	iters: 300, epoch: 5 | loss: 2.1373560
	speed: 0.0418s/iter; left time: 1467.5437s
Epoch: 5 cost time: 15.80756163597107
Epoch: 5, Steps: 369 | Train Loss: 1.332 Vali Loss: 2.714 Vali Acc: 0.641 Test Loss: 2.714 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.6783776
	speed: 0.2290s/iter; left time: 8006.1858s
	iters: 200, epoch: 6 | loss: 3.2225978
	speed: 0.0789s/iter; left time: 2748.5768s
	iters: 300, epoch: 6 | loss: 1.0353110
	speed: 0.0786s/iter; left time: 2731.6420s
Epoch: 6 cost time: 29.88491129875183
Epoch: 6, Steps: 369 | Train Loss: 1.110 Vali Loss: 2.724 Vali Acc: 0.616 Test Loss: 2.724 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1777658
	speed: 0.3116s/iter; left time: 10778.2197s
	iters: 200, epoch: 7 | loss: 0.2456176
	speed: 0.0781s/iter; left time: 2691.7878s
	iters: 300, epoch: 7 | loss: 0.4921486
	speed: 0.0787s/iter; left time: 2704.6254s
Epoch: 7 cost time: 29.530911684036255
Epoch: 7, Steps: 369 | Train Loss: 0.663 Vali Loss: 2.204 Vali Acc: 0.636 Test Loss: 2.204 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0104940
	speed: 0.3112s/iter; left time: 10647.6638s
	iters: 200, epoch: 8 | loss: 0.4376373
	speed: 0.0790s/iter; left time: 2694.5417s
	iters: 300, epoch: 8 | loss: 0.1736669
	speed: 0.0804s/iter; left time: 2735.8815s
Epoch: 8 cost time: 30.13358473777771
Epoch: 8, Steps: 369 | Train Loss: 0.406 Vali Loss: 1.871 Vali Acc: 0.620 Test Loss: 1.871 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0098368
	speed: 0.3158s/iter; left time: 10690.5167s
	iters: 200, epoch: 9 | loss: 0.5138850
	speed: 0.0762s/iter; left time: 2571.7745s
	iters: 300, epoch: 9 | loss: 0.1066740
	speed: 0.0711s/iter; left time: 2392.4215s
Epoch: 9 cost time: 28.574711322784424
Epoch: 9, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.545 Vali Acc: 0.651 Test Loss: 1.545 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1753969
	speed: 0.2967s/iter; left time: 9932.1809s
	iters: 200, epoch: 10 | loss: 0.0284590
	speed: 0.0742s/iter; left time: 2478.3307s
	iters: 300, epoch: 10 | loss: 0.1112723
	speed: 0.0733s/iter; left time: 2438.1756s
Epoch: 10 cost time: 28.06403875350952
Epoch: 10, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.669 Vali Acc: 0.632 Test Loss: 1.669 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0403590
	speed: 0.2873s/iter; left time: 9512.1298s
	iters: 200, epoch: 11 | loss: 0.1351030
	speed: 0.0697s/iter; left time: 2301.1228s
	iters: 300, epoch: 11 | loss: 0.0389749
	speed: 0.0706s/iter; left time: 2323.8972s
Epoch: 11 cost time: 26.88148856163025
Epoch: 11, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.675 Vali Acc: 0.646 Test Loss: 1.675 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0151649
	speed: 0.2910s/iter; left time: 9528.1400s
	iters: 200, epoch: 12 | loss: 0.1282752
	speed: 0.0703s/iter; left time: 2294.6780s
	iters: 300, epoch: 12 | loss: 0.0320888
	speed: 0.0808s/iter; left time: 2629.9421s
Epoch: 12 cost time: 28.49889636039734
Epoch: 12, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.897 Vali Acc: 0.636 Test Loss: 1.897 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6546538024971623
model parameter : 235810
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4761886
	speed: 0.0859s/iter; left time: 3162.5572s
	iters: 200, epoch: 1 | loss: 0.7167729
	speed: 0.0654s/iter; left time: 2399.2785s
	iters: 300, epoch: 1 | loss: 0.9464800
	speed: 0.0651s/iter; left time: 2382.6523s
Epoch: 1 cost time: 26.252208709716797
Epoch: 1, Steps: 369 | Train Loss: 1.032 Vali Loss: 1.246 Vali Acc: 0.595 Test Loss: 1.246 Test Acc: 0.595
Validation loss decreased (inf --> -0.594766).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8357162
	speed: 0.2558s/iter; left time: 9319.5529s
	iters: 200, epoch: 2 | loss: 1.8807166
	speed: 0.0640s/iter; left time: 2326.4937s
	iters: 300, epoch: 2 | loss: 1.5146743
	speed: 0.0644s/iter; left time: 2332.2168s
Epoch: 2 cost time: 24.337538719177246
Epoch: 2, Steps: 369 | Train Loss: 1.113 Vali Loss: 1.598 Vali Acc: 0.654 Test Loss: 1.598 Test Acc: 0.654
Validation loss decreased (-0.594766 --> -0.654070).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4529662
	speed: 0.2350s/iter; left time: 8475.3967s
	iters: 200, epoch: 3 | loss: 0.5946591
	speed: 0.0536s/iter; left time: 1926.5784s
	iters: 300, epoch: 3 | loss: 1.8194189
	speed: 0.0543s/iter; left time: 1946.7084s
Epoch: 3 cost time: 20.767804861068726
Epoch: 3, Steps: 369 | Train Loss: 1.380 Vali Loss: 1.892 Vali Acc: 0.654 Test Loss: 1.892 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5457272
	speed: 0.2348s/iter; left time: 8380.2281s
	iters: 200, epoch: 4 | loss: 2.7919490
	speed: 0.0554s/iter; left time: 1970.3065s
	iters: 300, epoch: 4 | loss: 1.6621990
	speed: 0.0527s/iter; left time: 1870.7400s
Epoch: 4 cost time: 20.793578147888184
Epoch: 4, Steps: 369 | Train Loss: 1.381 Vali Loss: 2.644 Vali Acc: 0.647 Test Loss: 2.644 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2844674
	speed: 0.2291s/iter; left time: 8094.3479s
	iters: 200, epoch: 5 | loss: 2.0885425
	speed: 0.0577s/iter; left time: 2033.1946s
	iters: 300, epoch: 5 | loss: 1.3131291
	speed: 0.0545s/iter; left time: 1913.3095s
Epoch: 5 cost time: 21.392393112182617
Epoch: 5, Steps: 369 | Train Loss: 1.129 Vali Loss: 2.346 Vali Acc: 0.656 Test Loss: 2.346 Test Acc: 0.656
Validation loss decreased (-0.654070 --> -0.656049).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4893978
	speed: 0.2330s/iter; left time: 8143.1566s
	iters: 200, epoch: 6 | loss: 0.9667304
	speed: 0.0497s/iter; left time: 1731.7684s
	iters: 300, epoch: 6 | loss: 0.8980256
	speed: 0.0656s/iter; left time: 2278.5346s
Epoch: 6 cost time: 22.491349458694458
Epoch: 6, Steps: 369 | Train Loss: 0.937 Vali Loss: 2.814 Vali Acc: 0.629 Test Loss: 2.814 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4285077
	speed: 0.2536s/iter; left time: 8772.1644s
	iters: 200, epoch: 7 | loss: 0.2489462
	speed: 0.0654s/iter; left time: 2255.8220s
	iters: 300, epoch: 7 | loss: 0.2626677
	speed: 0.0654s/iter; left time: 2248.9135s
Epoch: 7 cost time: 24.745697498321533
Epoch: 7, Steps: 369 | Train Loss: 0.648 Vali Loss: 2.238 Vali Acc: 0.640 Test Loss: 2.238 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4462366
	speed: 0.2539s/iter; left time: 8689.0053s
	iters: 200, epoch: 8 | loss: 0.2470873
	speed: 0.0644s/iter; left time: 2198.7238s
	iters: 300, epoch: 8 | loss: 1.3700304
	speed: 0.0656s/iter; left time: 2232.7261s
Epoch: 8 cost time: 24.60195779800415
Epoch: 8, Steps: 369 | Train Loss: 0.440 Vali Loss: 1.841 Vali Acc: 0.634 Test Loss: 1.841 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0039585
	speed: 0.2615s/iter; left time: 8852.5832s
	iters: 200, epoch: 9 | loss: 0.7592078
	speed: 0.0636s/iter; left time: 2147.2018s
	iters: 300, epoch: 9 | loss: 0.4720623
	speed: 0.0636s/iter; left time: 2138.5932s
Epoch: 9 cost time: 24.234811305999756
Epoch: 9, Steps: 369 | Train Loss: 0.291 Vali Loss: 1.811 Vali Acc: 0.616 Test Loss: 1.811 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0369066
	speed: 0.2602s/iter; left time: 8712.1301s
	iters: 200, epoch: 10 | loss: 0.1496769
	speed: 0.0543s/iter; left time: 1813.5759s
	iters: 300, epoch: 10 | loss: 0.2269141
	speed: 0.0524s/iter; left time: 1742.4301s
Epoch: 10 cost time: 21.258136749267578
Epoch: 10, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.532 Vali Acc: 0.642 Test Loss: 1.532 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0395986
	speed: 0.2247s/iter; left time: 7438.4954s
	iters: 200, epoch: 11 | loss: 0.1817674
	speed: 0.0556s/iter; left time: 1834.0004s
	iters: 300, epoch: 11 | loss: 0.3727071
	speed: 0.0533s/iter; left time: 1753.2991s
Epoch: 11 cost time: 20.885903358459473
Epoch: 11, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.657 Vali Acc: 0.639 Test Loss: 1.657 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4110867
	speed: 0.2258s/iter; left time: 7392.9122s
	iters: 200, epoch: 12 | loss: 0.1214569
	speed: 0.0532s/iter; left time: 1737.9661s
	iters: 300, epoch: 12 | loss: 0.1299215
	speed: 0.0524s/iter; left time: 1703.7757s
Epoch: 12 cost time: 19.521804571151733
Epoch: 12, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.717 Vali Acc: 0.644 Test Loss: 1.717 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1558898
	speed: 0.2222s/iter; left time: 7192.1222s
	iters: 200, epoch: 13 | loss: 0.0116566
	speed: 0.0522s/iter; left time: 1684.8796s
	iters: 300, epoch: 13 | loss: 0.1588334
	speed: 0.0500s/iter; left time: 1609.2439s
Epoch: 13 cost time: 19.60896134376526
Epoch: 13, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.781 Vali Acc: 0.628 Test Loss: 1.781 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0041620
	speed: 0.2320s/iter; left time: 7425.3745s
	iters: 200, epoch: 14 | loss: 0.0106510
	speed: 0.0628s/iter; left time: 2002.5457s
	iters: 300, epoch: 14 | loss: 0.0345639
	speed: 0.0623s/iter; left time: 1981.8743s
Epoch: 14 cost time: 23.58584237098694
Epoch: 14, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.005 Vali Acc: 0.632 Test Loss: 2.005 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1060130
	speed: 0.2464s/iter; left time: 7795.8262s
	iters: 200, epoch: 15 | loss: 0.0154056
	speed: 0.0601s/iter; left time: 1895.2197s
	iters: 300, epoch: 15 | loss: 0.1590410
	speed: 0.0603s/iter; left time: 1896.9738s
Epoch: 15 cost time: 23.065114736557007
Epoch: 15, Steps: 369 | Train Loss: 0.074 Vali Loss: 2.148 Vali Acc: 0.645 Test Loss: 2.148 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.656072644721907
model parameter : 180578
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.3569387
	speed: 0.0774s/iter; left time: 2848.7708s
	iters: 200, epoch: 1 | loss: 0.7170146
	speed: 0.0577s/iter; left time: 2116.8619s
	iters: 300, epoch: 1 | loss: 0.5040807
	speed: 0.0577s/iter; left time: 2111.4733s
Epoch: 1 cost time: 23.380322217941284
Epoch: 1, Steps: 369 | Train Loss: 0.987 Vali Loss: 1.115 Vali Acc: 0.605 Test Loss: 1.115 Test Acc: 0.605
Validation loss decreased (inf --> -0.605267).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5799924
	speed: 0.1990s/iter; left time: 7248.8925s
	iters: 200, epoch: 2 | loss: 1.0408317
	speed: 0.0477s/iter; left time: 1734.5750s
	iters: 300, epoch: 2 | loss: 0.2044115
	speed: 0.0464s/iter; left time: 1681.5809s
Epoch: 2 cost time: 18.444884777069092
Epoch: 2, Steps: 369 | Train Loss: 0.995 Vali Loss: 1.344 Vali Acc: 0.636 Test Loss: 1.344 Test Acc: 0.636
Validation loss decreased (-0.605267 --> -0.635912).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4849892
	speed: 0.2059s/iter; left time: 7424.4390s
	iters: 200, epoch: 3 | loss: 0.4863461
	speed: 0.0475s/iter; left time: 1708.1565s
	iters: 300, epoch: 3 | loss: 2.8473067
	speed: 0.0467s/iter; left time: 1675.2129s
Epoch: 3 cost time: 18.22705316543579
Epoch: 3, Steps: 369 | Train Loss: 1.242 Vali Loss: 1.716 Vali Acc: 0.636 Test Loss: 1.716 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2968748
	speed: 0.2012s/iter; left time: 7181.1135s
	iters: 200, epoch: 4 | loss: 0.6098095
	speed: 0.0491s/iter; left time: 1747.7012s
	iters: 300, epoch: 4 | loss: 2.0763702
	speed: 0.0490s/iter; left time: 1740.3592s
Epoch: 4 cost time: 18.518332481384277
Epoch: 4, Steps: 369 | Train Loss: 1.241 Vali Loss: 2.326 Vali Acc: 0.633 Test Loss: 2.326 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7939780
	speed: 0.1974s/iter; left time: 6974.2024s
	iters: 200, epoch: 5 | loss: 0.8339319
	speed: 0.0468s/iter; left time: 1648.3734s
	iters: 300, epoch: 5 | loss: 1.7288389
	speed: 0.0462s/iter; left time: 1621.5752s
Epoch: 5 cost time: 17.956870079040527
Epoch: 5, Steps: 369 | Train Loss: 1.093 Vali Loss: 2.439 Vali Acc: 0.644 Test Loss: 2.439 Test Acc: 0.644
Validation loss decreased (-0.635912 --> -0.643846).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2119198
	speed: 0.2102s/iter; left time: 7347.7440s
	iters: 200, epoch: 6 | loss: 0.6798688
	speed: 0.0564s/iter; left time: 1966.8459s
	iters: 300, epoch: 6 | loss: 0.5090801
	speed: 0.0553s/iter; left time: 1920.4263s
Epoch: 6 cost time: 21.40084433555603
Epoch: 6, Steps: 369 | Train Loss: 0.826 Vali Loss: 2.519 Vali Acc: 0.633 Test Loss: 2.519 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1204177
	speed: 0.2287s/iter; left time: 7911.5745s
	iters: 200, epoch: 7 | loss: 1.5025448
	speed: 0.0560s/iter; left time: 1930.7798s
	iters: 300, epoch: 7 | loss: 0.3377648
	speed: 0.0553s/iter; left time: 1900.2966s
Epoch: 7 cost time: 21.446779489517212
Epoch: 7, Steps: 369 | Train Loss: 0.618 Vali Loss: 1.872 Vali Acc: 0.642 Test Loss: 1.872 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6436914
	speed: 0.2300s/iter; left time: 7870.8303s
	iters: 200, epoch: 8 | loss: 0.3602404
	speed: 0.0555s/iter; left time: 1892.1465s
	iters: 300, epoch: 8 | loss: 0.7799059
	speed: 0.0556s/iter; left time: 1890.1130s
Epoch: 8 cost time: 21.330482482910156
Epoch: 8, Steps: 369 | Train Loss: 0.440 Vali Loss: 1.736 Vali Acc: 0.637 Test Loss: 1.736 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1741735
	speed: 0.2257s/iter; left time: 7640.2861s
	iters: 200, epoch: 9 | loss: 0.1926882
	speed: 0.0552s/iter; left time: 1862.4890s
	iters: 300, epoch: 9 | loss: 0.6872216
	speed: 0.0562s/iter; left time: 1890.3620s
Epoch: 9 cost time: 21.210752248764038
Epoch: 9, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.578 Vali Acc: 0.643 Test Loss: 1.578 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1496949
	speed: 0.2178s/iter; left time: 7290.3414s
	iters: 200, epoch: 10 | loss: 0.0700407
	speed: 0.0473s/iter; left time: 1578.3490s
	iters: 300, epoch: 10 | loss: 0.2079441
	speed: 0.0469s/iter; left time: 1560.9211s
Epoch: 10 cost time: 17.753612756729126
Epoch: 10, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.486 Vali Acc: 0.632 Test Loss: 1.486 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0721139
	speed: 0.2140s/iter; left time: 7084.3027s
	iters: 200, epoch: 11 | loss: 0.2238592
	speed: 0.0472s/iter; left time: 1558.5929s
	iters: 300, epoch: 11 | loss: 0.0920758
	speed: 0.0465s/iter; left time: 1529.4438s
Epoch: 11 cost time: 18.470799446105957
Epoch: 11, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.452 Vali Acc: 0.658 Test Loss: 1.452 Test Acc: 0.658
Validation loss decreased (-0.643846 --> -0.657761).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1973545
	speed: 0.1939s/iter; left time: 6349.4804s
	iters: 200, epoch: 12 | loss: 0.3032110
	speed: 0.0481s/iter; left time: 1569.4721s
	iters: 300, epoch: 12 | loss: 0.0332041
	speed: 0.0478s/iter; left time: 1556.0761s
Epoch: 12 cost time: 17.505799055099487
Epoch: 12, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.699 Vali Acc: 0.625 Test Loss: 1.699 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0983316
	speed: 0.1982s/iter; left time: 6416.0640s
	iters: 200, epoch: 13 | loss: 0.0145236
	speed: 0.0471s/iter; left time: 1519.0671s
	iters: 300, epoch: 13 | loss: 0.1288249
	speed: 0.0485s/iter; left time: 1560.2206s
Epoch: 13 cost time: 18.379316329956055
Epoch: 13, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.773 Vali Acc: 0.640 Test Loss: 1.773 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1063293
	speed: 0.1982s/iter; left time: 6342.8209s
	iters: 200, epoch: 14 | loss: 0.2740680
	speed: 0.0586s/iter; left time: 1868.6319s
	iters: 300, epoch: 14 | loss: 0.0935988
	speed: 0.0563s/iter; left time: 1790.8989s
Epoch: 14 cost time: 20.31049394607544
Epoch: 14, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.858 Vali Acc: 0.646 Test Loss: 1.858 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0038084
	speed: 0.2271s/iter; left time: 7184.0100s
	iters: 200, epoch: 15 | loss: 0.0936475
	speed: 0.0551s/iter; left time: 1737.8053s
	iters: 300, epoch: 15 | loss: 0.2834547
	speed: 0.0559s/iter; left time: 1757.8819s
Epoch: 15 cost time: 21.295249700546265
Epoch: 15, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.768 Vali Acc: 0.637 Test Loss: 1.768 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0013969
	speed: 0.2276s/iter; left time: 7117.5913s
	iters: 200, epoch: 16 | loss: 0.0180836
	speed: 0.0558s/iter; left time: 1738.1188s
	iters: 300, epoch: 16 | loss: 0.1423281
	speed: 0.0556s/iter; left time: 1727.4548s
Epoch: 16 cost time: 21.454575300216675
Epoch: 16, Steps: 369 | Train Loss: 0.080 Vali Loss: 1.859 Vali Acc: 0.645 Test Loss: 1.859 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0169055
	speed: 0.2240s/iter; left time: 6921.7439s
	iters: 200, epoch: 17 | loss: 0.0190633
	speed: 0.0558s/iter; left time: 1719.0227s
	iters: 300, epoch: 17 | loss: 0.1188983
	speed: 0.0554s/iter; left time: 1701.3066s
Epoch: 17 cost time: 21.448771476745605
Epoch: 17, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.965 Vali Acc: 0.633 Test Loss: 1.965 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0343877
	speed: 0.2364s/iter; left time: 7218.0772s
	iters: 200, epoch: 18 | loss: 0.0005848
	speed: 0.0565s/iter; left time: 1718.5272s
	iters: 300, epoch: 18 | loss: 0.3240089
	speed: 0.0453s/iter; left time: 1374.5765s
Epoch: 18 cost time: 20.01268696784973
Epoch: 18, Steps: 369 | Train Loss: 0.076 Vali Loss: 1.950 Vali Acc: 0.644 Test Loss: 1.950 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0029119
	speed: 0.2096s/iter; left time: 6321.4234s
	iters: 200, epoch: 19 | loss: 0.0063476
	speed: 0.0471s/iter; left time: 1416.8091s
	iters: 300, epoch: 19 | loss: 0.0868033
	speed: 0.0464s/iter; left time: 1388.6593s
Epoch: 19 cost time: 18.238073587417603
Epoch: 19, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.080 Vali Acc: 0.639 Test Loss: 2.080 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1021720
	speed: 0.2050s/iter; left time: 6106.2219s
	iters: 200, epoch: 20 | loss: 0.0511056
	speed: 0.0469s/iter; left time: 1393.8813s
	iters: 300, epoch: 20 | loss: 0.0115827
	speed: 0.0437s/iter; left time: 1294.1662s
Epoch: 20 cost time: 17.52476954460144
Epoch: 20, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.105 Vali Acc: 0.638 Test Loss: 2.105 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0136387
	speed: 0.1981s/iter; left time: 5826.8712s
	iters: 200, epoch: 21 | loss: 0.0316402
	speed: 0.0469s/iter; left time: 1374.1223s
	iters: 300, epoch: 21 | loss: 0.0457665
	speed: 0.0466s/iter; left time: 1362.8385s
Epoch: 21 cost time: 18.111034631729126
Epoch: 21, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.210 Vali Acc: 0.635 Test Loss: 2.210 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 153026
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4100347
	speed: 0.0680s/iter; left time: 2503.5847s
	iters: 200, epoch: 1 | loss: 0.5064549
	speed: 0.0517s/iter; left time: 1898.6073s
	iters: 300, epoch: 1 | loss: 0.2890930
	speed: 0.0512s/iter; left time: 1874.4019s
Epoch: 1 cost time: 20.718564987182617
Epoch: 1, Steps: 369 | Train Loss: 0.874 Vali Loss: 1.215 Vali Acc: 0.629 Test Loss: 1.215 Test Acc: 0.629
Validation loss decreased (inf --> -0.629386).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0045571
	speed: 0.2087s/iter; left time: 7604.6066s
	iters: 200, epoch: 2 | loss: 1.3761129
	speed: 0.0513s/iter; left time: 1863.0967s
	iters: 300, epoch: 2 | loss: 0.5214782
	speed: 0.0514s/iter; left time: 1862.0862s
Epoch: 2 cost time: 19.53514528274536
Epoch: 2, Steps: 369 | Train Loss: 0.937 Vali Loss: 1.390 Vali Acc: 0.628 Test Loss: 1.390 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4387683
	speed: 0.2056s/iter; left time: 7413.5893s
	iters: 200, epoch: 3 | loss: 1.0772597
	speed: 0.0502s/iter; left time: 1803.9845s
	iters: 300, epoch: 3 | loss: 1.2832412
	speed: 0.0498s/iter; left time: 1785.3465s
Epoch: 3 cost time: 19.176943063735962
Epoch: 3, Steps: 369 | Train Loss: 1.021 Vali Loss: 1.803 Vali Acc: 0.636 Test Loss: 1.803 Test Acc: 0.636
Validation loss decreased (-0.629386 --> -0.635623).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8962607
	speed: 0.1992s/iter; left time: 7110.2847s
	iters: 200, epoch: 4 | loss: 0.2295882
	speed: 0.0502s/iter; left time: 1786.5002s
	iters: 300, epoch: 4 | loss: 0.9776934
	speed: 0.0392s/iter; left time: 1390.2308s
Epoch: 4 cost time: 17.352230310440063
Epoch: 4, Steps: 369 | Train Loss: 1.015 Vali Loss: 2.075 Vali Acc: 0.627 Test Loss: 2.075 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5575686
	speed: 0.1853s/iter; left time: 6545.6928s
	iters: 200, epoch: 5 | loss: 0.1681532
	speed: 0.0436s/iter; left time: 1534.3702s
	iters: 300, epoch: 5 | loss: 3.1715157
	speed: 0.0426s/iter; left time: 1497.7660s
Epoch: 5 cost time: 16.4846031665802
Epoch: 5, Steps: 369 | Train Loss: 0.845 Vali Loss: 2.220 Vali Acc: 0.649 Test Loss: 2.220 Test Acc: 0.649
Validation loss decreased (-0.635623 --> -0.648956).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8312707
	speed: 0.1844s/iter; left time: 6445.5161s
	iters: 200, epoch: 6 | loss: 0.7815991
	speed: 0.0418s/iter; left time: 1458.0950s
	iters: 300, epoch: 6 | loss: 0.2794550
	speed: 0.0417s/iter; left time: 1448.5379s
Epoch: 6 cost time: 15.882905721664429
Epoch: 6, Steps: 369 | Train Loss: 0.714 Vali Loss: 2.098 Vali Acc: 0.648 Test Loss: 2.098 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5318566
	speed: 0.1865s/iter; left time: 6449.6865s
	iters: 200, epoch: 7 | loss: 1.5941038
	speed: 0.0421s/iter; left time: 1451.5094s
	iters: 300, epoch: 7 | loss: 1.0774658
	speed: 0.0428s/iter; left time: 1472.3789s
Epoch: 7 cost time: 16.41589641571045
Epoch: 7, Steps: 369 | Train Loss: 0.524 Vali Loss: 2.005 Vali Acc: 0.640 Test Loss: 2.005 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0411505
	speed: 0.1834s/iter; left time: 6275.1599s
	iters: 200, epoch: 8 | loss: 0.2047535
	speed: 0.0424s/iter; left time: 1447.1056s
	iters: 300, epoch: 8 | loss: 0.2409248
	speed: 0.0410s/iter; left time: 1394.5364s
Epoch: 8 cost time: 16.080158710479736
Epoch: 8, Steps: 369 | Train Loss: 0.418 Vali Loss: 2.005 Vali Acc: 0.642 Test Loss: 2.005 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0868716
	speed: 0.1771s/iter; left time: 5994.8279s
	iters: 200, epoch: 9 | loss: 0.1922353
	speed: 0.0484s/iter; left time: 1632.9924s
	iters: 300, epoch: 9 | loss: 0.1099016
	speed: 0.0486s/iter; left time: 1635.7588s
Epoch: 9 cost time: 18.48381209373474
Epoch: 9, Steps: 369 | Train Loss: 0.302 Vali Loss: 1.715 Vali Acc: 0.647 Test Loss: 1.715 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0013535
	speed: 0.1947s/iter; left time: 6516.9639s
	iters: 200, epoch: 10 | loss: 0.2478051
	speed: 0.0496s/iter; left time: 1654.0866s
	iters: 300, epoch: 10 | loss: 0.0778913
	speed: 0.0498s/iter; left time: 1656.6512s
Epoch: 10 cost time: 18.991671085357666
Epoch: 10, Steps: 369 | Train Loss: 0.255 Vali Loss: 1.686 Vali Acc: 0.644 Test Loss: 1.686 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1010105
	speed: 0.2000s/iter; left time: 6620.9900s
	iters: 200, epoch: 11 | loss: 0.2419651
	speed: 0.0505s/iter; left time: 1666.3298s
	iters: 300, epoch: 11 | loss: 0.3635202
	speed: 0.0493s/iter; left time: 1623.9503s
Epoch: 11 cost time: 19.05205726623535
Epoch: 11, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.753 Vali Acc: 0.636 Test Loss: 1.753 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1524247
	speed: 0.2020s/iter; left time: 6614.6352s
	iters: 200, epoch: 12 | loss: 0.2418136
	speed: 0.0496s/iter; left time: 1618.4237s
	iters: 300, epoch: 12 | loss: 0.2487174
	speed: 0.0500s/iter; left time: 1627.4428s
Epoch: 12 cost time: 19.05562424659729
Epoch: 12, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.624 Vali Acc: 0.641 Test Loss: 1.624 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0043343
	speed: 0.2063s/iter; left time: 6677.0348s
	iters: 200, epoch: 13 | loss: 0.0851475
	speed: 0.0502s/iter; left time: 1620.7389s
	iters: 300, epoch: 13 | loss: 0.3236586
	speed: 0.0508s/iter; left time: 1633.7189s
Epoch: 13 cost time: 19.019609689712524
Epoch: 13, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.759 Vali Acc: 0.644 Test Loss: 1.759 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0064228
	speed: 0.1904s/iter; left time: 6092.7161s
	iters: 200, epoch: 14 | loss: 0.0190012
	speed: 0.0443s/iter; left time: 1412.2446s
	iters: 300, epoch: 14 | loss: 0.2502792
	speed: 0.0421s/iter; left time: 1338.3727s
Epoch: 14 cost time: 16.531911373138428
Epoch: 14, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.766 Vali Acc: 0.651 Test Loss: 1.766 Test Acc: 0.651
Validation loss decreased (-0.648956 --> -0.651231).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0552309
	speed: 0.1819s/iter; left time: 5754.5652s
	iters: 200, epoch: 15 | loss: 0.0148969
	speed: 0.0408s/iter; left time: 1287.7566s
	iters: 300, epoch: 15 | loss: 0.0061582
	speed: 0.0406s/iter; left time: 1276.2288s
Epoch: 15 cost time: 15.582001686096191
Epoch: 15, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.747 Vali Acc: 0.645 Test Loss: 1.747 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0113116
	speed: 0.1791s/iter; left time: 5599.7726s
	iters: 200, epoch: 16 | loss: 0.1845824
	speed: 0.0413s/iter; left time: 1287.4446s
	iters: 300, epoch: 16 | loss: 0.0739840
	speed: 0.0414s/iter; left time: 1285.8656s
Epoch: 16 cost time: 15.978786945343018
Epoch: 16, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.864 Vali Acc: 0.651 Test Loss: 1.864 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0413302
	speed: 0.1822s/iter; left time: 5630.3739s
	iters: 200, epoch: 17 | loss: 0.1044616
	speed: 0.0415s/iter; left time: 1277.9569s
	iters: 300, epoch: 17 | loss: 0.0358852
	speed: 0.0412s/iter; left time: 1264.2040s
Epoch: 17 cost time: 15.936787128448486
Epoch: 17, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.901 Vali Acc: 0.646 Test Loss: 1.901 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0133627
	speed: 0.1850s/iter; left time: 5648.5300s
	iters: 200, epoch: 18 | loss: 0.0164643
	speed: 0.0485s/iter; left time: 1476.6361s
	iters: 300, epoch: 18 | loss: 0.0419943
	speed: 0.0484s/iter; left time: 1468.9487s
Epoch: 18 cost time: 18.810936212539673
Epoch: 18, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.877 Vali Acc: 0.647 Test Loss: 1.877 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0816303
	speed: 0.2047s/iter; left time: 6174.6730s
	iters: 200, epoch: 19 | loss: 0.0010490
	speed: 0.0491s/iter; left time: 1476.8510s
	iters: 300, epoch: 19 | loss: 0.0063383
	speed: 0.0502s/iter; left time: 1503.4442s
Epoch: 19 cost time: 18.954238891601562
Epoch: 19, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.044 Vali Acc: 0.630 Test Loss: 2.044 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0055722
	speed: 0.2027s/iter; left time: 6038.7763s
	iters: 200, epoch: 20 | loss: 0.0490550
	speed: 0.0497s/iter; left time: 1476.8434s
	iters: 300, epoch: 20 | loss: 0.1816290
	speed: 0.0495s/iter; left time: 1463.8562s
Epoch: 20 cost time: 18.864830255508423
Epoch: 20, Steps: 369 | Train Loss: 0.072 Vali Loss: 1.936 Vali Acc: 0.640 Test Loss: 1.936 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0150440
	speed: 0.2059s/iter; left time: 6058.5645s
	iters: 200, epoch: 21 | loss: 0.3257162
	speed: 0.0498s/iter; left time: 1461.5943s
	iters: 300, epoch: 21 | loss: 0.0309922
	speed: 0.0500s/iter; left time: 1462.3345s
Epoch: 21 cost time: 19.07718014717102
Epoch: 21, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.169 Vali Acc: 0.638 Test Loss: 2.169 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0007777
	speed: 0.2076s/iter; left time: 6031.7918s
	iters: 200, epoch: 22 | loss: 0.0056181
	speed: 0.0503s/iter; left time: 1456.1700s
	iters: 300, epoch: 22 | loss: 0.0669975
	speed: 0.0507s/iter; left time: 1461.3663s
Epoch: 22 cost time: 19.27094340324402
Epoch: 22, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.175 Vali Acc: 0.643 Test Loss: 2.175 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2659620
	speed: 0.1806s/iter; left time: 5180.8625s
	iters: 200, epoch: 23 | loss: 0.0035800
	speed: 0.0430s/iter; left time: 1230.2303s
	iters: 300, epoch: 23 | loss: 0.0459313
	speed: 0.0428s/iter; left time: 1220.4169s
Epoch: 23 cost time: 16.574087142944336
Epoch: 23, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.158 Vali Acc: 0.652 Test Loss: 2.158 Test Acc: 0.652
Validation loss decreased (-0.651231 --> -0.652362).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0550074
	speed: 0.1783s/iter; left time: 5048.1544s
	iters: 200, epoch: 24 | loss: 0.0007980
	speed: 0.0426s/iter; left time: 1202.6369s
	iters: 300, epoch: 24 | loss: 0.0022838
	speed: 0.0434s/iter; left time: 1220.8977s
Epoch: 24 cost time: 16.536815404891968
Epoch: 24, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.226 Vali Acc: 0.641 Test Loss: 2.226 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0354719
	speed: 0.1808s/iter; left time: 5052.4710s
	iters: 200, epoch: 25 | loss: 0.0315311
	speed: 0.0441s/iter; left time: 1227.3850s
	iters: 300, epoch: 25 | loss: 0.0307412
	speed: 0.0416s/iter; left time: 1154.5173s
Epoch: 25 cost time: 16.359169721603394
Epoch: 25, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.291 Vali Acc: 0.643 Test Loss: 2.291 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0111098
	speed: 0.1906s/iter; left time: 5256.2139s
	iters: 200, epoch: 26 | loss: 0.0081802
	speed: 0.0426s/iter; left time: 1169.5799s
	iters: 300, epoch: 26 | loss: 0.0286672
	speed: 0.0416s/iter; left time: 1140.1079s
Epoch: 26 cost time: 16.151419639587402
Epoch: 26, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.175 Vali Acc: 0.643 Test Loss: 2.175 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0608651
	speed: 0.1970s/iter; left time: 5360.1935s
	iters: 200, epoch: 27 | loss: 0.0032218
	speed: 0.0495s/iter; left time: 1342.0306s
	iters: 300, epoch: 27 | loss: 0.1508294
	speed: 0.0494s/iter; left time: 1334.8714s
Epoch: 27 cost time: 18.585439205169678
Epoch: 27, Steps: 369 | Train Loss: 0.044 Vali Loss: 2.301 Vali Acc: 0.647 Test Loss: 2.301 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0014903
	speed: 0.2059s/iter; left time: 5526.3231s
	iters: 200, epoch: 28 | loss: 0.0363503
	speed: 0.0490s/iter; left time: 1311.4133s
	iters: 300, epoch: 28 | loss: 0.0038113
	speed: 0.0495s/iter; left time: 1317.7443s
Epoch: 28 cost time: 18.93887710571289
Epoch: 28, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.293 Vali Acc: 0.648 Test Loss: 2.293 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0046605
	speed: 0.2010s/iter; left time: 5320.3828s
	iters: 200, epoch: 29 | loss: 0.0021716
	speed: 0.0495s/iter; left time: 1303.9765s
	iters: 300, epoch: 29 | loss: 0.2382003
	speed: 0.0501s/iter; left time: 1316.2748s
Epoch: 29 cost time: 19.07343316078186
Epoch: 29, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.349 Vali Acc: 0.639 Test Loss: 2.349 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0014911
	speed: 0.2087s/iter; left time: 5447.9967s
	iters: 200, epoch: 30 | loss: 0.0131761
	speed: 0.0506s/iter; left time: 1314.5618s
	iters: 300, epoch: 30 | loss: 0.2122690
	speed: 0.0500s/iter; left time: 1294.4717s
Epoch: 30 cost time: 19.27286696434021
Epoch: 30, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.277 Vali Acc: 0.649 Test Loss: 2.277 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0041518
	speed: 0.2099s/iter; left time: 5401.7239s
	iters: 200, epoch: 31 | loss: 0.0011308
	speed: 0.0506s/iter; left time: 1296.8570s
	iters: 300, epoch: 31 | loss: 0.0000463
	speed: 0.0505s/iter; left time: 1289.9927s
Epoch: 31 cost time: 19.41163682937622
Epoch: 31, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.302 Vali Acc: 0.662 Test Loss: 2.302 Test Acc: 0.662
Validation loss decreased (-0.652362 --> -0.661725).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0208754
	speed: 0.1840s/iter; left time: 4665.7933s
	iters: 200, epoch: 32 | loss: 0.1414679
	speed: 0.0438s/iter; left time: 1107.1595s
	iters: 300, epoch: 32 | loss: 0.1891675
	speed: 0.0447s/iter; left time: 1124.9801s
Epoch: 32 cost time: 16.829020738601685
Epoch: 32, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.363 Vali Acc: 0.646 Test Loss: 2.363 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0110006
	speed: 0.1863s/iter; left time: 4655.8983s
	iters: 200, epoch: 33 | loss: 0.0083650
	speed: 0.0421s/iter; left time: 1047.8102s
	iters: 300, epoch: 33 | loss: 0.0001212
	speed: 0.0420s/iter; left time: 1041.3310s
Epoch: 33 cost time: 16.202194213867188
Epoch: 33, Steps: 369 | Train Loss: 0.039 Vali Loss: 2.400 Vali Acc: 0.652 Test Loss: 2.400 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.1162606
	speed: 0.1831s/iter; left time: 4508.1575s
	iters: 200, epoch: 34 | loss: 0.0319461
	speed: 0.0421s/iter; left time: 1031.5003s
	iters: 300, epoch: 34 | loss: 0.0002418
	speed: 0.0419s/iter; left time: 1024.3119s
Epoch: 34 cost time: 16.316568613052368
Epoch: 34, Steps: 369 | Train Loss: 0.044 Vali Loss: 2.331 Vali Acc: 0.650 Test Loss: 2.331 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0002753
	speed: 0.1838s/iter; left time: 4458.7427s
	iters: 200, epoch: 35 | loss: 0.0696288
	speed: 0.0423s/iter; left time: 1021.2250s
	iters: 300, epoch: 35 | loss: 0.0052122
	speed: 0.0425s/iter; left time: 1021.6267s
Epoch: 35 cost time: 16.21373724937439
Epoch: 35, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.393 Vali Acc: 0.646 Test Loss: 2.393 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0410976
	speed: 0.1815s/iter; left time: 4335.1158s
	iters: 200, epoch: 36 | loss: 0.1903901
	speed: 0.0508s/iter; left time: 1209.2600s
	iters: 300, epoch: 36 | loss: 0.0064796
	speed: 0.0503s/iter; left time: 1191.6575s
Epoch: 36 cost time: 18.27997589111328
Epoch: 36, Steps: 369 | Train Loss: 0.033 Vali Loss: 2.521 Vali Acc: 0.646 Test Loss: 2.521 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0007884
	speed: 0.2035s/iter; left time: 4784.6592s
	iters: 200, epoch: 37 | loss: 0.0012262
	speed: 0.0493s/iter; left time: 1154.9119s
	iters: 300, epoch: 37 | loss: 0.0397448
	speed: 0.0493s/iter; left time: 1150.5535s
Epoch: 37 cost time: 18.985830783843994
Epoch: 37, Steps: 369 | Train Loss: 0.032 Vali Loss: 2.487 Vali Acc: 0.656 Test Loss: 2.487 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0026343
	speed: 0.2078s/iter; left time: 4809.5082s
	iters: 200, epoch: 38 | loss: 0.0145535
	speed: 0.0493s/iter; left time: 1135.5077s
	iters: 300, epoch: 38 | loss: 0.0194634
	speed: 0.0495s/iter; left time: 1136.4918s
Epoch: 38 cost time: 18.891215324401855
Epoch: 38, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.508 Vali Acc: 0.650 Test Loss: 2.508 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.1115655
	speed: 0.2093s/iter; left time: 4767.5287s
	iters: 200, epoch: 39 | loss: 0.0006169
	speed: 0.0490s/iter; left time: 1112.2017s
	iters: 300, epoch: 39 | loss: 0.0008066
	speed: 0.0496s/iter; left time: 1120.2004s
Epoch: 39 cost time: 18.890613555908203
Epoch: 39, Steps: 369 | Train Loss: 0.039 Vali Loss: 2.581 Vali Acc: 0.642 Test Loss: 2.581 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0053524
	speed: 0.2188s/iter; left time: 4904.2400s
	iters: 200, epoch: 40 | loss: 0.0700449
	speed: 0.0503s/iter; left time: 1121.7854s
	iters: 300, epoch: 40 | loss: 0.0060876
	speed: 0.0497s/iter; left time: 1103.3776s
Epoch: 40 cost time: 19.274980783462524
Epoch: 40, Steps: 369 | Train Loss: 0.036 Vali Loss: 2.635 Vali Acc: 0.635 Test Loss: 2.635 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.3120682
	speed: 0.1860s/iter; left time: 4099.1867s
	iters: 200, epoch: 41 | loss: 0.0010730
	speed: 0.0446s/iter; left time: 977.9110s
	iters: 300, epoch: 41 | loss: 0.0662864
	speed: 0.0432s/iter; left time: 944.1387s
Epoch: 41 cost time: 16.65648651123047
Epoch: 41, Steps: 369 | Train Loss: 0.039 Vali Loss: 2.679 Vali Acc: 0.648 Test Loss: 2.679 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6617480136208853
model parameter : 125474
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7675917
	speed: 0.0590s/iter; left time: 2170.0915s
	iters: 200, epoch: 1 | loss: 1.3395997
	speed: 0.0380s/iter; left time: 1394.4393s
	iters: 300, epoch: 1 | loss: 0.8920271
	speed: 0.0384s/iter; left time: 1405.1348s
Epoch: 1 cost time: 16.28580093383789
Epoch: 1, Steps: 369 | Train Loss: 0.811 Vali Loss: 1.283 Vali Acc: 0.617 Test Loss: 1.283 Test Acc: 0.617
Validation loss decreased (inf --> -0.616900).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6039844
	speed: 0.1672s/iter; left time: 6092.2353s
	iters: 200, epoch: 2 | loss: 0.2848764
	speed: 0.0327s/iter; left time: 1188.1881s
	iters: 300, epoch: 2 | loss: 1.0542021
	speed: 0.0439s/iter; left time: 1590.8173s
Epoch: 2 cost time: 15.185599327087402
Epoch: 2, Steps: 369 | Train Loss: 0.850 Vali Loss: 1.429 Vali Acc: 0.637 Test Loss: 1.429 Test Acc: 0.637
Validation loss decreased (-0.616900 --> -0.637330).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0068392
	speed: 0.1778s/iter; left time: 6410.6829s
	iters: 200, epoch: 3 | loss: 0.7754564
	speed: 0.0448s/iter; left time: 1609.4231s
	iters: 300, epoch: 3 | loss: 1.6718067
	speed: 0.0439s/iter; left time: 1573.4617s
Epoch: 3 cost time: 17.0417377948761
Epoch: 3, Steps: 369 | Train Loss: 0.876 Vali Loss: 1.903 Vali Acc: 0.619 Test Loss: 1.903 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6650271
	speed: 0.1744s/iter; left time: 6224.4819s
	iters: 200, epoch: 4 | loss: 0.8213899
	speed: 0.0440s/iter; left time: 1564.8567s
	iters: 300, epoch: 4 | loss: 0.5005711
	speed: 0.0437s/iter; left time: 1550.7507s
Epoch: 4 cost time: 16.837015867233276
Epoch: 4, Steps: 369 | Train Loss: 0.884 Vali Loss: 1.770 Vali Acc: 0.636 Test Loss: 1.770 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5338131
	speed: 0.1830s/iter; left time: 6462.7914s
	iters: 200, epoch: 5 | loss: 0.6768859
	speed: 0.0447s/iter; left time: 1574.4218s
	iters: 300, epoch: 5 | loss: 0.2880005
	speed: 0.0447s/iter; left time: 1569.5928s
Epoch: 5 cost time: 17.21374773979187
Epoch: 5, Steps: 369 | Train Loss: 0.787 Vali Loss: 2.150 Vali Acc: 0.626 Test Loss: 2.150 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9788013
	speed: 0.1814s/iter; left time: 6342.1462s
	iters: 200, epoch: 6 | loss: 0.6137044
	speed: 0.0448s/iter; left time: 1560.1081s
	iters: 300, epoch: 6 | loss: 0.1950115
	speed: 0.0457s/iter; left time: 1587.6804s
Epoch: 6 cost time: 17.270917415618896
Epoch: 6, Steps: 369 | Train Loss: 0.680 Vali Loss: 1.954 Vali Acc: 0.638 Test Loss: 1.954 Test Acc: 0.638
Validation loss decreased (-0.637330 --> -0.638459).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1361078
	speed: 0.1806s/iter; left time: 6247.3723s
	iters: 200, epoch: 7 | loss: 0.4022458
	speed: 0.0446s/iter; left time: 1537.2476s
	iters: 300, epoch: 7 | loss: 0.5578079
	speed: 0.0430s/iter; left time: 1477.6841s
Epoch: 7 cost time: 15.778544902801514
Epoch: 7, Steps: 369 | Train Loss: 0.514 Vali Loss: 1.797 Vali Acc: 0.649 Test Loss: 1.797 Test Acc: 0.649
Validation loss decreased (-0.638459 --> -0.648960).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3597848
	speed: 0.1582s/iter; left time: 5414.7649s
	iters: 200, epoch: 8 | loss: 0.2670606
	speed: 0.0367s/iter; left time: 1250.5105s
	iters: 300, epoch: 8 | loss: 1.0341076
	speed: 0.0383s/iter; left time: 1301.5258s
Epoch: 8 cost time: 14.513635873794556
Epoch: 8, Steps: 369 | Train Loss: 0.408 Vali Loss: 1.739 Vali Acc: 0.655 Test Loss: 1.739 Test Acc: 0.655
Validation loss decreased (-0.648960 --> -0.654636).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0426607
	speed: 0.1581s/iter; left time: 5352.6381s
	iters: 200, epoch: 9 | loss: 0.7428144
	speed: 0.0382s/iter; left time: 1289.9215s
	iters: 300, epoch: 9 | loss: 0.0587852
	speed: 0.0367s/iter; left time: 1233.4558s
Epoch: 9 cost time: 14.474343538284302
Epoch: 9, Steps: 369 | Train Loss: 0.332 Vali Loss: 1.603 Vali Acc: 0.646 Test Loss: 1.603 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0481090
	speed: 0.1644s/iter; left time: 5503.9012s
	iters: 200, epoch: 10 | loss: 0.1851699
	speed: 0.0380s/iter; left time: 1268.5121s
	iters: 300, epoch: 10 | loss: 0.0556348
	speed: 0.0379s/iter; left time: 1261.9227s
Epoch: 10 cost time: 14.742545366287231
Epoch: 10, Steps: 369 | Train Loss: 0.260 Vali Loss: 1.584 Vali Acc: 0.643 Test Loss: 1.584 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0117090
	speed: 0.1752s/iter; left time: 5799.9068s
	iters: 200, epoch: 11 | loss: 0.0103843
	speed: 0.0383s/iter; left time: 1264.4030s
	iters: 300, epoch: 11 | loss: 0.0984863
	speed: 0.0380s/iter; left time: 1248.9877s
Epoch: 11 cost time: 14.986193895339966
Epoch: 11, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.535 Vali Acc: 0.653 Test Loss: 1.535 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3683659
	speed: 0.1616s/iter; left time: 5292.1905s
	iters: 200, epoch: 12 | loss: 0.2104204
	speed: 0.0444s/iter; left time: 1448.5757s
	iters: 300, epoch: 12 | loss: 0.4504553
	speed: 0.0443s/iter; left time: 1440.7239s
Epoch: 12 cost time: 15.763039827346802
Epoch: 12, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.675 Vali Acc: 0.646 Test Loss: 1.675 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0809103
	speed: 0.1759s/iter; left time: 5695.9382s
	iters: 200, epoch: 13 | loss: 0.2087742
	speed: 0.0452s/iter; left time: 1457.2851s
	iters: 300, epoch: 13 | loss: 0.0317666
	speed: 0.0447s/iter; left time: 1438.6805s
Epoch: 13 cost time: 17.14224600791931
Epoch: 13, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.572 Vali Acc: 0.658 Test Loss: 1.572 Test Acc: 0.658
Validation loss decreased (-0.654636 --> -0.657760).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0059757
	speed: 0.1715s/iter; left time: 5488.5908s
	iters: 200, epoch: 14 | loss: 0.1634000
	speed: 0.0438s/iter; left time: 1396.2255s
	iters: 300, epoch: 14 | loss: 0.2600467
	speed: 0.0443s/iter; left time: 1408.1590s
Epoch: 14 cost time: 16.831231594085693
Epoch: 14, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.655 Vali Acc: 0.658 Test Loss: 1.655 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0057196
	speed: 0.1814s/iter; left time: 5737.0551s
	iters: 200, epoch: 15 | loss: 0.0915716
	speed: 0.0442s/iter; left time: 1392.6807s
	iters: 300, epoch: 15 | loss: 0.0398301
	speed: 0.0436s/iter; left time: 1371.9903s
Epoch: 15 cost time: 17.02946949005127
Epoch: 15, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.718 Vali Acc: 0.660 Test Loss: 1.718 Test Acc: 0.660
Validation loss decreased (-0.657760 --> -0.660312).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0131328
	speed: 0.1803s/iter; left time: 5638.0277s
	iters: 200, epoch: 16 | loss: 0.0673745
	speed: 0.0441s/iter; left time: 1375.6705s
	iters: 300, epoch: 16 | loss: 0.0006932
	speed: 0.0439s/iter; left time: 1363.4130s
Epoch: 16 cost time: 17.010085821151733
Epoch: 16, Steps: 369 | Train Loss: 0.091 Vali Loss: 1.815 Vali Acc: 0.642 Test Loss: 1.815 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0384370
	speed: 0.1844s/iter; left time: 5696.7511s
	iters: 200, epoch: 17 | loss: 0.0249962
	speed: 0.0444s/iter; left time: 1368.6406s
	iters: 300, epoch: 17 | loss: 0.0043366
	speed: 0.0324s/iter; left time: 995.2674s
Epoch: 17 cost time: 15.510859727859497
Epoch: 17, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.887 Vali Acc: 0.653 Test Loss: 1.887 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2285370
	speed: 0.1577s/iter; left time: 4813.9229s
	iters: 200, epoch: 18 | loss: 0.0577837
	speed: 0.0411s/iter; left time: 1249.9695s
	iters: 300, epoch: 18 | loss: 0.0055401
	speed: 0.0401s/iter; left time: 1215.8982s
Epoch: 18 cost time: 15.070971012115479
Epoch: 18, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.889 Vali Acc: 0.654 Test Loss: 1.889 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0141917
	speed: 0.1587s/iter; left time: 4786.3078s
	iters: 200, epoch: 19 | loss: 0.1207194
	speed: 0.0378s/iter; left time: 1136.4998s
	iters: 300, epoch: 19 | loss: 0.0439903
	speed: 0.0379s/iter; left time: 1134.3054s
Epoch: 19 cost time: 14.550690174102783
Epoch: 19, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.956 Vali Acc: 0.652 Test Loss: 1.956 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0717614
	speed: 0.1590s/iter; left time: 4737.7094s
	iters: 200, epoch: 20 | loss: 0.0555174
	speed: 0.0381s/iter; left time: 1131.8723s
	iters: 300, epoch: 20 | loss: 0.0519016
	speed: 0.0368s/iter; left time: 1090.1994s
Epoch: 20 cost time: 14.513921737670898
Epoch: 20, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.057 Vali Acc: 0.650 Test Loss: 2.057 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0012931
	speed: 0.1689s/iter; left time: 4968.9390s
	iters: 200, epoch: 21 | loss: 0.0010387
	speed: 0.0361s/iter; left time: 1057.6946s
	iters: 300, epoch: 21 | loss: 0.1148149
	speed: 0.0371s/iter; left time: 1083.2787s
Epoch: 21 cost time: 14.18705129623413
Epoch: 21, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.130 Vali Acc: 0.644 Test Loss: 2.130 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1031554
	speed: 0.1719s/iter; left time: 4995.0989s
	iters: 200, epoch: 22 | loss: 0.0489290
	speed: 0.0434s/iter; left time: 1257.2728s
	iters: 300, epoch: 22 | loss: 0.0010230
	speed: 0.0431s/iter; left time: 1243.4879s
Epoch: 22 cost time: 16.531099796295166
Epoch: 22, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.170 Vali Acc: 0.643 Test Loss: 2.170 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0974851
	speed: 0.1828s/iter; left time: 5242.7597s
	iters: 200, epoch: 23 | loss: 0.0086421
	speed: 0.0431s/iter; left time: 1230.5834s
	iters: 300, epoch: 23 | loss: 0.0044284
	speed: 0.0432s/iter; left time: 1229.3785s
Epoch: 23 cost time: 16.50005841255188
Epoch: 23, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.239 Vali Acc: 0.654 Test Loss: 2.239 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1202473
	speed: 0.1779s/iter; left time: 5038.2538s
	iters: 200, epoch: 24 | loss: 0.0537367
	speed: 0.0429s/iter; left time: 1210.5897s
	iters: 300, epoch: 24 | loss: 0.0574731
	speed: 0.0427s/iter; left time: 1200.8989s
Epoch: 24 cost time: 16.48901057243347
Epoch: 24, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.106 Vali Acc: 0.657 Test Loss: 2.106 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0524486
	speed: 0.1814s/iter; left time: 5068.0157s
	iters: 200, epoch: 25 | loss: 0.1026848
	speed: 0.0430s/iter; left time: 1197.5590s
	iters: 300, epoch: 25 | loss: 0.0441912
	speed: 0.0437s/iter; left time: 1213.3780s
Epoch: 25 cost time: 16.890186071395874
Epoch: 25, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.124 Vali Acc: 0.644 Test Loss: 2.124 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6603291713961408
model parameter : 107138
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.3046906
	speed: 0.1746s/iter; left time: 6426.1581s
	iters: 200, epoch: 1 | loss: 2.3592536
	speed: 0.1510s/iter; left time: 5540.8064s
	iters: 300, epoch: 1 | loss: 1.6940553
	speed: 0.1483s/iter; left time: 5426.1740s
Epoch: 1 cost time: 57.20934200286865
Epoch: 1, Steps: 369 | Train Loss: 1.935 Vali Loss: 1.341 Vali Acc: 0.654 Test Loss: 1.341 Test Acc: 0.654
Validation loss decreased (inf --> -0.653789).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8576093
	speed: 0.5161s/iter; left time: 18803.7259s
	iters: 200, epoch: 2 | loss: 3.2988169
	speed: 0.1482s/iter; left time: 5383.5535s
	iters: 300, epoch: 2 | loss: 0.9172902
	speed: 0.1508s/iter; left time: 5465.4257s
Epoch: 2 cost time: 56.30372667312622
Epoch: 2, Steps: 369 | Train Loss: 2.373 Vali Loss: 2.605 Vali Acc: 0.662 Test Loss: 2.605 Test Acc: 0.662
Validation loss decreased (-0.653789 --> -0.661722).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5084110
	speed: 0.5657s/iter; left time: 20400.9550s
	iters: 200, epoch: 3 | loss: 2.5697238
	speed: 0.1660s/iter; left time: 5968.4734s
	iters: 300, epoch: 3 | loss: 6.7488914
	speed: 0.1663s/iter; left time: 5964.4490s
Epoch: 3 cost time: 61.718039989471436
Epoch: 3, Steps: 369 | Train Loss: 3.024 Vali Loss: 5.179 Vali Acc: 0.635 Test Loss: 5.179 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1332870
	speed: 0.5712s/iter; left time: 20386.7563s
	iters: 200, epoch: 4 | loss: 1.1412758
	speed: 0.1698s/iter; left time: 6044.9724s
	iters: 300, epoch: 4 | loss: 2.2093091
	speed: 0.1531s/iter; left time: 5435.5510s
Epoch: 4 cost time: 59.71527910232544
Epoch: 4, Steps: 369 | Train Loss: 3.053 Vali Loss: 3.873 Vali Acc: 0.650 Test Loss: 3.873 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3191125
	speed: 0.5141s/iter; left time: 18159.5417s
	iters: 200, epoch: 5 | loss: 3.1588426
	speed: 0.1357s/iter; left time: 4779.7140s
	iters: 300, epoch: 5 | loss: 0.5344869
	speed: 0.1449s/iter; left time: 5091.3100s
Epoch: 5 cost time: 53.27830123901367
Epoch: 5, Steps: 369 | Train Loss: 2.373 Vali Loss: 4.922 Vali Acc: 0.640 Test Loss: 4.922 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3470418
	speed: 0.5102s/iter; left time: 17836.0696s
	iters: 200, epoch: 6 | loss: 0.5569572
	speed: 0.1420s/iter; left time: 4948.6024s
	iters: 300, epoch: 6 | loss: 2.6961505
	speed: 0.1568s/iter; left time: 5450.4900s
Epoch: 6 cost time: 56.26537609100342
Epoch: 6, Steps: 369 | Train Loss: 1.664 Vali Loss: 4.909 Vali Acc: 0.647 Test Loss: 4.909 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.4475s/iter; left time: 15476.2698s
	iters: 200, epoch: 7 | loss: 1.1292658
	speed: 0.0885s/iter; left time: 3052.9749s
	iters: 300, epoch: 7 | loss: 0.6736853
	speed: 0.0885s/iter; left time: 3041.9925s
Epoch: 7 cost time: 36.56159687042236
Epoch: 7, Steps: 369 | Train Loss: 1.006 Vali Loss: 4.315 Vali Acc: 0.640 Test Loss: 4.315 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0002242
	speed: 0.5338s/iter; left time: 18266.5899s
	iters: 200, epoch: 8 | loss: 0.4932801
	speed: 0.1538s/iter; left time: 5247.4391s
	iters: 300, epoch: 8 | loss: 1.0482932
	speed: 0.1566s/iter; left time: 5325.5272s
Epoch: 8 cost time: 57.85493206977844
Epoch: 8, Steps: 369 | Train Loss: 0.522 Vali Loss: 4.001 Vali Acc: 0.631 Test Loss: 4.001 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.4855710
	speed: 0.5008s/iter; left time: 16950.4818s
	iters: 200, epoch: 9 | loss: 0.0000045
	speed: 0.1324s/iter; left time: 4469.0710s
	iters: 300, epoch: 9 | loss: 0.3666506
	speed: 0.1289s/iter; left time: 4335.7222s
Epoch: 9 cost time: 49.29210114479065
Epoch: 9, Steps: 369 | Train Loss: 0.360 Vali Loss: 3.358 Vali Acc: 0.638 Test Loss: 3.358 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2790672
	speed: 0.4845s/iter; left time: 16222.3626s
	iters: 200, epoch: 10 | loss: 0.0099763
	speed: 0.1540s/iter; left time: 5140.8145s
	iters: 300, epoch: 10 | loss: 0.4810196
	speed: 0.1541s/iter; left time: 5128.9885s
Epoch: 10 cost time: 57.65066623687744
Epoch: 10, Steps: 369 | Train Loss: 0.218 Vali Loss: 2.691 Vali Acc: 0.643 Test Loss: 2.691 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1001185
	speed: 0.5476s/iter; left time: 18130.3995s
	iters: 200, epoch: 11 | loss: 0.1144872
	speed: 0.1443s/iter; left time: 4764.3886s
	iters: 300, epoch: 11 | loss: 0.3254591
	speed: 0.1301s/iter; left time: 4282.3859s
Epoch: 11 cost time: 52.4038827419281
Epoch: 11, Steps: 369 | Train Loss: 0.152 Vali Loss: 2.144 Vali Acc: 0.635 Test Loss: 2.144 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0141385
	speed: 0.4566s/iter; left time: 14949.2300s
	iters: 200, epoch: 12 | loss: 0.1260872
	speed: 0.1288s/iter; left time: 4205.0525s
	iters: 300, epoch: 12 | loss: 0.0058222
	speed: 0.1288s/iter; left time: 4192.3452s
Epoch: 12 cost time: 49.45069766044617
Epoch: 12, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.192 Vali Acc: 0.627 Test Loss: 2.192 Test Acc: 0.627
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6617480136208853
model parameter : 596930
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.4924233
	speed: 0.0837s/iter; left time: 3080.6638s
	iters: 200, epoch: 1 | loss: 2.8963144
	speed: 0.0669s/iter; left time: 2453.6556s
	iters: 300, epoch: 1 | loss: 0.6660165
	speed: 0.0683s/iter; left time: 2499.6463s
Epoch: 1 cost time: 26.729645490646362
Epoch: 1, Steps: 369 | Train Loss: 1.432 Vali Loss: 1.009 Vali Acc: 0.618 Test Loss: 1.009 Test Acc: 0.618
Validation loss decreased (inf --> -0.618038).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0358191
	speed: 0.2643s/iter; left time: 9628.5495s
	iters: 200, epoch: 2 | loss: 0.8433978
	speed: 0.0667s/iter; left time: 2424.7807s
	iters: 300, epoch: 2 | loss: 1.3461872
	speed: 0.0665s/iter; left time: 2409.2658s
Epoch: 2 cost time: 24.92161273956299
Epoch: 2, Steps: 369 | Train Loss: 1.561 Vali Loss: 1.689 Vali Acc: 0.645 Test Loss: 1.689 Test Acc: 0.645
Validation loss decreased (-0.618038 --> -0.645273).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1046996
	speed: 0.2801s/iter; left time: 10100.4101s
	iters: 200, epoch: 3 | loss: 2.6441669
	speed: 0.0787s/iter; left time: 2831.0950s
	iters: 300, epoch: 3 | loss: 1.3584971
	speed: 0.0792s/iter; left time: 2838.6878s
Epoch: 3 cost time: 29.970185041427612
Epoch: 3, Steps: 369 | Train Loss: 1.969 Vali Loss: 2.775 Vali Acc: 0.651 Test Loss: 2.775 Test Acc: 0.651
Validation loss decreased (-0.645273 --> -0.650653).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8212421
	speed: 0.3181s/iter; left time: 11353.6264s
	iters: 200, epoch: 4 | loss: 1.8646724
	speed: 0.0777s/iter; left time: 2764.0265s
	iters: 300, epoch: 4 | loss: 1.7685710
	speed: 0.0778s/iter; left time: 2763.0202s
Epoch: 4 cost time: 29.48739004135132
Epoch: 4, Steps: 369 | Train Loss: 2.084 Vali Loss: 2.356 Vali Acc: 0.646 Test Loss: 2.356 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3966529
	speed: 0.3011s/iter; left time: 10636.7841s
	iters: 200, epoch: 5 | loss: 1.8590814
	speed: 0.0649s/iter; left time: 2285.6477s
	iters: 300, epoch: 5 | loss: 3.9322364
	speed: 0.0635s/iter; left time: 2229.0098s
Epoch: 5 cost time: 25.166062116622925
Epoch: 5, Steps: 369 | Train Loss: 1.734 Vali Loss: 4.049 Vali Acc: 0.598 Test Loss: 4.049 Test Acc: 0.598
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5397521
	speed: 0.2654s/iter; left time: 9277.5973s
	iters: 200, epoch: 6 | loss: 2.6726723
	speed: 0.0602s/iter; left time: 2099.5229s
	iters: 300, epoch: 6 | loss: 4.9852252
	speed: 0.0632s/iter; left time: 2196.1845s
Epoch: 6 cost time: 23.79253125190735
Epoch: 6, Steps: 369 | Train Loss: 1.321 Vali Loss: 3.505 Vali Acc: 0.629 Test Loss: 3.505 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2855432
	speed: 0.2649s/iter; left time: 9161.3518s
	iters: 200, epoch: 7 | loss: 2.5665965
	speed: 0.0663s/iter; left time: 2287.1940s
	iters: 300, epoch: 7 | loss: 0.6773019
	speed: 0.0802s/iter; left time: 2756.9870s
Epoch: 7 cost time: 27.41661810874939
Epoch: 7, Steps: 369 | Train Loss: 0.776 Vali Loss: 3.490 Vali Acc: 0.625 Test Loss: 3.490 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0969220
	speed: 0.3112s/iter; left time: 10648.1438s
	iters: 200, epoch: 8 | loss: 0.8359923
	speed: 0.0791s/iter; left time: 2697.3067s
	iters: 300, epoch: 8 | loss: 0.0156651
	speed: 0.0792s/iter; left time: 2693.1793s
Epoch: 8 cost time: 30.108898162841797
Epoch: 8, Steps: 369 | Train Loss: 0.544 Vali Loss: 2.302 Vali Acc: 0.638 Test Loss: 2.302 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1071281
	speed: 0.3212s/iter; left time: 10871.2669s
	iters: 200, epoch: 9 | loss: 0.1885145
	speed: 0.0815s/iter; left time: 2750.0243s
	iters: 300, epoch: 9 | loss: 0.1615638
	speed: 0.0677s/iter; left time: 2277.1454s
Epoch: 9 cost time: 28.503645420074463
Epoch: 9, Steps: 369 | Train Loss: 0.251 Vali Loss: 2.028 Vali Acc: 0.633 Test Loss: 2.028 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1290574
	speed: 0.2722s/iter; left time: 9112.8828s
	iters: 200, epoch: 10 | loss: 0.0884450
	speed: 0.0686s/iter; left time: 2290.1167s
	iters: 300, epoch: 10 | loss: 0.3045890
	speed: 0.0668s/iter; left time: 2223.8730s
Epoch: 10 cost time: 25.650147914886475
Epoch: 10, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.873 Vali Acc: 0.633 Test Loss: 1.873 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0979558
	speed: 0.2730s/iter; left time: 9039.1966s
	iters: 200, epoch: 11 | loss: 0.0135086
	speed: 0.0646s/iter; left time: 2131.1426s
	iters: 300, epoch: 11 | loss: 0.0226239
	speed: 0.0736s/iter; left time: 2423.2566s
Epoch: 11 cost time: 26.64396333694458
Epoch: 11, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.815 Vali Acc: 0.645 Test Loss: 1.815 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1300943
	speed: 0.3147s/iter; left time: 10305.1794s
	iters: 200, epoch: 12 | loss: 0.0056926
	speed: 0.0779s/iter; left time: 2543.5540s
	iters: 300, epoch: 12 | loss: 0.1801937
	speed: 0.0775s/iter; left time: 2523.4289s
Epoch: 12 cost time: 29.526888132095337
Epoch: 12, Steps: 369 | Train Loss: 0.076 Vali Loss: 1.932 Vali Acc: 0.650 Test Loss: 1.932 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0054826
	speed: 0.3066s/iter; left time: 9924.0663s
	iters: 200, epoch: 13 | loss: 0.0096542
	speed: 0.0775s/iter; left time: 2501.1038s
	iters: 300, epoch: 13 | loss: 0.0116449
	speed: 0.0779s/iter; left time: 2505.0209s
Epoch: 13 cost time: 28.327592372894287
Epoch: 13, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.159 Vali Acc: 0.646 Test Loss: 2.159 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6506810442678774
model parameter : 311298
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8360444
	speed: 0.0716s/iter; left time: 2634.5670s
	iters: 200, epoch: 1 | loss: 1.3131397
	speed: 0.0650s/iter; left time: 2383.8969s
	iters: 300, epoch: 1 | loss: 2.1864986
	speed: 0.0673s/iter; left time: 2464.0761s
Epoch: 1 cost time: 25.11793303489685
Epoch: 1, Steps: 369 | Train Loss: 1.190 Vali Loss: 1.005 Vali Acc: 0.631 Test Loss: 1.005 Test Acc: 0.631
Validation loss decreased (inf --> -0.631375).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6303140
	speed: 0.2786s/iter; left time: 10148.4508s
	iters: 200, epoch: 2 | loss: 1.2209977
	speed: 0.0667s/iter; left time: 2422.3538s
	iters: 300, epoch: 2 | loss: 1.8335637
	speed: 0.0671s/iter; left time: 2432.7330s
Epoch: 2 cost time: 25.34717845916748
Epoch: 2, Steps: 369 | Train Loss: 1.321 Vali Loss: 1.611 Vali Acc: 0.644 Test Loss: 1.611 Test Acc: 0.644
Validation loss decreased (-0.631375 --> -0.644422).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9207509
	speed: 0.2856s/iter; left time: 10297.8424s
	iters: 200, epoch: 3 | loss: 0.2456085
	speed: 0.0675s/iter; left time: 2428.1742s
	iters: 300, epoch: 3 | loss: 1.9646990
	speed: 0.0658s/iter; left time: 2361.0826s
Epoch: 3 cost time: 24.190120220184326
Epoch: 3, Steps: 369 | Train Loss: 1.579 Vali Loss: 2.166 Vali Acc: 0.643 Test Loss: 2.166 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5596920
	speed: 0.2259s/iter; left time: 8061.7241s
	iters: 200, epoch: 4 | loss: 3.0133407
	speed: 0.0552s/iter; left time: 1963.5012s
	iters: 300, epoch: 4 | loss: 2.4811625
	speed: 0.0551s/iter; left time: 1955.2869s
Epoch: 4 cost time: 20.94281578063965
Epoch: 4, Steps: 369 | Train Loss: 1.709 Vali Loss: 3.040 Vali Acc: 0.624 Test Loss: 3.040 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1774747
	speed: 0.2255s/iter; left time: 7966.9150s
	iters: 200, epoch: 5 | loss: 3.2456448
	speed: 0.0534s/iter; left time: 1879.7818s
	iters: 300, epoch: 5 | loss: 1.4682175
	speed: 0.0526s/iter; left time: 1847.5310s
Epoch: 5 cost time: 20.202123641967773
Epoch: 5, Steps: 369 | Train Loss: 1.400 Vali Loss: 2.680 Vali Acc: 0.643 Test Loss: 2.680 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2045694
	speed: 0.2583s/iter; left time: 9028.0404s
	iters: 200, epoch: 6 | loss: 2.2240434
	speed: 0.0658s/iter; left time: 2292.3439s
	iters: 300, epoch: 6 | loss: 1.8195120
	speed: 0.0659s/iter; left time: 2291.9559s
Epoch: 6 cost time: 24.995656967163086
Epoch: 6, Steps: 369 | Train Loss: 1.038 Vali Loss: 3.058 Vali Acc: 0.649 Test Loss: 3.058 Test Acc: 0.649
Validation loss decreased (-0.644422 --> -0.648664).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7103997
	speed: 0.2794s/iter; left time: 9662.6531s
	iters: 200, epoch: 7 | loss: 0.2428518
	speed: 0.0656s/iter; left time: 2262.6806s
	iters: 300, epoch: 7 | loss: 1.1686870
	speed: 0.0658s/iter; left time: 2261.8389s
Epoch: 7 cost time: 25.011695384979248
Epoch: 7, Steps: 369 | Train Loss: 0.731 Vali Loss: 2.315 Vali Acc: 0.644 Test Loss: 2.315 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6873238
	speed: 0.2687s/iter; left time: 9194.4982s
	iters: 200, epoch: 8 | loss: 0.6028171
	speed: 0.0505s/iter; left time: 1721.7974s
	iters: 300, epoch: 8 | loss: 0.3641379
	speed: 0.0527s/iter; left time: 1791.5253s
Epoch: 8 cost time: 20.025547742843628
Epoch: 8, Steps: 369 | Train Loss: 0.424 Vali Loss: 2.042 Vali Acc: 0.632 Test Loss: 2.042 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1204488
	speed: 0.2287s/iter; left time: 7742.4608s
	iters: 200, epoch: 9 | loss: 0.7479703
	speed: 0.0505s/iter; left time: 1705.2732s
	iters: 300, epoch: 9 | loss: 0.5388992
	speed: 0.0551s/iter; left time: 1855.1620s
Epoch: 9 cost time: 20.220516204833984
Epoch: 9, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.761 Vali Acc: 0.638 Test Loss: 1.761 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1826530
	speed: 0.2275s/iter; left time: 7615.2321s
	iters: 200, epoch: 10 | loss: 0.0281716
	speed: 0.0530s/iter; left time: 1769.8888s
	iters: 300, epoch: 10 | loss: 0.0275272
	speed: 0.0504s/iter; left time: 1675.8269s
Epoch: 10 cost time: 21.063201665878296
Epoch: 10, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.736 Vali Acc: 0.632 Test Loss: 1.736 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3697472
	speed: 0.2851s/iter; left time: 9440.5125s
	iters: 200, epoch: 11 | loss: 0.0271551
	speed: 0.0668s/iter; left time: 2204.7289s
	iters: 300, epoch: 11 | loss: 0.0041941
	speed: 0.0671s/iter; left time: 2208.9320s
Epoch: 11 cost time: 25.522348642349243
Epoch: 11, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.773 Vali Acc: 0.630 Test Loss: 1.773 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1613924
	speed: 0.2832s/iter; left time: 9273.3812s
	iters: 200, epoch: 12 | loss: 0.2914720
	speed: 0.0672s/iter; left time: 2193.7131s
	iters: 300, epoch: 12 | loss: 0.2744414
	speed: 0.0674s/iter; left time: 2193.9135s
Epoch: 12 cost time: 25.574316024780273
Epoch: 12, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.059 Vali Acc: 0.626 Test Loss: 2.059 Test Acc: 0.626
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0020579
	speed: 0.2459s/iter; left time: 7961.7314s
	iters: 200, epoch: 13 | loss: 0.0190278
	speed: 0.0544s/iter; left time: 1755.8495s
	iters: 300, epoch: 13 | loss: 0.0696532
	speed: 0.0553s/iter; left time: 1778.2285s
Epoch: 13 cost time: 21.172300338745117
Epoch: 13, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.048 Vali Acc: 0.643 Test Loss: 2.048 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0022133
	speed: 0.2294s/iter; left time: 7342.2598s
	iters: 200, epoch: 14 | loss: 0.1286726
	speed: 0.0521s/iter; left time: 1660.8216s
	iters: 300, epoch: 14 | loss: 0.1436833
	speed: 0.0521s/iter; left time: 1658.3911s
Epoch: 14 cost time: 20.05449891090393
Epoch: 14, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.060 Vali Acc: 0.637 Test Loss: 2.060 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0203220
	speed: 0.2279s/iter; left time: 7210.3890s
	iters: 200, epoch: 15 | loss: 0.0737963
	speed: 0.0654s/iter; left time: 2061.4757s
	iters: 300, epoch: 15 | loss: 0.0056531
	speed: 0.0658s/iter; left time: 2068.9337s
Epoch: 15 cost time: 23.89565348625183
Epoch: 15, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.193 Vali Acc: 0.641 Test Loss: 2.193 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0042003
	speed: 0.2792s/iter; left time: 8729.6706s
	iters: 200, epoch: 16 | loss: 0.2710547
	speed: 0.0658s/iter; left time: 2050.2814s
	iters: 300, epoch: 16 | loss: 0.0142781
	speed: 0.0657s/iter; left time: 2039.5366s
Epoch: 16 cost time: 24.804251432418823
Epoch: 16, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.340 Vali Acc: 0.642 Test Loss: 2.340 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6486946651532349
model parameter : 219170
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2613702
	speed: 0.0558s/iter; left time: 2053.1202s
	iters: 200, epoch: 1 | loss: 0.7591053
	speed: 0.0413s/iter; left time: 1515.1541s
	iters: 300, epoch: 1 | loss: 2.0813258
	speed: 0.0410s/iter; left time: 1501.0631s
Epoch: 1 cost time: 16.678263902664185
Epoch: 1, Steps: 369 | Train Loss: 0.943 Vali Loss: 0.993 Vali Acc: 0.630 Test Loss: 0.993 Test Acc: 0.630
Validation loss decreased (inf --> -0.630240).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4828149
	speed: 0.1843s/iter; left time: 6713.0968s
	iters: 200, epoch: 2 | loss: 2.0140328
	speed: 0.0422s/iter; left time: 1532.7342s
	iters: 300, epoch: 2 | loss: 1.6485896
	speed: 0.0427s/iter; left time: 1545.4869s
Epoch: 2 cost time: 16.064490795135498
Epoch: 2, Steps: 369 | Train Loss: 1.142 Vali Loss: 2.027 Vali Acc: 0.627 Test Loss: 2.027 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2327552
	speed: 0.2152s/iter; left time: 7761.0637s
	iters: 200, epoch: 3 | loss: 1.7647400
	speed: 0.0535s/iter; left time: 1923.9468s
	iters: 300, epoch: 3 | loss: 0.5097486
	speed: 0.0530s/iter; left time: 1901.0886s
Epoch: 3 cost time: 20.292158365249634
Epoch: 3, Steps: 369 | Train Loss: 1.397 Vali Loss: 2.104 Vali Acc: 0.646 Test Loss: 2.104 Test Acc: 0.646
Validation loss decreased (-0.630240 --> -0.646120).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4596202
	speed: 0.2299s/iter; left time: 8206.2795s
	iters: 200, epoch: 4 | loss: 1.1060487
	speed: 0.0531s/iter; left time: 1891.0441s
	iters: 300, epoch: 4 | loss: 2.6026514
	speed: 0.0527s/iter; left time: 1871.1191s
Epoch: 4 cost time: 20.34101915359497
Epoch: 4, Steps: 369 | Train Loss: 1.318 Vali Loss: 2.557 Vali Acc: 0.633 Test Loss: 2.557 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8010699
	speed: 0.2290s/iter; left time: 8089.5085s
	iters: 200, epoch: 5 | loss: 1.6807535
	speed: 0.0393s/iter; left time: 1384.9663s
	iters: 300, epoch: 5 | loss: 1.1069155
	speed: 0.0410s/iter; left time: 1441.3342s
Epoch: 5 cost time: 16.682047128677368
Epoch: 5, Steps: 369 | Train Loss: 1.163 Vali Loss: 2.711 Vali Acc: 0.633 Test Loss: 2.711 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0625109
	speed: 0.1941s/iter; left time: 6784.3253s
	iters: 200, epoch: 6 | loss: 0.7925025
	speed: 0.0416s/iter; left time: 1450.9414s
	iters: 300, epoch: 6 | loss: 1.3755558
	speed: 0.0412s/iter; left time: 1431.5828s
Epoch: 6 cost time: 15.701390981674194
Epoch: 6, Steps: 369 | Train Loss: 0.904 Vali Loss: 2.524 Vali Acc: 0.618 Test Loss: 2.524 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0097748
	speed: 0.1855s/iter; left time: 6415.1222s
	iters: 200, epoch: 7 | loss: 0.7678702
	speed: 0.0406s/iter; left time: 1400.2646s
	iters: 300, epoch: 7 | loss: 0.3465858
	speed: 0.0416s/iter; left time: 1429.3236s
Epoch: 7 cost time: 15.807951927185059
Epoch: 7, Steps: 369 | Train Loss: 0.683 Vali Loss: 2.264 Vali Acc: 0.658 Test Loss: 2.264 Test Acc: 0.658
Validation loss decreased (-0.646120 --> -0.658320).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4388610
	speed: 0.2048s/iter; left time: 7007.1122s
	iters: 200, epoch: 8 | loss: 0.6347658
	speed: 0.0537s/iter; left time: 1831.0773s
	iters: 300, epoch: 8 | loss: 0.1755837
	speed: 0.0531s/iter; left time: 1806.8757s
Epoch: 8 cost time: 20.455256700515747
Epoch: 8, Steps: 369 | Train Loss: 0.454 Vali Loss: 2.063 Vali Acc: 0.640 Test Loss: 2.063 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1152710
	speed: 0.2355s/iter; left time: 7972.6825s
	iters: 200, epoch: 9 | loss: 0.0241613
	speed: 0.0528s/iter; left time: 1781.8114s
	iters: 300, epoch: 9 | loss: 0.0047859
	speed: 0.0529s/iter; left time: 1779.8214s
Epoch: 9 cost time: 20.157628059387207
Epoch: 9, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.805 Vali Acc: 0.630 Test Loss: 1.805 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1672073
	speed: 0.2329s/iter; left time: 7796.6975s
	iters: 200, epoch: 10 | loss: 0.0616100
	speed: 0.0522s/iter; left time: 1741.9289s
	iters: 300, epoch: 10 | loss: 0.0540790
	speed: 0.0430s/iter; left time: 1430.7281s
Epoch: 10 cost time: 18.30696153640747
Epoch: 10, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.576 Vali Acc: 0.637 Test Loss: 1.576 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0511656
	speed: 0.1894s/iter; left time: 6271.3023s
	iters: 200, epoch: 11 | loss: 0.2885872
	speed: 0.0392s/iter; left time: 1294.2462s
	iters: 300, epoch: 11 | loss: 0.0539259
	speed: 0.0386s/iter; left time: 1270.8522s
Epoch: 11 cost time: 15.316375494003296
Epoch: 11, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.668 Vali Acc: 0.649 Test Loss: 1.668 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0960467
	speed: 0.1850s/iter; left time: 6057.5261s
	iters: 200, epoch: 12 | loss: 0.1544078
	speed: 0.0424s/iter; left time: 1384.7157s
	iters: 300, epoch: 12 | loss: 0.0244521
	speed: 0.0400s/iter; left time: 1302.8610s
Epoch: 12 cost time: 16.108651161193848
Epoch: 12, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.774 Vali Acc: 0.641 Test Loss: 1.774 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1933645
	speed: 0.1824s/iter; left time: 5904.6487s
	iters: 200, epoch: 13 | loss: 0.2184383
	speed: 0.0534s/iter; left time: 1723.3398s
	iters: 300, epoch: 13 | loss: 0.2906865
	speed: 0.0543s/iter; left time: 1748.1855s
Epoch: 13 cost time: 18.974161386489868
Epoch: 13, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.844 Vali Acc: 0.623 Test Loss: 1.844 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0311737
	speed: 0.2236s/iter; left time: 7157.2711s
	iters: 200, epoch: 14 | loss: 0.0153428
	speed: 0.0516s/iter; left time: 1644.8913s
	iters: 300, epoch: 14 | loss: 0.0153851
	speed: 0.0510s/iter; left time: 1622.8349s
Epoch: 14 cost time: 19.67777967453003
Epoch: 14, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.819 Vali Acc: 0.647 Test Loss: 1.819 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0105689
	speed: 0.2288s/iter; left time: 7238.1275s
	iters: 200, epoch: 15 | loss: 0.1298021
	speed: 0.0540s/iter; left time: 1701.3843s
	iters: 300, epoch: 15 | loss: 0.0590462
	speed: 0.0536s/iter; left time: 1685.3008s
Epoch: 15 cost time: 20.42384934425354
Epoch: 15, Steps: 369 | Train Loss: 0.077 Vali Loss: 1.952 Vali Acc: 0.645 Test Loss: 1.952 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1104373
	speed: 0.2041s/iter; left time: 6381.0156s
	iters: 200, epoch: 16 | loss: 0.0057550
	speed: 0.0406s/iter; left time: 1266.4550s
	iters: 300, epoch: 16 | loss: 0.0187087
	speed: 0.0406s/iter; left time: 1261.5578s
Epoch: 16 cost time: 15.950608491897583
Epoch: 16, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.021 Vali Acc: 0.645 Test Loss: 2.021 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0188138
	speed: 0.1861s/iter; left time: 5749.3784s
	iters: 200, epoch: 17 | loss: 0.0159423
	speed: 0.0409s/iter; left time: 1258.4583s
	iters: 300, epoch: 17 | loss: 0.0062213
	speed: 0.0398s/iter; left time: 1222.5609s
Epoch: 17 cost time: 15.493259906768799
Epoch: 17, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.153 Vali Acc: 0.640 Test Loss: 2.153 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6583427922814983
model parameter : 163938
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6061908
	speed: 0.0618s/iter; left time: 2274.4093s
	iters: 200, epoch: 1 | loss: 1.1027094
	speed: 0.0455s/iter; left time: 1670.2612s
	iters: 300, epoch: 1 | loss: 1.3957475
	speed: 0.0453s/iter; left time: 1657.3130s
Epoch: 1 cost time: 18.534512042999268
Epoch: 1, Steps: 369 | Train Loss: 0.939 Vali Loss: 1.206 Vali Acc: 0.640 Test Loss: 1.206 Test Acc: 0.640
Validation loss decreased (inf --> -0.640170).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1580467
	speed: 0.1943s/iter; left time: 7077.6148s
	iters: 200, epoch: 2 | loss: 1.3691450
	speed: 0.0447s/iter; left time: 1625.0580s
	iters: 300, epoch: 2 | loss: 0.4528931
	speed: 0.0447s/iter; left time: 1621.0401s
Epoch: 2 cost time: 17.15493655204773
Epoch: 2, Steps: 369 | Train Loss: 1.026 Vali Loss: 1.504 Vali Acc: 0.640 Test Loss: 1.504 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4675599
	speed: 0.1614s/iter; left time: 5819.4411s
	iters: 200, epoch: 3 | loss: 1.0405065
	speed: 0.0323s/iter; left time: 1162.9378s
	iters: 300, epoch: 3 | loss: 1.6040164
	speed: 0.0332s/iter; left time: 1192.3532s
Epoch: 3 cost time: 12.71189260482788
Epoch: 3, Steps: 369 | Train Loss: 1.150 Vali Loss: 1.867 Vali Acc: 0.634 Test Loss: 1.867 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9660238
	speed: 0.1654s/iter; left time: 5902.9818s
	iters: 200, epoch: 4 | loss: 1.0660222
	speed: 0.0277s/iter; left time: 987.3119s
	iters: 300, epoch: 4 | loss: 1.4343494
	speed: 0.0338s/iter; left time: 1198.4031s
Epoch: 4 cost time: 12.38893723487854
Epoch: 4, Steps: 369 | Train Loss: 1.151 Vali Loss: 2.527 Vali Acc: 0.617 Test Loss: 2.527 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2409204
	speed: 0.1676s/iter; left time: 5920.9549s
	iters: 200, epoch: 5 | loss: 1.1445475
	speed: 0.0328s/iter; left time: 1156.2762s
	iters: 300, epoch: 5 | loss: 0.3323856
	speed: 0.0343s/iter; left time: 1203.6195s
Epoch: 5 cost time: 13.060800313949585
Epoch: 5, Steps: 369 | Train Loss: 0.991 Vali Loss: 2.510 Vali Acc: 0.632 Test Loss: 2.510 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.8440825
	speed: 0.1561s/iter; left time: 5457.3932s
	iters: 200, epoch: 6 | loss: 1.1345083
	speed: 0.0409s/iter; left time: 1426.7958s
	iters: 300, epoch: 6 | loss: 0.5353676
	speed: 0.0401s/iter; left time: 1394.4047s
Epoch: 6 cost time: 15.488801002502441
Epoch: 6, Steps: 369 | Train Loss: 0.743 Vali Loss: 2.533 Vali Acc: 0.630 Test Loss: 2.533 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5977815
	speed: 0.1593s/iter; left time: 5510.5214s
	iters: 200, epoch: 7 | loss: 0.0258498
	speed: 0.0230s/iter; left time: 794.6329s
	iters: 300, epoch: 7 | loss: 0.6657181
	speed: 0.0224s/iter; left time: 768.6540s
Epoch: 7 cost time: 9.018325328826904
Epoch: 7, Steps: 369 | Train Loss: 0.586 Vali Loss: 2.420 Vali Acc: 0.632 Test Loss: 2.420 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.9318768
	speed: 0.1123s/iter; left time: 3842.6374s
	iters: 200, epoch: 8 | loss: 0.3921647
	speed: 0.0222s/iter; left time: 757.9153s
	iters: 300, epoch: 8 | loss: 0.3243434
	speed: 0.0214s/iter; left time: 727.9054s
Epoch: 8 cost time: 8.780983448028564
Epoch: 8, Steps: 369 | Train Loss: 0.451 Vali Loss: 2.112 Vali Acc: 0.638 Test Loss: 2.112 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.2085668
	speed: 0.1632s/iter; left time: 5524.4766s
	iters: 200, epoch: 9 | loss: 0.4860139
	speed: 0.0439s/iter; left time: 1482.2426s
	iters: 300, epoch: 9 | loss: 0.2142121
	speed: 0.0441s/iter; left time: 1485.2633s
Epoch: 9 cost time: 16.971014499664307
Epoch: 9, Steps: 369 | Train Loss: 0.310 Vali Loss: 1.873 Vali Acc: 0.628 Test Loss: 1.873 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.1039539
	speed: 0.1888s/iter; left time: 6322.2015s
	iters: 200, epoch: 10 | loss: 0.0388461
	speed: 0.0437s/iter; left time: 1458.8894s
	iters: 300, epoch: 10 | loss: 0.1166953
	speed: 0.0441s/iter; left time: 1469.0367s
Epoch: 10 cost time: 17.02989363670349
Epoch: 10, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.664 Vali Acc: 0.627 Test Loss: 1.664 Test Acc: 0.627
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0163564
	speed: 0.1716s/iter; left time: 5681.0931s
	iters: 200, epoch: 11 | loss: 0.1800190
	speed: 0.0324s/iter; left time: 1068.3298s
	iters: 300, epoch: 11 | loss: 0.0420930
	speed: 0.0333s/iter; left time: 1096.6249s
Epoch: 11 cost time: 12.527462720870972
Epoch: 11, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.754 Vali Acc: 0.635 Test Loss: 1.754 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6401816118047673
model parameter : 136386
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7560554
	speed: 0.0611s/iter; left time: 2247.1167s
	iters: 200, epoch: 1 | loss: 0.9539338
	speed: 0.0411s/iter; left time: 1507.5638s
	iters: 300, epoch: 1 | loss: 1.2544746
	speed: 0.0419s/iter; left time: 1532.9011s
Epoch: 1 cost time: 17.432122945785522
Epoch: 1, Steps: 369 | Train Loss: 0.893 Vali Loss: 1.286 Vali Acc: 0.621 Test Loss: 1.286 Test Acc: 0.621
Validation loss decreased (inf --> -0.621440).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9960819
	speed: 0.1814s/iter; left time: 6607.0746s
	iters: 200, epoch: 2 | loss: 0.7381890
	speed: 0.0415s/iter; left time: 1506.3213s
	iters: 300, epoch: 2 | loss: 1.6395569
	speed: 0.0417s/iter; left time: 1511.2202s
Epoch: 2 cost time: 15.959594488143921
Epoch: 2, Steps: 369 | Train Loss: 0.890 Vali Loss: 1.535 Vali Acc: 0.641 Test Loss: 1.535 Test Acc: 0.641
Validation loss decreased (-0.621440 --> -0.641301).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8967382
	speed: 0.1669s/iter; left time: 6017.4398s
	iters: 200, epoch: 3 | loss: 1.0880380
	speed: 0.0285s/iter; left time: 1024.6671s
	iters: 300, epoch: 3 | loss: 0.2911579
	speed: 0.0287s/iter; left time: 1030.4057s
Epoch: 3 cost time: 11.2618567943573
Epoch: 3, Steps: 369 | Train Loss: 1.007 Vali Loss: 1.639 Vali Acc: 0.644 Test Loss: 1.639 Test Acc: 0.644
Validation loss decreased (-0.641301 --> -0.643854).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8339515
	speed: 0.1387s/iter; left time: 4949.1665s
	iters: 200, epoch: 4 | loss: 1.4945261
	speed: 0.0279s/iter; left time: 991.7268s
	iters: 300, epoch: 4 | loss: 1.0629420
	speed: 0.0251s/iter; left time: 890.8550s
Epoch: 4 cost time: 10.864541053771973
Epoch: 4, Steps: 369 | Train Loss: 0.985 Vali Loss: 2.282 Vali Acc: 0.644 Test Loss: 2.282 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9969132
	speed: 0.1367s/iter; left time: 4827.8960s
	iters: 200, epoch: 5 | loss: 0.9063590
	speed: 0.0277s/iter; left time: 974.3753s
	iters: 300, epoch: 5 | loss: 0.6804964
	speed: 0.0280s/iter; left time: 983.2252s
Epoch: 5 cost time: 10.886333703994751
Epoch: 5, Steps: 369 | Train Loss: 0.905 Vali Loss: 2.326 Vali Acc: 0.625 Test Loss: 2.326 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0251510
	speed: 0.1568s/iter; left time: 5482.0745s
	iters: 200, epoch: 6 | loss: 0.1024368
	speed: 0.0408s/iter; left time: 1423.0109s
	iters: 300, epoch: 6 | loss: 0.4094702
	speed: 0.0410s/iter; left time: 1424.4012s
Epoch: 6 cost time: 15.78049111366272
Epoch: 6, Steps: 369 | Train Loss: 0.742 Vali Loss: 2.413 Vali Acc: 0.636 Test Loss: 2.413 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0108281
	speed: 0.1809s/iter; left time: 6257.3337s
	iters: 200, epoch: 7 | loss: 0.1263868
	speed: 0.0412s/iter; left time: 1420.5202s
	iters: 300, epoch: 7 | loss: 0.3563969
	speed: 0.0414s/iter; left time: 1422.0333s
Epoch: 7 cost time: 15.974309921264648
Epoch: 7, Steps: 369 | Train Loss: 0.578 Vali Loss: 2.046 Vali Acc: 0.646 Test Loss: 2.046 Test Acc: 0.646
Validation loss decreased (-0.643854 --> -0.646120).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3058675
	speed: 0.1691s/iter; left time: 5787.3032s
	iters: 200, epoch: 8 | loss: 1.1259177
	speed: 0.0283s/iter; left time: 965.3298s
	iters: 300, epoch: 8 | loss: 0.0881606
	speed: 0.0286s/iter; left time: 972.4607s
Epoch: 8 cost time: 10.981050491333008
Epoch: 8, Steps: 369 | Train Loss: 0.449 Vali Loss: 1.879 Vali Acc: 0.635 Test Loss: 1.879 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1049723
	speed: 0.1532s/iter; left time: 5184.9295s
	iters: 200, epoch: 9 | loss: 0.0945401
	speed: 0.0272s/iter; left time: 916.8838s
	iters: 300, epoch: 9 | loss: 0.2041545
	speed: 0.0275s/iter; left time: 925.9109s
Epoch: 9 cost time: 10.661816120147705
Epoch: 9, Steps: 369 | Train Loss: 0.320 Vali Loss: 1.666 Vali Acc: 0.645 Test Loss: 1.666 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4049384
	speed: 0.1377s/iter; left time: 4611.2077s
	iters: 200, epoch: 10 | loss: 0.0376382
	speed: 0.0280s/iter; left time: 936.1463s
	iters: 300, epoch: 10 | loss: 0.1959512
	speed: 0.0284s/iter; left time: 943.7556s
Epoch: 10 cost time: 11.0386643409729
Epoch: 10, Steps: 369 | Train Loss: 0.247 Vali Loss: 1.626 Vali Acc: 0.645 Test Loss: 1.626 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1904020
	speed: 0.1510s/iter; left time: 4999.1966s
	iters: 200, epoch: 11 | loss: 0.1613856
	speed: 0.0405s/iter; left time: 1337.9420s
	iters: 300, epoch: 11 | loss: 0.7015724
	speed: 0.0408s/iter; left time: 1342.1625s
Epoch: 11 cost time: 15.554769039154053
Epoch: 11, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.633 Vali Acc: 0.650 Test Loss: 1.633 Test Acc: 0.650
Validation loss decreased (-0.646120 --> -0.650097).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0580504
	speed: 0.1781s/iter; left time: 5832.3958s
	iters: 200, epoch: 12 | loss: 0.3105577
	speed: 0.0412s/iter; left time: 1346.1356s
	iters: 300, epoch: 12 | loss: 0.0671818
	speed: 0.0411s/iter; left time: 1336.2138s
Epoch: 12 cost time: 15.971861124038696
Epoch: 12, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.635 Vali Acc: 0.651 Test Loss: 1.635 Test Acc: 0.651
Validation loss decreased (-0.650097 --> -0.650665).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1874752
	speed: 0.1786s/iter; left time: 5783.1354s
	iters: 200, epoch: 13 | loss: 0.1700113
	speed: 0.0299s/iter; left time: 965.0455s
	iters: 300, epoch: 13 | loss: 0.4223516
	speed: 0.0286s/iter; left time: 920.5809s
Epoch: 13 cost time: 12.762107610702515
Epoch: 13, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.733 Vali Acc: 0.649 Test Loss: 1.733 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0341629
	speed: 0.1409s/iter; left time: 4510.6889s
	iters: 200, epoch: 14 | loss: 0.0475904
	speed: 0.0297s/iter; left time: 946.7341s
	iters: 300, epoch: 14 | loss: 0.1544504
	speed: 0.0293s/iter; left time: 930.9375s
Epoch: 14 cost time: 11.394405841827393
Epoch: 14, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.740 Vali Acc: 0.657 Test Loss: 1.740 Test Acc: 0.657
Validation loss decreased (-0.650665 --> -0.656623).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0326291
	speed: 0.1334s/iter; left time: 4219.2600s
	iters: 200, epoch: 15 | loss: 0.1663489
	speed: 0.0277s/iter; left time: 873.2165s
	iters: 300, epoch: 15 | loss: 0.1955553
	speed: 0.0282s/iter; left time: 886.2014s
Epoch: 15 cost time: 11.01158881187439
Epoch: 15, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.947 Vali Acc: 0.639 Test Loss: 1.947 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0211700
	speed: 0.1394s/iter; left time: 4357.3577s
	iters: 200, epoch: 16 | loss: 0.1433130
	speed: 0.0416s/iter; left time: 1296.5547s
	iters: 300, epoch: 16 | loss: 0.0359051
	speed: 0.0419s/iter; left time: 1300.5727s
Epoch: 16 cost time: 14.905227184295654
Epoch: 16, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.991 Vali Acc: 0.638 Test Loss: 1.991 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0683303
	speed: 0.1779s/iter; left time: 5496.1135s
	iters: 200, epoch: 17 | loss: 0.0644448
	speed: 0.0414s/iter; left time: 1273.6995s
	iters: 300, epoch: 17 | loss: 0.2347587
	speed: 0.0417s/iter; left time: 1278.7495s
Epoch: 17 cost time: 15.999799966812134
Epoch: 17, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.903 Vali Acc: 0.648 Test Loss: 1.903 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0577963
	speed: 0.1833s/iter; left time: 5596.1631s
	iters: 200, epoch: 18 | loss: 0.1501637
	speed: 0.0415s/iter; left time: 1263.7357s
	iters: 300, epoch: 18 | loss: 0.0152896
	speed: 0.0323s/iter; left time: 979.7528s
Epoch: 18 cost time: 14.202461957931519
Epoch: 18, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.993 Vali Acc: 0.647 Test Loss: 1.993 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0690167
	speed: 0.1472s/iter; left time: 4440.6242s
	iters: 200, epoch: 19 | loss: 0.0792570
	speed: 0.0291s/iter; left time: 874.8735s
	iters: 300, epoch: 19 | loss: 0.0119990
	speed: 0.0284s/iter; left time: 850.5463s
Epoch: 19 cost time: 11.148825645446777
Epoch: 19, Steps: 369 | Train Loss: 0.080 Vali Loss: 1.960 Vali Acc: 0.650 Test Loss: 1.960 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0050261
	speed: 0.1378s/iter; left time: 4103.5943s
	iters: 200, epoch: 20 | loss: 0.0088671
	speed: 0.0285s/iter; left time: 846.6578s
	iters: 300, epoch: 20 | loss: 0.0029090
	speed: 0.0291s/iter; left time: 860.9394s
Epoch: 20 cost time: 11.192402601242065
Epoch: 20, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.039 Vali Acc: 0.653 Test Loss: 2.039 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0265276
	speed: 0.1372s/iter; left time: 4036.4053s
	iters: 200, epoch: 21 | loss: 0.0219060
	speed: 0.0325s/iter; left time: 951.6389s
	iters: 300, epoch: 21 | loss: 0.0111647
	speed: 0.0411s/iter; left time: 1201.6097s
Epoch: 21 cost time: 13.843851089477539
Epoch: 21, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.050 Vali Acc: 0.649 Test Loss: 2.050 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1591987
	speed: 0.1843s/iter; left time: 5354.7878s
	iters: 200, epoch: 22 | loss: 0.0309943
	speed: 0.0402s/iter; left time: 1163.9137s
	iters: 300, epoch: 22 | loss: 0.0198469
	speed: 0.0411s/iter; left time: 1184.8081s
Epoch: 22 cost time: 15.739225387573242
Epoch: 22, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.144 Vali Acc: 0.645 Test Loss: 2.144 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2884927
	speed: 0.1879s/iter; left time: 5388.2013s
	iters: 200, epoch: 23 | loss: 0.0100087
	speed: 0.0410s/iter; left time: 1172.6886s
	iters: 300, epoch: 23 | loss: 0.0037074
	speed: 0.0393s/iter; left time: 1120.1968s
Epoch: 23 cost time: 14.514942646026611
Epoch: 23, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.230 Vali Acc: 0.652 Test Loss: 2.230 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0002916
	speed: 0.1466s/iter; left time: 4151.8835s
	iters: 200, epoch: 24 | loss: 0.0096854
	speed: 0.0278s/iter; left time: 784.6839s
	iters: 300, epoch: 24 | loss: 0.6039889
	speed: 0.0266s/iter; left time: 747.5675s
Epoch: 24 cost time: 10.955342054367065
Epoch: 24, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.228 Vali Acc: 0.653 Test Loss: 2.228 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6566401816118048
model parameter : 108834
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9463029
	speed: 0.0509s/iter; left time: 1874.5801s
	iters: 200, epoch: 1 | loss: 0.5529199
	speed: 0.0338s/iter; left time: 1240.3630s
	iters: 300, epoch: 1 | loss: 1.0875319
	speed: 0.0336s/iter; left time: 1229.7894s
Epoch: 1 cost time: 14.231775283813477
Epoch: 1, Steps: 369 | Train Loss: 0.829 Vali Loss: 1.308 Vali Acc: 0.623 Test Loss: 1.308 Test Acc: 0.623
Validation loss decreased (inf --> -0.623142).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3061846
	speed: 0.1560s/iter; left time: 5681.9536s
	iters: 200, epoch: 2 | loss: 0.7726181
	speed: 0.0338s/iter; left time: 1228.8995s
	iters: 300, epoch: 2 | loss: 0.3418273
	speed: 0.0341s/iter; left time: 1236.2133s
Epoch: 2 cost time: 13.180692911148071
Epoch: 2, Steps: 369 | Train Loss: 0.829 Vali Loss: 1.827 Vali Acc: 0.601 Test Loss: 1.827 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1126188
	speed: 0.1518s/iter; left time: 5473.2533s
	iters: 200, epoch: 3 | loss: 0.6795148
	speed: 0.0343s/iter; left time: 1232.3214s
	iters: 300, epoch: 3 | loss: 0.9966375
	speed: 0.0335s/iter; left time: 1202.8930s
Epoch: 3 cost time: 12.42611312866211
Epoch: 3, Steps: 369 | Train Loss: 0.872 Vali Loss: 1.783 Vali Acc: 0.650 Test Loss: 1.783 Test Acc: 0.650
Validation loss decreased (-0.623142 --> -0.650379).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6931379
	speed: 0.1253s/iter; left time: 4472.9042s
	iters: 200, epoch: 4 | loss: 0.4265251
	speed: 0.0242s/iter; left time: 861.4505s
	iters: 300, epoch: 4 | loss: 0.8578108
	speed: 0.0238s/iter; left time: 845.5531s
Epoch: 4 cost time: 9.454829216003418
Epoch: 4, Steps: 369 | Train Loss: 0.860 Vali Loss: 2.153 Vali Acc: 0.646 Test Loss: 2.153 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0179739
	speed: 0.1205s/iter; left time: 4257.6503s
	iters: 200, epoch: 5 | loss: 0.2528254
	speed: 0.0235s/iter; left time: 828.9521s
	iters: 300, epoch: 5 | loss: 1.1609216
	speed: 0.0242s/iter; left time: 850.1912s
Epoch: 5 cost time: 9.034971237182617
Epoch: 5, Steps: 369 | Train Loss: 0.746 Vali Loss: 2.162 Vali Acc: 0.634 Test Loss: 2.162 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3912638
	speed: 0.1235s/iter; left time: 4317.6986s
	iters: 200, epoch: 6 | loss: 0.2657313
	speed: 0.0239s/iter; left time: 833.3382s
	iters: 300, epoch: 6 | loss: 1.4197955
	speed: 0.0240s/iter; left time: 832.7738s
Epoch: 6 cost time: 9.344506025314331
Epoch: 6, Steps: 369 | Train Loss: 0.637 Vali Loss: 2.090 Vali Acc: 0.639 Test Loss: 2.090 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9480562
	speed: 0.1362s/iter; left time: 4710.0787s
	iters: 200, epoch: 7 | loss: 0.2499910
	speed: 0.0354s/iter; left time: 1220.2181s
	iters: 300, epoch: 7 | loss: 0.9262542
	speed: 0.0344s/iter; left time: 1182.5914s
Epoch: 7 cost time: 13.291118144989014
Epoch: 7, Steps: 369 | Train Loss: 0.503 Vali Loss: 1.966 Vali Acc: 0.646 Test Loss: 1.966 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5137708
	speed: 0.1636s/iter; left time: 5599.0857s
	iters: 200, epoch: 8 | loss: 0.4252404
	speed: 0.0350s/iter; left time: 1193.7239s
	iters: 300, epoch: 8 | loss: 0.1273817
	speed: 0.0351s/iter; left time: 1195.2276s
Epoch: 8 cost time: 13.872511148452759
Epoch: 8, Steps: 369 | Train Loss: 0.402 Vali Loss: 1.785 Vali Acc: 0.655 Test Loss: 1.785 Test Acc: 0.655
Validation loss decreased (-0.650379 --> -0.655203).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1760141
	speed: 0.1647s/iter; left time: 5576.4525s
	iters: 200, epoch: 9 | loss: 0.8179024
	speed: 0.0355s/iter; left time: 1198.3116s
	iters: 300, epoch: 9 | loss: 0.8774307
	speed: 0.0243s/iter; left time: 818.4279s
Epoch: 9 cost time: 12.021098613739014
Epoch: 9, Steps: 369 | Train Loss: 0.323 Vali Loss: 1.900 Vali Acc: 0.630 Test Loss: 1.900 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0808467
	speed: 0.1317s/iter; left time: 4409.9812s
	iters: 200, epoch: 10 | loss: 0.9669032
	speed: 0.0241s/iter; left time: 803.6838s
	iters: 300, epoch: 10 | loss: 0.8391688
	speed: 0.0244s/iter; left time: 812.2935s
Epoch: 10 cost time: 9.71917462348938
Epoch: 10, Steps: 369 | Train Loss: 0.264 Vali Loss: 1.687 Vali Acc: 0.637 Test Loss: 1.687 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2260567
	speed: 0.1433s/iter; left time: 4746.4004s
	iters: 200, epoch: 11 | loss: 0.1128043
	speed: 0.0250s/iter; left time: 824.3845s
	iters: 300, epoch: 11 | loss: 0.6017984
	speed: 0.0249s/iter; left time: 818.0557s
Epoch: 11 cost time: 10.063942432403564
Epoch: 11, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.778 Vali Acc: 0.648 Test Loss: 1.778 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1113005
	speed: 0.1384s/iter; left time: 4530.3926s
	iters: 200, epoch: 12 | loss: 0.0622056
	speed: 0.0273s/iter; left time: 891.0468s
	iters: 300, epoch: 12 | loss: 0.0847118
	speed: 0.0342s/iter; left time: 1111.7324s
Epoch: 12 cost time: 11.883201837539673
Epoch: 12, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.729 Vali Acc: 0.654 Test Loss: 1.729 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0112795
	speed: 0.1630s/iter; left time: 5275.3788s
	iters: 200, epoch: 13 | loss: 0.0536690
	speed: 0.0350s/iter; left time: 1129.9654s
	iters: 300, epoch: 13 | loss: 0.1423239
	speed: 0.0342s/iter; left time: 1100.5029s
Epoch: 13 cost time: 13.593547582626343
Epoch: 13, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.819 Vali Acc: 0.648 Test Loss: 1.819 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0155766
	speed: 0.1627s/iter; left time: 5206.2898s
	iters: 200, epoch: 14 | loss: 0.0945743
	speed: 0.0347s/iter; left time: 1108.4711s
	iters: 300, epoch: 14 | loss: 0.1005900
	speed: 0.0346s/iter; left time: 1101.7470s
Epoch: 14 cost time: 13.571876049041748
Epoch: 14, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.769 Vali Acc: 0.649 Test Loss: 1.769 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0094577
	speed: 0.1373s/iter; left time: 4342.9651s
	iters: 200, epoch: 15 | loss: 0.3510995
	speed: 0.0242s/iter; left time: 764.5116s
	iters: 300, epoch: 15 | loss: 0.0415467
	speed: 0.0253s/iter; left time: 795.7431s
Epoch: 15 cost time: 9.945611000061035
Epoch: 15, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.895 Vali Acc: 0.646 Test Loss: 1.895 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0920543
	speed: 0.1360s/iter; left time: 4253.2509s
	iters: 200, epoch: 16 | loss: 0.0060353
	speed: 0.0249s/iter; left time: 775.4899s
	iters: 300, epoch: 16 | loss: 0.0388722
	speed: 0.0247s/iter; left time: 766.6314s
Epoch: 16 cost time: 9.828960657119751
Epoch: 16, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.906 Vali Acc: 0.648 Test Loss: 1.906 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0692333
	speed: 0.1446s/iter; left time: 4466.9948s
	iters: 200, epoch: 17 | loss: 0.0015826
	speed: 0.0247s/iter; left time: 762.0297s
	iters: 300, epoch: 17 | loss: 0.0275457
	speed: 0.0247s/iter; left time: 758.3898s
Epoch: 17 cost time: 9.937870264053345
Epoch: 17, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.911 Vali Acc: 0.642 Test Loss: 1.911 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0026061
	speed: 0.1606s/iter; left time: 4903.1190s
	iters: 200, epoch: 18 | loss: 0.1730333
	speed: 0.0339s/iter; left time: 1032.4292s
	iters: 300, epoch: 18 | loss: 0.0629623
	speed: 0.0344s/iter; left time: 1042.3854s
Epoch: 18 cost time: 13.565696239471436
Epoch: 18, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.943 Vali Acc: 0.647 Test Loss: 1.943 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6552213393870602
model parameter : 90498
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 5.1364121
	speed: 0.1294s/iter; left time: 4763.5665s
	iters: 200, epoch: 1 | loss: 2.1070650
	speed: 0.1107s/iter; left time: 4061.7051s
	iters: 300, epoch: 1 | loss: 1.0443369
	speed: 0.1116s/iter; left time: 4084.4201s
Epoch: 1 cost time: 43.9008104801178
Epoch: 1, Steps: 369 | Train Loss: 2.225 Vali Loss: 1.217 Vali Acc: 0.615 Test Loss: 1.217 Test Acc: 0.615
Validation loss decreased (inf --> -0.615198).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7677858
	speed: 0.4887s/iter; left time: 17805.6150s
	iters: 200, epoch: 2 | loss: 0.6526682
	speed: 0.1437s/iter; left time: 5221.4115s
	iters: 300, epoch: 2 | loss: 2.9244359
	speed: 0.1402s/iter; left time: 5080.3107s
Epoch: 2 cost time: 51.316654920578
Epoch: 2, Steps: 369 | Train Loss: 2.392 Vali Loss: 3.041 Vali Acc: 0.634 Test Loss: 3.041 Test Acc: 0.634
Validation loss decreased (-0.615198 --> -0.634192).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.6820960
	speed: 0.3984s/iter; left time: 14366.8111s
	iters: 200, epoch: 3 | loss: 5.0791669
	speed: 0.1028s/iter; left time: 3697.1002s
	iters: 300, epoch: 3 | loss: 3.8130345
	speed: 0.1034s/iter; left time: 3708.9481s
Epoch: 3 cost time: 38.85324835777283
Epoch: 3, Steps: 369 | Train Loss: 3.060 Vali Loss: 3.861 Vali Acc: 0.645 Test Loss: 3.861 Test Acc: 0.645
Validation loss decreased (-0.634192 --> -0.644683).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.7793574
	speed: 0.4499s/iter; left time: 16058.0937s
	iters: 200, epoch: 4 | loss: 4.9122677
	speed: 0.1426s/iter; left time: 5075.0875s
	iters: 300, epoch: 4 | loss: 1.7205101
	speed: 0.1423s/iter; left time: 5049.8325s
Epoch: 4 cost time: 53.284279108047485
Epoch: 4, Steps: 369 | Train Loss: 2.977 Vali Loss: 4.042 Vali Acc: 0.638 Test Loss: 4.042 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0026991
	speed: 0.4376s/iter; left time: 15459.8211s
	iters: 200, epoch: 5 | loss: 4.1554403
	speed: 0.1067s/iter; left time: 3758.8787s
	iters: 300, epoch: 5 | loss: 1.8965815
	speed: 0.1040s/iter; left time: 3651.3989s
Epoch: 5 cost time: 39.97756361961365
Epoch: 5, Steps: 369 | Train Loss: 2.476 Vali Loss: 4.018 Vali Acc: 0.643 Test Loss: 4.018 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3571202
	speed: 0.4419s/iter; left time: 15447.8594s
	iters: 200, epoch: 6 | loss: 0.0297829
	speed: 0.1439s/iter; left time: 5017.4092s
	iters: 300, epoch: 6 | loss: 0.4818530
	speed: 0.1464s/iter; left time: 5087.3689s
Epoch: 6 cost time: 54.08448004722595
Epoch: 6, Steps: 369 | Train Loss: 1.797 Vali Loss: 3.982 Vali Acc: 0.640 Test Loss: 3.982 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0229802
	speed: 0.4605s/iter; left time: 15927.6752s
	iters: 200, epoch: 7 | loss: 0.1474511
	speed: 0.1051s/iter; left time: 3625.0849s
	iters: 300, epoch: 7 | loss: 1.5210891
	speed: 0.1059s/iter; left time: 3641.2557s
Epoch: 7 cost time: 39.64492344856262
Epoch: 7, Steps: 369 | Train Loss: 0.867 Vali Loss: 4.493 Vali Acc: 0.623 Test Loss: 4.493 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.5575778
	speed: 0.4016s/iter; left time: 13742.6941s
	iters: 200, epoch: 8 | loss: 0.1862956
	speed: 0.1402s/iter; left time: 4783.0010s
	iters: 300, epoch: 8 | loss: 0.0772823
	speed: 0.1409s/iter; left time: 4793.2926s
Epoch: 8 cost time: 49.77009320259094
Epoch: 8, Steps: 369 | Train Loss: 0.462 Vali Loss: 3.788 Vali Acc: 0.632 Test Loss: 3.788 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0002426
	speed: 0.4839s/iter; left time: 16380.7789s
	iters: 200, epoch: 9 | loss: 0.2974689
	speed: 0.1124s/iter; left time: 3793.4042s
	iters: 300, epoch: 9 | loss: 0.0162613
	speed: 0.1106s/iter; left time: 3720.4667s
Epoch: 9 cost time: 43.984058141708374
Epoch: 9, Steps: 369 | Train Loss: 0.311 Vali Loss: 3.380 Vali Acc: 0.643 Test Loss: 3.380 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3899724
	speed: 0.4061s/iter; left time: 13595.9211s
	iters: 200, epoch: 10 | loss: 0.2477940
	speed: 0.1235s/iter; left time: 4123.5871s
	iters: 300, epoch: 10 | loss: 0.0929127
	speed: 0.1435s/iter; left time: 4774.3420s
Epoch: 10 cost time: 48.16109919548035
Epoch: 10, Steps: 369 | Train Loss: 0.212 Vali Loss: 2.734 Vali Acc: 0.632 Test Loss: 2.734 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6248875
	speed: 0.5021s/iter; left time: 16625.0002s
	iters: 200, epoch: 11 | loss: 0.5312502
	speed: 0.1225s/iter; left time: 4043.6095s
	iters: 300, epoch: 11 | loss: 0.2316599
	speed: 0.1123s/iter; left time: 3694.5550s
Epoch: 11 cost time: 46.06671953201294
Epoch: 11, Steps: 369 | Train Loss: 0.151 Vali Loss: 2.629 Vali Acc: 0.627 Test Loss: 2.629 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0078036
	speed: 0.4064s/iter; left time: 13307.7604s
	iters: 200, epoch: 12 | loss: 0.3098558
	speed: 0.1094s/iter; left time: 3570.7918s
	iters: 300, epoch: 12 | loss: 0.0137407
	speed: 0.0912s/iter; left time: 2968.2469s
Epoch: 12 cost time: 40.89501953125
Epoch: 12, Steps: 369 | Train Loss: 0.109 Vali Loss: 2.458 Vali Acc: 0.630 Test Loss: 2.458 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0003006
	speed: 0.3841s/iter; left time: 12435.7602s
	iters: 200, epoch: 13 | loss: 0.0531312
	speed: 0.0782s/iter; left time: 2523.6304s
	iters: 300, epoch: 13 | loss: 0.0124918
	speed: 0.0778s/iter; left time: 2504.4403s
Epoch: 13 cost time: 31.863245964050293
Epoch: 13, Steps: 369 | Train Loss: 0.096 Vali Loss: 2.445 Vali Acc: 0.643 Test Loss: 2.445 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.64472190692395
model parameter : 588610
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0006340
	speed: 0.0742s/iter; left time: 2731.5132s
	iters: 200, epoch: 1 | loss: 5.1953826
	speed: 0.0553s/iter; left time: 2027.8540s
	iters: 300, epoch: 1 | loss: 0.4860807
	speed: 0.0542s/iter; left time: 1982.4818s
Epoch: 1 cost time: 22.283903121948242
Epoch: 1, Steps: 369 | Train Loss: 1.523 Vali Loss: 1.115 Vali Acc: 0.638 Test Loss: 1.115 Test Acc: 0.638
Validation loss decreased (inf --> -0.637900).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6311382
	speed: 0.2502s/iter; left time: 9114.8157s
	iters: 200, epoch: 2 | loss: 0.9721528
	speed: 0.0750s/iter; left time: 2724.3034s
	iters: 300, epoch: 2 | loss: 1.6603916
	speed: 0.0756s/iter; left time: 2737.4834s
Epoch: 2 cost time: 28.358480215072632
Epoch: 2, Steps: 369 | Train Loss: 1.523 Vali Loss: 2.197 Vali Acc: 0.637 Test Loss: 2.197 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0489540
	speed: 0.2810s/iter; left time: 10134.1446s
	iters: 200, epoch: 3 | loss: 2.6345828
	speed: 0.0744s/iter; left time: 2675.3432s
	iters: 300, epoch: 3 | loss: 2.8332193
	speed: 0.0689s/iter; left time: 2471.7323s
Epoch: 3 cost time: 26.308906316757202
Epoch: 3, Steps: 369 | Train Loss: 1.890 Vali Loss: 2.732 Vali Acc: 0.634 Test Loss: 2.732 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3825469
	speed: 0.2372s/iter; left time: 8465.2413s
	iters: 200, epoch: 4 | loss: 2.3839593
	speed: 0.0547s/iter; left time: 1945.4384s
	iters: 300, epoch: 4 | loss: 3.6231303
	speed: 0.0573s/iter; left time: 2034.1907s
Epoch: 4 cost time: 21.841134786605835
Epoch: 4, Steps: 369 | Train Loss: 2.061 Vali Loss: 3.582 Vali Acc: 0.640 Test Loss: 3.582 Test Acc: 0.640
Validation loss decreased (-0.637900 --> -0.640146).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0436828
	speed: 0.2448s/iter; left time: 8648.1193s
	iters: 200, epoch: 5 | loss: 0.9798604
	speed: 0.0747s/iter; left time: 2632.9869s
	iters: 300, epoch: 5 | loss: 0.7345607
	speed: 0.0743s/iter; left time: 2609.4989s
Epoch: 5 cost time: 27.189730405807495
Epoch: 5, Steps: 369 | Train Loss: 1.663 Vali Loss: 3.804 Vali Acc: 0.652 Test Loss: 3.804 Test Acc: 0.652
Validation loss decreased (-0.640146 --> -0.652346).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.8037586
	speed: 0.2877s/iter; left time: 10055.4451s
	iters: 200, epoch: 6 | loss: 1.9656447
	speed: 0.0734s/iter; left time: 2557.6932s
	iters: 300, epoch: 6 | loss: 2.1656480
	speed: 0.0723s/iter; left time: 2514.3000s
Epoch: 6 cost time: 26.588504552841187
Epoch: 6, Steps: 369 | Train Loss: 1.245 Vali Loss: 3.718 Vali Acc: 0.635 Test Loss: 3.718 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6270460
	speed: 0.2378s/iter; left time: 8223.7468s
	iters: 200, epoch: 7 | loss: 0.8379768
	speed: 0.0537s/iter; left time: 1850.8321s
	iters: 300, epoch: 7 | loss: 1.6113808
	speed: 0.0501s/iter; left time: 1722.0261s
Epoch: 7 cost time: 20.436378240585327
Epoch: 7, Steps: 369 | Train Loss: 0.789 Vali Loss: 3.009 Vali Acc: 0.624 Test Loss: 3.009 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2804450
	speed: 0.2359s/iter; left time: 8071.7144s
	iters: 200, epoch: 8 | loss: 0.1876097
	speed: 0.0605s/iter; left time: 2063.0556s
	iters: 300, epoch: 8 | loss: 0.0084822
	speed: 0.0750s/iter; left time: 2552.1250s
Epoch: 8 cost time: 25.389681339263916
Epoch: 8, Steps: 369 | Train Loss: 0.449 Vali Loss: 2.432 Vali Acc: 0.629 Test Loss: 2.432 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0498069
	speed: 0.2875s/iter; left time: 9730.8128s
	iters: 200, epoch: 9 | loss: 0.4416062
	speed: 0.0746s/iter; left time: 2517.7739s
	iters: 300, epoch: 9 | loss: 0.0550118
	speed: 0.0750s/iter; left time: 2523.0928s
Epoch: 9 cost time: 28.400054454803467
Epoch: 9, Steps: 369 | Train Loss: 0.261 Vali Loss: 2.430 Vali Acc: 0.627 Test Loss: 2.430 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0229530
	speed: 0.2558s/iter; left time: 8563.1243s
	iters: 200, epoch: 10 | loss: 0.0132444
	speed: 0.0546s/iter; left time: 1823.5191s
	iters: 300, epoch: 10 | loss: 0.0119521
	speed: 0.0552s/iter; left time: 1838.5296s
Epoch: 10 cost time: 20.973110914230347
Epoch: 10, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.858 Vali Acc: 0.633 Test Loss: 1.858 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1003027
	speed: 0.2361s/iter; left time: 7817.4039s
	iters: 200, epoch: 11 | loss: 0.1390345
	speed: 0.0569s/iter; left time: 1878.9168s
	iters: 300, epoch: 11 | loss: 0.0069813
	speed: 0.0613s/iter; left time: 2018.0287s
Epoch: 11 cost time: 23.50524592399597
Epoch: 11, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.863 Vali Acc: 0.640 Test Loss: 1.863 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0534536
	speed: 0.2865s/iter; left time: 9380.3102s
	iters: 200, epoch: 12 | loss: 0.0524985
	speed: 0.0768s/iter; left time: 2505.3577s
	iters: 300, epoch: 12 | loss: 0.0170061
	speed: 0.0754s/iter; left time: 2455.1709s
Epoch: 12 cost time: 28.76866841316223
Epoch: 12, Steps: 369 | Train Loss: 0.079 Vali Loss: 1.991 Vali Acc: 0.627 Test Loss: 1.991 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0083375
	speed: 0.2631s/iter; left time: 8518.7023s
	iters: 200, epoch: 13 | loss: 0.2302341
	speed: 0.0538s/iter; left time: 1735.5446s
	iters: 300, epoch: 13 | loss: 0.0261527
	speed: 0.0536s/iter; left time: 1725.0722s
Epoch: 13 cost time: 20.617591857910156
Epoch: 13, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.305 Vali Acc: 0.637 Test Loss: 2.305 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0288589
	speed: 0.2297s/iter; left time: 7352.5400s
	iters: 200, epoch: 14 | loss: 0.0124853
	speed: 0.0548s/iter; left time: 1748.8493s
	iters: 300, epoch: 14 | loss: 0.0108334
	speed: 0.0540s/iter; left time: 1718.5269s
Epoch: 14 cost time: 20.584503173828125
Epoch: 14, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.221 Vali Acc: 0.632 Test Loss: 2.221 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0002467
	speed: 0.2659s/iter; left time: 8413.2976s
	iters: 200, epoch: 15 | loss: 0.1535663
	speed: 0.0739s/iter; left time: 2331.8723s
	iters: 300, epoch: 15 | loss: 0.1789303
	speed: 0.0736s/iter; left time: 2315.1125s
Epoch: 15 cost time: 27.912181615829468
Epoch: 15, Steps: 369 | Train Loss: 0.045 Vali Loss: 2.278 Vali Acc: 0.643 Test Loss: 2.278 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6523836549375709
model parameter : 302978
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8498734
	speed: 0.0634s/iter; left time: 2331.6957s
	iters: 200, epoch: 1 | loss: 1.7899654
	speed: 0.0440s/iter; left time: 1615.8568s
	iters: 300, epoch: 1 | loss: 2.9165533
	speed: 0.0438s/iter; left time: 1602.0255s
Epoch: 1 cost time: 19.44061255455017
Epoch: 1, Steps: 369 | Train Loss: 1.314 Vali Loss: 1.431 Vali Acc: 0.623 Test Loss: 1.431 Test Acc: 0.623
Validation loss decreased (inf --> -0.622574).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9862803
	speed: 0.2488s/iter; left time: 9064.6891s
	iters: 200, epoch: 2 | loss: 0.8297892
	speed: 0.0622s/iter; left time: 2258.1201s
	iters: 300, epoch: 2 | loss: 1.4749142
	speed: 0.0627s/iter; left time: 2272.2205s
Epoch: 2 cost time: 23.704353094100952
Epoch: 2, Steps: 369 | Train Loss: 1.255 Vali Loss: 2.223 Vali Acc: 0.650 Test Loss: 2.223 Test Acc: 0.650
Validation loss decreased (-0.622574 --> -0.650091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6887169
	speed: 0.2400s/iter; left time: 8655.4832s
	iters: 200, epoch: 3 | loss: 4.0100231
	speed: 0.0436s/iter; left time: 1569.3002s
	iters: 300, epoch: 3 | loss: 1.4014015
	speed: 0.0455s/iter; left time: 1631.8696s
Epoch: 3 cost time: 17.266541242599487
Epoch: 3, Steps: 369 | Train Loss: 1.596 Vali Loss: 2.030 Vali Acc: 0.649 Test Loss: 2.030 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9300435
	speed: 0.2007s/iter; left time: 7163.7374s
	iters: 200, epoch: 4 | loss: 0.9525559
	speed: 0.0459s/iter; left time: 1634.1873s
	iters: 300, epoch: 4 | loss: 2.3404467
	speed: 0.0477s/iter; left time: 1691.5842s
Epoch: 4 cost time: 17.470561981201172
Epoch: 4, Steps: 369 | Train Loss: 1.626 Vali Loss: 2.790 Vali Acc: 0.636 Test Loss: 2.790 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8082021
	speed: 0.2217s/iter; left time: 7831.1473s
	iters: 200, epoch: 5 | loss: 2.6405454
	speed: 0.0636s/iter; left time: 2239.3716s
	iters: 300, epoch: 5 | loss: 1.5690024
	speed: 0.0617s/iter; left time: 2166.5395s
Epoch: 5 cost time: 23.905193328857422
Epoch: 5, Steps: 369 | Train Loss: 1.410 Vali Loss: 3.187 Vali Acc: 0.638 Test Loss: 3.187 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7273582
	speed: 0.2599s/iter; left time: 9084.2339s
	iters: 200, epoch: 6 | loss: 1.0528349
	speed: 0.0617s/iter; left time: 2149.0102s
	iters: 300, epoch: 6 | loss: 0.7005858
	speed: 0.0617s/iter; left time: 2144.0532s
Epoch: 6 cost time: 22.74786925315857
Epoch: 6, Steps: 369 | Train Loss: 1.037 Vali Loss: 3.274 Vali Acc: 0.611 Test Loss: 3.274 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0149952
	speed: 0.2151s/iter; left time: 7439.7485s
	iters: 200, epoch: 7 | loss: 0.6168694
	speed: 0.0440s/iter; left time: 1518.4954s
	iters: 300, epoch: 7 | loss: 0.5909528
	speed: 0.0440s/iter; left time: 1512.0419s
Epoch: 7 cost time: 16.893054008483887
Epoch: 7, Steps: 369 | Train Loss: 0.691 Vali Loss: 2.045 Vali Acc: 0.646 Test Loss: 2.045 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0400039
	speed: 0.2087s/iter; left time: 7140.2946s
	iters: 200, epoch: 8 | loss: 0.5705706
	speed: 0.0445s/iter; left time: 1518.1563s
	iters: 300, epoch: 8 | loss: 0.2798078
	speed: 0.0507s/iter; left time: 1723.1078s
Epoch: 8 cost time: 19.23262071609497
Epoch: 8, Steps: 369 | Train Loss: 0.410 Vali Loss: 1.806 Vali Acc: 0.644 Test Loss: 1.806 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3873842
	speed: 0.2633s/iter; left time: 8910.8576s
	iters: 200, epoch: 9 | loss: 0.0376877
	speed: 0.0619s/iter; left time: 2087.5741s
	iters: 300, epoch: 9 | loss: 0.3992214
	speed: 0.0633s/iter; left time: 2129.9404s
Epoch: 9 cost time: 23.959070920944214
Epoch: 9, Steps: 369 | Train Loss: 0.264 Vali Loss: 1.491 Vali Acc: 0.634 Test Loss: 1.491 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1130458
	speed: 0.2401s/iter; left time: 8039.1521s
	iters: 200, epoch: 10 | loss: 0.1078591
	speed: 0.0451s/iter; left time: 1505.2641s
	iters: 300, epoch: 10 | loss: 0.1769441
	speed: 0.0455s/iter; left time: 1515.0008s
Epoch: 10 cost time: 17.752042770385742
Epoch: 10, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.383 Vali Acc: 0.642 Test Loss: 1.383 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0494097
	speed: 0.2123s/iter; left time: 7028.1209s
	iters: 200, epoch: 11 | loss: 0.2568277
	speed: 0.0448s/iter; left time: 1480.5004s
	iters: 300, epoch: 11 | loss: 0.0389863
	speed: 0.0449s/iter; left time: 1477.7696s
Epoch: 11 cost time: 17.66849946975708
Epoch: 11, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.623 Vali Acc: 0.659 Test Loss: 1.623 Test Acc: 0.659
Validation loss decreased (-0.650091 --> -0.658610).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2253488
	speed: 0.2486s/iter; left time: 8140.3225s
	iters: 200, epoch: 12 | loss: 0.2182243
	speed: 0.0629s/iter; left time: 2054.2651s
	iters: 300, epoch: 12 | loss: 0.0371888
	speed: 0.0635s/iter; left time: 2064.9065s
Epoch: 12 cost time: 24.07752752304077
Epoch: 12, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.831 Vali Acc: 0.635 Test Loss: 1.831 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0128997
	speed: 0.2631s/iter; left time: 8517.7633s
	iters: 200, epoch: 13 | loss: 0.0067732
	speed: 0.0486s/iter; left time: 1569.6283s
	iters: 300, epoch: 13 | loss: 0.0021558
	speed: 0.0483s/iter; left time: 1552.5658s
Epoch: 13 cost time: 20.101160526275635
Epoch: 13, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.943 Vali Acc: 0.648 Test Loss: 1.943 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0671485
	speed: 0.2088s/iter; left time: 6681.1750s
	iters: 200, epoch: 14 | loss: 0.0109175
	speed: 0.0451s/iter; left time: 1437.8313s
	iters: 300, epoch: 14 | loss: 0.0365144
	speed: 0.0450s/iter; left time: 1430.1979s
Epoch: 14 cost time: 17.763285160064697
Epoch: 14, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.077 Vali Acc: 0.647 Test Loss: 2.077 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0062806
	speed: 0.2392s/iter; left time: 7566.3981s
	iters: 200, epoch: 15 | loss: 0.0121939
	speed: 0.0621s/iter; left time: 1956.8453s
	iters: 300, epoch: 15 | loss: 0.0310365
	speed: 0.0628s/iter; left time: 1973.9383s
Epoch: 15 cost time: 23.995986461639404
Epoch: 15, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.148 Vali Acc: 0.633 Test Loss: 2.148 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0568379
	speed: 0.2672s/iter; left time: 8352.8367s
	iters: 200, epoch: 16 | loss: 0.0167770
	speed: 0.0625s/iter; left time: 1948.5322s
	iters: 300, epoch: 16 | loss: 0.2869456
	speed: 0.0524s/iter; left time: 1626.7659s
Epoch: 16 cost time: 21.695225715637207
Epoch: 16, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.241 Vali Acc: 0.637 Test Loss: 2.241 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0407616
	speed: 0.2186s/iter; left time: 6754.5435s
	iters: 200, epoch: 17 | loss: 0.1383419
	speed: 0.0437s/iter; left time: 1346.9316s
	iters: 300, epoch: 17 | loss: 0.2069753
	speed: 0.0468s/iter; left time: 1437.6619s
Epoch: 17 cost time: 18.115724802017212
Epoch: 17, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.164 Vali Acc: 0.639 Test Loss: 2.164 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0003290
	speed: 0.2251s/iter; left time: 6871.4299s
	iters: 200, epoch: 18 | loss: 0.0047883
	speed: 0.0617s/iter; left time: 1877.4937s
	iters: 300, epoch: 18 | loss: 0.0062629
	speed: 0.0610s/iter; left time: 1848.8178s
Epoch: 18 cost time: 22.562541246414185
Epoch: 18, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.284 Vali Acc: 0.633 Test Loss: 2.284 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0501261
	speed: 0.2701s/iter; left time: 8147.3608s
	iters: 200, epoch: 19 | loss: 0.0036050
	speed: 0.0614s/iter; left time: 1844.4300s
	iters: 300, epoch: 19 | loss: 0.0034393
	speed: 0.0619s/iter; left time: 1853.4038s
Epoch: 19 cost time: 23.714518785476685
Epoch: 19, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.330 Vali Acc: 0.646 Test Loss: 2.330 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0002994
	speed: 0.2255s/iter; left time: 6717.0186s
	iters: 200, epoch: 20 | loss: 0.0008933
	speed: 0.0487s/iter; left time: 1444.9231s
	iters: 300, epoch: 20 | loss: 0.0884377
	speed: 0.0421s/iter; left time: 1246.9189s
Epoch: 20 cost time: 17.82583475112915
Epoch: 20, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.322 Vali Acc: 0.637 Test Loss: 2.322 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0112136
	speed: 0.2151s/iter; left time: 6329.1584s
	iters: 200, epoch: 21 | loss: 0.0009157
	speed: 0.0453s/iter; left time: 1327.2810s
	iters: 300, epoch: 21 | loss: 0.0067958
	speed: 0.0646s/iter; left time: 1888.4998s
Epoch: 21 cost time: 20.96911859512329
Epoch: 21, Steps: 369 | Train Loss: 0.039 Vali Loss: 2.395 Vali Acc: 0.643 Test Loss: 2.395 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6586265607264472
model parameter : 210850
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9477465
	speed: 0.0553s/iter; left time: 2036.6344s
	iters: 200, epoch: 1 | loss: 0.7443748
	speed: 0.0328s/iter; left time: 1202.3140s
	iters: 300, epoch: 1 | loss: 1.4714464
	speed: 0.0337s/iter; left time: 1233.9890s
Epoch: 1 cost time: 14.751953601837158
Epoch: 1, Steps: 369 | Train Loss: 1.037 Vali Loss: 1.191 Vali Acc: 0.607 Test Loss: 1.191 Test Acc: 0.607
Validation loss decreased (inf --> -0.607253).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9731646
	speed: 0.1782s/iter; left time: 6492.8335s
	iters: 200, epoch: 2 | loss: 0.6173242
	speed: 0.0502s/iter; left time: 1823.6464s
	iters: 300, epoch: 2 | loss: 0.9956272
	speed: 0.0499s/iter; left time: 1807.4681s
Epoch: 2 cost time: 18.608506679534912
Epoch: 2, Steps: 369 | Train Loss: 1.103 Vali Loss: 1.959 Vali Acc: 0.631 Test Loss: 1.959 Test Acc: 0.631
Validation loss decreased (-0.607253 --> -0.630798).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5380714
	speed: 0.2130s/iter; left time: 7679.9797s
	iters: 200, epoch: 3 | loss: 0.5055610
	speed: 0.0504s/iter; left time: 1812.8148s
	iters: 300, epoch: 3 | loss: 0.2604331
	speed: 0.0500s/iter; left time: 1793.2703s
Epoch: 3 cost time: 19.50174880027771
Epoch: 3, Steps: 369 | Train Loss: 1.295 Vali Loss: 1.635 Vali Acc: 0.653 Test Loss: 1.635 Test Acc: 0.653
Validation loss decreased (-0.630798 --> -0.653219).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4684365
	speed: 0.1812s/iter; left time: 6468.1781s
	iters: 200, epoch: 4 | loss: 0.8132296
	speed: 0.0335s/iter; left time: 1191.4840s
	iters: 300, epoch: 4 | loss: 1.5486066
	speed: 0.0343s/iter; left time: 1218.2242s
Epoch: 4 cost time: 13.113315343856812
Epoch: 4, Steps: 369 | Train Loss: 1.232 Vali Loss: 2.339 Vali Acc: 0.646 Test Loss: 2.339 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2139020
	speed: 0.1589s/iter; left time: 5611.9571s
	iters: 200, epoch: 5 | loss: 1.6558995
	speed: 0.0334s/iter; left time: 1176.6782s
	iters: 300, epoch: 5 | loss: 1.0849392
	speed: 0.0337s/iter; left time: 1184.4148s
Epoch: 5 cost time: 12.86042070388794
Epoch: 5, Steps: 369 | Train Loss: 1.136 Vali Loss: 2.594 Vali Acc: 0.636 Test Loss: 2.594 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9296066
	speed: 0.1610s/iter; left time: 5627.3465s
	iters: 200, epoch: 6 | loss: 1.1270055
	speed: 0.0488s/iter; left time: 1700.4177s
	iters: 300, epoch: 6 | loss: 1.4622751
	speed: 0.0495s/iter; left time: 1721.3476s
Epoch: 6 cost time: 16.75005316734314
Epoch: 6, Steps: 369 | Train Loss: 0.928 Vali Loss: 2.349 Vali Acc: 0.646 Test Loss: 2.349 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7631012
	speed: 0.2171s/iter; left time: 7507.9061s
	iters: 200, epoch: 7 | loss: 0.3583824
	speed: 0.0478s/iter; left time: 1647.6017s
	iters: 300, epoch: 7 | loss: 0.7825831
	speed: 0.0489s/iter; left time: 1680.7137s
Epoch: 7 cost time: 18.924166440963745
Epoch: 7, Steps: 369 | Train Loss: 0.680 Vali Loss: 2.382 Vali Acc: 0.638 Test Loss: 2.382 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0233998
	speed: 0.1900s/iter; left time: 6501.9597s
	iters: 200, epoch: 8 | loss: 0.5899826
	speed: 0.0357s/iter; left time: 1218.2114s
	iters: 300, epoch: 8 | loss: 0.0281110
	speed: 0.0338s/iter; left time: 1149.3342s
Epoch: 8 cost time: 13.438459157943726
Epoch: 8, Steps: 369 | Train Loss: 0.473 Vali Loss: 2.059 Vali Acc: 0.650 Test Loss: 2.059 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2937716
	speed: 0.1627s/iter; left time: 5508.0317s
	iters: 200, epoch: 9 | loss: 0.6093968
	speed: 0.0344s/iter; left time: 1162.0869s
	iters: 300, epoch: 9 | loss: 0.4715315
	speed: 0.0369s/iter; left time: 1241.3125s
Epoch: 9 cost time: 13.67629623413086
Epoch: 9, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.694 Vali Acc: 0.639 Test Loss: 1.694 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5548488
	speed: 0.1675s/iter; left time: 5606.3903s
	iters: 200, epoch: 10 | loss: 0.4108232
	speed: 0.0502s/iter; left time: 1676.3411s
	iters: 300, epoch: 10 | loss: 0.1696148
	speed: 0.0505s/iter; left time: 1679.3527s
Epoch: 10 cost time: 18.103520393371582
Epoch: 10, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.580 Vali Acc: 0.644 Test Loss: 1.580 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0300390
	speed: 0.2184s/iter; left time: 7231.1247s
	iters: 200, epoch: 11 | loss: 0.2537718
	speed: 0.0495s/iter; left time: 1634.3416s
	iters: 300, epoch: 11 | loss: 0.0643029
	speed: 0.0488s/iter; left time: 1607.2199s
Epoch: 11 cost time: 19.25746989250183
Epoch: 11, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.676 Vali Acc: 0.648 Test Loss: 1.676 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0388066
	speed: 0.1935s/iter; left time: 6335.0777s
	iters: 200, epoch: 12 | loss: 0.0442413
	speed: 0.0334s/iter; left time: 1089.9856s
	iters: 300, epoch: 12 | loss: 0.0319187
	speed: 0.0332s/iter; left time: 1079.3064s
Epoch: 12 cost time: 13.086400985717773
Epoch: 12, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.855 Vali Acc: 0.645 Test Loss: 1.855 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2404655
	speed: 0.1632s/iter; left time: 5283.2084s
	iters: 200, epoch: 13 | loss: 0.0678885
	speed: 0.0355s/iter; left time: 1147.0736s
	iters: 300, epoch: 13 | loss: 0.0938028
	speed: 0.0346s/iter; left time: 1114.4133s
Epoch: 13 cost time: 13.99193787574768
Epoch: 13, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.896 Vali Acc: 0.648 Test Loss: 1.896 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6532349602724177
model parameter : 155618
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.1480379
	speed: 0.0479s/iter; left time: 1762.4483s
	iters: 200, epoch: 1 | loss: 1.1791661
	speed: 0.0274s/iter; left time: 1007.1663s
	iters: 300, epoch: 1 | loss: 1.6721663
	speed: 0.0274s/iter; left time: 1002.8158s
Epoch: 1 cost time: 12.24719762802124
Epoch: 1, Steps: 369 | Train Loss: 0.978 Vali Loss: 1.288 Vali Acc: 0.633 Test Loss: 1.288 Test Acc: 0.633
Validation loss decreased (inf --> -0.632791).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8687026
	speed: 0.1432s/iter; left time: 5216.2990s
	iters: 200, epoch: 2 | loss: 1.3061248
	speed: 0.0254s/iter; left time: 923.6917s
	iters: 300, epoch: 2 | loss: 0.7268832
	speed: 0.0251s/iter; left time: 908.2993s
Epoch: 2 cost time: 9.863008737564087
Epoch: 2, Steps: 369 | Train Loss: 1.015 Vali Loss: 1.505 Vali Acc: 0.644 Test Loss: 1.505 Test Acc: 0.644
Validation loss decreased (-0.632791 --> -0.644423).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2975856
	speed: 0.1351s/iter; left time: 4871.8920s
	iters: 200, epoch: 3 | loss: 1.0021613
	speed: 0.0268s/iter; left time: 964.4872s
	iters: 300, epoch: 3 | loss: 0.1820290
	speed: 0.0271s/iter; left time: 972.0293s
Epoch: 3 cost time: 10.942811727523804
Epoch: 3, Steps: 369 | Train Loss: 1.152 Vali Loss: 1.915 Vali Acc: 0.642 Test Loss: 1.915 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3400072
	speed: 0.1604s/iter; left time: 5726.9725s
	iters: 200, epoch: 4 | loss: 2.0124824
	speed: 0.0453s/iter; left time: 1611.7692s
	iters: 300, epoch: 4 | loss: 0.8310304
	speed: 0.0445s/iter; left time: 1577.9506s
Epoch: 4 cost time: 17.3210186958313
Epoch: 4, Steps: 369 | Train Loss: 1.204 Vali Loss: 2.446 Vali Acc: 0.620 Test Loss: 2.446 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5010598
	speed: 0.1727s/iter; left time: 6101.6126s
	iters: 200, epoch: 5 | loss: 0.3371107
	speed: 0.0421s/iter; left time: 1484.1087s
	iters: 300, epoch: 5 | loss: 0.9986473
	speed: 0.0437s/iter; left time: 1534.9689s
Epoch: 5 cost time: 16.247433185577393
Epoch: 5, Steps: 369 | Train Loss: 0.987 Vali Loss: 2.696 Vali Acc: 0.626 Test Loss: 2.696 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2794881
	speed: 0.1606s/iter; left time: 5613.0478s
	iters: 200, epoch: 6 | loss: 1.0941041
	speed: 0.0272s/iter; left time: 949.1302s
	iters: 300, epoch: 6 | loss: 0.3381365
	speed: 0.0266s/iter; left time: 925.7925s
Epoch: 6 cost time: 10.646369934082031
Epoch: 6, Steps: 369 | Train Loss: 0.807 Vali Loss: 2.429 Vali Acc: 0.656 Test Loss: 2.429 Test Acc: 0.656
Validation loss decreased (-0.644423 --> -0.655765).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6020298
	speed: 0.1476s/iter; left time: 5105.8445s
	iters: 200, epoch: 7 | loss: 0.3279422
	speed: 0.0235s/iter; left time: 811.1835s
	iters: 300, epoch: 7 | loss: 1.5306448
	speed: 0.0266s/iter; left time: 915.5554s
Epoch: 7 cost time: 10.18819522857666
Epoch: 7, Steps: 369 | Train Loss: 0.588 Vali Loss: 1.974 Vali Acc: 0.659 Test Loss: 1.974 Test Acc: 0.659
Validation loss decreased (-0.655765 --> -0.659174).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1176998
	speed: 0.1354s/iter; left time: 4632.0852s
	iters: 200, epoch: 8 | loss: 0.4196662
	speed: 0.0276s/iter; left time: 940.0246s
	iters: 300, epoch: 8 | loss: 1.1223999
	speed: 0.0262s/iter; left time: 891.7568s
Epoch: 8 cost time: 10.65620732307434
Epoch: 8, Steps: 369 | Train Loss: 0.446 Vali Loss: 1.954 Vali Acc: 0.640 Test Loss: 1.954 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1082554
	speed: 0.1529s/iter; left time: 5176.1829s
	iters: 200, epoch: 9 | loss: 0.5856978
	speed: 0.0430s/iter; left time: 1449.8389s
	iters: 300, epoch: 9 | loss: 0.1641783
	speed: 0.0456s/iter; left time: 1533.7600s
Epoch: 9 cost time: 16.741896152496338
Epoch: 9, Steps: 369 | Train Loss: 0.308 Vali Loss: 1.602 Vali Acc: 0.653 Test Loss: 1.602 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2469160
	speed: 0.1735s/iter; left time: 5810.2382s
	iters: 200, epoch: 10 | loss: 0.8549155
	speed: 0.0448s/iter; left time: 1494.0539s
	iters: 300, epoch: 10 | loss: 0.0487756
	speed: 0.0435s/iter; left time: 1449.0786s
Epoch: 10 cost time: 16.941901683807373
Epoch: 10, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.577 Vali Acc: 0.655 Test Loss: 1.577 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2284128
	speed: 0.1465s/iter; left time: 4851.5812s
	iters: 200, epoch: 11 | loss: 0.1206142
	speed: 0.0270s/iter; left time: 891.0836s
	iters: 300, epoch: 11 | loss: 0.1153357
	speed: 0.0291s/iter; left time: 956.1991s
Epoch: 11 cost time: 11.15137243270874
Epoch: 11, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.632 Vali Acc: 0.649 Test Loss: 1.632 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0534391
	speed: 0.1414s/iter; left time: 4629.5154s
	iters: 200, epoch: 12 | loss: 0.0547722
	speed: 0.0298s/iter; left time: 971.7645s
	iters: 300, epoch: 12 | loss: 0.1875782
	speed: 0.0296s/iter; left time: 962.1725s
Epoch: 12 cost time: 11.030220031738281
Epoch: 12, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.700 Vali Acc: 0.650 Test Loss: 1.700 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0138308
	speed: 0.1352s/iter; left time: 4377.5672s
	iters: 200, epoch: 13 | loss: 0.0402960
	speed: 0.0250s/iter; left time: 808.4109s
	iters: 300, epoch: 13 | loss: 0.0718998
	speed: 0.0422s/iter; left time: 1356.2102s
Epoch: 13 cost time: 13.265746593475342
Epoch: 13, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.810 Vali Acc: 0.650 Test Loss: 1.810 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0160589
	speed: 0.1716s/iter; left time: 5491.2379s
	iters: 200, epoch: 14 | loss: 0.0145869
	speed: 0.0440s/iter; left time: 1402.3160s
	iters: 300, epoch: 14 | loss: 0.0158018
	speed: 0.0423s/iter; left time: 1346.1967s
Epoch: 14 cost time: 16.525899648666382
Epoch: 14, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.924 Vali Acc: 0.650 Test Loss: 1.924 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0735255
	speed: 0.1835s/iter; left time: 5805.5205s
	iters: 200, epoch: 15 | loss: 0.1343061
	speed: 0.0377s/iter; left time: 1189.8369s
	iters: 300, epoch: 15 | loss: 0.0255421
	speed: 0.0278s/iter; left time: 873.6807s
Epoch: 15 cost time: 13.704954147338867
Epoch: 15, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.910 Vali Acc: 0.646 Test Loss: 1.910 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0193313
	speed: 0.1385s/iter; left time: 4331.2547s
	iters: 200, epoch: 16 | loss: 0.1087390
	speed: 0.0281s/iter; left time: 874.5660s
	iters: 300, epoch: 16 | loss: 0.0837703
	speed: 0.0258s/iter; left time: 800.6166s
Epoch: 16 cost time: 11.04123044013977
Epoch: 16, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.032 Vali Acc: 0.655 Test Loss: 2.032 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0125886
	speed: 0.1306s/iter; left time: 4034.9147s
	iters: 200, epoch: 17 | loss: 0.0319193
	speed: 0.0292s/iter; left time: 898.1828s
	iters: 300, epoch: 17 | loss: 0.1822293
	speed: 0.0280s/iter; left time: 859.3661s
Epoch: 17 cost time: 11.221968412399292
Epoch: 17, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.151 Vali Acc: 0.650 Test Loss: 2.151 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6591940976163451
model parameter : 128066
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7594807
	speed: 0.0480s/iter; left time: 1766.0617s
	iters: 200, epoch: 1 | loss: 1.2728117
	speed: 0.0245s/iter; left time: 898.4034s
	iters: 300, epoch: 1 | loss: 0.6282564
	speed: 0.0248s/iter; left time: 905.9839s
Epoch: 1 cost time: 11.669583082199097
Epoch: 1, Steps: 369 | Train Loss: 0.863 Vali Loss: 1.467 Vali Acc: 0.610 Test Loss: 1.467 Test Acc: 0.610
Validation loss decreased (inf --> -0.609804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7715735
	speed: 0.1467s/iter; left time: 5345.7039s
	iters: 200, epoch: 2 | loss: 0.1819994
	speed: 0.0258s/iter; left time: 938.5759s
	iters: 300, epoch: 2 | loss: 0.5624620
	speed: 0.0251s/iter; left time: 908.0622s
Epoch: 2 cost time: 10.139121294021606
Epoch: 2, Steps: 369 | Train Loss: 0.985 Vali Loss: 1.349 Vali Acc: 0.655 Test Loss: 1.349 Test Acc: 0.655
Validation loss decreased (-0.609804 --> -0.654924).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9797196
	speed: 0.1378s/iter; left time: 4967.7862s
	iters: 200, epoch: 3 | loss: 1.3494912
	speed: 0.0261s/iter; left time: 938.1406s
	iters: 300, epoch: 3 | loss: 0.1681758
	speed: 0.0251s/iter; left time: 901.1956s
Epoch: 3 cost time: 10.130205869674683
Epoch: 3, Steps: 369 | Train Loss: 0.980 Vali Loss: 1.673 Vali Acc: 0.649 Test Loss: 1.673 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2687844
	speed: 0.1159s/iter; left time: 4136.8413s
	iters: 200, epoch: 4 | loss: 2.2225869
	speed: 0.0309s/iter; left time: 1101.1773s
	iters: 300, epoch: 4 | loss: 1.1003858
	speed: 0.0331s/iter; left time: 1173.9808s
Epoch: 4 cost time: 10.992653131484985
Epoch: 4, Steps: 369 | Train Loss: 0.937 Vali Loss: 2.185 Vali Acc: 0.657 Test Loss: 2.185 Test Acc: 0.657
Validation loss decreased (-0.654924 --> -0.656618).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4900874
	speed: 0.1200s/iter; left time: 4237.7622s
	iters: 200, epoch: 5 | loss: 0.2693840
	speed: 0.0190s/iter; left time: 670.0995s
	iters: 300, epoch: 5 | loss: 0.6687966
	speed: 0.0190s/iter; left time: 668.4645s
Epoch: 5 cost time: 7.98140025138855
Epoch: 5, Steps: 369 | Train Loss: 0.832 Vali Loss: 2.332 Vali Acc: 0.644 Test Loss: 2.332 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4849364
	speed: 0.0954s/iter; left time: 3334.1780s
	iters: 200, epoch: 6 | loss: 0.1618982
	speed: 0.0184s/iter; left time: 639.8903s
	iters: 300, epoch: 6 | loss: 1.2334828
	speed: 0.0177s/iter; left time: 614.0428s
Epoch: 6 cost time: 7.360769033432007
Epoch: 6, Steps: 369 | Train Loss: 0.700 Vali Loss: 2.363 Vali Acc: 0.641 Test Loss: 2.363 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4136250
	speed: 0.0997s/iter; left time: 3449.4641s
	iters: 200, epoch: 7 | loss: 1.1457820
	speed: 0.0193s/iter; left time: 666.7741s
	iters: 300, epoch: 7 | loss: 0.3472886
	speed: 0.0189s/iter; left time: 649.2694s
Epoch: 7 cost time: 7.713804006576538
Epoch: 7, Steps: 369 | Train Loss: 0.552 Vali Loss: 2.214 Vali Acc: 0.642 Test Loss: 2.214 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2032395
	speed: 0.1498s/iter; left time: 5126.3528s
	iters: 200, epoch: 8 | loss: 0.5222596
	speed: 0.0361s/iter; left time: 1233.0090s
	iters: 300, epoch: 8 | loss: 0.1359250
	speed: 0.0374s/iter; left time: 1273.1986s
Epoch: 8 cost time: 14.39396333694458
Epoch: 8, Steps: 369 | Train Loss: 0.410 Vali Loss: 1.907 Vali Acc: 0.656 Test Loss: 1.907 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0129964
	speed: 0.1659s/iter; left time: 5614.2477s
	iters: 200, epoch: 9 | loss: 0.1654330
	speed: 0.0361s/iter; left time: 1217.5971s
	iters: 300, epoch: 9 | loss: 0.6309487
	speed: 0.0377s/iter; left time: 1269.5545s
Epoch: 9 cost time: 14.267600536346436
Epoch: 9, Steps: 369 | Train Loss: 0.303 Vali Loss: 2.023 Vali Acc: 0.640 Test Loss: 2.023 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2000497
	speed: 0.1393s/iter; left time: 4664.0855s
	iters: 200, epoch: 10 | loss: 0.2769371
	speed: 0.0247s/iter; left time: 825.9784s
	iters: 300, epoch: 10 | loss: 0.0844962
	speed: 0.0256s/iter; left time: 851.1712s
Epoch: 10 cost time: 9.978322267532349
Epoch: 10, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.907 Vali Acc: 0.652 Test Loss: 1.907 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0218414
	speed: 0.1358s/iter; left time: 4494.9036s
	iters: 200, epoch: 11 | loss: 0.5608148
	speed: 0.0255s/iter; left time: 840.3317s
	iters: 300, epoch: 11 | loss: 0.1952335
	speed: 0.0249s/iter; left time: 818.4708s
Epoch: 11 cost time: 9.998236179351807
Epoch: 11, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.901 Vali Acc: 0.646 Test Loss: 1.901 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0621624
	speed: 0.1364s/iter; left time: 4465.8207s
	iters: 200, epoch: 12 | loss: 0.3046303
	speed: 0.0391s/iter; left time: 1277.3052s
	iters: 300, epoch: 12 | loss: 0.0642626
	speed: 0.0384s/iter; left time: 1248.4417s
Epoch: 12 cost time: 14.077449083328247
Epoch: 12, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.798 Vali Acc: 0.637 Test Loss: 1.798 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1848345
	speed: 0.1608s/iter; left time: 5204.0508s
	iters: 200, epoch: 13 | loss: 0.0032234
	speed: 0.0391s/iter; left time: 1261.6688s
	iters: 300, epoch: 13 | loss: 0.2736742
	speed: 0.0395s/iter; left time: 1272.0263s
Epoch: 13 cost time: 15.11481237411499
Epoch: 13, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.822 Vali Acc: 0.644 Test Loss: 1.822 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1524363
	speed: 0.1516s/iter; left time: 4851.3250s
	iters: 200, epoch: 14 | loss: 0.0666414
	speed: 0.0244s/iter; left time: 778.1886s
	iters: 300, epoch: 14 | loss: 0.0818278
	speed: 0.0245s/iter; left time: 778.5099s
Epoch: 14 cost time: 10.10097050666809
Epoch: 14, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.797 Vali Acc: 0.660 Test Loss: 1.797 Test Acc: 0.660
Validation loss decreased (-0.656618 --> -0.659744).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1096855
	speed: 0.1358s/iter; left time: 4294.5075s
	iters: 200, epoch: 15 | loss: 0.0584251
	speed: 0.0245s/iter; left time: 771.5848s
	iters: 300, epoch: 15 | loss: 0.0922422
	speed: 0.0244s/iter; left time: 767.3693s
Epoch: 15 cost time: 9.507509231567383
Epoch: 15, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.876 Vali Acc: 0.657 Test Loss: 1.876 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4818732
	speed: 0.1316s/iter; left time: 4116.0158s
	iters: 200, epoch: 16 | loss: 0.1004214
	speed: 0.0230s/iter; left time: 717.3936s
	iters: 300, epoch: 16 | loss: 0.0219102
	speed: 0.0239s/iter; left time: 742.9996s
Epoch: 16 cost time: 9.45971965789795
Epoch: 16, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.026 Vali Acc: 0.636 Test Loss: 2.026 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0041639
	speed: 0.1477s/iter; left time: 4563.7155s
	iters: 200, epoch: 17 | loss: 0.0137843
	speed: 0.0354s/iter; left time: 1091.3433s
	iters: 300, epoch: 17 | loss: 0.3017118
	speed: 0.0354s/iter; left time: 1085.2631s
Epoch: 17 cost time: 13.760044813156128
Epoch: 17, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.021 Vali Acc: 0.639 Test Loss: 2.021 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0919563
	speed: 0.1565s/iter; left time: 4777.3279s
	iters: 200, epoch: 18 | loss: 0.1692059
	speed: 0.0381s/iter; left time: 1160.5547s
	iters: 300, epoch: 18 | loss: 0.0204564
	speed: 0.0371s/iter; left time: 1126.3737s
Epoch: 18 cost time: 14.719509840011597
Epoch: 18, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.994 Vali Acc: 0.647 Test Loss: 1.994 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0024884
	speed: 0.1458s/iter; left time: 4396.8534s
	iters: 200, epoch: 19 | loss: 0.6718699
	speed: 0.0245s/iter; left time: 735.2309s
	iters: 300, epoch: 19 | loss: 0.0013180
	speed: 0.0246s/iter; left time: 737.1408s
Epoch: 19 cost time: 9.787852764129639
Epoch: 19, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.011 Vali Acc: 0.641 Test Loss: 2.011 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0211783
	speed: 0.1291s/iter; left time: 3846.1482s
	iters: 200, epoch: 20 | loss: 0.0053698
	speed: 0.0232s/iter; left time: 690.0030s
	iters: 300, epoch: 20 | loss: 0.0697573
	speed: 0.0222s/iter; left time: 655.9350s
Epoch: 20 cost time: 9.439222574234009
Epoch: 20, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.145 Vali Acc: 0.647 Test Loss: 2.145 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2116632
	speed: 0.1354s/iter; left time: 3983.0328s
	iters: 200, epoch: 21 | loss: 0.0182576
	speed: 0.0237s/iter; left time: 694.0275s
	iters: 300, epoch: 21 | loss: 0.0880246
	speed: 0.0239s/iter; left time: 697.0527s
Epoch: 21 cost time: 9.56593632698059
Epoch: 21, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.228 Vali Acc: 0.640 Test Loss: 2.228 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0493309
	speed: 0.1487s/iter; left time: 4319.1629s
	iters: 200, epoch: 22 | loss: 0.0031547
	speed: 0.0349s/iter; left time: 1009.2881s
	iters: 300, epoch: 22 | loss: 0.2067182
	speed: 0.0367s/iter; left time: 1059.4612s
Epoch: 22 cost time: 13.990652322769165
Epoch: 22, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.244 Vali Acc: 0.640 Test Loss: 2.244 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0338085
	speed: 0.1556s/iter; left time: 4463.5859s
	iters: 200, epoch: 23 | loss: 0.0981213
	speed: 0.0375s/iter; left time: 1072.6170s
	iters: 300, epoch: 23 | loss: 0.0121134
	speed: 0.0377s/iter; left time: 1075.2290s
Epoch: 23 cost time: 14.389394044876099
Epoch: 23, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.433 Vali Acc: 0.637 Test Loss: 2.433 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0011457
	speed: 0.1449s/iter; left time: 4104.0804s
	iters: 200, epoch: 24 | loss: 0.0074720
	speed: 0.0257s/iter; left time: 724.2423s
	iters: 300, epoch: 24 | loss: 0.1753249
	speed: 0.0279s/iter; left time: 784.5968s
Epoch: 24 cost time: 10.484962224960327
Epoch: 24, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.280 Vali Acc: 0.647 Test Loss: 2.280 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6597616345062429
model parameter : 100514
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2516118
	speed: 0.0510s/iter; left time: 1875.8555s
	iters: 200, epoch: 1 | loss: 1.0428529
	speed: 0.0303s/iter; left time: 1112.0154s
	iters: 300, epoch: 1 | loss: 0.8939210
	speed: 0.0306s/iter; left time: 1119.6331s
Epoch: 1 cost time: 13.423539161682129
Epoch: 1, Steps: 369 | Train Loss: 0.792 Vali Loss: 1.155 Vali Acc: 0.659 Test Loss: 1.155 Test Acc: 0.659
Validation loss decreased (inf --> -0.658899).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4049978
	speed: 0.1399s/iter; left time: 5097.0009s
	iters: 200, epoch: 2 | loss: 0.5486041
	speed: 0.0316s/iter; left time: 1149.6858s
	iters: 300, epoch: 2 | loss: 0.6890548
	speed: 0.0312s/iter; left time: 1130.7896s
Epoch: 2 cost time: 12.293151378631592
Epoch: 2, Steps: 369 | Train Loss: 0.845 Vali Loss: 1.621 Vali Acc: 0.634 Test Loss: 1.621 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4902180
	speed: 0.1350s/iter; left time: 4869.7010s
	iters: 200, epoch: 3 | loss: 0.5203566
	speed: 0.0199s/iter; left time: 714.2636s
	iters: 300, epoch: 3 | loss: 1.4001565
	speed: 0.0208s/iter; left time: 745.2102s
Epoch: 3 cost time: 9.014654397964478
Epoch: 3, Steps: 369 | Train Loss: 0.812 Vali Loss: 1.893 Vali Acc: 0.647 Test Loss: 1.893 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2174601
	speed: 0.1166s/iter; left time: 4162.3984s
	iters: 200, epoch: 4 | loss: 1.1119335
	speed: 0.0208s/iter; left time: 740.6818s
	iters: 300, epoch: 4 | loss: 0.7345969
	speed: 0.0206s/iter; left time: 732.1693s
Epoch: 4 cost time: 8.283303499221802
Epoch: 4, Steps: 369 | Train Loss: 0.825 Vali Loss: 1.915 Vali Acc: 0.653 Test Loss: 1.915 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0523742
	speed: 0.1223s/iter; left time: 4319.8536s
	iters: 200, epoch: 5 | loss: 0.8136038
	speed: 0.0208s/iter; left time: 731.7363s
	iters: 300, epoch: 5 | loss: 0.8818745
	speed: 0.0198s/iter; left time: 697.0868s
Epoch: 5 cost time: 8.251030683517456
Epoch: 5, Steps: 369 | Train Loss: 0.740 Vali Loss: 2.233 Vali Acc: 0.635 Test Loss: 2.233 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4374143
	speed: 0.1230s/iter; left time: 4299.3675s
	iters: 200, epoch: 6 | loss: 0.0351884
	speed: 0.0258s/iter; left time: 900.5668s
	iters: 300, epoch: 6 | loss: 0.7399015
	speed: 0.0321s/iter; left time: 1116.1933s
Epoch: 6 cost time: 10.864113807678223
Epoch: 6, Steps: 369 | Train Loss: 0.579 Vali Loss: 2.312 Vali Acc: 0.630 Test Loss: 2.312 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1771603
	speed: 0.1491s/iter; left time: 5156.2896s
	iters: 200, epoch: 7 | loss: 0.2012309
	speed: 0.0323s/iter; left time: 1114.4462s
	iters: 300, epoch: 7 | loss: 1.5678998
	speed: 0.0326s/iter; left time: 1121.1450s
Epoch: 7 cost time: 12.694293975830078
Epoch: 7, Steps: 369 | Train Loss: 0.521 Vali Loss: 2.254 Vali Acc: 0.652 Test Loss: 2.254 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3848726
	speed: 0.1446s/iter; left time: 4949.4626s
	iters: 200, epoch: 8 | loss: 0.7417529
	speed: 0.0310s/iter; left time: 1056.3286s
	iters: 300, epoch: 8 | loss: 0.2711231
	speed: 0.0281s/iter; left time: 956.9528s
Epoch: 8 cost time: 11.541832208633423
Epoch: 8, Steps: 369 | Train Loss: 0.434 Vali Loss: 2.109 Vali Acc: 0.646 Test Loss: 2.109 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4822118
	speed: 0.1354s/iter; left time: 4584.1071s
	iters: 200, epoch: 9 | loss: 0.1819668
	speed: 0.0209s/iter; left time: 704.0382s
	iters: 300, epoch: 9 | loss: 0.2100644
	speed: 0.0216s/iter; left time: 725.1949s
Epoch: 9 cost time: 8.833751201629639
Epoch: 9, Steps: 369 | Train Loss: 0.369 Vali Loss: 1.915 Vali Acc: 0.654 Test Loss: 1.915 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.2444825
	speed: 0.1295s/iter; left time: 4334.8431s
	iters: 200, epoch: 10 | loss: 0.3432498
	speed: 0.0226s/iter; left time: 753.6872s
	iters: 300, epoch: 10 | loss: 0.6111303
	speed: 0.0233s/iter; left time: 774.3622s
Epoch: 10 cost time: 9.327864170074463
Epoch: 10, Steps: 369 | Train Loss: 0.293 Vali Loss: 1.844 Vali Acc: 0.646 Test Loss: 1.844 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.3706300
	speed: 0.1426s/iter; left time: 4720.5940s
	iters: 200, epoch: 11 | loss: 0.1881187
	speed: 0.0223s/iter; left time: 737.0033s
	iters: 300, epoch: 11 | loss: 0.0337326
	speed: 0.0246s/iter; left time: 809.0255s
Epoch: 11 cost time: 9.899286031723022
Epoch: 11, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.827 Vali Acc: 0.642 Test Loss: 1.827 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6589103291713961
model parameter : 82178
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5180047
	speed: 0.1382s/iter; left time: 5085.0223s
	iters: 200, epoch: 1 | loss: 2.1668532
	speed: 0.1169s/iter; left time: 4291.4182s
	iters: 300, epoch: 1 | loss: 0.8103441
	speed: 0.1182s/iter; left time: 4326.2118s
Epoch: 1 cost time: 45.396618127822876
Epoch: 1, Steps: 369 | Train Loss: 1.505 Vali Loss: 3.099 Vali Acc: 0.558 Test Loss: 3.099 Test Acc: 0.558
Validation loss decreased (inf --> -0.557858).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2271831
	speed: 0.4428s/iter; left time: 16132.9560s
	iters: 200, epoch: 2 | loss: 2.3521798
	speed: 0.1456s/iter; left time: 5290.8747s
	iters: 300, epoch: 2 | loss: 2.9898360
	speed: 0.1440s/iter; left time: 5216.5621s
Epoch: 2 cost time: 54.406917572021484
Epoch: 2, Steps: 369 | Train Loss: 1.655 Vali Loss: 2.150 Vali Acc: 0.642 Test Loss: 2.150 Test Acc: 0.642
Validation loss decreased (-0.557858 --> -0.642146).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0067606
	speed: 0.4273s/iter; left time: 15410.0852s
	iters: 200, epoch: 3 | loss: 0.9690419
	speed: 0.1197s/iter; left time: 4303.5077s
	iters: 300, epoch: 3 | loss: 0.1323143
	speed: 0.1193s/iter; left time: 4277.0898s
Epoch: 3 cost time: 45.082858085632324
Epoch: 3, Steps: 369 | Train Loss: 1.689 Vali Loss: 2.373 Vali Acc: 0.637 Test Loss: 2.373 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3701871
	speed: 0.4545s/iter; left time: 16224.6916s
	iters: 200, epoch: 4 | loss: 1.5115625
	speed: 0.1478s/iter; left time: 5259.3602s
	iters: 300, epoch: 4 | loss: 1.8832916
	speed: 0.1489s/iter; left time: 5285.7128s
Epoch: 4 cost time: 55.70517826080322
Epoch: 4, Steps: 369 | Train Loss: 1.355 Vali Loss: 3.077 Vali Acc: 0.636 Test Loss: 3.077 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0024941
	speed: 0.4278s/iter; left time: 15110.4246s
	iters: 200, epoch: 5 | loss: 1.0404779
	speed: 0.1216s/iter; left time: 4283.2697s
	iters: 300, epoch: 5 | loss: 1.2331653
	speed: 0.1224s/iter; left time: 4300.7140s
Epoch: 5 cost time: 45.411536693573
Epoch: 5, Steps: 369 | Train Loss: 0.926 Vali Loss: 2.835 Vali Acc: 0.626 Test Loss: 2.835 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5124566
	speed: 0.4579s/iter; left time: 16006.4751s
	iters: 200, epoch: 6 | loss: 0.0685797
	speed: 0.1457s/iter; left time: 5076.8366s
	iters: 300, epoch: 6 | loss: 0.2597059
	speed: 0.1456s/iter; left time: 5059.3271s
Epoch: 6 cost time: 53.74791216850281
Epoch: 6, Steps: 369 | Train Loss: 0.470 Vali Loss: 2.086 Vali Acc: 0.645 Test Loss: 2.086 Test Acc: 0.645
Validation loss decreased (-0.642146 --> -0.644985).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0081317
	speed: 0.4088s/iter; left time: 14139.4843s
	iters: 200, epoch: 7 | loss: 0.5897810
	speed: 0.1157s/iter; left time: 3991.4309s
	iters: 300, epoch: 7 | loss: 0.6209066
	speed: 0.1161s/iter; left time: 3993.7216s
Epoch: 7 cost time: 43.279696226119995
Epoch: 7, Steps: 369 | Train Loss: 0.255 Vali Loss: 1.997 Vali Acc: 0.624 Test Loss: 1.997 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1794366
	speed: 0.4643s/iter; left time: 15885.9247s
	iters: 200, epoch: 8 | loss: 0.0015437
	speed: 0.1507s/iter; left time: 5141.0380s
	iters: 300, epoch: 8 | loss: 0.1163576
	speed: 0.1512s/iter; left time: 5142.0079s
Epoch: 8 cost time: 55.86268138885498
Epoch: 8, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.949 Vali Acc: 0.646 Test Loss: 1.949 Test Acc: 0.646
Validation loss decreased (-0.644985 --> -0.646405).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1218824
	speed: 0.4211s/iter; left time: 14252.3856s
	iters: 200, epoch: 9 | loss: 0.2334101
	speed: 0.1242s/iter; left time: 4189.9716s
	iters: 300, epoch: 9 | loss: 0.0039230
	speed: 0.1270s/iter; left time: 4271.8508s
Epoch: 9 cost time: 48.70501756668091
Epoch: 9, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.932 Vali Acc: 0.630 Test Loss: 1.932 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0519214
	speed: 0.4911s/iter; left time: 16441.5546s
	iters: 200, epoch: 10 | loss: 0.0118306
	speed: 0.1499s/iter; left time: 5003.3803s
	iters: 300, epoch: 10 | loss: 0.0172066
	speed: 0.1237s/iter; left time: 4116.4213s
Epoch: 10 cost time: 51.41198420524597
Epoch: 10, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.918 Vali Acc: 0.636 Test Loss: 1.918 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2021268
	speed: 0.4092s/iter; left time: 13550.6182s
	iters: 200, epoch: 11 | loss: 0.1402594
	speed: 0.1194s/iter; left time: 3941.6425s
	iters: 300, epoch: 11 | loss: 0.2087113
	speed: 0.1505s/iter; left time: 4951.9730s
Epoch: 11 cost time: 50.18762016296387
Epoch: 11, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.074 Vali Acc: 0.636 Test Loss: 2.074 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0024770
	speed: 0.4849s/iter; left time: 15878.1448s
	iters: 200, epoch: 12 | loss: 0.0542510
	speed: 0.1285s/iter; left time: 4193.8899s
	iters: 300, epoch: 12 | loss: 0.1614355
	speed: 0.1192s/iter; left time: 3879.3783s
Epoch: 12 cost time: 48.55446219444275
Epoch: 12, Steps: 369 | Train Loss: 0.061 Vali Loss: 1.920 Vali Acc: 0.632 Test Loss: 1.920 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1345344
	speed: 0.4086s/iter; left time: 13228.8706s
	iters: 200, epoch: 13 | loss: 0.0609885
	speed: 0.1457s/iter; left time: 4701.4492s
	iters: 300, epoch: 13 | loss: 0.0073147
	speed: 0.1483s/iter; left time: 4772.3976s
Epoch: 13 cost time: 53.27196168899536
Epoch: 13, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.292 Vali Acc: 0.636 Test Loss: 2.292 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0073793
	speed: 0.4736s/iter; left time: 15156.7136s
	iters: 200, epoch: 14 | loss: 0.0000626
	speed: 0.1216s/iter; left time: 3880.1456s
	iters: 300, epoch: 14 | loss: 0.0158584
	speed: 0.1217s/iter; left time: 3871.6352s
Epoch: 14 cost time: 46.91477560997009
Epoch: 14, Steps: 369 | Train Loss: 0.046 Vali Loss: 2.438 Vali Acc: 0.641 Test Loss: 2.438 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0041532
	speed: 0.4329s/iter; left time: 13694.9375s
	iters: 200, epoch: 15 | loss: 0.0007509
	speed: 0.1464s/iter; left time: 4616.1110s
	iters: 300, epoch: 15 | loss: 0.0988896
	speed: 0.1468s/iter; left time: 4616.0111s
Epoch: 15 cost time: 54.965293407440186
Epoch: 15, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.467 Vali Acc: 0.640 Test Loss: 2.467 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0010426
	speed: 0.4517s/iter; left time: 14123.0261s
	iters: 200, epoch: 16 | loss: 0.1224849
	speed: 0.1224s/iter; left time: 3813.8354s
	iters: 300, epoch: 16 | loss: 0.0006899
	speed: 0.1216s/iter; left time: 3776.8721s
Epoch: 16 cost time: 45.79091262817383
Epoch: 16, Steps: 369 | Train Loss: 0.045 Vali Loss: 2.318 Vali Acc: 0.634 Test Loss: 2.318 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0023114
	speed: 0.4518s/iter; left time: 13960.7792s
	iters: 200, epoch: 17 | loss: 0.0006978
	speed: 0.1488s/iter; left time: 4583.3913s
	iters: 300, epoch: 17 | loss: 0.0041340
	speed: 0.1502s/iter; left time: 4611.1172s
Epoch: 17 cost time: 55.84944701194763
Epoch: 17, Steps: 369 | Train Loss: 0.031 Vali Loss: 2.569 Vali Acc: 0.633 Test Loss: 2.569 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0058408
	speed: 0.4296s/iter; left time: 13116.1306s
	iters: 200, epoch: 18 | loss: 0.0043654
	speed: 0.1190s/iter; left time: 3619.5055s
	iters: 300, epoch: 18 | loss: 0.0446675
	speed: 0.1211s/iter; left time: 3672.4148s
Epoch: 18 cost time: 45.65059018135071
Epoch: 18, Steps: 369 | Train Loss: 0.026 Vali Loss: 2.686 Vali Acc: 0.643 Test Loss: 2.686 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6464245175936436
model parameter : 304994
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6385763
	speed: 0.0751s/iter; left time: 2764.9535s
	iters: 200, epoch: 1 | loss: 1.0225067
	speed: 0.0546s/iter; left time: 2005.5167s
	iters: 300, epoch: 1 | loss: 1.6703426
	speed: 0.0549s/iter; left time: 2008.9712s
Epoch: 1 cost time: 22.476274490356445
Epoch: 1, Steps: 369 | Train Loss: 1.016 Vali Loss: 1.393 Vali Acc: 0.619 Test Loss: 1.393 Test Acc: 0.619
Validation loss decreased (inf --> -0.618601).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2295979
	speed: 0.2223s/iter; left time: 8097.9603s
	iters: 200, epoch: 2 | loss: 0.9994922
	speed: 0.0556s/iter; left time: 2020.8908s
	iters: 300, epoch: 2 | loss: 0.7410676
	speed: 0.0551s/iter; left time: 1994.5959s
Epoch: 2 cost time: 20.78163719177246
Epoch: 2, Steps: 369 | Train Loss: 1.186 Vali Loss: 1.691 Vali Acc: 0.645 Test Loss: 1.691 Test Acc: 0.645
Validation loss decreased (-0.618601 --> -0.644705).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7212313
	speed: 0.2583s/iter; left time: 9315.2700s
	iters: 200, epoch: 3 | loss: 1.2228922
	speed: 0.0721s/iter; left time: 2593.6892s
	iters: 300, epoch: 3 | loss: 1.0436647
	speed: 0.0732s/iter; left time: 2623.4732s
Epoch: 3 cost time: 27.3659508228302
Epoch: 3, Steps: 369 | Train Loss: 1.148 Vali Loss: 2.249 Vali Acc: 0.628 Test Loss: 2.249 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1278973
	speed: 0.2658s/iter; left time: 9486.7550s
	iters: 200, epoch: 4 | loss: 1.2068341
	speed: 0.0559s/iter; left time: 1990.3842s
	iters: 300, epoch: 4 | loss: 0.9050984
	speed: 0.0552s/iter; left time: 1959.2437s
Epoch: 4 cost time: 21.67693519592285
Epoch: 4, Steps: 369 | Train Loss: 0.993 Vali Loss: 2.220 Vali Acc: 0.630 Test Loss: 2.220 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0799547
	speed: 0.2203s/iter; left time: 7783.2188s
	iters: 200, epoch: 5 | loss: 1.1225944
	speed: 0.0560s/iter; left time: 1971.4737s
	iters: 300, epoch: 5 | loss: 0.3887750
	speed: 0.0569s/iter; left time: 1998.3064s
Epoch: 5 cost time: 21.552000999450684
Epoch: 5, Steps: 369 | Train Loss: 0.705 Vali Loss: 2.040 Vali Acc: 0.632 Test Loss: 2.040 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1674495
	speed: 0.2270s/iter; left time: 7933.7848s
	iters: 200, epoch: 6 | loss: 0.0566021
	speed: 0.0645s/iter; left time: 2249.8822s
	iters: 300, epoch: 6 | loss: 0.2028692
	speed: 0.0466s/iter; left time: 1619.3036s
Epoch: 6 cost time: 21.44457244873047
Epoch: 6, Steps: 369 | Train Loss: 0.433 Vali Loss: 1.682 Vali Acc: 0.640 Test Loss: 1.682 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1281098
	speed: 0.1872s/iter; left time: 6473.3676s
	iters: 200, epoch: 7 | loss: 0.3049062
	speed: 0.0458s/iter; left time: 1579.2356s
	iters: 300, epoch: 7 | loss: 0.0844873
	speed: 0.0455s/iter; left time: 1564.6764s
Epoch: 7 cost time: 17.50230574607849
Epoch: 7, Steps: 369 | Train Loss: 0.276 Vali Loss: 1.615 Vali Acc: 0.607 Test Loss: 1.615 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1021807
	speed: 0.2346s/iter; left time: 8028.3606s
	iters: 200, epoch: 8 | loss: 0.2786452
	speed: 0.0679s/iter; left time: 2315.7278s
	iters: 300, epoch: 8 | loss: 0.2943889
	speed: 0.0675s/iter; left time: 2296.6544s
Epoch: 8 cost time: 25.612099170684814
Epoch: 8, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.531 Vali Acc: 0.641 Test Loss: 1.531 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0090973
	speed: 0.2496s/iter; left time: 8448.6858s
	iters: 200, epoch: 9 | loss: 0.1817948
	speed: 0.0545s/iter; left time: 1838.0002s
	iters: 300, epoch: 9 | loss: 0.0855575
	speed: 0.0559s/iter; left time: 1879.7476s
Epoch: 9 cost time: 22.122501373291016
Epoch: 9, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.588 Vali Acc: 0.634 Test Loss: 1.588 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0880215
	speed: 0.2203s/iter; left time: 7375.3463s
	iters: 200, epoch: 10 | loss: 0.0024317
	speed: 0.0550s/iter; left time: 1835.2784s
	iters: 300, epoch: 10 | loss: 0.0414550
	speed: 0.0556s/iter; left time: 1851.1251s
Epoch: 10 cost time: 21.150657892227173
Epoch: 10, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.599 Vali Acc: 0.636 Test Loss: 1.599 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0097952
	speed: 0.2340s/iter; left time: 7747.4986s
	iters: 200, epoch: 11 | loss: 0.0081357
	speed: 0.0664s/iter; left time: 2190.6780s
	iters: 300, epoch: 11 | loss: 0.0502775
	speed: 0.0663s/iter; left time: 2183.0493s
Epoch: 11 cost time: 25.08725619316101
Epoch: 11, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.789 Vali Acc: 0.623 Test Loss: 1.789 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0603966
	speed: 0.2517s/iter; left time: 8240.6660s
	iters: 200, epoch: 12 | loss: 0.0014996
	speed: 0.0648s/iter; left time: 2115.8337s
	iters: 300, epoch: 12 | loss: 0.0108968
	speed: 0.0543s/iter; left time: 1767.3721s
Epoch: 12 cost time: 22.848703145980835
Epoch: 12, Steps: 369 | Train Loss: 0.081 Vali Loss: 1.819 Vali Acc: 0.639 Test Loss: 1.819 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.64472190692395
model parameter : 162178
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9618757
	speed: 0.0677s/iter; left time: 2491.5296s
	iters: 200, epoch: 1 | loss: 0.7989643
	speed: 0.0486s/iter; left time: 1783.4136s
	iters: 300, epoch: 1 | loss: 0.9339965
	speed: 0.0484s/iter; left time: 1772.4072s
Epoch: 1 cost time: 19.876878023147583
Epoch: 1, Steps: 369 | Train Loss: 0.903 Vali Loss: 1.217 Vali Acc: 0.642 Test Loss: 1.217 Test Acc: 0.642
Validation loss decreased (inf --> -0.642156).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9137967
	speed: 0.1972s/iter; left time: 7185.6105s
	iters: 200, epoch: 2 | loss: 1.7835573
	speed: 0.0427s/iter; left time: 1552.8167s
	iters: 300, epoch: 2 | loss: 0.8770595
	speed: 0.0411s/iter; left time: 1489.2754s
Epoch: 2 cost time: 16.743976831436157
Epoch: 2, Steps: 369 | Train Loss: 1.018 Vali Loss: 1.691 Vali Acc: 0.644 Test Loss: 1.691 Test Acc: 0.644
Validation loss decreased (-0.642156 --> -0.644137).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5064986
	speed: 0.1800s/iter; left time: 6492.3603s
	iters: 200, epoch: 3 | loss: 1.7894772
	speed: 0.0414s/iter; left time: 1490.4148s
	iters: 300, epoch: 3 | loss: 2.6280107
	speed: 0.0410s/iter; left time: 1469.9975s
Epoch: 3 cost time: 15.815693616867065
Epoch: 3, Steps: 369 | Train Loss: 0.961 Vali Loss: 2.052 Vali Acc: 0.637 Test Loss: 2.052 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6441914
	speed: 0.1712s/iter; left time: 6110.0503s
	iters: 200, epoch: 4 | loss: 1.2573869
	speed: 0.0427s/iter; left time: 1518.0896s
	iters: 300, epoch: 4 | loss: 0.1589740
	speed: 0.0510s/iter; left time: 1810.6035s
Epoch: 4 cost time: 17.796347856521606
Epoch: 4, Steps: 369 | Train Loss: 0.801 Vali Loss: 2.137 Vali Acc: 0.633 Test Loss: 2.137 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1338537
	speed: 0.1905s/iter; left time: 6728.7102s
	iters: 200, epoch: 5 | loss: 0.7181154
	speed: 0.0511s/iter; left time: 1800.5874s
	iters: 300, epoch: 5 | loss: 1.1153009
	speed: 0.0505s/iter; left time: 1773.0723s
Epoch: 5 cost time: 19.287724018096924
Epoch: 5, Steps: 369 | Train Loss: 0.591 Vali Loss: 1.990 Vali Acc: 0.634 Test Loss: 1.990 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0541336
	speed: 0.1986s/iter; left time: 6942.5658s
	iters: 200, epoch: 6 | loss: 0.4642029
	speed: 0.0450s/iter; left time: 1567.2029s
	iters: 300, epoch: 6 | loss: 0.4102100
	speed: 0.0418s/iter; left time: 1453.7389s
Epoch: 6 cost time: 17.046090841293335
Epoch: 6, Steps: 369 | Train Loss: 0.406 Vali Loss: 1.664 Vali Acc: 0.637 Test Loss: 1.664 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2569661
	speed: 0.1742s/iter; left time: 6023.6410s
	iters: 200, epoch: 7 | loss: 0.2892656
	speed: 0.0416s/iter; left time: 1435.6512s
	iters: 300, epoch: 7 | loss: 0.4678325
	speed: 0.0420s/iter; left time: 1444.3705s
Epoch: 7 cost time: 16.17116641998291
Epoch: 7, Steps: 369 | Train Loss: 0.307 Vali Loss: 1.534 Vali Acc: 0.643 Test Loss: 1.534 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.4513313
	speed: 0.1791s/iter; left time: 6127.5638s
	iters: 200, epoch: 8 | loss: 0.1010164
	speed: 0.0467s/iter; left time: 1594.4045s
	iters: 300, epoch: 8 | loss: 0.0271336
	speed: 0.0511s/iter; left time: 1737.4547s
Epoch: 8 cost time: 18.375997304916382
Epoch: 8, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.476 Vali Acc: 0.648 Test Loss: 1.476 Test Acc: 0.648
Validation loss decreased (-0.644137 --> -0.648396).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1208573
	speed: 0.2069s/iter; left time: 7004.7523s
	iters: 200, epoch: 9 | loss: 0.2684536
	speed: 0.0503s/iter; left time: 1696.7577s
	iters: 300, epoch: 9 | loss: 0.1834331
	speed: 0.0506s/iter; left time: 1702.6599s
Epoch: 9 cost time: 19.365111589431763
Epoch: 9, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.548 Vali Acc: 0.631 Test Loss: 1.548 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1709812
	speed: 0.1901s/iter; left time: 6363.8681s
	iters: 200, epoch: 10 | loss: 0.0178108
	speed: 0.0420s/iter; left time: 1402.8793s
	iters: 300, epoch: 10 | loss: 0.2332689
	speed: 0.0424s/iter; left time: 1410.8636s
Epoch: 10 cost time: 16.259012460708618
Epoch: 10, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.599 Vali Acc: 0.650 Test Loss: 1.599 Test Acc: 0.650
Validation loss decreased (-0.648396 --> -0.649530).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0036203
	speed: 0.1751s/iter; left time: 5799.0762s
	iters: 200, epoch: 11 | loss: 0.0397245
	speed: 0.0416s/iter; left time: 1373.3958s
	iters: 300, epoch: 11 | loss: 0.0106987
	speed: 0.0416s/iter; left time: 1369.3052s
Epoch: 11 cost time: 16.24418067932129
Epoch: 11, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.662 Vali Acc: 0.635 Test Loss: 1.662 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0035186
	speed: 0.1884s/iter; left time: 6169.1789s
	iters: 200, epoch: 12 | loss: 0.0443609
	speed: 0.0488s/iter; left time: 1592.6718s
	iters: 300, epoch: 12 | loss: 0.0145129
	speed: 0.0488s/iter; left time: 1587.0436s
Epoch: 12 cost time: 18.96776580810547
Epoch: 12, Steps: 369 | Train Loss: 0.080 Vali Loss: 1.808 Vali Acc: 0.642 Test Loss: 1.808 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1184763
	speed: 0.2059s/iter; left time: 6665.9681s
	iters: 200, epoch: 13 | loss: 0.0452963
	speed: 0.0497s/iter; left time: 1604.6940s
	iters: 300, epoch: 13 | loss: 0.0178282
	speed: 0.0501s/iter; left time: 1612.5521s
Epoch: 13 cost time: 19.06077003479004
Epoch: 13, Steps: 369 | Train Loss: 0.067 Vali Loss: 1.944 Vali Acc: 0.638 Test Loss: 1.944 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0962704
	speed: 0.1861s/iter; left time: 5955.5547s
	iters: 200, epoch: 14 | loss: 0.0133440
	speed: 0.0417s/iter; left time: 1329.2667s
	iters: 300, epoch: 14 | loss: 0.0050845
	speed: 0.0425s/iter; left time: 1351.5184s
Epoch: 14 cost time: 16.35148811340332
Epoch: 14, Steps: 369 | Train Loss: 0.079 Vali Loss: 1.966 Vali Acc: 0.647 Test Loss: 1.966 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1223363
	speed: 0.1718s/iter; left time: 5436.3606s
	iters: 200, epoch: 15 | loss: 0.0303738
	speed: 0.0441s/iter; left time: 1389.2286s
	iters: 300, epoch: 15 | loss: 0.0729681
	speed: 0.0422s/iter; left time: 1325.4593s
Epoch: 15 cost time: 16.64379119873047
Epoch: 15, Steps: 369 | Train Loss: 0.076 Vali Loss: 2.071 Vali Acc: 0.630 Test Loss: 2.071 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0033635
	speed: 0.1899s/iter; left time: 5938.7249s
	iters: 200, epoch: 16 | loss: 0.0457199
	speed: 0.0508s/iter; left time: 1582.3033s
	iters: 300, epoch: 16 | loss: 0.1874480
	speed: 0.0508s/iter; left time: 1579.6250s
Epoch: 16 cost time: 19.35433006286621
Epoch: 16, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.124 Vali Acc: 0.635 Test Loss: 2.124 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1883588
	speed: 0.2015s/iter; left time: 6224.3835s
	iters: 200, epoch: 17 | loss: 0.0454007
	speed: 0.0501s/iter; left time: 1543.7989s
	iters: 300, epoch: 17 | loss: 0.0196919
	speed: 0.0503s/iter; left time: 1543.0629s
Epoch: 17 cost time: 19.216887950897217
Epoch: 17, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.219 Vali Acc: 0.639 Test Loss: 2.219 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0226415
	speed: 0.1834s/iter; left time: 5597.4613s
	iters: 200, epoch: 18 | loss: 0.0818786
	speed: 0.0420s/iter; left time: 1277.1584s
	iters: 300, epoch: 18 | loss: 0.1428481
	speed: 0.0418s/iter; left time: 1269.0420s
Epoch: 18 cost time: 16.33029270172119
Epoch: 18, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.369 Vali Acc: 0.636 Test Loss: 2.369 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0117121
	speed: 0.1758s/iter; left time: 5301.8394s
	iters: 200, epoch: 19 | loss: 0.0121274
	speed: 0.0428s/iter; left time: 1286.1562s
	iters: 300, epoch: 19 | loss: 0.0561080
	speed: 0.0417s/iter; left time: 1250.0628s
Epoch: 19 cost time: 16.26991319656372
Epoch: 19, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.310 Vali Acc: 0.632 Test Loss: 2.310 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1187328
	speed: 0.1909s/iter; left time: 5687.9192s
	iters: 200, epoch: 20 | loss: 0.2470718
	speed: 0.0510s/iter; left time: 1514.4937s
	iters: 300, epoch: 20 | loss: 0.2045717
	speed: 0.0509s/iter; left time: 1505.5710s
Epoch: 20 cost time: 19.34611964225769
Epoch: 20, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.443 Vali Acc: 0.623 Test Loss: 2.443 Test Acc: 0.623
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6495459704880817
model parameter : 116114
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2969214
	speed: 0.0521s/iter; left time: 1917.2187s
	iters: 200, epoch: 1 | loss: 0.7768230
	speed: 0.0290s/iter; left time: 1065.4256s
	iters: 300, epoch: 1 | loss: 0.8614684
	speed: 0.0300s/iter; left time: 1099.1034s
Epoch: 1 cost time: 13.317028522491455
Epoch: 1, Steps: 369 | Train Loss: 0.845 Vali Loss: 1.341 Vali Acc: 0.619 Test Loss: 1.341 Test Acc: 0.619
Validation loss decreased (inf --> -0.619453).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5543061
	speed: 0.1448s/iter; left time: 5276.9686s
	iters: 200, epoch: 2 | loss: 0.2998545
	speed: 0.0310s/iter; left time: 1125.4844s
	iters: 300, epoch: 2 | loss: 0.8273134
	speed: 0.0312s/iter; left time: 1130.2482s
Epoch: 2 cost time: 12.413069486618042
Epoch: 2, Steps: 369 | Train Loss: 0.874 Vali Loss: 1.481 Vali Acc: 0.622 Test Loss: 1.481 Test Acc: 0.622
Validation loss decreased (-0.619453 --> -0.621722).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7263404
	speed: 0.1587s/iter; left time: 5723.6732s
	iters: 200, epoch: 3 | loss: 0.8549586
	speed: 0.0390s/iter; left time: 1403.5935s
	iters: 300, epoch: 3 | loss: 0.3587222
	speed: 0.0388s/iter; left time: 1391.1806s
Epoch: 3 cost time: 14.990988731384277
Epoch: 3, Steps: 369 | Train Loss: 0.833 Vali Loss: 1.868 Vali Acc: 0.612 Test Loss: 1.868 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2753893
	speed: 0.1609s/iter; left time: 5743.3583s
	iters: 200, epoch: 4 | loss: 3.3680882
	speed: 0.0399s/iter; left time: 1421.5722s
	iters: 300, epoch: 4 | loss: 1.2043395
	speed: 0.0388s/iter; left time: 1378.2662s
Epoch: 4 cost time: 15.21086835861206
Epoch: 4, Steps: 369 | Train Loss: 0.773 Vali Loss: 1.885 Vali Acc: 0.632 Test Loss: 1.885 Test Acc: 0.632
Validation loss decreased (-0.621722 --> -0.631650).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3198507
	speed: 0.1505s/iter; left time: 5315.7863s
	iters: 200, epoch: 5 | loss: 0.8737758
	speed: 0.0318s/iter; left time: 1121.4568s
	iters: 300, epoch: 5 | loss: 1.3230133
	speed: 0.0313s/iter; left time: 1099.6013s
Epoch: 5 cost time: 12.286945104598999
Epoch: 5, Steps: 369 | Train Loss: 0.592 Vali Loss: 1.566 Vali Acc: 0.639 Test Loss: 1.566 Test Acc: 0.639
Validation loss decreased (-0.631650 --> -0.639315).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4869202
	speed: 0.1434s/iter; left time: 5012.3812s
	iters: 200, epoch: 6 | loss: 0.2752990
	speed: 0.0337s/iter; left time: 1173.4097s
	iters: 300, epoch: 6 | loss: 0.3965188
	speed: 0.0319s/iter; left time: 1109.9315s
Epoch: 6 cost time: 12.651602983474731
Epoch: 6, Steps: 369 | Train Loss: 0.461 Vali Loss: 1.306 Vali Acc: 0.640 Test Loss: 1.306 Test Acc: 0.640
Validation loss decreased (-0.639315 --> -0.640452).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3321996
	speed: 0.1368s/iter; left time: 4731.6976s
	iters: 200, epoch: 7 | loss: 0.2060939
	speed: 0.0406s/iter; left time: 1400.1224s
	iters: 300, epoch: 7 | loss: 0.2774594
	speed: 0.0395s/iter; left time: 1358.4018s
Epoch: 7 cost time: 14.36903691291809
Epoch: 7, Steps: 369 | Train Loss: 0.321 Vali Loss: 1.188 Vali Acc: 0.638 Test Loss: 1.188 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1663405
	speed: 0.1597s/iter; left time: 5464.1718s
	iters: 200, epoch: 8 | loss: 0.2432311
	speed: 0.0396s/iter; left time: 1351.7937s
	iters: 300, epoch: 8 | loss: 0.1620367
	speed: 0.0393s/iter; left time: 1337.5031s
Epoch: 8 cost time: 15.335720300674438
Epoch: 8, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.248 Vali Acc: 0.648 Test Loss: 1.248 Test Acc: 0.648
Validation loss decreased (-0.640452 --> -0.648398).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0458493
	speed: 0.1636s/iter; left time: 5537.5894s
	iters: 200, epoch: 9 | loss: 0.3709404
	speed: 0.0396s/iter; left time: 1337.3822s
	iters: 300, epoch: 9 | loss: 0.2273314
	speed: 0.0335s/iter; left time: 1127.4214s
Epoch: 9 cost time: 14.101966142654419
Epoch: 9, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.333 Vali Acc: 0.652 Test Loss: 1.333 Test Acc: 0.652
Validation loss decreased (-0.648398 --> -0.652087).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0652924
	speed: 0.1451s/iter; left time: 4857.0001s
	iters: 200, epoch: 10 | loss: 0.0484988
	speed: 0.0319s/iter; left time: 1063.8482s
	iters: 300, epoch: 10 | loss: 0.0672163
	speed: 0.0321s/iter; left time: 1066.9392s
Epoch: 10 cost time: 12.488377571105957
Epoch: 10, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.414 Vali Acc: 0.652 Test Loss: 1.414 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0962614
	speed: 0.1399s/iter; left time: 4631.8057s
	iters: 200, epoch: 11 | loss: 0.1018747
	speed: 0.0326s/iter; left time: 1077.8008s
	iters: 300, epoch: 11 | loss: 0.1353758
	speed: 0.0326s/iter; left time: 1071.7244s
Epoch: 11 cost time: 12.798219680786133
Epoch: 11, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.515 Vali Acc: 0.640 Test Loss: 1.515 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2766638
	speed: 0.1528s/iter; left time: 5003.9733s
	iters: 200, epoch: 12 | loss: 0.0992908
	speed: 0.0403s/iter; left time: 1316.1581s
	iters: 300, epoch: 12 | loss: 0.0147376
	speed: 0.0405s/iter; left time: 1319.3110s
Epoch: 12 cost time: 15.641638994216919
Epoch: 12, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.615 Vali Acc: 0.646 Test Loss: 1.615 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0453278
	speed: 0.1684s/iter; left time: 5450.8011s
	iters: 200, epoch: 13 | loss: 0.1374139
	speed: 0.0393s/iter; left time: 1268.7822s
	iters: 300, epoch: 13 | loss: 0.0401080
	speed: 0.0397s/iter; left time: 1277.7504s
Epoch: 13 cost time: 15.49739384651184
Epoch: 13, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.753 Vali Acc: 0.649 Test Loss: 1.753 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0987096
	speed: 0.1611s/iter; left time: 5156.6800s
	iters: 200, epoch: 14 | loss: 0.1286320
	speed: 0.0320s/iter; left time: 1021.5562s
	iters: 300, epoch: 14 | loss: 0.2141532
	speed: 0.0316s/iter; left time: 1005.0767s
Epoch: 14 cost time: 12.464348316192627
Epoch: 14, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.785 Vali Acc: 0.647 Test Loss: 1.785 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0484744
	speed: 0.1524s/iter; left time: 4821.0511s
	iters: 200, epoch: 15 | loss: 0.2637720
	speed: 0.0313s/iter; left time: 988.5471s
	iters: 300, epoch: 15 | loss: 0.6019325
	speed: 0.0319s/iter; left time: 1001.7856s
Epoch: 15 cost time: 12.600075483322144
Epoch: 15, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.866 Vali Acc: 0.639 Test Loss: 1.866 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0017181
	speed: 0.1504s/iter; left time: 4701.2668s
	iters: 200, epoch: 16 | loss: 0.0301878
	speed: 0.0323s/iter; left time: 1006.3646s
	iters: 300, epoch: 16 | loss: 0.2832863
	speed: 0.0359s/iter; left time: 1116.1909s
Epoch: 16 cost time: 13.473375082015991
Epoch: 16, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.722 Vali Acc: 0.646 Test Loss: 1.722 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0144351
	speed: 0.1696s/iter; left time: 5238.9514s
	iters: 200, epoch: 17 | loss: 0.0820260
	speed: 0.0392s/iter; left time: 1206.0575s
	iters: 300, epoch: 17 | loss: 0.0687081
	speed: 0.0394s/iter; left time: 1210.0270s
Epoch: 17 cost time: 15.20812726020813
Epoch: 17, Steps: 369 | Train Loss: 0.068 Vali Loss: 1.932 Vali Acc: 0.644 Test Loss: 1.932 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0451759
	speed: 0.1728s/iter; left time: 5274.7730s
	iters: 200, epoch: 18 | loss: 0.0044793
	speed: 0.0397s/iter; left time: 1207.0702s
	iters: 300, epoch: 18 | loss: 0.0034665
	speed: 0.0395s/iter; left time: 1198.7061s
Epoch: 18 cost time: 14.779921531677246
Epoch: 18, Steps: 369 | Train Loss: 0.075 Vali Loss: 1.943 Vali Acc: 0.640 Test Loss: 1.943 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0186219
	speed: 0.1472s/iter; left time: 4438.8304s
	iters: 200, epoch: 19 | loss: 0.0215894
	speed: 0.0313s/iter; left time: 941.8809s
	iters: 300, epoch: 19 | loss: 0.0101295
	speed: 0.0311s/iter; left time: 931.8949s
Epoch: 19 cost time: 12.29762053489685
Epoch: 19, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.052 Vali Acc: 0.655 Test Loss: 2.052 Test Acc: 0.655
Validation loss decreased (-0.652087 --> -0.654917).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0044083
	speed: 0.1439s/iter; left time: 4286.1040s
	iters: 200, epoch: 20 | loss: 0.0082348
	speed: 0.0324s/iter; left time: 960.7059s
	iters: 300, epoch: 20 | loss: 0.0109733
	speed: 0.0318s/iter; left time: 941.5186s
Epoch: 20 cost time: 12.547592878341675
Epoch: 20, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.078 Vali Acc: 0.637 Test Loss: 2.078 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1274490
	speed: 0.1655s/iter; left time: 4868.6378s
	iters: 200, epoch: 21 | loss: 0.0572196
	speed: 0.0391s/iter; left time: 1145.3253s
	iters: 300, epoch: 21 | loss: 0.0231201
	speed: 0.0397s/iter; left time: 1160.7102s
Epoch: 21 cost time: 15.25721526145935
Epoch: 21, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.057 Vali Acc: 0.652 Test Loss: 2.057 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0311829
	speed: 0.1685s/iter; left time: 4895.4151s
	iters: 200, epoch: 22 | loss: 0.0946419
	speed: 0.0396s/iter; left time: 1146.3946s
	iters: 300, epoch: 22 | loss: 0.1124570
	speed: 0.0401s/iter; left time: 1156.2368s
Epoch: 22 cost time: 15.491874694824219
Epoch: 22, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.180 Vali Acc: 0.651 Test Loss: 2.180 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0572812
	speed: 0.1531s/iter; left time: 4390.8610s
	iters: 200, epoch: 23 | loss: 0.0028602
	speed: 0.0328s/iter; left time: 937.5342s
	iters: 300, epoch: 23 | loss: 0.0305271
	speed: 0.0341s/iter; left time: 970.2407s
Epoch: 23 cost time: 12.831254482269287
Epoch: 23, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.153 Vali Acc: 0.644 Test Loss: 2.153 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1017909
	speed: 0.1428s/iter; left time: 4044.3014s
	iters: 200, epoch: 24 | loss: 0.0132578
	speed: 0.0324s/iter; left time: 915.3086s
	iters: 300, epoch: 24 | loss: 0.0028075
	speed: 0.0327s/iter; left time: 919.4533s
Epoch: 24 cost time: 12.63530683517456
Epoch: 24, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.231 Vali Acc: 0.641 Test Loss: 2.231 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0007737
	speed: 0.1581s/iter; left time: 4417.3038s
	iters: 200, epoch: 25 | loss: 0.1295534
	speed: 0.0318s/iter; left time: 884.6771s
	iters: 300, epoch: 25 | loss: 0.2402573
	speed: 0.0342s/iter; left time: 949.6099s
Epoch: 25 cost time: 13.284460067749023
Epoch: 25, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.166 Vali Acc: 0.654 Test Loss: 2.166 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0345066
	speed: 0.1691s/iter; left time: 4663.3876s
	iters: 200, epoch: 26 | loss: 0.0251660
	speed: 0.0395s/iter; left time: 1086.6405s
	iters: 300, epoch: 26 | loss: 0.0239476
	speed: 0.0396s/iter; left time: 1083.8635s
Epoch: 26 cost time: 15.348409175872803
Epoch: 26, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.279 Vali Acc: 0.635 Test Loss: 2.279 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0022025
	speed: 0.1659s/iter; left time: 4514.2853s
	iters: 200, epoch: 27 | loss: 0.1587178
	speed: 0.0397s/iter; left time: 1075.6018s
	iters: 300, epoch: 27 | loss: 0.4665214
	speed: 0.0396s/iter; left time: 1068.6439s
Epoch: 27 cost time: 14.907000064849854
Epoch: 27, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.286 Vali Acc: 0.648 Test Loss: 2.286 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0055748
	speed: 0.1438s/iter; left time: 3859.9760s
	iters: 200, epoch: 28 | loss: 0.0116966
	speed: 0.0327s/iter; left time: 874.6722s
	iters: 300, epoch: 28 | loss: 0.0136892
	speed: 0.0322s/iter; left time: 858.8820s
Epoch: 28 cost time: 12.694552898406982
Epoch: 28, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.278 Vali Acc: 0.644 Test Loss: 2.278 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0306918
	speed: 0.1443s/iter; left time: 3820.1244s
	iters: 200, epoch: 29 | loss: 0.0036291
	speed: 0.0317s/iter; left time: 836.6365s
	iters: 300, epoch: 29 | loss: 0.0184311
	speed: 0.0317s/iter; left time: 832.9789s
Epoch: 29 cost time: 12.548513889312744
Epoch: 29, Steps: 369 | Train Loss: 0.033 Vali Loss: 2.361 Vali Acc: 0.640 Test Loss: 2.361 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6549375709421112
model parameter : 88498
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7820182
	speed: 0.0538s/iter; left time: 1978.7433s
	iters: 200, epoch: 1 | loss: 0.5853609
	speed: 0.0278s/iter; left time: 1021.2545s
	iters: 300, epoch: 1 | loss: 0.9326851
	speed: 0.0267s/iter; left time: 978.2383s
Epoch: 1 cost time: 12.851675748825073
Epoch: 1, Steps: 369 | Train Loss: 0.789 Vali Loss: 1.102 Vali Acc: 0.624 Test Loss: 1.102 Test Acc: 0.624
Validation loss decreased (inf --> -0.624280).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4857903
	speed: 0.1383s/iter; left time: 5038.7592s
	iters: 200, epoch: 2 | loss: 0.3690480
	speed: 0.0272s/iter; left time: 988.4835s
	iters: 300, epoch: 2 | loss: 0.9977843
	speed: 0.0276s/iter; left time: 998.2729s
Epoch: 2 cost time: 10.53946566581726
Epoch: 2, Steps: 369 | Train Loss: 0.783 Vali Loss: 1.341 Vali Acc: 0.646 Test Loss: 1.341 Test Acc: 0.646
Validation loss decreased (-0.624280 --> -0.646127).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3172347
	speed: 0.1378s/iter; left time: 4968.2623s
	iters: 200, epoch: 3 | loss: 0.3651297
	speed: 0.0278s/iter; left time: 998.0063s
	iters: 300, epoch: 3 | loss: 0.4341923
	speed: 0.0277s/iter; left time: 994.3109s
Epoch: 3 cost time: 10.783008813858032
Epoch: 3, Steps: 369 | Train Loss: 0.788 Vali Loss: 1.559 Vali Acc: 0.638 Test Loss: 1.559 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3690444
	speed: 0.1392s/iter; left time: 4969.4779s
	iters: 200, epoch: 4 | loss: 0.6394389
	speed: 0.0352s/iter; left time: 1251.3446s
	iters: 300, epoch: 4 | loss: 0.9093013
	speed: 0.0358s/iter; left time: 1271.4420s
Epoch: 4 cost time: 13.769985914230347
Epoch: 4, Steps: 369 | Train Loss: 0.687 Vali Loss: 1.702 Vali Acc: 0.646 Test Loss: 1.702 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3692164
	speed: 0.1497s/iter; left time: 5287.2888s
	iters: 200, epoch: 5 | loss: 0.5816416
	speed: 0.0364s/iter; left time: 1280.9557s
	iters: 300, epoch: 5 | loss: 0.3843596
	speed: 0.0366s/iter; left time: 1285.5510s
Epoch: 5 cost time: 14.213390588760376
Epoch: 5, Steps: 369 | Train Loss: 0.592 Vali Loss: 1.566 Vali Acc: 0.654 Test Loss: 1.566 Test Acc: 0.654
Validation loss decreased (-0.646127 --> -0.653787).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6136241
	speed: 0.1469s/iter; left time: 5136.0196s
	iters: 200, epoch: 6 | loss: 0.1400900
	speed: 0.0259s/iter; left time: 902.7080s
	iters: 300, epoch: 6 | loss: 0.2981526
	speed: 0.0282s/iter; left time: 981.4016s
Epoch: 6 cost time: 11.499636888504028
Epoch: 6, Steps: 369 | Train Loss: 0.442 Vali Loss: 1.576 Vali Acc: 0.631 Test Loss: 1.576 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8852604
	speed: 0.1351s/iter; left time: 4672.9866s
	iters: 200, epoch: 7 | loss: 0.3422070
	speed: 0.0276s/iter; left time: 952.1528s
	iters: 300, epoch: 7 | loss: 0.7653688
	speed: 0.0275s/iter; left time: 946.4509s
Epoch: 7 cost time: 10.783940553665161
Epoch: 7, Steps: 369 | Train Loss: 0.374 Vali Loss: 1.368 Vali Acc: 0.636 Test Loss: 1.368 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5819897
	speed: 0.1363s/iter; left time: 4662.6717s
	iters: 200, epoch: 8 | loss: 0.0655331
	speed: 0.0274s/iter; left time: 934.7126s
	iters: 300, epoch: 8 | loss: 0.1511897
	speed: 0.0268s/iter; left time: 911.8863s
Epoch: 8 cost time: 10.92042875289917
Epoch: 8, Steps: 369 | Train Loss: 0.301 Vali Loss: 1.240 Vali Acc: 0.650 Test Loss: 1.240 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3889270
	speed: 0.1481s/iter; left time: 5013.7305s
	iters: 200, epoch: 9 | loss: 0.1237544
	speed: 0.0357s/iter; left time: 1204.3091s
	iters: 300, epoch: 9 | loss: 0.3200386
	speed: 0.0354s/iter; left time: 1191.0881s
Epoch: 9 cost time: 13.734689950942993
Epoch: 9, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.281 Vali Acc: 0.642 Test Loss: 1.281 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0416037
	speed: 0.1480s/iter; left time: 4955.9617s
	iters: 200, epoch: 10 | loss: 0.0464860
	speed: 0.0364s/iter; left time: 1215.3210s
	iters: 300, epoch: 10 | loss: 0.1288791
	speed: 0.0362s/iter; left time: 1206.1034s
Epoch: 10 cost time: 14.085387468338013
Epoch: 10, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.385 Vali Acc: 0.636 Test Loss: 1.385 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2440740
	speed: 0.1409s/iter; left time: 4666.1805s
	iters: 200, epoch: 11 | loss: 0.0565929
	speed: 0.0282s/iter; left time: 932.0465s
	iters: 300, epoch: 11 | loss: 0.0690891
	speed: 0.0280s/iter; left time: 920.0421s
Epoch: 11 cost time: 11.66991114616394
Epoch: 11, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.493 Vali Acc: 0.640 Test Loss: 1.493 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0212108
	speed: 0.1295s/iter; left time: 4240.2712s
	iters: 200, epoch: 12 | loss: 0.0618995
	speed: 0.0291s/iter; left time: 949.0015s
	iters: 300, epoch: 12 | loss: 0.2738703
	speed: 0.0267s/iter; left time: 867.2759s
Epoch: 12 cost time: 10.942070245742798
Epoch: 12, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.537 Vali Acc: 0.637 Test Loss: 1.537 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0544757
	speed: 0.1361s/iter; left time: 4406.6330s
	iters: 200, epoch: 13 | loss: 0.1032721
	speed: 0.0272s/iter; left time: 876.5050s
	iters: 300, epoch: 13 | loss: 0.1439756
	speed: 0.0278s/iter; left time: 894.7071s
Epoch: 13 cost time: 10.952216386795044
Epoch: 13, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.588 Vali Acc: 0.637 Test Loss: 1.588 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0109151
	speed: 0.1453s/iter; left time: 4651.3843s
	iters: 200, epoch: 14 | loss: 0.0805099
	speed: 0.0351s/iter; left time: 1120.0814s
	iters: 300, epoch: 14 | loss: 0.1624838
	speed: 0.0351s/iter; left time: 1115.2803s
Epoch: 14 cost time: 13.710794925689697
Epoch: 14, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.682 Vali Acc: 0.645 Test Loss: 1.682 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0679788
	speed: 0.1498s/iter; left time: 4739.0484s
	iters: 200, epoch: 15 | loss: 0.0489953
	speed: 0.0350s/iter; left time: 1102.3241s
	iters: 300, epoch: 15 | loss: 0.1772413
	speed: 0.0353s/iter; left time: 1108.3222s
Epoch: 15 cost time: 13.676397800445557
Epoch: 15, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.740 Vali Acc: 0.650 Test Loss: 1.740 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 74722
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5494813
	speed: 0.0444s/iter; left time: 1635.0607s
	iters: 200, epoch: 1 | loss: 0.6380619
	speed: 0.0235s/iter; left time: 861.2854s
	iters: 300, epoch: 1 | loss: 0.7789863
	speed: 0.0223s/iter; left time: 816.5765s
Epoch: 1 cost time: 11.277393579483032
Epoch: 1, Steps: 369 | Train Loss: 0.731 Vali Loss: 1.189 Vali Acc: 0.604 Test Loss: 1.189 Test Acc: 0.604
Validation loss decreased (inf --> -0.604131).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5896139
	speed: 0.1377s/iter; left time: 5017.6715s
	iters: 200, epoch: 2 | loss: 0.9157006
	speed: 0.0314s/iter; left time: 1140.2330s
	iters: 300, epoch: 2 | loss: 1.3866876
	speed: 0.0319s/iter; left time: 1156.2544s
Epoch: 2 cost time: 12.512986183166504
Epoch: 2, Steps: 369 | Train Loss: 0.716 Vali Loss: 1.245 Vali Acc: 0.637 Test Loss: 1.245 Test Acc: 0.637
Validation loss decreased (-0.604131 --> -0.637048).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5816479
	speed: 0.1381s/iter; left time: 4982.0821s
	iters: 200, epoch: 3 | loss: 0.5093605
	speed: 0.0320s/iter; left time: 1150.8927s
	iters: 300, epoch: 3 | loss: 0.4889458
	speed: 0.0317s/iter; left time: 1136.6055s
Epoch: 3 cost time: 12.425021886825562
Epoch: 3, Steps: 369 | Train Loss: 0.691 Vali Loss: 1.430 Vali Acc: 0.625 Test Loss: 1.430 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4704582
	speed: 0.1296s/iter; left time: 4627.1083s
	iters: 200, epoch: 4 | loss: 1.3076713
	speed: 0.0238s/iter; left time: 848.1862s
	iters: 300, epoch: 4 | loss: 0.9019489
	speed: 0.0229s/iter; left time: 812.9978s
Epoch: 4 cost time: 9.5382559299469
Epoch: 4, Steps: 369 | Train Loss: 0.644 Vali Loss: 1.368 Vali Acc: 0.626 Test Loss: 1.368 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9469032
	speed: 0.1244s/iter; left time: 4395.9701s
	iters: 200, epoch: 5 | loss: 0.1638890
	speed: 0.0242s/iter; left time: 853.8439s
	iters: 300, epoch: 5 | loss: 0.0958138
	speed: 0.0243s/iter; left time: 854.7213s
Epoch: 5 cost time: 9.478895425796509
Epoch: 5, Steps: 369 | Train Loss: 0.555 Vali Loss: 1.267 Vali Acc: 0.669 Test Loss: 1.267 Test Acc: 0.669
Validation loss decreased (-0.637048 --> -0.668830).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4827725
	speed: 0.1298s/iter; left time: 4537.6848s
	iters: 200, epoch: 6 | loss: 0.4236591
	speed: 0.0247s/iter; left time: 861.0754s
	iters: 300, epoch: 6 | loss: 0.1316309
	speed: 0.0244s/iter; left time: 847.5251s
Epoch: 6 cost time: 9.635571956634521
Epoch: 6, Steps: 369 | Train Loss: 0.472 Vali Loss: 1.363 Vali Acc: 0.642 Test Loss: 1.363 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8058933
	speed: 0.1321s/iter; left time: 4568.1373s
	iters: 200, epoch: 7 | loss: 0.2001826
	speed: 0.0330s/iter; left time: 1138.3163s
	iters: 300, epoch: 7 | loss: 0.6905897
	speed: 0.0320s/iter; left time: 1099.1730s
Epoch: 7 cost time: 12.784303188323975
Epoch: 7, Steps: 369 | Train Loss: 0.373 Vali Loss: 1.248 Vali Acc: 0.640 Test Loss: 1.248 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2003912
	speed: 0.1342s/iter; left time: 4591.5137s
	iters: 200, epoch: 8 | loss: 0.3050973
	speed: 0.0324s/iter; left time: 1106.6839s
	iters: 300, epoch: 8 | loss: 0.3753119
	speed: 0.0323s/iter; left time: 1097.6394s
Epoch: 8 cost time: 12.65632677078247
Epoch: 8, Steps: 369 | Train Loss: 0.314 Vali Loss: 1.200 Vali Acc: 0.645 Test Loss: 1.200 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0525318
	speed: 0.1275s/iter; left time: 4316.5236s
	iters: 200, epoch: 9 | loss: 0.1420948
	speed: 0.0253s/iter; left time: 852.5353s
	iters: 300, epoch: 9 | loss: 0.5228022
	speed: 0.0245s/iter; left time: 823.7357s
Epoch: 9 cost time: 9.890899658203125
Epoch: 9, Steps: 369 | Train Loss: 0.264 Vali Loss: 1.192 Vali Acc: 0.650 Test Loss: 1.192 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0483780
	speed: 0.1203s/iter; left time: 4027.7529s
	iters: 200, epoch: 10 | loss: 0.3558728
	speed: 0.0240s/iter; left time: 800.4956s
	iters: 300, epoch: 10 | loss: 0.3707482
	speed: 0.0226s/iter; left time: 753.1101s
Epoch: 10 cost time: 9.381228923797607
Epoch: 10, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.230 Vali Acc: 0.641 Test Loss: 1.230 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0823135
	speed: 0.1353s/iter; left time: 4481.3903s
	iters: 200, epoch: 11 | loss: 0.0336411
	speed: 0.0241s/iter; left time: 795.2550s
	iters: 300, epoch: 11 | loss: 0.1514987
	speed: 0.0242s/iter; left time: 795.8488s
Epoch: 11 cost time: 9.816171169281006
Epoch: 11, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.296 Vali Acc: 0.646 Test Loss: 1.296 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0868104
	speed: 0.1377s/iter; left time: 4508.0389s
	iters: 200, epoch: 12 | loss: 0.0518098
	speed: 0.0320s/iter; left time: 1043.5525s
	iters: 300, epoch: 12 | loss: 0.1258131
	speed: 0.0323s/iter; left time: 1050.4564s
Epoch: 12 cost time: 12.714280366897583
Epoch: 12, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.338 Vali Acc: 0.644 Test Loss: 1.338 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0548907
	speed: 0.1408s/iter; left time: 4557.1494s
	iters: 200, epoch: 13 | loss: 0.0466905
	speed: 0.0327s/iter; left time: 1053.9184s
	iters: 300, epoch: 13 | loss: 0.0516103
	speed: 0.0323s/iter; left time: 1038.2463s
Epoch: 13 cost time: 12.662401676177979
Epoch: 13, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.475 Vali Acc: 0.631 Test Loss: 1.475 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0355536
	speed: 0.1255s/iter; left time: 4015.5618s
	iters: 200, epoch: 14 | loss: 0.4559202
	speed: 0.0259s/iter; left time: 825.1128s
	iters: 300, epoch: 14 | loss: 0.5623191
	speed: 0.0253s/iter; left time: 804.6034s
Epoch: 14 cost time: 10.128234386444092
Epoch: 14, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.511 Vali Acc: 0.646 Test Loss: 1.511 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1283327
	speed: 0.1210s/iter; left time: 3827.3707s
	iters: 200, epoch: 15 | loss: 0.0883852
	speed: 0.0246s/iter; left time: 776.8134s
	iters: 300, epoch: 15 | loss: 0.1773284
	speed: 0.0234s/iter; left time: 734.1045s
Epoch: 15 cost time: 9.471867561340332
Epoch: 15, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.512 Vali Acc: 0.643 Test Loss: 1.512 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6688422247446084
model parameter : 60946
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6203495
	speed: 0.0491s/iter; left time: 1806.3147s
	iters: 200, epoch: 1 | loss: 0.6168973
	speed: 0.0264s/iter; left time: 970.4613s
	iters: 300, epoch: 1 | loss: 0.8261190
	speed: 0.0270s/iter; left time: 986.8673s
Epoch: 1 cost time: 12.130306959152222
Epoch: 1, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.943 Vali Acc: 0.644 Test Loss: 0.943 Test Acc: 0.644
Validation loss decreased (inf --> -0.644429).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4821028
	speed: 0.1192s/iter; left time: 4344.0042s
	iters: 200, epoch: 2 | loss: 0.8020963
	speed: 0.0270s/iter; left time: 979.4104s
	iters: 300, epoch: 2 | loss: 1.1786797
	speed: 0.0273s/iter; left time: 988.8555s
Epoch: 2 cost time: 10.650907754898071
Epoch: 2, Steps: 369 | Train Loss: 0.656 Vali Loss: 1.037 Vali Acc: 0.644 Test Loss: 1.037 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9745448
	speed: 0.1115s/iter; left time: 4020.2257s
	iters: 200, epoch: 3 | loss: 0.5392108
	speed: 0.0213s/iter; left time: 765.5126s
	iters: 300, epoch: 3 | loss: 0.6211792
	speed: 0.0209s/iter; left time: 749.9151s
Epoch: 3 cost time: 8.4068443775177
Epoch: 3, Steps: 369 | Train Loss: 0.637 Vali Loss: 1.177 Vali Acc: 0.653 Test Loss: 1.177 Test Acc: 0.653
Validation loss decreased (-0.644429 --> -0.652656).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5055904
	speed: 0.1091s/iter; left time: 3893.5379s
	iters: 200, epoch: 4 | loss: 0.3664340
	speed: 0.0210s/iter; left time: 747.0596s
	iters: 300, epoch: 4 | loss: 0.2798724
	speed: 0.0215s/iter; left time: 762.8654s
Epoch: 4 cost time: 8.299299240112305
Epoch: 4, Steps: 369 | Train Loss: 0.612 Vali Loss: 1.234 Vali Acc: 0.661 Test Loss: 1.234 Test Acc: 0.661
Validation loss decreased (-0.652656 --> -0.660884).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6101173
	speed: 0.1191s/iter; left time: 4206.1324s
	iters: 200, epoch: 5 | loss: 0.4501458
	speed: 0.0214s/iter; left time: 754.4532s
	iters: 300, epoch: 5 | loss: 0.8037394
	speed: 0.0212s/iter; left time: 744.2177s
Epoch: 5 cost time: 8.356615781784058
Epoch: 5, Steps: 369 | Train Loss: 0.550 Vali Loss: 1.289 Vali Acc: 0.654 Test Loss: 1.289 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5015459
	speed: 0.1228s/iter; left time: 4293.3085s
	iters: 200, epoch: 6 | loss: 0.2037207
	speed: 0.0276s/iter; left time: 963.7458s
	iters: 300, epoch: 6 | loss: 1.1133811
	speed: 0.0279s/iter; left time: 969.3054s
Epoch: 6 cost time: 10.86250376701355
Epoch: 6, Steps: 369 | Train Loss: 0.460 Vali Loss: 1.250 Vali Acc: 0.643 Test Loss: 1.250 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3269208
	speed: 0.1249s/iter; left time: 4320.3306s
	iters: 200, epoch: 7 | loss: 0.0912470
	speed: 0.0281s/iter; left time: 968.4363s
	iters: 300, epoch: 7 | loss: 0.1649378
	speed: 0.0282s/iter; left time: 969.3130s
Epoch: 7 cost time: 11.08118748664856
Epoch: 7, Steps: 369 | Train Loss: 0.397 Vali Loss: 1.185 Vali Acc: 0.654 Test Loss: 1.185 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3952867
	speed: 0.1109s/iter; left time: 3796.1407s
	iters: 200, epoch: 8 | loss: 0.1552668
	speed: 0.0214s/iter; left time: 730.3045s
	iters: 300, epoch: 8 | loss: 0.6404119
	speed: 0.0215s/iter; left time: 731.5394s
Epoch: 8 cost time: 8.493119239807129
Epoch: 8, Steps: 369 | Train Loss: 0.339 Vali Loss: 1.164 Vali Acc: 0.661 Test Loss: 1.164 Test Acc: 0.661
Validation loss decreased (-0.660884 --> -0.660885).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2760297
	speed: 0.1117s/iter; left time: 3782.1016s
	iters: 200, epoch: 9 | loss: 0.5467752
	speed: 0.0207s/iter; left time: 699.1339s
	iters: 300, epoch: 9 | loss: 0.1755248
	speed: 0.0191s/iter; left time: 641.4018s
Epoch: 9 cost time: 8.195536613464355
Epoch: 9, Steps: 369 | Train Loss: 0.291 Vali Loss: 1.174 Vali Acc: 0.656 Test Loss: 1.174 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0517366
	speed: 0.1136s/iter; left time: 3803.1817s
	iters: 200, epoch: 10 | loss: 0.0973633
	speed: 0.0210s/iter; left time: 702.3553s
	iters: 300, epoch: 10 | loss: 0.1312211
	speed: 0.0213s/iter; left time: 707.9331s
Epoch: 10 cost time: 8.379626274108887
Epoch: 10, Steps: 369 | Train Loss: 0.263 Vali Loss: 1.179 Vali Acc: 0.654 Test Loss: 1.179 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4784765
	speed: 0.1203s/iter; left time: 3983.9114s
	iters: 200, epoch: 11 | loss: 0.0647428
	speed: 0.0289s/iter; left time: 954.5521s
	iters: 300, epoch: 11 | loss: 0.2282774
	speed: 0.0277s/iter; left time: 911.4780s
Epoch: 11 cost time: 10.882907152175903
Epoch: 11, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.215 Vali Acc: 0.658 Test Loss: 1.215 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1345044
	speed: 0.1214s/iter; left time: 3976.1808s
	iters: 200, epoch: 12 | loss: 0.1602510
	speed: 0.0278s/iter; left time: 907.5007s
	iters: 300, epoch: 12 | loss: 0.0537422
	speed: 0.0281s/iter; left time: 914.6724s
Epoch: 12 cost time: 10.896988153457642
Epoch: 12, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.263 Vali Acc: 0.657 Test Loss: 1.263 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1670877
	speed: 0.1195s/iter; left time: 3867.3742s
	iters: 200, epoch: 13 | loss: 0.1021153
	speed: 0.0264s/iter; left time: 852.4996s
	iters: 300, epoch: 13 | loss: 0.4164610
	speed: 0.0202s/iter; left time: 650.1951s
Epoch: 13 cost time: 9.677431106567383
Epoch: 13, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.341 Vali Acc: 0.655 Test Loss: 1.341 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1130405
	speed: 0.1126s/iter; left time: 3604.1986s
	iters: 200, epoch: 14 | loss: 0.1553392
	speed: 0.0217s/iter; left time: 693.5674s
	iters: 300, epoch: 14 | loss: 0.1139594
	speed: 0.0223s/iter; left time: 709.5749s
Epoch: 14 cost time: 8.872381925582886
Epoch: 14, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.321 Vali Acc: 0.661 Test Loss: 1.321 Test Acc: 0.661
Validation loss decreased (-0.660885 --> -0.661451).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0616554
	speed: 0.1077s/iter; left time: 3405.9007s
	iters: 200, epoch: 15 | loss: 0.1368912
	speed: 0.0223s/iter; left time: 704.7154s
	iters: 300, epoch: 15 | loss: 0.1809628
	speed: 0.0213s/iter; left time: 669.4339s
Epoch: 15 cost time: 8.70967149734497
Epoch: 15, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.427 Vali Acc: 0.644 Test Loss: 1.427 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0251191
	speed: 0.1050s/iter; left time: 3282.6653s
	iters: 200, epoch: 16 | loss: 0.0191715
	speed: 0.0169s/iter; left time: 527.4997s
	iters: 300, epoch: 16 | loss: 0.0765555
	speed: 0.0175s/iter; left time: 542.5869s
Epoch: 16 cost time: 7.015868425369263
Epoch: 16, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.437 Vali Acc: 0.649 Test Loss: 1.437 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0782018
	speed: 0.1007s/iter; left time: 3111.2788s
	iters: 200, epoch: 17 | loss: 0.0524656
	speed: 0.0233s/iter; left time: 717.0620s
	iters: 300, epoch: 17 | loss: 0.4700266
	speed: 0.0232s/iter; left time: 711.6832s
Epoch: 17 cost time: 8.742498874664307
Epoch: 17, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.511 Vali Acc: 0.650 Test Loss: 1.511 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0442011
	speed: 0.0880s/iter; left time: 2686.7986s
	iters: 200, epoch: 18 | loss: 0.1034249
	speed: 0.0171s/iter; left time: 519.4256s
	iters: 300, epoch: 18 | loss: 0.0511250
	speed: 0.0175s/iter; left time: 529.8889s
Epoch: 18 cost time: 6.902649641036987
Epoch: 18, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.617 Vali Acc: 0.649 Test Loss: 1.617 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0495419
	speed: 0.0957s/iter; left time: 2887.4482s
	iters: 200, epoch: 19 | loss: 0.1687924
	speed: 0.0179s/iter; left time: 539.2747s
	iters: 300, epoch: 19 | loss: 0.1478348
	speed: 0.0186s/iter; left time: 558.0773s
Epoch: 19 cost time: 7.4407057762146
Epoch: 19, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.644 Vali Acc: 0.646 Test Loss: 1.644 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0267999
	speed: 0.1044s/iter; left time: 3110.0341s
	iters: 200, epoch: 20 | loss: 0.1514906
	speed: 0.0275s/iter; left time: 817.2356s
	iters: 300, epoch: 20 | loss: 0.0457173
	speed: 0.0280s/iter; left time: 828.7125s
Epoch: 20 cost time: 10.331965923309326
Epoch: 20, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.699 Vali Acc: 0.637 Test Loss: 1.699 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0705775
	speed: 0.1348s/iter; left time: 3966.0405s
	iters: 200, epoch: 21 | loss: 0.0539123
	speed: 0.0281s/iter; left time: 824.0059s
	iters: 300, epoch: 21 | loss: 0.1325165
	speed: 0.0283s/iter; left time: 825.7605s
Epoch: 21 cost time: 11.262925863265991
Epoch: 21, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.745 Vali Acc: 0.636 Test Loss: 1.745 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0372256
	speed: 0.1258s/iter; left time: 3653.8224s
	iters: 200, epoch: 22 | loss: 0.1987063
	speed: 0.0289s/iter; left time: 836.1104s
	iters: 300, epoch: 22 | loss: 0.3706719
	speed: 0.0293s/iter; left time: 845.3313s
Epoch: 22 cost time: 10.93372893333435
Epoch: 22, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.730 Vali Acc: 0.650 Test Loss: 1.730 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0054258
	speed: 0.1177s/iter; left time: 3375.1763s
	iters: 200, epoch: 23 | loss: 0.1824847
	speed: 0.0215s/iter; left time: 615.5019s
	iters: 300, epoch: 23 | loss: 0.1360066
	speed: 0.0218s/iter; left time: 621.8943s
Epoch: 23 cost time: 8.80154800415039
Epoch: 23, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.865 Vali Acc: 0.640 Test Loss: 1.865 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4522089
	speed: 0.1223s/iter; left time: 3461.5741s
	iters: 200, epoch: 24 | loss: 0.3563679
	speed: 0.0227s/iter; left time: 640.4624s
	iters: 300, epoch: 24 | loss: 0.1700353
	speed: 0.0223s/iter; left time: 626.3478s
Epoch: 24 cost time: 9.006290435791016
Epoch: 24, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.854 Vali Acc: 0.645 Test Loss: 1.854 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6614642451759364
model parameter : 51778
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6429908
	speed: 0.1348s/iter; left time: 4960.3835s
	iters: 200, epoch: 1 | loss: 1.4531418
	speed: 0.1049s/iter; left time: 3850.8765s
	iters: 300, epoch: 1 | loss: 1.7684003
	speed: 0.1023s/iter; left time: 3744.9490s
Epoch: 1 cost time: 41.18801212310791
Epoch: 1, Steps: 369 | Train Loss: 1.395 Vali Loss: 1.603 Vali Acc: 0.617 Test Loss: 1.603 Test Acc: 0.617
Validation loss decreased (inf --> -0.617180).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3372064
	speed: 0.3417s/iter; left time: 12447.0935s
	iters: 200, epoch: 2 | loss: 0.8389729
	speed: 0.1120s/iter; left time: 4067.7094s
	iters: 300, epoch: 2 | loss: 1.8616604
	speed: 0.1162s/iter; left time: 4208.4984s
Epoch: 2 cost time: 41.234745502471924
Epoch: 2, Steps: 369 | Train Loss: 1.770 Vali Loss: 1.801 Vali Acc: 0.648 Test Loss: 1.801 Test Acc: 0.648
Validation loss decreased (-0.617180 --> -0.647542).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6992600
	speed: 0.4020s/iter; left time: 14497.8659s
	iters: 200, epoch: 3 | loss: 2.5620000
	speed: 0.1051s/iter; left time: 3781.4989s
	iters: 300, epoch: 3 | loss: 2.7930143
	speed: 0.1005s/iter; left time: 3603.4616s
Epoch: 3 cost time: 39.724470376968384
Epoch: 3, Steps: 369 | Train Loss: 1.778 Vali Loss: 2.897 Vali Acc: 0.652 Test Loss: 2.897 Test Acc: 0.652
Validation loss decreased (-0.647542 --> -0.652071).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4295578
	speed: 0.3413s/iter; left time: 12183.8145s
	iters: 200, epoch: 4 | loss: 2.6157653
	speed: 0.1019s/iter; left time: 3628.6213s
	iters: 300, epoch: 4 | loss: 1.4775877
	speed: 0.1129s/iter; left time: 4007.2973s
Epoch: 4 cost time: 39.811992168426514
Epoch: 4, Steps: 369 | Train Loss: 1.459 Vali Loss: 2.774 Vali Acc: 0.638 Test Loss: 2.774 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4356936
	speed: 0.3850s/iter; left time: 13600.6367s
	iters: 200, epoch: 5 | loss: 1.4415436
	speed: 0.1104s/iter; left time: 3888.5123s
	iters: 300, epoch: 5 | loss: 1.3611894
	speed: 0.0937s/iter; left time: 3291.4217s
Epoch: 5 cost time: 38.63425612449646
Epoch: 5, Steps: 369 | Train Loss: 0.883 Vali Loss: 2.572 Vali Acc: 0.630 Test Loss: 2.572 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0523667
	speed: 0.3297s/iter; left time: 11525.4786s
	iters: 200, epoch: 6 | loss: 0.1445424
	speed: 0.0930s/iter; left time: 3242.4780s
	iters: 300, epoch: 6 | loss: 0.4684555
	speed: 0.0961s/iter; left time: 3340.8210s
Epoch: 6 cost time: 36.91342210769653
Epoch: 6, Steps: 369 | Train Loss: 0.442 Vali Loss: 1.877 Vali Acc: 0.636 Test Loss: 1.877 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0081422
	speed: 0.3876s/iter; left time: 13406.4967s
	iters: 200, epoch: 7 | loss: 0.3189700
	speed: 0.1167s/iter; left time: 4024.1347s
	iters: 300, epoch: 7 | loss: 0.1923252
	speed: 0.1161s/iter; left time: 3991.0389s
Epoch: 7 cost time: 42.102036237716675
Epoch: 7, Steps: 369 | Train Loss: 0.241 Vali Loss: 1.832 Vali Acc: 0.630 Test Loss: 1.832 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0643638
	speed: 0.3423s/iter; left time: 11713.7804s
	iters: 200, epoch: 8 | loss: 0.1015946
	speed: 0.0991s/iter; left time: 3380.1967s
	iters: 300, epoch: 8 | loss: 0.0361109
	speed: 0.0973s/iter; left time: 3310.1410s
Epoch: 8 cost time: 37.701587438583374
Epoch: 8, Steps: 369 | Train Loss: 0.163 Vali Loss: 2.005 Vali Acc: 0.632 Test Loss: 2.005 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0596635
	speed: 0.3832s/iter; left time: 12970.8816s
	iters: 200, epoch: 9 | loss: 0.0127047
	speed: 0.1141s/iter; left time: 3852.3937s
	iters: 300, epoch: 9 | loss: 0.0567530
	speed: 0.1141s/iter; left time: 3838.2164s
Epoch: 9 cost time: 42.592522621154785
Epoch: 9, Steps: 369 | Train Loss: 0.107 Vali Loss: 2.006 Vali Acc: 0.639 Test Loss: 2.006 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0222603
	speed: 0.3468s/iter; left time: 11611.7259s
	iters: 200, epoch: 10 | loss: 0.0989875
	speed: 0.0956s/iter; left time: 3191.8940s
	iters: 300, epoch: 10 | loss: 0.0182659
	speed: 0.0981s/iter; left time: 3263.8858s
Epoch: 10 cost time: 36.195876359939575
Epoch: 10, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.448 Vali Acc: 0.634 Test Loss: 2.448 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3428931
	speed: 0.3743s/iter; left time: 12392.2242s
	iters: 200, epoch: 11 | loss: 0.0117870
	speed: 0.1146s/iter; left time: 3784.3348s
	iters: 300, epoch: 11 | loss: 0.0731605
	speed: 0.1135s/iter; left time: 3733.7769s
Epoch: 11 cost time: 42.65439319610596
Epoch: 11, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.929 Vali Acc: 0.640 Test Loss: 1.929 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2382725
	speed: 0.3553s/iter; left time: 11632.8075s
	iters: 200, epoch: 12 | loss: 0.0908700
	speed: 0.0942s/iter; left time: 3076.4330s
	iters: 300, epoch: 12 | loss: 0.0069613
	speed: 0.0961s/iter; left time: 3127.1471s
Epoch: 12 cost time: 36.34410810470581
Epoch: 12, Steps: 369 | Train Loss: 0.077 Vali Loss: 1.930 Vali Acc: 0.640 Test Loss: 1.930 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0071210
	speed: 0.3700s/iter; left time: 11978.2376s
	iters: 200, epoch: 13 | loss: 0.0202118
	speed: 0.1138s/iter; left time: 3673.2080s
	iters: 300, epoch: 13 | loss: 0.0070271
	speed: 0.1160s/iter; left time: 3730.8157s
Epoch: 13 cost time: 42.99389624595642
Epoch: 13, Steps: 369 | Train Loss: 0.042 Vali Loss: 2.291 Vali Acc: 0.644 Test Loss: 2.291 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6520998864926221
model parameter : 296546
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6137896
	speed: 0.0627s/iter; left time: 2306.4942s
	iters: 200, epoch: 1 | loss: 1.4041874
	speed: 0.0495s/iter; left time: 1815.8901s
	iters: 300, epoch: 1 | loss: 1.2275662
	speed: 0.0558s/iter; left time: 2041.8899s
Epoch: 1 cost time: 20.815104484558105
Epoch: 1, Steps: 369 | Train Loss: 1.053 Vali Loss: 1.302 Vali Acc: 0.632 Test Loss: 1.302 Test Acc: 0.632
Validation loss decreased (inf --> -0.631939).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9131680
	speed: 0.2271s/iter; left time: 8273.2068s
	iters: 200, epoch: 2 | loss: 0.4496671
	speed: 0.0574s/iter; left time: 2085.1423s
	iters: 300, epoch: 2 | loss: 2.3600445
	speed: 0.0577s/iter; left time: 2091.6452s
Epoch: 2 cost time: 21.803021907806396
Epoch: 2, Steps: 369 | Train Loss: 1.128 Vali Loss: 1.376 Vali Acc: 0.662 Test Loss: 1.376 Test Acc: 0.662
Validation loss decreased (-0.631939 --> -0.661734).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8268706
	speed: 0.2054s/iter; left time: 7407.6317s
	iters: 200, epoch: 3 | loss: 1.0856144
	speed: 0.0461s/iter; left time: 1659.4764s
	iters: 300, epoch: 3 | loss: 0.8994690
	speed: 0.0464s/iter; left time: 1665.2413s
Epoch: 3 cost time: 17.672039270401
Epoch: 3, Steps: 369 | Train Loss: 1.218 Vali Loss: 2.007 Vali Acc: 0.650 Test Loss: 2.007 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2114956
	speed: 0.1930s/iter; left time: 6887.9716s
	iters: 200, epoch: 4 | loss: 0.8030783
	speed: 0.0474s/iter; left time: 1686.1821s
	iters: 300, epoch: 4 | loss: 1.3154457
	speed: 0.0460s/iter; left time: 1633.1165s
Epoch: 4 cost time: 18.041558027267456
Epoch: 4, Steps: 369 | Train Loss: 1.075 Vali Loss: 1.910 Vali Acc: 0.638 Test Loss: 1.910 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9675324
	speed: 0.2078s/iter; left time: 7341.2498s
	iters: 200, epoch: 5 | loss: 1.1928161
	speed: 0.0569s/iter; left time: 2003.4839s
	iters: 300, epoch: 5 | loss: 0.5010988
	speed: 0.0561s/iter; left time: 1969.5543s
Epoch: 5 cost time: 21.41621994972229
Epoch: 5, Steps: 369 | Train Loss: 0.774 Vali Loss: 2.319 Vali Acc: 0.629 Test Loss: 2.319 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2674315
	speed: 0.2194s/iter; left time: 7671.0117s
	iters: 200, epoch: 6 | loss: 0.6961284
	speed: 0.0566s/iter; left time: 1971.8205s
	iters: 300, epoch: 6 | loss: 0.3792291
	speed: 0.0561s/iter; left time: 1948.3492s
Epoch: 6 cost time: 20.83092975616455
Epoch: 6, Steps: 369 | Train Loss: 0.439 Vali Loss: 1.705 Vali Acc: 0.638 Test Loss: 1.705 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0635115
	speed: 0.1886s/iter; left time: 6523.5140s
	iters: 200, epoch: 7 | loss: 0.8383563
	speed: 0.0467s/iter; left time: 1609.8767s
	iters: 300, epoch: 7 | loss: 0.5923395
	speed: 0.0459s/iter; left time: 1579.5986s
Epoch: 7 cost time: 17.175122022628784
Epoch: 7, Steps: 369 | Train Loss: 0.293 Vali Loss: 1.501 Vali Acc: 0.641 Test Loss: 1.501 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.3527120
	speed: 0.1956s/iter; left time: 6693.7536s
	iters: 200, epoch: 8 | loss: 0.6287876
	speed: 0.0464s/iter; left time: 1584.2986s
	iters: 300, epoch: 8 | loss: 0.2232200
	speed: 0.0463s/iter; left time: 1573.9599s
Epoch: 8 cost time: 17.653717041015625
Epoch: 8, Steps: 369 | Train Loss: 0.244 Vali Loss: 1.405 Vali Acc: 0.646 Test Loss: 1.405 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1375832
	speed: 0.2095s/iter; left time: 7091.7788s
	iters: 200, epoch: 9 | loss: 0.0418336
	speed: 0.0576s/iter; left time: 1944.1346s
	iters: 300, epoch: 9 | loss: 0.2380001
	speed: 0.0572s/iter; left time: 1924.3412s
Epoch: 9 cost time: 21.731784343719482
Epoch: 9, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.531 Vali Acc: 0.648 Test Loss: 1.531 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1304692
	speed: 0.2150s/iter; left time: 7197.3864s
	iters: 200, epoch: 10 | loss: 0.1778170
	speed: 0.0574s/iter; left time: 1914.4671s
	iters: 300, epoch: 10 | loss: 0.1138438
	speed: 0.0515s/iter; left time: 1714.7366s
Epoch: 10 cost time: 20.34693741798401
Epoch: 10, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.665 Vali Acc: 0.637 Test Loss: 1.665 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0176572
	speed: 0.1907s/iter; left time: 6315.0659s
	iters: 200, epoch: 11 | loss: 0.0145785
	speed: 0.0475s/iter; left time: 1567.3401s
	iters: 300, epoch: 11 | loss: 0.0333922
	speed: 0.0443s/iter; left time: 1459.5803s
Epoch: 11 cost time: 17.520339965820312
Epoch: 11, Steps: 369 | Train Loss: 0.085 Vali Loss: 1.968 Vali Acc: 0.641 Test Loss: 1.968 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0410973
	speed: 0.1915s/iter; left time: 6269.6286s
	iters: 200, epoch: 12 | loss: 0.0932384
	speed: 0.0473s/iter; left time: 1543.8392s
	iters: 300, epoch: 12 | loss: 0.0070323
	speed: 0.0496s/iter; left time: 1614.4563s
Epoch: 12 cost time: 18.96156930923462
Epoch: 12, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.859 Vali Acc: 0.643 Test Loss: 1.859 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6617480136208853
model parameter : 153730
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7100939
	speed: 0.0544s/iter; left time: 2000.6783s
	iters: 200, epoch: 1 | loss: 0.3685196
	speed: 0.0357s/iter; left time: 1311.6905s
	iters: 300, epoch: 1 | loss: 1.0668715
	speed: 0.0347s/iter; left time: 1269.8492s
Epoch: 1 cost time: 15.022808313369751
Epoch: 1, Steps: 369 | Train Loss: 0.919 Vali Loss: 1.390 Vali Acc: 0.639 Test Loss: 1.390 Test Acc: 0.639
Validation loss decreased (inf --> -0.639316).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9937598
	speed: 0.1536s/iter; left time: 5594.2114s
	iters: 200, epoch: 2 | loss: 0.5816460
	speed: 0.0349s/iter; left time: 1269.3723s
	iters: 300, epoch: 2 | loss: 1.2812126
	speed: 0.0353s/iter; left time: 1280.3957s
Epoch: 2 cost time: 13.58467411994934
Epoch: 2, Steps: 369 | Train Loss: 0.944 Vali Loss: 1.707 Vali Acc: 0.621 Test Loss: 1.707 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5307262
	speed: 0.1549s/iter; left time: 5586.4892s
	iters: 200, epoch: 3 | loss: 2.2896903
	speed: 0.0428s/iter; left time: 1538.0310s
	iters: 300, epoch: 3 | loss: 0.2652048
	speed: 0.0425s/iter; left time: 1523.2207s
Epoch: 3 cost time: 15.491174697875977
Epoch: 3, Steps: 369 | Train Loss: 0.890 Vali Loss: 1.845 Vali Acc: 0.634 Test Loss: 1.845 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.3796631
	speed: 0.1736s/iter; left time: 6196.5510s
	iters: 200, epoch: 4 | loss: 0.7299697
	speed: 0.0424s/iter; left time: 1508.9647s
	iters: 300, epoch: 4 | loss: 0.4590800
	speed: 0.0424s/iter; left time: 1504.5428s
Epoch: 4 cost time: 16.174156665802002
Epoch: 4, Steps: 369 | Train Loss: 0.791 Vali Loss: 2.023 Vali Acc: 0.648 Test Loss: 2.023 Test Acc: 0.648
Validation loss decreased (-0.639316 --> -0.647823).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8054575
	speed: 0.1826s/iter; left time: 6449.9471s
	iters: 200, epoch: 5 | loss: 0.3383923
	speed: 0.0385s/iter; left time: 1357.1836s
	iters: 300, epoch: 5 | loss: 1.2180538
	speed: 0.0347s/iter; left time: 1218.8370s
Epoch: 5 cost time: 14.549378395080566
Epoch: 5, Steps: 369 | Train Loss: 0.613 Vali Loss: 2.005 Vali Acc: 0.650 Test Loss: 2.005 Test Acc: 0.650
Validation loss decreased (-0.647823 --> -0.650377).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8362732
	speed: 0.1602s/iter; left time: 5598.6186s
	iters: 200, epoch: 6 | loss: 0.7969437
	speed: 0.0367s/iter; left time: 1279.6729s
	iters: 300, epoch: 6 | loss: 0.3482797
	speed: 0.0358s/iter; left time: 1243.1599s
Epoch: 6 cost time: 13.769235610961914
Epoch: 6, Steps: 369 | Train Loss: 0.448 Vali Loss: 1.672 Vali Acc: 0.653 Test Loss: 1.672 Test Acc: 0.653
Validation loss decreased (-0.650377 --> -0.652651).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7748224
	speed: 0.1522s/iter; left time: 5263.7862s
	iters: 200, epoch: 7 | loss: 0.3000742
	speed: 0.0373s/iter; left time: 1286.4614s
	iters: 300, epoch: 7 | loss: 0.2727078
	speed: 0.0380s/iter; left time: 1308.2760s
Epoch: 7 cost time: 14.185904741287231
Epoch: 7, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.610 Vali Acc: 0.642 Test Loss: 1.610 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1487791
	speed: 0.1652s/iter; left time: 5651.9673s
	iters: 200, epoch: 8 | loss: 0.1144552
	speed: 0.0429s/iter; left time: 1462.6506s
	iters: 300, epoch: 8 | loss: 0.0539312
	speed: 0.0430s/iter; left time: 1463.6498s
Epoch: 8 cost time: 16.387298822402954
Epoch: 8, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.602 Vali Acc: 0.641 Test Loss: 1.602 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1508128
	speed: 0.1811s/iter; left time: 6128.4765s
	iters: 200, epoch: 9 | loss: 0.3967864
	speed: 0.0429s/iter; left time: 1448.1715s
	iters: 300, epoch: 9 | loss: 0.5086477
	speed: 0.0431s/iter; left time: 1451.4885s
Epoch: 9 cost time: 16.43676733970642
Epoch: 9, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.516 Vali Acc: 0.645 Test Loss: 1.516 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0261185
	speed: 0.1640s/iter; left time: 5491.8609s
	iters: 200, epoch: 10 | loss: 0.1337913
	speed: 0.0372s/iter; left time: 1240.6378s
	iters: 300, epoch: 10 | loss: 0.1635186
	speed: 0.0356s/iter; left time: 1185.2100s
Epoch: 10 cost time: 13.875257968902588
Epoch: 10, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.621 Vali Acc: 0.646 Test Loss: 1.621 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1610676
	speed: 0.1541s/iter; left time: 5102.1755s
	iters: 200, epoch: 11 | loss: 0.0026452
	speed: 0.0360s/iter; left time: 1190.0248s
	iters: 300, epoch: 11 | loss: 0.0591847
	speed: 0.0366s/iter; left time: 1203.1251s
Epoch: 11 cost time: 14.057351350784302
Epoch: 11, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.793 Vali Acc: 0.626 Test Loss: 1.793 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0416413
	speed: 0.1640s/iter; left time: 5369.3000s
	iters: 200, epoch: 12 | loss: 0.0360687
	speed: 0.0433s/iter; left time: 1414.9501s
	iters: 300, epoch: 12 | loss: 0.0226922
	speed: 0.0436s/iter; left time: 1417.4661s
Epoch: 12 cost time: 16.528266668319702
Epoch: 12, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.762 Vali Acc: 0.651 Test Loss: 1.762 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0273810
	speed: 0.1801s/iter; left time: 5829.3001s
	iters: 200, epoch: 13 | loss: 0.1417825
	speed: 0.0432s/iter; left time: 1394.5413s
	iters: 300, epoch: 13 | loss: 0.0232881
	speed: 0.0437s/iter; left time: 1404.7068s
Epoch: 13 cost time: 16.67749857902527
Epoch: 13, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.883 Vali Acc: 0.648 Test Loss: 1.883 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0040434
	speed: 0.1751s/iter; left time: 5604.5931s
	iters: 200, epoch: 14 | loss: 0.1193811
	speed: 0.0367s/iter; left time: 1171.4838s
	iters: 300, epoch: 14 | loss: 0.0084509
	speed: 0.0362s/iter; left time: 1150.6059s
Epoch: 14 cost time: 14.573140621185303
Epoch: 14, Steps: 369 | Train Loss: 0.066 Vali Loss: 1.973 Vali Acc: 0.627 Test Loss: 1.973 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0431221
	speed: 0.1571s/iter; left time: 4970.2323s
	iters: 200, epoch: 15 | loss: 0.0087406
	speed: 0.0357s/iter; left time: 1126.2162s
	iters: 300, epoch: 15 | loss: 0.0002722
	speed: 0.0341s/iter; left time: 1070.7902s
Epoch: 15 cost time: 13.46434736251831
Epoch: 15, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.164 Vali Acc: 0.637 Test Loss: 2.164 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0365207
	speed: 0.1652s/iter; left time: 5165.5643s
	iters: 200, epoch: 16 | loss: 0.0004213
	speed: 0.0348s/iter; left time: 1084.2364s
	iters: 300, epoch: 16 | loss: 0.1100611
	speed: 0.0351s/iter; left time: 1089.0375s
Epoch: 16 cost time: 13.469579696655273
Epoch: 16, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.219 Vali Acc: 0.631 Test Loss: 2.219 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 107666
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7930091
	speed: 0.0439s/iter; left time: 1615.1811s
	iters: 200, epoch: 1 | loss: 0.3120175
	speed: 0.0275s/iter; left time: 1009.8784s
	iters: 300, epoch: 1 | loss: 0.7535203
	speed: 0.0274s/iter; left time: 1003.4313s
Epoch: 1 cost time: 11.922018766403198
Epoch: 1, Steps: 369 | Train Loss: 0.830 Vali Loss: 1.233 Vali Acc: 0.633 Test Loss: 1.233 Test Acc: 0.633
Validation loss decreased (inf --> -0.632791).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8905227
	speed: 0.1288s/iter; left time: 4691.9617s
	iters: 200, epoch: 2 | loss: 0.9703904
	speed: 0.0273s/iter; left time: 990.9561s
	iters: 300, epoch: 2 | loss: 1.3975925
	speed: 0.0258s/iter; left time: 936.3642s
Epoch: 2 cost time: 10.495594263076782
Epoch: 2, Steps: 369 | Train Loss: 0.904 Vali Loss: 1.501 Vali Acc: 0.635 Test Loss: 1.501 Test Acc: 0.635
Validation loss decreased (-0.632791 --> -0.634775).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2825099
	speed: 0.1437s/iter; left time: 5181.7755s
	iters: 200, epoch: 3 | loss: 0.1014898
	speed: 0.0260s/iter; left time: 934.4371s
	iters: 300, epoch: 3 | loss: 0.5598883
	speed: 0.0261s/iter; left time: 935.1431s
Epoch: 3 cost time: 10.356446266174316
Epoch: 3, Steps: 369 | Train Loss: 0.779 Vali Loss: 2.173 Vali Acc: 0.603 Test Loss: 2.173 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4621325
	speed: 0.1459s/iter; left time: 5209.1742s
	iters: 200, epoch: 4 | loss: 1.0765119
	speed: 0.0351s/iter; left time: 1247.6020s
	iters: 300, epoch: 4 | loss: 0.3112144
	speed: 0.0355s/iter; left time: 1260.5629s
Epoch: 4 cost time: 13.616224527359009
Epoch: 4, Steps: 369 | Train Loss: 0.731 Vali Loss: 1.708 Vali Acc: 0.650 Test Loss: 1.708 Test Acc: 0.650
Validation loss decreased (-0.634775 --> -0.649529).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3694812
	speed: 0.1531s/iter; left time: 5408.0346s
	iters: 200, epoch: 5 | loss: 0.2905605
	speed: 0.0356s/iter; left time: 1254.0211s
	iters: 300, epoch: 5 | loss: 0.4326863
	speed: 0.0353s/iter; left time: 1239.6861s
Epoch: 5 cost time: 13.712027072906494
Epoch: 5, Steps: 369 | Train Loss: 0.564 Vali Loss: 1.732 Vali Acc: 0.636 Test Loss: 1.732 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2248514
	speed: 0.1390s/iter; left time: 4858.4050s
	iters: 200, epoch: 6 | loss: 0.8051448
	speed: 0.0278s/iter; left time: 967.7846s
	iters: 300, epoch: 6 | loss: 0.4041325
	speed: 0.0273s/iter; left time: 949.8924s
Epoch: 6 cost time: 10.651561260223389
Epoch: 6, Steps: 369 | Train Loss: 0.412 Vali Loss: 1.523 Vali Acc: 0.642 Test Loss: 1.523 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5395331
	speed: 0.1318s/iter; left time: 4560.1210s
	iters: 200, epoch: 7 | loss: 0.1033982
	speed: 0.0278s/iter; left time: 957.0383s
	iters: 300, epoch: 7 | loss: 0.4776259
	speed: 0.0251s/iter; left time: 864.8275s
Epoch: 7 cost time: 10.716634035110474
Epoch: 7, Steps: 369 | Train Loss: 0.321 Vali Loss: 1.521 Vali Acc: 0.636 Test Loss: 1.521 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1294868
	speed: 0.1348s/iter; left time: 4613.4587s
	iters: 200, epoch: 8 | loss: 0.2228548
	speed: 0.0283s/iter; left time: 965.4633s
	iters: 300, epoch: 8 | loss: 0.8380941
	speed: 0.0276s/iter; left time: 937.7153s
Epoch: 8 cost time: 10.939989805221558
Epoch: 8, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.556 Vali Acc: 0.627 Test Loss: 1.556 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1184010
	speed: 0.1428s/iter; left time: 4835.2404s
	iters: 200, epoch: 9 | loss: 0.1706433
	speed: 0.0357s/iter; left time: 1203.5409s
	iters: 300, epoch: 9 | loss: 0.2525859
	speed: 0.0356s/iter; left time: 1196.4633s
Epoch: 9 cost time: 13.850535154342651
Epoch: 9, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.428 Vali Acc: 0.632 Test Loss: 1.428 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0131776
	speed: 0.1528s/iter; left time: 5114.5496s
	iters: 200, epoch: 10 | loss: 0.0251147
	speed: 0.0357s/iter; left time: 1192.4100s
	iters: 300, epoch: 10 | loss: 0.3153654
	speed: 0.0355s/iter; left time: 1180.3378s
Epoch: 10 cost time: 13.802777290344238
Epoch: 10, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.512 Vali Acc: 0.650 Test Loss: 1.512 Test Acc: 0.650
Validation loss decreased (-0.649529 --> -0.650382).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2200940
	speed: 0.1416s/iter; left time: 4686.9980s
	iters: 200, epoch: 11 | loss: 0.0421845
	speed: 0.0274s/iter; left time: 905.7970s
	iters: 300, epoch: 11 | loss: 0.2113121
	speed: 0.0274s/iter; left time: 901.3558s
Epoch: 11 cost time: 10.846181631088257
Epoch: 11, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.801 Vali Acc: 0.629 Test Loss: 1.801 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0075855
	speed: 0.1346s/iter; left time: 4406.6265s
	iters: 200, epoch: 12 | loss: 0.1157736
	speed: 0.0251s/iter; left time: 819.3979s
	iters: 300, epoch: 12 | loss: 0.1053195
	speed: 0.0270s/iter; left time: 877.3991s
Epoch: 12 cost time: 10.416785717010498
Epoch: 12, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.718 Vali Acc: 0.645 Test Loss: 1.718 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0404097
	speed: 0.1351s/iter; left time: 4373.7154s
	iters: 200, epoch: 13 | loss: 0.0513090
	speed: 0.0270s/iter; left time: 871.9269s
	iters: 300, epoch: 13 | loss: 0.0520372
	speed: 0.0267s/iter; left time: 859.1365s
Epoch: 13 cost time: 10.631759643554688
Epoch: 13, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.817 Vali Acc: 0.635 Test Loss: 1.817 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0168070
	speed: 0.1443s/iter; left time: 4619.3681s
	iters: 200, epoch: 14 | loss: 0.1923697
	speed: 0.0352s/iter; left time: 1123.7649s
	iters: 300, epoch: 14 | loss: 0.0439831
	speed: 0.0355s/iter; left time: 1130.2658s
Epoch: 14 cost time: 13.803844213485718
Epoch: 14, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.796 Vali Acc: 0.642 Test Loss: 1.796 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0247105
	speed: 0.1461s/iter; left time: 4622.7247s
	iters: 200, epoch: 15 | loss: 0.0017907
	speed: 0.0358s/iter; left time: 1129.0594s
	iters: 300, epoch: 15 | loss: 0.0069870
	speed: 0.0355s/iter; left time: 1116.3389s
Epoch: 15 cost time: 13.761388301849365
Epoch: 15, Steps: 369 | Train Loss: 0.081 Vali Loss: 1.899 Vali Acc: 0.635 Test Loss: 1.899 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1217435
	speed: 0.1360s/iter; left time: 4252.8549s
	iters: 200, epoch: 16 | loss: 0.0070043
	speed: 0.0272s/iter; left time: 846.7045s
	iters: 300, epoch: 16 | loss: 0.2651481
	speed: 0.0273s/iter; left time: 848.3625s
Epoch: 16 cost time: 10.571882963180542
Epoch: 16, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.998 Vali Acc: 0.647 Test Loss: 1.998 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0804910
	speed: 0.1362s/iter; left time: 4207.7116s
	iters: 200, epoch: 17 | loss: 0.0383753
	speed: 0.0247s/iter; left time: 761.6124s
	iters: 300, epoch: 17 | loss: 0.0823314
	speed: 0.0260s/iter; left time: 797.8555s
Epoch: 17 cost time: 10.324629306793213
Epoch: 17, Steps: 369 | Train Loss: 0.081 Vali Loss: 2.039 Vali Acc: 0.648 Test Loss: 2.039 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0561971
	speed: 0.1401s/iter; left time: 4277.7173s
	iters: 200, epoch: 18 | loss: 0.0175487
	speed: 0.0268s/iter; left time: 814.8803s
	iters: 300, epoch: 18 | loss: 0.1038952
	speed: 0.0263s/iter; left time: 798.5500s
Epoch: 18 cost time: 10.490939378738403
Epoch: 18, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.115 Vali Acc: 0.636 Test Loss: 2.115 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0049622
	speed: 0.1529s/iter; left time: 4610.3430s
	iters: 200, epoch: 19 | loss: 0.1829515
	speed: 0.0350s/iter; left time: 1052.3170s
	iters: 300, epoch: 19 | loss: 0.0112296
	speed: 0.0350s/iter; left time: 1048.3614s
Epoch: 19 cost time: 13.58752703666687
Epoch: 19, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.147 Vali Acc: 0.629 Test Loss: 2.147 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0149004
	speed: 0.1498s/iter; left time: 4463.3394s
	iters: 200, epoch: 20 | loss: 0.3412680
	speed: 0.0362s/iter; left time: 1074.8360s
	iters: 300, epoch: 20 | loss: 0.0034824
	speed: 0.0362s/iter; left time: 1071.1329s
Epoch: 20 cost time: 13.972477436065674
Epoch: 20, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.148 Vali Acc: 0.639 Test Loss: 2.148 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6503972758229285
model parameter : 80050
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7460250
	speed: 0.0420s/iter; left time: 1545.9033s
	iters: 200, epoch: 1 | loss: 0.6873943
	speed: 0.0225s/iter; left time: 827.4849s
	iters: 300, epoch: 1 | loss: 0.4823928
	speed: 0.0228s/iter; left time: 836.0307s
Epoch: 1 cost time: 10.416562557220459
Epoch: 1, Steps: 369 | Train Loss: 0.777 Vali Loss: 1.170 Vali Acc: 0.628 Test Loss: 1.170 Test Acc: 0.628
Validation loss decreased (inf --> -0.627684).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7921088
	speed: 0.1190s/iter; left time: 4336.2341s
	iters: 200, epoch: 2 | loss: 0.3789586
	speed: 0.0265s/iter; left time: 964.6057s
	iters: 300, epoch: 2 | loss: 0.7268668
	speed: 0.0267s/iter; left time: 967.6295s
Epoch: 2 cost time: 10.275102138519287
Epoch: 2, Steps: 369 | Train Loss: 0.777 Vali Loss: 1.352 Vali Acc: 0.626 Test Loss: 1.352 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2091087
	speed: 0.1057s/iter; left time: 3812.5832s
	iters: 200, epoch: 3 | loss: 0.9395490
	speed: 0.0191s/iter; left time: 685.9442s
	iters: 300, epoch: 3 | loss: 0.6037000
	speed: 0.0196s/iter; left time: 701.3757s
Epoch: 3 cost time: 7.927793741226196
Epoch: 3, Steps: 369 | Train Loss: 0.696 Vali Loss: 1.454 Vali Acc: 0.643 Test Loss: 1.454 Test Acc: 0.643
Validation loss decreased (-0.627684 --> -0.643289).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9742590
	speed: 0.0963s/iter; left time: 3435.9415s
	iters: 200, epoch: 4 | loss: 0.3852510
	speed: 0.0187s/iter; left time: 664.1209s
	iters: 300, epoch: 4 | loss: 1.0022784
	speed: 0.0196s/iter; left time: 697.2166s
Epoch: 4 cost time: 8.327185153961182
Epoch: 4, Steps: 369 | Train Loss: 0.675 Vali Loss: 1.617 Vali Acc: 0.644 Test Loss: 1.617 Test Acc: 0.644
Validation loss decreased (-0.643289 --> -0.644422).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4023103
	speed: 0.1446s/iter; left time: 5109.2071s
	iters: 200, epoch: 5 | loss: 1.5965463
	speed: 0.0373s/iter; left time: 1312.2158s
	iters: 300, epoch: 5 | loss: 0.3487175
	speed: 0.0369s/iter; left time: 1297.4069s
Epoch: 5 cost time: 14.224740028381348
Epoch: 5, Steps: 369 | Train Loss: 0.576 Vali Loss: 1.762 Vali Acc: 0.630 Test Loss: 1.762 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0989152
	speed: 0.1492s/iter; left time: 5217.1671s
	iters: 200, epoch: 6 | loss: 0.3327656
	speed: 0.0368s/iter; left time: 1281.6038s
	iters: 300, epoch: 6 | loss: 0.1915489
	speed: 0.0372s/iter; left time: 1291.2299s
Epoch: 6 cost time: 14.064713478088379
Epoch: 6, Steps: 369 | Train Loss: 0.450 Vali Loss: 1.510 Vali Acc: 0.638 Test Loss: 1.510 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3174685
	speed: 0.1524s/iter; left time: 5269.6446s
	iters: 200, epoch: 7 | loss: 0.5650313
	speed: 0.0363s/iter; left time: 1253.2870s
	iters: 300, epoch: 7 | loss: 0.3645741
	speed: 0.0369s/iter; left time: 1268.7922s
Epoch: 7 cost time: 14.25618839263916
Epoch: 7, Steps: 369 | Train Loss: 0.355 Vali Loss: 1.539 Vali Acc: 0.623 Test Loss: 1.539 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0801389
	speed: 0.1512s/iter; left time: 5175.0407s
	iters: 200, epoch: 8 | loss: 0.0830271
	speed: 0.0362s/iter; left time: 1235.1177s
	iters: 300, epoch: 8 | loss: 0.0914007
	speed: 0.0367s/iter; left time: 1249.2587s
Epoch: 8 cost time: 14.015103578567505
Epoch: 8, Steps: 369 | Train Loss: 0.286 Vali Loss: 1.387 Vali Acc: 0.643 Test Loss: 1.387 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1437602
	speed: 0.1529s/iter; left time: 5176.9999s
	iters: 200, epoch: 9 | loss: 0.0457409
	speed: 0.0360s/iter; left time: 1215.2126s
	iters: 300, epoch: 9 | loss: 0.5186412
	speed: 0.0359s/iter; left time: 1207.4899s
Epoch: 9 cost time: 13.888652086257935
Epoch: 9, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.399 Vali Acc: 0.638 Test Loss: 1.399 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0527350
	speed: 0.1543s/iter; left time: 5164.5788s
	iters: 200, epoch: 10 | loss: 0.0457141
	speed: 0.0360s/iter; left time: 1201.4828s
	iters: 300, epoch: 10 | loss: 0.0753205
	speed: 0.0357s/iter; left time: 1186.9225s
Epoch: 10 cost time: 13.309731006622314
Epoch: 10, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.482 Vali Acc: 0.635 Test Loss: 1.482 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.5883444
	speed: 0.1535s/iter; left time: 5081.8821s
	iters: 200, epoch: 11 | loss: 0.0228541
	speed: 0.0358s/iter; left time: 1181.0413s
	iters: 300, epoch: 11 | loss: 0.4828188
	speed: 0.0359s/iter; left time: 1181.2688s
Epoch: 11 cost time: 13.904766082763672
Epoch: 11, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.542 Vali Acc: 0.633 Test Loss: 1.542 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0729633
	speed: 0.1671s/iter; left time: 5471.0355s
	iters: 200, epoch: 12 | loss: 0.0057622
	speed: 0.0355s/iter; left time: 1159.1968s
	iters: 300, epoch: 12 | loss: 0.1553805
	speed: 0.0356s/iter; left time: 1158.6665s
Epoch: 12 cost time: 13.965904951095581
Epoch: 12, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.589 Vali Acc: 0.638 Test Loss: 1.589 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0544458
	speed: 0.1587s/iter; left time: 5136.1796s
	iters: 200, epoch: 13 | loss: 0.2192472
	speed: 0.0368s/iter; left time: 1186.0694s
	iters: 300, epoch: 13 | loss: 0.1997909
	speed: 0.0373s/iter; left time: 1200.2872s
Epoch: 13 cost time: 14.424474477767944
Epoch: 13, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.604 Vali Acc: 0.638 Test Loss: 1.604 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0687960
	speed: 0.1615s/iter; left time: 5169.3692s
	iters: 200, epoch: 14 | loss: 0.0531845
	speed: 0.0375s/iter; left time: 1195.0781s
	iters: 300, epoch: 14 | loss: 0.1979244
	speed: 0.0359s/iter; left time: 1140.3412s
Epoch: 14 cost time: 14.467772006988525
Epoch: 14, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.722 Vali Acc: 0.640 Test Loss: 1.722 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6444381384790011
model parameter : 66274
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0324051
	speed: 0.0524s/iter; left time: 1927.6894s
	iters: 200, epoch: 1 | loss: 0.8188844
	speed: 0.0310s/iter; left time: 1138.0104s
	iters: 300, epoch: 1 | loss: 0.8042740
	speed: 0.0309s/iter; left time: 1131.7194s
Epoch: 1 cost time: 13.692145347595215
Epoch: 1, Steps: 369 | Train Loss: 0.751 Vali Loss: 0.887 Vali Acc: 0.652 Test Loss: 0.887 Test Acc: 0.652
Validation loss decreased (inf --> -0.652091).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8277939
	speed: 0.1421s/iter; left time: 5177.0134s
	iters: 200, epoch: 2 | loss: 0.5498990
	speed: 0.0304s/iter; left time: 1103.6070s
	iters: 300, epoch: 2 | loss: 0.6115306
	speed: 0.0302s/iter; left time: 1095.9492s
Epoch: 2 cost time: 11.75347638130188
Epoch: 2, Steps: 369 | Train Loss: 0.720 Vali Loss: 1.155 Vali Acc: 0.642 Test Loss: 1.155 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5753089
	speed: 0.1330s/iter; left time: 4798.0885s
	iters: 200, epoch: 3 | loss: 0.6113915
	speed: 0.0304s/iter; left time: 1093.4029s
	iters: 300, epoch: 3 | loss: 0.5334718
	speed: 0.0301s/iter; left time: 1079.6749s
Epoch: 3 cost time: 11.909695863723755
Epoch: 3, Steps: 369 | Train Loss: 0.682 Vali Loss: 1.419 Vali Acc: 0.643 Test Loss: 1.419 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1789187
	speed: 0.1411s/iter; left time: 5037.8318s
	iters: 200, epoch: 4 | loss: 0.0999490
	speed: 0.0314s/iter; left time: 1117.5217s
	iters: 300, epoch: 4 | loss: 0.3891892
	speed: 0.0323s/iter; left time: 1147.8840s
Epoch: 4 cost time: 12.380048036575317
Epoch: 4, Steps: 369 | Train Loss: 0.631 Vali Loss: 1.553 Vali Acc: 0.633 Test Loss: 1.553 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.9518300
	speed: 0.1438s/iter; left time: 5079.4708s
	iters: 200, epoch: 5 | loss: 0.8270944
	speed: 0.0279s/iter; left time: 984.4126s
	iters: 300, epoch: 5 | loss: 0.0299671
	speed: 0.0337s/iter; left time: 1185.3405s
Epoch: 5 cost time: 12.28184700012207
Epoch: 5, Steps: 369 | Train Loss: 0.516 Vali Loss: 1.384 Vali Acc: 0.638 Test Loss: 1.384 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6196928
	speed: 0.1495s/iter; left time: 5226.5880s
	iters: 200, epoch: 6 | loss: 0.4258628
	speed: 0.0346s/iter; left time: 1206.4470s
	iters: 300, epoch: 6 | loss: 0.3965028
	speed: 0.0348s/iter; left time: 1209.4225s
Epoch: 6 cost time: 13.364093780517578
Epoch: 6, Steps: 369 | Train Loss: 0.450 Vali Loss: 1.336 Vali Acc: 0.646 Test Loss: 1.336 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5392846
	speed: 0.1482s/iter; left time: 5126.6100s
	iters: 200, epoch: 7 | loss: 0.1775987
	speed: 0.0334s/iter; left time: 1150.9565s
	iters: 300, epoch: 7 | loss: 0.4845101
	speed: 0.0328s/iter; left time: 1127.2222s
Epoch: 7 cost time: 12.546264171600342
Epoch: 7, Steps: 369 | Train Loss: 0.394 Vali Loss: 1.278 Vali Acc: 0.649 Test Loss: 1.278 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7429599
	speed: 0.1424s/iter; left time: 4873.1989s
	iters: 200, epoch: 8 | loss: 0.4131491
	speed: 0.0325s/iter; left time: 1109.4771s
	iters: 300, epoch: 8 | loss: 0.0245838
	speed: 0.0333s/iter; left time: 1132.8381s
Epoch: 8 cost time: 12.85653018951416
Epoch: 8, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.258 Vali Acc: 0.639 Test Loss: 1.258 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.3698623
	speed: 0.1464s/iter; left time: 4954.1622s
	iters: 200, epoch: 9 | loss: 0.2738525
	speed: 0.0339s/iter; left time: 1143.1694s
	iters: 300, epoch: 9 | loss: 0.3548913
	speed: 0.0310s/iter; left time: 1044.7915s
Epoch: 9 cost time: 12.493481874465942
Epoch: 9, Steps: 369 | Train Loss: 0.272 Vali Loss: 1.251 Vali Acc: 0.633 Test Loss: 1.251 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0316358
	speed: 0.1442s/iter; left time: 4827.4073s
	iters: 200, epoch: 10 | loss: 0.3797561
	speed: 0.0316s/iter; left time: 1056.1105s
	iters: 300, epoch: 10 | loss: 0.0798074
	speed: 0.0310s/iter; left time: 1031.1888s
Epoch: 10 cost time: 12.194904327392578
Epoch: 10, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.304 Vali Acc: 0.640 Test Loss: 1.304 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0732074
	speed: 0.1441s/iter; left time: 4771.6256s
	iters: 200, epoch: 11 | loss: 0.2845817
	speed: 0.0309s/iter; left time: 1021.3502s
	iters: 300, epoch: 11 | loss: 0.2717673
	speed: 0.0309s/iter; left time: 1016.9294s
Epoch: 11 cost time: 12.050968408584595
Epoch: 11, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.330 Vali Acc: 0.636 Test Loss: 1.330 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6520998864926221
model parameter : 52498
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5295729
	speed: 0.0477s/iter; left time: 1757.0365s
	iters: 200, epoch: 1 | loss: 0.7518001
	speed: 0.0281s/iter; left time: 1032.2540s
	iters: 300, epoch: 1 | loss: 0.4337494
	speed: 0.0283s/iter; left time: 1035.5922s
Epoch: 1 cost time: 12.455728769302368
Epoch: 1, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.893 Vali Acc: 0.647 Test Loss: 0.893 Test Acc: 0.647
Validation loss decreased (inf --> -0.647267).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3718496
	speed: 0.1351s/iter; left time: 4920.4483s
	iters: 200, epoch: 2 | loss: 0.4059192
	speed: 0.0285s/iter; left time: 1037.1562s
	iters: 300, epoch: 2 | loss: 0.6546841
	speed: 0.0277s/iter; left time: 1003.5980s
Epoch: 2 cost time: 11.063659191131592
Epoch: 2, Steps: 369 | Train Loss: 0.659 Vali Loss: 1.079 Vali Acc: 0.641 Test Loss: 1.079 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8615060
	speed: 0.1397s/iter; left time: 5038.8233s
	iters: 200, epoch: 3 | loss: 0.5240458
	speed: 0.0234s/iter; left time: 841.1425s
	iters: 300, epoch: 3 | loss: 0.5717062
	speed: 0.0304s/iter; left time: 1088.9318s
Epoch: 3 cost time: 10.83658242225647
Epoch: 3, Steps: 369 | Train Loss: 0.640 Vali Loss: 1.223 Vali Acc: 0.643 Test Loss: 1.223 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3296269
	speed: 0.1397s/iter; left time: 4985.8004s
	iters: 200, epoch: 4 | loss: 1.2493734
	speed: 0.0293s/iter; left time: 1041.6984s
	iters: 300, epoch: 4 | loss: 0.8171638
	speed: 0.0307s/iter; left time: 1091.2891s
Epoch: 4 cost time: 11.683665990829468
Epoch: 4, Steps: 369 | Train Loss: 0.593 Vali Loss: 1.202 Vali Acc: 0.667 Test Loss: 1.202 Test Acc: 0.667
Validation loss decreased (-0.647267 --> -0.667128).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4390668
	speed: 0.1417s/iter; left time: 5004.8965s
	iters: 200, epoch: 5 | loss: 0.5372929
	speed: 0.0304s/iter; left time: 1072.4981s
	iters: 300, epoch: 5 | loss: 0.2751696
	speed: 0.0283s/iter; left time: 994.3733s
Epoch: 5 cost time: 11.39134168624878
Epoch: 5, Steps: 369 | Train Loss: 0.525 Vali Loss: 1.315 Vali Acc: 0.648 Test Loss: 1.315 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4042339
	speed: 0.1466s/iter; left time: 5125.2990s
	iters: 200, epoch: 6 | loss: 0.1973808
	speed: 0.0284s/iter; left time: 989.7313s
	iters: 300, epoch: 6 | loss: 0.2280296
	speed: 0.0295s/iter; left time: 1024.8545s
Epoch: 6 cost time: 11.335152864456177
Epoch: 6, Steps: 369 | Train Loss: 0.470 Vali Loss: 1.250 Vali Acc: 0.654 Test Loss: 1.250 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4342841
	speed: 0.1496s/iter; left time: 5172.6180s
	iters: 200, epoch: 7 | loss: 0.6342630
	speed: 0.0317s/iter; left time: 1092.9199s
	iters: 300, epoch: 7 | loss: 0.6812768
	speed: 0.0310s/iter; left time: 1066.3414s
Epoch: 7 cost time: 12.07717251777649
Epoch: 7, Steps: 369 | Train Loss: 0.399 Vali Loss: 1.203 Vali Acc: 0.646 Test Loss: 1.203 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1473431
	speed: 0.1375s/iter; left time: 4703.9922s
	iters: 200, epoch: 8 | loss: 0.2548365
	speed: 0.0292s/iter; left time: 994.7256s
	iters: 300, epoch: 8 | loss: 0.4342860
	speed: 0.0287s/iter; left time: 975.9923s
Epoch: 8 cost time: 11.259459257125854
Epoch: 8, Steps: 369 | Train Loss: 0.357 Vali Loss: 1.180 Vali Acc: 0.645 Test Loss: 1.180 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1546254
	speed: 0.1347s/iter; left time: 4560.6718s
	iters: 200, epoch: 9 | loss: 0.2157174
	speed: 0.0293s/iter; left time: 989.6442s
	iters: 300, epoch: 9 | loss: 0.4248542
	speed: 0.0286s/iter; left time: 961.9441s
Epoch: 9 cost time: 11.387211561203003
Epoch: 9, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.146 Vali Acc: 0.647 Test Loss: 1.146 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1555865
	speed: 0.1335s/iter; left time: 4470.5912s
	iters: 200, epoch: 10 | loss: 0.2665157
	speed: 0.0279s/iter; left time: 930.8621s
	iters: 300, epoch: 10 | loss: 0.6313717
	speed: 0.0285s/iter; left time: 947.7409s
Epoch: 10 cost time: 11.012205362319946
Epoch: 10, Steps: 369 | Train Loss: 0.273 Vali Loss: 1.140 Vali Acc: 0.659 Test Loss: 1.140 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2480906
	speed: 0.1353s/iter; left time: 4479.4189s
	iters: 200, epoch: 11 | loss: 0.5509509
	speed: 0.0282s/iter; left time: 930.5403s
	iters: 300, epoch: 11 | loss: 0.2163791
	speed: 0.0280s/iter; left time: 922.3251s
Epoch: 11 cost time: 11.111107110977173
Epoch: 11, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.153 Vali Acc: 0.649 Test Loss: 1.153 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0281544
	speed: 0.1284s/iter; left time: 4203.5514s
	iters: 200, epoch: 12 | loss: 0.0571497
	speed: 0.0275s/iter; left time: 899.1097s
	iters: 300, epoch: 12 | loss: 0.0629070
	speed: 0.0277s/iter; left time: 900.6911s
Epoch: 12 cost time: 10.822413444519043
Epoch: 12, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.210 Vali Acc: 0.655 Test Loss: 1.210 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0211572
	speed: 0.1319s/iter; left time: 4271.2966s
	iters: 200, epoch: 13 | loss: 0.0824489
	speed: 0.0280s/iter; left time: 903.1037s
	iters: 300, epoch: 13 | loss: 0.1770735
	speed: 0.0278s/iter; left time: 893.5470s
Epoch: 13 cost time: 11.140048265457153
Epoch: 13, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.255 Vali Acc: 0.652 Test Loss: 1.255 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0914662
	speed: 0.1418s/iter; left time: 4539.7182s
	iters: 200, epoch: 14 | loss: 0.2169258
	speed: 0.0284s/iter; left time: 905.9916s
	iters: 300, epoch: 14 | loss: 0.1863102
	speed: 0.0229s/iter; left time: 727.6768s
Epoch: 14 cost time: 10.73346757888794
Epoch: 14, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.352 Vali Acc: 0.647 Test Loss: 1.352 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6671396140749148
model parameter : 43330
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7287371
	speed: 0.1442s/iter; left time: 5306.7543s
	iters: 200, epoch: 1 | loss: 2.5537930
	speed: 0.1251s/iter; left time: 4590.2001s
	iters: 300, epoch: 1 | loss: 0.9347817
	speed: 0.1208s/iter; left time: 4422.3852s
Epoch: 1 cost time: 47.38886523246765
Epoch: 1, Steps: 369 | Train Loss: 1.653 Vali Loss: 1.438 Vali Acc: 0.607 Test Loss: 1.438 Test Acc: 0.607
Validation loss decreased (inf --> -0.606683).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9915986
	speed: 0.4185s/iter; left time: 15247.6691s
	iters: 200, epoch: 2 | loss: 1.0986351
	speed: 0.1204s/iter; left time: 4375.6731s
	iters: 300, epoch: 2 | loss: 1.3195758
	speed: 0.1200s/iter; left time: 4346.2562s
Epoch: 2 cost time: 45.055843353271484
Epoch: 2, Steps: 369 | Train Loss: 1.535 Vali Loss: 1.878 Vali Acc: 0.651 Test Loss: 1.878 Test Acc: 0.651
Validation loss decreased (-0.606683 --> -0.650662).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9195918
	speed: 0.4162s/iter; left time: 15009.9255s
	iters: 200, epoch: 3 | loss: 2.2595055
	speed: 0.1201s/iter; left time: 4320.8674s
	iters: 300, epoch: 3 | loss: 0.6723069
	speed: 0.1215s/iter; left time: 4357.0362s
Epoch: 3 cost time: 45.39311099052429
Epoch: 3, Steps: 369 | Train Loss: 1.725 Vali Loss: 2.178 Vali Acc: 0.643 Test Loss: 2.178 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9975985
	speed: 0.4211s/iter; left time: 15030.2346s
	iters: 200, epoch: 4 | loss: 1.0298282
	speed: 0.1239s/iter; left time: 4411.7760s
	iters: 300, epoch: 4 | loss: 1.3739799
	speed: 0.1207s/iter; left time: 4285.2891s
Epoch: 4 cost time: 45.93054127693176
Epoch: 4, Steps: 369 | Train Loss: 1.326 Vali Loss: 3.115 Vali Acc: 0.614 Test Loss: 3.115 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6846224
	speed: 0.4207s/iter; left time: 14862.2873s
	iters: 200, epoch: 5 | loss: 1.7764928
	speed: 0.1182s/iter; left time: 4165.2407s
	iters: 300, epoch: 5 | loss: 0.1530329
	speed: 0.1173s/iter; left time: 4120.9791s
Epoch: 5 cost time: 44.660237312316895
Epoch: 5, Steps: 369 | Train Loss: 0.865 Vali Loss: 2.077 Vali Acc: 0.634 Test Loss: 2.077 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9025442
	speed: 0.4209s/iter; left time: 14714.0161s
	iters: 200, epoch: 6 | loss: 0.8301764
	speed: 0.1166s/iter; left time: 4065.7776s
	iters: 300, epoch: 6 | loss: 0.1523169
	speed: 0.1207s/iter; left time: 4195.3982s
Epoch: 6 cost time: 45.023794174194336
Epoch: 6, Steps: 369 | Train Loss: 0.430 Vali Loss: 2.350 Vali Acc: 0.644 Test Loss: 2.350 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2471957
	speed: 0.4212s/iter; left time: 14567.5644s
	iters: 200, epoch: 7 | loss: 0.6530061
	speed: 0.1221s/iter; left time: 4209.7918s
	iters: 300, epoch: 7 | loss: 0.0907535
	speed: 0.1216s/iter; left time: 4182.6620s
Epoch: 7 cost time: 45.60276174545288
Epoch: 7, Steps: 369 | Train Loss: 0.215 Vali Loss: 2.284 Vali Acc: 0.643 Test Loss: 2.284 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0896267
	speed: 0.4179s/iter; left time: 14299.5890s
	iters: 200, epoch: 8 | loss: 0.7405686
	speed: 0.1204s/iter; left time: 4107.1852s
	iters: 300, epoch: 8 | loss: 0.2260789
	speed: 0.1204s/iter; left time: 4096.2475s
Epoch: 8 cost time: 45.074997425079346
Epoch: 8, Steps: 369 | Train Loss: 0.156 Vali Loss: 2.087 Vali Acc: 0.627 Test Loss: 2.087 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0168956
	speed: 0.4200s/iter; left time: 14218.1284s
	iters: 200, epoch: 9 | loss: 0.3983972
	speed: 0.1218s/iter; left time: 4110.9877s
	iters: 300, epoch: 9 | loss: 0.0480967
	speed: 0.1204s/iter; left time: 4049.9916s
Epoch: 9 cost time: 45.59312081336975
Epoch: 9, Steps: 369 | Train Loss: 0.135 Vali Loss: 2.093 Vali Acc: 0.622 Test Loss: 2.093 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0229187
	speed: 0.4199s/iter; left time: 14059.0085s
	iters: 200, epoch: 10 | loss: 0.2783959
	speed: 0.1245s/iter; left time: 4155.3620s
	iters: 300, epoch: 10 | loss: 0.0063242
	speed: 0.1236s/iter; left time: 4112.9622s
Epoch: 10 cost time: 46.41139364242554
Epoch: 10, Steps: 369 | Train Loss: 0.102 Vali Loss: 2.104 Vali Acc: 0.620 Test Loss: 2.104 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0061570
	speed: 0.4175s/iter; left time: 13824.2578s
	iters: 200, epoch: 11 | loss: 0.0084329
	speed: 0.1219s/iter; left time: 4025.3443s
	iters: 300, epoch: 11 | loss: 0.0761738
	speed: 0.1223s/iter; left time: 4025.8747s
Epoch: 11 cost time: 45.48242449760437
Epoch: 11, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.187 Vali Acc: 0.620 Test Loss: 2.187 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0372203
	speed: 0.4176s/iter; left time: 13674.1218s
	iters: 200, epoch: 12 | loss: 0.0005372
	speed: 0.1210s/iter; left time: 3949.3551s
	iters: 300, epoch: 12 | loss: 0.2845173
	speed: 0.1200s/iter; left time: 3904.5130s
Epoch: 12 cost time: 45.22725868225098
Epoch: 12, Steps: 369 | Train Loss: 0.051 Vali Loss: 2.294 Vali Acc: 0.629 Test Loss: 2.294 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6506810442678774
model parameter : 292322
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9584152
	speed: 0.0867s/iter; left time: 3191.1523s
	iters: 200, epoch: 1 | loss: 0.3922623
	speed: 0.0625s/iter; left time: 2295.2217s
	iters: 300, epoch: 1 | loss: 1.0654035
	speed: 0.0658s/iter; left time: 2408.9423s
Epoch: 1 cost time: 25.9688720703125
Epoch: 1, Steps: 369 | Train Loss: 1.031 Vali Loss: 3.211 Vali Acc: 0.554 Test Loss: 3.211 Test Acc: 0.554
Validation loss decreased (inf --> -0.553884).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5525420
	speed: 0.2557s/iter; left time: 9314.8420s
	iters: 200, epoch: 2 | loss: 0.7973391
	speed: 0.0674s/iter; left time: 2448.4173s
	iters: 300, epoch: 2 | loss: 1.6034102
	speed: 0.0661s/iter; left time: 2395.0387s
Epoch: 2 cost time: 25.607651948928833
Epoch: 2, Steps: 369 | Train Loss: 1.128 Vali Loss: 1.435 Vali Acc: 0.652 Test Loss: 1.435 Test Acc: 0.652
Validation loss decreased (-0.553884 --> -0.651802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7275746
	speed: 0.2520s/iter; left time: 9087.7818s
	iters: 200, epoch: 3 | loss: 1.2633289
	speed: 0.0684s/iter; left time: 2458.2936s
	iters: 300, epoch: 3 | loss: 0.5623368
	speed: 0.0685s/iter; left time: 2456.6338s
Epoch: 3 cost time: 25.382549047470093
Epoch: 3, Steps: 369 | Train Loss: 1.262 Vali Loss: 2.140 Vali Acc: 0.628 Test Loss: 2.140 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5876914
	speed: 0.2563s/iter; left time: 9148.0320s
	iters: 200, epoch: 4 | loss: 0.6358095
	speed: 0.0684s/iter; left time: 2433.8330s
	iters: 300, epoch: 4 | loss: 0.3784174
	speed: 0.0687s/iter; left time: 2437.0151s
Epoch: 4 cost time: 26.185100317001343
Epoch: 4, Steps: 369 | Train Loss: 1.072 Vali Loss: 2.763 Vali Acc: 0.593 Test Loss: 2.763 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.1094140
	speed: 0.2518s/iter; left time: 8894.9171s
	iters: 200, epoch: 5 | loss: 1.3074729
	speed: 0.0687s/iter; left time: 2419.1493s
	iters: 300, epoch: 5 | loss: 0.1708474
	speed: 0.0694s/iter; left time: 2438.9339s
Epoch: 5 cost time: 26.196058988571167
Epoch: 5, Steps: 369 | Train Loss: 0.770 Vali Loss: 1.897 Vali Acc: 0.633 Test Loss: 1.897 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7607368
	speed: 0.2590s/iter; left time: 9054.6157s
	iters: 200, epoch: 6 | loss: 0.5507476
	speed: 0.0691s/iter; left time: 2407.4923s
	iters: 300, epoch: 6 | loss: 0.1514112
	speed: 0.0679s/iter; left time: 2359.0074s
Epoch: 6 cost time: 25.92525053024292
Epoch: 6, Steps: 369 | Train Loss: 0.503 Vali Loss: 1.601 Vali Acc: 0.623 Test Loss: 1.601 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1918024
	speed: 0.2591s/iter; left time: 8962.3315s
	iters: 200, epoch: 7 | loss: 0.3973050
	speed: 0.0664s/iter; left time: 2288.8026s
	iters: 300, epoch: 7 | loss: 0.3288436
	speed: 0.0660s/iter; left time: 2270.5486s
Epoch: 7 cost time: 25.28795075416565
Epoch: 7, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.368 Vali Acc: 0.648 Test Loss: 1.368 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.3269262
	speed: 0.2610s/iter; left time: 8929.8080s
	iters: 200, epoch: 8 | loss: 0.2126965
	speed: 0.0577s/iter; left time: 1967.7432s
	iters: 300, epoch: 8 | loss: 0.1777082
	speed: 0.0638s/iter; left time: 2171.6201s
Epoch: 8 cost time: 24.134024620056152
Epoch: 8, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.482 Vali Acc: 0.625 Test Loss: 1.482 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1320338
	speed: 0.2656s/iter; left time: 8990.3751s
	iters: 200, epoch: 9 | loss: 0.0698844
	speed: 0.0636s/iter; left time: 2146.0889s
	iters: 300, epoch: 9 | loss: 0.0297169
	speed: 0.0657s/iter; left time: 2209.6870s
Epoch: 9 cost time: 24.754945993423462
Epoch: 9, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.571 Vali Acc: 0.632 Test Loss: 1.571 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0519524
	speed: 0.2520s/iter; left time: 8438.5882s
	iters: 200, epoch: 10 | loss: 0.1702888
	speed: 0.0677s/iter; left time: 2260.8915s
	iters: 300, epoch: 10 | loss: 0.0786206
	speed: 0.0676s/iter; left time: 2248.2681s
Epoch: 10 cost time: 25.805032968521118
Epoch: 10, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.533 Vali Acc: 0.632 Test Loss: 1.533 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0377229
	speed: 0.2615s/iter; left time: 8657.3058s
	iters: 200, epoch: 11 | loss: 0.0062646
	speed: 0.0677s/iter; left time: 2234.7295s
	iters: 300, epoch: 11 | loss: 0.0136197
	speed: 0.0681s/iter; left time: 2242.4009s
Epoch: 11 cost time: 25.892047882080078
Epoch: 11, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.801 Vali Acc: 0.639 Test Loss: 1.801 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0221391
	speed: 0.2558s/iter; left time: 8375.1916s
	iters: 200, epoch: 12 | loss: 0.0984459
	speed: 0.0685s/iter; left time: 2234.8859s
	iters: 300, epoch: 12 | loss: 0.0253422
	speed: 0.0687s/iter; left time: 2236.0840s
Epoch: 12 cost time: 26.091957092285156
Epoch: 12, Steps: 369 | Train Loss: 0.078 Vali Loss: 1.887 Vali Acc: 0.631 Test Loss: 1.887 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6518161180476731
model parameter : 149506
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8866001
	speed: 0.0746s/iter; left time: 2746.6832s
	iters: 200, epoch: 1 | loss: 1.6412121
	speed: 0.0490s/iter; left time: 1797.7970s
	iters: 300, epoch: 1 | loss: 0.7499749
	speed: 0.0543s/iter; left time: 1988.5142s
Epoch: 1 cost time: 21.67157506942749
Epoch: 1, Steps: 369 | Train Loss: 0.973 Vali Loss: 1.585 Vali Acc: 0.611 Test Loss: 1.585 Test Acc: 0.611
Validation loss decreased (inf --> -0.610938).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0183499
	speed: 0.2231s/iter; left time: 8127.0016s
	iters: 200, epoch: 2 | loss: 1.1912550
	speed: 0.0506s/iter; left time: 1839.5136s
	iters: 300, epoch: 2 | loss: 0.9524737
	speed: 0.0518s/iter; left time: 1877.6853s
Epoch: 2 cost time: 20.054444551467896
Epoch: 2, Steps: 369 | Train Loss: 1.004 Vali Loss: 1.585 Vali Acc: 0.643 Test Loss: 1.585 Test Acc: 0.643
Validation loss decreased (-0.610938 --> -0.642720).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6736281
	speed: 0.2126s/iter; left time: 7668.0145s
	iters: 200, epoch: 3 | loss: 0.9548734
	speed: 0.0558s/iter; left time: 2008.2725s
	iters: 300, epoch: 3 | loss: 0.7621863
	speed: 0.0556s/iter; left time: 1992.5090s
Epoch: 3 cost time: 21.13717246055603
Epoch: 3, Steps: 369 | Train Loss: 0.971 Vali Loss: 1.945 Vali Acc: 0.626 Test Loss: 1.945 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5060675
	speed: 0.2125s/iter; left time: 7586.3903s
	iters: 200, epoch: 4 | loss: 1.5176404
	speed: 0.0551s/iter; left time: 1960.0420s
	iters: 300, epoch: 4 | loss: 0.4595119
	speed: 0.0552s/iter; left time: 1958.1329s
Epoch: 4 cost time: 20.97237229347229
Epoch: 4, Steps: 369 | Train Loss: 0.778 Vali Loss: 2.201 Vali Acc: 0.631 Test Loss: 2.201 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1696113
	speed: 0.2131s/iter; left time: 7528.7337s
	iters: 200, epoch: 5 | loss: 2.0075758
	speed: 0.0559s/iter; left time: 1969.6102s
	iters: 300, epoch: 5 | loss: 1.2059150
	speed: 0.0560s/iter; left time: 1968.4899s
Epoch: 5 cost time: 21.31598925590515
Epoch: 5, Steps: 369 | Train Loss: 0.653 Vali Loss: 1.845 Vali Acc: 0.663 Test Loss: 1.845 Test Acc: 0.663
Validation loss decreased (-0.642720 --> -0.662865).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2150780
	speed: 0.2114s/iter; left time: 7388.4166s
	iters: 200, epoch: 6 | loss: 0.1574755
	speed: 0.0570s/iter; left time: 1988.1183s
	iters: 300, epoch: 6 | loss: 0.4190847
	speed: 0.0572s/iter; left time: 1987.2225s
Epoch: 6 cost time: 21.634960412979126
Epoch: 6, Steps: 369 | Train Loss: 0.459 Vali Loss: 1.592 Vali Acc: 0.643 Test Loss: 1.592 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3640722
	speed: 0.2017s/iter; left time: 6977.0688s
	iters: 200, epoch: 7 | loss: 0.0647473
	speed: 0.0535s/iter; left time: 1846.1961s
	iters: 300, epoch: 7 | loss: 0.2804906
	speed: 0.0547s/iter; left time: 1882.3390s
Epoch: 7 cost time: 20.006954431533813
Epoch: 7, Steps: 369 | Train Loss: 0.301 Vali Loss: 1.463 Vali Acc: 0.635 Test Loss: 1.463 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2703548
	speed: 0.2229s/iter; left time: 7626.6468s
	iters: 200, epoch: 8 | loss: 0.1521559
	speed: 0.0530s/iter; left time: 1807.6047s
	iters: 300, epoch: 8 | loss: 0.0125746
	speed: 0.0514s/iter; left time: 1747.2811s
Epoch: 8 cost time: 20.37505531311035
Epoch: 8, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.508 Vali Acc: 0.630 Test Loss: 1.508 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0864712
	speed: 0.2096s/iter; left time: 7096.2010s
	iters: 200, epoch: 9 | loss: 0.5066050
	speed: 0.0556s/iter; left time: 1876.1578s
	iters: 300, epoch: 9 | loss: 0.3446528
	speed: 0.0551s/iter; left time: 1855.6963s
Epoch: 9 cost time: 21.07237219810486
Epoch: 9, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.473 Vali Acc: 0.641 Test Loss: 1.473 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0316408
	speed: 0.2175s/iter; left time: 7280.3265s
	iters: 200, epoch: 10 | loss: 0.1210703
	speed: 0.0558s/iter; left time: 1864.0253s
	iters: 300, epoch: 10 | loss: 0.1474176
	speed: 0.0495s/iter; left time: 1647.9621s
Epoch: 10 cost time: 20.711432218551636
Epoch: 10, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.618 Vali Acc: 0.644 Test Loss: 1.618 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1346761
	speed: 0.2142s/iter; left time: 7093.0615s
	iters: 200, epoch: 11 | loss: 0.0995211
	speed: 0.0568s/iter; left time: 1873.3879s
	iters: 300, epoch: 11 | loss: 0.0412710
	speed: 0.0569s/iter; left time: 1873.2110s
Epoch: 11 cost time: 21.775847911834717
Epoch: 11, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.615 Vali Acc: 0.651 Test Loss: 1.615 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1379145
	speed: 0.2111s/iter; left time: 6910.8585s
	iters: 200, epoch: 12 | loss: 0.0992034
	speed: 0.0553s/iter; left time: 1805.2381s
	iters: 300, epoch: 12 | loss: 0.0288262
	speed: 0.0551s/iter; left time: 1792.6002s
Epoch: 12 cost time: 21.010778427124023
Epoch: 12, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.770 Vali Acc: 0.636 Test Loss: 1.770 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1791821
	speed: 0.2100s/iter; left time: 6798.7223s
	iters: 200, epoch: 13 | loss: 0.0600428
	speed: 0.0554s/iter; left time: 1787.7590s
	iters: 300, epoch: 13 | loss: 0.1596786
	speed: 0.0553s/iter; left time: 1780.3882s
Epoch: 13 cost time: 21.048617601394653
Epoch: 13, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.876 Vali Acc: 0.644 Test Loss: 1.876 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1159170
	speed: 0.2212s/iter; left time: 7078.3561s
	iters: 200, epoch: 14 | loss: 0.1054595
	speed: 0.0551s/iter; left time: 1757.6811s
	iters: 300, epoch: 14 | loss: 0.0542105
	speed: 0.0553s/iter; left time: 1757.7197s
Epoch: 14 cost time: 20.34472894668579
Epoch: 14, Steps: 369 | Train Loss: 0.068 Vali Loss: 1.898 Vali Acc: 0.643 Test Loss: 1.898 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0019529
	speed: 0.2126s/iter; left time: 6725.4489s
	iters: 200, epoch: 15 | loss: 0.0420018
	speed: 0.0550s/iter; left time: 1734.6782s
	iters: 300, epoch: 15 | loss: 0.0370667
	speed: 0.0553s/iter; left time: 1738.7354s
Epoch: 15 cost time: 20.81396770477295
Epoch: 15, Steps: 369 | Train Loss: 0.066 Vali Loss: 1.985 Vali Acc: 0.657 Test Loss: 1.985 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.662883087400681
model parameter : 103442
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9332005
	speed: 0.0630s/iter; left time: 2318.9649s
	iters: 200, epoch: 1 | loss: 1.0639441
	speed: 0.0427s/iter; left time: 1566.3283s
	iters: 300, epoch: 1 | loss: 1.4052413
	speed: 0.0421s/iter; left time: 1542.4078s
Epoch: 1 cost time: 17.62779426574707
Epoch: 1, Steps: 369 | Train Loss: 0.836 Vali Loss: 1.196 Vali Acc: 0.636 Test Loss: 1.196 Test Acc: 0.636
Validation loss decreased (inf --> -0.636197).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3405971
	speed: 0.1846s/iter; left time: 6726.3133s
	iters: 200, epoch: 2 | loss: 0.5130864
	speed: 0.0482s/iter; left time: 1752.8110s
	iters: 300, epoch: 2 | loss: 1.3887198
	speed: 0.0489s/iter; left time: 1772.2414s
Epoch: 2 cost time: 18.702164888381958
Epoch: 2, Steps: 369 | Train Loss: 0.892 Vali Loss: 1.394 Vali Acc: 0.654 Test Loss: 1.394 Test Acc: 0.654
Validation loss decreased (-0.636197 --> -0.653505).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3839093
	speed: 0.1862s/iter; left time: 6713.6792s
	iters: 200, epoch: 3 | loss: 0.5605934
	speed: 0.0491s/iter; left time: 1767.0009s
	iters: 300, epoch: 3 | loss: 0.5889239
	speed: 0.0490s/iter; left time: 1755.5805s
Epoch: 3 cost time: 18.766533851623535
Epoch: 3, Steps: 369 | Train Loss: 0.783 Vali Loss: 1.709 Vali Acc: 0.632 Test Loss: 1.709 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3612518
	speed: 0.1863s/iter; left time: 6648.5984s
	iters: 200, epoch: 4 | loss: 0.1363859
	speed: 0.0499s/iter; left time: 1774.7514s
	iters: 300, epoch: 4 | loss: 0.6073889
	speed: 0.0494s/iter; left time: 1751.7652s
Epoch: 4 cost time: 19.026503324508667
Epoch: 4, Steps: 369 | Train Loss: 0.692 Vali Loss: 1.808 Vali Acc: 0.636 Test Loss: 1.808 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7859349
	speed: 0.1925s/iter; left time: 6799.1997s
	iters: 200, epoch: 5 | loss: 0.1941529
	speed: 0.0496s/iter; left time: 1748.0952s
	iters: 300, epoch: 5 | loss: 0.3593337
	speed: 0.0496s/iter; left time: 1741.2117s
Epoch: 5 cost time: 19.1043438911438
Epoch: 5, Steps: 369 | Train Loss: 0.572 Vali Loss: 1.690 Vali Acc: 0.635 Test Loss: 1.690 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0129327
	speed: 0.1919s/iter; left time: 6708.8918s
	iters: 200, epoch: 6 | loss: 0.3530752
	speed: 0.0459s/iter; left time: 1600.3859s
	iters: 300, epoch: 6 | loss: 0.3434293
	speed: 0.0473s/iter; left time: 1644.0240s
Epoch: 6 cost time: 18.013205528259277
Epoch: 6, Steps: 369 | Train Loss: 0.446 Vali Loss: 1.710 Vali Acc: 0.621 Test Loss: 1.710 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1835517
	speed: 0.1850s/iter; left time: 6400.0821s
	iters: 200, epoch: 7 | loss: 0.1244353
	speed: 0.0408s/iter; left time: 1407.0891s
	iters: 300, epoch: 7 | loss: 0.6246350
	speed: 0.0438s/iter; left time: 1506.5478s
Epoch: 7 cost time: 16.109816312789917
Epoch: 7, Steps: 369 | Train Loss: 0.317 Vali Loss: 1.481 Vali Acc: 0.643 Test Loss: 1.481 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1725107
	speed: 0.1875s/iter; left time: 6416.8772s
	iters: 200, epoch: 8 | loss: 0.1075669
	speed: 0.0402s/iter; left time: 1371.2756s
	iters: 300, epoch: 8 | loss: 0.3326926
	speed: 0.0427s/iter; left time: 1451.5596s
Epoch: 8 cost time: 16.446411848068237
Epoch: 8, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.433 Vali Acc: 0.634 Test Loss: 1.433 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2206786
	speed: 0.1957s/iter; left time: 6623.3398s
	iters: 200, epoch: 9 | loss: 0.3722140
	speed: 0.0391s/iter; left time: 1318.9945s
	iters: 300, epoch: 9 | loss: 0.3138159
	speed: 0.0412s/iter; left time: 1385.5403s
Epoch: 9 cost time: 16.270955801010132
Epoch: 9, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.388 Vali Acc: 0.649 Test Loss: 1.388 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1726914
	speed: 0.1902s/iter; left time: 6367.8323s
	iters: 200, epoch: 10 | loss: 0.1802313
	speed: 0.0485s/iter; left time: 1618.9707s
	iters: 300, epoch: 10 | loss: 0.4717063
	speed: 0.0484s/iter; left time: 1610.4431s
Epoch: 10 cost time: 18.614913940429688
Epoch: 10, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.498 Vali Acc: 0.640 Test Loss: 1.498 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0645428
	speed: 0.1867s/iter; left time: 6182.6668s
	iters: 200, epoch: 11 | loss: 0.2193354
	speed: 0.0463s/iter; left time: 1527.6668s
	iters: 300, epoch: 11 | loss: 0.0434301
	speed: 0.0463s/iter; left time: 1523.7458s
Epoch: 11 cost time: 17.98041820526123
Epoch: 11, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.504 Vali Acc: 0.655 Test Loss: 1.504 Test Acc: 0.655
Validation loss decreased (-0.653505 --> -0.655206).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0462295
	speed: 0.1942s/iter; left time: 6357.0345s
	iters: 200, epoch: 12 | loss: 0.1708416
	speed: 0.0493s/iter; left time: 1608.3334s
	iters: 300, epoch: 12 | loss: 0.1560994
	speed: 0.0497s/iter; left time: 1617.9770s
Epoch: 12 cost time: 19.133944511413574
Epoch: 12, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.668 Vali Acc: 0.645 Test Loss: 1.668 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0358550
	speed: 0.1844s/iter; left time: 5970.0246s
	iters: 200, epoch: 13 | loss: 0.0080182
	speed: 0.0495s/iter; left time: 1598.2696s
	iters: 300, epoch: 13 | loss: 0.0337444
	speed: 0.0497s/iter; left time: 1598.2353s
Epoch: 13 cost time: 18.464033126831055
Epoch: 13, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.724 Vali Acc: 0.647 Test Loss: 1.724 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0522687
	speed: 0.1871s/iter; left time: 5987.5576s
	iters: 200, epoch: 14 | loss: 0.2281448
	speed: 0.0455s/iter; left time: 1451.0389s
	iters: 300, epoch: 14 | loss: 0.0320793
	speed: 0.0413s/iter; left time: 1313.6039s
Epoch: 14 cost time: 17.31559467315674
Epoch: 14, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.770 Vali Acc: 0.648 Test Loss: 1.770 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0577570
	speed: 0.1925s/iter; left time: 6089.6846s
	iters: 200, epoch: 15 | loss: 0.0804743
	speed: 0.0441s/iter; left time: 1389.2145s
	iters: 300, epoch: 15 | loss: 0.0886866
	speed: 0.0365s/iter; left time: 1148.3779s
Epoch: 15 cost time: 16.084782123565674
Epoch: 15, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.860 Vali Acc: 0.647 Test Loss: 1.860 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0025238
	speed: 0.1973s/iter; left time: 6168.0830s
	iters: 200, epoch: 16 | loss: 0.2993673
	speed: 0.0442s/iter; left time: 1376.1069s
	iters: 300, epoch: 16 | loss: 0.0425433
	speed: 0.0451s/iter; left time: 1401.7702s
Epoch: 16 cost time: 17.37677550315857
Epoch: 16, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.893 Vali Acc: 0.653 Test Loss: 1.893 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0160038
	speed: 0.1808s/iter; left time: 5585.3026s
	iters: 200, epoch: 17 | loss: 0.0119010
	speed: 0.0489s/iter; left time: 1507.3639s
	iters: 300, epoch: 17 | loss: 0.0222174
	speed: 0.0484s/iter; left time: 1484.8507s
Epoch: 17 cost time: 17.718865633010864
Epoch: 17, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.974 Vali Acc: 0.640 Test Loss: 1.974 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2688229
	speed: 0.1896s/iter; left time: 5788.6661s
	iters: 200, epoch: 18 | loss: 0.0097872
	speed: 0.0494s/iter; left time: 1502.3538s
	iters: 300, epoch: 18 | loss: 0.0209466
	speed: 0.0493s/iter; left time: 1494.6824s
Epoch: 18 cost time: 19.10245966911316
Epoch: 18, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.058 Vali Acc: 0.651 Test Loss: 2.058 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0165319
	speed: 0.1949s/iter; left time: 5877.9310s
	iters: 200, epoch: 19 | loss: 0.0415987
	speed: 0.0491s/iter; left time: 1476.4275s
	iters: 300, epoch: 19 | loss: 0.0778415
	speed: 0.0481s/iter; left time: 1442.2145s
Epoch: 19 cost time: 18.78640842437744
Epoch: 19, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.100 Vali Acc: 0.650 Test Loss: 2.100 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0250633
	speed: 0.1930s/iter; left time: 5749.7767s
	iters: 200, epoch: 20 | loss: 0.0040692
	speed: 0.0491s/iter; left time: 1456.7023s
	iters: 300, epoch: 20 | loss: 0.1055774
	speed: 0.0488s/iter; left time: 1442.9071s
Epoch: 20 cost time: 18.734493017196655
Epoch: 20, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.268 Vali Acc: 0.636 Test Loss: 2.268 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0083829
	speed: 0.1908s/iter; left time: 5613.3405s
	iters: 200, epoch: 21 | loss: 0.0007172
	speed: 0.0435s/iter; left time: 1276.2259s
	iters: 300, epoch: 21 | loss: 0.0168869
	speed: 0.0367s/iter; left time: 1071.0445s
Epoch: 21 cost time: 16.673762798309326
Epoch: 21, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.257 Vali Acc: 0.644 Test Loss: 2.257 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6552213393870602
model parameter : 75826
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.2895556
	speed: 0.0587s/iter; left time: 2161.4281s
	iters: 200, epoch: 1 | loss: 0.8002830
	speed: 0.0384s/iter; left time: 1410.3187s
	iters: 300, epoch: 1 | loss: 1.2578979
	speed: 0.0382s/iter; left time: 1397.4546s
Epoch: 1 cost time: 16.19681167602539
Epoch: 1, Steps: 369 | Train Loss: 0.784 Vali Loss: 1.087 Vali Acc: 0.628 Test Loss: 1.087 Test Acc: 0.628
Validation loss decreased (inf --> -0.628252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8857290
	speed: 0.1633s/iter; left time: 5948.9137s
	iters: 200, epoch: 2 | loss: 0.2510506
	speed: 0.0373s/iter; left time: 1353.4758s
	iters: 300, epoch: 2 | loss: 0.7066390
	speed: 0.0406s/iter; left time: 1469.6184s
Epoch: 2 cost time: 13.983961343765259
Epoch: 2, Steps: 369 | Train Loss: 0.811 Vali Loss: 1.569 Vali Acc: 0.617 Test Loss: 1.569 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3244847
	speed: 0.1670s/iter; left time: 6021.1798s
	iters: 200, epoch: 3 | loss: 1.0622116
	speed: 0.0505s/iter; left time: 1817.0488s
	iters: 300, epoch: 3 | loss: 1.4220011
	speed: 0.0506s/iter; left time: 1814.3496s
Epoch: 3 cost time: 19.376285791397095
Epoch: 3, Steps: 369 | Train Loss: 0.757 Vali Loss: 1.469 Vali Acc: 0.641 Test Loss: 1.469 Test Acc: 0.641
Validation loss decreased (-0.628252 --> -0.640734).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1603196
	speed: 0.1592s/iter; left time: 5683.2753s
	iters: 200, epoch: 4 | loss: 0.3824821
	speed: 0.0190s/iter; left time: 676.4183s
	iters: 300, epoch: 4 | loss: 0.5659696
	speed: 0.0195s/iter; left time: 692.5729s
Epoch: 4 cost time: 7.6120288372039795
Epoch: 4, Steps: 369 | Train Loss: 0.648 Vali Loss: 1.663 Vali Acc: 0.642 Test Loss: 1.663 Test Acc: 0.642
Validation loss decreased (-0.640734 --> -0.641584).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9851432
	speed: 0.1034s/iter; left time: 3653.5405s
	iters: 200, epoch: 5 | loss: 0.4175025
	speed: 0.0189s/iter; left time: 664.4209s
	iters: 300, epoch: 5 | loss: 0.5853407
	speed: 0.0229s/iter; left time: 805.5100s
Epoch: 5 cost time: 8.925113916397095
Epoch: 5, Steps: 369 | Train Loss: 0.574 Vali Loss: 1.561 Vali Acc: 0.633 Test Loss: 1.561 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4975432
	speed: 0.1400s/iter; left time: 4895.2281s
	iters: 200, epoch: 6 | loss: 1.0420225
	speed: 0.0328s/iter; left time: 1142.3929s
	iters: 300, epoch: 6 | loss: 0.8191733
	speed: 0.0326s/iter; left time: 1132.4040s
Epoch: 6 cost time: 12.82024884223938
Epoch: 6, Steps: 369 | Train Loss: 0.449 Vali Loss: 1.516 Vali Acc: 0.641 Test Loss: 1.516 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1409830
	speed: 0.1363s/iter; left time: 4712.5010s
	iters: 200, epoch: 7 | loss: 0.1204754
	speed: 0.0341s/iter; left time: 1176.4123s
	iters: 300, epoch: 7 | loss: 0.4774565
	speed: 0.0336s/iter; left time: 1153.7990s
Epoch: 7 cost time: 13.114148378372192
Epoch: 7, Steps: 369 | Train Loss: 0.364 Vali Loss: 1.354 Vali Acc: 0.642 Test Loss: 1.354 Test Acc: 0.642
Validation loss decreased (-0.641584 --> -0.642438).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1470810
	speed: 0.1420s/iter; left time: 4860.0608s
	iters: 200, epoch: 8 | loss: 0.1195256
	speed: 0.0338s/iter; left time: 1152.3831s
	iters: 300, epoch: 8 | loss: 0.0881080
	speed: 0.0338s/iter; left time: 1148.5647s
Epoch: 8 cost time: 13.19008493423462
Epoch: 8, Steps: 369 | Train Loss: 0.291 Vali Loss: 1.319 Vali Acc: 0.653 Test Loss: 1.319 Test Acc: 0.653
Validation loss decreased (-0.642438 --> -0.653222).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1398910
	speed: 0.1366s/iter; left time: 4622.8847s
	iters: 200, epoch: 9 | loss: 0.1786798
	speed: 0.0289s/iter; left time: 976.8507s
	iters: 300, epoch: 9 | loss: 0.1623692
	speed: 0.0293s/iter; left time: 984.5381s
Epoch: 9 cost time: 11.382197618484497
Epoch: 9, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.344 Vali Acc: 0.647 Test Loss: 1.344 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0199949
	speed: 0.1455s/iter; left time: 4872.8090s
	iters: 200, epoch: 10 | loss: 0.5527058
	speed: 0.0290s/iter; left time: 969.2104s
	iters: 300, epoch: 10 | loss: 0.1873465
	speed: 0.0300s/iter; left time: 997.3042s
Epoch: 10 cost time: 11.262332677841187
Epoch: 10, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.347 Vali Acc: 0.656 Test Loss: 1.347 Test Acc: 0.656
Validation loss decreased (-0.653222 --> -0.656059).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1347858
	speed: 0.1399s/iter; left time: 4630.6678s
	iters: 200, epoch: 11 | loss: 0.1121248
	speed: 0.0284s/iter; left time: 937.5210s
	iters: 300, epoch: 11 | loss: 0.3733369
	speed: 0.0277s/iter; left time: 913.0410s
Epoch: 11 cost time: 11.344074010848999
Epoch: 11, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.396 Vali Acc: 0.648 Test Loss: 1.396 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1273594
	speed: 0.1539s/iter; left time: 5037.7683s
	iters: 200, epoch: 12 | loss: 0.1988790
	speed: 0.0331s/iter; left time: 1082.0050s
	iters: 300, epoch: 12 | loss: 0.1034130
	speed: 0.0332s/iter; left time: 1081.4099s
Epoch: 12 cost time: 13.12982726097107
Epoch: 12, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.527 Vali Acc: 0.648 Test Loss: 1.527 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2237044
	speed: 0.1527s/iter; left time: 4942.9424s
	iters: 200, epoch: 13 | loss: 0.0946515
	speed: 0.0328s/iter; left time: 1057.8966s
	iters: 300, epoch: 13 | loss: 0.0708122
	speed: 0.0327s/iter; left time: 1051.0664s
Epoch: 13 cost time: 12.90448522567749
Epoch: 13, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.596 Vali Acc: 0.651 Test Loss: 1.596 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0687423
	speed: 0.1441s/iter; left time: 4612.8905s
	iters: 200, epoch: 14 | loss: 0.0715660
	speed: 0.0334s/iter; left time: 1066.9361s
	iters: 300, epoch: 14 | loss: 0.1406776
	speed: 0.0338s/iter; left time: 1074.8112s
Epoch: 14 cost time: 13.120777606964111
Epoch: 14, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.687 Vali Acc: 0.650 Test Loss: 1.687 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0761481
	speed: 0.1411s/iter; left time: 4465.0581s
	iters: 200, epoch: 15 | loss: 0.0312776
	speed: 0.0288s/iter; left time: 906.7866s
	iters: 300, epoch: 15 | loss: 0.1541687
	speed: 0.0281s/iter; left time: 882.1428s
Epoch: 15 cost time: 11.808546781539917
Epoch: 15, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.682 Vali Acc: 0.641 Test Loss: 1.682 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0576993
	speed: 0.1409s/iter; left time: 4406.1030s
	iters: 200, epoch: 16 | loss: 0.0582409
	speed: 0.0300s/iter; left time: 933.5332s
	iters: 300, epoch: 16 | loss: 0.0598669
	speed: 0.0273s/iter; left time: 848.2184s
Epoch: 16 cost time: 11.444510698318481
Epoch: 16, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.752 Vali Acc: 0.645 Test Loss: 1.752 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0090183
	speed: 0.1425s/iter; left time: 4402.4260s
	iters: 200, epoch: 17 | loss: 0.2281387
	speed: 0.0285s/iter; left time: 878.7218s
	iters: 300, epoch: 17 | loss: 0.0033616
	speed: 0.0293s/iter; left time: 897.9866s
Epoch: 17 cost time: 11.36800241470337
Epoch: 17, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.821 Vali Acc: 0.646 Test Loss: 1.821 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0380869
	speed: 0.1409s/iter; left time: 4300.3279s
	iters: 200, epoch: 18 | loss: 0.1192792
	speed: 0.0247s/iter; left time: 750.1879s
	iters: 300, epoch: 18 | loss: 0.0267981
	speed: 0.0330s/iter; left time: 999.3805s
Epoch: 18 cost time: 11.630213975906372
Epoch: 18, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.866 Vali Acc: 0.650 Test Loss: 1.866 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0281736
	speed: 0.1395s/iter; left time: 4205.7964s
	iters: 200, epoch: 19 | loss: 0.0176138
	speed: 0.0337s/iter; left time: 1013.6872s
	iters: 300, epoch: 19 | loss: 0.1432192
	speed: 0.0329s/iter; left time: 984.3970s
Epoch: 19 cost time: 13.076236963272095
Epoch: 19, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.896 Vali Acc: 0.650 Test Loss: 1.896 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1956662
	speed: 0.1464s/iter; left time: 4359.8658s
	iters: 200, epoch: 20 | loss: 0.0577393
	speed: 0.0339s/iter; left time: 1007.3080s
	iters: 300, epoch: 20 | loss: 0.0897450
	speed: 0.0332s/iter; left time: 982.9311s
Epoch: 20 cost time: 13.208511114120483
Epoch: 20, Steps: 369 | Train Loss: 0.078 Vali Loss: 1.937 Vali Acc: 0.653 Test Loss: 1.937 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.656072644721907
model parameter : 62050
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9245946
	speed: 0.0484s/iter; left time: 1781.5870s
	iters: 200, epoch: 1 | loss: 0.4129330
	speed: 0.0279s/iter; left time: 1024.2381s
	iters: 300, epoch: 1 | loss: 0.4951164
	speed: 0.0211s/iter; left time: 773.0450s
Epoch: 1 cost time: 11.713286638259888
Epoch: 1, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.915 Vali Acc: 0.638 Test Loss: 0.915 Test Acc: 0.638
Validation loss decreased (inf --> -0.637902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0432882
	speed: 0.1310s/iter; left time: 4773.1611s
	iters: 200, epoch: 2 | loss: 1.3956771
	speed: 0.0251s/iter; left time: 913.0135s
	iters: 300, epoch: 2 | loss: 0.9602302
	speed: 0.0253s/iter; left time: 916.6293s
Epoch: 2 cost time: 9.969483375549316
Epoch: 2, Steps: 369 | Train Loss: 0.731 Vali Loss: 1.170 Vali Acc: 0.638 Test Loss: 1.170 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6342825
	speed: 0.1332s/iter; left time: 4801.9980s
	iters: 200, epoch: 3 | loss: 1.0399350
	speed: 0.0309s/iter; left time: 1111.8459s
	iters: 300, epoch: 3 | loss: 0.4979648
	speed: 0.0310s/iter; left time: 1110.6284s
Epoch: 3 cost time: 11.736933469772339
Epoch: 3, Steps: 369 | Train Loss: 0.675 Vali Loss: 1.312 Vali Acc: 0.650 Test Loss: 1.312 Test Acc: 0.650
Validation loss decreased (-0.637902 --> -0.649533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7942098
	speed: 0.1352s/iter; left time: 4824.7111s
	iters: 200, epoch: 4 | loss: 1.5131540
	speed: 0.0309s/iter; left time: 1100.8449s
	iters: 300, epoch: 4 | loss: 0.6660147
	speed: 0.0313s/iter; left time: 1112.0154s
Epoch: 4 cost time: 12.185919761657715
Epoch: 4, Steps: 369 | Train Loss: 0.598 Vali Loss: 1.438 Vali Acc: 0.642 Test Loss: 1.438 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7596660
	speed: 0.1289s/iter; left time: 4553.6417s
	iters: 200, epoch: 5 | loss: 0.2968612
	speed: 0.0315s/iter; left time: 1108.1796s
	iters: 300, epoch: 5 | loss: 0.7765224
	speed: 0.0315s/iter; left time: 1106.2160s
Epoch: 5 cost time: 12.252315521240234
Epoch: 5, Steps: 369 | Train Loss: 0.492 Vali Loss: 1.396 Vali Acc: 0.644 Test Loss: 1.396 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3652549
	speed: 0.1277s/iter; left time: 4465.1221s
	iters: 200, epoch: 6 | loss: 0.2825279
	speed: 0.0319s/iter; left time: 1113.0293s
	iters: 300, epoch: 6 | loss: 0.8272257
	speed: 0.0316s/iter; left time: 1096.5601s
Epoch: 6 cost time: 12.263520002365112
Epoch: 6, Steps: 369 | Train Loss: 0.446 Vali Loss: 1.377 Vali Acc: 0.645 Test Loss: 1.377 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5537125
	speed: 0.1292s/iter; left time: 4468.0035s
	iters: 200, epoch: 7 | loss: 0.0998614
	speed: 0.0265s/iter; left time: 914.3541s
	iters: 300, epoch: 7 | loss: 0.5376580
	speed: 0.0259s/iter; left time: 892.3159s
Epoch: 7 cost time: 10.616679191589355
Epoch: 7, Steps: 369 | Train Loss: 0.391 Vali Loss: 1.423 Vali Acc: 0.628 Test Loss: 1.423 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1027398
	speed: 0.1415s/iter; left time: 4841.7248s
	iters: 200, epoch: 8 | loss: 0.0783733
	speed: 0.0250s/iter; left time: 853.3528s
	iters: 300, epoch: 8 | loss: 0.4421487
	speed: 0.0215s/iter; left time: 729.9194s
Epoch: 8 cost time: 9.665519714355469
Epoch: 8, Steps: 369 | Train Loss: 0.308 Vali Loss: 1.394 Vali Acc: 0.641 Test Loss: 1.394 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.3355045
	speed: 0.1423s/iter; left time: 4815.8724s
	iters: 200, epoch: 9 | loss: 0.0213994
	speed: 0.0268s/iter; left time: 905.4578s
	iters: 300, epoch: 9 | loss: 0.2231459
	speed: 0.0260s/iter; left time: 875.3664s
Epoch: 9 cost time: 10.410292148590088
Epoch: 9, Steps: 369 | Train Loss: 0.260 Vali Loss: 1.300 Vali Acc: 0.654 Test Loss: 1.300 Test Acc: 0.654
Validation loss decreased (-0.649533 --> -0.653506).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0462894
	speed: 0.1448s/iter; left time: 4848.1140s
	iters: 200, epoch: 10 | loss: 0.2546576
	speed: 0.0301s/iter; left time: 1004.6198s
	iters: 300, epoch: 10 | loss: 0.1136409
	speed: 0.0308s/iter; left time: 1023.9538s
Epoch: 10 cost time: 11.98467206954956
Epoch: 10, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.383 Vali Acc: 0.643 Test Loss: 1.383 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3134676
	speed: 0.1354s/iter; left time: 4482.4996s
	iters: 200, epoch: 11 | loss: 0.4421895
	speed: 0.0304s/iter; left time: 1002.5965s
	iters: 300, epoch: 11 | loss: 0.1719775
	speed: 0.0310s/iter; left time: 1020.8251s
Epoch: 11 cost time: 12.128378868103027
Epoch: 11, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.427 Vali Acc: 0.638 Test Loss: 1.427 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2028990
	speed: 0.1365s/iter; left time: 4467.7510s
	iters: 200, epoch: 12 | loss: 0.3902888
	speed: 0.0315s/iter; left time: 1029.5301s
	iters: 300, epoch: 12 | loss: 0.0594964
	speed: 0.0312s/iter; left time: 1016.8893s
Epoch: 12 cost time: 12.3572838306427
Epoch: 12, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.438 Vali Acc: 0.637 Test Loss: 1.438 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1043466
	speed: 0.1390s/iter; left time: 4500.7809s
	iters: 200, epoch: 13 | loss: 0.0514965
	speed: 0.0315s/iter; left time: 1015.4687s
	iters: 300, epoch: 13 | loss: 0.3397282
	speed: 0.0313s/iter; left time: 1008.2620s
Epoch: 13 cost time: 12.132109880447388
Epoch: 13, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.512 Vali Acc: 0.648 Test Loss: 1.512 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0169693
	speed: 0.1397s/iter; left time: 4470.6117s
	iters: 200, epoch: 14 | loss: 0.0160025
	speed: 0.0283s/iter; left time: 902.9727s
	iters: 300, epoch: 14 | loss: 0.0817338
	speed: 0.0260s/iter; left time: 827.0413s
Epoch: 14 cost time: 10.79155945777893
Epoch: 14, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.557 Vali Acc: 0.642 Test Loss: 1.557 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0390827
	speed: 0.1355s/iter; left time: 4287.5106s
	iters: 200, epoch: 15 | loss: 0.0450410
	speed: 0.0273s/iter; left time: 860.6829s
	iters: 300, epoch: 15 | loss: 0.0017038
	speed: 0.0272s/iter; left time: 855.1519s
Epoch: 15 cost time: 10.562625885009766
Epoch: 15, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.631 Vali Acc: 0.646 Test Loss: 1.631 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1325066
	speed: 0.1381s/iter; left time: 4318.0397s
	iters: 200, epoch: 16 | loss: 0.0823885
	speed: 0.0277s/iter; left time: 864.4906s
	iters: 300, epoch: 16 | loss: 0.0756359
	speed: 0.0263s/iter; left time: 818.0610s
Epoch: 16 cost time: 10.394572257995605
Epoch: 16, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.652 Vali Acc: 0.645 Test Loss: 1.652 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2915645
	speed: 0.1257s/iter; left time: 3883.6481s
	iters: 200, epoch: 17 | loss: 0.1254279
	speed: 0.0313s/iter; left time: 963.4354s
	iters: 300, epoch: 17 | loss: 0.0797831
	speed: 0.0307s/iter; left time: 942.9454s
Epoch: 17 cost time: 12.120402336120605
Epoch: 17, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.716 Vali Acc: 0.634 Test Loss: 1.716 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0739563
	speed: 0.1395s/iter; left time: 4259.3111s
	iters: 200, epoch: 18 | loss: 0.0165721
	speed: 0.0308s/iter; left time: 936.8249s
	iters: 300, epoch: 18 | loss: 0.0206627
	speed: 0.0310s/iter; left time: 939.8999s
Epoch: 18 cost time: 12.28786826133728
Epoch: 18, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.738 Vali Acc: 0.650 Test Loss: 1.738 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1442570
	speed: 0.1350s/iter; left time: 4072.2938s
	iters: 200, epoch: 19 | loss: 0.2431698
	speed: 0.0318s/iter; left time: 955.2146s
	iters: 300, epoch: 19 | loss: 0.3436002
	speed: 0.0318s/iter; left time: 953.3323s
Epoch: 19 cost time: 12.425139665603638
Epoch: 19, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.835 Vali Acc: 0.640 Test Loss: 1.835 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6535187287173666
model parameter : 48274
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9074501
	speed: 0.0432s/iter; left time: 1590.1435s
	iters: 200, epoch: 1 | loss: 0.6801779
	speed: 0.0267s/iter; left time: 979.5601s
	iters: 300, epoch: 1 | loss: 0.6661658
	speed: 0.0240s/iter; left time: 879.4333s
Epoch: 1 cost time: 11.218491077423096
Epoch: 1, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.883 Vali Acc: 0.663 Test Loss: 0.883 Test Acc: 0.663
Validation loss decreased (inf --> -0.663158).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6612927
	speed: 0.1378s/iter; left time: 5020.1005s
	iters: 200, epoch: 2 | loss: 1.4136382
	speed: 0.0289s/iter; left time: 1050.0692s
	iters: 300, epoch: 2 | loss: 0.4732293
	speed: 0.0288s/iter; left time: 1044.9205s
Epoch: 2 cost time: 11.262363195419312
Epoch: 2, Steps: 369 | Train Loss: 0.676 Vali Loss: 1.021 Vali Acc: 0.645 Test Loss: 1.021 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1045427
	speed: 0.1333s/iter; left time: 4806.1054s
	iters: 200, epoch: 3 | loss: 0.5083451
	speed: 0.0279s/iter; left time: 1004.3737s
	iters: 300, epoch: 3 | loss: 0.7629757
	speed: 0.0287s/iter; left time: 1030.9130s
Epoch: 3 cost time: 11.29783296585083
Epoch: 3, Steps: 369 | Train Loss: 0.641 Vali Loss: 1.259 Vali Acc: 0.635 Test Loss: 1.259 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.3006351
	speed: 0.1339s/iter; left time: 4779.1845s
	iters: 200, epoch: 4 | loss: 0.4498291
	speed: 0.0287s/iter; left time: 1021.5861s
	iters: 300, epoch: 4 | loss: 1.2787118
	speed: 0.0294s/iter; left time: 1042.3912s
Epoch: 4 cost time: 11.405147552490234
Epoch: 4, Steps: 369 | Train Loss: 0.607 Vali Loss: 1.417 Vali Acc: 0.639 Test Loss: 1.417 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.1478208
	speed: 0.1190s/iter; left time: 4204.5514s
	iters: 200, epoch: 5 | loss: 0.2946978
	speed: 0.0289s/iter; left time: 1018.6302s
	iters: 300, epoch: 5 | loss: 0.4797141
	speed: 0.0292s/iter; left time: 1026.9999s
Epoch: 5 cost time: 11.008413791656494
Epoch: 5, Steps: 369 | Train Loss: 0.544 Vali Loss: 1.247 Vali Acc: 0.654 Test Loss: 1.247 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9497447
	speed: 0.1189s/iter; left time: 4156.7306s
	iters: 200, epoch: 6 | loss: 0.2180640
	speed: 0.0274s/iter; left time: 956.4704s
	iters: 300, epoch: 6 | loss: 0.1932988
	speed: 0.0246s/iter; left time: 854.5823s
Epoch: 6 cost time: 10.346664667129517
Epoch: 6, Steps: 369 | Train Loss: 0.468 Vali Loss: 1.233 Vali Acc: 0.654 Test Loss: 1.233 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0507968
	speed: 0.1227s/iter; left time: 4242.8422s
	iters: 200, epoch: 7 | loss: 0.1007320
	speed: 0.0227s/iter; left time: 784.0536s
	iters: 300, epoch: 7 | loss: 0.3674383
	speed: 0.0241s/iter; left time: 827.7475s
Epoch: 7 cost time: 9.332516431808472
Epoch: 7, Steps: 369 | Train Loss: 0.424 Vali Loss: 1.193 Vali Acc: 0.643 Test Loss: 1.193 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.1775481
	speed: 0.1245s/iter; left time: 4260.8430s
	iters: 200, epoch: 8 | loss: 0.2604822
	speed: 0.0245s/iter; left time: 835.2818s
	iters: 300, epoch: 8 | loss: 0.5336616
	speed: 0.0242s/iter; left time: 823.5137s
Epoch: 8 cost time: 9.544487953186035
Epoch: 8, Steps: 369 | Train Loss: 0.349 Vali Loss: 1.157 Vali Acc: 0.661 Test Loss: 1.157 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4947578
	speed: 0.1174s/iter; left time: 3975.1848s
	iters: 200, epoch: 9 | loss: 0.2520839
	speed: 0.0282s/iter; left time: 953.3965s
	iters: 300, epoch: 9 | loss: 0.3624790
	speed: 0.0281s/iter; left time: 945.9191s
Epoch: 9 cost time: 11.07847547531128
Epoch: 9, Steps: 369 | Train Loss: 0.305 Vali Loss: 1.175 Vali Acc: 0.652 Test Loss: 1.175 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.3788235
	speed: 0.1226s/iter; left time: 4103.8036s
	iters: 200, epoch: 10 | loss: 0.1315256
	speed: 0.0283s/iter; left time: 943.3803s
	iters: 300, epoch: 10 | loss: 0.3038059
	speed: 0.0284s/iter; left time: 946.4697s
Epoch: 10 cost time: 11.17803144454956
Epoch: 10, Steps: 369 | Train Loss: 0.278 Vali Loss: 1.224 Vali Acc: 0.648 Test Loss: 1.224 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0674585
	speed: 0.1188s/iter; left time: 3932.1355s
	iters: 200, epoch: 11 | loss: 0.1185277
	speed: 0.0294s/iter; left time: 971.5736s
	iters: 300, epoch: 11 | loss: 0.2088645
	speed: 0.0293s/iter; left time: 964.0326s
Epoch: 11 cost time: 11.51728081703186
Epoch: 11, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.206 Vali Acc: 0.658 Test Loss: 1.206 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.66316685584563
model parameter : 39106
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.5890572
	speed: 0.2566s/iter; left time: 9442.5297s
	iters: 200, epoch: 1 | loss: 4.0917330
	speed: 0.2352s/iter; left time: 8633.6326s
	iters: 300, epoch: 1 | loss: 1.7588866
	speed: 0.2282s/iter; left time: 8354.1663s
Epoch: 1 cost time: 87.5481641292572
Epoch: 1, Steps: 369 | Train Loss: 4.812 Vali Loss: 7.644 Vali Acc: 0.505 Test Loss: 7.644 Test Acc: 0.505
Validation loss decreased (inf --> -0.505031).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7387609
	speed: 0.7232s/iter; left time: 26348.9017s
	iters: 200, epoch: 2 | loss: 5.7583370
	speed: 0.2270s/iter; left time: 8245.7488s
	iters: 300, epoch: 2 | loss: 3.2209492
	speed: 0.2283s/iter; left time: 8271.2227s
Epoch: 2 cost time: 84.84923505783081
Epoch: 2, Steps: 369 | Train Loss: 4.952 Vali Loss: 7.905 Vali Acc: 0.613 Test Loss: 7.905 Test Acc: 0.613
Validation loss decreased (-0.505031 --> -0.612861).  Saving model ...
	iters: 100, epoch: 3 | loss: 6.0676107
	speed: 0.7229s/iter; left time: 26070.7786s
	iters: 200, epoch: 3 | loss: 15.2251186
	speed: 0.2267s/iter; left time: 8152.0922s
	iters: 300, epoch: 3 | loss: 9.4494772
	speed: 0.2292s/iter; left time: 8221.0611s
Epoch: 3 cost time: 85.23061990737915
Epoch: 3, Steps: 369 | Train Loss: 7.186 Vali Loss: 5.518 Vali Acc: 0.649 Test Loss: 5.518 Test Acc: 0.649
Validation loss decreased (-0.612861 --> -0.648639).  Saving model ...
	iters: 100, epoch: 4 | loss: 6.2178841
	speed: 0.7351s/iter; left time: 26237.3523s
	iters: 200, epoch: 4 | loss: 14.1095514
	speed: 0.2307s/iter; left time: 8212.0971s
	iters: 300, epoch: 4 | loss: 0.0000139
	speed: 0.2332s/iter; left time: 8276.0546s
Epoch: 4 cost time: 86.72300100326538
Epoch: 4, Steps: 369 | Train Loss: 8.090 Vali Loss: 8.975 Vali Acc: 0.641 Test Loss: 8.975 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 7.2790008
	speed: 0.7372s/iter; left time: 26041.7724s
	iters: 200, epoch: 5 | loss: 2.6977320
	speed: 0.2332s/iter; left time: 8212.8614s
	iters: 300, epoch: 5 | loss: 11.5198622
	speed: 0.2359s/iter; left time: 8285.6276s
Epoch: 5 cost time: 85.63209915161133
Epoch: 5, Steps: 369 | Train Loss: 8.854 Vali Loss: 10.383 Vali Acc: 0.623 Test Loss: 10.383 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 5.0319324
	speed: 0.7274s/iter; left time: 25426.1537s
	iters: 200, epoch: 6 | loss: 14.6801271
	speed: 0.2265s/iter; left time: 7894.6702s
	iters: 300, epoch: 6 | loss: 13.0126095
	speed: 0.2382s/iter; left time: 8278.1306s
Epoch: 6 cost time: 86.29575204849243
Epoch: 6, Steps: 369 | Train Loss: 8.846 Vali Loss: 12.653 Vali Acc: 0.633 Test Loss: 12.653 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.9837940
	speed: 0.7460s/iter; left time: 25802.6165s
	iters: 200, epoch: 7 | loss: 14.5917273
	speed: 0.2340s/iter; left time: 8068.7035s
	iters: 300, epoch: 7 | loss: 9.3357811
	speed: 0.2305s/iter; left time: 7926.9582s
Epoch: 7 cost time: 85.99565529823303
Epoch: 7, Steps: 369 | Train Loss: 8.024 Vali Loss: 18.394 Vali Acc: 0.641 Test Loss: 18.394 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 4.4788804
	speed: 0.7268s/iter; left time: 24868.3669s
	iters: 200, epoch: 8 | loss: 13.8494644
	speed: 0.2316s/iter; left time: 7901.0274s
	iters: 300, epoch: 8 | loss: 7.7540698
	speed: 0.2396s/iter; left time: 8151.8411s
Epoch: 8 cost time: 86.8311698436737
Epoch: 8, Steps: 369 | Train Loss: 6.747 Vali Loss: 19.354 Vali Acc: 0.649 Test Loss: 19.354 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648785).  Saving model ...
	iters: 100, epoch: 9 | loss: 7.0654550
	speed: 0.7422s/iter; left time: 25124.0107s
	iters: 200, epoch: 9 | loss: 14.3317156
	speed: 0.2346s/iter; left time: 7918.0076s
	iters: 300, epoch: 9 | loss: 6.6769991
	speed: 0.2331s/iter; left time: 7843.8885s
Epoch: 9 cost time: 86.16359424591064
Epoch: 9, Steps: 369 | Train Loss: 5.846 Vali Loss: 21.426 Vali Acc: 0.640 Test Loss: 21.426 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2190427
	speed: 0.7375s/iter; left time: 24692.8878s
	iters: 200, epoch: 10 | loss: 9.4180241
	speed: 0.2440s/iter; left time: 8143.1245s
	iters: 300, epoch: 10 | loss: 0.1525445
	speed: 0.2295s/iter; left time: 7636.8825s
Epoch: 10 cost time: 87.4471161365509
Epoch: 10, Steps: 369 | Train Loss: 4.342 Vali Loss: 29.140 Vali Acc: 0.621 Test Loss: 29.140 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5407549
	speed: 0.7244s/iter; left time: 23987.2576s
	iters: 200, epoch: 11 | loss: 0.4558627
	speed: 0.2246s/iter; left time: 7413.5136s
	iters: 300, epoch: 11 | loss: 15.5105581
	speed: 0.2305s/iter; left time: 7586.6484s
Epoch: 11 cost time: 84.95609831809998
Epoch: 11, Steps: 369 | Train Loss: 3.744 Vali Loss: 28.390 Vali Acc: 0.623 Test Loss: 28.390 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 6.8692279
	speed: 0.7460s/iter; left time: 24426.0872s
	iters: 200, epoch: 12 | loss: 1.4882364
	speed: 0.2336s/iter; left time: 7623.6385s
	iters: 300, epoch: 12 | loss: 0.1156173
	speed: 0.2380s/iter; left time: 7746.5586s
Epoch: 12 cost time: 87.45201063156128
Epoch: 12, Steps: 369 | Train Loss: 3.160 Vali Loss: 23.665 Vali Acc: 0.621 Test Loss: 23.665 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 3.5189855
	speed: 0.6721s/iter; left time: 21758.3587s
	iters: 200, epoch: 13 | loss: 6.7702236
	speed: 0.2217s/iter; left time: 7154.5558s
	iters: 300, epoch: 13 | loss: 5.3453865
	speed: 0.2220s/iter; left time: 7143.4098s
Epoch: 13 cost time: 79.2665159702301
Epoch: 13, Steps: 369 | Train Loss: 2.017 Vali Loss: 24.410 Vali Acc: 0.633 Test Loss: 24.410 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 3.2836254
	speed: 0.6941s/iter; left time: 22213.8820s
	iters: 200, epoch: 14 | loss: 3.5014162
	speed: 0.2218s/iter; left time: 7077.3418s
	iters: 300, epoch: 14 | loss: 0.0010093
	speed: 0.2255s/iter; left time: 7172.1640s
Epoch: 14 cost time: 83.44274163246155
Epoch: 14, Steps: 369 | Train Loss: 1.561 Vali Loss: 25.341 Vali Acc: 0.632 Test Loss: 25.341 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 2.5557296
	speed: 0.7185s/iter; left time: 22728.5568s
	iters: 200, epoch: 15 | loss: 0.0000926
	speed: 0.2251s/iter; left time: 7099.4970s
	iters: 300, epoch: 15 | loss: 0.0000843
	speed: 0.2188s/iter; left time: 6878.7799s
Epoch: 15 cost time: 83.417067527771
Epoch: 15, Steps: 369 | Train Loss: 1.534 Vali Loss: 22.523 Vali Acc: 0.630 Test Loss: 22.523 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000144
	speed: 0.7140s/iter; left time: 22324.8011s
	iters: 200, epoch: 16 | loss: 2.0921054
	speed: 0.2250s/iter; left time: 7011.3144s
	iters: 300, epoch: 16 | loss: 2.8630331
	speed: 0.2220s/iter; left time: 6896.2686s
Epoch: 16 cost time: 82.67744660377502
Epoch: 16, Steps: 369 | Train Loss: 1.257 Vali Loss: 21.274 Vali Acc: 0.628 Test Loss: 21.274 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7080s/iter; left time: 21873.5539s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2254s/iter; left time: 6942.3378s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2257s/iter; left time: 6928.4920s
Epoch: 17 cost time: 83.63897466659546
Epoch: 17, Steps: 369 | Train Loss: 1.001 Vali Loss: 19.410 Vali Acc: 0.629 Test Loss: 19.410 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.7229s/iter; left time: 22067.8119s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2266s/iter; left time: 6894.2915s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2205s/iter; left time: 6688.6406s
Epoch: 18 cost time: 83.49039936065674
Epoch: 18, Steps: 369 | Train Loss: 0.608 Vali Loss: 17.733 Vali Acc: 0.625 Test Loss: 17.733 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6489784335981839
model parameter : 2418562
model size : 11.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.9067659
	speed: 0.1094s/iter; left time: 4025.6528s
	iters: 200, epoch: 1 | loss: 1.7154044
	speed: 0.0956s/iter; left time: 3509.1780s
	iters: 300, epoch: 1 | loss: 1.1454092
	speed: 0.0979s/iter; left time: 3583.5485s
Epoch: 1 cost time: 37.17726755142212
Epoch: 1, Steps: 369 | Train Loss: 2.836 Vali Loss: 1.569 Vali Acc: 0.651 Test Loss: 1.569 Test Acc: 0.651
Validation loss decreased (inf --> -0.650949).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8761474
	speed: 0.3504s/iter; left time: 12764.6679s
	iters: 200, epoch: 2 | loss: 2.9818509
	speed: 0.0966s/iter; left time: 3509.3265s
	iters: 300, epoch: 2 | loss: 5.5253201
	speed: 0.0985s/iter; left time: 3567.1313s
Epoch: 2 cost time: 36.709118366241455
Epoch: 2, Steps: 369 | Train Loss: 3.252 Vali Loss: 3.669 Vali Acc: 0.643 Test Loss: 3.669 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9370425
	speed: 0.3613s/iter; left time: 13027.8335s
	iters: 200, epoch: 3 | loss: 4.2004910
	speed: 0.1026s/iter; left time: 3690.7132s
	iters: 300, epoch: 3 | loss: 4.4679651
	speed: 0.1004s/iter; left time: 3598.9273s
Epoch: 3 cost time: 38.090362310409546
Epoch: 3, Steps: 369 | Train Loss: 4.838 Vali Loss: 5.104 Vali Acc: 0.650 Test Loss: 5.104 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 8.1690521
	speed: 0.3667s/iter; left time: 13087.6002s
	iters: 200, epoch: 4 | loss: 4.7677193
	speed: 0.1019s/iter; left time: 3628.5626s
	iters: 300, epoch: 4 | loss: 16.8886681
	speed: 0.1029s/iter; left time: 3651.0398s
Epoch: 4 cost time: 38.21628999710083
Epoch: 4, Steps: 369 | Train Loss: 5.915 Vali Loss: 7.658 Vali Acc: 0.624 Test Loss: 7.658 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 9.8646688
	speed: 0.3593s/iter; left time: 12690.6708s
	iters: 200, epoch: 5 | loss: 0.8726015
	speed: 0.1014s/iter; left time: 3570.1446s
	iters: 300, epoch: 5 | loss: 0.0400683
	speed: 0.1014s/iter; left time: 3560.5844s
Epoch: 5 cost time: 37.939178228378296
Epoch: 5, Steps: 369 | Train Loss: 6.092 Vali Loss: 7.215 Vali Acc: 0.668 Test Loss: 7.215 Test Acc: 0.668
Validation loss decreased (-0.650949 --> -0.667919).  Saving model ...
	iters: 100, epoch: 6 | loss: 7.0535674
	speed: 0.3629s/iter; left time: 12685.6725s
	iters: 200, epoch: 6 | loss: 10.7496910
	speed: 0.1001s/iter; left time: 3490.3559s
	iters: 300, epoch: 6 | loss: 8.8041840
	speed: 0.0971s/iter; left time: 3374.9714s
Epoch: 6 cost time: 37.566487550735474
Epoch: 6, Steps: 369 | Train Loss: 5.978 Vali Loss: 10.783 Vali Acc: 0.645 Test Loss: 10.783 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.9398329
	speed: 0.3629s/iter; left time: 12550.5801s
	iters: 200, epoch: 7 | loss: 7.5074234
	speed: 0.1040s/iter; left time: 3585.8442s
	iters: 300, epoch: 7 | loss: 7.6323066
	speed: 0.1015s/iter; left time: 3489.2844s
Epoch: 7 cost time: 38.33251929283142
Epoch: 7, Steps: 369 | Train Loss: 6.106 Vali Loss: 8.995 Vali Acc: 0.661 Test Loss: 8.995 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.1960764
	speed: 0.3658s/iter; left time: 12516.7796s
	iters: 200, epoch: 8 | loss: 1.4602523
	speed: 0.1030s/iter; left time: 3512.8462s
	iters: 300, epoch: 8 | loss: 3.8769546
	speed: 0.1023s/iter; left time: 3481.0600s
Epoch: 8 cost time: 37.98574781417847
Epoch: 8, Steps: 369 | Train Loss: 4.920 Vali Loss: 13.188 Vali Acc: 0.628 Test Loss: 13.188 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6832466
	speed: 0.3671s/iter; left time: 12425.9830s
	iters: 200, epoch: 9 | loss: 6.4244442
	speed: 0.1031s/iter; left time: 3478.5176s
	iters: 300, epoch: 9 | loss: 0.7217212
	speed: 0.0992s/iter; left time: 3338.3878s
Epoch: 9 cost time: 38.34690475463867
Epoch: 9, Steps: 369 | Train Loss: 4.635 Vali Loss: 11.427 Vali Acc: 0.633 Test Loss: 11.427 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.9275765
	speed: 0.3759s/iter; left time: 12585.1893s
	iters: 200, epoch: 10 | loss: 2.6382604
	speed: 0.1028s/iter; left time: 3430.2054s
	iters: 300, epoch: 10 | loss: 12.4013329
	speed: 0.1030s/iter; left time: 3428.4061s
Epoch: 10 cost time: 38.86962032318115
Epoch: 10, Steps: 369 | Train Loss: 3.657 Vali Loss: 12.597 Vali Acc: 0.666 Test Loss: 12.597 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.9013638
	speed: 0.3791s/iter; left time: 12553.2763s
	iters: 200, epoch: 11 | loss: 1.0760937
	speed: 0.1034s/iter; left time: 3414.1989s
	iters: 300, epoch: 11 | loss: 2.6391661
	speed: 0.1018s/iter; left time: 3351.1152s
Epoch: 11 cost time: 38.50398230552673
Epoch: 11, Steps: 369 | Train Loss: 2.870 Vali Loss: 14.894 Vali Acc: 0.625 Test Loss: 14.894 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.1186974
	speed: 0.3726s/iter; left time: 12198.7777s
	iters: 200, epoch: 12 | loss: 2.6909661
	speed: 0.1003s/iter; left time: 3273.1641s
	iters: 300, epoch: 12 | loss: 4.2730994
	speed: 0.0965s/iter; left time: 3140.7827s
Epoch: 12 cost time: 37.71066689491272
Epoch: 12, Steps: 369 | Train Loss: 2.177 Vali Loss: 12.404 Vali Acc: 0.630 Test Loss: 12.404 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0848677
	speed: 0.3715s/iter; left time: 12025.2055s
	iters: 200, epoch: 13 | loss: 0.0019682
	speed: 0.1024s/iter; left time: 3304.9454s
	iters: 300, epoch: 13 | loss: 1.9215865
	speed: 0.1023s/iter; left time: 3292.7491s
Epoch: 13 cost time: 38.44544839859009
Epoch: 13, Steps: 369 | Train Loss: 1.740 Vali Loss: 13.226 Vali Acc: 0.624 Test Loss: 13.226 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0178603
	speed: 0.3682s/iter; left time: 11783.1770s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 3247.1514s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 3150.1037s
Epoch: 14 cost time: 38.358569383621216
Epoch: 14, Steps: 369 | Train Loss: 1.274 Vali Loss: 12.309 Vali Acc: 0.626 Test Loss: 12.309 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4093291
	speed: 0.3715s/iter; left time: 11752.0341s
	iters: 200, epoch: 15 | loss: 1.0866827
	speed: 0.1013s/iter; left time: 3195.5867s
	iters: 300, epoch: 15 | loss: 0.0003095
	speed: 0.1004s/iter; left time: 3156.1723s
Epoch: 15 cost time: 38.330190658569336
Epoch: 15, Steps: 369 | Train Loss: 1.180 Vali Loss: 11.667 Vali Acc: 0.646 Test Loss: 11.667 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 1276034
model size : 7.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.7900069
	speed: 0.0966s/iter; left time: 3555.2805s
	iters: 200, epoch: 1 | loss: 3.0354486
	speed: 0.0775s/iter; left time: 2843.9419s
	iters: 300, epoch: 1 | loss: 1.6954364
	speed: 0.0772s/iter; left time: 2825.6858s
Epoch: 1 cost time: 30.458415508270264
Epoch: 1, Steps: 369 | Train Loss: 2.346 Vali Loss: 1.555 Vali Acc: 0.660 Test Loss: 1.555 Test Acc: 0.660
Validation loss decreased (inf --> -0.660030).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3946962
	speed: 0.2954s/iter; left time: 10762.7247s
	iters: 200, epoch: 2 | loss: 3.1597912
	speed: 0.0727s/iter; left time: 2642.7299s
	iters: 300, epoch: 2 | loss: 7.1063676
	speed: 0.0778s/iter; left time: 2817.0408s
Epoch: 2 cost time: 28.608689546585083
Epoch: 2, Steps: 369 | Train Loss: 2.894 Vali Loss: 2.743 Vali Acc: 0.643 Test Loss: 2.743 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8890188
	speed: 0.2940s/iter; left time: 10600.7540s
	iters: 200, epoch: 3 | loss: 3.3187687
	speed: 0.0777s/iter; left time: 2795.8035s
	iters: 300, epoch: 3 | loss: 8.8835316
	speed: 0.0762s/iter; left time: 2733.9374s
Epoch: 3 cost time: 28.801380395889282
Epoch: 3, Steps: 369 | Train Loss: 4.092 Vali Loss: 5.503 Vali Acc: 0.627 Test Loss: 5.503 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 7.6080098
	speed: 0.2962s/iter; left time: 10572.6189s
	iters: 200, epoch: 4 | loss: 4.8072357
	speed: 0.0782s/iter; left time: 2782.3442s
	iters: 300, epoch: 4 | loss: 6.7797837
	speed: 0.0778s/iter; left time: 2760.8014s
Epoch: 4 cost time: 29.39065647125244
Epoch: 4, Steps: 369 | Train Loss: 4.547 Vali Loss: 4.601 Vali Acc: 0.642 Test Loss: 4.601 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.4119501
	speed: 0.2926s/iter; left time: 10337.2678s
	iters: 200, epoch: 5 | loss: 2.6803460
	speed: 0.0840s/iter; left time: 2958.7919s
	iters: 300, epoch: 5 | loss: 1.5257050
	speed: 0.0800s/iter; left time: 2808.6547s
Epoch: 5 cost time: 29.587989807128906
Epoch: 5, Steps: 369 | Train Loss: 5.066 Vali Loss: 6.390 Vali Acc: 0.653 Test Loss: 6.390 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 7.2142138
	speed: 0.2993s/iter; left time: 10461.6532s
	iters: 200, epoch: 6 | loss: 3.8259554
	speed: 0.0806s/iter; left time: 2808.2874s
	iters: 300, epoch: 6 | loss: 4.1297870
	speed: 0.0778s/iter; left time: 2703.5410s
Epoch: 6 cost time: 29.098533630371094
Epoch: 6, Steps: 369 | Train Loss: 5.444 Vali Loss: 7.102 Vali Acc: 0.640 Test Loss: 7.102 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 9.8838034
	speed: 0.2945s/iter; left time: 10184.7648s
	iters: 200, epoch: 7 | loss: 1.5484431
	speed: 0.0780s/iter; left time: 2688.3841s
	iters: 300, epoch: 7 | loss: 7.8391037
	speed: 0.0783s/iter; left time: 2692.1539s
Epoch: 7 cost time: 29.447656869888306
Epoch: 7, Steps: 369 | Train Loss: 4.761 Vali Loss: 7.999 Vali Acc: 0.663 Test Loss: 7.999 Test Acc: 0.663
Validation loss decreased (-0.660030 --> -0.663087).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2273269
	speed: 0.3044s/iter; left time: 10414.7247s
	iters: 200, epoch: 8 | loss: 7.5339956
	speed: 0.0791s/iter; left time: 2699.2231s
	iters: 300, epoch: 8 | loss: 8.3454332
	speed: 0.0794s/iter; left time: 2702.3804s
Epoch: 8 cost time: 29.9798526763916
Epoch: 8, Steps: 369 | Train Loss: 4.327 Vali Loss: 11.783 Vali Acc: 0.632 Test Loss: 11.783 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2663961
	speed: 0.2999s/iter; left time: 10151.4064s
	iters: 200, epoch: 9 | loss: 2.4613645
	speed: 0.0776s/iter; left time: 2618.5491s
	iters: 300, epoch: 9 | loss: 7.0115190
	speed: 0.0755s/iter; left time: 2539.7091s
Epoch: 9 cost time: 29.22313094139099
Epoch: 9, Steps: 369 | Train Loss: 3.611 Vali Loss: 11.997 Vali Acc: 0.634 Test Loss: 11.997 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000351
	speed: 0.3068s/iter; left time: 10271.7981s
	iters: 200, epoch: 10 | loss: 1.0943866
	speed: 0.0781s/iter; left time: 2606.9966s
	iters: 300, epoch: 10 | loss: 1.3234646
	speed: 0.0779s/iter; left time: 2592.4830s
Epoch: 10 cost time: 29.375197887420654
Epoch: 10, Steps: 369 | Train Loss: 3.105 Vali Loss: 11.621 Vali Acc: 0.639 Test Loss: 11.621 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 5.3002453
	speed: 0.3007s/iter; left time: 9957.8732s
	iters: 200, epoch: 11 | loss: 5.4499354
	speed: 0.0794s/iter; left time: 2621.7105s
	iters: 300, epoch: 11 | loss: 3.8327956
	speed: 0.0789s/iter; left time: 2598.2145s
Epoch: 11 cost time: 29.847275018692017
Epoch: 11, Steps: 369 | Train Loss: 2.107 Vali Loss: 9.495 Vali Acc: 0.619 Test Loss: 9.495 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6218123
	speed: 0.3090s/iter; left time: 10117.2792s
	iters: 200, epoch: 12 | loss: 0.0695981
	speed: 0.0792s/iter; left time: 2586.1742s
	iters: 300, epoch: 12 | loss: 2.7826478
	speed: 0.0801s/iter; left time: 2606.5659s
Epoch: 12 cost time: 30.3585307598114
Epoch: 12, Steps: 369 | Train Loss: 2.022 Vali Loss: 10.164 Vali Acc: 0.646 Test Loss: 10.164 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3637602
	speed: 0.3120s/iter; left time: 10098.7681s
	iters: 200, epoch: 13 | loss: 3.0435019
	speed: 0.0799s/iter; left time: 2578.4370s
	iters: 300, epoch: 13 | loss: 4.7555385
	speed: 0.0809s/iter; left time: 2603.9906s
Epoch: 13 cost time: 30.320430755615234
Epoch: 13, Steps: 369 | Train Loss: 1.457 Vali Loss: 9.607 Vali Acc: 0.625 Test Loss: 9.607 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3540006
	speed: 0.3000s/iter; left time: 9599.7113s
	iters: 200, epoch: 14 | loss: 1.5645150
	speed: 0.0797s/iter; left time: 2543.7611s
	iters: 300, epoch: 14 | loss: 2.5781157
	speed: 0.0790s/iter; left time: 2511.4059s
Epoch: 14 cost time: 30.005906105041504
Epoch: 14, Steps: 369 | Train Loss: 1.080 Vali Loss: 9.026 Vali Acc: 0.638 Test Loss: 9.026 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2353443
	speed: 0.3085s/iter; left time: 9759.3089s
	iters: 200, epoch: 15 | loss: 1.6127746
	speed: 0.0805s/iter; left time: 2538.0873s
	iters: 300, epoch: 15 | loss: 1.3115207
	speed: 0.0801s/iter; left time: 2519.1364s
Epoch: 15 cost time: 30.311919927597046
Epoch: 15, Steps: 369 | Train Loss: 0.869 Vali Loss: 8.348 Vali Acc: 0.626 Test Loss: 8.348 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7650788
	speed: 0.3068s/iter; left time: 9593.3947s
	iters: 200, epoch: 16 | loss: 1.1665044
	speed: 0.0798s/iter; left time: 2486.0329s
	iters: 300, epoch: 16 | loss: 0.0000042
	speed: 0.0780s/iter; left time: 2422.6135s
Epoch: 16 cost time: 30.079546689987183
Epoch: 16, Steps: 369 | Train Loss: 0.645 Vali Loss: 6.821 Vali Acc: 0.635 Test Loss: 6.821 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0004920
	speed: 0.3146s/iter; left time: 9720.9566s
	iters: 200, epoch: 17 | loss: 0.0103009
	speed: 0.0791s/iter; left time: 2435.0157s
	iters: 300, epoch: 17 | loss: 0.4779388
	speed: 0.0789s/iter; left time: 2420.5668s
Epoch: 17 cost time: 29.655089378356934
Epoch: 17, Steps: 369 | Train Loss: 0.444 Vali Loss: 6.069 Vali Acc: 0.628 Test Loss: 6.069 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.66316685584563
model parameter : 907522
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.5691442
	speed: 0.0764s/iter; left time: 2810.5014s
	iters: 200, epoch: 1 | loss: 1.9092956
	speed: 0.0608s/iter; left time: 2231.1752s
	iters: 300, epoch: 1 | loss: 0.8382016
	speed: 0.0572s/iter; left time: 2093.7473s
Epoch: 1 cost time: 23.49028205871582
Epoch: 1, Steps: 369 | Train Loss: 1.935 Vali Loss: 1.194 Vali Acc: 0.662 Test Loss: 1.194 Test Acc: 0.662
Validation loss decreased (inf --> -0.662304).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4932492
	speed: 0.2355s/iter; left time: 8581.4241s
	iters: 200, epoch: 2 | loss: 1.6195608
	speed: 0.0612s/iter; left time: 2222.0607s
	iters: 300, epoch: 2 | loss: 1.6891605
	speed: 0.0588s/iter; left time: 2130.0516s
Epoch: 2 cost time: 22.801496505737305
Epoch: 2, Steps: 369 | Train Loss: 2.306 Vali Loss: 2.170 Vali Acc: 0.657 Test Loss: 2.170 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7493196
	speed: 0.2338s/iter; left time: 8430.0077s
	iters: 200, epoch: 3 | loss: 1.1689436
	speed: 0.0565s/iter; left time: 2032.3100s
	iters: 300, epoch: 3 | loss: 2.6894393
	speed: 0.0566s/iter; left time: 2031.2094s
Epoch: 3 cost time: 21.671545028686523
Epoch: 3, Steps: 369 | Train Loss: 3.400 Vali Loss: 4.066 Vali Acc: 0.654 Test Loss: 4.066 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.0013869
	speed: 0.2267s/iter; left time: 8091.8139s
	iters: 200, epoch: 4 | loss: 1.4486855
	speed: 0.0608s/iter; left time: 2165.7748s
	iters: 300, epoch: 4 | loss: 12.3492241
	speed: 0.0610s/iter; left time: 2164.1556s
Epoch: 4 cost time: 22.866360664367676
Epoch: 4, Steps: 369 | Train Loss: 3.876 Vali Loss: 4.558 Vali Acc: 0.658 Test Loss: 4.558 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3030069
	speed: 0.2286s/iter; left time: 8076.0727s
	iters: 200, epoch: 5 | loss: 3.0094764
	speed: 0.0631s/iter; left time: 2223.6932s
	iters: 300, epoch: 5 | loss: 3.6747675
	speed: 0.0592s/iter; left time: 2079.1744s
Epoch: 5 cost time: 22.676340579986572
Epoch: 5, Steps: 369 | Train Loss: 4.279 Vali Loss: 6.621 Vali Acc: 0.650 Test Loss: 6.621 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.6636910
	speed: 0.2391s/iter; left time: 8357.0335s
	iters: 200, epoch: 6 | loss: 1.7428302
	speed: 0.0637s/iter; left time: 2219.9237s
	iters: 300, epoch: 6 | loss: 4.8394561
	speed: 0.0623s/iter; left time: 2166.5453s
Epoch: 6 cost time: 23.852744817733765
Epoch: 6, Steps: 369 | Train Loss: 4.331 Vali Loss: 6.043 Vali Acc: 0.642 Test Loss: 6.043 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.2621686
	speed: 0.2339s/iter; left time: 8090.6065s
	iters: 200, epoch: 7 | loss: 5.7935643
	speed: 0.0668s/iter; left time: 2303.4314s
	iters: 300, epoch: 7 | loss: 0.8426098
	speed: 0.0491s/iter; left time: 1689.0310s
Epoch: 7 cost time: 22.238136768341064
Epoch: 7, Steps: 369 | Train Loss: 3.799 Vali Loss: 7.823 Vali Acc: 0.612 Test Loss: 7.823 Test Acc: 0.612
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 3.2372212
	speed: 0.1844s/iter; left time: 6311.3663s
	iters: 200, epoch: 8 | loss: 2.2940233
	speed: 0.0604s/iter; left time: 2061.8334s
	iters: 300, epoch: 8 | loss: 5.0164919
	speed: 0.0586s/iter; left time: 1994.7082s
Epoch: 8 cost time: 21.043018341064453
Epoch: 8, Steps: 369 | Train Loss: 3.707 Vali Loss: 9.149 Vali Acc: 0.614 Test Loss: 9.149 Test Acc: 0.614
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 3.7088919
	speed: 0.2238s/iter; left time: 7575.8833s
	iters: 200, epoch: 9 | loss: 5.2842326
	speed: 0.0567s/iter; left time: 1912.8633s
	iters: 300, epoch: 9 | loss: 1.7721562
	speed: 0.0565s/iter; left time: 1901.9965s
Epoch: 9 cost time: 21.516175508499146
Epoch: 9, Steps: 369 | Train Loss: 3.335 Vali Loss: 8.931 Vali Acc: 0.627 Test Loss: 8.931 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.9446062
	speed: 0.2300s/iter; left time: 7700.3017s
	iters: 200, epoch: 10 | loss: 5.9495459
	speed: 0.0570s/iter; left time: 1902.1208s
	iters: 300, epoch: 10 | loss: 1.5388612
	speed: 0.0549s/iter; left time: 1828.1282s
Epoch: 10 cost time: 21.463892936706543
Epoch: 10, Steps: 369 | Train Loss: 3.147 Vali Loss: 8.976 Vali Acc: 0.638 Test Loss: 8.976 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.9968605
	speed: 0.2286s/iter; left time: 7567.6281s
	iters: 200, epoch: 11 | loss: 2.4218853
	speed: 0.0568s/iter; left time: 1874.5249s
	iters: 300, epoch: 11 | loss: 2.4402802
	speed: 0.0587s/iter; left time: 1931.4877s
Epoch: 11 cost time: 21.843393564224243
Epoch: 11, Steps: 369 | Train Loss: 2.291 Vali Loss: 9.473 Vali Acc: 0.626 Test Loss: 9.473 Test Acc: 0.626
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6623155505107832
model parameter : 686594
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2583340
	speed: 0.0655s/iter; left time: 2411.2750s
	iters: 200, epoch: 1 | loss: 1.5555477
	speed: 0.0474s/iter; left time: 1739.4427s
	iters: 300, epoch: 1 | loss: 1.3171977
	speed: 0.0474s/iter; left time: 1733.3195s
Epoch: 1 cost time: 19.43197226524353
Epoch: 1, Steps: 369 | Train Loss: 1.825 Vali Loss: 1.239 Vali Acc: 0.642 Test Loss: 1.239 Test Acc: 0.642
Validation loss decreased (inf --> -0.641588).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7673764
	speed: 0.1801s/iter; left time: 6561.3130s
	iters: 200, epoch: 2 | loss: 1.4895893
	speed: 0.0488s/iter; left time: 1772.7113s
	iters: 300, epoch: 2 | loss: 1.8845993
	speed: 0.0478s/iter; left time: 1730.6671s
Epoch: 2 cost time: 18.28860902786255
Epoch: 2, Steps: 369 | Train Loss: 1.999 Vali Loss: 2.470 Vali Acc: 0.653 Test Loss: 2.470 Test Acc: 0.653
Validation loss decreased (-0.641588 --> -0.653210).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0786090
	speed: 0.1783s/iter; left time: 6428.8495s
	iters: 200, epoch: 3 | loss: 1.0614474
	speed: 0.0482s/iter; left time: 1732.5640s
	iters: 300, epoch: 3 | loss: 0.4388373
	speed: 0.0492s/iter; left time: 1766.0108s
Epoch: 3 cost time: 18.52024555206299
Epoch: 3, Steps: 369 | Train Loss: 2.818 Vali Loss: 3.912 Vali Acc: 0.641 Test Loss: 3.912 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0704913
	speed: 0.1855s/iter; left time: 6621.3432s
	iters: 200, epoch: 4 | loss: 2.7841179
	speed: 0.0492s/iter; left time: 1750.9449s
	iters: 300, epoch: 4 | loss: 3.7551692
	speed: 0.0488s/iter; left time: 1732.9391s
Epoch: 4 cost time: 18.658259630203247
Epoch: 4, Steps: 369 | Train Loss: 3.376 Vali Loss: 3.748 Vali Acc: 0.646 Test Loss: 3.748 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7539482
	speed: 0.1865s/iter; left time: 6588.5372s
	iters: 200, epoch: 5 | loss: 2.0561428
	speed: 0.0478s/iter; left time: 1685.3083s
	iters: 300, epoch: 5 | loss: 1.7637918
	speed: 0.0482s/iter; left time: 1691.8053s
Epoch: 5 cost time: 18.333914756774902
Epoch: 5, Steps: 369 | Train Loss: 3.746 Vali Loss: 5.769 Vali Acc: 0.651 Test Loss: 5.769 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.1515875
	speed: 0.1917s/iter; left time: 6702.5167s
	iters: 200, epoch: 6 | loss: 4.6834960
	speed: 0.0481s/iter; left time: 1676.5521s
	iters: 300, epoch: 6 | loss: 1.3716724
	speed: 0.0466s/iter; left time: 1620.1779s
Epoch: 6 cost time: 18.126317977905273
Epoch: 6, Steps: 369 | Train Loss: 3.649 Vali Loss: 5.530 Vali Acc: 0.658 Test Loss: 5.530 Test Acc: 0.658
Validation loss decreased (-0.653210 --> -0.658287).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8702319
	speed: 0.1882s/iter; left time: 6510.8726s
	iters: 200, epoch: 7 | loss: 2.0362220
	speed: 0.0458s/iter; left time: 1580.9797s
	iters: 300, epoch: 7 | loss: 4.5769906
	speed: 0.0472s/iter; left time: 1623.8066s
Epoch: 7 cost time: 18.10370111465454
Epoch: 7, Steps: 369 | Train Loss: 3.119 Vali Loss: 7.804 Vali Acc: 0.641 Test Loss: 7.804 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.8580501
	speed: 0.1849s/iter; left time: 6327.1915s
	iters: 200, epoch: 8 | loss: 2.8562977
	speed: 0.0468s/iter; left time: 1595.7726s
	iters: 300, epoch: 8 | loss: 7.6323147
	speed: 0.0481s/iter; left time: 1637.8190s
Epoch: 8 cost time: 18.160972595214844
Epoch: 8, Steps: 369 | Train Loss: 3.016 Vali Loss: 7.852 Vali Acc: 0.658 Test Loss: 7.852 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.6047533
	speed: 0.1927s/iter; left time: 6523.4444s
	iters: 200, epoch: 9 | loss: 0.0081357
	speed: 0.0484s/iter; left time: 1633.7265s
	iters: 300, epoch: 9 | loss: 0.0005378
	speed: 0.0479s/iter; left time: 1610.3957s
Epoch: 9 cost time: 18.560426950454712
Epoch: 9, Steps: 369 | Train Loss: 2.627 Vali Loss: 9.817 Vali Acc: 0.641 Test Loss: 9.817 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9655991
	speed: 0.1900s/iter; left time: 6360.8452s
	iters: 200, epoch: 10 | loss: 1.9577730
	speed: 0.0476s/iter; left time: 1589.1213s
	iters: 300, epoch: 10 | loss: 4.0614123
	speed: 0.0480s/iter; left time: 1599.0073s
Epoch: 10 cost time: 18.299681186676025
Epoch: 10, Steps: 369 | Train Loss: 2.350 Vali Loss: 9.021 Vali Acc: 0.633 Test Loss: 9.021 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0005173
	speed: 0.1834s/iter; left time: 6071.6886s
	iters: 200, epoch: 11 | loss: 2.4139931
	speed: 0.0484s/iter; left time: 1599.1879s
	iters: 300, epoch: 11 | loss: 0.0003427
	speed: 0.0477s/iter; left time: 1571.0175s
Epoch: 11 cost time: 17.825485467910767
Epoch: 11, Steps: 369 | Train Loss: 1.827 Vali Loss: 8.821 Vali Acc: 0.629 Test Loss: 8.821 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0872058
	speed: 0.1896s/iter; left time: 6207.7144s
	iters: 200, epoch: 12 | loss: 2.7837300
	speed: 0.0472s/iter; left time: 1540.6989s
	iters: 300, epoch: 12 | loss: 7.1795378
	speed: 0.0491s/iter; left time: 1596.2411s
Epoch: 12 cost time: 18.185597896575928
Epoch: 12, Steps: 369 | Train Loss: 1.484 Vali Loss: 8.228 Vali Acc: 0.644 Test Loss: 8.228 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.7300987
	speed: 0.1815s/iter; left time: 5875.6657s
	iters: 200, epoch: 13 | loss: 0.0005817
	speed: 0.0490s/iter; left time: 1580.8012s
	iters: 300, epoch: 13 | loss: 0.4982539
	speed: 0.0488s/iter; left time: 1569.7686s
Epoch: 13 cost time: 18.610556840896606
Epoch: 13, Steps: 369 | Train Loss: 1.052 Vali Loss: 8.469 Vali Acc: 0.637 Test Loss: 8.469 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4904491
	speed: 0.1873s/iter; left time: 5994.9598s
	iters: 200, epoch: 14 | loss: 0.3175127
	speed: 0.0499s/iter; left time: 1591.0780s
	iters: 300, epoch: 14 | loss: 0.9970406
	speed: 0.0492s/iter; left time: 1564.0173s
Epoch: 14 cost time: 18.674999237060547
Epoch: 14, Steps: 369 | Train Loss: 1.092 Vali Loss: 7.455 Vali Acc: 0.636 Test Loss: 7.455 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3742179
	speed: 0.1907s/iter; left time: 6033.9261s
	iters: 200, epoch: 15 | loss: 0.1139981
	speed: 0.0508s/iter; left time: 1602.8721s
	iters: 300, epoch: 15 | loss: 0.0876061
	speed: 0.0493s/iter; left time: 1550.3553s
Epoch: 15 cost time: 18.38089156150818
Epoch: 15, Steps: 369 | Train Loss: 0.781 Vali Loss: 6.863 Vali Acc: 0.626 Test Loss: 6.863 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3402870
	speed: 0.1828s/iter; left time: 5715.5828s
	iters: 200, epoch: 16 | loss: 0.0101833
	speed: 0.0492s/iter; left time: 1532.0863s
	iters: 300, epoch: 16 | loss: 0.0031860
	speed: 0.0461s/iter; left time: 1432.7295s
Epoch: 16 cost time: 18.19811201095581
Epoch: 16, Steps: 369 | Train Loss: 0.622 Vali Loss: 6.328 Vali Acc: 0.622 Test Loss: 6.328 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6583427922814983
model parameter : 576386
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4398084
	speed: 0.0565s/iter; left time: 2080.6776s
	iters: 200, epoch: 1 | loss: 4.9350386
	speed: 0.0416s/iter; left time: 1527.5898s
	iters: 300, epoch: 1 | loss: 1.2741199
	speed: 0.0460s/iter; left time: 1681.8640s
Epoch: 1 cost time: 17.534736156463623
Epoch: 1, Steps: 369 | Train Loss: 1.529 Vali Loss: 1.008 Vali Acc: 0.650 Test Loss: 1.008 Test Acc: 0.650
Validation loss decreased (inf --> -0.650103).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3266518
	speed: 0.1697s/iter; left time: 6180.8373s
	iters: 200, epoch: 2 | loss: 3.1366384
	speed: 0.0430s/iter; left time: 1561.7869s
	iters: 300, epoch: 2 | loss: 3.7181106
	speed: 0.0426s/iter; left time: 1543.5520s
Epoch: 2 cost time: 16.040396690368652
Epoch: 2, Steps: 369 | Train Loss: 1.717 Vali Loss: 2.033 Vali Acc: 0.646 Test Loss: 2.033 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4310877
	speed: 0.1710s/iter; left time: 6167.8825s
	iters: 200, epoch: 3 | loss: 2.6921415
	speed: 0.0382s/iter; left time: 1372.9538s
	iters: 300, epoch: 3 | loss: 0.0256055
	speed: 0.0411s/iter; left time: 1475.4215s
Epoch: 3 cost time: 15.327672958374023
Epoch: 3, Steps: 369 | Train Loss: 2.509 Vali Loss: 2.581 Vali Acc: 0.649 Test Loss: 2.581 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.6080742
	speed: 0.1685s/iter; left time: 6016.0921s
	iters: 200, epoch: 4 | loss: 1.5203956
	speed: 0.0413s/iter; left time: 1471.2747s
	iters: 300, epoch: 4 | loss: 2.4619305
	speed: 0.0407s/iter; left time: 1446.0919s
Epoch: 4 cost time: 15.631682395935059
Epoch: 4, Steps: 369 | Train Loss: 2.888 Vali Loss: 3.013 Vali Acc: 0.661 Test Loss: 3.013 Test Acc: 0.661
Validation loss decreased (-0.650103 --> -0.660867).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.8740091
	speed: 0.1695s/iter; left time: 5988.1788s
	iters: 200, epoch: 5 | loss: 1.8394330
	speed: 0.0421s/iter; left time: 1481.6702s
	iters: 300, epoch: 5 | loss: 5.9771862
	speed: 0.0424s/iter; left time: 1488.9214s
Epoch: 5 cost time: 16.16379427909851
Epoch: 5, Steps: 369 | Train Loss: 3.231 Vali Loss: 4.052 Vali Acc: 0.653 Test Loss: 4.052 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8179500
	speed: 0.1688s/iter; left time: 5901.9342s
	iters: 200, epoch: 6 | loss: 5.4532795
	speed: 0.0431s/iter; left time: 1502.4775s
	iters: 300, epoch: 6 | loss: 2.2436795
	speed: 0.0431s/iter; left time: 1497.3346s
Epoch: 6 cost time: 16.55675959587097
Epoch: 6, Steps: 369 | Train Loss: 3.225 Vali Loss: 5.288 Vali Acc: 0.641 Test Loss: 5.288 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9510368
	speed: 0.1745s/iter; left time: 6034.3552s
	iters: 200, epoch: 7 | loss: 1.4825199
	speed: 0.0434s/iter; left time: 1496.2096s
	iters: 300, epoch: 7 | loss: 1.8462170
	speed: 0.0427s/iter; left time: 1467.1012s
Epoch: 7 cost time: 16.492746829986572
Epoch: 7, Steps: 369 | Train Loss: 2.875 Vali Loss: 5.504 Vali Acc: 0.633 Test Loss: 5.504 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 4.8011794
	speed: 0.1703s/iter; left time: 5826.9537s
	iters: 200, epoch: 8 | loss: 0.6518668
	speed: 0.0425s/iter; left time: 1449.1490s
	iters: 300, epoch: 8 | loss: 0.9908692
	speed: 0.0431s/iter; left time: 1466.9585s
Epoch: 8 cost time: 16.29094958305359
Epoch: 8, Steps: 369 | Train Loss: 2.686 Vali Loss: 7.138 Vali Acc: 0.631 Test Loss: 7.138 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.1002359
	speed: 0.1659s/iter; left time: 5616.3706s
	iters: 200, epoch: 9 | loss: 3.2803009
	speed: 0.0418s/iter; left time: 1411.8888s
	iters: 300, epoch: 9 | loss: 5.5355482
	speed: 0.0439s/iter; left time: 1476.3214s
Epoch: 9 cost time: 16.210716485977173
Epoch: 9, Steps: 369 | Train Loss: 2.313 Vali Loss: 7.450 Vali Acc: 0.629 Test Loss: 7.450 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.8551097
	speed: 0.1765s/iter; left time: 5909.4746s
	iters: 200, epoch: 10 | loss: 4.3193164
	speed: 0.0425s/iter; left time: 1417.3544s
	iters: 300, epoch: 10 | loss: 0.5788659
	speed: 0.0435s/iter; left time: 1446.4250s
Epoch: 10 cost time: 16.513447999954224
Epoch: 10, Steps: 369 | Train Loss: 1.920 Vali Loss: 7.573 Vali Acc: 0.647 Test Loss: 7.573 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4752041
	speed: 0.1762s/iter; left time: 5834.3214s
	iters: 200, epoch: 11 | loss: 1.4679492
	speed: 0.0436s/iter; left time: 1439.8746s
	iters: 300, epoch: 11 | loss: 1.2217932
	speed: 0.0437s/iter; left time: 1436.5875s
Epoch: 11 cost time: 16.594537258148193
Epoch: 11, Steps: 369 | Train Loss: 1.549 Vali Loss: 7.303 Vali Acc: 0.649 Test Loss: 7.303 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.1630797
	speed: 0.1703s/iter; left time: 5576.4116s
	iters: 200, epoch: 12 | loss: 1.3208691
	speed: 0.0428s/iter; left time: 1397.1094s
	iters: 300, epoch: 12 | loss: 2.0060978
	speed: 0.0427s/iter; left time: 1388.5767s
Epoch: 12 cost time: 16.572147607803345
Epoch: 12, Steps: 369 | Train Loss: 1.278 Vali Loss: 6.925 Vali Acc: 0.644 Test Loss: 6.925 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0382653
	speed: 0.1694s/iter; left time: 5483.1885s
	iters: 200, epoch: 13 | loss: 2.0803862
	speed: 0.0415s/iter; left time: 1339.9310s
	iters: 300, epoch: 13 | loss: 0.0127523
	speed: 0.0417s/iter; left time: 1342.4750s
Epoch: 13 cost time: 16.02992534637451
Epoch: 13, Steps: 369 | Train Loss: 1.000 Vali Loss: 6.148 Vali Acc: 0.643 Test Loss: 6.148 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6777389
	speed: 0.1759s/iter; left time: 5630.0389s
	iters: 200, epoch: 14 | loss: 0.0128949
	speed: 0.0396s/iter; left time: 1264.7918s
	iters: 300, epoch: 14 | loss: 0.6114079
	speed: 0.0427s/iter; left time: 1358.8935s
Epoch: 14 cost time: 16.027501583099365
Epoch: 14, Steps: 369 | Train Loss: 0.714 Vali Loss: 6.113 Vali Acc: 0.631 Test Loss: 6.113 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6608967082860386
model parameter : 466178
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.8642631
	speed: 0.0526s/iter; left time: 1936.3986s
	iters: 200, epoch: 1 | loss: 1.6643772
	speed: 0.0344s/iter; left time: 1263.3489s
	iters: 300, epoch: 1 | loss: 0.9154437
	speed: 0.0335s/iter; left time: 1227.5792s
Epoch: 1 cost time: 14.52842926979065
Epoch: 1, Steps: 369 | Train Loss: 1.440 Vali Loss: 1.044 Vali Acc: 0.632 Test Loss: 1.044 Test Acc: 0.632
Validation loss decreased (inf --> -0.631942).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0905415
	speed: 0.1349s/iter; left time: 4914.0111s
	iters: 200, epoch: 2 | loss: 1.3956747
	speed: 0.0347s/iter; left time: 1259.3039s
	iters: 300, epoch: 2 | loss: 1.3833350
	speed: 0.0346s/iter; left time: 1253.5582s
Epoch: 2 cost time: 13.177449703216553
Epoch: 2, Steps: 369 | Train Loss: 1.504 Vali Loss: 1.837 Vali Acc: 0.642 Test Loss: 1.837 Test Acc: 0.642
Validation loss decreased (-0.631942 --> -0.642150).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9859503
	speed: 0.1356s/iter; left time: 4891.0645s
	iters: 200, epoch: 3 | loss: 2.0135388
	speed: 0.0344s/iter; left time: 1238.1057s
	iters: 300, epoch: 3 | loss: 2.8985553
	speed: 0.0343s/iter; left time: 1229.5363s
Epoch: 3 cost time: 12.88305139541626
Epoch: 3, Steps: 369 | Train Loss: 2.138 Vali Loss: 2.546 Vali Acc: 0.630 Test Loss: 2.546 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7917632
	speed: 0.1370s/iter; left time: 4888.3187s
	iters: 200, epoch: 4 | loss: 3.5908532
	speed: 0.0351s/iter; left time: 1248.2943s
	iters: 300, epoch: 4 | loss: 5.3881330
	speed: 0.0346s/iter; left time: 1226.3727s
Epoch: 4 cost time: 13.354438304901123
Epoch: 4, Steps: 369 | Train Loss: 2.500 Vali Loss: 4.192 Vali Acc: 0.651 Test Loss: 4.192 Test Acc: 0.651
Validation loss decreased (-0.642150 --> -0.650639).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0055714
	speed: 0.1443s/iter; left time: 5098.1467s
	iters: 200, epoch: 5 | loss: 1.1194847
	speed: 0.0352s/iter; left time: 1240.5422s
	iters: 300, epoch: 5 | loss: 4.2185788
	speed: 0.0348s/iter; left time: 1223.7981s
Epoch: 5 cost time: 13.423372030258179
Epoch: 5, Steps: 369 | Train Loss: 2.765 Vali Loss: 4.623 Vali Acc: 0.644 Test Loss: 4.623 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5528967
	speed: 0.1383s/iter; left time: 4835.3489s
	iters: 200, epoch: 6 | loss: 1.4756404
	speed: 0.0348s/iter; left time: 1214.3883s
	iters: 300, epoch: 6 | loss: 5.9887791
	speed: 0.0341s/iter; left time: 1184.1455s
Epoch: 6 cost time: 13.187950372695923
Epoch: 6, Steps: 369 | Train Loss: 2.486 Vali Loss: 4.637 Vali Acc: 0.639 Test Loss: 4.637 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.8262358
	speed: 0.1410s/iter; left time: 4878.3017s
	iters: 200, epoch: 7 | loss: 0.2595403
	speed: 0.0357s/iter; left time: 1232.8476s
	iters: 300, epoch: 7 | loss: 1.0913221
	speed: 0.0356s/iter; left time: 1223.4332s
Epoch: 7 cost time: 13.644311428070068
Epoch: 7, Steps: 369 | Train Loss: 2.260 Vali Loss: 5.750 Vali Acc: 0.635 Test Loss: 5.750 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2471656
	speed: 0.1340s/iter; left time: 4586.4066s
	iters: 200, epoch: 8 | loss: 5.9352212
	speed: 0.0366s/iter; left time: 1247.9339s
	iters: 300, epoch: 8 | loss: 3.2645094
	speed: 0.0345s/iter; left time: 1171.9326s
Epoch: 8 cost time: 13.54565143585205
Epoch: 8, Steps: 369 | Train Loss: 2.123 Vali Loss: 5.952 Vali Acc: 0.642 Test Loss: 5.952 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0003075
	speed: 0.1416s/iter; left time: 4792.2914s
	iters: 200, epoch: 9 | loss: 0.0072434
	speed: 0.0353s/iter; left time: 1191.4197s
	iters: 300, epoch: 9 | loss: 1.4054374
	speed: 0.0352s/iter; left time: 1185.9804s
Epoch: 9 cost time: 13.735424280166626
Epoch: 9, Steps: 369 | Train Loss: 1.764 Vali Loss: 7.040 Vali Acc: 0.628 Test Loss: 7.040 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3744201
	speed: 0.1427s/iter; left time: 4778.5053s
	iters: 200, epoch: 10 | loss: 0.0016155
	speed: 0.0353s/iter; left time: 1177.1923s
	iters: 300, epoch: 10 | loss: 1.0007362
	speed: 0.0351s/iter; left time: 1167.5815s
Epoch: 10 cost time: 13.472511053085327
Epoch: 10, Steps: 369 | Train Loss: 1.569 Vali Loss: 6.650 Vali Acc: 0.640 Test Loss: 6.650 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3844995
	speed: 0.1387s/iter; left time: 4591.8522s
	iters: 200, epoch: 11 | loss: 0.1813159
	speed: 0.0349s/iter; left time: 1152.0744s
	iters: 300, epoch: 11 | loss: 1.3268805
	speed: 0.0347s/iter; left time: 1140.8393s
Epoch: 11 cost time: 13.463474035263062
Epoch: 11, Steps: 369 | Train Loss: 1.369 Vali Loss: 6.877 Vali Acc: 0.633 Test Loss: 6.877 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0135959
	speed: 0.1360s/iter; left time: 4451.5577s
	iters: 200, epoch: 12 | loss: 0.4115767
	speed: 0.0356s/iter; left time: 1161.5664s
	iters: 300, epoch: 12 | loss: 1.0357598
	speed: 0.0340s/iter; left time: 1106.3487s
Epoch: 12 cost time: 13.216808319091797
Epoch: 12, Steps: 369 | Train Loss: 1.023 Vali Loss: 7.204 Vali Acc: 0.633 Test Loss: 7.204 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.5011121
	speed: 0.1446s/iter; left time: 4681.5649s
	iters: 200, epoch: 13 | loss: 0.8699299
	speed: 0.0326s/iter; left time: 1051.0730s
	iters: 300, epoch: 13 | loss: 0.1188004
	speed: 0.0340s/iter; left time: 1094.4210s
Epoch: 13 cost time: 12.606415748596191
Epoch: 13, Steps: 369 | Train Loss: 0.890 Vali Loss: 6.059 Vali Acc: 0.650 Test Loss: 6.059 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2329869
	speed: 0.1426s/iter; left time: 4562.2647s
	iters: 200, epoch: 14 | loss: 0.7913162
	speed: 0.0342s/iter; left time: 1090.4700s
	iters: 300, epoch: 14 | loss: 1.2201458
	speed: 0.0328s/iter; left time: 1042.7884s
Epoch: 14 cost time: 13.156176090240479
Epoch: 14, Steps: 369 | Train Loss: 0.751 Vali Loss: 6.112 Vali Acc: 0.637 Test Loss: 6.112 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6506810442678774
model parameter : 392834
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 9.6504230
	speed: 0.2193s/iter; left time: 8070.6325s
	iters: 200, epoch: 1 | loss: 0.7789985
	speed: 0.2049s/iter; left time: 7519.1407s
	iters: 300, epoch: 1 | loss: 2.7859714
	speed: 0.1939s/iter; left time: 7098.6609s
Epoch: 1 cost time: 75.9710488319397
Epoch: 1, Steps: 369 | Train Loss: 5.095 Vali Loss: 1.744 Vali Acc: 0.655 Test Loss: 1.744 Test Acc: 0.655
Validation loss decreased (inf --> -0.654636).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.9272795
	speed: 0.6705s/iter; left time: 24425.9155s
	iters: 200, epoch: 2 | loss: 6.3520312
	speed: 0.2013s/iter; left time: 7311.8606s
	iters: 300, epoch: 2 | loss: 8.3425503
	speed: 0.1980s/iter; left time: 7174.5336s
Epoch: 2 cost time: 74.47814702987671
Epoch: 2, Steps: 369 | Train Loss: 5.090 Vali Loss: 3.978 Vali Acc: 0.658 Test Loss: 3.978 Test Acc: 0.658
Validation loss decreased (-0.654636 --> -0.658303).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1468163
	speed: 0.6755s/iter; left time: 24359.1078s
	iters: 200, epoch: 3 | loss: 2.5977647
	speed: 0.1949s/iter; left time: 7007.4212s
	iters: 300, epoch: 3 | loss: 16.6973476
	speed: 0.2029s/iter; left time: 7277.7838s
Epoch: 3 cost time: 74.27748513221741
Epoch: 3, Steps: 369 | Train Loss: 7.059 Vali Loss: 7.514 Vali Acc: 0.650 Test Loss: 7.514 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 13.8655968
	speed: 0.6700s/iter; left time: 23914.2866s
	iters: 200, epoch: 4 | loss: 16.8926315
	speed: 0.2052s/iter; left time: 7303.5544s
	iters: 300, epoch: 4 | loss: 16.5327568
	speed: 0.2045s/iter; left time: 7257.1788s
Epoch: 4 cost time: 75.42522978782654
Epoch: 4, Steps: 369 | Train Loss: 8.281 Vali Loss: 9.749 Vali Acc: 0.655 Test Loss: 9.749 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 14.3216362
	speed: 0.6878s/iter; left time: 24295.9463s
	iters: 200, epoch: 5 | loss: 5.2619061
	speed: 0.2114s/iter; left time: 7444.9727s
	iters: 300, epoch: 5 | loss: 2.8521392
	speed: 0.2068s/iter; left time: 7264.0945s
Epoch: 5 cost time: 76.62655854225159
Epoch: 5, Steps: 369 | Train Loss: 8.623 Vali Loss: 12.988 Vali Acc: 0.627 Test Loss: 12.988 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 18.7348213
	speed: 0.6762s/iter; left time: 23635.6124s
	iters: 200, epoch: 6 | loss: 1.0162518
	speed: 0.1958s/iter; left time: 6826.3940s
	iters: 300, epoch: 6 | loss: 5.8211946
	speed: 0.1954s/iter; left time: 6789.7825s
Epoch: 6 cost time: 73.73155641555786
Epoch: 6, Steps: 369 | Train Loss: 8.199 Vali Loss: 14.030 Vali Acc: 0.638 Test Loss: 14.030 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 9.7090139
	speed: 0.6671s/iter; left time: 23071.9923s
	iters: 200, epoch: 7 | loss: 5.9223452
	speed: 0.2010s/iter; left time: 6932.6572s
	iters: 300, epoch: 7 | loss: 5.2564111
	speed: 0.1985s/iter; left time: 6825.8324s
Epoch: 7 cost time: 74.55724859237671
Epoch: 7, Steps: 369 | Train Loss: 7.456 Vali Loss: 14.231 Vali Acc: 0.627 Test Loss: 14.231 Test Acc: 0.627
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.1215281
	speed: 0.6891s/iter; left time: 23580.1720s
	iters: 200, epoch: 8 | loss: 2.2921948
	speed: 0.1878s/iter; left time: 6406.4118s
	iters: 300, epoch: 8 | loss: 4.8071260
	speed: 0.1742s/iter; left time: 5924.9594s
Epoch: 8 cost time: 70.37291646003723
Epoch: 8, Steps: 369 | Train Loss: 6.218 Vali Loss: 21.032 Vali Acc: 0.641 Test Loss: 21.032 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.8714720
	speed: 0.6354s/iter; left time: 21507.1260s
	iters: 200, epoch: 9 | loss: 3.7902360
	speed: 0.1829s/iter; left time: 6171.7383s
	iters: 300, epoch: 9 | loss: 0.9931391
	speed: 0.1834s/iter; left time: 6171.2284s
Epoch: 9 cost time: 68.14524698257446
Epoch: 9, Steps: 369 | Train Loss: 4.771 Vali Loss: 25.222 Vali Acc: 0.628 Test Loss: 25.222 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.6963845
	speed: 0.6395s/iter; left time: 21411.2895s
	iters: 200, epoch: 10 | loss: 6.6326933
	speed: 0.1969s/iter; left time: 6571.9691s
	iters: 300, epoch: 10 | loss: 4.4598327
	speed: 0.1911s/iter; left time: 6359.5280s
Epoch: 10 cost time: 70.99797034263611
Epoch: 10, Steps: 369 | Train Loss: 3.727 Vali Loss: 29.803 Vali Acc: 0.622 Test Loss: 29.803 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.9779814
	speed: 0.6537s/iter; left time: 21644.5277s
	iters: 200, epoch: 11 | loss: 7.4183769
	speed: 0.1920s/iter; left time: 6337.1829s
	iters: 300, epoch: 11 | loss: 4.2187080
	speed: 0.1980s/iter; left time: 6516.6817s
Epoch: 11 cost time: 72.27627611160278
Epoch: 11, Steps: 369 | Train Loss: 3.528 Vali Loss: 27.019 Vali Acc: 0.623 Test Loss: 27.019 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1406226
	speed: 0.6579s/iter; left time: 21541.2697s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1945s/iter; left time: 6350.4425s
	iters: 300, epoch: 12 | loss: 4.3328252
	speed: 0.1857s/iter; left time: 6041.8698s
Epoch: 12 cost time: 70.96778440475464
Epoch: 12, Steps: 369 | Train Loss: 2.707 Vali Loss: 26.449 Vali Acc: 0.630 Test Loss: 26.449 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6583427922814983
model parameter : 2385666
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1019248
	speed: 0.1039s/iter; left time: 3824.0866s
	iters: 200, epoch: 1 | loss: 2.2660220
	speed: 0.0881s/iter; left time: 3231.5991s
	iters: 300, epoch: 1 | loss: 2.8208258
	speed: 0.0876s/iter; left time: 3206.7877s
Epoch: 1 cost time: 34.13246726989746
Epoch: 1, Steps: 369 | Train Loss: 3.038 Vali Loss: 1.596 Vali Acc: 0.662 Test Loss: 1.596 Test Acc: 0.662
Validation loss decreased (inf --> -0.662300).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5952262
	speed: 0.3419s/iter; left time: 12455.1445s
	iters: 200, epoch: 2 | loss: 2.9790370
	speed: 0.0925s/iter; left time: 3359.5893s
	iters: 300, epoch: 2 | loss: 3.2641764
	speed: 0.0858s/iter; left time: 3108.1281s
Epoch: 2 cost time: 33.53372025489807
Epoch: 2, Steps: 369 | Train Loss: 3.794 Vali Loss: 3.946 Vali Acc: 0.646 Test Loss: 3.946 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3398848
	speed: 0.3430s/iter; left time: 12368.7218s
	iters: 200, epoch: 3 | loss: 4.4049497
	speed: 0.0906s/iter; left time: 3258.7697s
	iters: 300, epoch: 3 | loss: 1.8248863
	speed: 0.0916s/iter; left time: 3286.2153s
Epoch: 3 cost time: 34.304222106933594
Epoch: 3, Steps: 369 | Train Loss: 4.886 Vali Loss: 4.824 Vali Acc: 0.662 Test Loss: 4.824 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 7.6793394
	speed: 0.3404s/iter; left time: 12149.7748s
	iters: 200, epoch: 4 | loss: 7.2734656
	speed: 0.0900s/iter; left time: 3203.9403s
	iters: 300, epoch: 4 | loss: 7.9304490
	speed: 0.0876s/iter; left time: 3109.7028s
Epoch: 4 cost time: 33.37929010391235
Epoch: 4, Steps: 369 | Train Loss: 6.257 Vali Loss: 6.850 Vali Acc: 0.654 Test Loss: 6.850 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.9138055
	speed: 0.3364s/iter; left time: 11881.8428s
	iters: 200, epoch: 5 | loss: 0.3330735
	speed: 0.0831s/iter; left time: 2925.7374s
	iters: 300, epoch: 5 | loss: 7.1712837
	speed: 0.0892s/iter; left time: 3134.7138s
Epoch: 5 cost time: 32.59991097450256
Epoch: 5, Steps: 369 | Train Loss: 6.207 Vali Loss: 6.346 Vali Acc: 0.653 Test Loss: 6.346 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.2544663
	speed: 0.3408s/iter; left time: 11913.5597s
	iters: 200, epoch: 6 | loss: 8.3503437
	speed: 0.0927s/iter; left time: 3230.8879s
	iters: 300, epoch: 6 | loss: 6.8996458
	speed: 0.0922s/iter; left time: 3204.3270s
Epoch: 6 cost time: 34.753865242004395
Epoch: 6, Steps: 369 | Train Loss: 5.981 Vali Loss: 9.571 Vali Acc: 0.653 Test Loss: 9.571 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 11.6161461
	speed: 0.3463s/iter; left time: 11976.7757s
	iters: 200, epoch: 7 | loss: 8.1067762
	speed: 0.0917s/iter; left time: 3162.7544s
	iters: 300, epoch: 7 | loss: 8.0193100
	speed: 0.0909s/iter; left time: 3125.4642s
Epoch: 7 cost time: 34.212441205978394
Epoch: 7, Steps: 369 | Train Loss: 5.546 Vali Loss: 7.555 Vali Acc: 0.648 Test Loss: 7.555 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 6.0330687
	speed: 0.3428s/iter; left time: 11730.2308s
	iters: 200, epoch: 8 | loss: 5.7522192
	speed: 0.0920s/iter; left time: 3138.6906s
	iters: 300, epoch: 8 | loss: 0.4090265
	speed: 0.0915s/iter; left time: 3113.0814s
Epoch: 8 cost time: 34.40374207496643
Epoch: 8, Steps: 369 | Train Loss: 4.987 Vali Loss: 11.971 Vali Acc: 0.629 Test Loss: 11.971 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 5.1416941
	speed: 0.3523s/iter; left time: 11925.4853s
	iters: 200, epoch: 9 | loss: 2.6861801
	speed: 0.0949s/iter; left time: 3202.8177s
	iters: 300, epoch: 9 | loss: 3.5531225
	speed: 0.0921s/iter; left time: 3097.7907s
Epoch: 9 cost time: 34.9936158657074
Epoch: 9, Steps: 369 | Train Loss: 3.899 Vali Loss: 13.688 Vali Acc: 0.608 Test Loss: 13.688 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3413s/iter; left time: 11427.5631s
	iters: 200, epoch: 10 | loss: 0.0000013
	speed: 0.0909s/iter; left time: 3034.3283s
	iters: 300, epoch: 10 | loss: 5.2511697
	speed: 0.0895s/iter; left time: 2979.4273s
Epoch: 10 cost time: 32.99022197723389
Epoch: 10, Steps: 369 | Train Loss: 2.920 Vali Loss: 14.117 Vali Acc: 0.618 Test Loss: 14.117 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 6.0635543
	speed: 0.3382s/iter; left time: 11199.0387s
	iters: 200, epoch: 11 | loss: 0.6073357
	speed: 0.0940s/iter; left time: 3102.1031s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 2987.0622s
Epoch: 11 cost time: 33.798277378082275
Epoch: 11, Steps: 369 | Train Loss: 2.503 Vali Loss: 14.965 Vali Acc: 0.629 Test Loss: 14.965 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6623155505107832
model parameter : 1243138
model size : 7.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.6006637
	speed: 0.0765s/iter; left time: 2814.5762s
	iters: 200, epoch: 1 | loss: 1.5238850
	speed: 0.0623s/iter; left time: 2286.8322s
	iters: 300, epoch: 1 | loss: 1.3455590
	speed: 0.0615s/iter; left time: 2251.8464s
Epoch: 1 cost time: 24.29554843902588
Epoch: 1, Steps: 369 | Train Loss: 2.260 Vali Loss: 1.859 Vali Acc: 0.621 Test Loss: 1.859 Test Acc: 0.621
Validation loss decreased (inf --> -0.620867).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9916089
	speed: 0.2427s/iter; left time: 8840.6216s
	iters: 200, epoch: 2 | loss: 3.0593188
	speed: 0.0628s/iter; left time: 2280.3664s
	iters: 300, epoch: 2 | loss: 3.6948001
	speed: 0.0638s/iter; left time: 2310.1955s
Epoch: 2 cost time: 24.227790355682373
Epoch: 2, Steps: 369 | Train Loss: 2.822 Vali Loss: 3.545 Vali Acc: 0.656 Test Loss: 3.545 Test Acc: 0.656
Validation loss decreased (-0.620867 --> -0.655753).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2604403
	speed: 0.2525s/iter; left time: 9104.3447s
	iters: 200, epoch: 3 | loss: 4.6111922
	speed: 0.0663s/iter; left time: 2382.5884s
	iters: 300, epoch: 3 | loss: 0.0922842
	speed: 0.0659s/iter; left time: 2363.1182s
Epoch: 3 cost time: 25.036420822143555
Epoch: 3, Steps: 369 | Train Loss: 4.105 Vali Loss: 4.089 Vali Acc: 0.660 Test Loss: 4.089 Test Acc: 0.660
Validation loss decreased (-0.655753 --> -0.659721).  Saving model ...
	iters: 100, epoch: 4 | loss: 9.4334040
	speed: 0.2577s/iter; left time: 9196.6802s
	iters: 200, epoch: 4 | loss: 2.8498313
	speed: 0.0656s/iter; left time: 2336.4139s
	iters: 300, epoch: 4 | loss: 7.6186686
	speed: 0.0662s/iter; left time: 2351.1030s
Epoch: 4 cost time: 25.057217836380005
Epoch: 4, Steps: 369 | Train Loss: 4.786 Vali Loss: 4.503 Vali Acc: 0.648 Test Loss: 4.503 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 6.5605741
	speed: 0.2510s/iter; left time: 8867.9082s
	iters: 200, epoch: 5 | loss: 4.3751917
	speed: 0.0667s/iter; left time: 2349.5408s
	iters: 300, epoch: 5 | loss: 10.6387491
	speed: 0.0668s/iter; left time: 2345.8017s
Epoch: 5 cost time: 25.172732830047607
Epoch: 5, Steps: 369 | Train Loss: 5.073 Vali Loss: 6.184 Vali Acc: 0.659 Test Loss: 6.184 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.6590986
	speed: 0.2517s/iter; left time: 8796.9769s
	iters: 200, epoch: 6 | loss: 0.0735762
	speed: 0.0666s/iter; left time: 2320.8873s
	iters: 300, epoch: 6 | loss: 2.3765929
	speed: 0.0671s/iter; left time: 2330.5006s
Epoch: 6 cost time: 25.215325355529785
Epoch: 6, Steps: 369 | Train Loss: 5.008 Vali Loss: 7.190 Vali Acc: 0.650 Test Loss: 7.190 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 8.2924719
	speed: 0.2493s/iter; left time: 8621.1345s
	iters: 200, epoch: 7 | loss: 8.7316055
	speed: 0.0663s/iter; left time: 2287.0324s
	iters: 300, epoch: 7 | loss: 3.3373570
	speed: 0.0650s/iter; left time: 2235.5721s
Epoch: 7 cost time: 25.05413055419922
Epoch: 7, Steps: 369 | Train Loss: 4.762 Vali Loss: 8.431 Vali Acc: 0.636 Test Loss: 8.431 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.4639463
	speed: 0.2508s/iter; left time: 8580.2810s
	iters: 200, epoch: 8 | loss: 0.8523234
	speed: 0.0659s/iter; left time: 2249.4321s
	iters: 300, epoch: 8 | loss: 2.2895632
	speed: 0.0663s/iter; left time: 2255.9397s
Epoch: 8 cost time: 25.046266794204712
Epoch: 8, Steps: 369 | Train Loss: 4.257 Vali Loss: 10.598 Vali Acc: 0.634 Test Loss: 10.598 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.1667924
	speed: 0.2541s/iter; left time: 8601.9663s
	iters: 200, epoch: 9 | loss: 8.7973490
	speed: 0.0660s/iter; left time: 2228.2569s
	iters: 300, epoch: 9 | loss: 7.5868788
	speed: 0.0661s/iter; left time: 2224.4931s
Epoch: 9 cost time: 25.001885652542114
Epoch: 9, Steps: 369 | Train Loss: 3.620 Vali Loss: 12.094 Vali Acc: 0.620 Test Loss: 12.094 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.8747125
	speed: 0.2584s/iter; left time: 8652.7159s
	iters: 200, epoch: 10 | loss: 1.6025821
	speed: 0.0673s/iter; left time: 2245.9745s
	iters: 300, epoch: 10 | loss: 7.0836234
	speed: 0.0671s/iter; left time: 2231.6223s
Epoch: 10 cost time: 25.380929231643677
Epoch: 10, Steps: 369 | Train Loss: 2.940 Vali Loss: 12.516 Vali Acc: 0.642 Test Loss: 12.516 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.2711985
	speed: 0.2514s/iter; left time: 8324.5284s
	iters: 200, epoch: 11 | loss: 0.0146338
	speed: 0.0683s/iter; left time: 2254.1303s
	iters: 300, epoch: 11 | loss: 0.9711164
	speed: 0.0666s/iter; left time: 2190.4015s
Epoch: 11 cost time: 25.500665187835693
Epoch: 11, Steps: 369 | Train Loss: 2.315 Vali Loss: 13.474 Vali Acc: 0.629 Test Loss: 13.474 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.4372959
	speed: 0.2577s/iter; left time: 8437.9574s
	iters: 200, epoch: 12 | loss: 0.0515776
	speed: 0.0690s/iter; left time: 2253.3577s
	iters: 300, epoch: 12 | loss: 2.0923896
	speed: 0.0682s/iter; left time: 2219.7986s
Epoch: 12 cost time: 25.593268394470215
Epoch: 12, Steps: 369 | Train Loss: 1.859 Vali Loss: 11.277 Vali Acc: 0.645 Test Loss: 11.277 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.9309235
	speed: 0.2538s/iter; left time: 8217.7105s
	iters: 200, epoch: 13 | loss: 2.6434050
	speed: 0.0679s/iter; left time: 2191.0639s
	iters: 300, epoch: 13 | loss: 1.3407863
	speed: 0.0676s/iter; left time: 2173.6729s
Epoch: 13 cost time: 25.579185724258423
Epoch: 13, Steps: 369 | Train Loss: 1.364 Vali Loss: 10.655 Vali Acc: 0.661 Test Loss: 10.655 Test Acc: 0.661
Validation loss decreased (-0.659721 --> -0.660506).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.9249074
	speed: 0.2540s/iter; left time: 8130.1452s
	iters: 200, epoch: 14 | loss: 0.0000029
	speed: 0.0678s/iter; left time: 2164.5691s
	iters: 300, epoch: 14 | loss: 0.0000084
	speed: 0.0641s/iter; left time: 2038.4560s
Epoch: 14 cost time: 24.899801015853882
Epoch: 14, Steps: 369 | Train Loss: 1.070 Vali Loss: 9.901 Vali Acc: 0.654 Test Loss: 9.901 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5971835
	speed: 0.2550s/iter; left time: 8066.0640s
	iters: 200, epoch: 15 | loss: 1.6498139
	speed: 0.0677s/iter; left time: 2134.7485s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2091.0712s
Epoch: 15 cost time: 25.193336486816406
Epoch: 15, Steps: 369 | Train Loss: 0.797 Vali Loss: 9.603 Vali Acc: 0.648 Test Loss: 9.603 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5328466
	speed: 0.2534s/iter; left time: 7921.9572s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 2147.7275s
	iters: 300, epoch: 16 | loss: 0.2058728
	speed: 0.0665s/iter; left time: 2064.3507s
Epoch: 16 cost time: 25.75353741645813
Epoch: 16, Steps: 369 | Train Loss: 0.656 Vali Loss: 8.161 Vali Acc: 0.649 Test Loss: 8.161 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0080469
	speed: 0.2595s/iter; left time: 8018.2431s
	iters: 200, epoch: 17 | loss: 0.5728631
	speed: 0.0668s/iter; left time: 2056.6536s
	iters: 300, epoch: 17 | loss: 1.2878971
	speed: 0.0666s/iter; left time: 2043.4541s
Epoch: 17 cost time: 25.256995916366577
Epoch: 17, Steps: 369 | Train Loss: 0.476 Vali Loss: 7.239 Vali Acc: 0.646 Test Loss: 7.239 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2512s/iter; left time: 7669.0803s
	iters: 200, epoch: 18 | loss: 0.1701220
	speed: 0.0672s/iter; left time: 2044.4040s
	iters: 300, epoch: 18 | loss: 0.0217026
	speed: 0.0663s/iter; left time: 2012.1757s
Epoch: 18 cost time: 25.19532299041748
Epoch: 18, Steps: 369 | Train Loss: 0.446 Vali Loss: 6.900 Vali Acc: 0.641 Test Loss: 6.900 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.8166366
	speed: 0.2553s/iter; left time: 7700.3224s
	iters: 200, epoch: 19 | loss: 0.5656407
	speed: 0.0668s/iter; left time: 2007.9731s
	iters: 300, epoch: 19 | loss: 1.7732430
	speed: 0.0683s/iter; left time: 2046.5965s
Epoch: 19 cost time: 25.752952337265015
Epoch: 19, Steps: 369 | Train Loss: 0.269 Vali Loss: 6.138 Vali Acc: 0.651 Test Loss: 6.138 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8633612
	speed: 0.2587s/iter; left time: 7707.3583s
	iters: 200, epoch: 20 | loss: 0.0397668
	speed: 0.0679s/iter; left time: 2016.1120s
	iters: 300, epoch: 20 | loss: 0.0704171
	speed: 0.0678s/iter; left time: 2005.6443s
Epoch: 20 cost time: 25.5950186252594
Epoch: 20, Steps: 369 | Train Loss: 0.197 Vali Loss: 5.786 Vali Acc: 0.650 Test Loss: 5.786 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0116358
	speed: 0.2577s/iter; left time: 7581.8545s
	iters: 200, epoch: 21 | loss: 0.0001552
	speed: 0.0671s/iter; left time: 1967.2592s
	iters: 300, epoch: 21 | loss: 0.4330398
	speed: 0.0651s/iter; left time: 1901.9118s
Epoch: 21 cost time: 25.179017543792725
Epoch: 21, Steps: 369 | Train Loss: 0.168 Vali Loss: 5.286 Vali Acc: 0.643 Test Loss: 5.286 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4358259
	speed: 0.2600s/iter; left time: 7552.2184s
	iters: 200, epoch: 22 | loss: 0.0838271
	speed: 0.0648s/iter; left time: 1874.9090s
	iters: 300, epoch: 22 | loss: 0.0352682
	speed: 0.0653s/iter; left time: 1883.7470s
Epoch: 22 cost time: 24.814682483673096
Epoch: 22, Steps: 369 | Train Loss: 0.138 Vali Loss: 4.728 Vali Acc: 0.653 Test Loss: 4.728 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3722022
	speed: 0.2584s/iter; left time: 7411.4807s
	iters: 200, epoch: 23 | loss: 0.0690057
	speed: 0.0684s/iter; left time: 1955.1076s
	iters: 300, epoch: 23 | loss: 0.0517333
	speed: 0.0675s/iter; left time: 1923.5012s
Epoch: 23 cost time: 25.75096321105957
Epoch: 23, Steps: 369 | Train Loss: 0.120 Vali Loss: 4.633 Vali Acc: 0.654 Test Loss: 4.633 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6606129398410897
model parameter : 874626
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1142988
	speed: 0.0640s/iter; left time: 2354.1231s
	iters: 200, epoch: 1 | loss: 3.1277151
	speed: 0.0453s/iter; left time: 1662.0724s
	iters: 300, epoch: 1 | loss: 1.3807085
	speed: 0.0464s/iter; left time: 1698.8196s
Epoch: 1 cost time: 18.90188193321228
Epoch: 1, Steps: 369 | Train Loss: 1.877 Vali Loss: 1.573 Vali Acc: 0.636 Test Loss: 1.573 Test Acc: 0.636
Validation loss decreased (inf --> -0.635626).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9917130
	speed: 0.1902s/iter; left time: 6927.6490s
	iters: 200, epoch: 2 | loss: 0.1278539
	speed: 0.0520s/iter; left time: 1887.8962s
	iters: 300, epoch: 2 | loss: 3.5178113
	speed: 0.0511s/iter; left time: 1852.0167s
Epoch: 2 cost time: 19.357988834381104
Epoch: 2, Steps: 369 | Train Loss: 2.415 Vali Loss: 2.628 Vali Acc: 0.638 Test Loss: 2.628 Test Acc: 0.638
Validation loss decreased (-0.635626 --> -0.637885).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1868906
	speed: 0.2013s/iter; left time: 7258.0279s
	iters: 200, epoch: 3 | loss: 3.4185085
	speed: 0.0513s/iter; left time: 1843.2112s
	iters: 300, epoch: 3 | loss: 3.4617221
	speed: 0.0502s/iter; left time: 1799.9595s
Epoch: 3 cost time: 19.43923282623291
Epoch: 3, Steps: 369 | Train Loss: 3.405 Vali Loss: 3.164 Vali Acc: 0.652 Test Loss: 3.164 Test Acc: 0.652
Validation loss decreased (-0.637885 --> -0.652068).  Saving model ...
	iters: 100, epoch: 4 | loss: 5.7605810
	speed: 0.2014s/iter; left time: 7189.9383s
	iters: 200, epoch: 4 | loss: 1.9745374
	speed: 0.0504s/iter; left time: 1792.8985s
	iters: 300, epoch: 4 | loss: 8.0921803
	speed: 0.0499s/iter; left time: 1771.6194s
Epoch: 4 cost time: 18.92596960067749
Epoch: 4, Steps: 369 | Train Loss: 3.949 Vali Loss: 5.970 Vali Acc: 0.638 Test Loss: 5.970 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1749982
	speed: 0.1941s/iter; left time: 6856.1906s
	iters: 200, epoch: 5 | loss: 6.4251466
	speed: 0.0471s/iter; left time: 1660.7050s
	iters: 300, epoch: 5 | loss: 2.7635674
	speed: 0.0497s/iter; left time: 1744.3056s
Epoch: 5 cost time: 18.250885725021362
Epoch: 5, Steps: 369 | Train Loss: 4.148 Vali Loss: 5.643 Vali Acc: 0.641 Test Loss: 5.643 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.7409256
	speed: 0.1993s/iter; left time: 6967.9001s
	iters: 200, epoch: 6 | loss: 3.0412049
	speed: 0.0486s/iter; left time: 1693.4200s
	iters: 300, epoch: 6 | loss: 2.0953760
	speed: 0.0432s/iter; left time: 1501.0368s
Epoch: 6 cost time: 18.225296020507812
Epoch: 6, Steps: 369 | Train Loss: 3.837 Vali Loss: 6.094 Vali Acc: 0.645 Test Loss: 6.094 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.2164683
	speed: 0.1864s/iter; left time: 6447.4302s
	iters: 200, epoch: 7 | loss: 6.8008466
	speed: 0.0412s/iter; left time: 1421.4872s
	iters: 300, epoch: 7 | loss: 2.1079853
	speed: 0.0398s/iter; left time: 1369.7602s
Epoch: 7 cost time: 15.187375783920288
Epoch: 7, Steps: 369 | Train Loss: 3.604 Vali Loss: 8.101 Vali Acc: 0.632 Test Loss: 8.101 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.2386010
	speed: 0.1726s/iter; left time: 5904.6887s
	iters: 200, epoch: 8 | loss: 1.6225637
	speed: 0.0562s/iter; left time: 1918.5090s
	iters: 300, epoch: 8 | loss: 4.1554809
	speed: 0.0541s/iter; left time: 1842.0371s
Epoch: 8 cost time: 20.491328239440918
Epoch: 8, Steps: 369 | Train Loss: 3.192 Vali Loss: 9.333 Vali Acc: 0.619 Test Loss: 9.333 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.1436827
	speed: 0.2134s/iter; left time: 7222.8235s
	iters: 200, epoch: 9 | loss: 1.2509758
	speed: 0.0539s/iter; left time: 1820.2275s
	iters: 300, epoch: 9 | loss: 3.5403905
	speed: 0.0544s/iter; left time: 1829.6944s
Epoch: 9 cost time: 20.533029079437256
Epoch: 9, Steps: 369 | Train Loss: 2.685 Vali Loss: 8.471 Vali Acc: 0.625 Test Loss: 8.471 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.4150853
	speed: 0.1923s/iter; left time: 6438.8659s
	iters: 200, epoch: 10 | loss: 3.0733495
	speed: 0.0458s/iter; left time: 1527.1815s
	iters: 300, epoch: 10 | loss: 3.1380544
	speed: 0.0462s/iter; left time: 1536.9564s
Epoch: 10 cost time: 17.269855499267578
Epoch: 10, Steps: 369 | Train Loss: 2.259 Vali Loss: 10.602 Vali Acc: 0.630 Test Loss: 10.602 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.9669453
	speed: 0.1849s/iter; left time: 6121.9872s
	iters: 200, epoch: 11 | loss: 1.3820589
	speed: 0.0449s/iter; left time: 1481.0837s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0496s/iter; left time: 1632.0408s
Epoch: 11 cost time: 18.39892292022705
Epoch: 11, Steps: 369 | Train Loss: 1.801 Vali Loss: 9.958 Vali Acc: 0.631 Test Loss: 9.958 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7452009
	speed: 0.2113s/iter; left time: 6917.8628s
	iters: 200, epoch: 12 | loss: 0.5431741
	speed: 0.0561s/iter; left time: 1829.7919s
	iters: 300, epoch: 12 | loss: 4.9660225
	speed: 0.0560s/iter; left time: 1822.9199s
Epoch: 12 cost time: 21.238572359085083
Epoch: 12, Steps: 369 | Train Loss: 1.403 Vali Loss: 11.029 Vali Acc: 0.638 Test Loss: 11.029 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.8277969
	speed: 0.2054s/iter; left time: 6650.0642s
	iters: 200, epoch: 13 | loss: 0.8805991
	speed: 0.0472s/iter; left time: 1523.0374s
	iters: 300, epoch: 13 | loss: 4.4091206
	speed: 0.0470s/iter; left time: 1512.5317s
Epoch: 13 cost time: 18.438615798950195
Epoch: 13, Steps: 369 | Train Loss: 1.140 Vali Loss: 9.837 Vali Acc: 0.628 Test Loss: 9.837 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6520998864926221
model parameter : 653698
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0627818
	speed: 0.0631s/iter; left time: 2323.5855s
	iters: 200, epoch: 1 | loss: 3.4313798
	speed: 0.0454s/iter; left time: 1665.0808s
	iters: 300, epoch: 1 | loss: 1.9645878
	speed: 0.0449s/iter; left time: 1643.8413s
Epoch: 1 cost time: 18.74493932723999
Epoch: 1, Steps: 369 | Train Loss: 1.920 Vali Loss: 1.330 Vali Acc: 0.616 Test Loss: 1.330 Test Acc: 0.616
Validation loss decreased (inf --> -0.616048).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0519085
	speed: 0.1822s/iter; left time: 6638.5791s
	iters: 200, epoch: 2 | loss: 0.6009895
	speed: 0.0481s/iter; left time: 1748.3641s
	iters: 300, epoch: 2 | loss: 3.5359476
	speed: 0.0480s/iter; left time: 1738.9790s
Epoch: 2 cost time: 17.82603406906128
Epoch: 2, Steps: 369 | Train Loss: 2.109 Vali Loss: 3.018 Vali Acc: 0.614 Test Loss: 3.018 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.3489723
	speed: 0.1664s/iter; left time: 6001.4523s
	iters: 200, epoch: 3 | loss: 1.8304514
	speed: 0.0421s/iter; left time: 1514.5061s
	iters: 300, epoch: 3 | loss: 2.3158312
	speed: 0.0405s/iter; left time: 1451.7753s
Epoch: 3 cost time: 16.074065446853638
Epoch: 3, Steps: 369 | Train Loss: 2.789 Vali Loss: 3.251 Vali Acc: 0.641 Test Loss: 3.251 Test Acc: 0.641
Validation loss decreased (-0.616048 --> -0.640717).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8072293
	speed: 0.1748s/iter; left time: 6239.8223s
	iters: 200, epoch: 4 | loss: 2.9138296
	speed: 0.0397s/iter; left time: 1414.7763s
	iters: 300, epoch: 4 | loss: 2.4226713
	speed: 0.0463s/iter; left time: 1644.5857s
Epoch: 4 cost time: 16.41553521156311
Epoch: 4, Steps: 369 | Train Loss: 3.377 Vali Loss: 3.581 Vali Acc: 0.648 Test Loss: 3.581 Test Acc: 0.648
Validation loss decreased (-0.640717 --> -0.648375).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0491712
	speed: 0.1923s/iter; left time: 6793.1507s
	iters: 200, epoch: 5 | loss: 0.8577611
	speed: 0.0472s/iter; left time: 1663.2579s
	iters: 300, epoch: 5 | loss: 3.1038635
	speed: 0.0469s/iter; left time: 1647.6824s
Epoch: 5 cost time: 17.7957284450531
Epoch: 5, Steps: 369 | Train Loss: 3.581 Vali Loss: 4.938 Vali Acc: 0.643 Test Loss: 4.938 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 5.6629028
	speed: 0.1862s/iter; left time: 6507.6124s
	iters: 200, epoch: 6 | loss: 1.9099296
	speed: 0.0440s/iter; left time: 1533.2567s
	iters: 300, epoch: 6 | loss: 4.4040098
	speed: 0.0403s/iter; left time: 1401.0475s
Epoch: 6 cost time: 16.296979904174805
Epoch: 6, Steps: 369 | Train Loss: 3.641 Vali Loss: 6.469 Vali Acc: 0.638 Test Loss: 6.469 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4782279
	speed: 0.1674s/iter; left time: 5788.6538s
	iters: 200, epoch: 7 | loss: 3.5704365
	speed: 0.0387s/iter; left time: 1334.9669s
	iters: 300, epoch: 7 | loss: 2.6646736
	speed: 0.0404s/iter; left time: 1389.0324s
Epoch: 7 cost time: 15.295447587966919
Epoch: 7, Steps: 369 | Train Loss: 3.183 Vali Loss: 7.424 Vali Acc: 0.635 Test Loss: 7.424 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.9553344
	speed: 0.1704s/iter; left time: 5830.4226s
	iters: 200, epoch: 8 | loss: 3.5477960
	speed: 0.0463s/iter; left time: 1580.3505s
	iters: 300, epoch: 8 | loss: 4.5973024
	speed: 0.0477s/iter; left time: 1621.1702s
Epoch: 8 cost time: 17.26522159576416
Epoch: 8, Steps: 369 | Train Loss: 2.959 Vali Loss: 7.649 Vali Acc: 0.650 Test Loss: 7.649 Test Acc: 0.650
Validation loss decreased (-0.648375 --> -0.650037).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2314796
	speed: 0.1874s/iter; left time: 6343.8139s
	iters: 200, epoch: 9 | loss: 0.0204595
	speed: 0.0463s/iter; left time: 1562.1569s
	iters: 300, epoch: 9 | loss: 1.2413133
	speed: 0.0464s/iter; left time: 1561.1796s
Epoch: 9 cost time: 17.66179323196411
Epoch: 9, Steps: 369 | Train Loss: 2.420 Vali Loss: 8.314 Vali Acc: 0.633 Test Loss: 8.314 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000439
	speed: 0.1876s/iter; left time: 6282.4993s
	iters: 200, epoch: 10 | loss: 0.9301257
	speed: 0.0413s/iter; left time: 1378.8472s
	iters: 300, epoch: 10 | loss: 1.9095080
	speed: 0.0403s/iter; left time: 1341.9376s
Epoch: 10 cost time: 16.03551483154297
Epoch: 10, Steps: 369 | Train Loss: 2.054 Vali Loss: 8.965 Vali Acc: 0.627 Test Loss: 8.965 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0265906
	speed: 0.1732s/iter; left time: 5733.2591s
	iters: 200, epoch: 11 | loss: 3.3152628
	speed: 0.0400s/iter; left time: 1321.0280s
	iters: 300, epoch: 11 | loss: 0.0032576
	speed: 0.0397s/iter; left time: 1307.7538s
Epoch: 11 cost time: 15.329588413238525
Epoch: 11, Steps: 369 | Train Loss: 1.626 Vali Loss: 9.089 Vali Acc: 0.623 Test Loss: 9.089 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.0072527
	speed: 0.1830s/iter; left time: 5992.1925s
	iters: 200, epoch: 12 | loss: 1.0229875
	speed: 0.0483s/iter; left time: 1577.1555s
	iters: 300, epoch: 12 | loss: 1.0932573
	speed: 0.0485s/iter; left time: 1576.7941s
Epoch: 12 cost time: 18.44859790802002
Epoch: 12, Steps: 369 | Train Loss: 1.348 Vali Loss: 9.424 Vali Acc: 0.645 Test Loss: 9.424 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7126092
	speed: 0.1883s/iter; left time: 6096.6153s
	iters: 200, epoch: 13 | loss: 3.0620072
	speed: 0.0485s/iter; left time: 1566.0708s
	iters: 300, epoch: 13 | loss: 0.1628101
	speed: 0.0489s/iter; left time: 1574.1669s
Epoch: 13 cost time: 18.59561514854431
Epoch: 13, Steps: 369 | Train Loss: 1.011 Vali Loss: 8.370 Vali Acc: 0.647 Test Loss: 8.370 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.4649999
	speed: 0.1834s/iter; left time: 5869.9081s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1299.9894s
	iters: 300, epoch: 14 | loss: 1.0802298
	speed: 0.0402s/iter; left time: 1279.7957s
Epoch: 14 cost time: 15.61612606048584
Epoch: 14, Steps: 369 | Train Loss: 0.832 Vali Loss: 8.426 Vali Acc: 0.638 Test Loss: 8.426 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.0061322
	speed: 0.1785s/iter; left time: 5647.8139s
	iters: 200, epoch: 15 | loss: 0.0000082
	speed: 0.0399s/iter; left time: 1257.5628s
	iters: 300, epoch: 15 | loss: 0.2454617
	speed: 0.0401s/iter; left time: 1260.1254s
Epoch: 15 cost time: 15.543635368347168
Epoch: 15, Steps: 369 | Train Loss: 0.597 Vali Loss: 7.756 Vali Acc: 0.627 Test Loss: 7.756 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0013439
	speed: 0.1890s/iter; left time: 5908.1112s
	iters: 200, epoch: 16 | loss: 2.1110554
	speed: 0.0478s/iter; left time: 1489.5577s
	iters: 300, epoch: 16 | loss: 0.0008020
	speed: 0.0473s/iter; left time: 1470.5629s
Epoch: 16 cost time: 18.345820903778076
Epoch: 16, Steps: 369 | Train Loss: 0.546 Vali Loss: 7.706 Vali Acc: 0.629 Test Loss: 7.706 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0001224
	speed: 0.1972s/iter; left time: 6094.0525s
	iters: 200, epoch: 17 | loss: 1.3025620
	speed: 0.0480s/iter; left time: 1479.1033s
	iters: 300, epoch: 17 | loss: 0.0000003
	speed: 0.0479s/iter; left time: 1469.0753s
Epoch: 17 cost time: 18.258042097091675
Epoch: 17, Steps: 369 | Train Loss: 0.462 Vali Loss: 7.329 Vali Acc: 0.640 Test Loss: 7.329 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2948430
	speed: 0.1822s/iter; left time: 5562.1523s
	iters: 200, epoch: 18 | loss: 0.0132777
	speed: 0.0402s/iter; left time: 1223.6647s
	iters: 300, epoch: 18 | loss: 0.0031263
	speed: 0.0404s/iter; left time: 1225.1629s
Epoch: 18 cost time: 15.634247303009033
Epoch: 18, Steps: 369 | Train Loss: 0.466 Vali Loss: 6.468 Vali Acc: 0.646 Test Loss: 6.468 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6501135073779796
model parameter : 543490
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.3544998
	speed: 0.0540s/iter; left time: 1985.8934s
	iters: 200, epoch: 1 | loss: 1.3455943
	speed: 0.0389s/iter; left time: 1426.0419s
	iters: 300, epoch: 1 | loss: 1.1541983
	speed: 0.0389s/iter; left time: 1424.0920s
Epoch: 1 cost time: 15.969370603561401
Epoch: 1, Steps: 369 | Train Loss: 1.592 Vali Loss: 0.929 Vali Acc: 0.656 Test Loss: 0.929 Test Acc: 0.656
Validation loss decreased (inf --> -0.655780).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3275668
	speed: 0.1562s/iter; left time: 5689.4885s
	iters: 200, epoch: 2 | loss: 1.6511203
	speed: 0.0324s/iter; left time: 1175.5510s
	iters: 300, epoch: 2 | loss: 3.2516482
	speed: 0.0332s/iter; left time: 1203.6254s
Epoch: 2 cost time: 12.809993267059326
Epoch: 2, Steps: 369 | Train Loss: 1.817 Vali Loss: 2.445 Vali Acc: 0.627 Test Loss: 2.445 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0014770
	speed: 0.1461s/iter; left time: 5269.8419s
	iters: 200, epoch: 3 | loss: 1.7658561
	speed: 0.0344s/iter; left time: 1236.2616s
	iters: 300, epoch: 3 | loss: 2.1849508
	speed: 0.0357s/iter; left time: 1280.9298s
Epoch: 3 cost time: 13.293907880783081
Epoch: 3, Steps: 369 | Train Loss: 2.572 Vali Loss: 3.102 Vali Acc: 0.665 Test Loss: 3.102 Test Acc: 0.665
Validation loss decreased (-0.655780 --> -0.665122).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4373029
	speed: 0.1437s/iter; left time: 5130.4353s
	iters: 200, epoch: 4 | loss: 3.1803777
	speed: 0.0410s/iter; left time: 1457.9637s
	iters: 300, epoch: 4 | loss: 4.3883820
	speed: 0.0406s/iter; left time: 1442.5055s
Epoch: 4 cost time: 14.969908237457275
Epoch: 4, Steps: 369 | Train Loss: 2.808 Vali Loss: 3.799 Vali Acc: 0.653 Test Loss: 3.799 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7508357
	speed: 0.1584s/iter; left time: 5595.6736s
	iters: 200, epoch: 5 | loss: 2.2732308
	speed: 0.0402s/iter; left time: 1415.2940s
	iters: 300, epoch: 5 | loss: 1.6730924
	speed: 0.0401s/iter; left time: 1408.6458s
Epoch: 5 cost time: 15.371947288513184
Epoch: 5, Steps: 369 | Train Loss: 2.974 Vali Loss: 4.505 Vali Acc: 0.632 Test Loss: 4.505 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6828496
	speed: 0.1594s/iter; left time: 5571.4522s
	iters: 200, epoch: 6 | loss: 2.9776168
	speed: 0.0404s/iter; left time: 1409.5639s
	iters: 300, epoch: 6 | loss: 4.0997596
	speed: 0.0334s/iter; left time: 1160.4807s
Epoch: 6 cost time: 14.303007364273071
Epoch: 6, Steps: 369 | Train Loss: 2.763 Vali Loss: 6.445 Vali Acc: 0.635 Test Loss: 6.445 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.1564438
	speed: 0.1490s/iter; left time: 5153.7524s
	iters: 200, epoch: 7 | loss: 1.7053337
	speed: 0.0338s/iter; left time: 1167.0995s
	iters: 300, epoch: 7 | loss: 2.5086153
	speed: 0.0328s/iter; left time: 1127.7873s
Epoch: 7 cost time: 13.027238368988037
Epoch: 7, Steps: 369 | Train Loss: 2.792 Vali Loss: 4.983 Vali Acc: 0.642 Test Loss: 4.983 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.1708727
	speed: 0.1535s/iter; left time: 5251.3340s
	iters: 200, epoch: 8 | loss: 3.7852876
	speed: 0.0331s/iter; left time: 1130.6266s
	iters: 300, epoch: 8 | loss: 2.7173777
	speed: 0.0347s/iter; left time: 1181.8530s
Epoch: 8 cost time: 13.213929653167725
Epoch: 8, Steps: 369 | Train Loss: 2.437 Vali Loss: 6.688 Vali Acc: 0.621 Test Loss: 6.688 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.6985070
	speed: 0.1565s/iter; left time: 5295.9992s
	iters: 200, epoch: 9 | loss: 0.7982209
	speed: 0.0411s/iter; left time: 1388.7307s
	iters: 300, epoch: 9 | loss: 1.5488917
	speed: 0.0409s/iter; left time: 1376.2790s
Epoch: 9 cost time: 15.603169918060303
Epoch: 9, Steps: 369 | Train Loss: 2.009 Vali Loss: 7.409 Vali Acc: 0.644 Test Loss: 7.409 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.8318853
	speed: 0.1614s/iter; left time: 5404.1111s
	iters: 200, epoch: 10 | loss: 0.6056128
	speed: 0.0407s/iter; left time: 1357.2680s
	iters: 300, epoch: 10 | loss: 0.0000024
	speed: 0.0401s/iter; left time: 1335.1259s
Epoch: 10 cost time: 15.592901468276978
Epoch: 10, Steps: 369 | Train Loss: 1.668 Vali Loss: 7.956 Vali Acc: 0.635 Test Loss: 7.956 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.5762863
	speed: 0.1503s/iter; left time: 4978.2170s
	iters: 200, epoch: 11 | loss: 0.5272253
	speed: 0.0333s/iter; left time: 1099.6891s
	iters: 300, epoch: 11 | loss: 0.7261486
	speed: 0.0340s/iter; left time: 1118.6761s
Epoch: 11 cost time: 13.078788757324219
Epoch: 11, Steps: 369 | Train Loss: 1.256 Vali Loss: 7.637 Vali Acc: 0.632 Test Loss: 7.637 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.5187799
	speed: 0.1539s/iter; left time: 5038.4381s
	iters: 200, epoch: 12 | loss: 1.5783322
	speed: 0.0336s/iter; left time: 1095.7828s
	iters: 300, epoch: 12 | loss: 0.4315003
	speed: 0.0328s/iter; left time: 1067.9762s
Epoch: 12 cost time: 12.918183326721191
Epoch: 12, Steps: 369 | Train Loss: 1.206 Vali Loss: 8.085 Vali Acc: 0.643 Test Loss: 8.085 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4073954
	speed: 0.1636s/iter; left time: 5295.0060s
	iters: 200, epoch: 13 | loss: 1.5233892
	speed: 0.0397s/iter; left time: 1281.7987s
	iters: 300, epoch: 13 | loss: 0.0000367
	speed: 0.0394s/iter; left time: 1267.9121s
Epoch: 13 cost time: 15.205909252166748
Epoch: 13, Steps: 369 | Train Loss: 0.913 Vali Loss: 7.152 Vali Acc: 0.645 Test Loss: 7.152 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6651532349602725
model parameter : 433282
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.3497223
	speed: 0.0430s/iter; left time: 1584.1248s
	iters: 200, epoch: 1 | loss: 2.3084419
	speed: 0.0261s/iter; left time: 959.5185s
	iters: 300, epoch: 1 | loss: 0.9946694
	speed: 0.0275s/iter; left time: 1007.2294s
Epoch: 1 cost time: 11.627489805221558
Epoch: 1, Steps: 369 | Train Loss: 1.400 Vali Loss: 1.046 Vali Acc: 0.651 Test Loss: 1.046 Test Acc: 0.651
Validation loss decreased (inf --> -0.650954).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0977665
	speed: 0.1297s/iter; left time: 4725.6158s
	iters: 200, epoch: 2 | loss: 1.8783908
	speed: 0.0275s/iter; left time: 1000.5717s
	iters: 300, epoch: 2 | loss: 1.9395202
	speed: 0.0275s/iter; left time: 995.5493s
Epoch: 2 cost time: 10.784765481948853
Epoch: 2, Steps: 369 | Train Loss: 1.514 Vali Loss: 1.925 Vali Acc: 0.646 Test Loss: 1.925 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4897759
	speed: 0.1415s/iter; left time: 5103.8828s
	iters: 200, epoch: 3 | loss: 0.8622801
	speed: 0.0353s/iter; left time: 1268.3405s
	iters: 300, epoch: 3 | loss: 3.6536279
	speed: 0.0348s/iter; left time: 1249.1067s
Epoch: 3 cost time: 13.380781173706055
Epoch: 3, Steps: 369 | Train Loss: 2.135 Vali Loss: 2.105 Vali Acc: 0.647 Test Loss: 2.105 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6477172
	speed: 0.1405s/iter; left time: 5015.8952s
	iters: 200, epoch: 4 | loss: 6.5122004
	speed: 0.0351s/iter; left time: 1247.6335s
	iters: 300, epoch: 4 | loss: 3.9736943
	speed: 0.0346s/iter; left time: 1229.3525s
Epoch: 4 cost time: 13.470834255218506
Epoch: 4, Steps: 369 | Train Loss: 2.526 Vali Loss: 4.879 Vali Acc: 0.645 Test Loss: 4.879 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.9500614
	speed: 0.1291s/iter; left time: 4560.5136s
	iters: 200, epoch: 5 | loss: 0.9756435
	speed: 0.0284s/iter; left time: 1001.4065s
	iters: 300, epoch: 5 | loss: 1.1869643
	speed: 0.0277s/iter; left time: 972.3235s
Epoch: 5 cost time: 10.871200323104858
Epoch: 5, Steps: 369 | Train Loss: 2.609 Vali Loss: 4.665 Vali Acc: 0.631 Test Loss: 4.665 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9421979
	speed: 0.1297s/iter; left time: 4532.6622s
	iters: 200, epoch: 6 | loss: 1.3461727
	speed: 0.0283s/iter; left time: 986.9839s
	iters: 300, epoch: 6 | loss: 3.4231322
	speed: 0.0284s/iter; left time: 986.1427s
Epoch: 6 cost time: 10.834444522857666
Epoch: 6, Steps: 369 | Train Loss: 2.531 Vali Loss: 5.438 Vali Acc: 0.639 Test Loss: 5.438 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6692433
	speed: 0.1299s/iter; left time: 4492.3608s
	iters: 200, epoch: 7 | loss: 0.0010493
	speed: 0.0285s/iter; left time: 981.2747s
	iters: 300, epoch: 7 | loss: 1.1474488
	speed: 0.0328s/iter; left time: 1126.7439s
Epoch: 7 cost time: 12.045293092727661
Epoch: 7, Steps: 369 | Train Loss: 2.328 Vali Loss: 5.981 Vali Acc: 0.625 Test Loss: 5.981 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.5656514
	speed: 0.1404s/iter; left time: 4803.1248s
	iters: 200, epoch: 8 | loss: 0.8668489
	speed: 0.0358s/iter; left time: 1219.7833s
	iters: 300, epoch: 8 | loss: 0.9195014
	speed: 0.0360s/iter; left time: 1225.1011s
Epoch: 8 cost time: 13.711673498153687
Epoch: 8, Steps: 369 | Train Loss: 1.923 Vali Loss: 6.996 Vali Acc: 0.645 Test Loss: 6.996 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.2132211
	speed: 0.1424s/iter; left time: 4819.8598s
	iters: 200, epoch: 9 | loss: 3.2948728
	speed: 0.0351s/iter; left time: 1183.9567s
	iters: 300, epoch: 9 | loss: 0.5970599
	speed: 0.0349s/iter; left time: 1174.5693s
Epoch: 9 cost time: 13.460548162460327
Epoch: 9, Steps: 369 | Train Loss: 1.717 Vali Loss: 6.745 Vali Acc: 0.646 Test Loss: 6.745 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 3.3783755
	speed: 0.1303s/iter; left time: 4361.1658s
	iters: 200, epoch: 10 | loss: 2.4229999
	speed: 0.0282s/iter; left time: 942.4700s
	iters: 300, epoch: 10 | loss: 5.5049171
	speed: 0.0277s/iter; left time: 920.3507s
Epoch: 10 cost time: 10.901103019714355
Epoch: 10, Steps: 369 | Train Loss: 1.393 Vali Loss: 6.900 Vali Acc: 0.636 Test Loss: 6.900 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.4768889
	speed: 0.1305s/iter; left time: 4321.0782s
	iters: 200, epoch: 11 | loss: 4.5493793
	speed: 0.0276s/iter; left time: 910.5043s
	iters: 300, epoch: 11 | loss: 0.0493233
	speed: 0.0275s/iter; left time: 906.2083s
Epoch: 11 cost time: 10.635944604873657
Epoch: 11, Steps: 369 | Train Loss: 1.319 Vali Loss: 7.105 Vali Acc: 0.633 Test Loss: 7.105 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6509648127128264
model parameter : 359938
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 21.0598106
	speed: 0.2091s/iter; left time: 7696.6821s
	iters: 200, epoch: 1 | loss: 4.7054996
	speed: 0.1840s/iter; left time: 6753.6958s
	iters: 300, epoch: 1 | loss: 2.0816135
	speed: 0.1590s/iter; left time: 5819.6875s
Epoch: 1 cost time: 66.15006232261658
Epoch: 1, Steps: 369 | Train Loss: 5.760 Vali Loss: 2.029 Vali Acc: 0.657 Test Loss: 2.029 Test Acc: 0.657
Validation loss decreased (inf --> -0.656620).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7615471
	speed: 0.6143s/iter; left time: 22378.5691s
	iters: 200, epoch: 2 | loss: 5.1065731
	speed: 0.1938s/iter; left time: 7039.9391s
	iters: 300, epoch: 2 | loss: 10.8904200
	speed: 0.1845s/iter; left time: 6685.9569s
Epoch: 2 cost time: 69.05493068695068
Epoch: 2, Steps: 369 | Train Loss: 5.236 Vali Loss: 6.378 Vali Acc: 0.661 Test Loss: 6.378 Test Acc: 0.661
Validation loss decreased (-0.656620 --> -0.661400).  Saving model ...
	iters: 100, epoch: 3 | loss: 9.4594316
	speed: 0.6258s/iter; left time: 22569.4264s
	iters: 200, epoch: 3 | loss: 0.0307522
	speed: 0.1916s/iter; left time: 6891.5352s
	iters: 300, epoch: 3 | loss: 4.1512508
	speed: 0.1919s/iter; left time: 6881.4206s
Epoch: 3 cost time: 71.20090985298157
Epoch: 3, Steps: 369 | Train Loss: 7.451 Vali Loss: 8.566 Vali Acc: 0.634 Test Loss: 8.566 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 14.1932449
	speed: 0.6039s/iter; left time: 21557.2315s
	iters: 200, epoch: 4 | loss: 7.1251373
	speed: 0.1811s/iter; left time: 6445.2703s
	iters: 300, epoch: 4 | loss: 5.4074273
	speed: 0.1932s/iter; left time: 6856.7707s
Epoch: 4 cost time: 67.14813327789307
Epoch: 4, Steps: 369 | Train Loss: 7.999 Vali Loss: 15.616 Vali Acc: 0.627 Test Loss: 15.616 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 5.9925990
	speed: 0.6254s/iter; left time: 22092.6860s
	iters: 200, epoch: 5 | loss: 6.4012585
	speed: 0.1618s/iter; left time: 5698.0689s
	iters: 300, epoch: 5 | loss: 4.3376532
	speed: 0.1681s/iter; left time: 5903.9519s
Epoch: 5 cost time: 61.7448890209198
Epoch: 5, Steps: 369 | Train Loss: 8.312 Vali Loss: 16.658 Vali Acc: 0.660 Test Loss: 16.658 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 5.6124492
	speed: 0.6149s/iter; left time: 21493.1224s
	iters: 200, epoch: 6 | loss: 14.6335135
	speed: 0.1983s/iter; left time: 6913.6519s
	iters: 300, epoch: 6 | loss: 9.1814642
	speed: 0.1964s/iter; left time: 6825.7029s
Epoch: 6 cost time: 70.88145804405212
Epoch: 6, Steps: 369 | Train Loss: 7.709 Vali Loss: 15.531 Vali Acc: 0.644 Test Loss: 15.531 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 14.9724941
	speed: 0.6123s/iter; left time: 21176.8922s
	iters: 200, epoch: 7 | loss: 0.6566752
	speed: 0.1900s/iter; left time: 6552.8212s
	iters: 300, epoch: 7 | loss: 3.2684176
	speed: 0.1912s/iter; left time: 6573.3963s
Epoch: 7 cost time: 69.59186553955078
Epoch: 7, Steps: 369 | Train Loss: 6.210 Vali Loss: 24.158 Vali Acc: 0.608 Test Loss: 24.158 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.6211s/iter; left time: 21254.1005s
	iters: 200, epoch: 8 | loss: 8.1236191
	speed: 0.1815s/iter; left time: 6192.1497s
	iters: 300, epoch: 8 | loss: 7.5640860
	speed: 0.1921s/iter; left time: 6533.3258s
Epoch: 8 cost time: 68.03188300132751
Epoch: 8, Steps: 369 | Train Loss: 5.853 Vali Loss: 24.485 Vali Acc: 0.627 Test Loss: 24.485 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.4406137
	speed: 0.6299s/iter; left time: 21320.0038s
	iters: 200, epoch: 9 | loss: 5.1533504
	speed: 0.1631s/iter; left time: 5504.0683s
	iters: 300, epoch: 9 | loss: 8.2383423
	speed: 0.1861s/iter; left time: 6260.5793s
Epoch: 9 cost time: 65.26491451263428
Epoch: 9, Steps: 369 | Train Loss: 5.106 Vali Loss: 25.969 Vali Acc: 0.642 Test Loss: 25.969 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 5.1483693
	speed: 0.6603s/iter; left time: 22106.2381s
	iters: 200, epoch: 10 | loss: 2.5428085
	speed: 0.1619s/iter; left time: 5404.1982s
	iters: 300, epoch: 10 | loss: 2.8922906
	speed: 0.1668s/iter; left time: 5552.6709s
Epoch: 10 cost time: 61.87450361251831
Epoch: 10, Steps: 369 | Train Loss: 3.853 Vali Loss: 26.053 Vali Acc: 0.631 Test Loss: 26.053 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6496s/iter; left time: 21508.5438s
	iters: 200, epoch: 11 | loss: 0.8227744
	speed: 0.1746s/iter; left time: 5762.6076s
	iters: 300, epoch: 11 | loss: 0.9003825
	speed: 0.1620s/iter; left time: 5330.6913s
Epoch: 11 cost time: 65.07845091819763
Epoch: 11, Steps: 369 | Train Loss: 2.771 Vali Loss: 29.508 Vali Acc: 0.625 Test Loss: 29.508 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6463s/iter; left time: 21160.3783s
	iters: 200, epoch: 12 | loss: 3.8044739
	speed: 0.1969s/iter; left time: 6426.9693s
	iters: 300, epoch: 12 | loss: 3.6851757
	speed: 0.1761s/iter; left time: 5730.8465s
Epoch: 12 cost time: 68.5278537273407
Epoch: 12, Steps: 369 | Train Loss: 2.326 Vali Loss: 28.865 Vali Acc: 0.627 Test Loss: 28.865 Test Acc: 0.627
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6614642451759364
model parameter : 2369218
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.7766271
	speed: 0.1018s/iter; left time: 3746.2035s
	iters: 200, epoch: 1 | loss: 1.1274241
	speed: 0.0799s/iter; left time: 2932.4381s
	iters: 300, epoch: 1 | loss: 2.0115876
	speed: 0.0789s/iter; left time: 2888.5714s
Epoch: 1 cost time: 32.06121063232422
Epoch: 1, Steps: 369 | Train Loss: 3.145 Vali Loss: 1.736 Vali Acc: 0.647 Test Loss: 1.736 Test Acc: 0.647
Validation loss decreased (inf --> -0.646975).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7935605
	speed: 0.3486s/iter; left time: 12698.8278s
	iters: 200, epoch: 2 | loss: 4.1798825
	speed: 0.0973s/iter; left time: 3533.5415s
	iters: 300, epoch: 2 | loss: 9.5400553
	speed: 0.0974s/iter; left time: 3529.7508s
Epoch: 2 cost time: 36.461769104003906
Epoch: 2, Steps: 369 | Train Loss: 3.598 Vali Loss: 2.717 Vali Acc: 0.666 Test Loss: 2.717 Test Acc: 0.666
Validation loss decreased (-0.646975 --> -0.665977).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4335377
	speed: 0.3529s/iter; left time: 12727.1499s
	iters: 200, epoch: 3 | loss: 3.4721377
	speed: 0.0852s/iter; left time: 3063.8178s
	iters: 300, epoch: 3 | loss: 6.6045365
	speed: 0.0782s/iter; left time: 2804.5835s
Epoch: 3 cost time: 30.618251085281372
Epoch: 3, Steps: 369 | Train Loss: 5.169 Vali Loss: 5.504 Vali Acc: 0.665 Test Loss: 5.504 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3917436
	speed: 0.3375s/iter; left time: 12046.4761s
	iters: 200, epoch: 4 | loss: 6.2431173
	speed: 0.1005s/iter; left time: 3577.0766s
	iters: 300, epoch: 4 | loss: 5.1167989
	speed: 0.1001s/iter; left time: 3554.2073s
Epoch: 4 cost time: 37.06823396682739
Epoch: 4, Steps: 369 | Train Loss: 5.652 Vali Loss: 7.071 Vali Acc: 0.653 Test Loss: 7.071 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.3002570
	speed: 0.3687s/iter; left time: 13025.8413s
	iters: 200, epoch: 5 | loss: 9.5623436
	speed: 0.0827s/iter; left time: 2913.2541s
	iters: 300, epoch: 5 | loss: 6.2377100
	speed: 0.0860s/iter; left time: 3020.0610s
Epoch: 5 cost time: 32.978456020355225
Epoch: 5, Steps: 369 | Train Loss: 6.371 Vali Loss: 10.159 Vali Acc: 0.641 Test Loss: 10.159 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 5.8955193
	speed: 0.3288s/iter; left time: 11494.0396s
	iters: 200, epoch: 6 | loss: 11.5075092
	speed: 0.0944s/iter; left time: 3289.7857s
	iters: 300, epoch: 6 | loss: 7.1080956
	speed: 0.1022s/iter; left time: 3552.4068s
Epoch: 6 cost time: 35.413339376449585
Epoch: 6, Steps: 369 | Train Loss: 5.730 Vali Loss: 9.766 Vali Acc: 0.644 Test Loss: 9.766 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3855131
	speed: 0.3717s/iter; left time: 12855.7802s
	iters: 200, epoch: 7 | loss: 1.1759161
	speed: 0.0899s/iter; left time: 3099.1674s
	iters: 300, epoch: 7 | loss: 3.8664613
	speed: 0.0836s/iter; left time: 2876.3153s
Epoch: 7 cost time: 33.482813119888306
Epoch: 7, Steps: 369 | Train Loss: 5.188 Vali Loss: 11.377 Vali Acc: 0.633 Test Loss: 11.377 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 4.9207115
	speed: 0.3245s/iter; left time: 11103.5610s
	iters: 200, epoch: 8 | loss: 13.9669504
	speed: 0.0888s/iter; left time: 3028.4911s
	iters: 300, epoch: 8 | loss: 1.3847320
	speed: 0.0957s/iter; left time: 3254.4293s
Epoch: 8 cost time: 33.88793683052063
Epoch: 8, Steps: 369 | Train Loss: 4.672 Vali Loss: 11.417 Vali Acc: 0.643 Test Loss: 11.417 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 5.1443405
	speed: 0.3685s/iter; left time: 12472.5457s
	iters: 200, epoch: 9 | loss: 1.7862285
	speed: 0.0972s/iter; left time: 3279.4699s
	iters: 300, epoch: 9 | loss: 1.1840914
	speed: 0.0821s/iter; left time: 2763.6947s
Epoch: 9 cost time: 33.472245931625366
Epoch: 9, Steps: 369 | Train Loss: 3.650 Vali Loss: 15.789 Vali Acc: 0.633 Test Loss: 15.789 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.9194825
	speed: 0.3288s/iter; left time: 11009.7519s
	iters: 200, epoch: 10 | loss: 4.1623068
	speed: 0.0866s/iter; left time: 2890.9212s
	iters: 300, epoch: 10 | loss: 3.1741285
	speed: 0.0998s/iter; left time: 3320.2135s
Epoch: 10 cost time: 34.80482053756714
Epoch: 10, Steps: 369 | Train Loss: 3.115 Vali Loss: 15.028 Vali Acc: 0.623 Test Loss: 15.028 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.5035348
	speed: 0.3735s/iter; left time: 12368.5663s
	iters: 200, epoch: 11 | loss: 6.7744441
	speed: 0.0982s/iter; left time: 3242.0266s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 3069.3418s
Epoch: 11 cost time: 35.45054888725281
Epoch: 11, Steps: 369 | Train Loss: 2.235 Vali Loss: 13.786 Vali Acc: 0.622 Test Loss: 13.786 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000099
	speed: 0.3257s/iter; left time: 10663.0243s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2604.0329s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0849s/iter; left time: 2761.3322s
Epoch: 12 cost time: 32.19472551345825
Epoch: 12, Steps: 369 | Train Loss: 1.636 Vali Loss: 15.042 Vali Acc: 0.646 Test Loss: 15.042 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6660045402951191
model parameter : 1226690
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1065011
	speed: 0.0732s/iter; left time: 2692.7739s
	iters: 200, epoch: 1 | loss: 1.8921084
	speed: 0.0538s/iter; left time: 1973.4346s
	iters: 300, epoch: 1 | loss: 1.6612409
	speed: 0.0571s/iter; left time: 2088.3579s
Epoch: 1 cost time: 22.60584545135498
Epoch: 1, Steps: 369 | Train Loss: 2.566 Vali Loss: 1.250 Vali Acc: 0.661 Test Loss: 1.250 Test Acc: 0.661
Validation loss decreased (inf --> -0.661452).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4300923
	speed: 0.2522s/iter; left time: 9187.1493s
	iters: 200, epoch: 2 | loss: 2.4052134
	speed: 0.0697s/iter; left time: 2532.3605s
	iters: 300, epoch: 2 | loss: 6.3179631
	speed: 0.0704s/iter; left time: 2549.8082s
Epoch: 2 cost time: 26.49287748336792
Epoch: 2, Steps: 369 | Train Loss: 3.070 Vali Loss: 2.933 Vali Acc: 0.633 Test Loss: 2.933 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.5127735
	speed: 0.2669s/iter; left time: 9625.7348s
	iters: 200, epoch: 3 | loss: 0.7208940
	speed: 0.0620s/iter; left time: 2230.3458s
	iters: 300, epoch: 3 | loss: 5.2929440
	speed: 0.0589s/iter; left time: 2111.1238s
Epoch: 3 cost time: 23.875603437423706
Epoch: 3, Steps: 369 | Train Loss: 4.179 Vali Loss: 4.368 Vali Acc: 0.644 Test Loss: 4.368 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0121352
	speed: 0.2387s/iter; left time: 8520.4089s
	iters: 200, epoch: 4 | loss: 3.3652525
	speed: 0.0627s/iter; left time: 2231.4099s
	iters: 300, epoch: 4 | loss: 1.7918667
	speed: 0.0618s/iter; left time: 2193.0054s
Epoch: 4 cost time: 23.615016222000122
Epoch: 4, Steps: 369 | Train Loss: 4.571 Vali Loss: 5.905 Vali Acc: 0.634 Test Loss: 5.905 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.4726059
	speed: 0.2656s/iter; left time: 9381.0663s
	iters: 200, epoch: 5 | loss: 10.6168232
	speed: 0.0706s/iter; left time: 2487.5893s
	iters: 300, epoch: 5 | loss: 7.7834430
	speed: 0.0695s/iter; left time: 2439.4517s
Epoch: 5 cost time: 26.373135566711426
Epoch: 5, Steps: 369 | Train Loss: 5.113 Vali Loss: 8.452 Vali Acc: 0.630 Test Loss: 8.452 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 4.9989543
	speed: 0.2475s/iter; left time: 8652.6770s
	iters: 200, epoch: 6 | loss: 2.6025434
	speed: 0.0589s/iter; left time: 2054.5378s
	iters: 300, epoch: 6 | loss: 7.8675265
	speed: 0.0619s/iter; left time: 2151.7454s
Epoch: 6 cost time: 22.60433530807495
Epoch: 6, Steps: 369 | Train Loss: 4.703 Vali Loss: 8.038 Vali Acc: 0.656 Test Loss: 8.038 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 6.6686954
	speed: 0.2380s/iter; left time: 8230.4813s
	iters: 200, epoch: 7 | loss: 1.5943165
	speed: 0.0652s/iter; left time: 2247.0261s
	iters: 300, epoch: 7 | loss: 8.1411476
	speed: 0.0716s/iter; left time: 2463.3642s
Epoch: 7 cost time: 25.433305263519287
Epoch: 7, Steps: 369 | Train Loss: 4.796 Vali Loss: 9.762 Vali Acc: 0.623 Test Loss: 9.762 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 3.8607297
	speed: 0.2763s/iter; left time: 9455.9842s
	iters: 200, epoch: 8 | loss: 2.6286337
	speed: 0.0737s/iter; left time: 2516.0776s
	iters: 300, epoch: 8 | loss: 4.7275672
	speed: 0.0730s/iter; left time: 2482.6354s
Epoch: 8 cost time: 27.7045578956604
Epoch: 8, Steps: 369 | Train Loss: 3.705 Vali Loss: 11.702 Vali Acc: 0.657 Test Loss: 11.702 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.2663634
	speed: 0.2456s/iter; left time: 8312.8041s
	iters: 200, epoch: 9 | loss: 4.6290073
	speed: 0.0616s/iter; left time: 2080.1186s
	iters: 300, epoch: 9 | loss: 3.8352354
	speed: 0.0593s/iter; left time: 1994.3495s
Epoch: 9 cost time: 22.844033241271973
Epoch: 9, Steps: 369 | Train Loss: 3.257 Vali Loss: 11.530 Vali Acc: 0.620 Test Loss: 11.530 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0009908
	speed: 0.2451s/iter; left time: 8205.8704s
	iters: 200, epoch: 10 | loss: 5.8843813
	speed: 0.0727s/iter; left time: 2427.7292s
	iters: 300, epoch: 10 | loss: 3.8450637
	speed: 0.0719s/iter; left time: 2393.5334s
Epoch: 10 cost time: 26.36351704597473
Epoch: 10, Steps: 369 | Train Loss: 2.685 Vali Loss: 11.477 Vali Acc: 0.637 Test Loss: 11.477 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 4.0299654
	speed: 0.2719s/iter; left time: 9004.1461s
	iters: 200, epoch: 11 | loss: 2.7526710
	speed: 0.0705s/iter; left time: 2326.4124s
	iters: 300, epoch: 11 | loss: 7.2696791
	speed: 0.0707s/iter; left time: 2327.3124s
Epoch: 11 cost time: 26.115047931671143
Epoch: 11, Steps: 369 | Train Loss: 2.038 Vali Loss: 11.114 Vali Acc: 0.644 Test Loss: 11.114 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6614642451759364
model parameter : 858178
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.1754336
	speed: 0.0712s/iter; left time: 2620.5514s
	iters: 200, epoch: 1 | loss: 2.8824570
	speed: 0.0521s/iter; left time: 1912.1145s
	iters: 300, epoch: 1 | loss: 1.1942308
	speed: 0.0527s/iter; left time: 1927.9395s
Epoch: 1 cost time: 21.376609086990356
Epoch: 1, Steps: 369 | Train Loss: 1.990 Vali Loss: 2.179 Vali Acc: 0.585 Test Loss: 2.179 Test Acc: 0.585
Validation loss decreased (inf --> -0.584541).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9839567
	speed: 0.2032s/iter; left time: 7403.1068s
	iters: 200, epoch: 2 | loss: 0.5977172
	speed: 0.0434s/iter; left time: 1577.4404s
	iters: 300, epoch: 2 | loss: 4.7116647
	speed: 0.0448s/iter; left time: 1624.8098s
Epoch: 2 cost time: 16.939965963363647
Epoch: 2, Steps: 369 | Train Loss: 2.437 Vali Loss: 4.182 Vali Acc: 0.602 Test Loss: 4.182 Test Acc: 0.602
Validation loss decreased (-0.584541 --> -0.602399).  Saving model ...
	iters: 100, epoch: 3 | loss: 6.1611400
	speed: 0.1852s/iter; left time: 6677.1310s
	iters: 200, epoch: 3 | loss: 4.0430846
	speed: 0.0462s/iter; left time: 1661.8510s
	iters: 300, epoch: 3 | loss: 7.2939944
	speed: 0.0472s/iter; left time: 1691.2762s
Epoch: 3 cost time: 17.940945625305176
Epoch: 3, Steps: 369 | Train Loss: 3.276 Vali Loss: 3.983 Vali Acc: 0.653 Test Loss: 3.983 Test Acc: 0.653
Validation loss decreased (-0.602399 --> -0.652911).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1164258
	speed: 0.2043s/iter; left time: 7292.3431s
	iters: 200, epoch: 4 | loss: 1.8740968
	speed: 0.0558s/iter; left time: 1985.8035s
	iters: 300, epoch: 4 | loss: 3.3141296
	speed: 0.0554s/iter; left time: 1968.1106s
Epoch: 4 cost time: 21.08711528778076
Epoch: 4, Steps: 369 | Train Loss: 3.677 Vali Loss: 6.190 Vali Acc: 0.651 Test Loss: 6.190 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.9821761
	speed: 0.2163s/iter; left time: 7641.1440s
	iters: 200, epoch: 5 | loss: 2.3464851
	speed: 0.0518s/iter; left time: 1825.2914s
	iters: 300, epoch: 5 | loss: 9.9670506
	speed: 0.0448s/iter; left time: 1572.9112s
Epoch: 5 cost time: 18.926074266433716
Epoch: 5, Steps: 369 | Train Loss: 4.013 Vali Loss: 6.515 Vali Acc: 0.650 Test Loss: 6.515 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0332629
	speed: 0.1861s/iter; left time: 6506.4861s
	iters: 200, epoch: 6 | loss: 5.5018444
	speed: 0.0473s/iter; left time: 1647.2008s
	iters: 300, epoch: 6 | loss: 2.2234542
	speed: 0.0450s/iter; left time: 1563.8463s
Epoch: 6 cost time: 17.317312002182007
Epoch: 6, Steps: 369 | Train Loss: 4.135 Vali Loss: 7.207 Vali Acc: 0.627 Test Loss: 7.207 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 7.6940908
	speed: 0.2000s/iter; left time: 6916.8572s
	iters: 200, epoch: 7 | loss: 1.4351072
	speed: 0.0551s/iter; left time: 1898.7647s
	iters: 300, epoch: 7 | loss: 7.3299150
	speed: 0.0543s/iter; left time: 1867.9246s
Epoch: 7 cost time: 20.514336109161377
Epoch: 7, Steps: 369 | Train Loss: 3.479 Vali Loss: 8.271 Vali Acc: 0.627 Test Loss: 8.271 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 5.1796594
	speed: 0.2083s/iter; left time: 7128.6349s
	iters: 200, epoch: 8 | loss: 0.9544895
	speed: 0.0557s/iter; left time: 1899.1584s
	iters: 300, epoch: 8 | loss: 2.0842493
	speed: 0.0563s/iter; left time: 1914.4408s
Epoch: 8 cost time: 21.134695291519165
Epoch: 8, Steps: 369 | Train Loss: 2.941 Vali Loss: 11.004 Vali Acc: 0.632 Test Loss: 11.004 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.1961389
	speed: 0.1924s/iter; left time: 6513.7857s
	iters: 200, epoch: 9 | loss: 0.2749980
	speed: 0.0454s/iter; left time: 1531.1122s
	iters: 300, epoch: 9 | loss: 6.7795763
	speed: 0.0436s/iter; left time: 1467.0007s
Epoch: 9 cost time: 17.183338403701782
Epoch: 9, Steps: 369 | Train Loss: 2.587 Vali Loss: 10.859 Vali Acc: 0.633 Test Loss: 10.859 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3228780
	speed: 0.1857s/iter; left time: 6215.7152s
	iters: 200, epoch: 10 | loss: 5.5479746
	speed: 0.0460s/iter; left time: 1534.9139s
	iters: 300, epoch: 10 | loss: 3.7670503
	speed: 0.0445s/iter; left time: 1480.1689s
Epoch: 10 cost time: 17.83249282836914
Epoch: 10, Steps: 369 | Train Loss: 2.218 Vali Loss: 10.672 Vali Acc: 0.641 Test Loss: 10.672 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 6.3726778
	speed: 0.2164s/iter; left time: 7166.1818s
	iters: 200, epoch: 11 | loss: 1.9303784
	speed: 0.0531s/iter; left time: 1752.3379s
	iters: 300, epoch: 11 | loss: 1.6183404
	speed: 0.0533s/iter; left time: 1752.9749s
Epoch: 11 cost time: 20.329626083374023
Epoch: 11, Steps: 369 | Train Loss: 1.760 Vali Loss: 10.716 Vali Acc: 0.636 Test Loss: 10.716 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.4707944
	speed: 0.2071s/iter; left time: 6781.7676s
	iters: 200, epoch: 12 | loss: 0.8648713
	speed: 0.0444s/iter; left time: 1447.7117s
	iters: 300, epoch: 12 | loss: 2.2181208
	speed: 0.0455s/iter; left time: 1480.2897s
Epoch: 12 cost time: 17.612468004226685
Epoch: 12, Steps: 369 | Train Loss: 1.346 Vali Loss: 10.529 Vali Acc: 0.634 Test Loss: 10.529 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000044
	speed: 0.1821s/iter; left time: 5894.1710s
	iters: 200, epoch: 13 | loss: 1.2728639
	speed: 0.0462s/iter; left time: 1490.1746s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1441.5173s
Epoch: 13 cost time: 17.44664478302002
Epoch: 13, Steps: 369 | Train Loss: 1.117 Vali Loss: 10.310 Vali Acc: 0.638 Test Loss: 10.310 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6529511918274687
model parameter : 637250
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8116964
	speed: 0.0528s/iter; left time: 1942.4111s
	iters: 200, epoch: 1 | loss: 1.7769525
	speed: 0.0380s/iter; left time: 1393.8438s
	iters: 300, epoch: 1 | loss: 1.6742008
	speed: 0.0394s/iter; left time: 1442.9720s
Epoch: 1 cost time: 15.815081119537354
Epoch: 1, Steps: 369 | Train Loss: 1.822 Vali Loss: 1.396 Vali Acc: 0.600 Test Loss: 1.396 Test Acc: 0.600
Validation loss decreased (inf --> -0.599873).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2455394
	speed: 0.1666s/iter; left time: 6068.2450s
	iters: 200, epoch: 2 | loss: 2.3314366
	speed: 0.0388s/iter; left time: 1409.5575s
	iters: 300, epoch: 2 | loss: 1.9980005
	speed: 0.0399s/iter; left time: 1444.7820s
Epoch: 2 cost time: 15.325073719024658
Epoch: 2, Steps: 369 | Train Loss: 2.243 Vali Loss: 2.992 Vali Acc: 0.623 Test Loss: 2.992 Test Acc: 0.623
Validation loss decreased (-0.599873 --> -0.623126).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4852970
	speed: 0.1669s/iter; left time: 6017.4572s
	iters: 200, epoch: 3 | loss: 0.8637654
	speed: 0.0443s/iter; left time: 1594.8190s
	iters: 300, epoch: 3 | loss: 9.0360126
	speed: 0.0441s/iter; left time: 1581.5592s
Epoch: 3 cost time: 16.151639699935913
Epoch: 3, Steps: 369 | Train Loss: 3.122 Vali Loss: 5.193 Vali Acc: 0.607 Test Loss: 5.193 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5125961
	speed: 0.1461s/iter; left time: 5214.1047s
	iters: 200, epoch: 4 | loss: 7.3899789
	speed: 0.0336s/iter; left time: 1195.7263s
	iters: 300, epoch: 4 | loss: 6.8268085
	speed: 0.0330s/iter; left time: 1170.7607s
Epoch: 4 cost time: 13.039273977279663
Epoch: 4, Steps: 369 | Train Loss: 3.310 Vali Loss: 4.048 Vali Acc: 0.633 Test Loss: 4.048 Test Acc: 0.633
Validation loss decreased (-0.623126 --> -0.633331).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.2377257
	speed: 0.2626s/iter; left time: 9276.7006s
	iters: 200, epoch: 5 | loss: 3.6317389
	speed: 0.0770s/iter; left time: 2714.0178s
	iters: 300, epoch: 5 | loss: 2.1113908
	speed: 0.0773s/iter; left time: 2715.8181s
Epoch: 5 cost time: 29.245301723480225
Epoch: 5, Steps: 369 | Train Loss: 3.395 Vali Loss: 5.319 Vali Acc: 0.654 Test Loss: 5.319 Test Acc: 0.654
Validation loss decreased (-0.633331 --> -0.653749).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.3221445
	speed: 0.3005s/iter; left time: 10505.7767s
	iters: 200, epoch: 6 | loss: 6.7786822
	speed: 0.0772s/iter; left time: 2690.4712s
	iters: 300, epoch: 6 | loss: 1.0072565
	speed: 0.0759s/iter; left time: 2637.8283s
Epoch: 6 cost time: 29.0414297580719
Epoch: 6, Steps: 369 | Train Loss: 3.238 Vali Loss: 7.719 Vali Acc: 0.640 Test Loss: 7.719 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1090713
	speed: 0.2890s/iter; left time: 9996.8462s
	iters: 200, epoch: 7 | loss: 5.1710434
	speed: 0.0767s/iter; left time: 2646.3578s
	iters: 300, epoch: 7 | loss: 0.5921047
	speed: 0.0757s/iter; left time: 2604.0781s
Epoch: 7 cost time: 28.54340124130249
Epoch: 7, Steps: 369 | Train Loss: 3.001 Vali Loss: 7.044 Vali Acc: 0.635 Test Loss: 7.044 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8437544
	speed: 0.2961s/iter; left time: 10131.3266s
	iters: 200, epoch: 8 | loss: 3.3057630
	speed: 0.0764s/iter; left time: 2605.1008s
	iters: 300, epoch: 8 | loss: 1.1862330
	speed: 0.0767s/iter; left time: 2608.3620s
Epoch: 8 cost time: 28.871463537216187
Epoch: 8, Steps: 369 | Train Loss: 2.738 Vali Loss: 7.870 Vali Acc: 0.634 Test Loss: 7.870 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3283744
	speed: 0.2940s/iter; left time: 9951.4404s
	iters: 200, epoch: 9 | loss: 2.7300882
	speed: 0.0719s/iter; left time: 2427.6313s
	iters: 300, epoch: 9 | loss: 3.4141581
	speed: 0.0796s/iter; left time: 2678.0987s
Epoch: 9 cost time: 28.762152433395386
Epoch: 9, Steps: 369 | Train Loss: 2.266 Vali Loss: 8.755 Vali Acc: 0.636 Test Loss: 8.755 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3979693
	speed: 0.2899s/iter; left time: 9704.9558s
	iters: 200, epoch: 10 | loss: 2.9462252
	speed: 0.0781s/iter; left time: 2606.7360s
	iters: 300, epoch: 10 | loss: 0.3111844
	speed: 0.0768s/iter; left time: 2556.1675s
Epoch: 10 cost time: 28.803043127059937
Epoch: 10, Steps: 369 | Train Loss: 1.943 Vali Loss: 9.361 Vali Acc: 0.629 Test Loss: 9.361 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3041s/iter; left time: 10069.1679s
	iters: 200, epoch: 11 | loss: 0.0438428
	speed: 0.0763s/iter; left time: 2518.8366s
	iters: 300, epoch: 11 | loss: 3.1545875
	speed: 0.0745s/iter; left time: 2450.3984s
Epoch: 11 cost time: 28.73505973815918
Epoch: 11, Steps: 369 | Train Loss: 1.533 Vali Loss: 10.022 Vali Acc: 0.640 Test Loss: 10.022 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7237204
	speed: 0.2928s/iter; left time: 9587.6096s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0777s/iter; left time: 2536.0925s
	iters: 300, epoch: 12 | loss: 0.1847123
	speed: 0.0774s/iter; left time: 2519.9618s
Epoch: 12 cost time: 29.206095933914185
Epoch: 12, Steps: 369 | Train Loss: 1.281 Vali Loss: 9.471 Vali Acc: 0.644 Test Loss: 9.471 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.6951706
	speed: 0.2875s/iter; left time: 9306.0909s
	iters: 200, epoch: 13 | loss: 3.2029774
	speed: 0.0700s/iter; left time: 2259.3150s
	iters: 300, epoch: 13 | loss: 1.7395816
	speed: 0.0665s/iter; left time: 2139.4417s
Epoch: 13 cost time: 25.683288097381592
Epoch: 13, Steps: 369 | Train Loss: 1.165 Vali Loss: 8.581 Vali Acc: 0.648 Test Loss: 8.581 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.0089340
	speed: 0.2689s/iter; left time: 8606.4084s
	iters: 200, epoch: 14 | loss: 3.6860640
	speed: 0.0635s/iter; left time: 2024.4675s
	iters: 300, epoch: 14 | loss: 0.0000004
	speed: 0.0688s/iter; left time: 2188.9985s
Epoch: 14 cost time: 24.929733276367188
Epoch: 14, Steps: 369 | Train Loss: 0.812 Vali Loss: 8.977 Vali Acc: 0.637 Test Loss: 8.977 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.7975940
	speed: 0.2709s/iter; left time: 8569.3428s
	iters: 200, epoch: 15 | loss: 0.8838683
	speed: 0.0696s/iter; left time: 2194.0095s
	iters: 300, epoch: 15 | loss: 0.6067779
	speed: 0.0647s/iter; left time: 2033.6003s
Epoch: 15 cost time: 24.801552057266235
Epoch: 15, Steps: 369 | Train Loss: 0.657 Vali Loss: 8.470 Vali Acc: 0.635 Test Loss: 8.470 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 527042
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1349847
	speed: 0.0760s/iter; left time: 2798.5581s
	iters: 200, epoch: 1 | loss: 4.5071983
	speed: 0.0587s/iter; left time: 2153.4732s
	iters: 300, epoch: 1 | loss: 1.1304781
	speed: 0.0563s/iter; left time: 2059.5174s
Epoch: 1 cost time: 23.07644748687744
Epoch: 1, Steps: 369 | Train Loss: 1.598 Vali Loss: 1.182 Vali Acc: 0.647 Test Loss: 1.182 Test Acc: 0.647
Validation loss decreased (inf --> -0.646696).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0472255
	speed: 0.2217s/iter; left time: 8075.9689s
	iters: 200, epoch: 2 | loss: 4.0545864
	speed: 0.0565s/iter; left time: 2054.0232s
	iters: 300, epoch: 2 | loss: 3.3914888
	speed: 0.0587s/iter; left time: 2126.7641s
Epoch: 2 cost time: 21.473326921463013
Epoch: 2, Steps: 369 | Train Loss: 1.872 Vali Loss: 2.702 Vali Acc: 0.648 Test Loss: 2.702 Test Acc: 0.648
Validation loss decreased (-0.646696 --> -0.648100).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5455978
	speed: 0.2258s/iter; left time: 8144.6924s
	iters: 200, epoch: 3 | loss: 2.2742095
	speed: 0.0572s/iter; left time: 2057.8486s
	iters: 300, epoch: 3 | loss: 1.7848932
	speed: 0.0564s/iter; left time: 2020.9514s
Epoch: 3 cost time: 21.48469066619873
Epoch: 3, Steps: 369 | Train Loss: 2.620 Vali Loss: 2.909 Vali Acc: 0.656 Test Loss: 2.909 Test Acc: 0.656
Validation loss decreased (-0.648100 --> -0.655476).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5664303
	speed: 0.2429s/iter; left time: 8669.5519s
	iters: 200, epoch: 4 | loss: 3.8558872
	speed: 0.0637s/iter; left time: 2267.5566s
	iters: 300, epoch: 4 | loss: 3.7796891
	speed: 0.0620s/iter; left time: 2199.0623s
Epoch: 4 cost time: 23.356893062591553
Epoch: 4, Steps: 369 | Train Loss: 2.929 Vali Loss: 4.734 Vali Acc: 0.632 Test Loss: 4.734 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.7566681
	speed: 0.2368s/iter; left time: 8363.2071s
	iters: 200, epoch: 5 | loss: 3.6532471
	speed: 0.0606s/iter; left time: 2134.8943s
	iters: 300, epoch: 5 | loss: 2.1550214
	speed: 0.0608s/iter; left time: 2136.0631s
Epoch: 5 cost time: 23.22244620323181
Epoch: 5, Steps: 369 | Train Loss: 2.941 Vali Loss: 5.217 Vali Acc: 0.634 Test Loss: 5.217 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.3870566
	speed: 0.2376s/iter; left time: 8305.2009s
	iters: 200, epoch: 6 | loss: 4.4797974
	speed: 0.0596s/iter; left time: 2075.6817s
	iters: 300, epoch: 6 | loss: 4.7449198
	speed: 0.0595s/iter; left time: 2066.9504s
Epoch: 6 cost time: 22.869688272476196
Epoch: 6, Steps: 369 | Train Loss: 2.915 Vali Loss: 5.688 Vali Acc: 0.638 Test Loss: 5.688 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.8897438
	speed: 0.2431s/iter; left time: 8409.2888s
	iters: 200, epoch: 7 | loss: 1.8734090
	speed: 0.0612s/iter; left time: 2109.6144s
	iters: 300, epoch: 7 | loss: 1.8225232
	speed: 0.0603s/iter; left time: 2073.5708s
Epoch: 7 cost time: 23.17422604560852
Epoch: 7, Steps: 369 | Train Loss: 2.663 Vali Loss: 7.022 Vali Acc: 0.638 Test Loss: 7.022 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.4326372
	speed: 0.2344s/iter; left time: 8020.8096s
	iters: 200, epoch: 8 | loss: 1.6050650
	speed: 0.0602s/iter; left time: 2055.0312s
	iters: 300, epoch: 8 | loss: 2.7289598
	speed: 0.0605s/iter; left time: 2056.6107s
Epoch: 8 cost time: 23.007771253585815
Epoch: 8, Steps: 369 | Train Loss: 2.312 Vali Loss: 7.565 Vali Acc: 0.636 Test Loss: 7.565 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.9986196
	speed: 0.2448s/iter; left time: 8285.8448s
	iters: 200, epoch: 9 | loss: 1.9296881
	speed: 0.0612s/iter; left time: 2063.7926s
	iters: 300, epoch: 9 | loss: 5.6546593
	speed: 0.0598s/iter; left time: 2013.3690s
Epoch: 9 cost time: 23.04832649230957
Epoch: 9, Steps: 369 | Train Loss: 1.886 Vali Loss: 8.353 Vali Acc: 0.632 Test Loss: 8.353 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.4528106
	speed: 0.2407s/iter; left time: 8058.4838s
	iters: 200, epoch: 10 | loss: 0.7908922
	speed: 0.0615s/iter; left time: 2052.4620s
	iters: 300, epoch: 10 | loss: 4.9579391
	speed: 0.0619s/iter; left time: 2059.7807s
Epoch: 10 cost time: 23.740864992141724
Epoch: 10, Steps: 369 | Train Loss: 1.539 Vali Loss: 8.178 Vali Acc: 0.623 Test Loss: 8.178 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3394605
	speed: 0.2450s/iter; left time: 8110.5671s
	iters: 200, epoch: 11 | loss: 2.1760993
	speed: 0.0630s/iter; left time: 2080.7967s
	iters: 300, epoch: 11 | loss: 0.9422289
	speed: 0.0619s/iter; left time: 2037.6265s
Epoch: 11 cost time: 23.72825574874878
Epoch: 11, Steps: 369 | Train Loss: 1.274 Vali Loss: 8.105 Vali Acc: 0.631 Test Loss: 8.105 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.2714365
	speed: 0.2395s/iter; left time: 7840.1382s
	iters: 200, epoch: 12 | loss: 0.0993286
	speed: 0.0639s/iter; left time: 2086.1610s
	iters: 300, epoch: 12 | loss: 1.8162214
	speed: 0.0624s/iter; left time: 2030.1231s
Epoch: 12 cost time: 23.750434637069702
Epoch: 12, Steps: 369 | Train Loss: 1.101 Vali Loss: 7.753 Vali Acc: 0.629 Test Loss: 7.753 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2287178
	speed: 0.2474s/iter; left time: 8009.2719s
	iters: 200, epoch: 13 | loss: 0.0034201
	speed: 0.0642s/iter; left time: 2071.0996s
	iters: 300, epoch: 13 | loss: 0.9570284
	speed: 0.0548s/iter; left time: 1763.3220s
Epoch: 13 cost time: 23.19711709022522
Epoch: 13, Steps: 369 | Train Loss: 0.851 Vali Loss: 7.582 Vali Acc: 0.631 Test Loss: 7.582 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6555051078320091
model parameter : 416834
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4301209
	speed: 0.0639s/iter; left time: 2350.9422s
	iters: 200, epoch: 1 | loss: 2.0578470
	speed: 0.0458s/iter; left time: 1681.9488s
	iters: 300, epoch: 1 | loss: 1.7800601
	speed: 0.0453s/iter; left time: 1659.5640s
Epoch: 1 cost time: 18.70379090309143
Epoch: 1, Steps: 369 | Train Loss: 1.428 Vali Loss: 1.280 Vali Acc: 0.624 Test Loss: 1.280 Test Acc: 0.624
Validation loss decreased (inf --> -0.624278).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4502360
	speed: 0.1941s/iter; left time: 7071.1358s
	iters: 200, epoch: 2 | loss: 2.3247626
	speed: 0.0458s/iter; left time: 1664.5263s
	iters: 300, epoch: 2 | loss: 0.6284015
	speed: 0.0462s/iter; left time: 1673.2369s
Epoch: 2 cost time: 17.66290283203125
Epoch: 2, Steps: 369 | Train Loss: 1.589 Vali Loss: 1.891 Vali Acc: 0.646 Test Loss: 1.891 Test Acc: 0.646
Validation loss decreased (-0.624278 --> -0.645554).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1445319
	speed: 0.1787s/iter; left time: 6443.1569s
	iters: 200, epoch: 3 | loss: 0.8157371
	speed: 0.0455s/iter; left time: 1636.8959s
	iters: 300, epoch: 3 | loss: 2.3677864
	speed: 0.0447s/iter; left time: 1602.2686s
Epoch: 3 cost time: 16.34937024116516
Epoch: 3, Steps: 369 | Train Loss: 2.204 Vali Loss: 3.347 Vali Acc: 0.638 Test Loss: 3.347 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6082451
	speed: 0.1922s/iter; left time: 6861.3817s
	iters: 200, epoch: 4 | loss: 2.9428685
	speed: 0.0464s/iter; left time: 1652.0490s
	iters: 300, epoch: 4 | loss: 2.0140207
	speed: 0.0467s/iter; left time: 1658.6805s
Epoch: 4 cost time: 17.765882968902588
Epoch: 4, Steps: 369 | Train Loss: 2.414 Vali Loss: 4.556 Vali Acc: 0.621 Test Loss: 4.556 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.4606361
	speed: 0.1884s/iter; left time: 6653.5044s
	iters: 200, epoch: 5 | loss: 2.6770828
	speed: 0.0484s/iter; left time: 1704.3118s
	iters: 300, epoch: 5 | loss: 2.1603205
	speed: 0.0474s/iter; left time: 1665.6478s
Epoch: 5 cost time: 18.030628442764282
Epoch: 5, Steps: 369 | Train Loss: 2.602 Vali Loss: 4.942 Vali Acc: 0.634 Test Loss: 4.942 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9531195
	speed: 0.1918s/iter; left time: 6704.3065s
	iters: 200, epoch: 6 | loss: 3.3427613
	speed: 0.0468s/iter; left time: 1630.2230s
	iters: 300, epoch: 6 | loss: 1.2976644
	speed: 0.0466s/iter; left time: 1620.6627s
Epoch: 6 cost time: 17.84722113609314
Epoch: 6, Steps: 369 | Train Loss: 2.363 Vali Loss: 5.860 Vali Acc: 0.644 Test Loss: 5.860 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.4442126
	speed: 0.1902s/iter; left time: 6577.2419s
	iters: 200, epoch: 7 | loss: 0.1485243
	speed: 0.0479s/iter; left time: 1653.4415s
	iters: 300, epoch: 7 | loss: 0.5993262
	speed: 0.0424s/iter; left time: 1458.8969s
Epoch: 7 cost time: 17.886056184768677
Epoch: 7, Steps: 369 | Train Loss: 2.055 Vali Loss: 6.214 Vali Acc: 0.640 Test Loss: 6.214 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0639960
	speed: 0.2044s/iter; left time: 6992.5687s
	iters: 200, epoch: 8 | loss: 0.7787770
	speed: 0.0506s/iter; left time: 1727.2789s
	iters: 300, epoch: 8 | loss: 1.8783064
	speed: 0.0512s/iter; left time: 1742.0860s
Epoch: 8 cost time: 19.35057020187378
Epoch: 8, Steps: 369 | Train Loss: 1.874 Vali Loss: 6.748 Vali Acc: 0.625 Test Loss: 6.748 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7423364
	speed: 0.1990s/iter; left time: 6735.5166s
	iters: 200, epoch: 9 | loss: 0.9500927
	speed: 0.0524s/iter; left time: 1767.3358s
	iters: 300, epoch: 9 | loss: 1.1090894
	speed: 0.0523s/iter; left time: 1760.4028s
Epoch: 9 cost time: 19.661033630371094
Epoch: 9, Steps: 369 | Train Loss: 1.471 Vali Loss: 7.698 Vali Acc: 0.627 Test Loss: 7.698 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1927799
	speed: 0.2049s/iter; left time: 6861.2082s
	iters: 200, epoch: 10 | loss: 0.6804256
	speed: 0.0505s/iter; left time: 1685.0235s
	iters: 300, epoch: 10 | loss: 2.0196159
	speed: 0.0522s/iter; left time: 1736.7007s
Epoch: 10 cost time: 19.603899717330933
Epoch: 10, Steps: 369 | Train Loss: 1.267 Vali Loss: 7.512 Vali Acc: 0.637 Test Loss: 7.512 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0001958
	speed: 0.2029s/iter; left time: 6718.2024s
	iters: 200, epoch: 11 | loss: 3.1190648
	speed: 0.0524s/iter; left time: 1729.2995s
	iters: 300, epoch: 11 | loss: 0.2905299
	speed: 0.0515s/iter; left time: 1695.9875s
Epoch: 11 cost time: 19.6993248462677
Epoch: 11, Steps: 369 | Train Loss: 1.230 Vali Loss: 7.498 Vali Acc: 0.629 Test Loss: 7.498 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0036947
	speed: 0.2068s/iter; left time: 6769.5623s
	iters: 200, epoch: 12 | loss: 0.6491735
	speed: 0.0512s/iter; left time: 1672.4047s
	iters: 300, epoch: 12 | loss: 1.9344525
	speed: 0.0503s/iter; left time: 1636.3871s
Epoch: 12 cost time: 19.686116218566895
Epoch: 12, Steps: 369 | Train Loss: 1.020 Vali Loss: 7.100 Vali Acc: 0.624 Test Loss: 7.100 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6455732122587968
model parameter : 343490
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 8.1180840
	speed: 0.2923s/iter; left time: 10758.6309s
	iters: 200, epoch: 1 | loss: 3.3815281
	speed: 0.2742s/iter; left time: 10063.9527s
	iters: 300, epoch: 1 | loss: 3.2898648
	speed: 0.2778s/iter; left time: 10166.0205s
Epoch: 1 cost time: 103.68450856208801
Epoch: 1, Steps: 369 | Train Loss: 3.703 Vali Loss: 1.594 Vali Acc: 0.639 Test Loss: 1.594 Test Acc: 0.639
Validation loss decreased (inf --> -0.639031).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8161547
	speed: 0.9150s/iter; left time: 33334.9407s
	iters: 200, epoch: 2 | loss: 3.2384748
	speed: 0.2647s/iter; left time: 9617.1284s
	iters: 300, epoch: 2 | loss: 2.5784850
	speed: 0.2678s/iter; left time: 9703.0879s
Epoch: 2 cost time: 99.79008889198303
Epoch: 2, Steps: 369 | Train Loss: 3.204 Vali Loss: 4.353 Vali Acc: 0.648 Test Loss: 4.353 Test Acc: 0.648
Validation loss decreased (-0.639031 --> -0.648084).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7635729
	speed: 0.8472s/iter; left time: 30552.5746s
	iters: 200, epoch: 3 | loss: 3.1263981
	speed: 0.2574s/iter; left time: 9256.8136s
	iters: 300, epoch: 3 | loss: 1.4989594
	speed: 0.2592s/iter; left time: 9296.4807s
Epoch: 3 cost time: 96.16593527793884
Epoch: 3, Steps: 369 | Train Loss: 4.511 Vali Loss: 4.078 Vali Acc: 0.657 Test Loss: 4.078 Test Acc: 0.657
Validation loss decreased (-0.648084 --> -0.657451).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8679969
	speed: 0.8675s/iter; left time: 30964.8891s
	iters: 200, epoch: 4 | loss: 6.2968750
	speed: 0.2627s/iter; left time: 9351.3511s
	iters: 300, epoch: 4 | loss: 6.5081925
	speed: 0.2646s/iter; left time: 9390.5658s
Epoch: 4 cost time: 98.93849182128906
Epoch: 4, Steps: 369 | Train Loss: 5.387 Vali Loss: 5.903 Vali Acc: 0.638 Test Loss: 5.903 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 8.5466614
	speed: 0.8986s/iter; left time: 31741.6276s
	iters: 200, epoch: 5 | loss: 1.2220039
	speed: 0.2771s/iter; left time: 9760.3301s
	iters: 300, epoch: 5 | loss: 4.8836184
	speed: 0.2777s/iter; left time: 9753.8966s
Epoch: 5 cost time: 102.10167646408081
Epoch: 5, Steps: 369 | Train Loss: 5.121 Vali Loss: 8.187 Vali Acc: 0.649 Test Loss: 8.187 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 10.7412310
	speed: 0.8905s/iter; left time: 31127.6732s
	iters: 200, epoch: 6 | loss: 0.6306874
	speed: 0.2778s/iter; left time: 9681.2806s
	iters: 300, epoch: 6 | loss: 6.7554102
	speed: 0.2765s/iter; left time: 9608.8081s
Epoch: 6 cost time: 102.58704662322998
Epoch: 6, Steps: 369 | Train Loss: 4.673 Vali Loss: 9.165 Vali Acc: 0.645 Test Loss: 9.165 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5619783
	speed: 0.9024s/iter; left time: 31212.1269s
	iters: 200, epoch: 7 | loss: 2.2499566
	speed: 0.2759s/iter; left time: 9515.1190s
	iters: 300, epoch: 7 | loss: 9.5557041
	speed: 0.2681s/iter; left time: 9219.3906s
Epoch: 7 cost time: 99.62999391555786
Epoch: 7, Steps: 369 | Train Loss: 3.442 Vali Loss: 9.190 Vali Acc: 0.663 Test Loss: 9.190 Test Acc: 0.663
Validation loss decreased (-0.657451 --> -0.662791).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.2867770
	speed: 0.8364s/iter; left time: 28620.0625s
	iters: 200, epoch: 8 | loss: 3.9876819
	speed: 0.2573s/iter; left time: 8779.1556s
	iters: 300, epoch: 8 | loss: 5.1251845
	speed: 0.2650s/iter; left time: 9015.3412s
Epoch: 8 cost time: 96.77543902397156
Epoch: 8, Steps: 369 | Train Loss: 2.493 Vali Loss: 10.618 Vali Acc: 0.626 Test Loss: 10.618 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 6.1632242
	speed: 0.8574s/iter; left time: 29022.4645s
	iters: 200, epoch: 9 | loss: 2.1001225
	speed: 0.2649s/iter; left time: 8939.0561s
	iters: 300, epoch: 9 | loss: 2.5744634
	speed: 0.2606s/iter; left time: 8769.9964s
Epoch: 9 cost time: 96.93490028381348
Epoch: 9, Steps: 369 | Train Loss: 1.703 Vali Loss: 7.792 Vali Acc: 0.642 Test Loss: 7.792 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.8733953
	speed: 0.8608s/iter; left time: 28819.4674s
	iters: 200, epoch: 10 | loss: 0.7196769
	speed: 0.2761s/iter; left time: 9215.6317s
	iters: 300, epoch: 10 | loss: 1.1780322
	speed: 0.2720s/iter; left time: 9053.4763s
Epoch: 10 cost time: 101.29288673400879
Epoch: 10, Steps: 369 | Train Loss: 1.053 Vali Loss: 7.263 Vali Acc: 0.632 Test Loss: 7.263 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1018505
	speed: 0.9038s/iter; left time: 29925.2879s
	iters: 200, epoch: 11 | loss: 2.2865713
	speed: 0.2765s/iter; left time: 9128.1374s
	iters: 300, epoch: 11 | loss: 0.3637599
	speed: 0.2757s/iter; left time: 9074.3542s
Epoch: 11 cost time: 102.61613392829895
Epoch: 11, Steps: 369 | Train Loss: 0.643 Vali Loss: 7.133 Vali Acc: 0.644 Test Loss: 7.133 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0273864
	speed: 0.8958s/iter; left time: 29330.7858s
	iters: 200, epoch: 12 | loss: 0.3811033
	speed: 0.2767s/iter; left time: 9030.6328s
	iters: 300, epoch: 12 | loss: 0.0000104
	speed: 0.2674s/iter; left time: 8700.3878s
Epoch: 12 cost time: 101.09018182754517
Epoch: 12, Steps: 369 | Train Loss: 0.435 Vali Loss: 5.949 Vali Acc: 0.635 Test Loss: 5.949 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6037427
	speed: 0.8740s/iter; left time: 28295.1794s
	iters: 200, epoch: 13 | loss: 0.3468861
	speed: 0.2647s/iter; left time: 8543.2310s
	iters: 300, epoch: 13 | loss: 0.0514003
	speed: 0.2632s/iter; left time: 8466.7183s
Epoch: 13 cost time: 98.12801003456116
Epoch: 13, Steps: 369 | Train Loss: 0.285 Vali Loss: 5.793 Vali Acc: 0.644 Test Loss: 5.793 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000075
	speed: 0.8621s/iter; left time: 27589.2259s
	iters: 200, epoch: 14 | loss: 0.7245606
	speed: 0.2598s/iter; left time: 8288.4846s
	iters: 300, epoch: 14 | loss: 0.0000136
	speed: 0.2616s/iter; left time: 8320.8672s
Epoch: 14 cost time: 96.15380430221558
Epoch: 14, Steps: 369 | Train Loss: 0.203 Vali Loss: 4.214 Vali Acc: 0.638 Test Loss: 4.214 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0001905
	speed: 0.8516s/iter; left time: 26939.7000s
	iters: 200, epoch: 15 | loss: 0.0000020
	speed: 0.2766s/iter; left time: 8722.4958s
	iters: 300, epoch: 15 | loss: 0.0002192
	speed: 0.2843s/iter; left time: 8938.1138s
Epoch: 15 cost time: 101.50946402549744
Epoch: 15, Steps: 369 | Train Loss: 0.143 Vali Loss: 3.750 Vali Acc: 0.639 Test Loss: 3.750 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.6536487
	speed: 0.8962s/iter; left time: 28021.1377s
	iters: 200, epoch: 16 | loss: 0.0003939
	speed: 0.2739s/iter; left time: 8537.2511s
	iters: 300, epoch: 16 | loss: 0.1578959
	speed: 0.2730s/iter; left time: 8481.1272s
Epoch: 16 cost time: 101.26057124137878
Epoch: 16, Steps: 369 | Train Loss: 0.077 Vali Loss: 3.235 Vali Acc: 0.639 Test Loss: 3.235 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0314077
	speed: 0.8920s/iter; left time: 27560.3911s
	iters: 200, epoch: 17 | loss: 0.0350275
	speed: 0.2759s/iter; left time: 8496.7827s
	iters: 300, epoch: 17 | loss: 0.1937613
	speed: 0.2746s/iter; left time: 8429.1243s
Epoch: 17 cost time: 102.2889416217804
Epoch: 17, Steps: 369 | Train Loss: 0.056 Vali Loss: 3.655 Vali Acc: 0.626 Test Loss: 3.655 Test Acc: 0.626
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.662883087400681
model parameter : 1193026
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.5828340
	speed: 0.1378s/iter; left time: 5072.0021s
	iters: 200, epoch: 1 | loss: 0.9927748
	speed: 0.1167s/iter; left time: 4284.1776s
	iters: 300, epoch: 1 | loss: 1.7458110
	speed: 0.1244s/iter; left time: 4554.8660s
Epoch: 1 cost time: 46.169777631759644
Epoch: 1, Steps: 369 | Train Loss: 2.416 Vali Loss: 1.280 Vali Acc: 0.643 Test Loss: 1.280 Test Acc: 0.643
Validation loss decreased (inf --> -0.643290).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7868025
	speed: 0.4107s/iter; left time: 14961.6808s
	iters: 200, epoch: 2 | loss: 3.2828243
	speed: 0.1200s/iter; left time: 4361.1858s
	iters: 300, epoch: 2 | loss: 3.1975830
	speed: 0.1191s/iter; left time: 4314.9633s
Epoch: 2 cost time: 43.78230857849121
Epoch: 2, Steps: 369 | Train Loss: 2.188 Vali Loss: 2.393 Vali Acc: 0.658 Test Loss: 2.393 Test Acc: 0.658
Validation loss decreased (-0.643290 --> -0.658319).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3198836
	speed: 0.4030s/iter; left time: 14532.7555s
	iters: 200, epoch: 3 | loss: 4.0004539
	speed: 0.1145s/iter; left time: 4118.0272s
	iters: 300, epoch: 3 | loss: 3.1111734
	speed: 0.1140s/iter; left time: 4087.6785s
Epoch: 3 cost time: 42.99266767501831
Epoch: 3, Steps: 369 | Train Loss: 3.188 Vali Loss: 4.253 Vali Acc: 0.644 Test Loss: 4.253 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3813460
	speed: 0.4029s/iter; left time: 14382.4631s
	iters: 200, epoch: 4 | loss: 1.3101645
	speed: 0.1195s/iter; left time: 4254.0211s
	iters: 300, epoch: 4 | loss: 2.5734851
	speed: 0.1174s/iter; left time: 4168.6639s
Epoch: 4 cost time: 43.70965647697449
Epoch: 4, Steps: 369 | Train Loss: 3.446 Vali Loss: 5.062 Vali Acc: 0.642 Test Loss: 5.062 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8164861
	speed: 0.4068s/iter; left time: 14368.9962s
	iters: 200, epoch: 5 | loss: 5.3560071
	speed: 0.1290s/iter; left time: 4542.3696s
	iters: 300, epoch: 5 | loss: 1.3145505
	speed: 0.1236s/iter; left time: 4342.8467s
Epoch: 5 cost time: 46.08134412765503
Epoch: 5, Steps: 369 | Train Loss: 3.285 Vali Loss: 5.661 Vali Acc: 0.647 Test Loss: 5.661 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 6.5601139
	speed: 0.4332s/iter; left time: 15144.0155s
	iters: 200, epoch: 6 | loss: 5.3975639
	speed: 0.1251s/iter; left time: 4359.5954s
	iters: 300, epoch: 6 | loss: 2.6758208
	speed: 0.1258s/iter; left time: 4371.2089s
Epoch: 6 cost time: 46.753586292266846
Epoch: 6, Steps: 369 | Train Loss: 3.131 Vali Loss: 7.140 Vali Acc: 0.641 Test Loss: 7.140 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.1964364
	speed: 0.4342s/iter; left time: 15018.2990s
	iters: 200, epoch: 7 | loss: 4.9661808
	speed: 0.1226s/iter; left time: 4229.6411s
	iters: 300, epoch: 7 | loss: 1.1272333
	speed: 0.1269s/iter; left time: 4363.3690s
Epoch: 7 cost time: 46.12563228607178
Epoch: 7, Steps: 369 | Train Loss: 2.530 Vali Loss: 6.273 Vali Acc: 0.632 Test Loss: 6.273 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.1210802
	speed: 0.4406s/iter; left time: 15078.0712s
	iters: 200, epoch: 8 | loss: 1.2111197
	speed: 0.1276s/iter; left time: 4353.7342s
	iters: 300, epoch: 8 | loss: 1.0709716
	speed: 0.1256s/iter; left time: 4273.3353s
Epoch: 8 cost time: 47.03697729110718
Epoch: 8, Steps: 369 | Train Loss: 2.003 Vali Loss: 6.284 Vali Acc: 0.635 Test Loss: 6.284 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.0785842
	speed: 0.4365s/iter; left time: 14773.9958s
	iters: 200, epoch: 9 | loss: 4.3945193
	speed: 0.1278s/iter; left time: 4311.8118s
	iters: 300, epoch: 9 | loss: 3.1511092
	speed: 0.1291s/iter; left time: 4344.0527s
Epoch: 9 cost time: 47.4317684173584
Epoch: 9, Steps: 369 | Train Loss: 1.610 Vali Loss: 6.045 Vali Acc: 0.632 Test Loss: 6.045 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.6310134
	speed: 0.4384s/iter; left time: 14676.1224s
	iters: 200, epoch: 10 | loss: 1.4949554
	speed: 0.1234s/iter; left time: 4118.4284s
	iters: 300, epoch: 10 | loss: 1.5805509
	speed: 0.1294s/iter; left time: 4304.8983s
Epoch: 10 cost time: 47.60674428939819
Epoch: 10, Steps: 369 | Train Loss: 0.891 Vali Loss: 4.168 Vali Acc: 0.646 Test Loss: 4.168 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.2941697
	speed: 0.4383s/iter; left time: 14513.4241s
	iters: 200, epoch: 11 | loss: 2.7757800
	speed: 0.1217s/iter; left time: 4018.6519s
	iters: 300, epoch: 11 | loss: 0.1481879
	speed: 0.1168s/iter; left time: 3844.2037s
Epoch: 11 cost time: 44.857890605926514
Epoch: 11, Steps: 369 | Train Loss: 0.563 Vali Loss: 3.736 Vali Acc: 0.633 Test Loss: 3.736 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0068808
	speed: 0.4231s/iter; left time: 13853.2665s
	iters: 200, epoch: 12 | loss: 0.2050161
	speed: 0.1152s/iter; left time: 3760.5422s
	iters: 300, epoch: 12 | loss: 1.4884745
	speed: 0.1187s/iter; left time: 3863.6362s
Epoch: 12 cost time: 43.9842267036438
Epoch: 12, Steps: 369 | Train Loss: 0.292 Vali Loss: 3.535 Vali Acc: 0.626 Test Loss: 3.535 Test Acc: 0.626
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6583427922814983
model parameter : 621762
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6845348
	speed: 0.1173s/iter; left time: 4318.4144s
	iters: 200, epoch: 1 | loss: 2.3539302
	speed: 0.0944s/iter; left time: 3465.3136s
	iters: 300, epoch: 1 | loss: 1.9842976
	speed: 0.0957s/iter; left time: 3502.8196s
Epoch: 1 cost time: 37.13463020324707
Epoch: 1, Steps: 369 | Train Loss: 1.868 Vali Loss: 1.171 Vali Acc: 0.649 Test Loss: 1.171 Test Acc: 0.649
Validation loss decreased (inf --> -0.648683).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1599886
	speed: 0.3518s/iter; left time: 12817.0854s
	iters: 200, epoch: 2 | loss: 1.1857356
	speed: 0.0974s/iter; left time: 3539.9380s
	iters: 300, epoch: 2 | loss: 1.0249857
	speed: 0.0972s/iter; left time: 3523.0593s
Epoch: 2 cost time: 36.05312967300415
Epoch: 2, Steps: 369 | Train Loss: 1.901 Vali Loss: 2.354 Vali Acc: 0.627 Test Loss: 2.354 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.7086300
	speed: 0.3568s/iter; left time: 12867.9204s
	iters: 200, epoch: 3 | loss: 3.5677376
	speed: 0.1021s/iter; left time: 3672.2743s
	iters: 300, epoch: 3 | loss: 3.0040898
	speed: 0.1020s/iter; left time: 3658.9727s
Epoch: 3 cost time: 37.49341130256653
Epoch: 3, Steps: 369 | Train Loss: 2.426 Vali Loss: 3.453 Vali Acc: 0.627 Test Loss: 3.453 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.2080092
	speed: 0.3808s/iter; left time: 13592.3724s
	iters: 200, epoch: 4 | loss: 2.8933740
	speed: 0.1002s/iter; left time: 3566.9586s
	iters: 300, epoch: 4 | loss: 2.5159154
	speed: 0.1024s/iter; left time: 3634.1428s
Epoch: 4 cost time: 37.840970516204834
Epoch: 4, Steps: 369 | Train Loss: 2.813 Vali Loss: 4.144 Vali Acc: 0.643 Test Loss: 4.144 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2564440
	speed: 0.3788s/iter; left time: 13381.9480s
	iters: 200, epoch: 5 | loss: 0.5132636
	speed: 0.1001s/iter; left time: 3524.6223s
	iters: 300, epoch: 5 | loss: 1.2433531
	speed: 0.0974s/iter; left time: 3419.4396s
Epoch: 5 cost time: 37.22407579421997
Epoch: 5, Steps: 369 | Train Loss: 2.984 Vali Loss: 4.155 Vali Acc: 0.640 Test Loss: 4.155 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.8921890
	speed: 0.3782s/iter; left time: 13221.6398s
	iters: 200, epoch: 6 | loss: 0.0420548
	speed: 0.0995s/iter; left time: 3466.7408s
	iters: 300, epoch: 6 | loss: 3.3196919
	speed: 0.1046s/iter; left time: 3634.3802s
Epoch: 6 cost time: 37.91019296646118
Epoch: 6, Steps: 369 | Train Loss: 2.420 Vali Loss: 4.708 Vali Acc: 0.632 Test Loss: 4.708 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3939917
	speed: 0.3813s/iter; left time: 13188.3850s
	iters: 200, epoch: 7 | loss: 2.7264495
	speed: 0.1017s/iter; left time: 3507.5508s
	iters: 300, epoch: 7 | loss: 3.6795449
	speed: 0.1061s/iter; left time: 3646.9981s
Epoch: 7 cost time: 38.50865435600281
Epoch: 7, Steps: 369 | Train Loss: 2.115 Vali Loss: 5.889 Vali Acc: 0.625 Test Loss: 5.889 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1969848
	speed: 0.3817s/iter; left time: 13060.9925s
	iters: 200, epoch: 8 | loss: 0.9592731
	speed: 0.1043s/iter; left time: 3558.6494s
	iters: 300, epoch: 8 | loss: 1.1019324
	speed: 0.1049s/iter; left time: 3568.2923s
Epoch: 8 cost time: 39.00977182388306
Epoch: 8, Steps: 369 | Train Loss: 1.803 Vali Loss: 4.197 Vali Acc: 0.628 Test Loss: 4.197 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000702
	speed: 0.3868s/iter; left time: 13093.0263s
	iters: 200, epoch: 9 | loss: 0.2886813
	speed: 0.1017s/iter; left time: 3432.3874s
	iters: 300, epoch: 9 | loss: 0.5528716
	speed: 0.1004s/iter; left time: 3378.6010s
Epoch: 9 cost time: 38.86647939682007
Epoch: 9, Steps: 369 | Train Loss: 1.169 Vali Loss: 4.314 Vali Acc: 0.631 Test Loss: 4.314 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.3589454
	speed: 0.3691s/iter; left time: 12357.1685s
	iters: 200, epoch: 10 | loss: 0.1305602
	speed: 0.0898s/iter; left time: 2998.2521s
	iters: 300, epoch: 10 | loss: 0.6380216
	speed: 0.0985s/iter; left time: 3276.9358s
Epoch: 10 cost time: 35.256173849105835
Epoch: 10, Steps: 369 | Train Loss: 0.767 Vali Loss: 3.315 Vali Acc: 0.638 Test Loss: 3.315 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6102685
	speed: 0.3512s/iter; left time: 11628.8555s
	iters: 200, epoch: 11 | loss: 0.9265562
	speed: 0.0988s/iter; left time: 3261.2936s
	iters: 300, epoch: 11 | loss: 0.3975084
	speed: 0.0955s/iter; left time: 3144.2606s
Epoch: 11 cost time: 35.96749830245972
Epoch: 11, Steps: 369 | Train Loss: 0.427 Vali Loss: 2.513 Vali Acc: 0.640 Test Loss: 2.513 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6486946651532349
model parameter : 437506
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7421430
	speed: 0.0836s/iter; left time: 3078.2931s
	iters: 200, epoch: 1 | loss: 1.0948148
	speed: 0.0657s/iter; left time: 2411.8322s
	iters: 300, epoch: 1 | loss: 1.5005701
	speed: 0.0692s/iter; left time: 2534.4914s
Epoch: 1 cost time: 26.873424291610718
Epoch: 1, Steps: 369 | Train Loss: 1.544 Vali Loss: 1.624 Vali Acc: 0.579 Test Loss: 1.624 Test Acc: 0.579
Validation loss decreased (inf --> -0.579155).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1623802
	speed: 0.2489s/iter; left time: 9068.6381s
	iters: 200, epoch: 2 | loss: 1.5182146
	speed: 0.0681s/iter; left time: 2474.6682s
	iters: 300, epoch: 2 | loss: 2.7350359
	speed: 0.0681s/iter; left time: 2467.4771s
Epoch: 2 cost time: 25.386919736862183
Epoch: 2, Steps: 369 | Train Loss: 1.578 Vali Loss: 1.855 Vali Acc: 0.671 Test Loss: 1.855 Test Acc: 0.671
Validation loss decreased (-0.579155 --> -0.671094).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1126071
	speed: 0.2529s/iter; left time: 9121.5804s
	iters: 200, epoch: 3 | loss: 1.5208945
	speed: 0.0675s/iter; left time: 2428.6647s
	iters: 300, epoch: 3 | loss: 1.9136771
	speed: 0.0699s/iter; left time: 2506.1475s
Epoch: 3 cost time: 26.197710275650024
Epoch: 3, Steps: 369 | Train Loss: 2.088 Vali Loss: 2.575 Vali Acc: 0.642 Test Loss: 2.575 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5657463
	speed: 0.2510s/iter; left time: 8957.4722s
	iters: 200, epoch: 4 | loss: 5.0074387
	speed: 0.0723s/iter; left time: 2572.7480s
	iters: 300, epoch: 4 | loss: 0.9709067
	speed: 0.0752s/iter; left time: 2669.2724s
Epoch: 4 cost time: 27.850744247436523
Epoch: 4, Steps: 369 | Train Loss: 2.276 Vali Loss: 3.095 Vali Acc: 0.647 Test Loss: 3.095 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.6630896
	speed: 0.2735s/iter; left time: 9661.3289s
	iters: 200, epoch: 5 | loss: 2.1831255
	speed: 0.0744s/iter; left time: 2622.1749s
	iters: 300, epoch: 5 | loss: 2.0575922
	speed: 0.0732s/iter; left time: 2572.1943s
Epoch: 5 cost time: 27.82948112487793
Epoch: 5, Steps: 369 | Train Loss: 2.279 Vali Loss: 3.847 Vali Acc: 0.666 Test Loss: 3.847 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.3828049
	speed: 0.2737s/iter; left time: 9567.7369s
	iters: 200, epoch: 6 | loss: 0.7815858
	speed: 0.0742s/iter; left time: 2586.4264s
	iters: 300, epoch: 6 | loss: 2.3792489
	speed: 0.0736s/iter; left time: 2559.5218s
Epoch: 6 cost time: 27.784924268722534
Epoch: 6, Steps: 369 | Train Loss: 2.051 Vali Loss: 4.352 Vali Acc: 0.642 Test Loss: 4.352 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.0814569
	speed: 0.2701s/iter; left time: 9342.3105s
	iters: 200, epoch: 7 | loss: 3.8093643
	speed: 0.0735s/iter; left time: 2533.7649s
	iters: 300, epoch: 7 | loss: 2.4783416
	speed: 0.0730s/iter; left time: 2509.4301s
Epoch: 7 cost time: 27.569282054901123
Epoch: 7, Steps: 369 | Train Loss: 1.758 Vali Loss: 5.454 Vali Acc: 0.630 Test Loss: 5.454 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6777067
	speed: 0.2763s/iter; left time: 9453.8142s
	iters: 200, epoch: 8 | loss: 0.1602310
	speed: 0.0738s/iter; left time: 2516.3572s
	iters: 300, epoch: 8 | loss: 0.6014928
	speed: 0.0712s/iter; left time: 2421.8923s
Epoch: 8 cost time: 27.54076337814331
Epoch: 8, Steps: 369 | Train Loss: 1.354 Vali Loss: 5.229 Vali Acc: 0.630 Test Loss: 5.229 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3676038
	speed: 0.2813s/iter; left time: 9521.4881s
	iters: 200, epoch: 9 | loss: 1.3793831
	speed: 0.0768s/iter; left time: 2592.5514s
	iters: 300, epoch: 9 | loss: 0.8648138
	speed: 0.0762s/iter; left time: 2562.5011s
Epoch: 9 cost time: 28.76633381843567
Epoch: 9, Steps: 369 | Train Loss: 0.984 Vali Loss: 4.569 Vali Acc: 0.640 Test Loss: 4.569 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5447582
	speed: 0.2796s/iter; left time: 9362.1219s
	iters: 200, epoch: 10 | loss: 1.1713005
	speed: 0.0768s/iter; left time: 2563.0660s
	iters: 300, epoch: 10 | loss: 0.0342108
	speed: 0.0746s/iter; left time: 2481.6000s
Epoch: 10 cost time: 28.431118488311768
Epoch: 10, Steps: 369 | Train Loss: 0.717 Vali Loss: 3.789 Vali Acc: 0.638 Test Loss: 3.789 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.9134644
	speed: 0.2794s/iter; left time: 9252.5879s
	iters: 200, epoch: 11 | loss: 0.5427932
	speed: 0.0752s/iter; left time: 2482.7365s
	iters: 300, epoch: 11 | loss: 0.3790044
	speed: 0.0747s/iter; left time: 2459.9871s
Epoch: 11 cost time: 28.30842423439026
Epoch: 11, Steps: 369 | Train Loss: 0.493 Vali Loss: 3.167 Vali Acc: 0.642 Test Loss: 3.167 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0515342
	speed: 0.2764s/iter; left time: 9048.9226s
	iters: 200, epoch: 12 | loss: 0.0026630
	speed: 0.0768s/iter; left time: 2507.6618s
	iters: 300, epoch: 12 | loss: 0.0464359
	speed: 0.0755s/iter; left time: 2457.4131s
Epoch: 12 cost time: 28.39228320121765
Epoch: 12, Steps: 369 | Train Loss: 0.326 Vali Loss: 2.691 Vali Acc: 0.641 Test Loss: 2.691 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 327042
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5221971
	speed: 0.0766s/iter; left time: 2817.3293s
	iters: 200, epoch: 1 | loss: 0.6973562
	speed: 0.0593s/iter; left time: 2177.9003s
	iters: 300, epoch: 1 | loss: 1.7603235
	speed: 0.0585s/iter; left time: 2142.3586s
Epoch: 1 cost time: 23.648605346679688
Epoch: 1, Steps: 369 | Train Loss: 1.471 Vali Loss: 1.785 Vali Acc: 0.616 Test Loss: 1.785 Test Acc: 0.616
Validation loss decreased (inf --> -0.615760).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4718585
	speed: 0.2280s/iter; left time: 8307.9348s
	iters: 200, epoch: 2 | loss: 0.6936451
	speed: 0.0593s/iter; left time: 2156.0644s
	iters: 300, epoch: 2 | loss: 0.3000832
	speed: 0.0584s/iter; left time: 2114.6856s
Epoch: 2 cost time: 22.307260990142822
Epoch: 2, Steps: 369 | Train Loss: 1.373 Vali Loss: 1.787 Vali Acc: 0.643 Test Loss: 1.787 Test Acc: 0.643
Validation loss decreased (-0.615760 --> -0.642718).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0929465
	speed: 0.2306s/iter; left time: 8315.2466s
	iters: 200, epoch: 3 | loss: 3.5760610
	speed: 0.0527s/iter; left time: 1895.6688s
	iters: 300, epoch: 3 | loss: 2.0166585
	speed: 0.0588s/iter; left time: 2109.5732s
Epoch: 3 cost time: 21.629949808120728
Epoch: 3, Steps: 369 | Train Loss: 1.771 Vali Loss: 2.742 Vali Acc: 0.634 Test Loss: 2.742 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.9215312
	speed: 0.2296s/iter; left time: 8195.4198s
	iters: 200, epoch: 4 | loss: 2.1707053
	speed: 0.0591s/iter; left time: 2102.5222s
	iters: 300, epoch: 4 | loss: 1.7352359
	speed: 0.0584s/iter; left time: 2071.2574s
Epoch: 4 cost time: 22.321717739105225
Epoch: 4, Steps: 369 | Train Loss: 1.965 Vali Loss: 3.115 Vali Acc: 0.647 Test Loss: 3.115 Test Acc: 0.647
Validation loss decreased (-0.642718 --> -0.647245).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0168786
	speed: 0.2296s/iter; left time: 8109.7209s
	iters: 200, epoch: 5 | loss: 2.6253395
	speed: 0.0596s/iter; left time: 2100.8717s
	iters: 300, epoch: 5 | loss: 3.5622141
	speed: 0.0600s/iter; left time: 2107.8312s
Epoch: 5 cost time: 22.643021821975708
Epoch: 5, Steps: 369 | Train Loss: 1.963 Vali Loss: 3.460 Vali Acc: 0.649 Test Loss: 3.460 Test Acc: 0.649
Validation loss decreased (-0.647245 --> -0.649228).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9132302
	speed: 0.2309s/iter; left time: 8070.2412s
	iters: 200, epoch: 6 | loss: 2.5960131
	speed: 0.0599s/iter; left time: 2087.4712s
	iters: 300, epoch: 6 | loss: 0.1701368
	speed: 0.0603s/iter; left time: 2095.5947s
Epoch: 6 cost time: 22.692748308181763
Epoch: 6, Steps: 369 | Train Loss: 1.582 Vali Loss: 4.458 Vali Acc: 0.640 Test Loss: 4.458 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0378443
	speed: 0.2366s/iter; left time: 8184.7238s
	iters: 200, epoch: 7 | loss: 1.8826598
	speed: 0.0657s/iter; left time: 2265.3017s
	iters: 300, epoch: 7 | loss: 1.0418342
	speed: 0.0663s/iter; left time: 2279.3629s
Epoch: 7 cost time: 25.202059268951416
Epoch: 7, Steps: 369 | Train Loss: 1.423 Vali Loss: 4.847 Vali Acc: 0.642 Test Loss: 4.847 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9117346
	speed: 0.2453s/iter; left time: 8393.5184s
	iters: 200, epoch: 8 | loss: 0.9730613
	speed: 0.0663s/iter; left time: 2260.7319s
	iters: 300, epoch: 8 | loss: 0.9792061
	speed: 0.0651s/iter; left time: 2215.6810s
Epoch: 8 cost time: 24.601510047912598
Epoch: 8, Steps: 369 | Train Loss: 1.142 Vali Loss: 4.412 Vali Acc: 0.634 Test Loss: 4.412 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0009909
	speed: 0.2504s/iter; left time: 8474.2054s
	iters: 200, epoch: 9 | loss: 0.0975071
	speed: 0.0662s/iter; left time: 2233.6437s
	iters: 300, epoch: 9 | loss: 0.0183574
	speed: 0.0645s/iter; left time: 2170.4770s
Epoch: 9 cost time: 24.47262692451477
Epoch: 9, Steps: 369 | Train Loss: 0.827 Vali Loss: 4.045 Vali Acc: 0.654 Test Loss: 4.045 Test Acc: 0.654
Validation loss decreased (-0.649228 --> -0.654330).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1282860
	speed: 0.2499s/iter; left time: 8366.3309s
	iters: 200, epoch: 10 | loss: 0.0827840
	speed: 0.0651s/iter; left time: 2171.9169s
	iters: 300, epoch: 10 | loss: 0.7859917
	speed: 0.0638s/iter; left time: 2124.3498s
Epoch: 10 cost time: 24.56319260597229
Epoch: 10, Steps: 369 | Train Loss: 0.625 Vali Loss: 3.921 Vali Acc: 0.644 Test Loss: 3.921 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3832434
	speed: 0.2525s/iter; left time: 8361.1264s
	iters: 200, epoch: 11 | loss: 0.9730787
	speed: 0.0650s/iter; left time: 2144.3539s
	iters: 300, epoch: 11 | loss: 0.5859721
	speed: 0.0648s/iter; left time: 2131.5304s
Epoch: 11 cost time: 24.728384971618652
Epoch: 11, Steps: 369 | Train Loss: 0.467 Vali Loss: 3.263 Vali Acc: 0.645 Test Loss: 3.263 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0506670
	speed: 0.2497s/iter; left time: 8176.9504s
	iters: 200, epoch: 12 | loss: 0.4607891
	speed: 0.0658s/iter; left time: 2147.2528s
	iters: 300, epoch: 12 | loss: 1.1705060
	speed: 0.0655s/iter; left time: 2131.3419s
Epoch: 12 cost time: 24.871331930160522
Epoch: 12, Steps: 369 | Train Loss: 0.353 Vali Loss: 2.954 Vali Acc: 0.650 Test Loss: 2.954 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1221483
	speed: 0.2550s/iter; left time: 8254.6350s
	iters: 200, epoch: 13 | loss: 0.0183108
	speed: 0.0660s/iter; left time: 2130.5214s
	iters: 300, epoch: 13 | loss: 0.3354319
	speed: 0.0657s/iter; left time: 2114.8249s
Epoch: 13 cost time: 24.968669652938843
Epoch: 13, Steps: 369 | Train Loss: 0.246 Vali Loss: 2.701 Vali Acc: 0.642 Test Loss: 2.701 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3671540
	speed: 0.2427s/iter; left time: 7767.8330s
	iters: 200, epoch: 14 | loss: 0.6428302
	speed: 0.0633s/iter; left time: 2020.5663s
	iters: 300, epoch: 14 | loss: 0.0007929
	speed: 0.0654s/iter; left time: 2079.8317s
Epoch: 14 cost time: 24.224710941314697
Epoch: 14, Steps: 369 | Train Loss: 0.169 Vali Loss: 2.556 Vali Acc: 0.640 Test Loss: 2.556 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1090274
	speed: 0.2503s/iter; left time: 7916.6919s
	iters: 200, epoch: 15 | loss: 0.0093204
	speed: 0.0654s/iter; left time: 2063.0651s
	iters: 300, epoch: 15 | loss: 0.2542638
	speed: 0.0663s/iter; left time: 2083.4515s
Epoch: 15 cost time: 24.946327924728394
Epoch: 15, Steps: 369 | Train Loss: 0.130 Vali Loss: 2.464 Vali Acc: 0.643 Test Loss: 2.464 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0595756
	speed: 0.2488s/iter; left time: 7780.0811s
	iters: 200, epoch: 16 | loss: 0.0459767
	speed: 0.0670s/iter; left time: 2087.9101s
	iters: 300, epoch: 16 | loss: 0.0807957
	speed: 0.0650s/iter; left time: 2020.5822s
Epoch: 16 cost time: 23.968302249908447
Epoch: 16, Steps: 369 | Train Loss: 0.116 Vali Loss: 2.447 Vali Acc: 0.633 Test Loss: 2.447 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.1835332
	speed: 0.2305s/iter; left time: 7121.4735s
	iters: 200, epoch: 17 | loss: 0.0671494
	speed: 0.0616s/iter; left time: 1897.6866s
	iters: 300, epoch: 17 | loss: 0.0078380
	speed: 0.0665s/iter; left time: 2042.4742s
Epoch: 17 cost time: 23.701390743255615
Epoch: 17, Steps: 369 | Train Loss: 0.085 Vali Loss: 2.334 Vali Acc: 0.646 Test Loss: 2.334 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0116988
	speed: 0.2392s/iter; left time: 7302.6398s
	iters: 200, epoch: 18 | loss: 0.2010123
	speed: 0.0612s/iter; left time: 1863.0990s
	iters: 300, epoch: 18 | loss: 0.0009095
	speed: 0.0606s/iter; left time: 1837.0308s
Epoch: 18 cost time: 23.343429803848267
Epoch: 18, Steps: 369 | Train Loss: 0.063 Vali Loss: 2.412 Vali Acc: 0.653 Test Loss: 2.412 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0130167
	speed: 0.2352s/iter; left time: 7094.4210s
	iters: 200, epoch: 19 | loss: 0.2906165
	speed: 0.0601s/iter; left time: 1807.1913s
	iters: 300, epoch: 19 | loss: 0.0077518
	speed: 0.0622s/iter; left time: 1863.2416s
Epoch: 19 cost time: 22.935951948165894
Epoch: 19, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.456 Vali Acc: 0.656 Test Loss: 2.456 Test Acc: 0.656
Validation loss decreased (-0.654330 --> -0.655764).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0129444
	speed: 0.2299s/iter; left time: 6849.3708s
	iters: 200, epoch: 20 | loss: 0.0109989
	speed: 0.0585s/iter; left time: 1738.2986s
	iters: 300, epoch: 20 | loss: 0.0231888
	speed: 0.0591s/iter; left time: 1750.1646s
Epoch: 20 cost time: 21.802486658096313
Epoch: 20, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.335 Vali Acc: 0.648 Test Loss: 2.335 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0027617
	speed: 0.2317s/iter; left time: 6816.9887s
	iters: 200, epoch: 21 | loss: 0.0024759
	speed: 0.0595s/iter; left time: 1745.0806s
	iters: 300, epoch: 21 | loss: 0.2394490
	speed: 0.0618s/iter; left time: 1804.8936s
Epoch: 21 cost time: 22.615844249725342
Epoch: 21, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.483 Vali Acc: 0.642 Test Loss: 2.483 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0598137
	speed: 0.2304s/iter; left time: 6692.8737s
	iters: 200, epoch: 22 | loss: 0.0009890
	speed: 0.0592s/iter; left time: 1712.5951s
	iters: 300, epoch: 22 | loss: 0.0971796
	speed: 0.0601s/iter; left time: 1734.0207s
Epoch: 22 cost time: 22.35120964050293
Epoch: 22, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.475 Vali Acc: 0.633 Test Loss: 2.475 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1539264
	speed: 0.2344s/iter; left time: 6724.3315s
	iters: 200, epoch: 23 | loss: 0.0266912
	speed: 0.0599s/iter; left time: 1710.9369s
	iters: 300, epoch: 23 | loss: 0.0049924
	speed: 0.0609s/iter; left time: 1734.7597s
Epoch: 23 cost time: 22.46083664894104
Epoch: 23, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.542 Vali Acc: 0.645 Test Loss: 2.542 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0419238
	speed: 0.2412s/iter; left time: 6829.3482s
	iters: 200, epoch: 24 | loss: 0.0754411
	speed: 0.0659s/iter; left time: 1859.9496s
	iters: 300, epoch: 24 | loss: 0.0005414
	speed: 0.0649s/iter; left time: 1824.8430s
Epoch: 24 cost time: 24.775811195373535
Epoch: 24, Steps: 369 | Train Loss: 0.045 Vali Loss: 2.480 Vali Acc: 0.643 Test Loss: 2.480 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0010753
	speed: 0.2465s/iter; left time: 6889.5967s
	iters: 200, epoch: 25 | loss: 0.0148441
	speed: 0.0639s/iter; left time: 1778.6225s
	iters: 300, epoch: 25 | loss: 0.1790709
	speed: 0.0677s/iter; left time: 1879.4288s
Epoch: 25 cost time: 24.705811977386475
Epoch: 25, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.678 Vali Acc: 0.643 Test Loss: 2.678 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0001137
	speed: 0.2526s/iter; left time: 6965.4059s
	iters: 200, epoch: 26 | loss: 0.0074320
	speed: 0.0646s/iter; left time: 1775.9305s
	iters: 300, epoch: 26 | loss: 0.0054175
	speed: 0.0656s/iter; left time: 1796.5676s
Epoch: 26 cost time: 24.76149296760559
Epoch: 26, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.764 Vali Acc: 0.645 Test Loss: 2.764 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0003155
	speed: 0.2512s/iter; left time: 6833.9293s
	iters: 200, epoch: 27 | loss: 0.0522642
	speed: 0.0650s/iter; left time: 1762.7601s
	iters: 300, epoch: 27 | loss: 0.0159691
	speed: 0.0653s/iter; left time: 1764.2118s
Epoch: 27 cost time: 24.591415405273438
Epoch: 27, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.650 Vali Acc: 0.647 Test Loss: 2.650 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0076375
	speed: 0.2496s/iter; left time: 6700.0719s
	iters: 200, epoch: 28 | loss: 0.0106243
	speed: 0.0643s/iter; left time: 1719.2085s
	iters: 300, epoch: 28 | loss: 0.0017452
	speed: 0.0645s/iter; left time: 1717.2869s
Epoch: 28 cost time: 24.582754373550415
Epoch: 28, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.731 Vali Acc: 0.642 Test Loss: 2.731 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0008861
	speed: 0.2529s/iter; left time: 6693.7378s
	iters: 200, epoch: 29 | loss: 0.0250612
	speed: 0.0655s/iter; left time: 1726.2280s
	iters: 300, epoch: 29 | loss: 0.1717373
	speed: 0.0647s/iter; left time: 1698.9372s
Epoch: 29 cost time: 24.707709789276123
Epoch: 29, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.719 Vali Acc: 0.635 Test Loss: 2.719 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.655788876276958
model parameter : 271938
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0677007
	speed: 0.0772s/iter; left time: 2839.9466s
	iters: 200, epoch: 1 | loss: 2.0993366
	speed: 0.0593s/iter; left time: 2177.3191s
	iters: 300, epoch: 1 | loss: 2.0757859
	speed: 0.0589s/iter; left time: 2156.9866s
Epoch: 1 cost time: 23.722643613815308
Epoch: 1, Steps: 369 | Train Loss: 1.222 Vali Loss: 1.523 Vali Acc: 0.649 Test Loss: 1.523 Test Acc: 0.649
Validation loss decreased (inf --> -0.648963).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4699528
	speed: 0.2332s/iter; left time: 8494.5201s
	iters: 200, epoch: 2 | loss: 1.7512336
	speed: 0.0591s/iter; left time: 2146.8941s
	iters: 300, epoch: 2 | loss: 1.7971581
	speed: 0.0610s/iter; left time: 2209.0467s
Epoch: 2 cost time: 22.786246061325073
Epoch: 2, Steps: 369 | Train Loss: 1.194 Vali Loss: 1.905 Vali Acc: 0.631 Test Loss: 1.905 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1673223
	speed: 0.2178s/iter; left time: 7853.2269s
	iters: 200, epoch: 3 | loss: 1.3045921
	speed: 0.0539s/iter; left time: 1939.9027s
	iters: 300, epoch: 3 | loss: 1.1297113
	speed: 0.0541s/iter; left time: 1940.1223s
Epoch: 3 cost time: 20.158250093460083
Epoch: 3, Steps: 369 | Train Loss: 1.507 Vali Loss: 2.267 Vali Acc: 0.655 Test Loss: 2.267 Test Acc: 0.655
Validation loss decreased (-0.648963 --> -0.654915).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9236329
	speed: 0.2154s/iter; left time: 7688.8651s
	iters: 200, epoch: 4 | loss: 0.7759030
	speed: 0.0553s/iter; left time: 1968.2627s
	iters: 300, epoch: 4 | loss: 1.4667521
	speed: 0.0550s/iter; left time: 1950.9301s
Epoch: 4 cost time: 21.16615653038025
Epoch: 4, Steps: 369 | Train Loss: 1.734 Vali Loss: 2.779 Vali Acc: 0.645 Test Loss: 2.779 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3234725
	speed: 0.2197s/iter; left time: 7761.4617s
	iters: 200, epoch: 5 | loss: 0.6167280
	speed: 0.0544s/iter; left time: 1917.4095s
	iters: 300, epoch: 5 | loss: 1.9910765
	speed: 0.0547s/iter; left time: 1921.7559s
Epoch: 5 cost time: 20.758797645568848
Epoch: 5, Steps: 369 | Train Loss: 1.614 Vali Loss: 3.458 Vali Acc: 0.660 Test Loss: 3.458 Test Acc: 0.660
Validation loss decreased (-0.654915 --> -0.660295).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6907570
	speed: 0.2069s/iter; left time: 7233.1529s
	iters: 200, epoch: 6 | loss: 1.8148115
	speed: 0.0528s/iter; left time: 1840.6173s
	iters: 300, epoch: 6 | loss: 0.2236472
	speed: 0.0531s/iter; left time: 1844.1278s
Epoch: 6 cost time: 20.314045906066895
Epoch: 6, Steps: 369 | Train Loss: 1.477 Vali Loss: 4.125 Vali Acc: 0.633 Test Loss: 4.125 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7660406
	speed: 0.2127s/iter; left time: 7357.3458s
	iters: 200, epoch: 7 | loss: 2.2841985
	speed: 0.0530s/iter; left time: 1827.6560s
	iters: 300, epoch: 7 | loss: 2.2159216
	speed: 0.0526s/iter; left time: 1807.9158s
Epoch: 7 cost time: 20.278773307800293
Epoch: 7, Steps: 369 | Train Loss: 1.242 Vali Loss: 4.069 Vali Acc: 0.641 Test Loss: 4.069 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3344320
	speed: 0.2088s/iter; left time: 7146.1797s
	iters: 200, epoch: 8 | loss: 1.4290907
	speed: 0.0538s/iter; left time: 1837.0165s
	iters: 300, epoch: 8 | loss: 1.6113303
	speed: 0.0532s/iter; left time: 1809.8242s
Epoch: 8 cost time: 20.424481868743896
Epoch: 8, Steps: 369 | Train Loss: 0.911 Vali Loss: 4.067 Vali Acc: 0.643 Test Loss: 4.067 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0523032
	speed: 0.2083s/iter; left time: 7051.6647s
	iters: 200, epoch: 9 | loss: 0.0585489
	speed: 0.0529s/iter; left time: 1784.1258s
	iters: 300, epoch: 9 | loss: 0.7595941
	speed: 0.0531s/iter; left time: 1785.5877s
Epoch: 9 cost time: 20.239577531814575
Epoch: 9, Steps: 369 | Train Loss: 0.740 Vali Loss: 3.771 Vali Acc: 0.649 Test Loss: 3.771 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1918288
	speed: 0.2088s/iter; left time: 6990.0348s
	iters: 200, epoch: 10 | loss: 0.1227362
	speed: 0.0536s/iter; left time: 1788.7682s
	iters: 300, epoch: 10 | loss: 0.1967831
	speed: 0.0537s/iter; left time: 1788.5265s
Epoch: 10 cost time: 20.675865650177002
Epoch: 10, Steps: 369 | Train Loss: 0.524 Vali Loss: 3.738 Vali Acc: 0.630 Test Loss: 3.738 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2850325
	speed: 0.2115s/iter; left time: 7001.7002s
	iters: 200, epoch: 11 | loss: 0.7601749
	speed: 0.0588s/iter; left time: 1939.6400s
	iters: 300, epoch: 11 | loss: 0.1871427
	speed: 0.0592s/iter; left time: 1946.7048s
Epoch: 11 cost time: 22.457785844802856
Epoch: 11, Steps: 369 | Train Loss: 0.374 Vali Loss: 3.185 Vali Acc: 0.643 Test Loss: 3.185 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0411074
	speed: 0.2276s/iter; left time: 7452.7094s
	iters: 200, epoch: 12 | loss: 0.6022967
	speed: 0.0601s/iter; left time: 1961.2614s
	iters: 300, epoch: 12 | loss: 0.0862108
	speed: 0.0596s/iter; left time: 1939.7927s
Epoch: 12 cost time: 22.530292987823486
Epoch: 12, Steps: 369 | Train Loss: 0.322 Vali Loss: 3.022 Vali Acc: 0.639 Test Loss: 3.022 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0077240
	speed: 0.2262s/iter; left time: 7322.3742s
	iters: 200, epoch: 13 | loss: 0.1031930
	speed: 0.0593s/iter; left time: 1913.7922s
	iters: 300, epoch: 13 | loss: 0.1309069
	speed: 0.0584s/iter; left time: 1879.1492s
Epoch: 13 cost time: 22.45401358604431
Epoch: 13, Steps: 369 | Train Loss: 0.211 Vali Loss: 2.888 Vali Acc: 0.647 Test Loss: 2.888 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0063683
	speed: 0.2254s/iter; left time: 7213.7757s
	iters: 200, epoch: 14 | loss: 0.1152237
	speed: 0.0594s/iter; left time: 1893.9193s
	iters: 300, epoch: 14 | loss: 0.0678507
	speed: 0.0594s/iter; left time: 1889.0980s
Epoch: 14 cost time: 22.5640127658844
Epoch: 14, Steps: 369 | Train Loss: 0.171 Vali Loss: 2.846 Vali Acc: 0.645 Test Loss: 2.846 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6562044
	speed: 0.2313s/iter; left time: 7317.4969s
	iters: 200, epoch: 15 | loss: 0.0043415
	speed: 0.0597s/iter; left time: 1884.0868s
	iters: 300, epoch: 15 | loss: 0.2529871
	speed: 0.0598s/iter; left time: 1878.5841s
Epoch: 15 cost time: 22.721935510635376
Epoch: 15, Steps: 369 | Train Loss: 0.147 Vali Loss: 2.643 Vali Acc: 0.653 Test Loss: 2.643 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6603291713961408
model parameter : 216834
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9414776
	speed: 0.0680s/iter; left time: 2504.0338s
	iters: 200, epoch: 1 | loss: 1.3834081
	speed: 0.0496s/iter; left time: 1821.2287s
	iters: 300, epoch: 1 | loss: 2.0203712
	speed: 0.0491s/iter; left time: 1798.9356s
Epoch: 1 cost time: 20.236594438552856
Epoch: 1, Steps: 369 | Train Loss: 1.061 Vali Loss: 1.549 Vali Acc: 0.625 Test Loss: 1.549 Test Acc: 0.625
Validation loss decreased (inf --> -0.625410).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4804746
	speed: 0.1893s/iter; left time: 6897.9254s
	iters: 200, epoch: 2 | loss: 0.5317648
	speed: 0.0484s/iter; left time: 1760.0295s
	iters: 300, epoch: 2 | loss: 1.0566429
	speed: 0.0486s/iter; left time: 1759.1889s
Epoch: 2 cost time: 18.475589513778687
Epoch: 2, Steps: 369 | Train Loss: 1.094 Vali Loss: 1.642 Vali Acc: 0.647 Test Loss: 1.642 Test Acc: 0.647
Validation loss decreased (-0.625410 --> -0.646976).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4654032
	speed: 0.1890s/iter; left time: 6815.2193s
	iters: 200, epoch: 3 | loss: 3.3079145
	speed: 0.0490s/iter; left time: 1761.3544s
	iters: 300, epoch: 3 | loss: 0.2486016
	speed: 0.0487s/iter; left time: 1745.0186s
Epoch: 3 cost time: 18.541455268859863
Epoch: 3, Steps: 369 | Train Loss: 1.371 Vali Loss: 2.289 Vali Acc: 0.626 Test Loss: 2.289 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0624326
	speed: 0.1928s/iter; left time: 6880.7746s
	iters: 200, epoch: 4 | loss: 0.2234943
	speed: 0.0484s/iter; left time: 1723.1147s
	iters: 300, epoch: 4 | loss: 5.2023568
	speed: 0.0485s/iter; left time: 1721.5290s
Epoch: 4 cost time: 18.594861268997192
Epoch: 4, Steps: 369 | Train Loss: 1.423 Vali Loss: 2.919 Vali Acc: 0.642 Test Loss: 2.919 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1650779
	speed: 0.1856s/iter; left time: 6556.7598s
	iters: 200, epoch: 5 | loss: 0.3636045
	speed: 0.0506s/iter; left time: 1780.6321s
	iters: 300, epoch: 5 | loss: 2.0939989
	speed: 0.0394s/iter; left time: 1384.1277s
Epoch: 5 cost time: 17.530136585235596
Epoch: 5, Steps: 369 | Train Loss: 1.394 Vali Loss: 2.929 Vali Acc: 0.644 Test Loss: 2.929 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7126387
	speed: 0.1765s/iter; left time: 6170.4872s
	iters: 200, epoch: 6 | loss: 0.6716283
	speed: 0.0443s/iter; left time: 1544.0197s
	iters: 300, epoch: 6 | loss: 0.1438657
	speed: 0.0437s/iter; left time: 1519.8637s
Epoch: 6 cost time: 16.83533501625061
Epoch: 6, Steps: 369 | Train Loss: 1.190 Vali Loss: 3.283 Vali Acc: 0.640 Test Loss: 3.283 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1063095
	speed: 0.1799s/iter; left time: 6223.8374s
	iters: 200, epoch: 7 | loss: 3.5176613
	speed: 0.0451s/iter; left time: 1556.3033s
	iters: 300, epoch: 7 | loss: 0.8125782
	speed: 0.0451s/iter; left time: 1549.3274s
Epoch: 7 cost time: 17.483243942260742
Epoch: 7, Steps: 369 | Train Loss: 1.032 Vali Loss: 3.726 Vali Acc: 0.637 Test Loss: 3.726 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.9396657
	speed: 0.1719s/iter; left time: 5881.4668s
	iters: 200, epoch: 8 | loss: 0.0096927
	speed: 0.0466s/iter; left time: 1591.5844s
	iters: 300, epoch: 8 | loss: 0.4563306
	speed: 0.0461s/iter; left time: 1566.9712s
Epoch: 8 cost time: 17.2615966796875
Epoch: 8, Steps: 369 | Train Loss: 0.826 Vali Loss: 3.936 Vali Acc: 0.636 Test Loss: 3.936 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6597264
	speed: 0.1738s/iter; left time: 5881.9188s
	iters: 200, epoch: 9 | loss: 0.1819236
	speed: 0.0447s/iter; left time: 1508.3494s
	iters: 300, epoch: 9 | loss: 0.9343740
	speed: 0.0454s/iter; left time: 1526.6454s
Epoch: 9 cost time: 17.130874156951904
Epoch: 9, Steps: 369 | Train Loss: 0.622 Vali Loss: 3.738 Vali Acc: 0.624 Test Loss: 3.738 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0124420
	speed: 0.1668s/iter; left time: 5583.4773s
	iters: 200, epoch: 10 | loss: 0.3911559
	speed: 0.0428s/iter; left time: 1429.2527s
	iters: 300, epoch: 10 | loss: 0.0566514
	speed: 0.0433s/iter; left time: 1442.2822s
Epoch: 10 cost time: 16.761453866958618
Epoch: 10, Steps: 369 | Train Loss: 0.455 Vali Loss: 3.354 Vali Acc: 0.634 Test Loss: 3.354 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0007004
	speed: 0.1780s/iter; left time: 5892.4868s
	iters: 200, epoch: 11 | loss: 1.4049038
	speed: 0.0444s/iter; left time: 1465.0552s
	iters: 300, epoch: 11 | loss: 0.9849551
	speed: 0.0434s/iter; left time: 1429.8995s
Epoch: 11 cost time: 16.788512468338013
Epoch: 11, Steps: 369 | Train Loss: 0.375 Vali Loss: 3.177 Vali Acc: 0.645 Test Loss: 3.177 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.1501491
	speed: 0.1687s/iter; left time: 5524.4448s
	iters: 200, epoch: 12 | loss: 0.0039024
	speed: 0.0443s/iter; left time: 1447.2989s
	iters: 300, epoch: 12 | loss: 0.1833120
	speed: 0.0430s/iter; left time: 1398.1313s
Epoch: 12 cost time: 16.591034650802612
Epoch: 12, Steps: 369 | Train Loss: 0.315 Vali Loss: 3.256 Vali Acc: 0.635 Test Loss: 3.256 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6469920544835415
model parameter : 180162
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 5.2412243
	speed: 0.2247s/iter; left time: 8267.7652s
	iters: 200, epoch: 1 | loss: 2.4296606
	speed: 0.2071s/iter; left time: 7599.5460s
	iters: 300, epoch: 1 | loss: 1.6474304
	speed: 0.2090s/iter; left time: 7649.8328s
Epoch: 1 cost time: 78.52716183662415
Epoch: 1, Steps: 369 | Train Loss: 4.002 Vali Loss: 1.529 Vali Acc: 0.655 Test Loss: 1.529 Test Acc: 0.655
Validation loss decreased (inf --> -0.654922).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3095741
	speed: 0.7265s/iter; left time: 26466.2984s
	iters: 200, epoch: 2 | loss: 1.8353802
	speed: 0.2103s/iter; left time: 7639.9066s
	iters: 300, epoch: 2 | loss: 3.4479203
	speed: 0.2123s/iter; left time: 7691.1012s
Epoch: 2 cost time: 78.23816156387329
Epoch: 2, Steps: 369 | Train Loss: 3.232 Vali Loss: 3.625 Vali Acc: 0.655 Test Loss: 3.625 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2414186
	speed: 0.7239s/iter; left time: 26106.6525s
	iters: 200, epoch: 3 | loss: 7.7693620
	speed: 0.2125s/iter; left time: 7640.7850s
	iters: 300, epoch: 3 | loss: 4.3141651
	speed: 0.2088s/iter; left time: 7489.4938s
Epoch: 3 cost time: 78.13797402381897
Epoch: 3, Steps: 369 | Train Loss: 4.627 Vali Loss: 5.488 Vali Acc: 0.645 Test Loss: 5.488 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 5.5314002
	speed: 0.7177s/iter; left time: 25617.9698s
	iters: 200, epoch: 4 | loss: 2.0957258
	speed: 0.2084s/iter; left time: 7416.4588s
	iters: 300, epoch: 4 | loss: 7.0079794
	speed: 0.2088s/iter; left time: 7409.5242s
Epoch: 4 cost time: 77.67007613182068
Epoch: 4, Steps: 369 | Train Loss: 5.065 Vali Loss: 6.465 Vali Acc: 0.645 Test Loss: 6.465 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 5.2238364
	speed: 0.7078s/iter; left time: 25003.1831s
	iters: 200, epoch: 5 | loss: 4.4187961
	speed: 0.2023s/iter; left time: 7126.4689s
	iters: 300, epoch: 5 | loss: 4.1698322
	speed: 0.2028s/iter; left time: 7123.6485s
Epoch: 5 cost time: 75.46778297424316
Epoch: 5, Steps: 369 | Train Loss: 4.664 Vali Loss: 8.811 Vali Acc: 0.654 Test Loss: 8.811 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.0512903
	speed: 0.6881s/iter; left time: 24054.9592s
	iters: 200, epoch: 6 | loss: 6.8040123
	speed: 0.1887s/iter; left time: 6575.7485s
	iters: 300, epoch: 6 | loss: 8.2076130
	speed: 0.1947s/iter; left time: 6767.1173s
Epoch: 6 cost time: 72.49483060836792
Epoch: 6, Steps: 369 | Train Loss: 4.438 Vali Loss: 9.621 Vali Acc: 0.625 Test Loss: 9.621 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6446338
	speed: 0.6793s/iter; left time: 23495.7256s
	iters: 200, epoch: 7 | loss: 7.3937740
	speed: 0.1962s/iter; left time: 6765.6605s
	iters: 300, epoch: 7 | loss: 10.6543016
	speed: 0.2005s/iter; left time: 6894.5800s
Epoch: 7 cost time: 73.88056087493896
Epoch: 7, Steps: 369 | Train Loss: 3.290 Vali Loss: 9.837 Vali Acc: 0.637 Test Loss: 9.837 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000266
	speed: 0.7179s/iter; left time: 24563.4289s
	iters: 200, epoch: 8 | loss: 3.1010604
	speed: 0.2109s/iter; left time: 7194.9905s
	iters: 300, epoch: 8 | loss: 3.2533090
	speed: 0.2074s/iter; left time: 7055.8242s
Epoch: 8 cost time: 78.26272916793823
Epoch: 8, Steps: 369 | Train Loss: 2.364 Vali Loss: 10.616 Vali Acc: 0.640 Test Loss: 10.616 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.1446564
	speed: 0.7261s/iter; left time: 24577.8815s
	iters: 200, epoch: 9 | loss: 1.8822963
	speed: 0.2100s/iter; left time: 7086.1197s
	iters: 300, epoch: 9 | loss: 8.8905392
	speed: 0.2086s/iter; left time: 7019.8410s
Epoch: 9 cost time: 77.63340759277344
Epoch: 9, Steps: 369 | Train Loss: 1.747 Vali Loss: 10.744 Vali Acc: 0.625 Test Loss: 10.744 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.5991517
	speed: 0.7229s/iter; left time: 24202.8160s
	iters: 200, epoch: 10 | loss: 2.3856921
	speed: 0.2069s/iter; left time: 6906.7561s
	iters: 300, epoch: 10 | loss: 3.7314119
	speed: 0.2084s/iter; left time: 6936.6342s
Epoch: 10 cost time: 77.5630943775177
Epoch: 10, Steps: 369 | Train Loss: 1.285 Vali Loss: 8.469 Vali Acc: 0.627 Test Loss: 8.469 Test Acc: 0.627
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.8312198
	speed: 0.7269s/iter; left time: 24069.9598s
	iters: 200, epoch: 11 | loss: 0.7685585
	speed: 0.2052s/iter; left time: 6774.9702s
	iters: 300, epoch: 11 | loss: 2.8412344
	speed: 0.2095s/iter; left time: 6894.2135s
Epoch: 11 cost time: 76.79836893081665
Epoch: 11, Steps: 369 | Train Loss: 0.697 Vali Loss: 8.091 Vali Acc: 0.630 Test Loss: 8.091 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6549375709421112
model parameter : 1176514
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.4305437
	speed: 0.1191s/iter; left time: 4384.2852s
	iters: 200, epoch: 1 | loss: 5.5818257
	speed: 0.1013s/iter; left time: 3716.8513s
	iters: 300, epoch: 1 | loss: 4.4948587
	speed: 0.1019s/iter; left time: 3729.8805s
Epoch: 1 cost time: 39.46867775917053
Epoch: 1, Steps: 369 | Train Loss: 2.679 Vali Loss: 1.184 Vali Acc: 0.662 Test Loss: 1.184 Test Acc: 0.662
Validation loss decreased (inf --> -0.661736).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5016968
	speed: 0.3980s/iter; left time: 14498.6366s
	iters: 200, epoch: 2 | loss: 1.5825886
	speed: 0.1022s/iter; left time: 3711.6427s
	iters: 300, epoch: 2 | loss: 2.9699612
	speed: 0.1052s/iter; left time: 3811.4699s
Epoch: 2 cost time: 38.65786004066467
Epoch: 2, Steps: 369 | Train Loss: 2.133 Vali Loss: 3.961 Vali Acc: 0.598 Test Loss: 3.961 Test Acc: 0.598
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.8448169
	speed: 0.4107s/iter; left time: 14810.2644s
	iters: 200, epoch: 3 | loss: 2.8616042
	speed: 0.1100s/iter; left time: 3956.8198s
	iters: 300, epoch: 3 | loss: 4.1323857
	speed: 0.1086s/iter; left time: 3894.0598s
Epoch: 3 cost time: 40.645057916641235
Epoch: 3, Steps: 369 | Train Loss: 3.024 Vali Loss: 3.282 Vali Acc: 0.650 Test Loss: 3.282 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.9771144
	speed: 0.4201s/iter; left time: 14994.7988s
	iters: 200, epoch: 4 | loss: 6.9465714
	speed: 0.1146s/iter; left time: 4078.2935s
	iters: 300, epoch: 4 | loss: 3.4248481
	speed: 0.1140s/iter; left time: 4045.5888s
Epoch: 4 cost time: 42.58355903625488
Epoch: 4, Steps: 369 | Train Loss: 3.341 Vali Loss: 5.868 Vali Acc: 0.643 Test Loss: 5.868 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8706011
	speed: 0.4414s/iter; left time: 15592.2234s
	iters: 200, epoch: 5 | loss: 1.4601736
	speed: 0.1167s/iter; left time: 4111.8379s
	iters: 300, epoch: 5 | loss: 4.9125562
	speed: 0.1143s/iter; left time: 4013.5595s
Epoch: 5 cost time: 42.77478647232056
Epoch: 5, Steps: 369 | Train Loss: 3.424 Vali Loss: 6.441 Vali Acc: 0.641 Test Loss: 6.441 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 6.2522445
	speed: 0.4386s/iter; left time: 15330.6138s
	iters: 200, epoch: 6 | loss: 2.4207580
	speed: 0.1154s/iter; left time: 4021.4992s
	iters: 300, epoch: 6 | loss: 3.2859554
	speed: 0.1118s/iter; left time: 3884.6495s
Epoch: 6 cost time: 42.881462812423706
Epoch: 6, Steps: 369 | Train Loss: 3.258 Vali Loss: 5.302 Vali Acc: 0.648 Test Loss: 5.302 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.5134118
	speed: 0.4453s/iter; left time: 15401.9075s
	iters: 200, epoch: 7 | loss: 2.3588910
	speed: 0.1156s/iter; left time: 3987.3324s
	iters: 300, epoch: 7 | loss: 2.5627453
	speed: 0.1155s/iter; left time: 3972.2514s
Epoch: 7 cost time: 42.93665599822998
Epoch: 7, Steps: 369 | Train Loss: 2.654 Vali Loss: 8.317 Vali Acc: 0.643 Test Loss: 8.317 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8857684
	speed: 0.4505s/iter; left time: 15416.0811s
	iters: 200, epoch: 8 | loss: 0.0002994
	speed: 0.1166s/iter; left time: 3978.4405s
	iters: 300, epoch: 8 | loss: 2.5615590
	speed: 0.1149s/iter; left time: 3909.9510s
Epoch: 8 cost time: 43.18525576591492
Epoch: 8, Steps: 369 | Train Loss: 1.851 Vali Loss: 7.022 Vali Acc: 0.644 Test Loss: 7.022 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.1038346
	speed: 0.4537s/iter; left time: 15358.8418s
	iters: 200, epoch: 9 | loss: 0.9052955
	speed: 0.1177s/iter; left time: 3973.8721s
	iters: 300, epoch: 9 | loss: 0.3721517
	speed: 0.1162s/iter; left time: 3908.5614s
Epoch: 9 cost time: 43.89392161369324
Epoch: 9, Steps: 369 | Train Loss: 1.352 Vali Loss: 5.439 Vali Acc: 0.614 Test Loss: 5.439 Test Acc: 0.614
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.1407049
	speed: 0.4430s/iter; left time: 14830.5709s
	iters: 200, epoch: 10 | loss: 1.8774395
	speed: 0.1081s/iter; left time: 3608.8350s
	iters: 300, epoch: 10 | loss: 0.5613887
	speed: 0.1051s/iter; left time: 3496.5331s
Epoch: 10 cost time: 40.16083073616028
Epoch: 10, Steps: 369 | Train Loss: 0.778 Vali Loss: 4.374 Vali Acc: 0.632 Test Loss: 4.374 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8889629
	speed: 0.4072s/iter; left time: 13482.4399s
	iters: 200, epoch: 11 | loss: 0.5583025
	speed: 0.1055s/iter; left time: 3481.2343s
	iters: 300, epoch: 11 | loss: 0.4260026
	speed: 0.1027s/iter; left time: 3379.6911s
Epoch: 11 cost time: 38.770628690719604
Epoch: 11, Steps: 369 | Train Loss: 0.510 Vali Loss: 3.674 Vali Acc: 0.635 Test Loss: 3.674 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6617480136208853
model parameter : 605250
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7696787
	speed: 0.0955s/iter; left time: 3516.3229s
	iters: 200, epoch: 1 | loss: 1.7541226
	speed: 0.0829s/iter; left time: 3043.0134s
	iters: 300, epoch: 1 | loss: 1.5571052
	speed: 0.0792s/iter; left time: 2899.0846s
Epoch: 1 cost time: 31.497523546218872
Epoch: 1, Steps: 369 | Train Loss: 1.910 Vali Loss: 1.521 Vali Acc: 0.628 Test Loss: 1.521 Test Acc: 0.628
Validation loss decreased (inf --> -0.628248).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8709512
	speed: 0.3069s/iter; left time: 11181.5088s
	iters: 200, epoch: 2 | loss: 2.4388719
	speed: 0.0832s/iter; left time: 3021.3418s
	iters: 300, epoch: 2 | loss: 3.0721903
	speed: 0.0788s/iter; left time: 2853.7168s
Epoch: 2 cost time: 30.14763307571411
Epoch: 2, Steps: 369 | Train Loss: 1.889 Vali Loss: 1.800 Vali Acc: 0.649 Test Loss: 1.800 Test Acc: 0.649
Validation loss decreased (-0.628248 --> -0.648677).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9329998
	speed: 0.3050s/iter; left time: 10998.8708s
	iters: 200, epoch: 3 | loss: 1.0053800
	speed: 0.0817s/iter; left time: 2939.9650s
	iters: 300, epoch: 3 | loss: 3.2503142
	speed: 0.0775s/iter; left time: 2780.2009s
Epoch: 3 cost time: 29.70182156562805
Epoch: 3, Steps: 369 | Train Loss: 2.381 Vali Loss: 3.354 Vali Acc: 0.643 Test Loss: 3.354 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1020463
	speed: 0.3257s/iter; left time: 11625.5620s
	iters: 200, epoch: 4 | loss: 6.8276477
	speed: 0.0872s/iter; left time: 3104.7295s
	iters: 300, epoch: 4 | loss: 4.0706139
	speed: 0.0870s/iter; left time: 3087.3232s
Epoch: 4 cost time: 32.94098162651062
Epoch: 4, Steps: 369 | Train Loss: 2.899 Vali Loss: 3.545 Vali Acc: 0.640 Test Loss: 3.545 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.4376740
	speed: 0.3304s/iter; left time: 11672.2899s
	iters: 200, epoch: 5 | loss: 1.5651716
	speed: 0.0851s/iter; left time: 2996.8548s
	iters: 300, epoch: 5 | loss: 2.6037989
	speed: 0.0879s/iter; left time: 3086.3803s
Epoch: 5 cost time: 32.60084533691406
Epoch: 5, Steps: 369 | Train Loss: 2.739 Vali Loss: 5.197 Vali Acc: 0.626 Test Loss: 5.197 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.3373007
	speed: 0.3332s/iter; left time: 11645.9403s
	iters: 200, epoch: 6 | loss: 1.9450339
	speed: 0.0870s/iter; left time: 3031.1136s
	iters: 300, epoch: 6 | loss: 2.2069399
	speed: 0.0881s/iter; left time: 3060.9256s
Epoch: 6 cost time: 33.0947802066803
Epoch: 6, Steps: 369 | Train Loss: 2.541 Vali Loss: 5.213 Vali Acc: 0.636 Test Loss: 5.213 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.2877600
	speed: 0.3362s/iter; left time: 11627.5702s
	iters: 200, epoch: 7 | loss: 0.0364957
	speed: 0.0872s/iter; left time: 3008.6228s
	iters: 300, epoch: 7 | loss: 2.5132668
	speed: 0.0877s/iter; left time: 3015.4274s
Epoch: 7 cost time: 32.915205240249634
Epoch: 7, Steps: 369 | Train Loss: 1.958 Vali Loss: 5.155 Vali Acc: 0.634 Test Loss: 5.155 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.2081878
	speed: 0.3342s/iter; left time: 11434.3824s
	iters: 200, epoch: 8 | loss: 0.8632613
	speed: 0.0890s/iter; left time: 3036.2233s
	iters: 300, epoch: 8 | loss: 0.5456482
	speed: 0.0889s/iter; left time: 3023.8302s
Epoch: 8 cost time: 33.48479509353638
Epoch: 8, Steps: 369 | Train Loss: 1.608 Vali Loss: 6.079 Vali Acc: 0.636 Test Loss: 6.079 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.0166383
	speed: 0.3383s/iter; left time: 11450.7751s
	iters: 200, epoch: 9 | loss: 0.2722588
	speed: 0.0897s/iter; left time: 3027.2193s
	iters: 300, epoch: 9 | loss: 2.5362477
	speed: 0.0898s/iter; left time: 3023.3176s
Epoch: 9 cost time: 33.74637842178345
Epoch: 9, Steps: 369 | Train Loss: 1.113 Vali Loss: 4.510 Vali Acc: 0.641 Test Loss: 4.510 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5967454
	speed: 0.3438s/iter; left time: 11510.5383s
	iters: 200, epoch: 10 | loss: 0.0176509
	speed: 0.0913s/iter; left time: 3046.4358s
	iters: 300, epoch: 10 | loss: 0.9677922
	speed: 0.0909s/iter; left time: 3023.9389s
Epoch: 10 cost time: 34.19046497344971
Epoch: 10, Steps: 369 | Train Loss: 0.735 Vali Loss: 4.507 Vali Acc: 0.641 Test Loss: 4.507 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.9184933
	speed: 0.3336s/iter; left time: 11044.6369s
	iters: 200, epoch: 11 | loss: 0.8258346
	speed: 0.0800s/iter; left time: 2640.2954s
	iters: 300, epoch: 11 | loss: 0.5183640
	speed: 0.0810s/iter; left time: 2665.2154s
Epoch: 11 cost time: 31.13692808151245
Epoch: 11, Steps: 369 | Train Loss: 0.470 Vali Loss: 3.400 Vali Acc: 0.634 Test Loss: 3.400 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000809
	speed: 0.3195s/iter; left time: 10462.0322s
	iters: 200, epoch: 12 | loss: 0.0086342
	speed: 0.0833s/iter; left time: 2719.9718s
	iters: 300, epoch: 12 | loss: 0.3590550
	speed: 0.0761s/iter; left time: 2475.4863s
Epoch: 12 cost time: 30.180978775024414
Epoch: 12, Steps: 369 | Train Loss: 0.298 Vali Loss: 2.658 Vali Acc: 0.641 Test Loss: 2.658 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6486946651532349
model parameter : 420994
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3325663
	speed: 0.0751s/iter; left time: 2764.3976s
	iters: 200, epoch: 1 | loss: 2.8365831
	speed: 0.0514s/iter; left time: 1888.0507s
	iters: 300, epoch: 1 | loss: 1.0455673
	speed: 0.0606s/iter; left time: 2218.2005s
Epoch: 1 cost time: 23.020407915115356
Epoch: 1, Steps: 369 | Train Loss: 1.556 Vali Loss: 1.080 Vali Acc: 0.645 Test Loss: 1.080 Test Acc: 0.645
Validation loss decreased (inf --> -0.645279).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5426631
	speed: 0.2533s/iter; left time: 9227.7578s
	iters: 200, epoch: 2 | loss: 2.1673429
	speed: 0.0615s/iter; left time: 2232.8476s
	iters: 300, epoch: 2 | loss: 1.3845198
	speed: 0.0580s/iter; left time: 2101.3187s
Epoch: 2 cost time: 23.087287664413452
Epoch: 2, Steps: 369 | Train Loss: 1.497 Vali Loss: 1.767 Vali Acc: 0.663 Test Loss: 1.767 Test Acc: 0.663
Validation loss decreased (-0.645279 --> -0.663149).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3251803
	speed: 0.2528s/iter; left time: 9116.5032s
	iters: 200, epoch: 3 | loss: 4.3449268
	speed: 0.0597s/iter; left time: 2146.1417s
	iters: 300, epoch: 3 | loss: 5.2085166
	speed: 0.0629s/iter; left time: 2255.2183s
Epoch: 3 cost time: 23.12769627571106
Epoch: 3, Steps: 369 | Train Loss: 2.134 Vali Loss: 2.765 Vali Acc: 0.647 Test Loss: 2.765 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9735608
	speed: 0.2523s/iter; left time: 9003.8481s
	iters: 200, epoch: 4 | loss: 1.7836262
	speed: 0.0654s/iter; left time: 2326.4643s
	iters: 300, epoch: 4 | loss: 3.5799232
	speed: 0.0622s/iter; left time: 2208.3336s
Epoch: 4 cost time: 23.877858638763428
Epoch: 4, Steps: 369 | Train Loss: 2.239 Vali Loss: 3.084 Vali Acc: 0.642 Test Loss: 3.084 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.9256740
	speed: 0.2533s/iter; left time: 8947.7202s
	iters: 200, epoch: 5 | loss: 2.0958798
	speed: 0.0666s/iter; left time: 2345.6737s
	iters: 300, epoch: 5 | loss: 3.8153551
	speed: 0.0664s/iter; left time: 2331.2722s
Epoch: 5 cost time: 24.79618763923645
Epoch: 5, Steps: 369 | Train Loss: 2.218 Vali Loss: 4.376 Vali Acc: 0.633 Test Loss: 4.376 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.4695730
	speed: 0.2707s/iter; left time: 9461.5463s
	iters: 200, epoch: 6 | loss: 1.6475469
	speed: 0.0655s/iter; left time: 2281.6804s
	iters: 300, epoch: 6 | loss: 3.0505843
	speed: 0.0652s/iter; left time: 2264.7369s
Epoch: 6 cost time: 24.782015085220337
Epoch: 6, Steps: 369 | Train Loss: 2.018 Vali Loss: 4.686 Vali Acc: 0.635 Test Loss: 4.686 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.7188104
	speed: 0.2667s/iter; left time: 9224.7513s
	iters: 200, epoch: 7 | loss: 0.6828852
	speed: 0.0662s/iter; left time: 2283.4932s
	iters: 300, epoch: 7 | loss: 1.4103565
	speed: 0.0657s/iter; left time: 2258.8808s
Epoch: 7 cost time: 24.793358087539673
Epoch: 7, Steps: 369 | Train Loss: 1.729 Vali Loss: 4.563 Vali Acc: 0.637 Test Loss: 4.563 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.3293686
	speed: 0.2679s/iter; left time: 9165.5636s
	iters: 200, epoch: 8 | loss: 1.0626892
	speed: 0.0658s/iter; left time: 2246.2389s
	iters: 300, epoch: 8 | loss: 1.7440839
	speed: 0.0668s/iter; left time: 2273.5432s
Epoch: 8 cost time: 25.183554649353027
Epoch: 8, Steps: 369 | Train Loss: 1.349 Vali Loss: 4.251 Vali Acc: 0.650 Test Loss: 4.251 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.3020009
	speed: 0.2715s/iter; left time: 9188.6056s
	iters: 200, epoch: 9 | loss: 0.7441916
	speed: 0.0642s/iter; left time: 2165.8137s
	iters: 300, epoch: 9 | loss: 0.3723429
	speed: 0.0694s/iter; left time: 2335.1477s
Epoch: 9 cost time: 25.158498525619507
Epoch: 9, Steps: 369 | Train Loss: 1.049 Vali Loss: 4.270 Vali Acc: 0.650 Test Loss: 4.270 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.4880775
	speed: 0.2681s/iter; left time: 8976.8327s
	iters: 200, epoch: 10 | loss: 1.6463509
	speed: 0.0667s/iter; left time: 2227.5352s
	iters: 300, epoch: 10 | loss: 0.2306251
	speed: 0.0665s/iter; left time: 2212.9728s
Epoch: 10 cost time: 25.325155019760132
Epoch: 10, Steps: 369 | Train Loss: 0.663 Vali Loss: 3.492 Vali Acc: 0.641 Test Loss: 3.492 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0937410
	speed: 0.2679s/iter; left time: 8870.3962s
	iters: 200, epoch: 11 | loss: 0.1919545
	speed: 0.0645s/iter; left time: 2127.8563s
	iters: 300, epoch: 11 | loss: 0.7691802
	speed: 0.0646s/iter; left time: 2126.2487s
Epoch: 11 cost time: 24.48344111442566
Epoch: 11, Steps: 369 | Train Loss: 0.450 Vali Loss: 3.372 Vali Acc: 0.634 Test Loss: 3.372 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2523576
	speed: 0.2626s/iter; left time: 8596.5187s
	iters: 200, epoch: 12 | loss: 0.2492025
	speed: 0.0691s/iter; left time: 2255.3649s
	iters: 300, epoch: 12 | loss: 0.4601863
	speed: 0.0683s/iter; left time: 2223.2836s
Epoch: 12 cost time: 25.704768180847168
Epoch: 12, Steps: 369 | Train Loss: 0.332 Vali Loss: 2.714 Vali Acc: 0.660 Test Loss: 2.714 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.66316685584563
model parameter : 310530
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5327921
	speed: 0.0709s/iter; left time: 2610.0022s
	iters: 200, epoch: 1 | loss: 1.5648614
	speed: 0.0566s/iter; left time: 2076.4017s
	iters: 300, epoch: 1 | loss: 1.5731189
	speed: 0.0551s/iter; left time: 2017.2324s
Epoch: 1 cost time: 21.917108297348022
Epoch: 1, Steps: 369 | Train Loss: 1.454 Vali Loss: 1.697 Vali Acc: 0.628 Test Loss: 1.697 Test Acc: 0.628
Validation loss decreased (inf --> -0.628246).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2763913
	speed: 0.2037s/iter; left time: 7422.9687s
	iters: 200, epoch: 2 | loss: 1.2140030
	speed: 0.0521s/iter; left time: 1893.6534s
	iters: 300, epoch: 2 | loss: 1.0214173
	speed: 0.0558s/iter; left time: 2021.7120s
Epoch: 2 cost time: 20.331031799316406
Epoch: 2, Steps: 369 | Train Loss: 1.283 Vali Loss: 2.171 Vali Acc: 0.626 Test Loss: 2.171 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.8381984
	speed: 0.2040s/iter; left time: 7356.3528s
	iters: 200, epoch: 3 | loss: 4.1666436
	speed: 0.0516s/iter; left time: 1854.5318s
	iters: 300, epoch: 3 | loss: 2.5290916
	speed: 0.0493s/iter; left time: 1769.1912s
Epoch: 3 cost time: 19.468952178955078
Epoch: 3, Steps: 369 | Train Loss: 1.818 Vali Loss: 3.071 Vali Acc: 0.634 Test Loss: 3.071 Test Acc: 0.634
Validation loss decreased (-0.628246 --> -0.633908).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3395839
	speed: 0.2103s/iter; left time: 7506.4995s
	iters: 200, epoch: 4 | loss: 1.2109076
	speed: 0.0508s/iter; left time: 1807.3785s
	iters: 300, epoch: 4 | loss: 1.5857608
	speed: 0.0513s/iter; left time: 1821.8912s
Epoch: 4 cost time: 19.465546131134033
Epoch: 4, Steps: 369 | Train Loss: 1.975 Vali Loss: 3.431 Vali Acc: 0.627 Test Loss: 3.431 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0413483
	speed: 0.1966s/iter; left time: 6946.5318s
	iters: 200, epoch: 5 | loss: 3.5250461
	speed: 0.0502s/iter; left time: 1767.1967s
	iters: 300, epoch: 5 | loss: 2.3560922
	speed: 0.0477s/iter; left time: 1676.5475s
Epoch: 5 cost time: 18.16621685028076
Epoch: 5, Steps: 369 | Train Loss: 1.969 Vali Loss: 4.666 Vali Acc: 0.641 Test Loss: 4.666 Test Acc: 0.641
Validation loss decreased (-0.633908 --> -0.641270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5616754
	speed: 0.2069s/iter; left time: 7234.1118s
	iters: 200, epoch: 6 | loss: 1.6089116
	speed: 0.0509s/iter; left time: 1773.7298s
	iters: 300, epoch: 6 | loss: 0.9111894
	speed: 0.0537s/iter; left time: 1865.8968s
Epoch: 6 cost time: 19.624289989471436
Epoch: 6, Steps: 369 | Train Loss: 1.708 Vali Loss: 4.375 Vali Acc: 0.648 Test Loss: 4.375 Test Acc: 0.648
Validation loss decreased (-0.641270 --> -0.647800).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5862027
	speed: 0.1999s/iter; left time: 6914.4313s
	iters: 200, epoch: 7 | loss: 2.5847888
	speed: 0.0504s/iter; left time: 1739.7368s
	iters: 300, epoch: 7 | loss: 4.1231880
	speed: 0.0530s/iter; left time: 1823.3226s
Epoch: 7 cost time: 19.56394338607788
Epoch: 7, Steps: 369 | Train Loss: 1.373 Vali Loss: 5.303 Vali Acc: 0.624 Test Loss: 5.303 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0549268
	speed: 0.2036s/iter; left time: 6968.1066s
	iters: 200, epoch: 8 | loss: 0.6896216
	speed: 0.0511s/iter; left time: 1743.1800s
	iters: 300, epoch: 8 | loss: 0.7649648
	speed: 0.0509s/iter; left time: 1731.7853s
Epoch: 8 cost time: 19.49138903617859
Epoch: 8, Steps: 369 | Train Loss: 1.114 Vali Loss: 4.995 Vali Acc: 0.642 Test Loss: 4.995 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9675574
	speed: 0.1942s/iter; left time: 6574.6314s
	iters: 200, epoch: 9 | loss: 0.5535904
	speed: 0.0508s/iter; left time: 1713.4661s
	iters: 300, epoch: 9 | loss: 1.7923623
	speed: 0.0557s/iter; left time: 1875.6172s
Epoch: 9 cost time: 18.896799325942993
Epoch: 9, Steps: 369 | Train Loss: 0.867 Vali Loss: 4.613 Vali Acc: 0.646 Test Loss: 4.613 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4244510
	speed: 0.2117s/iter; left time: 7086.1795s
	iters: 200, epoch: 10 | loss: 0.8255114
	speed: 0.0553s/iter; left time: 1846.7878s
	iters: 300, epoch: 10 | loss: 0.0645258
	speed: 0.0578s/iter; left time: 1923.0938s
Epoch: 10 cost time: 21.129124402999878
Epoch: 10, Steps: 369 | Train Loss: 0.610 Vali Loss: 4.134 Vali Acc: 0.636 Test Loss: 4.134 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0959928
	speed: 0.2172s/iter; left time: 7190.3973s
	iters: 200, epoch: 11 | loss: 0.0014901
	speed: 0.0569s/iter; left time: 1879.6844s
	iters: 300, epoch: 11 | loss: 0.1592432
	speed: 0.0560s/iter; left time: 1842.1878s
Epoch: 11 cost time: 21.32481074333191
Epoch: 11, Steps: 369 | Train Loss: 0.433 Vali Loss: 3.684 Vali Acc: 0.649 Test Loss: 3.684 Test Acc: 0.649
Validation loss decreased (-0.647800 --> -0.648658).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1941703
	speed: 0.2118s/iter; left time: 6935.5358s
	iters: 200, epoch: 12 | loss: 0.1535632
	speed: 0.0562s/iter; left time: 1835.7243s
	iters: 300, epoch: 12 | loss: 1.4093167
	speed: 0.0545s/iter; left time: 1772.2583s
Epoch: 12 cost time: 20.91067385673523
Epoch: 12, Steps: 369 | Train Loss: 0.322 Vali Loss: 3.265 Vali Acc: 0.641 Test Loss: 3.265 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5788328
	speed: 0.1521s/iter; left time: 4923.2286s
	iters: 200, epoch: 13 | loss: 0.6408594
	speed: 0.0246s/iter; left time: 794.9906s
	iters: 300, epoch: 13 | loss: 0.7339341
	speed: 0.0247s/iter; left time: 793.3090s
Epoch: 13 cost time: 9.69433879852295
Epoch: 13, Steps: 369 | Train Loss: 0.235 Vali Loss: 3.130 Vali Acc: 0.634 Test Loss: 3.130 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0201949
	speed: 0.1349s/iter; left time: 4318.6663s
	iters: 200, epoch: 14 | loss: 0.4358483
	speed: 0.0547s/iter; left time: 1746.4068s
	iters: 300, epoch: 14 | loss: 0.0059158
	speed: 0.0556s/iter; left time: 1766.7445s
Epoch: 14 cost time: 20.66245937347412
Epoch: 14, Steps: 369 | Train Loss: 0.158 Vali Loss: 2.920 Vali Acc: 0.649 Test Loss: 2.920 Test Acc: 0.649
Validation loss decreased (-0.648658 --> -0.649233).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0766511
	speed: 0.2117s/iter; left time: 6696.0452s
	iters: 200, epoch: 15 | loss: 0.0128128
	speed: 0.0541s/iter; left time: 1706.5130s
	iters: 300, epoch: 15 | loss: 0.3002902
	speed: 0.0534s/iter; left time: 1679.3437s
Epoch: 15 cost time: 20.625000715255737
Epoch: 15, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.724 Vali Acc: 0.641 Test Loss: 2.724 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0601245
	speed: 0.2129s/iter; left time: 6656.2646s
	iters: 200, epoch: 16 | loss: 0.0255379
	speed: 0.0542s/iter; left time: 1689.7987s
	iters: 300, epoch: 16 | loss: 0.1870646
	speed: 0.0539s/iter; left time: 1674.2953s
Epoch: 16 cost time: 20.593900442123413
Epoch: 16, Steps: 369 | Train Loss: 0.127 Vali Loss: 2.464 Vali Acc: 0.647 Test Loss: 2.464 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0053735
	speed: 0.2178s/iter; left time: 6727.8608s
	iters: 200, epoch: 17 | loss: 0.2641299
	speed: 0.0540s/iter; left time: 1661.8592s
	iters: 300, epoch: 17 | loss: 0.0170804
	speed: 0.0538s/iter; left time: 1651.1143s
Epoch: 17 cost time: 20.65877342224121
Epoch: 17, Steps: 369 | Train Loss: 0.099 Vali Loss: 2.546 Vali Acc: 0.640 Test Loss: 2.546 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2168036
	speed: 0.2120s/iter; left time: 6470.9812s
	iters: 200, epoch: 18 | loss: 0.0009698
	speed: 0.0543s/iter; left time: 1653.2939s
	iters: 300, epoch: 18 | loss: 0.0323259
	speed: 0.0547s/iter; left time: 1660.1765s
Epoch: 18 cost time: 20.69574475288391
Epoch: 18, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.530 Vali Acc: 0.645 Test Loss: 2.530 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0004457
	speed: 0.2192s/iter; left time: 6611.9984s
	iters: 200, epoch: 19 | loss: 0.0036666
	speed: 0.0547s/iter; left time: 1643.5640s
	iters: 300, epoch: 19 | loss: 0.2643937
	speed: 0.0549s/iter; left time: 1643.4096s
Epoch: 19 cost time: 20.918089389801025
Epoch: 19, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.599 Vali Acc: 0.638 Test Loss: 2.599 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0033080
	speed: 0.2116s/iter; left time: 6304.3110s
	iters: 200, epoch: 20 | loss: 0.1468642
	speed: 0.0562s/iter; left time: 1667.5065s
	iters: 300, epoch: 20 | loss: 0.0504447
	speed: 0.0450s/iter; left time: 1333.0082s
Epoch: 20 cost time: 19.557971477508545
Epoch: 20, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.477 Vali Acc: 0.636 Test Loss: 2.477 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0147606
	speed: 0.1863s/iter; left time: 5479.9672s
	iters: 200, epoch: 21 | loss: 0.0305575
	speed: 0.0487s/iter; left time: 1426.7059s
	iters: 300, epoch: 21 | loss: 0.0110097
	speed: 0.0471s/iter; left time: 1377.6293s
Epoch: 21 cost time: 18.131314277648926
Epoch: 21, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.621 Vali Acc: 0.654 Test Loss: 2.621 Test Acc: 0.654
Validation loss decreased (-0.649233 --> -0.654344).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0693996
	speed: 0.1856s/iter; left time: 5392.1024s
	iters: 200, epoch: 22 | loss: 0.0710930
	speed: 0.0488s/iter; left time: 1412.2265s
	iters: 300, epoch: 22 | loss: 0.0088725
	speed: 0.0472s/iter; left time: 1361.4024s
Epoch: 22 cost time: 18.053542375564575
Epoch: 22, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.658 Vali Acc: 0.644 Test Loss: 2.658 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0164512
	speed: 0.1861s/iter; left time: 5338.5155s
	iters: 200, epoch: 23 | loss: 0.1202544
	speed: 0.0458s/iter; left time: 1308.5970s
	iters: 300, epoch: 23 | loss: 0.0192147
	speed: 0.0488s/iter; left time: 1388.6092s
Epoch: 23 cost time: 17.970969915390015
Epoch: 23, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.797 Vali Acc: 0.654 Test Loss: 2.797 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0030866
	speed: 0.1860s/iter; left time: 5265.4335s
	iters: 200, epoch: 24 | loss: 0.0004901
	speed: 0.0478s/iter; left time: 1347.8068s
	iters: 300, epoch: 24 | loss: 0.3759870
	speed: 0.0475s/iter; left time: 1336.3541s
Epoch: 24 cost time: 17.98515820503235
Epoch: 24, Steps: 369 | Train Loss: 0.051 Vali Loss: 2.847 Vali Acc: 0.650 Test Loss: 2.847 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0712042
	speed: 0.1909s/iter; left time: 5334.3643s
	iters: 200, epoch: 25 | loss: 0.0022215
	speed: 0.0456s/iter; left time: 1269.4036s
	iters: 300, epoch: 25 | loss: 0.0864910
	speed: 0.0561s/iter; left time: 1556.4205s
Epoch: 25 cost time: 19.253859281539917
Epoch: 25, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.879 Vali Acc: 0.637 Test Loss: 2.879 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0002309
	speed: 0.2129s/iter; left time: 5869.9818s
	iters: 200, epoch: 26 | loss: 0.0261695
	speed: 0.0555s/iter; left time: 1526.1954s
	iters: 300, epoch: 26 | loss: 0.2973089
	speed: 0.0549s/iter; left time: 1503.8288s
Epoch: 26 cost time: 20.876806020736694
Epoch: 26, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.743 Vali Acc: 0.641 Test Loss: 2.743 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1440641
	speed: 0.2215s/iter; left time: 6027.3190s
	iters: 200, epoch: 27 | loss: 0.7084892
	speed: 0.0550s/iter; left time: 1491.9388s
	iters: 300, epoch: 27 | loss: 0.0169486
	speed: 0.0563s/iter; left time: 1521.4486s
Epoch: 27 cost time: 21.06006956100464
Epoch: 27, Steps: 369 | Train Loss: 0.051 Vali Loss: 2.870 Vali Acc: 0.636 Test Loss: 2.870 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0179121
	speed: 0.2180s/iter; left time: 5849.9499s
	iters: 200, epoch: 28 | loss: 0.0011212
	speed: 0.0545s/iter; left time: 1457.0669s
	iters: 300, epoch: 28 | loss: 0.0002974
	speed: 0.0548s/iter; left time: 1458.4758s
Epoch: 28 cost time: 20.86201000213623
Epoch: 28, Steps: 369 | Train Loss: 0.044 Vali Loss: 2.930 Vali Acc: 0.641 Test Loss: 2.930 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.5277390
	speed: 0.2215s/iter; left time: 5863.7742s
	iters: 200, epoch: 29 | loss: 0.0000697
	speed: 0.0548s/iter; left time: 1445.3060s
	iters: 300, epoch: 29 | loss: 0.0296393
	speed: 0.0552s/iter; left time: 1449.2140s
Epoch: 29 cost time: 20.891066312789917
Epoch: 29, Steps: 369 | Train Loss: 0.046 Vali Loss: 3.020 Vali Acc: 0.638 Test Loss: 3.020 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0097249
	speed: 0.2191s/iter; left time: 5718.6968s
	iters: 200, epoch: 30 | loss: 0.0020680
	speed: 0.0557s/iter; left time: 1448.3465s
	iters: 300, epoch: 30 | loss: 0.0790774
	speed: 0.0560s/iter; left time: 1450.3638s
Epoch: 30 cost time: 21.25517177581787
Epoch: 30, Steps: 369 | Train Loss: 0.040 Vali Loss: 2.955 Vali Acc: 0.648 Test Loss: 2.955 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0001717
	speed: 0.2190s/iter; left time: 5634.0931s
	iters: 200, epoch: 31 | loss: 0.0008732
	speed: 0.0560s/iter; left time: 1434.2279s
	iters: 300, epoch: 31 | loss: 0.0012788
	speed: 0.0560s/iter; left time: 1428.9724s
Epoch: 31 cost time: 21.31146740913391
Epoch: 31, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.921 Vali Acc: 0.643 Test Loss: 2.921 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6543700340522134
model parameter : 255426
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4677569
	speed: 0.0598s/iter; left time: 2199.0964s
	iters: 200, epoch: 1 | loss: 1.2612193
	speed: 0.0446s/iter; left time: 1635.5194s
	iters: 300, epoch: 1 | loss: 1.1699804
	speed: 0.0471s/iter; left time: 1724.6365s
Epoch: 1 cost time: 18.392988920211792
Epoch: 1, Steps: 369 | Train Loss: 1.283 Vali Loss: 1.918 Vali Acc: 0.607 Test Loss: 1.918 Test Acc: 0.607
Validation loss decreased (inf --> -0.606962).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8355107
	speed: 0.1716s/iter; left time: 6252.6697s
	iters: 200, epoch: 2 | loss: 1.0098150
	speed: 0.0435s/iter; left time: 1579.0668s
	iters: 300, epoch: 2 | loss: 0.6326748
	speed: 0.0437s/iter; left time: 1582.6133s
Epoch: 2 cost time: 16.619083642959595
Epoch: 2, Steps: 369 | Train Loss: 1.228 Vali Loss: 1.600 Vali Acc: 0.648 Test Loss: 1.600 Test Acc: 0.648
Validation loss decreased (-0.606962 --> -0.648111).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8455023
	speed: 0.1755s/iter; left time: 6329.5129s
	iters: 200, epoch: 3 | loss: 1.6136025
	speed: 0.0445s/iter; left time: 1600.3511s
	iters: 300, epoch: 3 | loss: 2.1442940
	speed: 0.0447s/iter; left time: 1604.5193s
Epoch: 3 cost time: 16.896342515945435
Epoch: 3, Steps: 369 | Train Loss: 1.474 Vali Loss: 2.524 Vali Acc: 0.641 Test Loss: 2.524 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9532796
	speed: 0.1730s/iter; left time: 6174.7962s
	iters: 200, epoch: 4 | loss: 3.5934093
	speed: 0.0411s/iter; left time: 1463.7528s
	iters: 300, epoch: 4 | loss: 2.8089876
	speed: 0.0493s/iter; left time: 1749.1155s
Epoch: 4 cost time: 17.29098606109619
Epoch: 4, Steps: 369 | Train Loss: 1.658 Vali Loss: 2.975 Vali Acc: 0.645 Test Loss: 2.975 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.1894035
	speed: 0.1997s/iter; left time: 7053.8646s
	iters: 200, epoch: 5 | loss: 1.4305158
	speed: 0.0493s/iter; left time: 1735.5720s
	iters: 300, epoch: 5 | loss: 1.5654706
	speed: 0.0493s/iter; left time: 1730.0835s
Epoch: 5 cost time: 18.760988473892212
Epoch: 5, Steps: 369 | Train Loss: 1.565 Vali Loss: 3.632 Vali Acc: 0.643 Test Loss: 3.632 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0271765
	speed: 0.1932s/iter; left time: 6755.0848s
	iters: 200, epoch: 6 | loss: 0.1192561
	speed: 0.0506s/iter; left time: 1762.8457s
	iters: 300, epoch: 6 | loss: 3.8730767
	speed: 0.0506s/iter; left time: 1759.9145s
Epoch: 6 cost time: 18.971071243286133
Epoch: 6, Steps: 369 | Train Loss: 1.422 Vali Loss: 4.162 Vali Acc: 0.638 Test Loss: 4.162 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2102093
	speed: 0.1937s/iter; left time: 6698.8187s
	iters: 200, epoch: 7 | loss: 0.3240571
	speed: 0.0501s/iter; left time: 1727.0164s
	iters: 300, epoch: 7 | loss: 1.0159419
	speed: 0.0497s/iter; left time: 1710.2088s
Epoch: 7 cost time: 18.99642539024353
Epoch: 7, Steps: 369 | Train Loss: 1.177 Vali Loss: 4.456 Vali Acc: 0.638 Test Loss: 4.456 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.3667227
	speed: 0.1991s/iter; left time: 6814.1992s
	iters: 200, epoch: 8 | loss: 0.3157202
	speed: 0.0494s/iter; left time: 1684.6058s
	iters: 300, epoch: 8 | loss: 2.1006143
	speed: 0.0495s/iter; left time: 1682.9526s
Epoch: 8 cost time: 18.773991346359253
Epoch: 8, Steps: 369 | Train Loss: 1.028 Vali Loss: 4.249 Vali Acc: 0.637 Test Loss: 4.249 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.4747519
	speed: 0.1951s/iter; left time: 6602.4906s
	iters: 200, epoch: 9 | loss: 0.7664019
	speed: 0.0507s/iter; left time: 1711.7920s
	iters: 300, epoch: 9 | loss: 1.5447319
	speed: 0.0495s/iter; left time: 1666.8296s
Epoch: 9 cost time: 19.07176399230957
Epoch: 9, Steps: 369 | Train Loss: 0.719 Vali Loss: 3.716 Vali Acc: 0.633 Test Loss: 3.716 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2384848
	speed: 0.2009s/iter; left time: 6727.6372s
	iters: 200, epoch: 10 | loss: 1.1434020
	speed: 0.0508s/iter; left time: 1694.1160s
	iters: 300, epoch: 10 | loss: 0.7075884
	speed: 0.0510s/iter; left time: 1698.6307s
Epoch: 10 cost time: 19.24646830558777
Epoch: 10, Steps: 369 | Train Loss: 0.504 Vali Loss: 3.802 Vali Acc: 0.655 Test Loss: 3.802 Test Acc: 0.655
Validation loss decreased (-0.648111 --> -0.655183).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3465555
	speed: 0.2000s/iter; left time: 6621.8259s
	iters: 200, epoch: 11 | loss: 0.3841753
	speed: 0.0381s/iter; left time: 1256.2303s
	iters: 300, epoch: 11 | loss: 0.3878022
	speed: 0.0444s/iter; left time: 1460.1481s
Epoch: 11 cost time: 16.946398735046387
Epoch: 11, Steps: 369 | Train Loss: 0.428 Vali Loss: 3.492 Vali Acc: 0.633 Test Loss: 3.492 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2021916
	speed: 0.1804s/iter; left time: 5907.9487s
	iters: 200, epoch: 12 | loss: 0.7160023
	speed: 0.0435s/iter; left time: 1418.8769s
	iters: 300, epoch: 12 | loss: 0.1774132
	speed: 0.0483s/iter; left time: 1572.3124s
Epoch: 12 cost time: 17.268538236618042
Epoch: 12, Steps: 369 | Train Loss: 0.316 Vali Loss: 3.164 Vali Acc: 0.639 Test Loss: 3.164 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6402468
	speed: 0.1808s/iter; left time: 5852.4447s
	iters: 200, epoch: 13 | loss: 0.1224583
	speed: 0.0444s/iter; left time: 1433.7450s
	iters: 300, epoch: 13 | loss: 0.3784134
	speed: 0.0446s/iter; left time: 1435.3404s
Epoch: 13 cost time: 17.035558223724365
Epoch: 13, Steps: 369 | Train Loss: 0.224 Vali Loss: 3.108 Vali Acc: 0.639 Test Loss: 3.108 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0252266
	speed: 0.1758s/iter; left time: 5626.0445s
	iters: 200, epoch: 14 | loss: 0.4941240
	speed: 0.0446s/iter; left time: 1424.0376s
	iters: 300, epoch: 14 | loss: 0.0058942
	speed: 0.0452s/iter; left time: 1436.2222s
Epoch: 14 cost time: 17.22256875038147
Epoch: 14, Steps: 369 | Train Loss: 0.179 Vali Loss: 2.862 Vali Acc: 0.657 Test Loss: 2.862 Test Acc: 0.657
Validation loss decreased (-0.655183 --> -0.656612).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1006035
	speed: 0.1777s/iter; left time: 5620.4044s
	iters: 200, epoch: 15 | loss: 0.0373351
	speed: 0.0445s/iter; left time: 1404.1600s
	iters: 300, epoch: 15 | loss: 0.0411233
	speed: 0.0422s/iter; left time: 1327.9467s
Epoch: 15 cost time: 16.579452514648438
Epoch: 15, Steps: 369 | Train Loss: 0.162 Vali Loss: 2.829 Vali Acc: 0.649 Test Loss: 2.829 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2508389
	speed: 0.1739s/iter; left time: 5437.8824s
	iters: 200, epoch: 16 | loss: 0.5855528
	speed: 0.0506s/iter; left time: 1578.4877s
	iters: 300, epoch: 16 | loss: 0.0081445
	speed: 0.0492s/iter; left time: 1527.3553s
Epoch: 16 cost time: 17.652743577957153
Epoch: 16, Steps: 369 | Train Loss: 0.119 Vali Loss: 2.733 Vali Acc: 0.657 Test Loss: 2.733 Test Acc: 0.657
Validation loss decreased (-0.656612 --> -0.656897).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0096277
	speed: 0.1984s/iter; left time: 6130.9390s
	iters: 200, epoch: 17 | loss: 0.2662787
	speed: 0.0496s/iter; left time: 1526.7738s
	iters: 300, epoch: 17 | loss: 0.0004292
	speed: 0.0491s/iter; left time: 1507.5422s
Epoch: 17 cost time: 18.81572914123535
Epoch: 17, Steps: 369 | Train Loss: 0.116 Vali Loss: 2.582 Vali Acc: 0.645 Test Loss: 2.582 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1251984
	speed: 0.2050s/iter; left time: 6259.4366s
	iters: 200, epoch: 18 | loss: 0.1793899
	speed: 0.0496s/iter; left time: 1508.4509s
	iters: 300, epoch: 18 | loss: 0.3692961
	speed: 0.0491s/iter; left time: 1489.1457s
Epoch: 18 cost time: 18.854060173034668
Epoch: 18, Steps: 369 | Train Loss: 0.097 Vali Loss: 2.611 Vali Acc: 0.644 Test Loss: 2.611 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0050560
	speed: 0.2018s/iter; left time: 6084.8994s
	iters: 200, epoch: 19 | loss: 0.0316046
	speed: 0.0504s/iter; left time: 1513.7621s
	iters: 300, epoch: 19 | loss: 0.4206738
	speed: 0.0504s/iter; left time: 1511.3826s
Epoch: 19 cost time: 19.18761372566223
Epoch: 19, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.644 Vali Acc: 0.642 Test Loss: 2.644 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0583802
	speed: 0.2049s/iter; left time: 6103.8277s
	iters: 200, epoch: 20 | loss: 0.2874307
	speed: 0.0521s/iter; left time: 1545.8756s
	iters: 300, epoch: 20 | loss: 0.3963369
	speed: 0.0512s/iter; left time: 1514.6352s
Epoch: 20 cost time: 19.512331247329712
Epoch: 20, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.566 Vali Acc: 0.656 Test Loss: 2.566 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0167874
	speed: 0.2001s/iter; left time: 5887.7014s
	iters: 200, epoch: 21 | loss: 0.0081887
	speed: 0.0510s/iter; left time: 1493.9577s
	iters: 300, epoch: 21 | loss: 0.0239531
	speed: 0.0508s/iter; left time: 1484.3836s
Epoch: 21 cost time: 19.367817640304565
Epoch: 21, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.614 Vali Acc: 0.651 Test Loss: 2.614 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0005253
	speed: 0.2042s/iter; left time: 5931.0186s
	iters: 200, epoch: 22 | loss: 0.0088965
	speed: 0.0508s/iter; left time: 1470.2038s
	iters: 300, epoch: 22 | loss: 0.0057112
	speed: 0.0505s/iter; left time: 1457.3517s
Epoch: 22 cost time: 19.36146831512451
Epoch: 22, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.679 Vali Acc: 0.652 Test Loss: 2.679 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0019695
	speed: 0.1890s/iter; left time: 5421.2811s
	iters: 200, epoch: 23 | loss: 0.0034960
	speed: 0.0431s/iter; left time: 1231.3316s
	iters: 300, epoch: 23 | loss: 0.0085208
	speed: 0.0449s/iter; left time: 1278.0979s
Epoch: 23 cost time: 16.931348085403442
Epoch: 23, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.612 Vali Acc: 0.648 Test Loss: 2.612 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0148031
	speed: 0.1818s/iter; left time: 5147.8545s
	iters: 200, epoch: 24 | loss: 0.3626168
	speed: 0.0449s/iter; left time: 1266.3233s
	iters: 300, epoch: 24 | loss: 0.0066940
	speed: 0.0441s/iter; left time: 1240.5276s
Epoch: 24 cost time: 17.141149044036865
Epoch: 24, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.628 Vali Acc: 0.644 Test Loss: 2.628 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0040567
	speed: 0.1795s/iter; left time: 5015.3212s
	iters: 200, epoch: 25 | loss: 0.0004140
	speed: 0.0455s/iter; left time: 1265.8121s
	iters: 300, epoch: 25 | loss: 0.4530720
	speed: 0.0378s/iter; left time: 1049.1930s
Epoch: 25 cost time: 16.422091960906982
Epoch: 25, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.615 Vali Acc: 0.638 Test Loss: 2.615 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0233766
	speed: 0.1823s/iter; left time: 5025.8491s
	iters: 200, epoch: 26 | loss: 0.0341552
	speed: 0.0459s/iter; left time: 1260.6289s
	iters: 300, epoch: 26 | loss: 0.0001563
	speed: 0.0447s/iter; left time: 1223.3653s
Epoch: 26 cost time: 17.390743494033813
Epoch: 26, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.628 Vali Acc: 0.661 Test Loss: 2.628 Test Acc: 0.661
Validation loss decreased (-0.656897 --> -0.660870).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0005096
	speed: 0.1804s/iter; left time: 4907.3200s
	iters: 200, epoch: 27 | loss: 0.0037987
	speed: 0.0447s/iter; left time: 1212.4241s
	iters: 300, epoch: 27 | loss: 0.0004480
	speed: 0.0443s/iter; left time: 1195.5773s
Epoch: 27 cost time: 17.140323162078857
Epoch: 27, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.622 Vali Acc: 0.652 Test Loss: 2.622 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0183698
	speed: 0.1924s/iter; left time: 5162.6901s
	iters: 200, epoch: 28 | loss: 0.2532653
	speed: 0.0500s/iter; left time: 1337.7017s
	iters: 300, epoch: 28 | loss: 0.0369521
	speed: 0.0495s/iter; left time: 1318.3426s
Epoch: 28 cost time: 19.076055765151978
Epoch: 28, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.704 Vali Acc: 0.659 Test Loss: 2.704 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0006489
	speed: 0.2032s/iter; left time: 5379.7738s
	iters: 200, epoch: 29 | loss: 0.0022655
	speed: 0.0496s/iter; left time: 1308.4447s
	iters: 300, epoch: 29 | loss: 0.0213233
	speed: 0.0502s/iter; left time: 1319.6897s
Epoch: 29 cost time: 19.023274660110474
Epoch: 29, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.748 Vali Acc: 0.650 Test Loss: 2.748 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.2668183
	speed: 0.2027s/iter; left time: 5291.1549s
	iters: 200, epoch: 30 | loss: 0.0758553
	speed: 0.0506s/iter; left time: 1316.6001s
	iters: 300, epoch: 30 | loss: 0.0004332
	speed: 0.0497s/iter; left time: 1288.3357s
Epoch: 30 cost time: 19.120023250579834
Epoch: 30, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.808 Vali Acc: 0.643 Test Loss: 2.808 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0156966
	speed: 0.2044s/iter; left time: 5259.0488s
	iters: 200, epoch: 31 | loss: 0.0127661
	speed: 0.0509s/iter; left time: 1305.2095s
	iters: 300, epoch: 31 | loss: 0.0004859
	speed: 0.0514s/iter; left time: 1312.8298s
Epoch: 31 cost time: 19.589625597000122
Epoch: 31, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.868 Vali Acc: 0.644 Test Loss: 2.868 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0019212
	speed: 0.2003s/iter; left time: 5078.7732s
	iters: 200, epoch: 32 | loss: 0.0010957
	speed: 0.0521s/iter; left time: 1316.2637s
	iters: 300, epoch: 32 | loss: 0.0127814
	speed: 0.0514s/iter; left time: 1293.1033s
Epoch: 32 cost time: 19.633359909057617
Epoch: 32, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.856 Vali Acc: 0.645 Test Loss: 2.856 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0492194
	speed: 0.2073s/iter; left time: 5182.0374s
	iters: 200, epoch: 33 | loss: 0.0004399
	speed: 0.0521s/iter; left time: 1297.3792s
	iters: 300, epoch: 33 | loss: 0.0003472
	speed: 0.0521s/iter; left time: 1291.0741s
Epoch: 33 cost time: 19.77703070640564
Epoch: 33, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.835 Vali Acc: 0.662 Test Loss: 2.835 Test Acc: 0.662
Validation loss decreased (-0.660870 --> -0.661720).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0112181
	speed: 0.2003s/iter; left time: 4931.1934s
	iters: 200, epoch: 34 | loss: 0.1049612
	speed: 0.0519s/iter; left time: 1273.7274s
	iters: 300, epoch: 34 | loss: 0.0027019
	speed: 0.0508s/iter; left time: 1240.9480s
Epoch: 34 cost time: 19.478152751922607
Epoch: 34, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.751 Vali Acc: 0.648 Test Loss: 2.751 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0025965
	speed: 0.1830s/iter; left time: 4438.8521s
	iters: 200, epoch: 35 | loss: 0.0109731
	speed: 0.0462s/iter; left time: 1116.6727s
	iters: 300, epoch: 35 | loss: 0.0134510
	speed: 0.0464s/iter; left time: 1116.7948s
Epoch: 35 cost time: 17.368717908859253
Epoch: 35, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.823 Vali Acc: 0.644 Test Loss: 2.823 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0079704
	speed: 0.1821s/iter; left time: 4349.5443s
	iters: 200, epoch: 36 | loss: 0.0046076
	speed: 0.0450s/iter; left time: 1069.7758s
	iters: 300, epoch: 36 | loss: 0.0017002
	speed: 0.0442s/iter; left time: 1046.6284s
Epoch: 36 cost time: 17.095863819122314
Epoch: 36, Steps: 369 | Train Loss: 0.046 Vali Loss: 2.968 Vali Acc: 0.641 Test Loss: 2.968 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0152331
	speed: 0.1707s/iter; left time: 4013.7616s
	iters: 200, epoch: 37 | loss: 0.0051622
	speed: 0.0452s/iter; left time: 1057.6405s
	iters: 300, epoch: 37 | loss: 0.1949580
	speed: 0.0438s/iter; left time: 1021.1518s
Epoch: 37 cost time: 16.257390022277832
Epoch: 37, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.863 Vali Acc: 0.630 Test Loss: 2.863 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0002918
	speed: 0.1829s/iter; left time: 4233.4857s
	iters: 200, epoch: 38 | loss: 0.0085055
	speed: 0.0437s/iter; left time: 1007.6658s
	iters: 300, epoch: 38 | loss: 0.0489661
	speed: 0.0429s/iter; left time: 984.2415s
Epoch: 38 cost time: 16.562220096588135
Epoch: 38, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.793 Vali Acc: 0.646 Test Loss: 2.793 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0003617
	speed: 0.1806s/iter; left time: 4113.8861s
	iters: 200, epoch: 39 | loss: 0.0001516
	speed: 0.0448s/iter; left time: 1015.4070s
	iters: 300, epoch: 39 | loss: 0.0140306
	speed: 0.0449s/iter; left time: 1013.3004s
Epoch: 39 cost time: 16.692744970321655
Epoch: 39, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.777 Vali Acc: 0.636 Test Loss: 2.777 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0979106
	speed: 0.1907s/iter; left time: 4273.2992s
	iters: 200, epoch: 40 | loss: 0.0714004
	speed: 0.0506s/iter; left time: 1128.2706s
	iters: 300, epoch: 40 | loss: 0.0104430
	speed: 0.0502s/iter; left time: 1114.8810s
Epoch: 40 cost time: 19.30708599090576
Epoch: 40, Steps: 369 | Train Loss: 0.029 Vali Loss: 2.936 Vali Acc: 0.647 Test Loss: 2.936 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0164888
	speed: 0.1989s/iter; left time: 4383.5763s
	iters: 200, epoch: 41 | loss: 0.0002464
	speed: 0.0496s/iter; left time: 1087.4080s
	iters: 300, epoch: 41 | loss: 0.0209537
	speed: 0.0498s/iter; left time: 1088.5103s
Epoch: 41 cost time: 18.976603984832764
Epoch: 41, Steps: 369 | Train Loss: 0.049 Vali Loss: 3.003 Vali Acc: 0.646 Test Loss: 3.003 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0010304
	speed: 0.2047s/iter; left time: 4437.0242s
	iters: 200, epoch: 42 | loss: 0.0002121
	speed: 0.0501s/iter; left time: 1081.2198s
	iters: 300, epoch: 42 | loss: 0.0251304
	speed: 0.0510s/iter; left time: 1095.4844s
Epoch: 42 cost time: 19.414723873138428
Epoch: 42, Steps: 369 | Train Loss: 0.037 Vali Loss: 2.878 Vali Acc: 0.651 Test Loss: 2.878 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0026901
	speed: 0.1987s/iter; left time: 4233.2889s
	iters: 200, epoch: 43 | loss: 0.4258160
	speed: 0.0509s/iter; left time: 1079.0571s
	iters: 300, epoch: 43 | loss: 0.0001562
	speed: 0.0512s/iter; left time: 1080.9694s
Epoch: 43 cost time: 19.416531324386597
Epoch: 43, Steps: 369 | Train Loss: 0.038 Vali Loss: 3.082 Vali Acc: 0.642 Test Loss: 3.082 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6617480136208853
model parameter : 200322
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.6714120
	speed: 0.0616s/iter; left time: 2267.8456s
	iters: 200, epoch: 1 | loss: 1.4210627
	speed: 0.0469s/iter; left time: 1719.9095s
	iters: 300, epoch: 1 | loss: 1.3010873
	speed: 0.0472s/iter; left time: 1728.8358s
Epoch: 1 cost time: 18.88470482826233
Epoch: 1, Steps: 369 | Train Loss: 1.148 Vali Loss: 1.502 Vali Acc: 0.647 Test Loss: 1.502 Test Acc: 0.647
Validation loss decreased (inf --> -0.646977).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3401738
	speed: 0.1866s/iter; left time: 6797.3142s
	iters: 200, epoch: 2 | loss: 1.3020039
	speed: 0.0374s/iter; left time: 1357.4390s
	iters: 300, epoch: 2 | loss: 3.4631050
	speed: 0.0414s/iter; left time: 1500.5606s
Epoch: 2 cost time: 15.339932441711426
Epoch: 2, Steps: 369 | Train Loss: 1.086 Vali Loss: 1.595 Vali Acc: 0.642 Test Loss: 1.595 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9248369
	speed: 0.1667s/iter; left time: 6012.5023s
	iters: 200, epoch: 3 | loss: 0.6559218
	speed: 0.0419s/iter; left time: 1508.2953s
	iters: 300, epoch: 3 | loss: 2.7715871
	speed: 0.0408s/iter; left time: 1463.8809s
Epoch: 3 cost time: 15.590466976165771
Epoch: 3, Steps: 369 | Train Loss: 1.365 Vali Loss: 2.238 Vali Acc: 0.644 Test Loss: 2.238 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.0883911
	speed: 0.1665s/iter; left time: 5944.1463s
	iters: 200, epoch: 4 | loss: 1.0469701
	speed: 0.0385s/iter; left time: 1368.6728s
	iters: 300, epoch: 4 | loss: 1.3124115
	speed: 0.0384s/iter; left time: 1364.1452s
Epoch: 4 cost time: 14.537883043289185
Epoch: 4, Steps: 369 | Train Loss: 1.452 Vali Loss: 2.667 Vali Acc: 0.651 Test Loss: 2.667 Test Acc: 0.651
Validation loss decreased (-0.646977 --> -0.650654).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6648367
	speed: 0.1601s/iter; left time: 5654.8549s
	iters: 200, epoch: 5 | loss: 1.0721382
	speed: 0.0384s/iter; left time: 1351.0148s
	iters: 300, epoch: 5 | loss: 0.4950009
	speed: 0.0362s/iter; left time: 1270.9466s
Epoch: 5 cost time: 14.644256830215454
Epoch: 5, Steps: 369 | Train Loss: 1.352 Vali Loss: 2.848 Vali Acc: 0.648 Test Loss: 2.848 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2950874
	speed: 0.1668s/iter; left time: 5828.9284s
	iters: 200, epoch: 6 | loss: 1.0394053
	speed: 0.0385s/iter; left time: 1341.0065s
	iters: 300, epoch: 6 | loss: 0.9096174
	speed: 0.0385s/iter; left time: 1336.8806s
Epoch: 6 cost time: 14.848963499069214
Epoch: 6, Steps: 369 | Train Loss: 1.260 Vali Loss: 3.280 Vali Acc: 0.634 Test Loss: 3.280 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3405056
	speed: 0.1662s/iter; left time: 5749.7901s
	iters: 200, epoch: 7 | loss: 0.0227082
	speed: 0.0405s/iter; left time: 1396.3943s
	iters: 300, epoch: 7 | loss: 1.0757060
	speed: 0.0293s/iter; left time: 1008.6408s
Epoch: 7 cost time: 14.389993906021118
Epoch: 7, Steps: 369 | Train Loss: 0.979 Vali Loss: 3.542 Vali Acc: 0.628 Test Loss: 3.542 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5796479
	speed: 0.1858s/iter; left time: 6359.3718s
	iters: 200, epoch: 8 | loss: 0.5758878
	speed: 0.0456s/iter; left time: 1555.3752s
	iters: 300, epoch: 8 | loss: 0.0275083
	speed: 0.0452s/iter; left time: 1537.8659s
Epoch: 8 cost time: 17.226736068725586
Epoch: 8, Steps: 369 | Train Loss: 0.748 Vali Loss: 3.813 Vali Acc: 0.635 Test Loss: 3.813 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6322948
	speed: 0.1905s/iter; left time: 6447.8508s
	iters: 200, epoch: 9 | loss: 0.0343788
	speed: 0.0459s/iter; left time: 1547.8725s
	iters: 300, epoch: 9 | loss: 0.4872897
	speed: 0.0447s/iter; left time: 1504.7436s
Epoch: 9 cost time: 17.154085636138916
Epoch: 9, Steps: 369 | Train Loss: 0.666 Vali Loss: 3.545 Vali Acc: 0.651 Test Loss: 3.545 Test Acc: 0.651
Validation loss decreased (-0.650654 --> -0.651213).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0010568
	speed: 0.1844s/iter; left time: 6173.9741s
	iters: 200, epoch: 10 | loss: 1.2618682
	speed: 0.0461s/iter; left time: 1537.9174s
	iters: 300, epoch: 10 | loss: 0.4127353
	speed: 0.0453s/iter; left time: 1508.8987s
Epoch: 10 cost time: 17.415460109710693
Epoch: 10, Steps: 369 | Train Loss: 0.475 Vali Loss: 3.558 Vali Acc: 0.648 Test Loss: 3.558 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7256917
	speed: 0.1903s/iter; left time: 6300.0360s
	iters: 200, epoch: 11 | loss: 0.7950439
	speed: 0.0459s/iter; left time: 1516.3440s
	iters: 300, epoch: 11 | loss: 0.3758120
	speed: 0.0461s/iter; left time: 1517.2136s
Epoch: 11 cost time: 17.57785940170288
Epoch: 11, Steps: 369 | Train Loss: 0.394 Vali Loss: 3.534 Vali Acc: 0.634 Test Loss: 3.534 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3040681
	speed: 0.1850s/iter; left time: 6057.3321s
	iters: 200, epoch: 12 | loss: 0.0572499
	speed: 0.0459s/iter; left time: 1499.8228s
	iters: 300, epoch: 12 | loss: 0.4483495
	speed: 0.0456s/iter; left time: 1484.7582s
Epoch: 12 cost time: 17.442442655563354
Epoch: 12, Steps: 369 | Train Loss: 0.325 Vali Loss: 3.129 Vali Acc: 0.636 Test Loss: 3.129 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1098967
	speed: 0.1931s/iter; left time: 6250.1016s
	iters: 200, epoch: 13 | loss: 0.0778591
	speed: 0.0459s/iter; left time: 1480.5245s
	iters: 300, epoch: 13 | loss: 0.0025687
	speed: 0.0462s/iter; left time: 1486.7483s
Epoch: 13 cost time: 17.636680364608765
Epoch: 13, Steps: 369 | Train Loss: 0.256 Vali Loss: 3.000 Vali Acc: 0.641 Test Loss: 3.000 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1253570
	speed: 0.1856s/iter; left time: 5940.4958s
	iters: 200, epoch: 14 | loss: 0.1247197
	speed: 0.0459s/iter; left time: 1463.4289s
	iters: 300, epoch: 14 | loss: 0.6267811
	speed: 0.0460s/iter; left time: 1461.9994s
Epoch: 14 cost time: 17.526983737945557
Epoch: 14, Steps: 369 | Train Loss: 0.214 Vali Loss: 2.992 Vali Acc: 0.636 Test Loss: 2.992 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0138947
	speed: 0.1601s/iter; left time: 5065.7685s
	iters: 200, epoch: 15 | loss: 0.0313955
	speed: 0.0443s/iter; left time: 1397.4773s
	iters: 300, epoch: 15 | loss: 0.0387145
	speed: 0.0420s/iter; left time: 1321.1075s
Epoch: 15 cost time: 15.897957801818848
Epoch: 15, Steps: 369 | Train Loss: 0.164 Vali Loss: 2.806 Vali Acc: 0.638 Test Loss: 2.806 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1114594
	speed: 0.1666s/iter; left time: 5209.7058s
	iters: 200, epoch: 16 | loss: 0.0489829
	speed: 0.0421s/iter; left time: 1313.4686s
	iters: 300, epoch: 16 | loss: 0.0627570
	speed: 0.0405s/iter; left time: 1256.7074s
Epoch: 16 cost time: 15.412893772125244
Epoch: 16, Steps: 369 | Train Loss: 0.153 Vali Loss: 2.885 Vali Acc: 0.642 Test Loss: 2.885 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0808880
	speed: 0.1615s/iter; left time: 4990.5519s
	iters: 200, epoch: 17 | loss: 0.3885237
	speed: 0.0319s/iter; left time: 983.2515s
	iters: 300, epoch: 17 | loss: 0.0082042
	speed: 0.0396s/iter; left time: 1214.1276s
Epoch: 17 cost time: 14.01372742652893
Epoch: 17, Steps: 369 | Train Loss: 0.114 Vali Loss: 2.761 Vali Acc: 0.644 Test Loss: 2.761 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0089418
	speed: 0.1622s/iter; left time: 4951.0307s
	iters: 200, epoch: 18 | loss: 0.1519466
	speed: 0.0404s/iter; left time: 1228.3461s
	iters: 300, epoch: 18 | loss: 0.0650417
	speed: 0.0402s/iter; left time: 1220.0416s
Epoch: 18 cost time: 15.027079820632935
Epoch: 18, Steps: 369 | Train Loss: 0.110 Vali Loss: 2.704 Vali Acc: 0.642 Test Loss: 2.704 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1528762
	speed: 0.1647s/iter; left time: 4968.6790s
	iters: 200, epoch: 19 | loss: 0.2260092
	speed: 0.0372s/iter; left time: 1117.4827s
	iters: 300, epoch: 19 | loss: 0.0313163
	speed: 0.0361s/iter; left time: 1082.1581s
Epoch: 19 cost time: 14.369758367538452
Epoch: 19, Steps: 369 | Train Loss: 0.101 Vali Loss: 2.942 Vali Acc: 0.650 Test Loss: 2.942 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6512485811577753
model parameter : 163650
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2439760
	speed: 0.2212s/iter; left time: 8140.5251s
	iters: 200, epoch: 1 | loss: 12.7298307
	speed: 0.2054s/iter; left time: 7539.3134s
	iters: 300, epoch: 1 | loss: 3.4607396
	speed: 0.2056s/iter; left time: 7526.0909s
Epoch: 1 cost time: 77.14996576309204
Epoch: 1, Steps: 369 | Train Loss: 4.428 Vali Loss: 1.897 Vali Acc: 0.639 Test Loss: 1.897 Test Acc: 0.639
Validation loss decreased (inf --> -0.639311).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9820236
	speed: 0.7084s/iter; left time: 25808.0039s
	iters: 200, epoch: 2 | loss: 2.5431631
	speed: 0.1989s/iter; left time: 7225.7156s
	iters: 300, epoch: 2 | loss: 4.2957115
	speed: 0.2007s/iter; left time: 7271.3236s
Epoch: 2 cost time: 74.42309331893921
Epoch: 2, Steps: 369 | Train Loss: 3.262 Vali Loss: 3.618 Vali Acc: 0.652 Test Loss: 3.618 Test Acc: 0.652
Validation loss decreased (-0.639311 --> -0.651780).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0163541
	speed: 0.6456s/iter; left time: 23282.0303s
	iters: 200, epoch: 3 | loss: 9.0744019
	speed: 0.1785s/iter; left time: 6420.8520s
	iters: 300, epoch: 3 | loss: 3.6135454
	speed: 0.1695s/iter; left time: 6078.4755s
Epoch: 3 cost time: 64.00293397903442
Epoch: 3, Steps: 369 | Train Loss: 4.522 Vali Loss: 5.690 Vali Acc: 0.662 Test Loss: 5.690 Test Acc: 0.662
Validation loss decreased (-0.651780 --> -0.661691).  Saving model ...
	iters: 100, epoch: 4 | loss: 8.8992195
	speed: 0.6104s/iter; left time: 21789.0549s
	iters: 200, epoch: 4 | loss: 0.8647113
	speed: 0.1673s/iter; left time: 5953.8681s
	iters: 300, epoch: 4 | loss: 3.4240751
	speed: 0.1762s/iter; left time: 6254.4481s
Epoch: 4 cost time: 63.85187840461731
Epoch: 4, Steps: 369 | Train Loss: 4.853 Vali Loss: 6.969 Vali Acc: 0.646 Test Loss: 6.969 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1449192
	speed: 0.6789s/iter; left time: 23980.8411s
	iters: 200, epoch: 5 | loss: 2.4675145
	speed: 0.1969s/iter; left time: 6937.3834s
	iters: 300, epoch: 5 | loss: 9.3982525
	speed: 0.2039s/iter; left time: 7163.6960s
Epoch: 5 cost time: 74.47937083244324
Epoch: 5, Steps: 369 | Train Loss: 4.533 Vali Loss: 9.203 Vali Acc: 0.629 Test Loss: 9.203 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9092658
	speed: 0.6932s/iter; left time: 24230.0941s
	iters: 200, epoch: 6 | loss: 5.6801195
	speed: 0.1957s/iter; left time: 6820.6520s
	iters: 300, epoch: 6 | loss: 1.4439940
	speed: 0.1938s/iter; left time: 6735.5770s
Epoch: 6 cost time: 72.53083395957947
Epoch: 6, Steps: 369 | Train Loss: 3.744 Vali Loss: 10.242 Vali Acc: 0.647 Test Loss: 10.242 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000006
	speed: 0.6448s/iter; left time: 22301.6529s
	iters: 200, epoch: 7 | loss: 5.1955872
	speed: 0.1716s/iter; left time: 5916.9257s
	iters: 300, epoch: 7 | loss: 2.5976331
	speed: 0.1708s/iter; left time: 5874.6440s
Epoch: 7 cost time: 63.569457054138184
Epoch: 7, Steps: 369 | Train Loss: 3.308 Vali Loss: 11.729 Vali Acc: 0.632 Test Loss: 11.729 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.2738166
	speed: 0.6117s/iter; left time: 20929.5935s
	iters: 200, epoch: 8 | loss: 4.6370149
	speed: 0.1733s/iter; left time: 5912.3139s
	iters: 300, epoch: 8 | loss: 4.0499430
	speed: 0.1753s/iter; left time: 5962.1034s
Epoch: 8 cost time: 63.94750905036926
Epoch: 8, Steps: 369 | Train Loss: 2.207 Vali Loss: 11.707 Vali Acc: 0.640 Test Loss: 11.707 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.1376119
	speed: 0.6643s/iter; left time: 22485.8626s
	iters: 200, epoch: 9 | loss: 4.1835022
	speed: 0.1938s/iter; left time: 6541.6792s
	iters: 300, epoch: 9 | loss: 0.0089502
	speed: 0.1928s/iter; left time: 6486.0291s
Epoch: 9 cost time: 72.05213069915771
Epoch: 9, Steps: 369 | Train Loss: 1.698 Vali Loss: 12.096 Vali Acc: 0.643 Test Loss: 12.096 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6494661
	speed: 0.6927s/iter; left time: 23192.6457s
	iters: 200, epoch: 10 | loss: 3.3705616
	speed: 0.1984s/iter; left time: 6622.2460s
	iters: 300, epoch: 10 | loss: 1.9868544
	speed: 0.2005s/iter; left time: 6673.8356s
Epoch: 10 cost time: 73.86633849143982
Epoch: 10, Steps: 369 | Train Loss: 1.142 Vali Loss: 10.679 Vali Acc: 0.632 Test Loss: 10.679 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6856313
	speed: 0.6615s/iter; left time: 21904.2351s
	iters: 200, epoch: 11 | loss: 0.4721587
	speed: 0.1757s/iter; left time: 5798.8999s
	iters: 300, epoch: 11 | loss: 1.0098672
	speed: 0.1690s/iter; left time: 5561.9847s
Epoch: 11 cost time: 63.67458915710449
Epoch: 11, Steps: 369 | Train Loss: 0.747 Vali Loss: 10.822 Vali Acc: 0.634 Test Loss: 10.822 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000275
	speed: 0.6106s/iter; left time: 19990.7722s
	iters: 200, epoch: 12 | loss: 0.2190455
	speed: 0.1747s/iter; left time: 5703.1153s
	iters: 300, epoch: 12 | loss: 0.9189325
	speed: 0.1728s/iter; left time: 5622.5524s
Epoch: 12 cost time: 65.09556913375854
Epoch: 12, Steps: 369 | Train Loss: 0.518 Vali Loss: 9.537 Vali Acc: 0.634 Test Loss: 9.537 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4651670
	speed: 0.6581s/iter; left time: 21306.0387s
	iters: 200, epoch: 13 | loss: 0.8975554
	speed: 0.1936s/iter; left time: 6249.4559s
	iters: 300, epoch: 13 | loss: 1.4545498
	speed: 0.1934s/iter; left time: 6220.7269s
Epoch: 13 cost time: 72.47077775001526
Epoch: 13, Steps: 369 | Train Loss: 0.459 Vali Loss: 8.281 Vali Acc: 0.628 Test Loss: 8.281 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6617480136208853
model parameter : 1168258
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.1028819
	speed: 0.1299s/iter; left time: 4781.7120s
	iters: 200, epoch: 1 | loss: 3.1750045
	speed: 0.1139s/iter; left time: 4179.1419s
	iters: 300, epoch: 1 | loss: 1.8872491
	speed: 0.1138s/iter; left time: 4164.5957s
Epoch: 1 cost time: 43.66111660003662
Epoch: 1, Steps: 369 | Train Loss: 2.652 Vali Loss: 1.819 Vali Acc: 0.622 Test Loss: 1.819 Test Acc: 0.622
Validation loss decreased (inf --> -0.622286).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7712269
	speed: 0.4025s/iter; left time: 14664.7300s
	iters: 200, epoch: 2 | loss: 1.5643257
	speed: 0.0986s/iter; left time: 3581.8711s
	iters: 300, epoch: 2 | loss: 2.0562003
	speed: 0.0992s/iter; left time: 3594.6907s
Epoch: 2 cost time: 37.00498580932617
Epoch: 2, Steps: 369 | Train Loss: 2.260 Vali Loss: 2.589 Vali Acc: 0.651 Test Loss: 2.589 Test Acc: 0.651
Validation loss decreased (-0.622286 --> -0.650655).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6339720
	speed: 0.3779s/iter; left time: 13628.0244s
	iters: 200, epoch: 3 | loss: 3.2107763
	speed: 0.0904s/iter; left time: 3249.4726s
	iters: 300, epoch: 3 | loss: 5.4268737
	speed: 0.0971s/iter; left time: 3481.9880s
Epoch: 3 cost time: 35.55708193778992
Epoch: 3, Steps: 369 | Train Loss: 3.093 Vali Loss: 5.173 Vali Acc: 0.637 Test Loss: 5.173 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1574612
	speed: 0.3790s/iter; left time: 13528.3291s
	iters: 200, epoch: 4 | loss: 4.5675640
	speed: 0.1000s/iter; left time: 3558.4551s
	iters: 300, epoch: 4 | loss: 3.2472992
	speed: 0.0995s/iter; left time: 3530.6393s
Epoch: 4 cost time: 37.0515353679657
Epoch: 4, Steps: 369 | Train Loss: 3.563 Vali Loss: 5.323 Vali Acc: 0.653 Test Loss: 5.323 Test Acc: 0.653
Validation loss decreased (-0.650655 --> -0.652614).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2824514
	speed: 0.4274s/iter; left time: 15098.7338s
	iters: 200, epoch: 5 | loss: 10.5608788
	speed: 0.1127s/iter; left time: 3970.9101s
	iters: 300, epoch: 5 | loss: 2.5581217
	speed: 0.1117s/iter; left time: 3923.4908s
Epoch: 5 cost time: 42.80346941947937
Epoch: 5, Steps: 369 | Train Loss: 3.385 Vali Loss: 6.148 Vali Acc: 0.631 Test Loss: 6.148 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4804817
	speed: 0.4407s/iter; left time: 15404.7689s
	iters: 200, epoch: 6 | loss: 5.7142711
	speed: 0.1133s/iter; left time: 3950.3515s
	iters: 300, epoch: 6 | loss: 3.3477762
	speed: 0.1141s/iter; left time: 3966.8783s
Epoch: 6 cost time: 42.55612635612488
Epoch: 6, Steps: 369 | Train Loss: 3.235 Vali Loss: 6.788 Vali Acc: 0.626 Test Loss: 6.788 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1794500
	speed: 0.4329s/iter; left time: 14971.1145s
	iters: 200, epoch: 7 | loss: 1.5998623
	speed: 0.1121s/iter; left time: 3865.6425s
	iters: 300, epoch: 7 | loss: 0.2994180
	speed: 0.1141s/iter; left time: 3923.8620s
Epoch: 7 cost time: 42.09569478034973
Epoch: 7, Steps: 369 | Train Loss: 2.375 Vali Loss: 6.500 Vali Acc: 0.641 Test Loss: 6.500 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0002383
	speed: 0.4301s/iter; left time: 14718.2494s
	iters: 200, epoch: 8 | loss: 7.7283792
	speed: 0.0932s/iter; left time: 3178.3436s
	iters: 300, epoch: 8 | loss: 2.9733088
	speed: 0.0994s/iter; left time: 3381.5950s
Epoch: 8 cost time: 37.697407484054565
Epoch: 8, Steps: 369 | Train Loss: 1.731 Vali Loss: 6.801 Vali Acc: 0.637 Test Loss: 6.801 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.6985902
	speed: 0.3805s/iter; left time: 12879.3510s
	iters: 200, epoch: 9 | loss: 1.3864663
	speed: 0.0968s/iter; left time: 3267.0197s
	iters: 300, epoch: 9 | loss: 0.8765985
	speed: 0.0935s/iter; left time: 3147.0723s
Epoch: 9 cost time: 35.60110282897949
Epoch: 9, Steps: 369 | Train Loss: 1.220 Vali Loss: 5.054 Vali Acc: 0.631 Test Loss: 5.054 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3011015
	speed: 0.3799s/iter; left time: 12717.6949s
	iters: 200, epoch: 10 | loss: 1.2157956
	speed: 0.0991s/iter; left time: 3309.4713s
	iters: 300, epoch: 10 | loss: 0.0505119
	speed: 0.1003s/iter; left time: 3337.6089s
Epoch: 10 cost time: 37.54484176635742
Epoch: 10, Steps: 369 | Train Loss: 0.863 Vali Loss: 5.348 Vali Acc: 0.629 Test Loss: 5.348 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0312111
	speed: 0.4157s/iter; left time: 13765.0885s
	iters: 200, epoch: 11 | loss: 0.0000283
	speed: 0.1155s/iter; left time: 3811.3222s
	iters: 300, epoch: 11 | loss: 0.2442321
	speed: 0.1164s/iter; left time: 3830.7179s
Epoch: 11 cost time: 43.38883590698242
Epoch: 11, Steps: 369 | Train Loss: 0.515 Vali Loss: 3.450 Vali Acc: 0.637 Test Loss: 3.450 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0012574
	speed: 0.4388s/iter; left time: 14368.5267s
	iters: 200, epoch: 12 | loss: 0.4272717
	speed: 0.1146s/iter; left time: 3739.1568s
	iters: 300, epoch: 12 | loss: 0.1070117
	speed: 0.1141s/iter; left time: 3712.0341s
Epoch: 12 cost time: 42.66636395454407
Epoch: 12, Steps: 369 | Train Loss: 0.323 Vali Loss: 3.059 Vali Acc: 0.641 Test Loss: 3.059 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0111623
	speed: 0.4396s/iter; left time: 14232.4074s
	iters: 200, epoch: 13 | loss: 0.0947412
	speed: 0.1121s/iter; left time: 3616.7030s
	iters: 300, epoch: 13 | loss: 0.1068095
	speed: 0.1110s/iter; left time: 3569.8265s
Epoch: 13 cost time: 41.740917921066284
Epoch: 13, Steps: 369 | Train Loss: 0.172 Vali Loss: 2.645 Vali Acc: 0.638 Test Loss: 2.645 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0040978
	speed: 0.4304s/iter; left time: 13775.7834s
	iters: 200, epoch: 14 | loss: 0.0277441
	speed: 0.1145s/iter; left time: 3653.3991s
	iters: 300, epoch: 14 | loss: 0.0088743
	speed: 0.0957s/iter; left time: 3044.2263s
Epoch: 14 cost time: 39.18029761314392
Epoch: 14, Steps: 369 | Train Loss: 0.113 Vali Loss: 2.368 Vali Acc: 0.653 Test Loss: 2.368 Test Acc: 0.653
Validation loss decreased (-0.652614 --> -0.652644).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0119907
	speed: 0.3818s/iter; left time: 12079.7841s
	iters: 200, epoch: 15 | loss: 0.0139913
	speed: 0.0974s/iter; left time: 3072.0303s
	iters: 300, epoch: 15 | loss: 0.0103582
	speed: 0.0994s/iter; left time: 3123.6332s
Epoch: 15 cost time: 36.81967329978943
Epoch: 15, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.319 Vali Acc: 0.644 Test Loss: 2.319 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1601612
	speed: 0.3823s/iter; left time: 11952.7569s
	iters: 200, epoch: 16 | loss: 0.0029667
	speed: 0.0968s/iter; left time: 3015.7005s
	iters: 300, epoch: 16 | loss: 0.0001611
	speed: 0.1001s/iter; left time: 3108.3320s
Epoch: 16 cost time: 36.97342538833618
Epoch: 16, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.678 Vali Acc: 0.634 Test Loss: 2.678 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0004838
	speed: 0.3975s/iter; left time: 12281.1797s
	iters: 200, epoch: 17 | loss: 0.0029058
	speed: 0.1128s/iter; left time: 3474.6046s
	iters: 300, epoch: 17 | loss: 0.0227400
	speed: 0.1135s/iter; left time: 3484.6093s
Epoch: 17 cost time: 42.34576082229614
Epoch: 17, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.644 Vali Acc: 0.643 Test Loss: 2.644 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0944695
	speed: 0.4403s/iter; left time: 13442.5486s
	iters: 200, epoch: 18 | loss: 0.0020541
	speed: 0.1139s/iter; left time: 3466.1374s
	iters: 300, epoch: 18 | loss: 0.0059578
	speed: 0.1136s/iter; left time: 3446.5582s
Epoch: 18 cost time: 42.65090227127075
Epoch: 18, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.454 Vali Acc: 0.638 Test Loss: 2.454 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0008346
	speed: 0.4366s/iter; left time: 13167.6628s
	iters: 200, epoch: 19 | loss: 0.2683303
	speed: 0.1120s/iter; left time: 3365.2562s
	iters: 300, epoch: 19 | loss: 0.0032167
	speed: 0.1114s/iter; left time: 3337.9776s
Epoch: 19 cost time: 41.96171259880066
Epoch: 19, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.565 Vali Acc: 0.638 Test Loss: 2.565 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0200170
	speed: 0.4367s/iter; left time: 13009.2354s
	iters: 200, epoch: 20 | loss: 0.5396916
	speed: 0.1125s/iter; left time: 3339.9536s
	iters: 300, epoch: 20 | loss: 0.0077451
	speed: 0.1121s/iter; left time: 3317.9406s
Epoch: 20 cost time: 41.35769319534302
Epoch: 20, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.579 Vali Acc: 0.641 Test Loss: 2.579 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0530547
	speed: 0.3960s/iter; left time: 11649.6893s
	iters: 200, epoch: 21 | loss: 0.0018603
	speed: 0.1014s/iter; left time: 2972.6033s
	iters: 300, epoch: 21 | loss: 0.0822527
	speed: 0.1010s/iter; left time: 2951.8658s
Epoch: 21 cost time: 38.17653942108154
Epoch: 21, Steps: 369 | Train Loss: 0.044 Vali Loss: 2.796 Vali Acc: 0.638 Test Loss: 2.796 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0017305
	speed: 0.3892s/iter; left time: 11305.7104s
	iters: 200, epoch: 22 | loss: 0.2019736
	speed: 0.0962s/iter; left time: 2785.0361s
	iters: 300, epoch: 22 | loss: 0.0103385
	speed: 0.1011s/iter; left time: 2916.9330s
Epoch: 22 cost time: 37.74919509887695
Epoch: 22, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.713 Vali Acc: 0.642 Test Loss: 2.713 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0267304
	speed: 0.3881s/iter; left time: 11131.6227s
	iters: 200, epoch: 23 | loss: 0.0005327
	speed: 0.1139s/iter; left time: 3256.5090s
	iters: 300, epoch: 23 | loss: 0.2237852
	speed: 0.1144s/iter; left time: 3258.0620s
Epoch: 23 cost time: 41.1661639213562
Epoch: 23, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.830 Vali Acc: 0.651 Test Loss: 2.830 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000444
	speed: 0.4385s/iter; left time: 12414.4953s
	iters: 200, epoch: 24 | loss: 0.0236936
	speed: 0.1128s/iter; left time: 3183.8745s
	iters: 300, epoch: 24 | loss: 0.0017952
	speed: 0.1131s/iter; left time: 3179.9201s
Epoch: 24 cost time: 42.37132167816162
Epoch: 24, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.890 Vali Acc: 0.630 Test Loss: 2.890 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 596994
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.8544121
	speed: 0.1023s/iter; left time: 3766.0683s
	iters: 200, epoch: 1 | loss: 2.0355740
	speed: 0.0870s/iter; left time: 3192.3859s
	iters: 300, epoch: 1 | loss: 2.3550503
	speed: 0.0877s/iter; left time: 3211.0779s
Epoch: 1 cost time: 33.86051154136658
Epoch: 1, Steps: 369 | Train Loss: 1.925 Vali Loss: 1.140 Vali Acc: 0.629 Test Loss: 1.140 Test Acc: 0.629
Validation loss decreased (inf --> -0.629103).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4026637
	speed: 0.3242s/iter; left time: 11811.7401s
	iters: 200, epoch: 2 | loss: 0.6399990
	speed: 0.0878s/iter; left time: 3190.8855s
	iters: 300, epoch: 2 | loss: 3.3967133
	speed: 0.0699s/iter; left time: 2531.0051s
Epoch: 2 cost time: 30.23344659805298
Epoch: 2, Steps: 369 | Train Loss: 1.853 Vali Loss: 2.466 Vali Acc: 0.615 Test Loss: 2.466 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.0518563
	speed: 0.2935s/iter; left time: 10584.2299s
	iters: 200, epoch: 3 | loss: 3.7533216
	speed: 0.0766s/iter; left time: 2753.0488s
	iters: 300, epoch: 3 | loss: 2.1133158
	speed: 0.0747s/iter; left time: 2677.9304s
Epoch: 3 cost time: 28.644733905792236
Epoch: 3, Steps: 369 | Train Loss: 2.543 Vali Loss: 2.727 Vali Acc: 0.643 Test Loss: 2.727 Test Acc: 0.643
Validation loss decreased (-0.629103 --> -0.643276).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4832985
	speed: 0.2795s/iter; left time: 9975.5560s
	iters: 200, epoch: 4 | loss: 2.9819772
	speed: 0.0762s/iter; left time: 2713.5687s
	iters: 300, epoch: 4 | loss: 1.4412575
	speed: 0.0780s/iter; left time: 2767.8010s
Epoch: 4 cost time: 28.217790842056274
Epoch: 4, Steps: 369 | Train Loss: 2.690 Vali Loss: 4.447 Vali Acc: 0.641 Test Loss: 4.447 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6391863
	speed: 0.2865s/iter; left time: 10120.2860s
	iters: 200, epoch: 5 | loss: 2.2083411
	speed: 0.0747s/iter; left time: 2631.6823s
	iters: 300, epoch: 5 | loss: 0.5322741
	speed: 0.0716s/iter; left time: 2515.1545s
Epoch: 5 cost time: 27.818543910980225
Epoch: 5, Steps: 369 | Train Loss: 2.861 Vali Loss: 4.614 Vali Acc: 0.631 Test Loss: 4.614 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5323133
	speed: 0.3038s/iter; left time: 10621.0544s
	iters: 200, epoch: 6 | loss: 2.9823225
	speed: 0.0868s/iter; left time: 3026.9588s
	iters: 300, epoch: 6 | loss: 1.2068294
	speed: 0.0861s/iter; left time: 2992.9980s
Epoch: 6 cost time: 32.32738971710205
Epoch: 6, Steps: 369 | Train Loss: 2.436 Vali Loss: 5.172 Vali Acc: 0.642 Test Loss: 5.172 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4340477
	speed: 0.3245s/iter; left time: 11223.7128s
	iters: 200, epoch: 7 | loss: 3.5235083
	speed: 0.0871s/iter; left time: 3002.2301s
	iters: 300, epoch: 7 | loss: 1.7742776
	speed: 0.0872s/iter; left time: 2998.9701s
Epoch: 7 cost time: 32.682300329208374
Epoch: 7, Steps: 369 | Train Loss: 1.967 Vali Loss: 6.799 Vali Acc: 0.630 Test Loss: 6.799 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.9538798
	speed: 0.3326s/iter; left time: 11380.5983s
	iters: 200, epoch: 8 | loss: 0.9303089
	speed: 0.0897s/iter; left time: 3060.4433s
	iters: 300, epoch: 8 | loss: 1.6301368
	speed: 0.0898s/iter; left time: 3054.4857s
Epoch: 8 cost time: 33.530208110809326
Epoch: 8, Steps: 369 | Train Loss: 1.534 Vali Loss: 5.586 Vali Acc: 0.625 Test Loss: 5.586 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.0274954
	speed: 0.3308s/iter; left time: 11196.5125s
	iters: 200, epoch: 9 | loss: 0.0614008
	speed: 0.0898s/iter; left time: 3031.4594s
	iters: 300, epoch: 9 | loss: 0.7244353
	speed: 0.0893s/iter; left time: 3005.7384s
Epoch: 9 cost time: 33.458054304122925
Epoch: 9, Steps: 369 | Train Loss: 1.096 Vali Loss: 4.423 Vali Acc: 0.633 Test Loss: 4.423 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.3679165
	speed: 0.3279s/iter; left time: 10979.2621s
	iters: 200, epoch: 10 | loss: 0.9046305
	speed: 0.0884s/iter; left time: 2950.0132s
	iters: 300, epoch: 10 | loss: 1.0596423
	speed: 0.0746s/iter; left time: 2483.7919s
Epoch: 10 cost time: 30.973713636398315
Epoch: 10, Steps: 369 | Train Loss: 0.708 Vali Loss: 3.915 Vali Acc: 0.637 Test Loss: 3.915 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2611267
	speed: 0.2947s/iter; left time: 9757.3767s
	iters: 200, epoch: 11 | loss: 1.5172375
	speed: 0.0720s/iter; left time: 2375.5614s
	iters: 300, epoch: 11 | loss: 0.2056936
	speed: 0.0733s/iter; left time: 2413.8374s
Epoch: 11 cost time: 27.767475366592407
Epoch: 11, Steps: 369 | Train Loss: 0.420 Vali Loss: 3.314 Vali Acc: 0.640 Test Loss: 3.314 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5504935
	speed: 0.2800s/iter; left time: 9168.2231s
	iters: 200, epoch: 12 | loss: 0.0114634
	speed: 0.0732s/iter; left time: 2389.8837s
	iters: 300, epoch: 12 | loss: 0.0028415
	speed: 0.0739s/iter; left time: 2403.8807s
Epoch: 12 cost time: 27.31541132926941
Epoch: 12, Steps: 369 | Train Loss: 0.294 Vali Loss: 2.634 Vali Acc: 0.638 Test Loss: 2.634 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0844072
	speed: 0.2840s/iter; left time: 9192.7685s
	iters: 200, epoch: 13 | loss: 0.5629614
	speed: 0.0733s/iter; left time: 2364.0722s
	iters: 300, epoch: 13 | loss: 0.1151583
	speed: 0.0736s/iter; left time: 2369.2662s
Epoch: 13 cost time: 27.561251163482666
Epoch: 13, Steps: 369 | Train Loss: 0.192 Vali Loss: 2.345 Vali Acc: 0.639 Test Loss: 2.345 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6433030646992054
model parameter : 412738
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2771560
	speed: 0.0797s/iter; left time: 2932.0871s
	iters: 200, epoch: 1 | loss: 1.8609580
	speed: 0.0553s/iter; left time: 2029.6234s
	iters: 300, epoch: 1 | loss: 1.7466406
	speed: 0.0291s/iter; left time: 1063.8945s
Epoch: 1 cost time: 18.478570699691772
Epoch: 1, Steps: 369 | Train Loss: 1.588 Vali Loss: 1.319 Vali Acc: 0.639 Test Loss: 1.319 Test Acc: 0.639
Validation loss decreased (inf --> -0.638750).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1495351
	speed: 0.1362s/iter; left time: 4961.4667s
	iters: 200, epoch: 2 | loss: 1.6123997
	speed: 0.0286s/iter; left time: 1038.3939s
	iters: 300, epoch: 2 | loss: 1.7161610
	speed: 0.0282s/iter; left time: 1021.1220s
Epoch: 2 cost time: 11.047051668167114
Epoch: 2, Steps: 369 | Train Loss: 1.581 Vali Loss: 1.709 Vali Acc: 0.652 Test Loss: 1.709 Test Acc: 0.652
Validation loss decreased (-0.638750 --> -0.652083).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1401153
	speed: 0.2126s/iter; left time: 7667.3960s
	iters: 200, epoch: 3 | loss: 4.0671167
	speed: 0.0675s/iter; left time: 2427.3714s
	iters: 300, epoch: 3 | loss: 2.3623550
	speed: 0.0675s/iter; left time: 2421.8937s
Epoch: 3 cost time: 25.38857626914978
Epoch: 3, Steps: 369 | Train Loss: 2.019 Vali Loss: 2.783 Vali Acc: 0.654 Test Loss: 2.783 Test Acc: 0.654
Validation loss decreased (-0.652083 --> -0.654342).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.2006121
	speed: 0.2616s/iter; left time: 9338.6571s
	iters: 200, epoch: 4 | loss: 2.6148994
	speed: 0.0679s/iter; left time: 2416.4254s
	iters: 300, epoch: 4 | loss: 3.2023141
	speed: 0.0676s/iter; left time: 2398.7189s
Epoch: 4 cost time: 25.525514125823975
Epoch: 4, Steps: 369 | Train Loss: 2.295 Vali Loss: 3.189 Vali Acc: 0.653 Test Loss: 3.189 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.5837648
	speed: 0.2631s/iter; left time: 9294.8004s
	iters: 200, epoch: 5 | loss: 1.6296880
	speed: 0.0665s/iter; left time: 2343.7556s
	iters: 300, epoch: 5 | loss: 2.5497825
	speed: 0.0667s/iter; left time: 2342.4100s
Epoch: 5 cost time: 25.232447862625122
Epoch: 5, Steps: 369 | Train Loss: 2.239 Vali Loss: 4.559 Vali Acc: 0.636 Test Loss: 4.559 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.6397552
	speed: 0.2652s/iter; left time: 9269.5190s
	iters: 200, epoch: 6 | loss: 4.4812756
	speed: 0.0673s/iter; left time: 2346.7195s
	iters: 300, epoch: 6 | loss: 4.2480159
	speed: 0.0640s/iter; left time: 2225.3874s
Epoch: 6 cost time: 25.288071870803833
Epoch: 6, Steps: 369 | Train Loss: 2.039 Vali Loss: 4.308 Vali Acc: 0.639 Test Loss: 4.308 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4298929
	speed: 0.2463s/iter; left time: 8518.6787s
	iters: 200, epoch: 7 | loss: 1.9921256
	speed: 0.0528s/iter; left time: 1819.7320s
	iters: 300, epoch: 7 | loss: 2.7968411
	speed: 0.0544s/iter; left time: 1871.9354s
Epoch: 7 cost time: 20.278836488723755
Epoch: 7, Steps: 369 | Train Loss: 1.625 Vali Loss: 4.652 Vali Acc: 0.648 Test Loss: 4.652 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5409670
	speed: 0.2341s/iter; left time: 8009.5100s
	iters: 200, epoch: 8 | loss: 0.6610230
	speed: 0.0499s/iter; left time: 1703.7159s
	iters: 300, epoch: 8 | loss: 1.2474781
	speed: 0.0542s/iter; left time: 1844.6155s
Epoch: 8 cost time: 20.48051881790161
Epoch: 8, Steps: 369 | Train Loss: 1.260 Vali Loss: 4.818 Vali Acc: 0.646 Test Loss: 4.818 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.4813147
	speed: 0.2392s/iter; left time: 8096.3464s
	iters: 200, epoch: 9 | loss: 0.9694248
	speed: 0.0560s/iter; left time: 1889.3079s
	iters: 300, epoch: 9 | loss: 1.6730579
	speed: 0.0563s/iter; left time: 1893.8176s
Epoch: 9 cost time: 21.51224994659424
Epoch: 9, Steps: 369 | Train Loss: 0.895 Vali Loss: 4.200 Vali Acc: 0.651 Test Loss: 4.200 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.2526994
	speed: 0.2514s/iter; left time: 8415.8480s
	iters: 200, epoch: 10 | loss: 0.1882185
	speed: 0.0657s/iter; left time: 2194.2952s
	iters: 300, epoch: 10 | loss: 0.9888943
	speed: 0.0654s/iter; left time: 2176.9762s
Epoch: 10 cost time: 24.83307719230652
Epoch: 10, Steps: 369 | Train Loss: 0.620 Vali Loss: 4.049 Vali Acc: 0.648 Test Loss: 4.049 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0382099
	speed: 0.2649s/iter; left time: 8770.6038s
	iters: 200, epoch: 11 | loss: 2.0200720
	speed: 0.0670s/iter; left time: 2211.6666s
	iters: 300, epoch: 11 | loss: 0.1766766
	speed: 0.0676s/iter; left time: 2224.0906s
Epoch: 11 cost time: 25.40813684463501
Epoch: 11, Steps: 369 | Train Loss: 0.494 Vali Loss: 3.345 Vali Acc: 0.637 Test Loss: 3.345 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1887973
	speed: 0.2694s/iter; left time: 8821.1530s
	iters: 200, epoch: 12 | loss: 0.0358705
	speed: 0.0674s/iter; left time: 2200.7589s
	iters: 300, epoch: 12 | loss: 0.0002232
	speed: 0.0673s/iter; left time: 2189.9346s
Epoch: 12 cost time: 25.352096557617188
Epoch: 12, Steps: 369 | Train Loss: 0.335 Vali Loss: 3.266 Vali Acc: 0.637 Test Loss: 3.266 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6932079
	speed: 0.2649s/iter; left time: 8576.1464s
	iters: 200, epoch: 13 | loss: 0.0012277
	speed: 0.0683s/iter; left time: 2204.8989s
	iters: 300, epoch: 13 | loss: 0.0188501
	speed: 0.0676s/iter; left time: 2175.9000s
Epoch: 13 cost time: 25.63501524925232
Epoch: 13, Steps: 369 | Train Loss: 0.204 Vali Loss: 3.039 Vali Acc: 0.645 Test Loss: 3.039 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6543700340522134
model parameter : 302274
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0663797
	speed: 0.0750s/iter; left time: 2761.4486s
	iters: 200, epoch: 1 | loss: 1.2151474
	speed: 0.0569s/iter; left time: 2089.2679s
	iters: 300, epoch: 1 | loss: 2.5454934
	speed: 0.0566s/iter; left time: 2072.2660s
Epoch: 1 cost time: 22.856101036071777
Epoch: 1, Steps: 369 | Train Loss: 1.505 Vali Loss: 1.615 Vali Acc: 0.626 Test Loss: 1.615 Test Acc: 0.626
Validation loss decreased (inf --> -0.625693).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8688979
	speed: 0.2138s/iter; left time: 7789.9222s
	iters: 200, epoch: 2 | loss: 1.4044619
	speed: 0.0563s/iter; left time: 2044.5108s
	iters: 300, epoch: 2 | loss: 2.1293600
	speed: 0.0558s/iter; left time: 2020.9058s
Epoch: 2 cost time: 21.369927406311035
Epoch: 2, Steps: 369 | Train Loss: 1.293 Vali Loss: 1.864 Vali Acc: 0.648 Test Loss: 1.864 Test Acc: 0.648
Validation loss decreased (-0.625693 --> -0.648108).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6598982
	speed: 0.2169s/iter; left time: 7823.4911s
	iters: 200, epoch: 3 | loss: 0.5286530
	speed: 0.0566s/iter; left time: 2037.1747s
	iters: 300, epoch: 3 | loss: 2.5369301
	speed: 0.0522s/iter; left time: 1871.0684s
Epoch: 3 cost time: 20.139369010925293
Epoch: 3, Steps: 369 | Train Loss: 1.750 Vali Loss: 2.625 Vali Acc: 0.658 Test Loss: 2.625 Test Acc: 0.658
Validation loss decreased (-0.648108 --> -0.658317).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9931216
	speed: 0.1831s/iter; left time: 6536.5276s
	iters: 200, epoch: 4 | loss: 0.9369565
	speed: 0.0460s/iter; left time: 1636.4192s
	iters: 300, epoch: 4 | loss: 1.8534495
	speed: 0.0441s/iter; left time: 1564.5929s
Epoch: 4 cost time: 17.367311716079712
Epoch: 4, Steps: 369 | Train Loss: 1.843 Vali Loss: 3.524 Vali Acc: 0.633 Test Loss: 3.524 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9160652
	speed: 0.1844s/iter; left time: 6512.5683s
	iters: 200, epoch: 5 | loss: 2.3883548
	speed: 0.0399s/iter; left time: 1404.5298s
	iters: 300, epoch: 5 | loss: 1.2250087
	speed: 0.0467s/iter; left time: 1639.3873s
Epoch: 5 cost time: 17.236021995544434
Epoch: 5, Steps: 369 | Train Loss: 1.911 Vali Loss: 3.266 Vali Acc: 0.660 Test Loss: 3.266 Test Acc: 0.660
Validation loss decreased (-0.658317 --> -0.660297).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1124356
	speed: 0.1819s/iter; left time: 6359.6695s
	iters: 200, epoch: 6 | loss: 3.8507202
	speed: 0.0451s/iter; left time: 1572.8208s
	iters: 300, epoch: 6 | loss: 2.2766831
	speed: 0.0452s/iter; left time: 1571.9102s
Epoch: 6 cost time: 17.41323184967041
Epoch: 6, Steps: 369 | Train Loss: 1.800 Vali Loss: 4.246 Vali Acc: 0.640 Test Loss: 4.246 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6420629
	speed: 0.1853s/iter; left time: 6409.4286s
	iters: 200, epoch: 7 | loss: 0.1112754
	speed: 0.0577s/iter; left time: 1991.2014s
	iters: 300, epoch: 7 | loss: 7.0450988
	speed: 0.0572s/iter; left time: 1967.4842s
Epoch: 7 cost time: 20.554553747177124
Epoch: 7, Steps: 369 | Train Loss: 1.469 Vali Loss: 4.936 Vali Acc: 0.634 Test Loss: 4.936 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.9410043
	speed: 0.2104s/iter; left time: 7198.7077s
	iters: 200, epoch: 8 | loss: 1.8454833
	speed: 0.0566s/iter; left time: 1930.2520s
	iters: 300, epoch: 8 | loss: 0.1964256
	speed: 0.0565s/iter; left time: 1921.9461s
Epoch: 8 cost time: 21.48864984512329
Epoch: 8, Steps: 369 | Train Loss: 1.170 Vali Loss: 4.931 Vali Acc: 0.624 Test Loss: 4.931 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.8490160
	speed: 0.2152s/iter; left time: 7285.3560s
	iters: 200, epoch: 9 | loss: 0.7224116
	speed: 0.0574s/iter; left time: 1937.9020s
	iters: 300, epoch: 9 | loss: 0.0004672
	speed: 0.0559s/iter; left time: 1879.6659s
Epoch: 9 cost time: 21.478352546691895
Epoch: 9, Steps: 369 | Train Loss: 0.834 Vali Loss: 4.286 Vali Acc: 0.631 Test Loss: 4.286 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2409113
	speed: 0.2148s/iter; left time: 7189.8548s
	iters: 200, epoch: 10 | loss: 0.3263732
	speed: 0.0559s/iter; left time: 1867.3908s
	iters: 300, epoch: 10 | loss: 0.8063321
	speed: 0.0557s/iter; left time: 1854.8550s
Epoch: 10 cost time: 21.38270139694214
Epoch: 10, Steps: 369 | Train Loss: 0.645 Vali Loss: 3.724 Vali Acc: 0.652 Test Loss: 3.724 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0225141
	speed: 0.2121s/iter; left time: 7024.1354s
	iters: 200, epoch: 11 | loss: 0.1089865
	speed: 0.0559s/iter; left time: 1844.8415s
	iters: 300, epoch: 11 | loss: 0.0015442
	speed: 0.0557s/iter; left time: 1832.4800s
Epoch: 11 cost time: 21.209948778152466
Epoch: 11, Steps: 369 | Train Loss: 0.406 Vali Loss: 3.720 Vali Acc: 0.638 Test Loss: 3.720 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.5815198
	speed: 0.1959s/iter; left time: 6414.8339s
	iters: 200, epoch: 12 | loss: 0.8271711
	speed: 0.0443s/iter; left time: 1444.8768s
	iters: 300, epoch: 12 | loss: 0.8030148
	speed: 0.0450s/iter; left time: 1465.8084s
Epoch: 12 cost time: 17.06569790840149
Epoch: 12, Steps: 369 | Train Loss: 0.339 Vali Loss: 3.429 Vali Acc: 0.639 Test Loss: 3.429 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1111218
	speed: 0.1787s/iter; left time: 5784.7604s
	iters: 200, epoch: 13 | loss: 0.0105002
	speed: 0.0482s/iter; left time: 1557.1380s
	iters: 300, epoch: 13 | loss: 0.7982940
	speed: 0.0462s/iter; left time: 1486.4315s
Epoch: 13 cost time: 17.34052300453186
Epoch: 13, Steps: 369 | Train Loss: 0.245 Vali Loss: 2.857 Vali Acc: 0.636 Test Loss: 2.857 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0245993
	speed: 0.1801s/iter; left time: 5762.9882s
	iters: 200, epoch: 14 | loss: 0.1019177
	speed: 0.0438s/iter; left time: 1397.9738s
	iters: 300, epoch: 14 | loss: 0.2699232
	speed: 0.0433s/iter; left time: 1378.6780s
Epoch: 14 cost time: 16.851130962371826
Epoch: 14, Steps: 369 | Train Loss: 0.175 Vali Loss: 2.759 Vali Acc: 0.639 Test Loss: 2.759 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0593408
	speed: 0.1829s/iter; left time: 5785.2197s
	iters: 200, epoch: 15 | loss: 0.0223775
	speed: 0.0459s/iter; left time: 1446.8474s
	iters: 300, epoch: 15 | loss: 0.0071473
	speed: 0.0422s/iter; left time: 1325.4078s
Epoch: 15 cost time: 18.036243438720703
Epoch: 15, Steps: 369 | Train Loss: 0.128 Vali Loss: 2.520 Vali Acc: 0.645 Test Loss: 2.520 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6603291713961408
model parameter : 247170
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5309643
	speed: 0.0696s/iter; left time: 2559.9540s
	iters: 200, epoch: 1 | loss: 0.7844652
	speed: 0.0520s/iter; left time: 1907.3149s
	iters: 300, epoch: 1 | loss: 1.5340935
	speed: 0.0519s/iter; left time: 1898.1055s
Epoch: 1 cost time: 20.995948553085327
Epoch: 1, Steps: 369 | Train Loss: 1.235 Vali Loss: 1.437 Vali Acc: 0.605 Test Loss: 1.437 Test Acc: 0.605
Validation loss decreased (inf --> -0.604980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8466964
	speed: 0.1960s/iter; left time: 7138.9368s
	iters: 200, epoch: 2 | loss: 0.6305278
	speed: 0.0524s/iter; left time: 1902.2716s
	iters: 300, epoch: 2 | loss: 1.1912264
	speed: 0.0518s/iter; left time: 1878.0489s
Epoch: 2 cost time: 18.66031050682068
Epoch: 2, Steps: 369 | Train Loss: 1.233 Vali Loss: 1.797 Vali Acc: 0.649 Test Loss: 1.797 Test Acc: 0.649
Validation loss decreased (-0.604980 --> -0.649244).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7844846
	speed: 0.1671s/iter; left time: 6026.1920s
	iters: 200, epoch: 3 | loss: 2.4877353
	speed: 0.0401s/iter; left time: 1442.7335s
	iters: 300, epoch: 3 | loss: 2.0789764
	speed: 0.0411s/iter; left time: 1472.3398s
Epoch: 3 cost time: 15.774163007736206
Epoch: 3, Steps: 369 | Train Loss: 1.516 Vali Loss: 2.095 Vali Acc: 0.651 Test Loss: 2.095 Test Acc: 0.651
Validation loss decreased (-0.649244 --> -0.650660).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6763084
	speed: 0.1733s/iter; left time: 6186.8451s
	iters: 200, epoch: 4 | loss: 0.7706142
	speed: 0.0426s/iter; left time: 1515.5355s
	iters: 300, epoch: 4 | loss: 0.6736046
	speed: 0.0341s/iter; left time: 1210.5170s
Epoch: 4 cost time: 15.575987815856934
Epoch: 4, Steps: 369 | Train Loss: 1.667 Vali Loss: 2.747 Vali Acc: 0.637 Test Loss: 2.747 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7851299
	speed: 0.1696s/iter; left time: 5990.8703s
	iters: 200, epoch: 5 | loss: 1.9482272
	speed: 0.0412s/iter; left time: 1450.2264s
	iters: 300, epoch: 5 | loss: 1.8368454
	speed: 0.0397s/iter; left time: 1393.8137s
Epoch: 5 cost time: 15.636922597885132
Epoch: 5, Steps: 369 | Train Loss: 1.569 Vali Loss: 4.072 Vali Acc: 0.622 Test Loss: 4.072 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3840033
	speed: 0.1700s/iter; left time: 5943.5486s
	iters: 200, epoch: 6 | loss: 1.2702339
	speed: 0.0403s/iter; left time: 1405.4303s
	iters: 300, epoch: 6 | loss: 2.0984807
	speed: 0.0424s/iter; left time: 1473.7011s
Epoch: 6 cost time: 16.522005796432495
Epoch: 6, Steps: 369 | Train Loss: 1.452 Vali Loss: 4.206 Vali Acc: 0.623 Test Loss: 4.206 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7785275
	speed: 0.2005s/iter; left time: 6933.1881s
	iters: 200, epoch: 7 | loss: 0.2048439
	speed: 0.0525s/iter; left time: 1811.4339s
	iters: 300, epoch: 7 | loss: 3.4781723
	speed: 0.0522s/iter; left time: 1796.6323s
Epoch: 7 cost time: 20.0086567401886
Epoch: 7, Steps: 369 | Train Loss: 1.164 Vali Loss: 4.372 Vali Acc: 0.636 Test Loss: 4.372 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2032553
	speed: 0.2056s/iter; left time: 7036.4721s
	iters: 200, epoch: 8 | loss: 0.3821862
	speed: 0.0515s/iter; left time: 1758.1265s
	iters: 300, epoch: 8 | loss: 1.5134176
	speed: 0.0520s/iter; left time: 1769.9332s
Epoch: 8 cost time: 19.70423936843872
Epoch: 8, Steps: 369 | Train Loss: 0.988 Vali Loss: 4.226 Vali Acc: 0.643 Test Loss: 4.226 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1711474
	speed: 0.2016s/iter; left time: 6822.8691s
	iters: 200, epoch: 9 | loss: 0.0000462
	speed: 0.0513s/iter; left time: 1730.6453s
	iters: 300, epoch: 9 | loss: 0.6238753
	speed: 0.0506s/iter; left time: 1701.1262s
Epoch: 9 cost time: 19.424280405044556
Epoch: 9, Steps: 369 | Train Loss: 0.685 Vali Loss: 4.063 Vali Acc: 0.643 Test Loss: 4.063 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3465285
	speed: 0.2083s/iter; left time: 6975.0511s
	iters: 200, epoch: 10 | loss: 0.0002488
	speed: 0.0507s/iter; left time: 1693.1870s
	iters: 300, epoch: 10 | loss: 0.4018387
	speed: 0.0506s/iter; left time: 1685.4949s
Epoch: 10 cost time: 19.45360541343689
Epoch: 10, Steps: 369 | Train Loss: 0.562 Vali Loss: 4.008 Vali Acc: 0.636 Test Loss: 4.008 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.8857822
	speed: 0.2021s/iter; left time: 6691.9687s
	iters: 200, epoch: 11 | loss: 0.0504506
	speed: 0.0348s/iter; left time: 1147.3846s
	iters: 300, epoch: 11 | loss: 0.0220455
	speed: 0.0390s/iter; left time: 1281.8946s
Epoch: 11 cost time: 16.007257223129272
Epoch: 11, Steps: 369 | Train Loss: 0.481 Vali Loss: 3.865 Vali Acc: 0.639 Test Loss: 3.865 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7324905
	speed: 0.1832s/iter; left time: 5997.7747s
	iters: 200, epoch: 12 | loss: 0.0053709
	speed: 0.0399s/iter; left time: 1301.8365s
	iters: 300, epoch: 12 | loss: 0.4458398
	speed: 0.0415s/iter; left time: 1349.9627s
Epoch: 12 cost time: 16.00975513458252
Epoch: 12, Steps: 369 | Train Loss: 0.349 Vali Loss: 3.491 Vali Acc: 0.630 Test Loss: 3.491 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.5281632
	speed: 0.1657s/iter; left time: 5365.3918s
	iters: 200, epoch: 13 | loss: 0.6265494
	speed: 0.0442s/iter; left time: 1425.1894s
	iters: 300, epoch: 13 | loss: 0.9307672
	speed: 0.0437s/iter; left time: 1406.1633s
Epoch: 13 cost time: 16.28753352165222
Epoch: 13, Steps: 369 | Train Loss: 0.292 Vali Loss: 3.293 Vali Acc: 0.644 Test Loss: 3.293 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6506810442678774
model parameter : 192066
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2056361
	speed: 0.0658s/iter; left time: 2423.2764s
	iters: 200, epoch: 1 | loss: 0.6921189
	speed: 0.0475s/iter; left time: 1742.9506s
	iters: 300, epoch: 1 | loss: 1.0613809
	speed: 0.0475s/iter; left time: 1738.7953s
Epoch: 1 cost time: 19.45523476600647
Epoch: 1, Steps: 369 | Train Loss: 1.091 Vali Loss: 1.509 Vali Acc: 0.642 Test Loss: 1.509 Test Acc: 0.642
Validation loss decreased (inf --> -0.642437).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9809389
	speed: 0.1900s/iter; left time: 6921.0243s
	iters: 200, epoch: 2 | loss: 1.7792032
	speed: 0.0473s/iter; left time: 1719.1986s
	iters: 300, epoch: 2 | loss: 0.9098090
	speed: 0.0476s/iter; left time: 1725.4860s
Epoch: 2 cost time: 18.210806131362915
Epoch: 2, Steps: 369 | Train Loss: 1.135 Vali Loss: 1.587 Vali Acc: 0.648 Test Loss: 1.587 Test Acc: 0.648
Validation loss decreased (-0.642437 --> -0.648111).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1740292
	speed: 0.1958s/iter; left time: 7059.3369s
	iters: 200, epoch: 3 | loss: 2.7492497
	speed: 0.0480s/iter; left time: 1726.5166s
	iters: 300, epoch: 3 | loss: 0.6557491
	speed: 0.0480s/iter; left time: 1720.2469s
Epoch: 3 cost time: 18.377411127090454
Epoch: 3, Steps: 369 | Train Loss: 1.317 Vali Loss: 2.018 Vali Acc: 0.652 Test Loss: 2.018 Test Acc: 0.652
Validation loss decreased (-0.648111 --> -0.651796).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2561141
	speed: 0.1867s/iter; left time: 6664.3624s
	iters: 200, epoch: 4 | loss: 2.2338736
	speed: 0.0477s/iter; left time: 1696.2794s
	iters: 300, epoch: 4 | loss: 1.3017308
	speed: 0.0359s/iter; left time: 1275.0413s
Epoch: 4 cost time: 16.141491889953613
Epoch: 4, Steps: 369 | Train Loss: 1.439 Vali Loss: 2.543 Vali Acc: 0.648 Test Loss: 2.543 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9874880
	speed: 0.1615s/iter; left time: 5704.8604s
	iters: 200, epoch: 5 | loss: 2.4676878
	speed: 0.0348s/iter; left time: 1225.9257s
	iters: 300, epoch: 5 | loss: 2.5104170
	speed: 0.0354s/iter; left time: 1244.3813s
Epoch: 5 cost time: 13.7430899143219
Epoch: 5, Steps: 369 | Train Loss: 1.402 Vali Loss: 3.347 Vali Acc: 0.631 Test Loss: 3.347 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.5158849
	speed: 0.1567s/iter; left time: 5477.7826s
	iters: 200, epoch: 6 | loss: 2.8703313
	speed: 0.0356s/iter; left time: 1239.5052s
	iters: 300, epoch: 6 | loss: 0.0926646
	speed: 0.0355s/iter; left time: 1232.6259s
Epoch: 6 cost time: 12.893985986709595
Epoch: 6, Steps: 369 | Train Loss: 1.254 Vali Loss: 3.548 Vali Acc: 0.627 Test Loss: 3.548 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0457301
	speed: 0.1438s/iter; left time: 4972.2771s
	iters: 200, epoch: 7 | loss: 0.0289424
	speed: 0.0351s/iter; left time: 1210.1639s
	iters: 300, epoch: 7 | loss: 1.0107723
	speed: 0.0347s/iter; left time: 1192.8368s
Epoch: 7 cost time: 13.198309421539307
Epoch: 7, Steps: 369 | Train Loss: 0.962 Vali Loss: 3.511 Vali Acc: 0.635 Test Loss: 3.511 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8490839
	speed: 0.1639s/iter; left time: 5608.6340s
	iters: 200, epoch: 8 | loss: 1.8346549
	speed: 0.0345s/iter; left time: 1177.2627s
	iters: 300, epoch: 8 | loss: 0.7279571
	speed: 0.0349s/iter; left time: 1186.2511s
Epoch: 8 cost time: 13.293188095092773
Epoch: 8, Steps: 369 | Train Loss: 0.790 Vali Loss: 4.026 Vali Acc: 0.626 Test Loss: 4.026 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0049217
	speed: 0.1781s/iter; left time: 6029.5549s
	iters: 200, epoch: 9 | loss: 0.3936804
	speed: 0.0464s/iter; left time: 1566.2413s
	iters: 300, epoch: 9 | loss: 1.3438265
	speed: 0.0465s/iter; left time: 1564.8621s
Epoch: 9 cost time: 17.720503330230713
Epoch: 9, Steps: 369 | Train Loss: 0.630 Vali Loss: 3.607 Vali Acc: 0.630 Test Loss: 3.607 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2417189
	speed: 0.1937s/iter; left time: 6484.2136s
	iters: 200, epoch: 10 | loss: 0.0061431
	speed: 0.0482s/iter; left time: 1607.6110s
	iters: 300, epoch: 10 | loss: 0.9073526
	speed: 0.0477s/iter; left time: 1588.4482s
Epoch: 10 cost time: 18.292876482009888
Epoch: 10, Steps: 369 | Train Loss: 0.514 Vali Loss: 3.491 Vali Acc: 0.634 Test Loss: 3.491 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2932930
	speed: 0.1869s/iter; left time: 6187.7834s
	iters: 200, epoch: 11 | loss: 0.0069361
	speed: 0.0484s/iter; left time: 1596.5365s
	iters: 300, epoch: 11 | loss: 0.5734187
	speed: 0.0481s/iter; left time: 1582.6652s
Epoch: 11 cost time: 18.499370336532593
Epoch: 11, Steps: 369 | Train Loss: 0.397 Vali Loss: 3.238 Vali Acc: 0.641 Test Loss: 3.238 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1603845
	speed: 0.1935s/iter; left time: 6335.1824s
	iters: 200, epoch: 12 | loss: 0.6972571
	speed: 0.0470s/iter; left time: 1535.5582s
	iters: 300, epoch: 12 | loss: 1.1273154
	speed: 0.0475s/iter; left time: 1545.2442s
Epoch: 12 cost time: 18.16467785835266
Epoch: 12, Steps: 369 | Train Loss: 0.323 Vali Loss: 3.119 Vali Acc: 0.640 Test Loss: 3.119 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.5392131
	speed: 0.1907s/iter; left time: 6174.4969s
	iters: 200, epoch: 13 | loss: 0.0080678
	speed: 0.0469s/iter; left time: 1514.7070s
	iters: 300, epoch: 13 | loss: 0.6817494
	speed: 0.0473s/iter; left time: 1522.3366s
Epoch: 13 cost time: 17.463733196258545
Epoch: 13, Steps: 369 | Train Loss: 0.242 Vali Loss: 3.096 Vali Acc: 0.650 Test Loss: 3.096 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6518161180476731
model parameter : 155394
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.6815267
	speed: 0.1179s/iter; left time: 4340.6627s
	iters: 200, epoch: 1 | loss: 2.1441188
	speed: 0.1037s/iter; left time: 3804.5341s
	iters: 300, epoch: 1 | loss: 2.0575991
	speed: 0.0994s/iter; left time: 3637.3609s
Epoch: 1 cost time: 39.105109214782715
Epoch: 1, Steps: 369 | Train Loss: 2.770 Vali Loss: 4.151 Vali Acc: 0.609 Test Loss: 4.151 Test Acc: 0.609
Validation loss decreased (inf --> -0.608926).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2755144
	speed: 0.3751s/iter; left time: 13667.1315s
	iters: 200, epoch: 2 | loss: 1.3640603
	speed: 0.1166s/iter; left time: 4237.6238s
	iters: 300, epoch: 2 | loss: 3.0172784
	speed: 0.1138s/iter; left time: 4121.7703s
Epoch: 2 cost time: 42.297513484954834
Epoch: 2, Steps: 369 | Train Loss: 2.242 Vali Loss: 2.834 Vali Acc: 0.652 Test Loss: 2.834 Test Acc: 0.652
Validation loss decreased (-0.608926 --> -0.652355).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2032886
	speed: 0.4161s/iter; left time: 15007.2339s
	iters: 200, epoch: 3 | loss: 4.4748206
	speed: 0.1136s/iter; left time: 4084.4394s
	iters: 300, epoch: 3 | loss: 3.2295933
	speed: 0.1130s/iter; left time: 4050.7485s
Epoch: 3 cost time: 42.60964488983154
Epoch: 3, Steps: 369 | Train Loss: 2.798 Vali Loss: 3.205 Vali Acc: 0.648 Test Loss: 3.205 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 6.1778531
	speed: 0.4188s/iter; left time: 14948.7272s
	iters: 200, epoch: 4 | loss: 3.5433164
	speed: 0.1157s/iter; left time: 4119.5232s
	iters: 300, epoch: 4 | loss: 3.4257715
	speed: 0.1150s/iter; left time: 4080.3493s
Epoch: 4 cost time: 43.101104736328125
Epoch: 4, Steps: 369 | Train Loss: 2.870 Vali Loss: 4.394 Vali Acc: 0.657 Test Loss: 4.394 Test Acc: 0.657
Validation loss decreased (-0.652355 --> -0.657164).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8179443
	speed: 0.3875s/iter; left time: 13686.7358s
	iters: 200, epoch: 5 | loss: 5.2344627
	speed: 0.1013s/iter; left time: 3568.1842s
	iters: 300, epoch: 5 | loss: 4.7252669
	speed: 0.1001s/iter; left time: 3516.1103s
Epoch: 5 cost time: 37.59507727622986
Epoch: 5, Steps: 369 | Train Loss: 2.408 Vali Loss: 4.582 Vali Acc: 0.648 Test Loss: 4.582 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.7399266
	speed: 0.3555s/iter; left time: 12427.0300s
	iters: 200, epoch: 6 | loss: 0.2272884
	speed: 0.0982s/iter; left time: 3423.2001s
	iters: 300, epoch: 6 | loss: 0.8999503
	speed: 0.0973s/iter; left time: 3381.5965s
Epoch: 6 cost time: 36.988104581832886
Epoch: 6, Steps: 369 | Train Loss: 1.653 Vali Loss: 4.813 Vali Acc: 0.632 Test Loss: 4.813 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0800085
	speed: 0.3662s/iter; left time: 12665.9568s
	iters: 200, epoch: 7 | loss: 1.4464061
	speed: 0.1135s/iter; left time: 3912.8445s
	iters: 300, epoch: 7 | loss: 0.8147928
	speed: 0.1139s/iter; left time: 3917.1537s
Epoch: 7 cost time: 42.48130202293396
Epoch: 7, Steps: 369 | Train Loss: 1.003 Vali Loss: 3.976 Vali Acc: 0.636 Test Loss: 3.976 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0037852
	speed: 0.4177s/iter; left time: 14292.5513s
	iters: 200, epoch: 8 | loss: 0.3906039
	speed: 0.1153s/iter; left time: 3932.7738s
	iters: 300, epoch: 8 | loss: 0.1589749
	speed: 0.1161s/iter; left time: 3948.0553s
Epoch: 8 cost time: 43.19217562675476
Epoch: 8, Steps: 369 | Train Loss: 0.532 Vali Loss: 3.623 Vali Acc: 0.630 Test Loss: 3.623 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0732045
	speed: 0.4222s/iter; left time: 14289.5678s
	iters: 200, epoch: 9 | loss: 0.0057507
	speed: 0.1167s/iter; left time: 3939.3857s
	iters: 300, epoch: 9 | loss: 0.0024722
	speed: 0.1167s/iter; left time: 3925.9485s
Epoch: 9 cost time: 43.694727420806885
Epoch: 9, Steps: 369 | Train Loss: 0.375 Vali Loss: 3.704 Vali Acc: 0.618 Test Loss: 3.704 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0087638
	speed: 0.3863s/iter; left time: 12933.4150s
	iters: 200, epoch: 10 | loss: 0.1538410
	speed: 0.1007s/iter; left time: 3362.0069s
	iters: 300, epoch: 10 | loss: 0.0013178
	speed: 0.0997s/iter; left time: 3316.7822s
Epoch: 10 cost time: 37.31737303733826
Epoch: 10, Steps: 369 | Train Loss: 0.221 Vali Loss: 2.971 Vali Acc: 0.650 Test Loss: 2.971 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0019252
	speed: 0.3629s/iter; left time: 12017.3736s
	iters: 200, epoch: 11 | loss: 0.0000636
	speed: 0.0999s/iter; left time: 3298.2584s
	iters: 300, epoch: 11 | loss: 0.0357819
	speed: 0.1003s/iter; left time: 3302.2911s
Epoch: 11 cost time: 37.61954665184021
Epoch: 11, Steps: 369 | Train Loss: 0.148 Vali Loss: 3.001 Vali Acc: 0.629 Test Loss: 3.001 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0153391
	speed: 0.3843s/iter; left time: 12582.1934s
	iters: 200, epoch: 12 | loss: 0.4222009
	speed: 0.1148s/iter; left time: 3747.2572s
	iters: 300, epoch: 12 | loss: 0.0005526
	speed: 0.1111s/iter; left time: 3616.2176s
Epoch: 12 cost time: 42.251018047332764
Epoch: 12, Steps: 369 | Train Loss: 0.086 Vali Loss: 2.810 Vali Acc: 0.638 Test Loss: 2.810 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0404060
	speed: 0.4239s/iter; left time: 13721.3814s
	iters: 200, epoch: 13 | loss: 0.0070201
	speed: 0.1160s/iter; left time: 3742.7198s
	iters: 300, epoch: 13 | loss: 0.1340342
	speed: 0.1161s/iter; left time: 3736.5601s
Epoch: 13 cost time: 43.52499294281006
Epoch: 13, Steps: 369 | Train Loss: 0.095 Vali Loss: 2.390 Vali Acc: 0.635 Test Loss: 2.390 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0042132
	speed: 0.4290s/iter; left time: 13728.6266s
	iters: 200, epoch: 14 | loss: 0.0059684
	speed: 0.1173s/iter; left time: 3742.4052s
	iters: 300, epoch: 14 | loss: 0.0056317
	speed: 0.1165s/iter; left time: 3705.7096s
Epoch: 14 cost time: 43.61065340042114
Epoch: 14, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.389 Vali Acc: 0.651 Test Loss: 2.389 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6572077185017026
model parameter : 592546
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7720706
	speed: 0.0703s/iter; left time: 2585.5750s
	iters: 200, epoch: 1 | loss: 0.9379473
	speed: 0.0509s/iter; left time: 1869.1608s
	iters: 300, epoch: 1 | loss: 3.4352648
	speed: 0.0496s/iter; left time: 1814.2622s
Epoch: 1 cost time: 20.70164728164673
Epoch: 1, Steps: 369 | Train Loss: 1.757 Vali Loss: 2.346 Vali Acc: 0.593 Test Loss: 2.346 Test Acc: 0.593
Validation loss decreased (inf --> -0.593053).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5081054
	speed: 0.2235s/iter; left time: 8143.6141s
	iters: 200, epoch: 2 | loss: 2.3315380
	speed: 0.0536s/iter; left time: 1947.5743s
	iters: 300, epoch: 2 | loss: 0.6711575
	speed: 0.0518s/iter; left time: 1875.5512s
Epoch: 2 cost time: 20.719767332077026
Epoch: 2, Steps: 369 | Train Loss: 1.619 Vali Loss: 1.751 Vali Acc: 0.645 Test Loss: 1.751 Test Acc: 0.645
Validation loss decreased (-0.593053 --> -0.645272).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7441491
	speed: 0.2546s/iter; left time: 9180.3815s
	iters: 200, epoch: 3 | loss: 2.7635479
	speed: 0.0618s/iter; left time: 2222.0953s
	iters: 300, epoch: 3 | loss: 1.3819746
	speed: 0.0615s/iter; left time: 2206.4285s
Epoch: 3 cost time: 23.281376361846924
Epoch: 3, Steps: 369 | Train Loss: 1.809 Vali Loss: 3.912 Vali Acc: 0.616 Test Loss: 3.912 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3051672
	speed: 0.2528s/iter; left time: 9024.0032s
	iters: 200, epoch: 4 | loss: 2.1870639
	speed: 0.0606s/iter; left time: 2156.5131s
	iters: 300, epoch: 4 | loss: 2.1763358
	speed: 0.0605s/iter; left time: 2146.5605s
Epoch: 4 cost time: 22.926108360290527
Epoch: 4, Steps: 369 | Train Loss: 1.754 Vali Loss: 3.472 Vali Acc: 0.644 Test Loss: 3.472 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7476805
	speed: 0.2552s/iter; left time: 9015.6462s
	iters: 200, epoch: 5 | loss: 3.2755198
	speed: 0.0606s/iter; left time: 2134.4363s
	iters: 300, epoch: 5 | loss: 1.4713666
	speed: 0.0605s/iter; left time: 2125.6505s
Epoch: 5 cost time: 22.95332169532776
Epoch: 5, Steps: 369 | Train Loss: 1.492 Vali Loss: 4.152 Vali Acc: 0.644 Test Loss: 4.152 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.8675675
	speed: 0.2541s/iter; left time: 8882.9134s
	iters: 200, epoch: 6 | loss: 0.0000044
	speed: 0.0606s/iter; left time: 2111.4199s
	iters: 300, epoch: 6 | loss: 1.7004615
	speed: 0.0612s/iter; left time: 2127.8488s
Epoch: 6 cost time: 23.053201913833618
Epoch: 6, Steps: 369 | Train Loss: 1.155 Vali Loss: 3.865 Vali Acc: 0.623 Test Loss: 3.865 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9348687
	speed: 0.2231s/iter; left time: 7717.5708s
	iters: 200, epoch: 7 | loss: 1.3476036
	speed: 0.0501s/iter; left time: 1727.4844s
	iters: 300, epoch: 7 | loss: 1.7057639
	speed: 0.0513s/iter; left time: 1764.9634s
Epoch: 7 cost time: 19.275696516036987
Epoch: 7, Steps: 369 | Train Loss: 0.783 Vali Loss: 3.289 Vali Acc: 0.635 Test Loss: 3.289 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.9800594
	speed: 0.2194s/iter; left time: 7507.0980s
	iters: 200, epoch: 8 | loss: 0.6088700
	speed: 0.0525s/iter; left time: 1791.3965s
	iters: 300, epoch: 8 | loss: 0.7817329
	speed: 0.0466s/iter; left time: 1585.1323s
Epoch: 8 cost time: 19.276981592178345
Epoch: 8, Steps: 369 | Train Loss: 0.446 Vali Loss: 2.712 Vali Acc: 0.642 Test Loss: 2.712 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0153511
	speed: 0.2249s/iter; left time: 7613.2092s
	iters: 200, epoch: 9 | loss: 0.0270335
	speed: 0.0501s/iter; left time: 1691.5355s
	iters: 300, epoch: 9 | loss: 0.6838406
	speed: 0.0498s/iter; left time: 1674.0676s
Epoch: 9 cost time: 19.0760715007782
Epoch: 9, Steps: 369 | Train Loss: 0.275 Vali Loss: 2.680 Vali Acc: 0.636 Test Loss: 2.680 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1067916
	speed: 0.2210s/iter; left time: 7400.4877s
	iters: 200, epoch: 10 | loss: 0.1761958
	speed: 0.0618s/iter; left time: 2061.7176s
	iters: 300, epoch: 10 | loss: 0.5330583
	speed: 0.0617s/iter; left time: 2053.4001s
Epoch: 10 cost time: 22.526754140853882
Epoch: 10, Steps: 369 | Train Loss: 0.193 Vali Loss: 2.642 Vali Acc: 0.642 Test Loss: 2.642 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.5752596
	speed: 0.2511s/iter; left time: 8314.8227s
	iters: 200, epoch: 11 | loss: 0.0635964
	speed: 0.0618s/iter; left time: 2040.2919s
	iters: 300, epoch: 11 | loss: 0.1346149
	speed: 0.0615s/iter; left time: 2024.4013s
Epoch: 11 cost time: 23.269010543823242
Epoch: 11, Steps: 369 | Train Loss: 0.144 Vali Loss: 2.232 Vali Acc: 0.637 Test Loss: 2.232 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2923150
	speed: 0.2502s/iter; left time: 8193.0254s
	iters: 200, epoch: 12 | loss: 0.0089052
	speed: 0.0632s/iter; left time: 2061.3584s
	iters: 300, epoch: 12 | loss: 0.0020223
	speed: 0.0625s/iter; left time: 2034.5505s
Epoch: 12 cost time: 23.619128704071045
Epoch: 12, Steps: 369 | Train Loss: 0.106 Vali Loss: 2.164 Vali Acc: 0.644 Test Loss: 2.164 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6452894438138479
model parameter : 306914
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3292555
	speed: 0.0624s/iter; left time: 2296.0338s
	iters: 200, epoch: 1 | loss: 2.1257663
	speed: 0.0450s/iter; left time: 1651.9827s
	iters: 300, epoch: 1 | loss: 0.9244471
	speed: 0.0366s/iter; left time: 1341.2754s
Epoch: 1 cost time: 16.988706588745117
Epoch: 1, Steps: 369 | Train Loss: 1.341 Vali Loss: 3.336 Vali Acc: 0.566 Test Loss: 3.336 Test Acc: 0.566
Validation loss decreased (inf --> -0.565517).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7114008
	speed: 0.1690s/iter; left time: 6156.2251s
	iters: 200, epoch: 2 | loss: 1.4171829
	speed: 0.0373s/iter; left time: 1354.7249s
	iters: 300, epoch: 2 | loss: 2.0468211
	speed: 0.0361s/iter; left time: 1308.5475s
Epoch: 2 cost time: 14.118794441223145
Epoch: 2, Steps: 369 | Train Loss: 1.400 Vali Loss: 2.012 Vali Acc: 0.633 Test Loss: 2.012 Test Acc: 0.633
Validation loss decreased (-0.565517 --> -0.632784).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6868473
	speed: 0.1650s/iter; left time: 5951.5512s
	iters: 200, epoch: 3 | loss: 2.3360298
	speed: 0.0370s/iter; left time: 1332.0750s
	iters: 300, epoch: 3 | loss: 1.8918800
	speed: 0.0368s/iter; left time: 1320.2196s
Epoch: 3 cost time: 14.183331966400146
Epoch: 3, Steps: 369 | Train Loss: 1.513 Vali Loss: 2.301 Vali Acc: 0.667 Test Loss: 2.301 Test Acc: 0.667
Validation loss decreased (-0.632784 --> -0.666549).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.4430070
	speed: 0.1589s/iter; left time: 5671.0799s
	iters: 200, epoch: 4 | loss: 1.0474225
	speed: 0.0361s/iter; left time: 1285.9720s
	iters: 300, epoch: 4 | loss: 2.1111169
	speed: 0.0364s/iter; left time: 1290.6134s
Epoch: 4 cost time: 14.011892557144165
Epoch: 4, Steps: 369 | Train Loss: 1.521 Vali Loss: 3.319 Vali Acc: 0.640 Test Loss: 3.319 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9288810
	speed: 0.1660s/iter; left time: 5864.6483s
	iters: 200, epoch: 5 | loss: 2.7694216
	speed: 0.0391s/iter; left time: 1375.5745s
	iters: 300, epoch: 5 | loss: 3.3483756
	speed: 0.0383s/iter; left time: 1346.1965s
Epoch: 5 cost time: 14.89466142654419
Epoch: 5, Steps: 369 | Train Loss: 1.371 Vali Loss: 3.845 Vali Acc: 0.635 Test Loss: 3.845 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2576644
	speed: 0.1732s/iter; left time: 6053.9250s
	iters: 200, epoch: 6 | loss: 1.0048468
	speed: 0.0465s/iter; left time: 1621.3652s
	iters: 300, epoch: 6 | loss: 0.6796064
	speed: 0.0462s/iter; left time: 1604.3826s
Epoch: 6 cost time: 17.674628257751465
Epoch: 6, Steps: 369 | Train Loss: 0.996 Vali Loss: 2.816 Vali Acc: 0.640 Test Loss: 2.816 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0081764
	speed: 0.1910s/iter; left time: 6606.0282s
	iters: 200, epoch: 7 | loss: 0.8018975
	speed: 0.0458s/iter; left time: 1579.0522s
	iters: 300, epoch: 7 | loss: 0.2111199
	speed: 0.0459s/iter; left time: 1579.8998s
Epoch: 7 cost time: 17.413313388824463
Epoch: 7, Steps: 369 | Train Loss: 0.677 Vali Loss: 2.344 Vali Acc: 0.642 Test Loss: 2.344 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3944163
	speed: 0.1896s/iter; left time: 6489.3335s
	iters: 200, epoch: 8 | loss: 0.0268251
	speed: 0.0460s/iter; left time: 1569.1450s
	iters: 300, epoch: 8 | loss: 0.7463843
	speed: 0.0458s/iter; left time: 1559.1628s
Epoch: 8 cost time: 17.494940280914307
Epoch: 8, Steps: 369 | Train Loss: 0.403 Vali Loss: 2.084 Vali Acc: 0.636 Test Loss: 2.084 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1238425
	speed: 0.1871s/iter; left time: 6333.2891s
	iters: 200, epoch: 9 | loss: 0.1446672
	speed: 0.0456s/iter; left time: 1539.8458s
	iters: 300, epoch: 9 | loss: 0.0072718
	speed: 0.0462s/iter; left time: 1554.3899s
Epoch: 9 cost time: 17.45494508743286
Epoch: 9, Steps: 369 | Train Loss: 0.273 Vali Loss: 1.561 Vali Acc: 0.621 Test Loss: 1.561 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2784365
	speed: 0.1969s/iter; left time: 6590.6232s
	iters: 200, epoch: 10 | loss: 0.0593034
	speed: 0.0454s/iter; left time: 1514.5401s
	iters: 300, epoch: 10 | loss: 0.3235972
	speed: 0.0455s/iter; left time: 1514.6998s
Epoch: 10 cost time: 17.429267644882202
Epoch: 10, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.559 Vali Acc: 0.652 Test Loss: 1.559 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0389519
	speed: 0.1912s/iter; left time: 6332.4624s
	iters: 200, epoch: 11 | loss: 0.1228635
	speed: 0.0465s/iter; left time: 1536.5271s
	iters: 300, epoch: 11 | loss: 0.2636704
	speed: 0.0354s/iter; left time: 1166.0039s
Epoch: 11 cost time: 16.03888177871704
Epoch: 11, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.724 Vali Acc: 0.629 Test Loss: 1.724 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0315696
	speed: 0.1615s/iter; left time: 5287.7113s
	iters: 200, epoch: 12 | loss: 0.0815574
	speed: 0.0380s/iter; left time: 1239.7352s
	iters: 300, epoch: 12 | loss: 0.0150763
	speed: 0.0372s/iter; left time: 1211.9511s
Epoch: 12 cost time: 14.432905197143555
Epoch: 12, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.777 Vali Acc: 0.639 Test Loss: 1.777 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0281528
	speed: 0.1621s/iter; left time: 5248.8927s
	iters: 200, epoch: 13 | loss: 0.0020012
	speed: 0.0372s/iter; left time: 1199.4044s
	iters: 300, epoch: 13 | loss: 0.0058688
	speed: 0.0375s/iter; left time: 1205.5784s
Epoch: 13 cost time: 13.996421337127686
Epoch: 13, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.905 Vali Acc: 0.635 Test Loss: 1.905 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.666572077185017
model parameter : 214786
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6632640
	speed: 0.0553s/iter; left time: 2035.5593s
	iters: 200, epoch: 1 | loss: 0.5291265
	speed: 0.0399s/iter; left time: 1463.5087s
	iters: 300, epoch: 1 | loss: 1.1289991
	speed: 0.0402s/iter; left time: 1471.0518s
Epoch: 1 cost time: 16.421374559402466
Epoch: 1, Steps: 369 | Train Loss: 1.099 Vali Loss: 1.744 Vali Acc: 0.623 Test Loss: 1.744 Test Acc: 0.623
Validation loss decreased (inf --> -0.622571).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2172954
	speed: 0.1583s/iter; left time: 5768.2887s
	iters: 200, epoch: 2 | loss: 0.9821250
	speed: 0.0401s/iter; left time: 1458.3562s
	iters: 300, epoch: 2 | loss: 1.3326907
	speed: 0.0402s/iter; left time: 1455.6348s
Epoch: 2 cost time: 15.354068279266357
Epoch: 2, Steps: 369 | Train Loss: 1.284 Vali Loss: 1.695 Vali Acc: 0.651 Test Loss: 1.695 Test Acc: 0.651
Validation loss decreased (-0.622571 --> -0.651232).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1234671
	speed: 0.1582s/iter; left time: 5704.1213s
	iters: 200, epoch: 3 | loss: 1.8283172
	speed: 0.0402s/iter; left time: 1447.3908s
	iters: 300, epoch: 3 | loss: 1.4082621
	speed: 0.0408s/iter; left time: 1462.8758s
Epoch: 3 cost time: 15.64610767364502
Epoch: 3, Steps: 369 | Train Loss: 1.213 Vali Loss: 2.361 Vali Acc: 0.647 Test Loss: 2.361 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5178179
	speed: 0.1623s/iter; left time: 5794.7211s
	iters: 200, epoch: 4 | loss: 1.0335451
	speed: 0.0419s/iter; left time: 1490.1457s
	iters: 300, epoch: 4 | loss: 1.7974876
	speed: 0.0414s/iter; left time: 1470.6569s
Epoch: 4 cost time: 15.89563274383545
Epoch: 4, Steps: 369 | Train Loss: 1.227 Vali Loss: 3.210 Vali Acc: 0.637 Test Loss: 3.210 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.1228004
	speed: 0.1572s/iter; left time: 5554.0461s
	iters: 200, epoch: 5 | loss: 0.0157186
	speed: 0.0412s/iter; left time: 1451.5745s
	iters: 300, epoch: 5 | loss: 1.3856951
	speed: 0.0415s/iter; left time: 1456.3928s
Epoch: 5 cost time: 15.799934148788452
Epoch: 5, Steps: 369 | Train Loss: 1.120 Vali Loss: 2.900 Vali Acc: 0.636 Test Loss: 2.900 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5230444
	speed: 0.1617s/iter; left time: 5652.7317s
	iters: 200, epoch: 6 | loss: 1.2480394
	speed: 0.0401s/iter; left time: 1398.1310s
	iters: 300, epoch: 6 | loss: 1.4381868
	speed: 0.0405s/iter; left time: 1408.3145s
Epoch: 6 cost time: 15.471690654754639
Epoch: 6, Steps: 369 | Train Loss: 0.890 Vali Loss: 2.564 Vali Acc: 0.644 Test Loss: 2.564 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1380223
	speed: 0.1472s/iter; left time: 5092.5074s
	iters: 200, epoch: 7 | loss: 0.4453354
	speed: 0.0318s/iter; left time: 1096.8965s
	iters: 300, epoch: 7 | loss: 0.4489091
	speed: 0.0315s/iter; left time: 1082.6745s
Epoch: 7 cost time: 11.722250699996948
Epoch: 7, Steps: 369 | Train Loss: 0.615 Vali Loss: 2.339 Vali Acc: 0.627 Test Loss: 2.339 Test Acc: 0.627
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8458942
	speed: 0.1315s/iter; left time: 4498.8622s
	iters: 200, epoch: 8 | loss: 0.0052652
	speed: 0.0312s/iter; left time: 1064.7804s
	iters: 300, epoch: 8 | loss: 0.3199679
	speed: 0.0312s/iter; left time: 1062.0235s
Epoch: 8 cost time: 12.157410621643066
Epoch: 8, Steps: 369 | Train Loss: 0.414 Vali Loss: 1.853 Vali Acc: 0.630 Test Loss: 1.853 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3083383
	speed: 0.1358s/iter; left time: 4596.5062s
	iters: 200, epoch: 9 | loss: 0.2262138
	speed: 0.0314s/iter; left time: 1059.6135s
	iters: 300, epoch: 9 | loss: 0.4219508
	speed: 0.0251s/iter; left time: 843.2476s
Epoch: 9 cost time: 11.600080728530884
Epoch: 9, Steps: 369 | Train Loss: 0.247 Vali Loss: 1.860 Vali Acc: 0.626 Test Loss: 1.860 Test Acc: 0.626
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0885408
	speed: 0.1317s/iter; left time: 4409.5086s
	iters: 200, epoch: 10 | loss: 0.0066117
	speed: 0.0313s/iter; left time: 1045.4899s
	iters: 300, epoch: 10 | loss: 0.4461145
	speed: 0.0315s/iter; left time: 1048.2573s
Epoch: 10 cost time: 12.229942321777344
Epoch: 10, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.748 Vali Acc: 0.644 Test Loss: 1.748 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1349455
	speed: 0.1318s/iter; left time: 4365.6050s
	iters: 200, epoch: 11 | loss: 0.1093737
	speed: 0.0319s/iter; left time: 1052.4215s
	iters: 300, epoch: 11 | loss: 0.0579118
	speed: 0.0320s/iter; left time: 1054.3820s
Epoch: 11 cost time: 12.324213027954102
Epoch: 11, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.833 Vali Acc: 0.629 Test Loss: 1.833 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0289459
	speed: 0.1462s/iter; left time: 4788.0531s
	iters: 200, epoch: 12 | loss: 0.0306136
	speed: 0.0404s/iter; left time: 1317.5578s
	iters: 300, epoch: 12 | loss: 0.0251249
	speed: 0.0407s/iter; left time: 1324.7980s
Epoch: 12 cost time: 15.551234722137451
Epoch: 12, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.792 Vali Acc: 0.634 Test Loss: 1.792 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6512485811577753
model parameter : 159554
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4876799
	speed: 0.0523s/iter; left time: 1924.6714s
	iters: 200, epoch: 1 | loss: 1.4257190
	speed: 0.0338s/iter; left time: 1241.4663s
	iters: 300, epoch: 1 | loss: 0.7608726
	speed: 0.0339s/iter; left time: 1239.7854s
Epoch: 1 cost time: 14.457163572311401
Epoch: 1, Steps: 369 | Train Loss: 1.018 Vali Loss: 1.503 Vali Acc: 0.622 Test Loss: 1.503 Test Acc: 0.622
Validation loss decreased (inf --> -0.622289).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1699643
	speed: 0.1485s/iter; left time: 5408.5385s
	iters: 200, epoch: 2 | loss: 0.9776405
	speed: 0.0335s/iter; left time: 1217.6711s
	iters: 300, epoch: 2 | loss: 1.0250134
	speed: 0.0339s/iter; left time: 1227.0705s
Epoch: 2 cost time: 13.088682889938354
Epoch: 2, Steps: 369 | Train Loss: 1.068 Vali Loss: 1.226 Vali Acc: 0.653 Test Loss: 1.226 Test Acc: 0.653
Validation loss decreased (-0.622289 --> -0.652655).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2008277
	speed: 0.1465s/iter; left time: 5281.9601s
	iters: 200, epoch: 3 | loss: 1.4013863
	speed: 0.0340s/iter; left time: 1224.0235s
	iters: 300, epoch: 3 | loss: 1.6549850
	speed: 0.0338s/iter; left time: 1211.9600s
Epoch: 3 cost time: 13.089246988296509
Epoch: 3, Steps: 369 | Train Loss: 1.152 Vali Loss: 2.111 Vali Acc: 0.636 Test Loss: 2.111 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2197037
	speed: 0.1499s/iter; left time: 5351.6507s
	iters: 200, epoch: 4 | loss: 1.9549216
	speed: 0.0275s/iter; left time: 980.5114s
	iters: 300, epoch: 4 | loss: 0.7716905
	speed: 0.0284s/iter; left time: 1009.0347s
Epoch: 4 cost time: 11.652594566345215
Epoch: 4, Steps: 369 | Train Loss: 1.103 Vali Loss: 3.167 Vali Acc: 0.635 Test Loss: 3.167 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2238696
	speed: 0.1260s/iter; left time: 4450.4599s
	iters: 200, epoch: 5 | loss: 0.5520351
	speed: 0.0302s/iter; left time: 1064.7268s
	iters: 300, epoch: 5 | loss: 0.9725053
	speed: 0.0302s/iter; left time: 1061.4148s
Epoch: 5 cost time: 11.73046875
Epoch: 5, Steps: 369 | Train Loss: 0.980 Vali Loss: 2.703 Vali Acc: 0.637 Test Loss: 2.703 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1258471
	speed: 0.1273s/iter; left time: 4449.5541s
	iters: 200, epoch: 6 | loss: 0.4526960
	speed: 0.0302s/iter; left time: 1053.9016s
	iters: 300, epoch: 6 | loss: 1.2483516
	speed: 0.0300s/iter; left time: 1042.9591s
Epoch: 6 cost time: 11.59055781364441
Epoch: 6, Steps: 369 | Train Loss: 0.800 Vali Loss: 2.640 Vali Acc: 0.643 Test Loss: 2.640 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7547039
	speed: 0.1258s/iter; left time: 4352.3674s
	iters: 200, epoch: 7 | loss: 0.5200793
	speed: 0.0302s/iter; left time: 1041.4567s
	iters: 300, epoch: 7 | loss: 0.6015414
	speed: 0.0302s/iter; left time: 1039.4590s
Epoch: 7 cost time: 11.811123847961426
Epoch: 7, Steps: 369 | Train Loss: 0.596 Vali Loss: 2.266 Vali Acc: 0.629 Test Loss: 2.266 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0260676
	speed: 0.1266s/iter; left time: 4331.5901s
	iters: 200, epoch: 8 | loss: 0.1078094
	speed: 0.0299s/iter; left time: 1020.4002s
	iters: 300, epoch: 8 | loss: 0.0915387
	speed: 0.0300s/iter; left time: 1021.0882s
Epoch: 8 cost time: 11.61931848526001
Epoch: 8, Steps: 369 | Train Loss: 0.404 Vali Loss: 1.975 Vali Acc: 0.648 Test Loss: 1.975 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0787312
	speed: 0.1233s/iter; left time: 4174.0364s
	iters: 200, epoch: 9 | loss: 0.1680954
	speed: 0.0349s/iter; left time: 1177.7404s
	iters: 300, epoch: 9 | loss: 0.5434582
	speed: 0.0341s/iter; left time: 1148.7751s
Epoch: 9 cost time: 12.396788835525513
Epoch: 9, Steps: 369 | Train Loss: 0.300 Vali Loss: 1.916 Vali Acc: 0.640 Test Loss: 1.916 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1924177
	speed: 0.1504s/iter; left time: 5034.0520s
	iters: 200, epoch: 10 | loss: 0.3893451
	speed: 0.0344s/iter; left time: 1148.4376s
	iters: 300, epoch: 10 | loss: 0.4016542
	speed: 0.0343s/iter; left time: 1141.2908s
Epoch: 10 cost time: 13.291453123092651
Epoch: 10, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.705 Vali Acc: 0.645 Test Loss: 1.705 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1519777
	speed: 0.1459s/iter; left time: 4830.8635s
	iters: 200, epoch: 11 | loss: 0.1074128
	speed: 0.0346s/iter; left time: 1143.5525s
	iters: 300, epoch: 11 | loss: 0.2405580
	speed: 0.0348s/iter; left time: 1145.5299s
Epoch: 11 cost time: 13.396766662597656
Epoch: 11, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.712 Vali Acc: 0.643 Test Loss: 1.712 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2330368
	speed: 0.1481s/iter; left time: 4850.5032s
	iters: 200, epoch: 12 | loss: 0.0657577
	speed: 0.0349s/iter; left time: 1137.6212s
	iters: 300, epoch: 12 | loss: 0.2815168
	speed: 0.0347s/iter; left time: 1128.0295s
Epoch: 12 cost time: 13.360114097595215
Epoch: 12, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.674 Vali Acc: 0.646 Test Loss: 1.674 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 132002
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6609538
	speed: 0.0480s/iter; left time: 1767.8889s
	iters: 200, epoch: 1 | loss: 0.6940563
	speed: 0.0314s/iter; left time: 1153.8911s
	iters: 300, epoch: 1 | loss: 0.8227021
	speed: 0.0315s/iter; left time: 1153.7166s
Epoch: 1 cost time: 13.37939453125
Epoch: 1, Steps: 369 | Train Loss: 0.871 Vali Loss: 1.301 Vali Acc: 0.631 Test Loss: 1.301 Test Acc: 0.631
Validation loss decreased (inf --> -0.631088).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6619675
	speed: 0.1273s/iter; left time: 4636.2349s
	iters: 200, epoch: 2 | loss: 0.8665820
	speed: 0.0270s/iter; left time: 981.5770s
	iters: 300, epoch: 2 | loss: 0.9592271
	speed: 0.0259s/iter; left time: 939.0427s
Epoch: 2 cost time: 9.607916116714478
Epoch: 2, Steps: 369 | Train Loss: 0.938 Vali Loss: 1.602 Vali Acc: 0.646 Test Loss: 1.602 Test Acc: 0.646
Validation loss decreased (-0.631088 --> -0.646409).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1662067
	speed: 0.1223s/iter; left time: 4409.9030s
	iters: 200, epoch: 3 | loss: 1.3007199
	speed: 0.0269s/iter; left time: 965.9468s
	iters: 300, epoch: 3 | loss: 0.6336962
	speed: 0.0273s/iter; left time: 980.6133s
Epoch: 3 cost time: 10.472914457321167
Epoch: 3, Steps: 369 | Train Loss: 0.952 Vali Loss: 2.103 Vali Acc: 0.634 Test Loss: 2.103 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1168184
	speed: 0.1185s/iter; left time: 4230.3250s
	iters: 200, epoch: 4 | loss: 0.3605786
	speed: 0.0266s/iter; left time: 945.1814s
	iters: 300, epoch: 4 | loss: 1.3282241
	speed: 0.0268s/iter; left time: 949.5743s
Epoch: 4 cost time: 9.67955470085144
Epoch: 4, Steps: 369 | Train Loss: 0.923 Vali Loss: 2.519 Vali Acc: 0.627 Test Loss: 2.519 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4826707
	speed: 0.1142s/iter; left time: 4033.5396s
	iters: 200, epoch: 5 | loss: 0.9707782
	speed: 0.0257s/iter; left time: 905.1706s
	iters: 300, epoch: 5 | loss: 1.1096609
	speed: 0.0252s/iter; left time: 885.1419s
Epoch: 5 cost time: 10.11639952659607
Epoch: 5, Steps: 369 | Train Loss: 0.789 Vali Loss: 2.530 Vali Acc: 0.640 Test Loss: 2.530 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5506832
	speed: 0.1240s/iter; left time: 4334.9142s
	iters: 200, epoch: 6 | loss: 0.1440741
	speed: 0.0262s/iter; left time: 913.4656s
	iters: 300, epoch: 6 | loss: 1.4618261
	speed: 0.0276s/iter; left time: 960.7740s
Epoch: 6 cost time: 10.347875118255615
Epoch: 6, Steps: 369 | Train Loss: 0.726 Vali Loss: 2.345 Vali Acc: 0.634 Test Loss: 2.345 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.8660840
	speed: 0.1006s/iter; left time: 3480.6943s
	iters: 200, epoch: 7 | loss: 0.5417936
	speed: 0.0269s/iter; left time: 929.0441s
	iters: 300, epoch: 7 | loss: 0.5823947
	speed: 0.0278s/iter; left time: 955.1672s
Epoch: 7 cost time: 9.314435243606567
Epoch: 7, Steps: 369 | Train Loss: 0.535 Vali Loss: 2.406 Vali Acc: 0.618 Test Loss: 2.406 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1755038
	speed: 0.1261s/iter; left time: 4316.5337s
	iters: 200, epoch: 8 | loss: 0.8210747
	speed: 0.0278s/iter; left time: 946.9821s
	iters: 300, epoch: 8 | loss: 0.3229295
	speed: 0.0276s/iter; left time: 938.9551s
Epoch: 8 cost time: 10.739283800125122
Epoch: 8, Steps: 369 | Train Loss: 0.416 Vali Loss: 1.992 Vali Acc: 0.636 Test Loss: 1.992 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.9397253
	speed: 0.1315s/iter; left time: 4451.0949s
	iters: 200, epoch: 9 | loss: 0.0545053
	speed: 0.0166s/iter; left time: 559.6565s
	iters: 300, epoch: 9 | loss: 0.1158012
	speed: 0.0132s/iter; left time: 444.1835s
Epoch: 9 cost time: 7.184251308441162
Epoch: 9, Steps: 369 | Train Loss: 0.337 Vali Loss: 1.938 Vali Acc: 0.643 Test Loss: 1.938 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.3647673
	speed: 0.0646s/iter; left time: 2162.9878s
	iters: 200, epoch: 10 | loss: 0.0264686
	speed: 0.0123s/iter; left time: 410.2160s
	iters: 300, epoch: 10 | loss: 0.4688293
	speed: 0.0138s/iter; left time: 460.2810s
Epoch: 10 cost time: 5.368592023849487
Epoch: 10, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.895 Vali Acc: 0.626 Test Loss: 1.895 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.3674017
	speed: 0.0652s/iter; left time: 2159.7394s
	iters: 200, epoch: 11 | loss: 0.1925346
	speed: 0.0122s/iter; left time: 401.8582s
	iters: 300, epoch: 11 | loss: 0.1918115
	speed: 0.0129s/iter; left time: 423.3310s
Epoch: 11 cost time: 5.324624538421631
Epoch: 11, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.690 Vali Acc: 0.649 Test Loss: 1.690 Test Acc: 0.649
Validation loss decreased (-0.646409 --> -0.648962).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4634766
	speed: 0.0860s/iter; left time: 2815.1202s
	iters: 200, epoch: 12 | loss: 0.3102986
	speed: 0.0288s/iter; left time: 941.6948s
	iters: 300, epoch: 12 | loss: 0.0483022
	speed: 0.0299s/iter; left time: 973.6135s
Epoch: 12 cost time: 11.38424825668335
Epoch: 12, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.818 Vali Acc: 0.630 Test Loss: 1.818 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0044489
	speed: 0.1352s/iter; left time: 4375.4819s
	iters: 200, epoch: 13 | loss: 0.0312736
	speed: 0.0296s/iter; left time: 955.6300s
	iters: 300, epoch: 13 | loss: 0.2598065
	speed: 0.0289s/iter; left time: 930.5241s
Epoch: 13 cost time: 11.479559659957886
Epoch: 13, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.862 Vali Acc: 0.642 Test Loss: 1.862 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0135056
	speed: 0.1369s/iter; left time: 4380.5012s
	iters: 200, epoch: 14 | loss: 0.1437699
	speed: 0.0309s/iter; left time: 985.3699s
	iters: 300, epoch: 14 | loss: 0.1969334
	speed: 0.0305s/iter; left time: 969.2111s
Epoch: 14 cost time: 11.82593560218811
Epoch: 14, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.834 Vali Acc: 0.648 Test Loss: 1.834 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1269218
	speed: 0.1346s/iter; left time: 4258.6975s
	iters: 200, epoch: 15 | loss: 0.5154237
	speed: 0.0297s/iter; left time: 936.1431s
	iters: 300, epoch: 15 | loss: 0.0183775
	speed: 0.0294s/iter; left time: 925.1654s
Epoch: 15 cost time: 11.555591583251953
Epoch: 15, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.886 Vali Acc: 0.641 Test Loss: 1.886 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0160551
	speed: 0.1348s/iter; left time: 4215.0768s
	iters: 200, epoch: 16 | loss: 0.0221728
	speed: 0.0299s/iter; left time: 931.1287s
	iters: 300, epoch: 16 | loss: 0.0163258
	speed: 0.0297s/iter; left time: 923.3822s
Epoch: 16 cost time: 11.563454866409302
Epoch: 16, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.952 Vali Acc: 0.640 Test Loss: 1.952 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0496994
	speed: 0.1291s/iter; left time: 3988.7322s
	iters: 200, epoch: 17 | loss: 0.0032853
	speed: 0.0300s/iter; left time: 924.3669s
	iters: 300, epoch: 17 | loss: 0.0075067
	speed: 0.0301s/iter; left time: 923.1662s
Epoch: 17 cost time: 11.713560104370117
Epoch: 17, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.947 Vali Acc: 0.648 Test Loss: 1.947 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0028933
	speed: 0.1255s/iter; left time: 3832.5976s
	iters: 200, epoch: 18 | loss: 0.0228360
	speed: 0.0239s/iter; left time: 728.2127s
	iters: 300, epoch: 18 | loss: 0.1070282
	speed: 0.0243s/iter; left time: 736.6964s
Epoch: 18 cost time: 9.607040643692017
Epoch: 18, Steps: 369 | Train Loss: 0.079 Vali Loss: 1.967 Vali Acc: 0.650 Test Loss: 1.967 Test Acc: 0.650
Validation loss decreased (-0.648962 --> -0.649526).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0127600
	speed: 0.1176s/iter; left time: 3547.5310s
	iters: 200, epoch: 19 | loss: 0.0042925
	speed: 0.0238s/iter; left time: 714.4206s
	iters: 300, epoch: 19 | loss: 0.0323043
	speed: 0.0237s/iter; left time: 711.3024s
Epoch: 19 cost time: 9.37362289428711
Epoch: 19, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.091 Vali Acc: 0.634 Test Loss: 2.091 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0072841
	speed: 0.1135s/iter; left time: 3381.3587s
	iters: 200, epoch: 20 | loss: 0.0208637
	speed: 0.0226s/iter; left time: 672.3725s
	iters: 300, epoch: 20 | loss: 0.0117826
	speed: 0.0235s/iter; left time: 695.5564s
Epoch: 20 cost time: 8.752346277236938
Epoch: 20, Steps: 369 | Train Loss: 0.074 Vali Loss: 2.201 Vali Acc: 0.641 Test Loss: 2.201 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0052386
	speed: 0.1226s/iter; left time: 3607.1670s
	iters: 200, epoch: 21 | loss: 0.0211557
	speed: 0.0236s/iter; left time: 690.5442s
	iters: 300, epoch: 21 | loss: 0.0739903
	speed: 0.0233s/iter; left time: 681.8984s
Epoch: 21 cost time: 9.262163639068604
Epoch: 21, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.085 Vali Acc: 0.652 Test Loss: 2.085 Test Acc: 0.652
Validation loss decreased (-0.649526 --> -0.652079).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0669017
	speed: 0.1231s/iter; left time: 3575.0849s
	iters: 200, epoch: 22 | loss: 0.0451268
	speed: 0.0165s/iter; left time: 476.8134s
	iters: 300, epoch: 22 | loss: 0.0542756
	speed: 0.0293s/iter; left time: 845.3815s
Epoch: 22 cost time: 9.587811946868896
Epoch: 22, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.234 Vali Acc: 0.627 Test Loss: 2.234 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1251118
	speed: 0.1305s/iter; left time: 3742.2003s
	iters: 200, epoch: 23 | loss: 0.1609748
	speed: 0.0297s/iter; left time: 849.0757s
	iters: 300, epoch: 23 | loss: 0.1453986
	speed: 0.0296s/iter; left time: 842.8951s
Epoch: 23 cost time: 11.373387098312378
Epoch: 23, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.198 Vali Acc: 0.647 Test Loss: 2.198 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1014426
	speed: 0.1322s/iter; left time: 3742.5417s
	iters: 200, epoch: 24 | loss: 0.0091727
	speed: 0.0297s/iter; left time: 837.4547s
	iters: 300, epoch: 24 | loss: 0.1992108
	speed: 0.0288s/iter; left time: 810.6427s
Epoch: 24 cost time: 11.392405271530151
Epoch: 24, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.408 Vali Acc: 0.639 Test Loss: 2.408 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0047862
	speed: 0.1356s/iter; left time: 3788.8364s
	iters: 200, epoch: 25 | loss: 0.1393998
	speed: 0.0308s/iter; left time: 856.6245s
	iters: 300, epoch: 25 | loss: 0.0183927
	speed: 0.0301s/iter; left time: 834.6590s
Epoch: 25 cost time: 11.818100452423096
Epoch: 25, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.379 Vali Acc: 0.635 Test Loss: 2.379 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0144871
	speed: 0.1332s/iter; left time: 3674.0976s
	iters: 200, epoch: 26 | loss: 0.0028810
	speed: 0.0307s/iter; left time: 842.6591s
	iters: 300, epoch: 26 | loss: 0.0099625
	speed: 0.0304s/iter; left time: 832.9820s
Epoch: 26 cost time: 11.876811265945435
Epoch: 26, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.398 Vali Acc: 0.634 Test Loss: 2.398 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1117488
	speed: 0.1310s/iter; left time: 3563.8773s
	iters: 200, epoch: 27 | loss: 0.0023162
	speed: 0.0304s/iter; left time: 823.9929s
	iters: 300, epoch: 27 | loss: 0.0304644
	speed: 0.0303s/iter; left time: 817.5553s
Epoch: 27 cost time: 11.67263650894165
Epoch: 27, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.517 Vali Acc: 0.643 Test Loss: 2.517 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0148703
	speed: 0.1393s/iter; left time: 3737.9132s
	iters: 200, epoch: 28 | loss: 0.3768280
	speed: 0.0293s/iter; left time: 782.8600s
	iters: 300, epoch: 28 | loss: 0.0031758
	speed: 0.0188s/iter; left time: 500.3928s
Epoch: 28 cost time: 10.068420886993408
Epoch: 28, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.351 Vali Acc: 0.644 Test Loss: 2.351 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0250941
	speed: 0.1223s/iter; left time: 3235.9321s
	iters: 200, epoch: 29 | loss: 0.0201626
	speed: 0.0242s/iter; left time: 638.2617s
	iters: 300, epoch: 29 | loss: 0.0045935
	speed: 0.0243s/iter; left time: 637.7373s
Epoch: 29 cost time: 9.582546472549438
Epoch: 29, Steps: 369 | Train Loss: 0.040 Vali Loss: 2.432 Vali Acc: 0.643 Test Loss: 2.432 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0722289
	speed: 0.1213s/iter; left time: 3165.3409s
	iters: 200, epoch: 30 | loss: 0.0774469
	speed: 0.0238s/iter; left time: 618.7298s
	iters: 300, epoch: 30 | loss: 0.0037054
	speed: 0.0188s/iter; left time: 486.9531s
Epoch: 30 cost time: 9.042060852050781
Epoch: 30, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.497 Vali Acc: 0.643 Test Loss: 2.497 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0027957
	speed: 0.1181s/iter; left time: 3038.1477s
	iters: 200, epoch: 31 | loss: 0.0218601
	speed: 0.0238s/iter; left time: 610.6303s
	iters: 300, epoch: 31 | loss: 0.3489000
	speed: 0.0236s/iter; left time: 601.6551s
Epoch: 31 cost time: 9.416692972183228
Epoch: 31, Steps: 369 | Train Loss: 0.049 Vali Loss: 2.400 Vali Acc: 0.651 Test Loss: 2.400 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6520998864926221
model parameter : 104450
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7899319
	speed: 0.0421s/iter; left time: 1549.5236s
	iters: 200, epoch: 1 | loss: 0.5249732
	speed: 0.0288s/iter; left time: 1057.6637s
	iters: 300, epoch: 1 | loss: 0.5796370
	speed: 0.0289s/iter; left time: 1058.2554s
Epoch: 1 cost time: 12.011039018630981
Epoch: 1, Steps: 369 | Train Loss: 0.817 Vali Loss: 1.404 Vali Acc: 0.631 Test Loss: 1.404 Test Acc: 0.631
Validation loss decreased (inf --> -0.630803).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5537301
	speed: 0.1141s/iter; left time: 4157.6345s
	iters: 200, epoch: 2 | loss: 0.7217337
	speed: 0.0290s/iter; left time: 1053.0258s
	iters: 300, epoch: 2 | loss: 0.2601146
	speed: 0.0282s/iter; left time: 1021.8827s
Epoch: 2 cost time: 10.965452194213867
Epoch: 2, Steps: 369 | Train Loss: 0.881 Vali Loss: 1.743 Vali Acc: 0.618 Test Loss: 1.743 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1305889
	speed: 0.1228s/iter; left time: 4428.9271s
	iters: 200, epoch: 3 | loss: 0.8536651
	speed: 0.0274s/iter; left time: 984.6603s
	iters: 300, epoch: 3 | loss: 2.1147020
	speed: 0.0279s/iter; left time: 1001.4728s
Epoch: 3 cost time: 10.761905670166016
Epoch: 3, Steps: 369 | Train Loss: 0.838 Vali Loss: 1.861 Vali Acc: 0.635 Test Loss: 1.861 Test Acc: 0.635
Validation loss decreased (-0.630803 --> -0.634488).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0218400
	speed: 0.1200s/iter; left time: 4282.3161s
	iters: 200, epoch: 4 | loss: 0.5984319
	speed: 0.0278s/iter; left time: 987.8744s
	iters: 300, epoch: 4 | loss: 0.1113282
	speed: 0.0273s/iter; left time: 967.6989s
Epoch: 4 cost time: 10.740825891494751
Epoch: 4, Steps: 369 | Train Loss: 0.783 Vali Loss: 2.184 Vali Acc: 0.642 Test Loss: 2.184 Test Acc: 0.642
Validation loss decreased (-0.634488 --> -0.641579).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1395974
	speed: 0.1187s/iter; left time: 4193.5181s
	iters: 200, epoch: 5 | loss: 0.6210961
	speed: 0.0278s/iter; left time: 980.5645s
	iters: 300, epoch: 5 | loss: 0.9958774
	speed: 0.0270s/iter; left time: 947.9515s
Epoch: 5 cost time: 10.842534303665161
Epoch: 5, Steps: 369 | Train Loss: 0.724 Vali Loss: 2.164 Vali Acc: 0.640 Test Loss: 2.164 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4725273
	speed: 0.1259s/iter; left time: 4400.5640s
	iters: 200, epoch: 6 | loss: 0.1808496
	speed: 0.0275s/iter; left time: 959.4670s
	iters: 300, epoch: 6 | loss: 1.4047140
	speed: 0.0255s/iter; left time: 884.6961s
Epoch: 6 cost time: 9.555298089981079
Epoch: 6, Steps: 369 | Train Loss: 0.614 Vali Loss: 2.209 Vali Acc: 0.637 Test Loss: 2.209 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2612460
	speed: 0.1090s/iter; left time: 3770.2585s
	iters: 200, epoch: 7 | loss: 0.7920651
	speed: 0.0228s/iter; left time: 786.8750s
	iters: 300, epoch: 7 | loss: 0.6819911
	speed: 0.0226s/iter; left time: 776.4515s
Epoch: 7 cost time: 8.958357572555542
Epoch: 7, Steps: 369 | Train Loss: 0.496 Vali Loss: 2.067 Vali Acc: 0.629 Test Loss: 2.067 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5161676
	speed: 0.1076s/iter; left time: 3681.4843s
	iters: 200, epoch: 8 | loss: 0.1624493
	speed: 0.0216s/iter; left time: 738.2252s
	iters: 300, epoch: 8 | loss: 0.7656656
	speed: 0.0228s/iter; left time: 775.0643s
Epoch: 8 cost time: 8.94394326210022
Epoch: 8, Steps: 369 | Train Loss: 0.406 Vali Loss: 1.989 Vali Acc: 0.657 Test Loss: 1.989 Test Acc: 0.657
Validation loss decreased (-0.641579 --> -0.656904).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0447792
	speed: 0.0989s/iter; left time: 3348.7974s
	iters: 200, epoch: 9 | loss: 0.2452135
	speed: 0.0228s/iter; left time: 768.6668s
	iters: 300, epoch: 9 | loss: 0.4111847
	speed: 0.0232s/iter; left time: 779.2080s
Epoch: 9 cost time: 8.99034309387207
Epoch: 9, Steps: 369 | Train Loss: 0.318 Vali Loss: 1.897 Vali Acc: 0.631 Test Loss: 1.897 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0105341
	speed: 0.1097s/iter; left time: 3673.2517s
	iters: 200, epoch: 10 | loss: 0.3205469
	speed: 0.0223s/iter; left time: 743.8333s
	iters: 300, epoch: 10 | loss: 0.0260286
	speed: 0.0227s/iter; left time: 756.0676s
Epoch: 10 cost time: 8.927980422973633
Epoch: 10, Steps: 369 | Train Loss: 0.259 Vali Loss: 1.829 Vali Acc: 0.648 Test Loss: 1.829 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0707137
	speed: 0.1043s/iter; left time: 3453.7561s
	iters: 200, epoch: 11 | loss: 0.3011005
	speed: 0.0283s/iter; left time: 935.4568s
	iters: 300, epoch: 11 | loss: 0.2260763
	speed: 0.0283s/iter; left time: 932.6268s
Epoch: 11 cost time: 10.796064376831055
Epoch: 11, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.804 Vali Acc: 0.648 Test Loss: 1.804 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0689490
	speed: 0.1135s/iter; left time: 3717.0106s
	iters: 200, epoch: 12 | loss: 0.0496139
	speed: 0.0287s/iter; left time: 938.1811s
	iters: 300, epoch: 12 | loss: 0.5924333
	speed: 0.0271s/iter; left time: 882.9282s
Epoch: 12 cost time: 10.893954277038574
Epoch: 12, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.787 Vali Acc: 0.650 Test Loss: 1.787 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1674714
	speed: 0.1127s/iter; left time: 3648.2630s
	iters: 200, epoch: 13 | loss: 0.1239047
	speed: 0.0273s/iter; left time: 882.1629s
	iters: 300, epoch: 13 | loss: 0.3560220
	speed: 0.0274s/iter; left time: 881.7725s
Epoch: 13 cost time: 10.5142982006073
Epoch: 13, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.794 Vali Acc: 0.634 Test Loss: 1.794 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7265645
	speed: 0.1175s/iter; left time: 3760.5812s
	iters: 200, epoch: 14 | loss: 0.1091491
	speed: 0.0271s/iter; left time: 865.5890s
	iters: 300, epoch: 14 | loss: 0.0445915
	speed: 0.0278s/iter; left time: 883.6640s
Epoch: 14 cost time: 10.622143268585205
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.748 Vali Acc: 0.654 Test Loss: 1.748 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0556522
	speed: 0.1154s/iter; left time: 3651.0600s
	iters: 200, epoch: 15 | loss: 0.0068472
	speed: 0.0276s/iter; left time: 871.4872s
	iters: 300, epoch: 15 | loss: 0.1201694
	speed: 0.0268s/iter; left time: 843.7684s
Epoch: 15 cost time: 10.65000295639038
Epoch: 15, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.887 Vali Acc: 0.652 Test Loss: 1.887 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6518844
	speed: 0.1163s/iter; left time: 3637.4578s
	iters: 200, epoch: 16 | loss: 0.0163230
	speed: 0.0275s/iter; left time: 858.1066s
	iters: 300, epoch: 16 | loss: 0.1298822
	speed: 0.0280s/iter; left time: 868.8463s
Epoch: 16 cost time: 10.770437479019165
Epoch: 16, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.948 Vali Acc: 0.636 Test Loss: 1.948 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0096599
	speed: 0.1211s/iter; left time: 3742.3782s
	iters: 200, epoch: 17 | loss: 0.2607654
	speed: 0.0269s/iter; left time: 827.0373s
	iters: 300, epoch: 17 | loss: 0.1642285
	speed: 0.0269s/iter; left time: 826.8106s
Epoch: 17 cost time: 10.66214656829834
Epoch: 17, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.946 Vali Acc: 0.649 Test Loss: 1.946 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2863379
	speed: 0.1057s/iter; left time: 3225.9757s
	iters: 200, epoch: 18 | loss: 0.0394255
	speed: 0.0226s/iter; left time: 686.1605s
	iters: 300, epoch: 18 | loss: 0.0281950
	speed: 0.0230s/iter; left time: 697.7740s
Epoch: 18 cost time: 8.894360303878784
Epoch: 18, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.992 Vali Acc: 0.645 Test Loss: 1.992 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6569239500567536
model parameter : 86114
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3325803
	speed: 0.0905s/iter; left time: 3330.0048s
	iters: 200, epoch: 1 | loss: 4.6525192
	speed: 0.0744s/iter; left time: 2732.1974s
	iters: 300, epoch: 1 | loss: 0.3475146
	speed: 0.0734s/iter; left time: 2686.6957s
Epoch: 1 cost time: 28.953881978988647
Epoch: 1, Steps: 369 | Train Loss: 2.902 Vali Loss: 2.946 Vali Acc: 0.605 Test Loss: 2.946 Test Acc: 0.605
Validation loss decreased (inf --> -0.604681).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6075599
	speed: 0.3048s/iter; left time: 11104.6151s
	iters: 200, epoch: 2 | loss: 2.9465649
	speed: 0.0894s/iter; left time: 3248.3055s
	iters: 300, epoch: 2 | loss: 3.2782719
	speed: 0.0906s/iter; left time: 3280.8690s
Epoch: 2 cost time: 33.635860204696655
Epoch: 2, Steps: 369 | Train Loss: 2.210 Vali Loss: 2.085 Vali Acc: 0.655 Test Loss: 2.085 Test Acc: 0.655
Validation loss decreased (-0.604681 --> -0.654633).  Saving model ...
	iters: 100, epoch: 3 | loss: 7.8239737
	speed: 0.3365s/iter; left time: 12135.4638s
	iters: 200, epoch: 3 | loss: 4.1584320
	speed: 0.0896s/iter; left time: 3223.7387s
	iters: 300, epoch: 3 | loss: 2.3727007
	speed: 0.0898s/iter; left time: 3221.7807s
Epoch: 3 cost time: 33.60266470909119
Epoch: 3, Steps: 369 | Train Loss: 2.808 Vali Loss: 3.889 Vali Acc: 0.637 Test Loss: 3.889 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5311058
	speed: 0.3317s/iter; left time: 11839.6079s
	iters: 200, epoch: 4 | loss: 1.4837102
	speed: 0.0898s/iter; left time: 3195.6892s
	iters: 300, epoch: 4 | loss: 2.6184616
	speed: 0.0930s/iter; left time: 3302.6398s
Epoch: 4 cost time: 33.981574296951294
Epoch: 4, Steps: 369 | Train Loss: 2.746 Vali Loss: 4.303 Vali Acc: 0.640 Test Loss: 4.303 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.1303163
	speed: 0.2851s/iter; left time: 10069.8676s
	iters: 200, epoch: 5 | loss: 1.3039206
	speed: 0.0757s/iter; left time: 2665.1462s
	iters: 300, epoch: 5 | loss: 2.6678011
	speed: 0.0765s/iter; left time: 2686.5342s
Epoch: 5 cost time: 28.603475332260132
Epoch: 5, Steps: 369 | Train Loss: 2.104 Vali Loss: 4.520 Vali Acc: 0.656 Test Loss: 4.520 Test Acc: 0.656
Validation loss decreased (-0.654633 --> -0.656311).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4158652
	speed: 0.2709s/iter; left time: 9467.9484s
	iters: 200, epoch: 6 | loss: 0.1107755
	speed: 0.0730s/iter; left time: 2543.2148s
	iters: 300, epoch: 6 | loss: 0.5916803
	speed: 0.0726s/iter; left time: 2524.9804s
Epoch: 6 cost time: 27.398271322250366
Epoch: 6, Steps: 369 | Train Loss: 1.645 Vali Loss: 5.097 Vali Acc: 0.626 Test Loss: 5.097 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6092267
	speed: 0.2830s/iter; left time: 9786.9513s
	iters: 200, epoch: 7 | loss: 1.8812255
	speed: 0.0889s/iter; left time: 3065.6667s
	iters: 300, epoch: 7 | loss: 0.7770479
	speed: 0.0917s/iter; left time: 3152.7139s
Epoch: 7 cost time: 33.722431898117065
Epoch: 7, Steps: 369 | Train Loss: 1.029 Vali Loss: 4.538 Vali Acc: 0.629 Test Loss: 4.538 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0591987
	speed: 0.3320s/iter; left time: 11361.9231s
	iters: 200, epoch: 8 | loss: 0.0477943
	speed: 0.0870s/iter; left time: 2967.1967s
	iters: 300, epoch: 8 | loss: 0.1943827
	speed: 0.0924s/iter; left time: 3144.5912s
Epoch: 8 cost time: 33.53395986557007
Epoch: 8, Steps: 369 | Train Loss: 0.545 Vali Loss: 3.082 Vali Acc: 0.636 Test Loss: 3.082 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0040371
	speed: 0.3341s/iter; left time: 11310.2425s
	iters: 200, epoch: 9 | loss: 0.6213177
	speed: 0.0890s/iter; left time: 3004.0464s
	iters: 300, epoch: 9 | loss: 0.3169117
	speed: 0.0889s/iter; left time: 2991.7020s
Epoch: 9 cost time: 33.598103523254395
Epoch: 9, Steps: 369 | Train Loss: 0.282 Vali Loss: 3.652 Vali Acc: 0.604 Test Loss: 3.652 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2370364
	speed: 0.3067s/iter; left time: 10269.2185s
	iters: 200, epoch: 10 | loss: 0.0034466
	speed: 0.0702s/iter; left time: 2344.2160s
	iters: 300, epoch: 10 | loss: 0.3523511
	speed: 0.0702s/iter; left time: 2335.5167s
Epoch: 10 cost time: 26.796569347381592
Epoch: 10, Steps: 369 | Train Loss: 0.196 Vali Loss: 3.590 Vali Acc: 0.633 Test Loss: 3.590 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0453035
	speed: 0.2645s/iter; left time: 8756.7251s
	iters: 200, epoch: 11 | loss: 0.0199396
	speed: 0.0752s/iter; left time: 2483.8218s
	iters: 300, epoch: 11 | loss: 0.0159921
	speed: 0.0723s/iter; left time: 2379.4171s
Epoch: 11 cost time: 27.09868884086609
Epoch: 11, Steps: 369 | Train Loss: 0.146 Vali Loss: 3.086 Vali Acc: 0.646 Test Loss: 3.086 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0051219
	speed: 0.2757s/iter; left time: 9028.5075s
	iters: 200, epoch: 12 | loss: 0.4037998
	speed: 0.0765s/iter; left time: 2497.4142s
	iters: 300, epoch: 12 | loss: 0.0012687
	speed: 0.0861s/iter; left time: 2800.8804s
Epoch: 12 cost time: 30.317532539367676
Epoch: 12, Steps: 369 | Train Loss: 0.122 Vali Loss: 2.858 Vali Acc: 0.651 Test Loss: 2.858 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0927108
	speed: 0.3256s/iter; left time: 10540.2666s
	iters: 200, epoch: 13 | loss: 0.0000452
	speed: 0.0902s/iter; left time: 2911.6962s
	iters: 300, epoch: 13 | loss: 0.5578852
	speed: 0.0935s/iter; left time: 3007.3121s
Epoch: 13 cost time: 34.27643084526062
Epoch: 13, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.590 Vali Acc: 0.627 Test Loss: 2.590 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0095508
	speed: 0.3304s/iter; left time: 10575.2239s
	iters: 200, epoch: 14 | loss: 0.0026043
	speed: 0.0885s/iter; left time: 2824.9559s
	iters: 300, epoch: 14 | loss: 0.2069560
	speed: 0.0929s/iter; left time: 2953.7002s
Epoch: 14 cost time: 33.90305495262146
Epoch: 14, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.617 Vali Acc: 0.635 Test Loss: 2.617 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4646089
	speed: 0.3318s/iter; left time: 10497.0625s
	iters: 200, epoch: 15 | loss: 0.0015329
	speed: 0.0777s/iter; left time: 2449.5457s
	iters: 300, epoch: 15 | loss: 0.2639468
	speed: 0.0732s/iter; left time: 2301.8217s
Epoch: 15 cost time: 29.79379630088806
Epoch: 15, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.622 Vali Acc: 0.630 Test Loss: 2.622 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6563564131668559
model parameter : 584226
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4469488
	speed: 0.0574s/iter; left time: 2111.9669s
	iters: 200, epoch: 1 | loss: 1.4962873
	speed: 0.0385s/iter; left time: 1411.9941s
	iters: 300, epoch: 1 | loss: 3.6004434
	speed: 0.0386s/iter; left time: 1414.5999s
Epoch: 1 cost time: 16.1860671043396
Epoch: 1, Steps: 369 | Train Loss: 1.686 Vali Loss: 2.004 Vali Acc: 0.619 Test Loss: 2.004 Test Acc: 0.619
Validation loss decreased (inf --> -0.618879).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8674669
	speed: 0.1874s/iter; left time: 6827.5947s
	iters: 200, epoch: 2 | loss: 1.8511448
	speed: 0.0504s/iter; left time: 1831.0794s
	iters: 300, epoch: 2 | loss: 2.2635140
	speed: 0.0508s/iter; left time: 1841.7767s
Epoch: 2 cost time: 19.204538345336914
Epoch: 2, Steps: 369 | Train Loss: 1.652 Vali Loss: 1.630 Vali Acc: 0.648 Test Loss: 1.630 Test Acc: 0.648
Validation loss decreased (-0.618879 --> -0.648395).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5623417
	speed: 0.2087s/iter; left time: 7527.7880s
	iters: 200, epoch: 3 | loss: 1.4285674
	speed: 0.0497s/iter; left time: 1787.4219s
	iters: 300, epoch: 3 | loss: 2.2911525
	speed: 0.0493s/iter; left time: 1768.1102s
Epoch: 3 cost time: 18.968035459518433
Epoch: 3, Steps: 369 | Train Loss: 1.859 Vali Loss: 2.561 Vali Acc: 0.632 Test Loss: 2.561 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6867533
	speed: 0.2111s/iter; left time: 7536.5175s
	iters: 200, epoch: 4 | loss: 3.7135277
	speed: 0.0497s/iter; left time: 1767.5940s
	iters: 300, epoch: 4 | loss: 2.5517707
	speed: 0.0500s/iter; left time: 1775.3974s
Epoch: 4 cost time: 19.06612515449524
Epoch: 4, Steps: 369 | Train Loss: 2.012 Vali Loss: 2.582 Vali Acc: 0.631 Test Loss: 2.582 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9184249
	speed: 0.2133s/iter; left time: 7534.8858s
	iters: 200, epoch: 5 | loss: 2.0897388
	speed: 0.0506s/iter; left time: 1783.0551s
	iters: 300, epoch: 5 | loss: 4.3724108
	speed: 0.0489s/iter; left time: 1717.1820s
Epoch: 5 cost time: 19.15090012550354
Epoch: 5, Steps: 369 | Train Loss: 1.693 Vali Loss: 3.568 Vali Acc: 0.635 Test Loss: 3.568 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6918650
	speed: 0.1922s/iter; left time: 6719.3045s
	iters: 200, epoch: 6 | loss: 0.8707216
	speed: 0.0393s/iter; left time: 1369.9168s
	iters: 300, epoch: 6 | loss: 2.7188730
	speed: 0.0386s/iter; left time: 1342.3348s
Epoch: 6 cost time: 14.935671329498291
Epoch: 6, Steps: 369 | Train Loss: 1.252 Vali Loss: 3.590 Vali Acc: 0.617 Test Loss: 3.590 Test Acc: 0.617
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0003662
	speed: 0.1761s/iter; left time: 6089.2383s
	iters: 200, epoch: 7 | loss: 0.5142097
	speed: 0.0398s/iter; left time: 1372.5708s
	iters: 300, epoch: 7 | loss: 0.9604881
	speed: 0.0394s/iter; left time: 1354.9792s
Epoch: 7 cost time: 15.27461552619934
Epoch: 7, Steps: 369 | Train Loss: 0.799 Vali Loss: 2.305 Vali Acc: 0.638 Test Loss: 2.305 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2716498
	speed: 0.1734s/iter; left time: 5933.8556s
	iters: 200, epoch: 8 | loss: 0.5085717
	speed: 0.0403s/iter; left time: 1373.4391s
	iters: 300, epoch: 8 | loss: 0.8540758
	speed: 0.0403s/iter; left time: 1370.3541s
Epoch: 8 cost time: 15.389453887939453
Epoch: 8, Steps: 369 | Train Loss: 0.450 Vali Loss: 1.951 Vali Acc: 0.646 Test Loss: 1.951 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0095677
	speed: 0.1749s/iter; left time: 5919.2937s
	iters: 200, epoch: 9 | loss: 0.0729608
	speed: 0.0360s/iter; left time: 1215.4466s
	iters: 300, epoch: 9 | loss: 0.3506930
	speed: 0.0484s/iter; left time: 1629.4408s
Epoch: 9 cost time: 16.474068880081177
Epoch: 9, Steps: 369 | Train Loss: 0.285 Vali Loss: 1.667 Vali Acc: 0.641 Test Loss: 1.667 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0754893
	speed: 0.2101s/iter; left time: 7033.0043s
	iters: 200, epoch: 10 | loss: 0.2646097
	speed: 0.0509s/iter; left time: 1700.1060s
	iters: 300, epoch: 10 | loss: 0.1221384
	speed: 0.0506s/iter; left time: 1684.2035s
Epoch: 10 cost time: 19.2345449924469
Epoch: 10, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.615 Vali Acc: 0.640 Test Loss: 1.615 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2927542
	speed: 0.2099s/iter; left time: 6950.4835s
	iters: 200, epoch: 11 | loss: 0.1658881
	speed: 0.0498s/iter; left time: 1645.0722s
	iters: 300, epoch: 11 | loss: 0.5420642
	speed: 0.0495s/iter; left time: 1628.1188s
Epoch: 11 cost time: 19.05010962486267
Epoch: 11, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.652 Vali Acc: 0.638 Test Loss: 1.652 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0393166
	speed: 0.2118s/iter; left time: 6933.7663s
	iters: 200, epoch: 12 | loss: 0.0354252
	speed: 0.0497s/iter; left time: 1623.4738s
	iters: 300, epoch: 12 | loss: 0.0977173
	speed: 0.0502s/iter; left time: 1633.5130s
Epoch: 12 cost time: 19.068622827529907
Epoch: 12, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.887 Vali Acc: 0.631 Test Loss: 1.887 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.648410896708286
model parameter : 298594
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0706609
	speed: 0.0478s/iter; left time: 1758.2951s
	iters: 200, epoch: 1 | loss: 0.3231821
	speed: 0.0320s/iter; left time: 1173.0924s
	iters: 300, epoch: 1 | loss: 1.9735770
	speed: 0.0314s/iter; left time: 1148.4486s
Epoch: 1 cost time: 13.343640327453613
Epoch: 1, Steps: 369 | Train Loss: 1.377 Vali Loss: 1.924 Vali Acc: 0.626 Test Loss: 1.924 Test Acc: 0.626
Validation loss decreased (inf --> -0.625974).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7675879
	speed: 0.1510s/iter; left time: 5499.6078s
	iters: 200, epoch: 2 | loss: 1.6121863
	speed: 0.0302s/iter; left time: 1097.1798s
	iters: 300, epoch: 2 | loss: 0.6485831
	speed: 0.0299s/iter; left time: 1081.5829s
Epoch: 2 cost time: 11.55214786529541
Epoch: 2, Steps: 369 | Train Loss: 1.335 Vali Loss: 1.860 Vali Acc: 0.641 Test Loss: 1.860 Test Acc: 0.641
Validation loss decreased (-0.625974 --> -0.641298).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3286724
	speed: 0.1538s/iter; left time: 5547.9380s
	iters: 200, epoch: 3 | loss: 0.8361396
	speed: 0.0317s/iter; left time: 1139.1839s
	iters: 300, epoch: 3 | loss: 0.7047564
	speed: 0.0323s/iter; left time: 1157.5528s
Epoch: 3 cost time: 12.286888599395752
Epoch: 3, Steps: 369 | Train Loss: 1.558 Vali Loss: 2.370 Vali Acc: 0.635 Test Loss: 2.370 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1663685
	speed: 0.1590s/iter; left time: 5674.0513s
	iters: 200, epoch: 4 | loss: 0.8047402
	speed: 0.0403s/iter; left time: 1435.4532s
	iters: 300, epoch: 4 | loss: 1.4827368
	speed: 0.0397s/iter; left time: 1410.6449s
Epoch: 4 cost time: 15.443913221359253
Epoch: 4, Steps: 369 | Train Loss: 1.482 Vali Loss: 2.923 Vali Acc: 0.649 Test Loss: 2.923 Test Acc: 0.649
Validation loss decreased (-0.641298 --> -0.648949).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9327214
	speed: 0.1779s/iter; left time: 6285.8379s
	iters: 200, epoch: 5 | loss: 0.1776899
	speed: 0.0401s/iter; left time: 1411.6156s
	iters: 300, epoch: 5 | loss: 2.2461350
	speed: 0.0415s/iter; left time: 1458.7730s
Epoch: 5 cost time: 15.68319821357727
Epoch: 5, Steps: 369 | Train Loss: 1.370 Vali Loss: 3.310 Vali Acc: 0.640 Test Loss: 3.310 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1394687
	speed: 0.1724s/iter; left time: 6027.9558s
	iters: 200, epoch: 6 | loss: 1.3046452
	speed: 0.0414s/iter; left time: 1441.6195s
	iters: 300, epoch: 6 | loss: 0.2189136
	speed: 0.0410s/iter; left time: 1424.8359s
Epoch: 6 cost time: 15.674299240112305
Epoch: 6, Steps: 369 | Train Loss: 1.074 Vali Loss: 2.513 Vali Acc: 0.635 Test Loss: 2.513 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9595369
	speed: 0.1751s/iter; left time: 6054.6426s
	iters: 200, epoch: 7 | loss: 0.8579542
	speed: 0.0410s/iter; left time: 1413.8861s
	iters: 300, epoch: 7 | loss: 0.6933038
	speed: 0.0410s/iter; left time: 1409.7740s
Epoch: 7 cost time: 15.659363508224487
Epoch: 7, Steps: 369 | Train Loss: 0.643 Vali Loss: 2.211 Vali Acc: 0.647 Test Loss: 2.211 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0119848
	speed: 0.1717s/iter; left time: 5874.4877s
	iters: 200, epoch: 8 | loss: 0.2701871
	speed: 0.0412s/iter; left time: 1406.3601s
	iters: 300, epoch: 8 | loss: 0.0185206
	speed: 0.0416s/iter; left time: 1414.2289s
Epoch: 8 cost time: 15.764346599578857
Epoch: 8, Steps: 369 | Train Loss: 0.400 Vali Loss: 1.788 Vali Acc: 0.647 Test Loss: 1.788 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0543217
	speed: 0.1570s/iter; left time: 5315.6625s
	iters: 200, epoch: 9 | loss: 0.4470732
	speed: 0.0307s/iter; left time: 1037.6542s
	iters: 300, epoch: 9 | loss: 0.2842653
	speed: 0.0304s/iter; left time: 1022.9144s
Epoch: 9 cost time: 11.810650825500488
Epoch: 9, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.673 Vali Acc: 0.635 Test Loss: 1.673 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0378742
	speed: 0.1549s/iter; left time: 5185.1775s
	iters: 200, epoch: 10 | loss: 0.0129618
	speed: 0.0305s/iter; left time: 1017.7161s
	iters: 300, epoch: 10 | loss: 0.4770192
	speed: 0.0302s/iter; left time: 1005.2829s
Epoch: 10 cost time: 11.887131214141846
Epoch: 10, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.595 Vali Acc: 0.632 Test Loss: 1.595 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0453572
	speed: 0.1469s/iter; left time: 4863.7755s
	iters: 200, epoch: 11 | loss: 0.0468341
	speed: 0.0302s/iter; left time: 997.0624s
	iters: 300, epoch: 11 | loss: 0.0359852
	speed: 0.0305s/iter; left time: 1004.7286s
Epoch: 11 cost time: 11.759455442428589
Epoch: 11, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.602 Vali Acc: 0.640 Test Loss: 1.602 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0080183
	speed: 0.1547s/iter; left time: 5064.0813s
	iters: 200, epoch: 12 | loss: 0.0270655
	speed: 0.0301s/iter; left time: 980.9701s
	iters: 300, epoch: 12 | loss: 0.0247692
	speed: 0.0299s/iter; left time: 974.0251s
Epoch: 12 cost time: 11.639619827270508
Epoch: 12, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.807 Vali Acc: 0.632 Test Loss: 1.807 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1073642
	speed: 0.1626s/iter; left time: 5264.7624s
	iters: 200, epoch: 13 | loss: 0.0016208
	speed: 0.0412s/iter; left time: 1329.4547s
	iters: 300, epoch: 13 | loss: 0.0301039
	speed: 0.0405s/iter; left time: 1303.6032s
Epoch: 13 cost time: 15.520591020584106
Epoch: 13, Steps: 369 | Train Loss: 0.078 Vali Loss: 1.981 Vali Acc: 0.635 Test Loss: 1.981 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1022283
	speed: 0.1716s/iter; left time: 5492.7678s
	iters: 200, epoch: 14 | loss: 0.1160343
	speed: 0.0407s/iter; left time: 1299.8394s
	iters: 300, epoch: 14 | loss: 0.2101495
	speed: 0.0406s/iter; left time: 1289.8923s
Epoch: 14 cost time: 15.401187181472778
Epoch: 14, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.120 Vali Acc: 0.642 Test Loss: 2.120 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6489784335981839
model parameter : 206466
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6741228
	speed: 0.0523s/iter; left time: 1924.3758s
	iters: 200, epoch: 1 | loss: 1.1468725
	speed: 0.0361s/iter; left time: 1323.9939s
	iters: 300, epoch: 1 | loss: 1.2840277
	speed: 0.0362s/iter; left time: 1325.2939s
Epoch: 1 cost time: 15.010366201400757
Epoch: 1, Steps: 369 | Train Loss: 1.138 Vali Loss: 1.748 Vali Acc: 0.625 Test Loss: 1.748 Test Acc: 0.625
Validation loss decreased (inf --> -0.625124).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9283340
	speed: 0.1394s/iter; left time: 5078.2303s
	iters: 200, epoch: 2 | loss: 0.9272402
	speed: 0.0261s/iter; left time: 948.0652s
	iters: 300, epoch: 2 | loss: 1.5009416
	speed: 0.0264s/iter; left time: 955.9037s
Epoch: 2 cost time: 10.313755989074707
Epoch: 2, Steps: 369 | Train Loss: 1.166 Vali Loss: 1.979 Vali Acc: 0.625 Test Loss: 1.979 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3365662
	speed: 0.1243s/iter; left time: 4481.7482s
	iters: 200, epoch: 3 | loss: 0.2623888
	speed: 0.0268s/iter; left time: 962.9658s
	iters: 300, epoch: 3 | loss: 1.4914151
	speed: 0.0265s/iter; left time: 952.1594s
Epoch: 3 cost time: 10.30924367904663
Epoch: 3, Steps: 369 | Train Loss: 1.221 Vali Loss: 2.164 Vali Acc: 0.649 Test Loss: 2.164 Test Acc: 0.649
Validation loss decreased (-0.625124 --> -0.649241).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4928000
	speed: 0.1231s/iter; left time: 4394.5417s
	iters: 200, epoch: 4 | loss: 1.0983047
	speed: 0.0266s/iter; left time: 946.0745s
	iters: 300, epoch: 4 | loss: 0.9623576
	speed: 0.0263s/iter; left time: 934.3528s
Epoch: 4 cost time: 10.257588386535645
Epoch: 4, Steps: 369 | Train Loss: 1.155 Vali Loss: 3.115 Vali Acc: 0.640 Test Loss: 3.115 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4362660
	speed: 0.1283s/iter; left time: 4531.1093s
	iters: 200, epoch: 5 | loss: 0.9962482
	speed: 0.0267s/iter; left time: 941.9439s
	iters: 300, epoch: 5 | loss: 1.4107398
	speed: 0.0268s/iter; left time: 939.8952s
Epoch: 5 cost time: 10.473336696624756
Epoch: 5, Steps: 369 | Train Loss: 1.074 Vali Loss: 2.851 Vali Acc: 0.628 Test Loss: 2.851 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1608254
	speed: 0.1202s/iter; left time: 4199.9792s
	iters: 200, epoch: 6 | loss: 0.3875865
	speed: 0.0349s/iter; left time: 1215.5918s
	iters: 300, epoch: 6 | loss: 1.3318473
	speed: 0.0374s/iter; left time: 1298.4236s
Epoch: 6 cost time: 12.811639547348022
Epoch: 6, Steps: 369 | Train Loss: 0.764 Vali Loss: 2.555 Vali Acc: 0.630 Test Loss: 2.555 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4718847
	speed: 0.1537s/iter; left time: 5316.3400s
	iters: 200, epoch: 7 | loss: 1.3665971
	speed: 0.0369s/iter; left time: 1271.3258s
	iters: 300, epoch: 7 | loss: 0.3396530
	speed: 0.0355s/iter; left time: 1221.6152s
Epoch: 7 cost time: 14.028537511825562
Epoch: 7, Steps: 369 | Train Loss: 0.603 Vali Loss: 2.229 Vali Acc: 0.636 Test Loss: 2.229 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.0702175
	speed: 0.1575s/iter; left time: 5389.0852s
	iters: 200, epoch: 8 | loss: 0.1283957
	speed: 0.0353s/iter; left time: 1203.5266s
	iters: 300, epoch: 8 | loss: 0.2644800
	speed: 0.0341s/iter; left time: 1159.7832s
Epoch: 8 cost time: 13.538248538970947
Epoch: 8, Steps: 369 | Train Loss: 0.421 Vali Loss: 1.907 Vali Acc: 0.636 Test Loss: 1.907 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0487073
	speed: 0.1587s/iter; left time: 5372.5527s
	iters: 200, epoch: 9 | loss: 0.2394628
	speed: 0.0358s/iter; left time: 1207.4741s
	iters: 300, epoch: 9 | loss: 0.5013509
	speed: 0.0358s/iter; left time: 1203.8428s
Epoch: 9 cost time: 13.89565396308899
Epoch: 9, Steps: 369 | Train Loss: 0.300 Vali Loss: 1.831 Vali Acc: 0.632 Test Loss: 1.831 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1024795
	speed: 0.1578s/iter; left time: 5284.3577s
	iters: 200, epoch: 10 | loss: 0.0703200
	speed: 0.0354s/iter; left time: 1181.6105s
	iters: 300, epoch: 10 | loss: 0.1594562
	speed: 0.0361s/iter; left time: 1201.3011s
Epoch: 10 cost time: 13.888728380203247
Epoch: 10, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.668 Vali Acc: 0.627 Test Loss: 1.668 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0356119
	speed: 0.1619s/iter; left time: 5361.8562s
	iters: 200, epoch: 11 | loss: 0.0126266
	speed: 0.0360s/iter; left time: 1187.4787s
	iters: 300, epoch: 11 | loss: 0.0745491
	speed: 0.0293s/iter; left time: 964.3060s
Epoch: 11 cost time: 12.32129192352295
Epoch: 11, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.644 Vali Acc: 0.642 Test Loss: 1.644 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1505059
	speed: 0.1270s/iter; left time: 4156.9503s
	iters: 200, epoch: 12 | loss: 0.0070903
	speed: 0.0267s/iter; left time: 871.4034s
	iters: 300, epoch: 12 | loss: 0.0394580
	speed: 0.0266s/iter; left time: 866.5711s
Epoch: 12 cost time: 10.328385353088379
Epoch: 12, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.826 Vali Acc: 0.630 Test Loss: 1.826 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0372340
	speed: 0.1252s/iter; left time: 4052.2549s
	iters: 200, epoch: 13 | loss: 0.0073658
	speed: 0.0264s/iter; left time: 850.7998s
	iters: 300, epoch: 13 | loss: 0.3023144
	speed: 0.0268s/iter; left time: 861.9347s
Epoch: 13 cost time: 10.334582567214966
Epoch: 13, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.946 Vali Acc: 0.636 Test Loss: 1.946 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6492622020431328
model parameter : 151234
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5618411
	speed: 0.0469s/iter; left time: 1724.9500s
	iters: 200, epoch: 1 | loss: 1.0020099
	speed: 0.0297s/iter; left time: 1091.6441s
	iters: 300, epoch: 1 | loss: 1.4663841
	speed: 0.0308s/iter; left time: 1126.6942s
Epoch: 1 cost time: 13.014692068099976
Epoch: 1, Steps: 369 | Train Loss: 1.015 Vali Loss: 1.452 Vali Acc: 0.643 Test Loss: 1.452 Test Acc: 0.643
Validation loss decreased (inf --> -0.643005).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6711148
	speed: 0.1407s/iter; left time: 5126.6062s
	iters: 200, epoch: 2 | loss: 2.2054985
	speed: 0.0317s/iter; left time: 1153.2150s
	iters: 300, epoch: 2 | loss: 1.6932161
	speed: 0.0311s/iter; left time: 1125.4519s
Epoch: 2 cost time: 12.092538356781006
Epoch: 2, Steps: 369 | Train Loss: 1.136 Vali Loss: 1.756 Vali Acc: 0.623 Test Loss: 1.756 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.9311950
	speed: 0.1375s/iter; left time: 4957.5736s
	iters: 200, epoch: 3 | loss: 0.5509908
	speed: 0.0310s/iter; left time: 1113.4203s
	iters: 300, epoch: 3 | loss: 1.1694406
	speed: 0.0311s/iter; left time: 1114.6950s
Epoch: 3 cost time: 12.067012786865234
Epoch: 3, Steps: 369 | Train Loss: 1.086 Vali Loss: 2.212 Vali Acc: 0.636 Test Loss: 2.212 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4211112
	speed: 0.1353s/iter; left time: 4830.1621s
	iters: 200, epoch: 4 | loss: 1.4337713
	speed: 0.0309s/iter; left time: 1101.3424s
	iters: 300, epoch: 4 | loss: 0.1160257
	speed: 0.0313s/iter; left time: 1111.4231s
Epoch: 4 cost time: 12.169486045837402
Epoch: 4, Steps: 369 | Train Loss: 1.098 Vali Loss: 2.499 Vali Acc: 0.643 Test Loss: 2.499 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0651511
	speed: 0.1400s/iter; left time: 4946.6906s
	iters: 200, epoch: 5 | loss: 2.4104397
	speed: 0.0310s/iter; left time: 1090.7857s
	iters: 300, epoch: 5 | loss: 1.9950113
	speed: 0.0311s/iter; left time: 1090.9940s
Epoch: 5 cost time: 12.137357711791992
Epoch: 5, Steps: 369 | Train Loss: 0.912 Vali Loss: 2.716 Vali Acc: 0.630 Test Loss: 2.716 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.2016124
	speed: 0.1348s/iter; left time: 4713.3402s
	iters: 200, epoch: 6 | loss: 0.4585296
	speed: 0.0319s/iter; left time: 1110.7852s
	iters: 300, epoch: 6 | loss: 1.0871519
	speed: 0.0304s/iter; left time: 1055.3772s
Epoch: 6 cost time: 11.708974599838257
Epoch: 6, Steps: 369 | Train Loss: 0.721 Vali Loss: 2.569 Vali Acc: 0.639 Test Loss: 2.569 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3756876
	speed: 0.1139s/iter; left time: 3940.9888s
	iters: 200, epoch: 7 | loss: 0.0822857
	speed: 0.0242s/iter; left time: 835.1284s
	iters: 300, epoch: 7 | loss: 0.8907830
	speed: 0.0239s/iter; left time: 820.9177s
Epoch: 7 cost time: 9.391243934631348
Epoch: 7, Steps: 369 | Train Loss: 0.578 Vali Loss: 2.212 Vali Acc: 0.652 Test Loss: 2.212 Test Acc: 0.652
Validation loss decreased (-0.643005 --> -0.652078).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4932545
	speed: 0.1178s/iter; left time: 4030.6292s
	iters: 200, epoch: 8 | loss: 0.4082477
	speed: 0.0241s/iter; left time: 822.2477s
	iters: 300, epoch: 8 | loss: 0.0744382
	speed: 0.0237s/iter; left time: 805.7137s
Epoch: 8 cost time: 9.373988151550293
Epoch: 8, Steps: 369 | Train Loss: 0.427 Vali Loss: 2.071 Vali Acc: 0.637 Test Loss: 2.071 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6895280
	speed: 0.1155s/iter; left time: 3909.7386s
	iters: 200, epoch: 9 | loss: 0.3560154
	speed: 0.0232s/iter; left time: 781.7959s
	iters: 300, epoch: 9 | loss: 0.1096133
	speed: 0.0230s/iter; left time: 774.5767s
Epoch: 9 cost time: 9.100635290145874
Epoch: 9, Steps: 369 | Train Loss: 0.318 Vali Loss: 1.794 Vali Acc: 0.649 Test Loss: 1.794 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0692613
	speed: 0.1167s/iter; left time: 3907.3658s
	iters: 200, epoch: 10 | loss: 0.0104804
	speed: 0.0232s/iter; left time: 774.7047s
	iters: 300, epoch: 10 | loss: 0.0801085
	speed: 0.0230s/iter; left time: 764.5697s
Epoch: 10 cost time: 9.189684629440308
Epoch: 10, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.676 Vali Acc: 0.641 Test Loss: 1.676 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0767317
	speed: 0.1156s/iter; left time: 3829.1903s
	iters: 200, epoch: 11 | loss: 0.1724289
	speed: 0.0300s/iter; left time: 989.4953s
	iters: 300, epoch: 11 | loss: 0.0645431
	speed: 0.0303s/iter; left time: 996.7402s
Epoch: 11 cost time: 11.53916597366333
Epoch: 11, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.735 Vali Acc: 0.639 Test Loss: 1.735 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0740703
	speed: 0.1395s/iter; left time: 4566.7159s
	iters: 200, epoch: 12 | loss: 0.0740309
	speed: 0.0310s/iter; left time: 1011.7532s
	iters: 300, epoch: 12 | loss: 0.1490100
	speed: 0.0305s/iter; left time: 991.4815s
Epoch: 12 cost time: 11.969887733459473
Epoch: 12, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.729 Vali Acc: 0.649 Test Loss: 1.729 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0467805
	speed: 0.1365s/iter; left time: 4418.9517s
	iters: 200, epoch: 13 | loss: 0.0877872
	speed: 0.0311s/iter; left time: 1003.9718s
	iters: 300, epoch: 13 | loss: 0.0334372
	speed: 0.0306s/iter; left time: 983.2808s
Epoch: 13 cost time: 11.909716606140137
Epoch: 13, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.742 Vali Acc: 0.649 Test Loss: 1.742 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0232590
	speed: 0.1362s/iter; left time: 4359.6263s
	iters: 200, epoch: 14 | loss: 0.1032871
	speed: 0.0310s/iter; left time: 988.2023s
	iters: 300, epoch: 14 | loss: 0.1513494
	speed: 0.0313s/iter; left time: 994.1195s
Epoch: 14 cost time: 12.08792781829834
Epoch: 14, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.939 Vali Acc: 0.643 Test Loss: 1.939 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0786304
	speed: 0.1362s/iter; left time: 4307.3568s
	iters: 200, epoch: 15 | loss: 0.0373199
	speed: 0.0309s/iter; left time: 973.7274s
	iters: 300, epoch: 15 | loss: 0.0055220
	speed: 0.0310s/iter; left time: 974.7531s
Epoch: 15 cost time: 12.05030369758606
Epoch: 15, Steps: 369 | Train Loss: 0.078 Vali Loss: 1.959 Vali Acc: 0.644 Test Loss: 1.959 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1222225
	speed: 0.1385s/iter; left time: 4329.8831s
	iters: 200, epoch: 16 | loss: 0.1296650
	speed: 0.0321s/iter; left time: 1001.0504s
	iters: 300, epoch: 16 | loss: 0.0063490
	speed: 0.0324s/iter; left time: 1006.9196s
Epoch: 16 cost time: 12.565164804458618
Epoch: 16, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.044 Vali Acc: 0.643 Test Loss: 2.044 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.2335968
	speed: 0.1308s/iter; left time: 4040.8478s
	iters: 200, epoch: 17 | loss: 0.0250875
	speed: 0.0230s/iter; left time: 707.6560s
	iters: 300, epoch: 17 | loss: 0.1565470
	speed: 0.0243s/iter; left time: 744.6424s
Epoch: 17 cost time: 9.477344512939453
Epoch: 17, Steps: 369 | Train Loss: 0.081 Vali Loss: 2.101 Vali Acc: 0.640 Test Loss: 2.101 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6520998864926221
model parameter : 123682
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6539343
	speed: 0.0387s/iter; left time: 1425.5280s
	iters: 200, epoch: 1 | loss: 0.7469813
	speed: 0.0226s/iter; left time: 828.2680s
	iters: 300, epoch: 1 | loss: 0.8519126
	speed: 0.0228s/iter; left time: 835.1855s
Epoch: 1 cost time: 10.058537244796753
Epoch: 1, Steps: 369 | Train Loss: 0.881 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
Validation loss decreased (inf --> -0.632506).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2915443
	speed: 0.1106s/iter; left time: 4027.6433s
	iters: 200, epoch: 2 | loss: 1.8243773
	speed: 0.0271s/iter; left time: 983.3970s
	iters: 300, epoch: 2 | loss: 0.7317054
	speed: 0.0270s/iter; left time: 976.6767s
Epoch: 2 cost time: 9.347557067871094
Epoch: 2, Steps: 369 | Train Loss: 0.973 Vali Loss: 1.684 Vali Acc: 0.654 Test Loss: 1.684 Test Acc: 0.654
Validation loss decreased (-0.632506 --> -0.653786).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5762936
	speed: 0.1282s/iter; left time: 4624.0822s
	iters: 200, epoch: 3 | loss: 0.9329997
	speed: 0.0284s/iter; left time: 1022.8135s
	iters: 300, epoch: 3 | loss: 0.5351385
	speed: 0.0294s/iter; left time: 1052.7152s
Epoch: 3 cost time: 11.090810775756836
Epoch: 3, Steps: 369 | Train Loss: 0.956 Vali Loss: 1.951 Vali Acc: 0.640 Test Loss: 1.951 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5198762
	speed: 0.1264s/iter; left time: 4510.2250s
	iters: 200, epoch: 4 | loss: 0.2897735
	speed: 0.0291s/iter; left time: 1035.8386s
	iters: 300, epoch: 4 | loss: 0.2666138
	speed: 0.0286s/iter; left time: 1015.0738s
Epoch: 4 cost time: 11.047753810882568
Epoch: 4, Steps: 369 | Train Loss: 0.925 Vali Loss: 2.240 Vali Acc: 0.643 Test Loss: 2.240 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5252110
	speed: 0.1322s/iter; left time: 4671.6182s
	iters: 200, epoch: 5 | loss: 1.0649183
	speed: 0.0285s/iter; left time: 1005.3316s
	iters: 300, epoch: 5 | loss: 0.3525403
	speed: 0.0280s/iter; left time: 982.0637s
Epoch: 5 cost time: 10.956069946289062
Epoch: 5, Steps: 369 | Train Loss: 0.829 Vali Loss: 2.357 Vali Acc: 0.649 Test Loss: 2.357 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0640112
	speed: 0.1323s/iter; left time: 4626.0183s
	iters: 200, epoch: 6 | loss: 0.5166397
	speed: 0.0287s/iter; left time: 999.2010s
	iters: 300, epoch: 6 | loss: 1.0635139
	speed: 0.0288s/iter; left time: 999.4539s
Epoch: 6 cost time: 11.210170984268188
Epoch: 6, Steps: 369 | Train Loss: 0.657 Vali Loss: 2.354 Vali Acc: 0.646 Test Loss: 2.354 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2792373
	speed: 0.1298s/iter; left time: 4489.4985s
	iters: 200, epoch: 7 | loss: 0.9061044
	speed: 0.0281s/iter; left time: 969.5987s
	iters: 300, epoch: 7 | loss: 0.5457719
	speed: 0.0273s/iter; left time: 939.5005s
Epoch: 7 cost time: 10.783025026321411
Epoch: 7, Steps: 369 | Train Loss: 0.551 Vali Loss: 2.140 Vali Acc: 0.648 Test Loss: 2.140 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2177897
	speed: 0.1314s/iter; left time: 4497.5467s
	iters: 200, epoch: 8 | loss: 1.9245374
	speed: 0.0268s/iter; left time: 913.9643s
	iters: 300, epoch: 8 | loss: 0.1020947
	speed: 0.0150s/iter; left time: 509.8873s
Epoch: 8 cost time: 9.045220375061035
Epoch: 8, Steps: 369 | Train Loss: 0.437 Vali Loss: 2.154 Vali Acc: 0.634 Test Loss: 2.154 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0792243
	speed: 0.1198s/iter; left time: 4053.9040s
	iters: 200, epoch: 9 | loss: 0.2564084
	speed: 0.0212s/iter; left time: 715.6823s
	iters: 300, epoch: 9 | loss: 0.5009100
	speed: 0.0211s/iter; left time: 710.3966s
Epoch: 9 cost time: 8.525012969970703
Epoch: 9, Steps: 369 | Train Loss: 0.341 Vali Loss: 2.084 Vali Acc: 0.643 Test Loss: 2.084 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.4016525
	speed: 0.1189s/iter; left time: 3981.0885s
	iters: 200, epoch: 10 | loss: 0.3541228
	speed: 0.0214s/iter; left time: 713.9504s
	iters: 300, epoch: 10 | loss: 0.0961106
	speed: 0.0219s/iter; left time: 729.4704s
Epoch: 10 cost time: 8.34960675239563
Epoch: 10, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.958 Vali Acc: 0.637 Test Loss: 1.958 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.4315776
	speed: 0.1139s/iter; left time: 3772.6450s
	iters: 200, epoch: 11 | loss: 0.0844573
	speed: 0.0223s/iter; left time: 735.0471s
	iters: 300, epoch: 11 | loss: 0.3284114
	speed: 0.0226s/iter; left time: 743.8624s
Epoch: 11 cost time: 8.83033537864685
Epoch: 11, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.839 Vali Acc: 0.658 Test Loss: 1.839 Test Acc: 0.658
Validation loss decreased (-0.653786 --> -0.657757).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0344709
	speed: 0.1150s/iter; left time: 3763.7293s
	iters: 200, epoch: 12 | loss: 0.3996111
	speed: 0.0221s/iter; left time: 721.9382s
	iters: 300, epoch: 12 | loss: 0.2127640
	speed: 0.0215s/iter; left time: 699.2092s
Epoch: 12 cost time: 8.67628002166748
Epoch: 12, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.823 Vali Acc: 0.646 Test Loss: 1.823 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2758149
	speed: 0.1186s/iter; left time: 3838.4223s
	iters: 200, epoch: 13 | loss: 0.4310392
	speed: 0.0294s/iter; left time: 948.2337s
	iters: 300, epoch: 13 | loss: 0.0514305
	speed: 0.0285s/iter; left time: 916.5124s
Epoch: 13 cost time: 11.20072627067566
Epoch: 13, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.891 Vali Acc: 0.637 Test Loss: 1.891 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.2999468
	speed: 0.1292s/iter; left time: 4135.0294s
	iters: 200, epoch: 14 | loss: 0.1344471
	speed: 0.0288s/iter; left time: 919.0004s
	iters: 300, epoch: 14 | loss: 0.0274832
	speed: 0.0292s/iter; left time: 929.8555s
Epoch: 14 cost time: 11.17849588394165
Epoch: 14, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.906 Vali Acc: 0.649 Test Loss: 1.906 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0210572
	speed: 0.1296s/iter; left time: 4098.5707s
	iters: 200, epoch: 15 | loss: 0.0372663
	speed: 0.0280s/iter; left time: 881.8026s
	iters: 300, epoch: 15 | loss: 0.3088771
	speed: 0.0287s/iter; left time: 901.0491s
Epoch: 15 cost time: 10.923596620559692
Epoch: 15, Steps: 369 | Train Loss: 0.110 Vali Loss: 2.001 Vali Acc: 0.636 Test Loss: 2.001 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0363437
	speed: 0.1366s/iter; left time: 4271.8807s
	iters: 200, epoch: 16 | loss: 0.0061415
	speed: 0.0277s/iter; left time: 864.0355s
	iters: 300, epoch: 16 | loss: 0.1176387
	speed: 0.0282s/iter; left time: 876.4881s
Epoch: 16 cost time: 11.036510229110718
Epoch: 16, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.977 Vali Acc: 0.650 Test Loss: 1.977 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0695141
	speed: 0.1313s/iter; left time: 4056.3836s
	iters: 200, epoch: 17 | loss: 0.1458540
	speed: 0.0283s/iter; left time: 870.0172s
	iters: 300, epoch: 17 | loss: 0.2206223
	speed: 0.0281s/iter; left time: 861.1192s
Epoch: 17 cost time: 10.939110040664673
Epoch: 17, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.018 Vali Acc: 0.639 Test Loss: 2.018 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0558725
	speed: 0.1309s/iter; left time: 3995.9297s
	iters: 200, epoch: 18 | loss: 0.0346165
	speed: 0.0285s/iter; left time: 866.9718s
	iters: 300, epoch: 18 | loss: 0.0036566
	speed: 0.0276s/iter; left time: 836.4249s
Epoch: 18 cost time: 10.959924459457397
Epoch: 18, Steps: 369 | Train Loss: 0.085 Vali Loss: 2.180 Vali Acc: 0.635 Test Loss: 2.180 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0115427
	speed: 0.1183s/iter; left time: 3567.6804s
	iters: 200, epoch: 19 | loss: 0.0671634
	speed: 0.0217s/iter; left time: 650.8512s
	iters: 300, epoch: 19 | loss: 0.0016721
	speed: 0.0216s/iter; left time: 646.5875s
Epoch: 19 cost time: 8.536482810974121
Epoch: 19, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.074 Vali Acc: 0.656 Test Loss: 2.074 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1473170
	speed: 0.1131s/iter; left time: 3369.1263s
	iters: 200, epoch: 20 | loss: 0.0001777
	speed: 0.0228s/iter; left time: 676.1828s
	iters: 300, epoch: 20 | loss: 0.2240304
	speed: 0.0230s/iter; left time: 680.5211s
Epoch: 20 cost time: 8.998906373977661
Epoch: 20, Steps: 369 | Train Loss: 0.077 Vali Loss: 2.158 Vali Acc: 0.644 Test Loss: 2.158 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0423033
	speed: 0.1024s/iter; left time: 3012.0199s
	iters: 200, epoch: 21 | loss: 0.0186412
	speed: 0.0229s/iter; left time: 670.9920s
	iters: 300, epoch: 21 | loss: 0.0262570
	speed: 0.0230s/iter; left time: 671.1451s
Epoch: 21 cost time: 8.322834730148315
Epoch: 21, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.186 Vali Acc: 0.648 Test Loss: 2.186 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 96130
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8188028
	speed: 0.0408s/iter; left time: 1503.0755s
	iters: 200, epoch: 1 | loss: 1.1691915
	speed: 0.0254s/iter; left time: 930.9802s
	iters: 300, epoch: 1 | loss: 1.3301573
	speed: 0.0253s/iter; left time: 925.2298s
Epoch: 1 cost time: 10.98509955406189
Epoch: 1, Steps: 369 | Train Loss: 0.806 Vali Loss: 1.253 Vali Acc: 0.625 Test Loss: 1.253 Test Acc: 0.625
Validation loss decreased (inf --> -0.624562).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5663779
	speed: 0.1236s/iter; left time: 4503.8450s
	iters: 200, epoch: 2 | loss: 0.3847588
	speed: 0.0254s/iter; left time: 924.0816s
	iters: 300, epoch: 2 | loss: 1.1035583
	speed: 0.0251s/iter; left time: 909.0389s
Epoch: 2 cost time: 9.745286226272583
Epoch: 2, Steps: 369 | Train Loss: 0.886 Vali Loss: 1.645 Vali Acc: 0.622 Test Loss: 1.645 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2924479
	speed: 0.1279s/iter; left time: 4610.7458s
	iters: 200, epoch: 3 | loss: 1.9932899
	speed: 0.0248s/iter; left time: 890.2104s
	iters: 300, epoch: 3 | loss: 0.3054245
	speed: 0.0256s/iter; left time: 917.7712s
Epoch: 3 cost time: 9.965745449066162
Epoch: 3, Steps: 369 | Train Loss: 0.846 Vali Loss: 1.821 Vali Acc: 0.629 Test Loss: 1.821 Test Acc: 0.629
Validation loss decreased (-0.624562 --> -0.629380).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4953507
	speed: 0.1270s/iter; left time: 4531.8742s
	iters: 200, epoch: 4 | loss: 0.6620632
	speed: 0.0250s/iter; left time: 890.5189s
	iters: 300, epoch: 4 | loss: 0.5103384
	speed: 0.0257s/iter; left time: 912.7843s
Epoch: 4 cost time: 9.896058320999146
Epoch: 4, Steps: 369 | Train Loss: 0.764 Vali Loss: 2.233 Vali Acc: 0.636 Test Loss: 2.233 Test Acc: 0.636
Validation loss decreased (-0.629380 --> -0.636187).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2292794
	speed: 0.1240s/iter; left time: 4382.0483s
	iters: 200, epoch: 5 | loss: 0.7913876
	speed: 0.0256s/iter; left time: 901.2233s
	iters: 300, epoch: 5 | loss: 0.4107478
	speed: 0.0255s/iter; left time: 895.1372s
Epoch: 5 cost time: 9.977942705154419
Epoch: 5, Steps: 369 | Train Loss: 0.700 Vali Loss: 2.197 Vali Acc: 0.648 Test Loss: 2.197 Test Acc: 0.648
Validation loss decreased (-0.636187 --> -0.648105).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0960963
	speed: 0.1245s/iter; left time: 4352.1976s
	iters: 200, epoch: 6 | loss: 1.3661834
	speed: 0.0211s/iter; left time: 736.0733s
	iters: 300, epoch: 6 | loss: 0.7883179
	speed: 0.0172s/iter; left time: 596.6905s
Epoch: 6 cost time: 8.380693674087524
Epoch: 6, Steps: 369 | Train Loss: 0.617 Vali Loss: 2.269 Vali Acc: 0.647 Test Loss: 2.269 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1347957
	speed: 0.1062s/iter; left time: 3674.2083s
	iters: 200, epoch: 7 | loss: 0.3212527
	speed: 0.0205s/iter; left time: 706.8666s
	iters: 300, epoch: 7 | loss: 0.2508166
	speed: 0.0207s/iter; left time: 711.3227s
Epoch: 7 cost time: 8.226890087127686
Epoch: 7, Steps: 369 | Train Loss: 0.484 Vali Loss: 2.086 Vali Acc: 0.651 Test Loss: 2.086 Test Acc: 0.651
Validation loss decreased (-0.648105 --> -0.650944).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0582513
	speed: 0.1040s/iter; left time: 3558.4247s
	iters: 200, epoch: 8 | loss: 0.2672786
	speed: 0.0211s/iter; left time: 719.9446s
	iters: 300, epoch: 8 | loss: 1.5596482
	speed: 0.0214s/iter; left time: 726.4305s
Epoch: 8 cost time: 8.343050241470337
Epoch: 8, Steps: 369 | Train Loss: 0.394 Vali Loss: 2.146 Vali Acc: 0.646 Test Loss: 2.146 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4535983
	speed: 0.0967s/iter; left time: 3274.3601s
	iters: 200, epoch: 9 | loss: 0.2836316
	speed: 0.0214s/iter; left time: 723.4902s
	iters: 300, epoch: 9 | loss: 0.7549179
	speed: 0.0215s/iter; left time: 721.9269s
Epoch: 9 cost time: 8.366356372833252
Epoch: 9, Steps: 369 | Train Loss: 0.321 Vali Loss: 2.157 Vali Acc: 0.645 Test Loss: 2.157 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5855917
	speed: 0.1038s/iter; left time: 3476.0335s
	iters: 200, epoch: 10 | loss: 0.0089224
	speed: 0.0208s/iter; left time: 694.4711s
	iters: 300, epoch: 10 | loss: 0.3817556
	speed: 0.0199s/iter; left time: 662.8378s
Epoch: 10 cost time: 8.060075759887695
Epoch: 10, Steps: 369 | Train Loss: 0.277 Vali Loss: 2.027 Vali Acc: 0.644 Test Loss: 2.027 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1010270
	speed: 0.0885s/iter; left time: 2929.2274s
	iters: 200, epoch: 11 | loss: 0.5136421
	speed: 0.0190s/iter; left time: 626.7207s
	iters: 300, epoch: 11 | loss: 0.1263889
	speed: 0.0208s/iter; left time: 682.9456s
Epoch: 11 cost time: 6.977681636810303
Epoch: 11, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.986 Vali Acc: 0.640 Test Loss: 1.986 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0818616
	speed: 0.1194s/iter; left time: 3910.9913s
	iters: 200, epoch: 12 | loss: 0.3431869
	speed: 0.0218s/iter; left time: 712.7330s
	iters: 300, epoch: 12 | loss: 0.0236355
	speed: 0.0209s/iter; left time: 680.5339s
Epoch: 12 cost time: 8.455996036529541
Epoch: 12, Steps: 369 | Train Loss: 0.195 Vali Loss: 2.000 Vali Acc: 0.642 Test Loss: 2.000 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0357552
	speed: 0.0924s/iter; left time: 2991.2739s
	iters: 200, epoch: 13 | loss: 0.3827781
	speed: 0.0116s/iter; left time: 374.6729s
	iters: 300, epoch: 13 | loss: 0.4162261
	speed: 0.0112s/iter; left time: 360.6918s
Epoch: 13 cost time: 4.596406698226929
Epoch: 13, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.964 Vali Acc: 0.648 Test Loss: 1.964 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1816370
	speed: 0.0576s/iter; left time: 1842.1174s
	iters: 200, epoch: 14 | loss: 0.0972539
	speed: 0.0114s/iter; left time: 364.6033s
	iters: 300, epoch: 14 | loss: 0.0157931
	speed: 0.0107s/iter; left time: 341.2099s
Epoch: 14 cost time: 4.607829332351685
Epoch: 14, Steps: 369 | Train Loss: 0.117 Vali Loss: 2.105 Vali Acc: 0.637 Test Loss: 2.105 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2028836
	speed: 0.0597s/iter; left time: 1888.9819s
	iters: 200, epoch: 15 | loss: 0.2131212
	speed: 0.0197s/iter; left time: 621.9428s
	iters: 300, epoch: 15 | loss: 0.6099449
	speed: 0.0226s/iter; left time: 709.2521s
Epoch: 15 cost time: 7.382663726806641
Epoch: 15, Steps: 369 | Train Loss: 0.133 Vali Loss: 2.077 Vali Acc: 0.643 Test Loss: 2.077 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0045782
	speed: 0.1180s/iter; left time: 3690.9487s
	iters: 200, epoch: 16 | loss: 0.0067148
	speed: 0.0237s/iter; left time: 739.7093s
	iters: 300, epoch: 16 | loss: 0.0561334
	speed: 0.0252s/iter; left time: 782.5417s
Epoch: 16 cost time: 9.761656761169434
Epoch: 16, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.059 Vali Acc: 0.642 Test Loss: 2.059 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0186730
	speed: 0.1157s/iter; left time: 3574.1354s
	iters: 200, epoch: 17 | loss: 0.1473454
	speed: 0.0243s/iter; left time: 748.8458s
	iters: 300, epoch: 17 | loss: 0.1006837
	speed: 0.0238s/iter; left time: 729.8158s
Epoch: 17 cost time: 9.692907810211182
Epoch: 17, Steps: 369 | Train Loss: 0.113 Vali Loss: 2.133 Vali Acc: 0.637 Test Loss: 2.133 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6509648127128264
model parameter : 77794
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1754413
	speed: 0.1017s/iter; left time: 3742.5992s
	iters: 200, epoch: 1 | loss: 2.1459322
	speed: 0.0826s/iter; left time: 3031.2983s
	iters: 300, epoch: 1 | loss: 4.8785305
	speed: 0.0821s/iter; left time: 3006.4710s
Epoch: 1 cost time: 31.56234383583069
Epoch: 1, Steps: 369 | Train Loss: 2.898 Vali Loss: 3.100 Vali Acc: 0.646 Test Loss: 3.100 Test Acc: 0.646
Validation loss decreased (inf --> -0.646110).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9686150
	speed: 0.2525s/iter; left time: 9199.2226s
	iters: 200, epoch: 2 | loss: 1.5813742
	speed: 0.0610s/iter; left time: 2214.7160s
	iters: 300, epoch: 2 | loss: 0.9903321
	speed: 0.0617s/iter; left time: 2236.2121s
Epoch: 2 cost time: 23.18168306350708
Epoch: 2, Steps: 369 | Train Loss: 2.578 Vali Loss: 2.531 Vali Acc: 0.640 Test Loss: 2.531 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4909090
	speed: 0.2498s/iter; left time: 9009.3926s
	iters: 200, epoch: 3 | loss: 2.7936790
	speed: 0.0644s/iter; left time: 2314.8636s
	iters: 300, epoch: 3 | loss: 1.5442833
	speed: 0.0656s/iter; left time: 2351.0638s
Epoch: 3 cost time: 25.87439799308777
Epoch: 3, Steps: 369 | Train Loss: 2.708 Vali Loss: 4.122 Vali Acc: 0.627 Test Loss: 4.122 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.8288456
	speed: 0.3151s/iter; left time: 11248.1308s
	iters: 200, epoch: 4 | loss: 1.9531240
	speed: 0.0837s/iter; left time: 2980.5208s
	iters: 300, epoch: 4 | loss: 5.5304976
	speed: 0.0845s/iter; left time: 2999.8945s
Epoch: 4 cost time: 31.69922184944153
Epoch: 4, Steps: 369 | Train Loss: 2.756 Vali Loss: 4.389 Vali Acc: 0.642 Test Loss: 4.389 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.6151439
	speed: 0.3186s/iter; left time: 11254.9672s
	iters: 200, epoch: 5 | loss: 3.2742159
	speed: 0.0839s/iter; left time: 2956.9857s
	iters: 300, epoch: 5 | loss: 0.6505224
	speed: 0.0841s/iter; left time: 2953.3569s
Epoch: 5 cost time: 31.43452525138855
Epoch: 5, Steps: 369 | Train Loss: 2.258 Vali Loss: 5.012 Vali Acc: 0.646 Test Loss: 5.012 Test Acc: 0.646
Validation loss decreased (-0.646110 --> -0.646374).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4323919
	speed: 0.2966s/iter; left time: 10369.3105s
	iters: 200, epoch: 6 | loss: 2.4033499
	speed: 0.0641s/iter; left time: 2234.8546s
	iters: 300, epoch: 6 | loss: 0.6939873
	speed: 0.0636s/iter; left time: 2212.2003s
Epoch: 6 cost time: 24.048659801483154
Epoch: 6, Steps: 369 | Train Loss: 1.638 Vali Loss: 4.542 Vali Acc: 0.638 Test Loss: 4.542 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1484298
	speed: 0.2505s/iter; left time: 8664.7513s
	iters: 200, epoch: 7 | loss: 2.5962470
	speed: 0.0664s/iter; left time: 2289.9431s
	iters: 300, epoch: 7 | loss: 1.1148356
	speed: 0.0665s/iter; left time: 2287.0143s
Epoch: 7 cost time: 25.191504955291748
Epoch: 7, Steps: 369 | Train Loss: 0.797 Vali Loss: 3.556 Vali Acc: 0.636 Test Loss: 3.556 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0456750
	speed: 0.2844s/iter; left time: 9731.7206s
	iters: 200, epoch: 8 | loss: 0.9526156
	speed: 0.0829s/iter; left time: 2827.9784s
	iters: 300, epoch: 8 | loss: 0.0135574
	speed: 0.0815s/iter; left time: 2772.7181s
Epoch: 8 cost time: 31.039233207702637
Epoch: 8, Steps: 369 | Train Loss: 0.442 Vali Loss: 3.458 Vali Acc: 0.633 Test Loss: 3.458 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0023668
	speed: 0.3142s/iter; left time: 10636.9909s
	iters: 200, epoch: 9 | loss: 0.3074352
	speed: 0.0808s/iter; left time: 2728.1393s
	iters: 300, epoch: 9 | loss: 0.7055098
	speed: 0.0806s/iter; left time: 2712.2414s
Epoch: 9 cost time: 30.534234046936035
Epoch: 9, Steps: 369 | Train Loss: 0.260 Vali Loss: 3.144 Vali Acc: 0.630 Test Loss: 3.144 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0142091
	speed: 0.3109s/iter; left time: 10408.5530s
	iters: 200, epoch: 10 | loss: 0.0457571
	speed: 0.0814s/iter; left time: 2716.3648s
	iters: 300, epoch: 10 | loss: 1.0300232
	speed: 0.0609s/iter; left time: 2028.0669s
Epoch: 10 cost time: 27.261607885360718
Epoch: 10, Steps: 369 | Train Loss: 0.211 Vali Loss: 2.616 Vali Acc: 0.635 Test Loss: 2.616 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1729777
	speed: 0.2522s/iter; left time: 8349.8367s
	iters: 200, epoch: 11 | loss: 0.0404888
	speed: 0.0612s/iter; left time: 2018.8315s
	iters: 300, epoch: 11 | loss: 0.0140574
	speed: 0.0667s/iter; left time: 2195.5290s
Epoch: 11 cost time: 24.325528621673584
Epoch: 11, Steps: 369 | Train Loss: 0.136 Vali Loss: 2.444 Vali Acc: 0.634 Test Loss: 2.444 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0025752
	speed: 0.2489s/iter; left time: 8149.6516s
	iters: 200, epoch: 12 | loss: 0.0019769
	speed: 0.0826s/iter; left time: 2697.5315s
	iters: 300, epoch: 12 | loss: 0.0063618
	speed: 0.0840s/iter; left time: 2732.8326s
Epoch: 12 cost time: 29.423872232437134
Epoch: 12, Steps: 369 | Train Loss: 0.120 Vali Loss: 2.166 Vali Acc: 0.637 Test Loss: 2.166 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0052122
	speed: 0.3147s/iter; left time: 10186.6716s
	iters: 200, epoch: 13 | loss: 0.0521219
	speed: 0.0828s/iter; left time: 2672.8332s
	iters: 300, epoch: 13 | loss: 0.2435486
	speed: 0.0831s/iter; left time: 2674.3896s
Epoch: 13 cost time: 31.180424213409424
Epoch: 13, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.131 Vali Acc: 0.646 Test Loss: 2.131 Test Acc: 0.646
Validation loss decreased (-0.646374 --> -0.646403).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0102800
	speed: 0.3183s/iter; left time: 10187.9436s
	iters: 200, epoch: 14 | loss: 0.1134623
	speed: 0.0829s/iter; left time: 2644.8587s
	iters: 300, epoch: 14 | loss: 0.0149568
	speed: 0.0832s/iter; left time: 2644.7202s
Epoch: 14 cost time: 31.603433847427368
Epoch: 14, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.074 Vali Acc: 0.648 Test Loss: 2.074 Test Acc: 0.648
Validation loss decreased (-0.646403 --> -0.647539).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000936
	speed: 0.2698s/iter; left time: 8536.0346s
	iters: 200, epoch: 15 | loss: 0.0765341
	speed: 0.0609s/iter; left time: 1921.7773s
	iters: 300, epoch: 15 | loss: 0.0018137
	speed: 0.0626s/iter; left time: 1968.3101s
Epoch: 15 cost time: 23.640114545822144
Epoch: 15, Steps: 369 | Train Loss: 0.045 Vali Loss: 2.254 Vali Acc: 0.648 Test Loss: 2.254 Test Acc: 0.648
Validation loss decreased (-0.647539 --> -0.648105).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0046045
	speed: 0.2464s/iter; left time: 7704.0904s
	iters: 200, epoch: 16 | loss: 0.0002311
	speed: 0.0650s/iter; left time: 2025.9957s
	iters: 300, epoch: 16 | loss: 0.1545889
	speed: 0.0647s/iter; left time: 2009.4394s
Epoch: 16 cost time: 24.57005000114441
Epoch: 16, Steps: 369 | Train Loss: 0.034 Vali Loss: 2.691 Vali Acc: 0.664 Test Loss: 2.691 Test Acc: 0.664
Validation loss decreased (-0.648105 --> -0.663707).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0012734
	speed: 0.3042s/iter; left time: 9398.4103s
	iters: 200, epoch: 17 | loss: 0.0056975
	speed: 0.0821s/iter; left time: 2529.3680s
	iters: 300, epoch: 17 | loss: 0.0002122
	speed: 0.0814s/iter; left time: 2500.1773s
Epoch: 17 cost time: 30.91922426223755
Epoch: 17, Steps: 369 | Train Loss: 0.032 Vali Loss: 2.860 Vali Acc: 0.653 Test Loss: 2.860 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1107679
	speed: 0.3156s/iter; left time: 9635.4825s
	iters: 200, epoch: 18 | loss: 0.0002707
	speed: 0.0830s/iter; left time: 2526.7918s
	iters: 300, epoch: 18 | loss: 0.0063059
	speed: 0.0830s/iter; left time: 2516.2019s
Epoch: 18 cost time: 31.347654819488525
Epoch: 18, Steps: 369 | Train Loss: 0.045 Vali Loss: 2.947 Vali Acc: 0.633 Test Loss: 2.947 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4029766
	speed: 0.3021s/iter; left time: 9109.5729s
	iters: 200, epoch: 19 | loss: 0.0082449
	speed: 0.0652s/iter; left time: 1961.2785s
	iters: 300, epoch: 19 | loss: 0.0018065
	speed: 0.0651s/iter; left time: 1950.9098s
Epoch: 19 cost time: 25.56848669052124
Epoch: 19, Steps: 369 | Train Loss: 0.034 Vali Loss: 3.035 Vali Acc: 0.642 Test Loss: 3.035 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0002748
	speed: 0.2513s/iter; left time: 7486.4302s
	iters: 200, epoch: 20 | loss: 0.0000127
	speed: 0.0671s/iter; left time: 1991.2871s
	iters: 300, epoch: 20 | loss: 0.0017627
	speed: 0.0671s/iter; left time: 1986.5460s
Epoch: 20 cost time: 25.06907081604004
Epoch: 20, Steps: 369 | Train Loss: 0.041 Vali Loss: 3.240 Vali Acc: 0.626 Test Loss: 3.240 Test Acc: 0.626
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2216734
	speed: 0.2717s/iter; left time: 7992.7021s
	iters: 200, epoch: 21 | loss: 0.0017620
	speed: 0.0826s/iter; left time: 2423.3101s
	iters: 300, epoch: 21 | loss: 0.0002752
	speed: 0.0831s/iter; left time: 2429.1674s
Epoch: 21 cost time: 31.39172124862671
Epoch: 21, Steps: 369 | Train Loss: 0.043 Vali Loss: 3.105 Vali Acc: 0.635 Test Loss: 3.105 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0030558
	speed: 0.3134s/iter; left time: 9104.6672s
	iters: 200, epoch: 22 | loss: 0.0002227
	speed: 0.0821s/iter; left time: 2378.2243s
	iters: 300, epoch: 22 | loss: 0.0144868
	speed: 0.0817s/iter; left time: 2358.1301s
Epoch: 22 cost time: 30.837623119354248
Epoch: 22, Steps: 369 | Train Loss: 0.030 Vali Loss: 3.017 Vali Acc: 0.642 Test Loss: 3.017 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0003797
	speed: 0.3204s/iter; left time: 9191.0917s
	iters: 200, epoch: 23 | loss: 0.0205923
	speed: 0.0817s/iter; left time: 2336.2534s
	iters: 300, epoch: 23 | loss: 0.0574807
	speed: 0.0740s/iter; left time: 2106.7286s
Epoch: 23 cost time: 28.837799549102783
Epoch: 23, Steps: 369 | Train Loss: 0.031 Vali Loss: 3.158 Vali Acc: 0.646 Test Loss: 3.158 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0025157
	speed: 0.2482s/iter; left time: 7028.7034s
	iters: 200, epoch: 24 | loss: 0.0039467
	speed: 0.0631s/iter; left time: 1780.3268s
	iters: 300, epoch: 24 | loss: 0.1076305
	speed: 0.0588s/iter; left time: 1652.4373s
Epoch: 24 cost time: 23.66451096534729
Epoch: 24, Steps: 369 | Train Loss: 0.023 Vali Loss: 3.183 Vali Acc: 0.630 Test Loss: 3.183 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0019476
	speed: 0.2516s/iter; left time: 7030.1959s
	iters: 200, epoch: 25 | loss: 0.0000007
	speed: 0.0637s/iter; left time: 1773.3202s
	iters: 300, epoch: 25 | loss: 0.0463509
	speed: 0.0796s/iter; left time: 2208.2826s
Epoch: 25 cost time: 27.442479848861694
Epoch: 25, Steps: 369 | Train Loss: 0.030 Vali Loss: 3.196 Vali Acc: 0.630 Test Loss: 3.196 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0002079
	speed: 0.3186s/iter; left time: 8786.4773s
	iters: 200, epoch: 26 | loss: 0.0001231
	speed: 0.0835s/iter; left time: 2295.5026s
	iters: 300, epoch: 26 | loss: 0.0003060
	speed: 0.0827s/iter; left time: 2262.8622s
Epoch: 26 cost time: 31.298291206359863
Epoch: 26, Steps: 369 | Train Loss: 0.037 Vali Loss: 3.279 Vali Acc: 0.641 Test Loss: 3.279 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6637343927355278
model parameter : 580066
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6437595
	speed: 0.0555s/iter; left time: 2043.6338s
	iters: 200, epoch: 1 | loss: 1.8793664
	speed: 0.0386s/iter; left time: 1415.2254s
	iters: 300, epoch: 1 | loss: 4.8150601
	speed: 0.0380s/iter; left time: 1392.6450s
Epoch: 1 cost time: 15.915494680404663
Epoch: 1, Steps: 369 | Train Loss: 1.745 Vali Loss: 1.871 Vali Acc: 0.625 Test Loss: 1.871 Test Acc: 0.625
Validation loss decreased (inf --> -0.625123).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9510865
	speed: 0.1621s/iter; left time: 5906.8185s
	iters: 200, epoch: 2 | loss: 3.0386174
	speed: 0.0351s/iter; left time: 1275.3309s
	iters: 300, epoch: 2 | loss: 1.8487837
	speed: 0.0371s/iter; left time: 1345.5472s
Epoch: 2 cost time: 14.356928825378418
Epoch: 2, Steps: 369 | Train Loss: 1.635 Vali Loss: 2.000 Vali Acc: 0.640 Test Loss: 2.000 Test Acc: 0.640
Validation loss decreased (-0.625123 --> -0.639594).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4499264
	speed: 0.1591s/iter; left time: 5738.1437s
	iters: 200, epoch: 3 | loss: 0.7253771
	speed: 0.0367s/iter; left time: 1320.5246s
	iters: 300, epoch: 3 | loss: 3.2752757
	speed: 0.0360s/iter; left time: 1290.1463s
Epoch: 3 cost time: 13.68691611289978
Epoch: 3, Steps: 369 | Train Loss: 1.847 Vali Loss: 2.565 Vali Acc: 0.651 Test Loss: 2.565 Test Acc: 0.651
Validation loss decreased (-0.639594 --> -0.651223).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8271413
	speed: 0.1849s/iter; left time: 6601.2679s
	iters: 200, epoch: 4 | loss: 1.1283132
	speed: 0.0471s/iter; left time: 1676.6811s
	iters: 300, epoch: 4 | loss: 3.4011650
	speed: 0.0489s/iter; left time: 1736.0729s
Epoch: 4 cost time: 18.392858743667603
Epoch: 4, Steps: 369 | Train Loss: 1.855 Vali Loss: 3.425 Vali Acc: 0.648 Test Loss: 3.425 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.8764725
	speed: 0.2030s/iter; left time: 7172.0749s
	iters: 200, epoch: 5 | loss: 1.5095707
	speed: 0.0484s/iter; left time: 1703.5710s
	iters: 300, epoch: 5 | loss: 0.6696612
	speed: 0.0487s/iter; left time: 1709.6462s
Epoch: 5 cost time: 18.527146577835083
Epoch: 5, Steps: 369 | Train Loss: 1.808 Vali Loss: 4.214 Vali Acc: 0.633 Test Loss: 4.214 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6896194
	speed: 0.2020s/iter; left time: 7060.0476s
	iters: 200, epoch: 6 | loss: 1.0818760
	speed: 0.0485s/iter; left time: 1690.0710s
	iters: 300, epoch: 6 | loss: 2.0113890
	speed: 0.0486s/iter; left time: 1688.6253s
Epoch: 6 cost time: 18.53650712966919
Epoch: 6, Steps: 369 | Train Loss: 1.264 Vali Loss: 3.051 Vali Acc: 0.633 Test Loss: 3.051 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8984757
	speed: 0.2024s/iter; left time: 7001.4443s
	iters: 200, epoch: 7 | loss: 0.3091339
	speed: 0.0354s/iter; left time: 1219.5502s
	iters: 300, epoch: 7 | loss: 0.1900135
	speed: 0.0385s/iter; left time: 1323.5943s
Epoch: 7 cost time: 15.403541088104248
Epoch: 7, Steps: 369 | Train Loss: 0.744 Vali Loss: 2.658 Vali Acc: 0.634 Test Loss: 2.658 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1531829
	speed: 0.1608s/iter; left time: 5500.6421s
	iters: 200, epoch: 8 | loss: 0.2055946
	speed: 0.0383s/iter; left time: 1305.1150s
	iters: 300, epoch: 8 | loss: 0.0335117
	speed: 0.0343s/iter; left time: 1168.1991s
Epoch: 8 cost time: 14.4112868309021
Epoch: 8, Steps: 369 | Train Loss: 0.463 Vali Loss: 2.157 Vali Acc: 0.626 Test Loss: 2.157 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1589561
	speed: 0.1605s/iter; left time: 5434.0886s
	iters: 200, epoch: 9 | loss: 0.3518044
	speed: 0.0373s/iter; left time: 1260.4333s
	iters: 300, epoch: 9 | loss: 0.1451249
	speed: 0.0365s/iter; left time: 1227.0927s
Epoch: 9 cost time: 14.34056830406189
Epoch: 9, Steps: 369 | Train Loss: 0.273 Vali Loss: 1.955 Vali Acc: 0.631 Test Loss: 1.955 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0427055
	speed: 0.1926s/iter; left time: 6447.3657s
	iters: 200, epoch: 10 | loss: 0.3416486
	speed: 0.0495s/iter; left time: 1653.1665s
	iters: 300, epoch: 10 | loss: 0.0770420
	speed: 0.0495s/iter; left time: 1648.0681s
Epoch: 10 cost time: 18.901730060577393
Epoch: 10, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.798 Vali Acc: 0.629 Test Loss: 1.798 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0119547
	speed: 0.1967s/iter; left time: 6511.4881s
	iters: 200, epoch: 11 | loss: 0.0517451
	speed: 0.0506s/iter; left time: 1669.1803s
	iters: 300, epoch: 11 | loss: 0.0220985
	speed: 0.0496s/iter; left time: 1633.7407s
Epoch: 11 cost time: 18.968605995178223
Epoch: 11, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.900 Vali Acc: 0.618 Test Loss: 1.900 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0360659
	speed: 0.2058s/iter; left time: 6739.8648s
	iters: 200, epoch: 12 | loss: 0.0022691
	speed: 0.0499s/iter; left time: 1629.8206s
	iters: 300, epoch: 12 | loss: 0.2491510
	speed: 0.0495s/iter; left time: 1610.3208s
Epoch: 12 cost time: 19.0244357585907
Epoch: 12, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.820 Vali Acc: 0.633 Test Loss: 1.820 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1034682
	speed: 0.2023s/iter; left time: 6548.1929s
	iters: 200, epoch: 13 | loss: 0.1790320
	speed: 0.0416s/iter; left time: 1342.4350s
	iters: 300, epoch: 13 | loss: 0.1093155
	speed: 0.0380s/iter; left time: 1223.8432s
Epoch: 13 cost time: 16.08977961540222
Epoch: 13, Steps: 369 | Train Loss: 0.073 Vali Loss: 1.977 Vali Acc: 0.634 Test Loss: 1.977 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6512485811577753
model parameter : 294434
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9531478
	speed: 0.0480s/iter; left time: 1764.8699s
	iters: 200, epoch: 1 | loss: 1.1396867
	speed: 0.0267s/iter; left time: 978.8392s
	iters: 300, epoch: 1 | loss: 1.4200290
	speed: 0.0403s/iter; left time: 1473.7962s
Epoch: 1 cost time: 14.36732530593872
Epoch: 1, Steps: 369 | Train Loss: 1.431 Vali Loss: 2.055 Vali Acc: 0.632 Test Loss: 2.055 Test Acc: 0.632
Validation loss decreased (inf --> -0.631648).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4821232
	speed: 0.1698s/iter; left time: 6186.6405s
	iters: 200, epoch: 2 | loss: 3.1535892
	speed: 0.0400s/iter; left time: 1452.9629s
	iters: 300, epoch: 2 | loss: 1.5447648
	speed: 0.0401s/iter; left time: 1453.7791s
Epoch: 2 cost time: 15.221961498260498
Epoch: 2, Steps: 369 | Train Loss: 1.427 Vali Loss: 3.199 Vali Acc: 0.587 Test Loss: 3.199 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5421604
	speed: 0.1756s/iter; left time: 6334.4349s
	iters: 200, epoch: 3 | loss: 2.7284853
	speed: 0.0403s/iter; left time: 1449.9358s
	iters: 300, epoch: 3 | loss: 0.7644182
	speed: 0.0401s/iter; left time: 1438.1344s
Epoch: 3 cost time: 15.437636375427246
Epoch: 3, Steps: 369 | Train Loss: 1.429 Vali Loss: 2.454 Vali Acc: 0.636 Test Loss: 2.454 Test Acc: 0.636
Validation loss decreased (-0.631648 --> -0.636184).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0185699
	speed: 0.1705s/iter; left time: 6086.9176s
	iters: 200, epoch: 4 | loss: 0.0752508
	speed: 0.0403s/iter; left time: 1435.2345s
	iters: 300, epoch: 4 | loss: 3.4043584
	speed: 0.0410s/iter; left time: 1455.6385s
Epoch: 4 cost time: 15.433128118515015
Epoch: 4, Steps: 369 | Train Loss: 1.494 Vali Loss: 3.361 Vali Acc: 0.637 Test Loss: 3.361 Test Acc: 0.637
Validation loss decreased (-0.636184 --> -0.637027).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2622214
	speed: 0.1720s/iter; left time: 6076.4816s
	iters: 200, epoch: 5 | loss: 1.6226602
	speed: 0.0429s/iter; left time: 1509.6227s
	iters: 300, epoch: 5 | loss: 2.5470014
	speed: 0.0418s/iter; left time: 1468.3774s
Epoch: 5 cost time: 14.924793720245361
Epoch: 5, Steps: 369 | Train Loss: 1.321 Vali Loss: 3.104 Vali Acc: 0.650 Test Loss: 3.104 Test Acc: 0.650
Validation loss decreased (-0.637027 --> -0.650082).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1789050
	speed: 0.1393s/iter; left time: 4868.6703s
	iters: 200, epoch: 6 | loss: 1.0785418
	speed: 0.0340s/iter; left time: 1184.5639s
	iters: 300, epoch: 6 | loss: 0.4110765
	speed: 0.0339s/iter; left time: 1178.0567s
Epoch: 6 cost time: 12.980438232421875
Epoch: 6, Steps: 369 | Train Loss: 0.954 Vali Loss: 2.741 Vali Acc: 0.648 Test Loss: 2.741 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3709990
	speed: 0.1416s/iter; left time: 4897.6856s
	iters: 200, epoch: 7 | loss: 0.2373686
	speed: 0.0333s/iter; left time: 1148.8054s
	iters: 300, epoch: 7 | loss: 0.2193999
	speed: 0.0337s/iter; left time: 1158.5413s
Epoch: 7 cost time: 12.725846529006958
Epoch: 7, Steps: 369 | Train Loss: 0.710 Vali Loss: 2.138 Vali Acc: 0.645 Test Loss: 2.138 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4815049
	speed: 0.1381s/iter; left time: 4725.0696s
	iters: 200, epoch: 8 | loss: 0.4434170
	speed: 0.0401s/iter; left time: 1368.4033s
	iters: 300, epoch: 8 | loss: 0.2697561
	speed: 0.0406s/iter; left time: 1382.5622s
Epoch: 8 cost time: 14.067626953125
Epoch: 8, Steps: 369 | Train Loss: 0.399 Vali Loss: 1.872 Vali Acc: 0.641 Test Loss: 1.872 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4744703
	speed: 0.1720s/iter; left time: 5821.4262s
	iters: 200, epoch: 9 | loss: 0.6394093
	speed: 0.0411s/iter; left time: 1388.4715s
	iters: 300, epoch: 9 | loss: 0.1313173
	speed: 0.0411s/iter; left time: 1382.9907s
Epoch: 9 cost time: 15.603520393371582
Epoch: 9, Steps: 369 | Train Loss: 0.290 Vali Loss: 1.400 Vali Acc: 0.655 Test Loss: 1.400 Test Acc: 0.655
Validation loss decreased (-0.650082 --> -0.655207).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2660437
	speed: 0.1715s/iter; left time: 5740.3297s
	iters: 200, epoch: 10 | loss: 0.1870641
	speed: 0.0416s/iter; left time: 1387.5351s
	iters: 300, epoch: 10 | loss: 0.2903963
	speed: 0.0418s/iter; left time: 1392.5564s
Epoch: 10 cost time: 15.923611164093018
Epoch: 10, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.552 Vali Acc: 0.650 Test Loss: 1.552 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0913689
	speed: 0.1779s/iter; left time: 5889.4860s
	iters: 200, epoch: 11 | loss: 0.0718102
	speed: 0.0406s/iter; left time: 1339.1139s
	iters: 300, epoch: 11 | loss: 0.4019271
	speed: 0.0399s/iter; left time: 1312.5921s
Epoch: 11 cost time: 15.50015139579773
Epoch: 11, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.582 Vali Acc: 0.643 Test Loss: 1.582 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0257647
	speed: 0.1716s/iter; left time: 5619.3072s
	iters: 200, epoch: 12 | loss: 0.2031492
	speed: 0.0418s/iter; left time: 1364.6336s
	iters: 300, epoch: 12 | loss: 0.2483168
	speed: 0.0279s/iter; left time: 908.2778s
Epoch: 12 cost time: 13.793887615203857
Epoch: 12, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.745 Vali Acc: 0.646 Test Loss: 1.745 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1178177
	speed: 0.1413s/iter; left time: 4572.8899s
	iters: 200, epoch: 13 | loss: 0.3138368
	speed: 0.0303s/iter; left time: 976.8757s
	iters: 300, epoch: 13 | loss: 0.1161669
	speed: 0.0301s/iter; left time: 969.5658s
Epoch: 13 cost time: 11.696460008621216
Epoch: 13, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.870 Vali Acc: 0.644 Test Loss: 1.870 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0052959
	speed: 0.1350s/iter; left time: 4319.0650s
	iters: 200, epoch: 14 | loss: 0.0435434
	speed: 0.0288s/iter; left time: 920.2329s
	iters: 300, epoch: 14 | loss: 0.0087629
	speed: 0.0297s/iter; left time: 944.4124s
Epoch: 14 cost time: 11.458687782287598
Epoch: 14, Steps: 369 | Train Loss: 0.077 Vali Loss: 1.897 Vali Acc: 0.641 Test Loss: 1.897 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3874802
	speed: 0.1340s/iter; left time: 4238.0806s
	iters: 200, epoch: 15 | loss: 0.0621672
	speed: 0.0377s/iter; left time: 1188.8857s
	iters: 300, epoch: 15 | loss: 0.1676297
	speed: 0.0397s/iter; left time: 1249.0079s
Epoch: 15 cost time: 13.565857172012329
Epoch: 15, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.975 Vali Acc: 0.660 Test Loss: 1.975 Test Acc: 0.660
Validation loss decreased (-0.655207 --> -0.660026).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0179596
	speed: 0.1712s/iter; left time: 5351.9921s
	iters: 200, epoch: 16 | loss: 0.1845027
	speed: 0.0400s/iter; left time: 1247.7516s
	iters: 300, epoch: 16 | loss: 0.0021863
	speed: 0.0394s/iter; left time: 1222.8002s
Epoch: 16 cost time: 15.236658573150635
Epoch: 16, Steps: 369 | Train Loss: 0.076 Vali Loss: 2.022 Vali Acc: 0.648 Test Loss: 2.022 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0431151
	speed: 0.1760s/iter; left time: 5439.3279s
	iters: 200, epoch: 17 | loss: 0.1019525
	speed: 0.0413s/iter; left time: 1272.7674s
	iters: 300, epoch: 17 | loss: 0.1381807
	speed: 0.0398s/iter; left time: 1220.9500s
Epoch: 17 cost time: 15.674744844436646
Epoch: 17, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.133 Vali Acc: 0.640 Test Loss: 2.133 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0035492
	speed: 0.1691s/iter; left time: 5163.0655s
	iters: 200, epoch: 18 | loss: 0.0321390
	speed: 0.0405s/iter; left time: 1231.0786s
	iters: 300, epoch: 18 | loss: 0.0011757
	speed: 0.0407s/iter; left time: 1234.0966s
Epoch: 18 cost time: 15.560037612915039
Epoch: 18, Steps: 369 | Train Loss: 0.050 Vali Loss: 2.314 Vali Acc: 0.646 Test Loss: 2.314 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0594563
	speed: 0.1722s/iter; left time: 5191.8879s
	iters: 200, epoch: 19 | loss: 0.0236136
	speed: 0.0401s/iter; left time: 1205.6703s
	iters: 300, epoch: 19 | loss: 0.2919189
	speed: 0.0281s/iter; left time: 841.8019s
Epoch: 19 cost time: 13.307483196258545
Epoch: 19, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.301 Vali Acc: 0.654 Test Loss: 2.301 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0004295
	speed: 0.1355s/iter; left time: 4035.9318s
	iters: 200, epoch: 20 | loss: 0.1390045
	speed: 0.0314s/iter; left time: 933.4634s
	iters: 300, epoch: 20 | loss: 0.0018036
	speed: 0.0311s/iter; left time: 919.9302s
Epoch: 20 cost time: 11.944335460662842
Epoch: 20, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.340 Vali Acc: 0.653 Test Loss: 2.340 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0916903
	speed: 0.1326s/iter; left time: 3901.0949s
	iters: 200, epoch: 21 | loss: 0.0020057
	speed: 0.0312s/iter; left time: 915.6549s
	iters: 300, epoch: 21 | loss: 0.0135394
	speed: 0.0299s/iter; left time: 874.4417s
Epoch: 21 cost time: 11.859042406082153
Epoch: 21, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.317 Vali Acc: 0.652 Test Loss: 2.317 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0207900
	speed: 0.1472s/iter; left time: 4275.4631s
	iters: 200, epoch: 22 | loss: 0.0042862
	speed: 0.0400s/iter; left time: 1158.3244s
	iters: 300, epoch: 22 | loss: 0.1021798
	speed: 0.0400s/iter; left time: 1154.3053s
Epoch: 22 cost time: 15.297635555267334
Epoch: 22, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.284 Vali Acc: 0.636 Test Loss: 2.284 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0048986
	speed: 0.1736s/iter; left time: 4979.4331s
	iters: 200, epoch: 23 | loss: 0.0009263
	speed: 0.0416s/iter; left time: 1190.4755s
	iters: 300, epoch: 23 | loss: 0.0878207
	speed: 0.0415s/iter; left time: 1183.2771s
Epoch: 23 cost time: 15.665306568145752
Epoch: 23, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.456 Vali Acc: 0.644 Test Loss: 2.456 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0020446
	speed: 0.1721s/iter; left time: 4873.6847s
	iters: 200, epoch: 24 | loss: 0.2420434
	speed: 0.0404s/iter; left time: 1140.8377s
	iters: 300, epoch: 24 | loss: 0.2388259
	speed: 0.0397s/iter; left time: 1116.9466s
Epoch: 24 cost time: 15.509210348129272
Epoch: 24, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.489 Vali Acc: 0.646 Test Loss: 2.489 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0030176
	speed: 0.1778s/iter; left time: 4969.9532s
	iters: 200, epoch: 25 | loss: 0.0482214
	speed: 0.0407s/iter; left time: 1134.0626s
	iters: 300, epoch: 25 | loss: 0.1998441
	speed: 0.0407s/iter; left time: 1128.3660s
Epoch: 25 cost time: 15.462361812591553
Epoch: 25, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.475 Vali Acc: 0.640 Test Loss: 2.475 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6600454029511919
model parameter : 202306
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1328756
	speed: 0.0413s/iter; left time: 1520.5905s
	iters: 200, epoch: 1 | loss: 0.7534591
	speed: 0.0238s/iter; left time: 874.0075s
	iters: 300, epoch: 1 | loss: 2.1192226
	speed: 0.0252s/iter; left time: 923.2150s
Epoch: 1 cost time: 10.80784797668457
Epoch: 1, Steps: 369 | Train Loss: 1.173 Vali Loss: 1.778 Vali Acc: 0.629 Test Loss: 1.778 Test Acc: 0.629
Validation loss decreased (inf --> -0.629381).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6496582
	speed: 0.1267s/iter; left time: 4617.1189s
	iters: 200, epoch: 2 | loss: 1.1409332
	speed: 0.0335s/iter; left time: 1217.9370s
	iters: 300, epoch: 2 | loss: 0.6939329
	speed: 0.0363s/iter; left time: 1316.0239s
Epoch: 2 cost time: 13.37178921699524
Epoch: 2, Steps: 369 | Train Loss: 1.361 Vali Loss: 1.909 Vali Acc: 0.641 Test Loss: 1.909 Test Acc: 0.641
Validation loss decreased (-0.629381 --> -0.641014).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2712249
	speed: 0.1522s/iter; left time: 5490.5461s
	iters: 200, epoch: 3 | loss: 1.5006852
	speed: 0.0344s/iter; left time: 1238.9166s
	iters: 300, epoch: 3 | loss: 1.6821606
	speed: 0.0346s/iter; left time: 1239.6897s
Epoch: 3 cost time: 13.259177207946777
Epoch: 3, Steps: 369 | Train Loss: 1.193 Vali Loss: 2.446 Vali Acc: 0.656 Test Loss: 2.446 Test Acc: 0.656
Validation loss decreased (-0.641014 --> -0.656332).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2678829
	speed: 0.1457s/iter; left time: 5200.2720s
	iters: 200, epoch: 4 | loss: 0.6372135
	speed: 0.0338s/iter; left time: 1204.7982s
	iters: 300, epoch: 4 | loss: 0.1111655
	speed: 0.0361s/iter; left time: 1282.4285s
Epoch: 4 cost time: 13.381558179855347
Epoch: 4, Steps: 369 | Train Loss: 1.196 Vali Loss: 3.079 Vali Acc: 0.628 Test Loss: 3.079 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1181761
	speed: 0.1486s/iter; left time: 5249.1647s
	iters: 200, epoch: 5 | loss: 0.5761745
	speed: 0.0352s/iter; left time: 1240.9947s
	iters: 300, epoch: 5 | loss: 0.7313715
	speed: 0.0350s/iter; left time: 1228.9086s
Epoch: 5 cost time: 13.710668802261353
Epoch: 5, Steps: 369 | Train Loss: 0.932 Vali Loss: 2.766 Vali Acc: 0.647 Test Loss: 2.766 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8608359
	speed: 0.1445s/iter; left time: 5051.6884s
	iters: 200, epoch: 6 | loss: 0.4658158
	speed: 0.0233s/iter; left time: 813.1444s
	iters: 300, epoch: 6 | loss: 0.0394615
	speed: 0.0259s/iter; left time: 901.6409s
Epoch: 6 cost time: 10.054009914398193
Epoch: 6, Steps: 369 | Train Loss: 0.747 Vali Loss: 2.809 Vali Acc: 0.642 Test Loss: 2.809 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4496248
	speed: 0.1245s/iter; left time: 4304.5387s
	iters: 200, epoch: 7 | loss: 1.0044754
	speed: 0.0259s/iter; left time: 893.2781s
	iters: 300, epoch: 7 | loss: 0.3470230
	speed: 0.0257s/iter; left time: 883.2700s
Epoch: 7 cost time: 10.09495997428894
Epoch: 7, Steps: 369 | Train Loss: 0.607 Vali Loss: 2.332 Vali Acc: 0.641 Test Loss: 2.332 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1432096
	speed: 0.1171s/iter; left time: 4008.3610s
	iters: 200, epoch: 8 | loss: 0.3694160
	speed: 0.0254s/iter; left time: 865.0195s
	iters: 300, epoch: 8 | loss: 0.3601787
	speed: 0.0244s/iter; left time: 829.7278s
Epoch: 8 cost time: 9.747697114944458
Epoch: 8, Steps: 369 | Train Loss: 0.366 Vali Loss: 2.375 Vali Acc: 0.637 Test Loss: 2.375 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1409701
	speed: 0.1195s/iter; left time: 4044.4922s
	iters: 200, epoch: 9 | loss: 0.6088014
	speed: 0.0278s/iter; left time: 936.5992s
	iters: 300, epoch: 9 | loss: 0.3303754
	speed: 0.0342s/iter; left time: 1152.0483s
Epoch: 9 cost time: 11.433686971664429
Epoch: 9, Steps: 369 | Train Loss: 0.293 Vali Loss: 1.942 Vali Acc: 0.646 Test Loss: 1.942 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2646356
	speed: 0.1504s/iter; left time: 5035.3429s
	iters: 200, epoch: 10 | loss: 0.1082455
	speed: 0.0352s/iter; left time: 1176.0695s
	iters: 300, epoch: 10 | loss: 0.0197832
	speed: 0.0366s/iter; left time: 1219.4600s
Epoch: 10 cost time: 13.852810621261597
Epoch: 10, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.855 Vali Acc: 0.636 Test Loss: 1.855 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2607054
	speed: 0.1486s/iter; left time: 4919.6587s
	iters: 200, epoch: 11 | loss: 0.1940281
	speed: 0.0351s/iter; left time: 1159.6577s
	iters: 300, epoch: 11 | loss: 0.3663423
	speed: 0.0361s/iter; left time: 1188.6720s
Epoch: 11 cost time: 13.876003503799438
Epoch: 11, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.794 Vali Acc: 0.648 Test Loss: 1.794 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3467799
	speed: 0.1520s/iter; left time: 4975.4658s
	iters: 200, epoch: 12 | loss: 0.0383683
	speed: 0.0362s/iter; left time: 1180.9272s
	iters: 300, epoch: 12 | loss: 0.1537840
	speed: 0.0352s/iter; left time: 1146.5461s
Epoch: 12 cost time: 13.902742862701416
Epoch: 12, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.875 Vali Acc: 0.654 Test Loss: 1.875 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0148093
	speed: 0.1518s/iter; left time: 4914.4598s
	iters: 200, epoch: 13 | loss: 0.1262344
	speed: 0.0366s/iter; left time: 1182.6169s
	iters: 300, epoch: 13 | loss: 0.1203314
	speed: 0.0356s/iter; left time: 1145.0880s
Epoch: 13 cost time: 13.888821363449097
Epoch: 13, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.887 Vali Acc: 0.648 Test Loss: 1.887 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6563564131668559
model parameter : 147074
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5113268
	speed: 0.0391s/iter; left time: 1437.9552s
	iters: 200, epoch: 1 | loss: 0.9478995
	speed: 0.0202s/iter; left time: 742.1942s
	iters: 300, epoch: 1 | loss: 0.7394891
	speed: 0.0195s/iter; left time: 713.8826s
Epoch: 1 cost time: 9.372895956039429
Epoch: 1, Steps: 369 | Train Loss: 0.992 Vali Loss: 1.923 Vali Acc: 0.620 Test Loss: 1.923 Test Acc: 0.620
Validation loss decreased (inf --> -0.620299).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3734615
	speed: 0.1176s/iter; left time: 4283.7578s
	iters: 200, epoch: 2 | loss: 0.6461503
	speed: 0.0309s/iter; left time: 1122.0597s
	iters: 300, epoch: 2 | loss: 1.2071157
	speed: 0.0300s/iter; left time: 1088.1684s
Epoch: 2 cost time: 12.02648401260376
Epoch: 2, Steps: 369 | Train Loss: 1.145 Vali Loss: 2.083 Vali Acc: 0.626 Test Loss: 2.083 Test Acc: 0.626
Validation loss decreased (-0.620299 --> -0.625972).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9377463
	speed: 0.1308s/iter; left time: 4716.1580s
	iters: 200, epoch: 3 | loss: 2.1444454
	speed: 0.0319s/iter; left time: 1148.2840s
	iters: 300, epoch: 3 | loss: 0.6540514
	speed: 0.0308s/iter; left time: 1105.1126s
Epoch: 3 cost time: 12.128409147262573
Epoch: 3, Steps: 369 | Train Loss: 1.080 Vali Loss: 2.370 Vali Acc: 0.620 Test Loss: 2.370 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0897063
	speed: 0.1356s/iter; left time: 4840.3026s
	iters: 200, epoch: 4 | loss: 0.9884284
	speed: 0.0317s/iter; left time: 1129.8109s
	iters: 300, epoch: 4 | loss: 2.0658531
	speed: 0.0318s/iter; left time: 1130.4023s
Epoch: 4 cost time: 12.324472427368164
Epoch: 4, Steps: 369 | Train Loss: 1.067 Vali Loss: 2.412 Vali Acc: 0.644 Test Loss: 2.412 Test Acc: 0.644
Validation loss decreased (-0.625972 --> -0.644414).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2560429
	speed: 0.1337s/iter; left time: 4723.3165s
	iters: 200, epoch: 5 | loss: 1.5582206
	speed: 0.0305s/iter; left time: 1075.8620s
	iters: 300, epoch: 5 | loss: 0.8745152
	speed: 0.0334s/iter; left time: 1173.2755s
Epoch: 5 cost time: 12.122616052627563
Epoch: 5, Steps: 369 | Train Loss: 0.885 Vali Loss: 2.505 Vali Acc: 0.639 Test Loss: 2.505 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0149092
	speed: 0.1346s/iter; left time: 4706.2651s
	iters: 200, epoch: 6 | loss: 0.0175074
	speed: 0.0307s/iter; left time: 1071.3812s
	iters: 300, epoch: 6 | loss: 0.7524452
	speed: 0.0303s/iter; left time: 1053.2301s
Epoch: 6 cost time: 11.488948583602905
Epoch: 6, Steps: 369 | Train Loss: 0.753 Vali Loss: 2.717 Vali Acc: 0.630 Test Loss: 2.717 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6227253
	speed: 0.1131s/iter; left time: 3910.0986s
	iters: 200, epoch: 7 | loss: 0.6276845
	speed: 0.0213s/iter; left time: 733.6213s
	iters: 300, epoch: 7 | loss: 0.3300881
	speed: 0.0212s/iter; left time: 728.3333s
Epoch: 7 cost time: 8.576173543930054
Epoch: 7, Steps: 369 | Train Loss: 0.566 Vali Loss: 2.116 Vali Acc: 0.639 Test Loss: 2.116 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2609673
	speed: 0.1076s/iter; left time: 3681.2213s
	iters: 200, epoch: 8 | loss: 0.3955567
	speed: 0.0190s/iter; left time: 649.6602s
	iters: 300, epoch: 8 | loss: 0.0303128
	speed: 0.0203s/iter; left time: 690.2518s
Epoch: 8 cost time: 7.636573076248169
Epoch: 8, Steps: 369 | Train Loss: 0.399 Vali Loss: 1.945 Vali Acc: 0.640 Test Loss: 1.945 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1877498
	speed: 0.1116s/iter; left time: 3778.5828s
	iters: 200, epoch: 9 | loss: 0.0983987
	speed: 0.0191s/iter; left time: 642.9266s
	iters: 300, epoch: 9 | loss: 0.3711861
	speed: 0.0193s/iter; left time: 649.8399s
Epoch: 9 cost time: 7.7614781856536865
Epoch: 9, Steps: 369 | Train Loss: 0.303 Vali Loss: 1.857 Vali Acc: 0.646 Test Loss: 1.857 Test Acc: 0.646
Validation loss decreased (-0.644414 --> -0.645555).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0082942
	speed: 0.1150s/iter; left time: 3851.7529s
	iters: 200, epoch: 10 | loss: 0.1979190
	speed: 0.0300s/iter; left time: 1001.7882s
	iters: 300, epoch: 10 | loss: 0.4871267
	speed: 0.0301s/iter; left time: 1001.7500s
Epoch: 10 cost time: 11.860654592514038
Epoch: 10, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.710 Vali Acc: 0.650 Test Loss: 1.710 Test Acc: 0.650
Validation loss decreased (-0.645555 --> -0.649529).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0158731
	speed: 0.1369s/iter; left time: 4534.3563s
	iters: 200, epoch: 11 | loss: 0.3018113
	speed: 0.0309s/iter; left time: 1019.0441s
	iters: 300, epoch: 11 | loss: 0.6232642
	speed: 0.0321s/iter; left time: 1055.8556s
Epoch: 11 cost time: 12.37013053894043
Epoch: 11, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.680 Vali Acc: 0.653 Test Loss: 1.680 Test Acc: 0.653
Validation loss decreased (-0.649529 --> -0.652651).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1786052
	speed: 0.1358s/iter; left time: 4445.9153s
	iters: 200, epoch: 12 | loss: 0.3577569
	speed: 0.0310s/iter; left time: 1011.7471s
	iters: 300, epoch: 12 | loss: 0.0291997
	speed: 0.0313s/iter; left time: 1017.8410s
Epoch: 12 cost time: 12.265600204467773
Epoch: 12, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.764 Vali Acc: 0.648 Test Loss: 1.764 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0574115
	speed: 0.1402s/iter; left time: 4539.8414s
	iters: 200, epoch: 13 | loss: 0.0595488
	speed: 0.0309s/iter; left time: 997.0932s
	iters: 300, epoch: 13 | loss: 0.0860673
	speed: 0.0328s/iter; left time: 1056.1603s
Epoch: 13 cost time: 12.397010326385498
Epoch: 13, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.852 Vali Acc: 0.648 Test Loss: 1.852 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1191955
	speed: 0.1307s/iter; left time: 4183.2202s
	iters: 200, epoch: 14 | loss: 0.4065997
	speed: 0.0324s/iter; left time: 1033.4959s
	iters: 300, epoch: 14 | loss: 0.1692762
	speed: 0.0326s/iter; left time: 1035.8597s
Epoch: 14 cost time: 12.398584127426147
Epoch: 14, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.864 Vali Acc: 0.646 Test Loss: 1.864 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0157238
	speed: 0.1138s/iter; left time: 3598.9620s
	iters: 200, epoch: 15 | loss: 0.2641845
	speed: 0.0227s/iter; left time: 715.5268s
	iters: 300, epoch: 15 | loss: 0.1710217
	speed: 0.0209s/iter; left time: 656.6588s
Epoch: 15 cost time: 8.828565120697021
Epoch: 15, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.920 Vali Acc: 0.636 Test Loss: 1.920 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0667180
	speed: 0.1123s/iter; left time: 3512.4710s
	iters: 200, epoch: 16 | loss: 0.0273496
	speed: 0.0159s/iter; left time: 494.0922s
	iters: 300, epoch: 16 | loss: 0.0493762
	speed: 0.0219s/iter; left time: 679.7965s
Epoch: 16 cost time: 8.089763641357422
Epoch: 16, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.988 Vali Acc: 0.638 Test Loss: 1.988 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0214104
	speed: 0.1117s/iter; left time: 3451.7017s
	iters: 200, epoch: 17 | loss: 0.0275692
	speed: 0.0208s/iter; left time: 639.1482s
	iters: 300, epoch: 17 | loss: 0.0176963
	speed: 0.0205s/iter; left time: 629.5951s
Epoch: 17 cost time: 8.318583726882935
Epoch: 17, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.108 Vali Acc: 0.636 Test Loss: 2.108 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0107825
	speed: 0.0994s/iter; left time: 3033.2375s
	iters: 200, epoch: 18 | loss: 0.0051078
	speed: 0.0268s/iter; left time: 814.5986s
	iters: 300, epoch: 18 | loss: 0.1112809
	speed: 0.0267s/iter; left time: 809.7829s
Epoch: 18 cost time: 9.758196353912354
Epoch: 18, Steps: 369 | Train Loss: 0.077 Vali Loss: 2.115 Vali Acc: 0.641 Test Loss: 2.115 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0241290
	speed: 0.1175s/iter; left time: 3543.6766s
	iters: 200, epoch: 19 | loss: 0.0663407
	speed: 0.0161s/iter; left time: 483.4713s
	iters: 300, epoch: 19 | loss: 0.5039635
	speed: 0.0121s/iter; left time: 363.5603s
Epoch: 19 cost time: 6.756589889526367
Epoch: 19, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.156 Vali Acc: 0.642 Test Loss: 2.156 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1894857
	speed: 0.0669s/iter; left time: 1992.9783s
	iters: 200, epoch: 20 | loss: 0.2523010
	speed: 0.0107s/iter; left time: 317.0574s
	iters: 300, epoch: 20 | loss: 0.0408829
	speed: 0.0106s/iter; left time: 313.7406s
Epoch: 20 cost time: 4.468969106674194
Epoch: 20, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.189 Vali Acc: 0.645 Test Loss: 2.189 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0137926
	speed: 0.0701s/iter; left time: 2063.4904s
	iters: 200, epoch: 21 | loss: 0.0281372
	speed: 0.0115s/iter; left time: 336.2058s
	iters: 300, epoch: 21 | loss: 0.0605477
	speed: 0.0126s/iter; left time: 368.7153s
Epoch: 21 cost time: 5.9570252895355225
Epoch: 21, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.277 Vali Acc: 0.644 Test Loss: 2.277 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 119522
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0094811
	speed: 0.0428s/iter; left time: 1576.5290s
	iters: 200, epoch: 1 | loss: 0.4910093
	speed: 0.0285s/iter; left time: 1047.0483s
	iters: 300, epoch: 1 | loss: 1.3680655
	speed: 0.0282s/iter; left time: 1032.9825s
Epoch: 1 cost time: 12.027791023254395
Epoch: 1, Steps: 369 | Train Loss: 0.855 Vali Loss: 1.757 Vali Acc: 0.588 Test Loss: 1.757 Test Acc: 0.588
Validation loss decreased (inf --> -0.587667).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2501312
	speed: 0.1220s/iter; left time: 4445.5805s
	iters: 200, epoch: 2 | loss: 1.4060017
	speed: 0.0281s/iter; left time: 1020.5637s
	iters: 300, epoch: 2 | loss: 0.4492362
	speed: 0.0279s/iter; left time: 1009.7867s
Epoch: 2 cost time: 10.909608602523804
Epoch: 2, Steps: 369 | Train Loss: 0.945 Vali Loss: 1.622 Vali Acc: 0.636 Test Loss: 1.622 Test Acc: 0.636
Validation loss decreased (-0.587667 --> -0.636193).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1687443
	speed: 0.1248s/iter; left time: 4502.1500s
	iters: 200, epoch: 3 | loss: 0.8988383
	speed: 0.0277s/iter; left time: 997.2613s
	iters: 300, epoch: 3 | loss: 0.5839724
	speed: 0.0274s/iter; left time: 982.1243s
Epoch: 3 cost time: 10.696670293807983
Epoch: 3, Steps: 369 | Train Loss: 0.949 Vali Loss: 2.188 Vali Acc: 0.633 Test Loss: 2.188 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8162554
	speed: 0.1003s/iter; left time: 3581.4884s
	iters: 200, epoch: 4 | loss: 1.2515016
	speed: 0.0177s/iter; left time: 629.7670s
	iters: 300, epoch: 4 | loss: 0.4266989
	speed: 0.0181s/iter; left time: 643.3071s
Epoch: 4 cost time: 7.2012388706207275
Epoch: 4, Steps: 369 | Train Loss: 0.877 Vali Loss: 2.397 Vali Acc: 0.629 Test Loss: 2.397 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2708610
	speed: 0.0899s/iter; left time: 3174.7139s
	iters: 200, epoch: 5 | loss: 0.5084187
	speed: 0.0174s/iter; left time: 614.1218s
	iters: 300, epoch: 5 | loss: 0.7849720
	speed: 0.0181s/iter; left time: 634.0889s
Epoch: 5 cost time: 6.668517351150513
Epoch: 5, Steps: 369 | Train Loss: 0.789 Vali Loss: 2.273 Vali Acc: 0.643 Test Loss: 2.273 Test Acc: 0.643
Validation loss decreased (-0.636193 --> -0.642713).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4073507
	speed: 0.0942s/iter; left time: 3293.2671s
	iters: 200, epoch: 6 | loss: 0.0203675
	speed: 0.0177s/iter; left time: 618.6306s
	iters: 300, epoch: 6 | loss: 0.0846166
	speed: 0.0178s/iter; left time: 619.0378s
Epoch: 6 cost time: 7.105809926986694
Epoch: 6, Steps: 369 | Train Loss: 0.656 Vali Loss: 2.378 Vali Acc: 0.656 Test Loss: 2.378 Test Acc: 0.656
Validation loss decreased (-0.642713 --> -0.656049).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3547129
	speed: 0.1174s/iter; left time: 4058.9005s
	iters: 200, epoch: 7 | loss: 1.5614750
	speed: 0.0281s/iter; left time: 969.5971s
	iters: 300, epoch: 7 | loss: 0.0767807
	speed: 0.0281s/iter; left time: 965.1051s
Epoch: 7 cost time: 10.85570240020752
Epoch: 7, Steps: 369 | Train Loss: 0.519 Vali Loss: 2.362 Vali Acc: 0.645 Test Loss: 2.362 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0152520
	speed: 0.1226s/iter; left time: 4196.1198s
	iters: 200, epoch: 8 | loss: 0.1695819
	speed: 0.0288s/iter; left time: 983.7112s
	iters: 300, epoch: 8 | loss: 0.5433156
	speed: 0.0286s/iter; left time: 971.9344s
Epoch: 8 cost time: 11.014026641845703
Epoch: 8, Steps: 369 | Train Loss: 0.399 Vali Loss: 2.114 Vali Acc: 0.650 Test Loss: 2.114 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3087051
	speed: 0.1202s/iter; left time: 4069.6407s
	iters: 200, epoch: 9 | loss: 0.2535981
	speed: 0.0292s/iter; left time: 984.4571s
	iters: 300, epoch: 9 | loss: 0.4989896
	speed: 0.0286s/iter; left time: 962.2509s
Epoch: 9 cost time: 11.066155433654785
Epoch: 9, Steps: 369 | Train Loss: 0.347 Vali Loss: 2.069 Vali Acc: 0.643 Test Loss: 2.069 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0700294
	speed: 0.1190s/iter; left time: 3985.4588s
	iters: 200, epoch: 10 | loss: 0.2395516
	speed: 0.0290s/iter; left time: 967.1613s
	iters: 300, epoch: 10 | loss: 0.7899206
	speed: 0.0280s/iter; left time: 932.3279s
Epoch: 10 cost time: 10.954389810562134
Epoch: 10, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.949 Vali Acc: 0.651 Test Loss: 1.949 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1734540
	speed: 0.1238s/iter; left time: 4098.0501s
	iters: 200, epoch: 11 | loss: 0.2215080
	speed: 0.0276s/iter; left time: 909.6139s
	iters: 300, epoch: 11 | loss: 0.1191074
	speed: 0.0145s/iter; left time: 475.8586s
Epoch: 11 cost time: 8.702651262283325
Epoch: 11, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.899 Vali Acc: 0.643 Test Loss: 1.899 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0071829
	speed: 0.0943s/iter; left time: 3086.3288s
	iters: 200, epoch: 12 | loss: 0.0735055
	speed: 0.0181s/iter; left time: 590.3942s
	iters: 300, epoch: 12 | loss: 0.0032406
	speed: 0.0188s/iter; left time: 613.3919s
Epoch: 12 cost time: 7.328242540359497
Epoch: 12, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.970 Vali Acc: 0.642 Test Loss: 1.970 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3271327
	speed: 0.0909s/iter; left time: 2943.4660s
	iters: 200, epoch: 13 | loss: 0.0100718
	speed: 0.0182s/iter; left time: 587.6240s
	iters: 300, epoch: 13 | loss: 0.0132699
	speed: 0.0183s/iter; left time: 588.0958s
Epoch: 13 cost time: 7.326032400131226
Epoch: 13, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.954 Vali Acc: 0.635 Test Loss: 1.954 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1245391
	speed: 0.0914s/iter; left time: 2926.2582s
	iters: 200, epoch: 14 | loss: 0.2871776
	speed: 0.0216s/iter; left time: 688.3805s
	iters: 300, epoch: 14 | loss: 0.4092492
	speed: 0.0281s/iter; left time: 893.7626s
Epoch: 14 cost time: 9.182402849197388
Epoch: 14, Steps: 369 | Train Loss: 0.126 Vali Loss: 2.052 Vali Acc: 0.638 Test Loss: 2.052 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0792548
	speed: 0.1244s/iter; left time: 3934.1685s
	iters: 200, epoch: 15 | loss: 0.0249534
	speed: 0.0281s/iter; left time: 887.6419s
	iters: 300, epoch: 15 | loss: 0.0058805
	speed: 0.0277s/iter; left time: 870.2401s
Epoch: 15 cost time: 10.780283451080322
Epoch: 15, Steps: 369 | Train Loss: 0.097 Vali Loss: 2.026 Vali Acc: 0.652 Test Loss: 2.026 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0255579
	speed: 0.1218s/iter; left time: 3807.3853s
	iters: 200, epoch: 16 | loss: 0.0093468
	speed: 0.0289s/iter; left time: 901.0586s
	iters: 300, epoch: 16 | loss: 0.6109558
	speed: 0.0288s/iter; left time: 895.1878s
Epoch: 16 cost time: 11.122175931930542
Epoch: 16, Steps: 369 | Train Loss: 0.094 Vali Loss: 2.105 Vali Acc: 0.646 Test Loss: 2.105 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.656072644721907
model parameter : 91970
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7977582
	speed: 0.0397s/iter; left time: 1459.6604s
	iters: 200, epoch: 1 | loss: 1.4852613
	speed: 0.0248s/iter; left time: 911.1287s
	iters: 300, epoch: 1 | loss: 0.7027295
	speed: 0.0243s/iter; left time: 888.9808s
Epoch: 1 cost time: 10.622331619262695
Epoch: 1, Steps: 369 | Train Loss: 0.811 Vali Loss: 1.267 Vali Acc: 0.609 Test Loss: 1.267 Test Acc: 0.609
Validation loss decreased (inf --> -0.608954).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2820057
	speed: 0.0910s/iter; left time: 3314.1554s
	iters: 200, epoch: 2 | loss: 0.8178980
	speed: 0.0154s/iter; left time: 559.5449s
	iters: 300, epoch: 2 | loss: 0.7273329
	speed: 0.0155s/iter; left time: 561.1217s
Epoch: 2 cost time: 6.330865144729614
Epoch: 2, Steps: 369 | Train Loss: 0.859 Vali Loss: 1.725 Vali Acc: 0.633 Test Loss: 1.725 Test Acc: 0.633
Validation loss decreased (-0.608954 --> -0.633070).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1468924
	speed: 0.0852s/iter; left time: 3073.8501s
	iters: 200, epoch: 3 | loss: 0.7640308
	speed: 0.0155s/iter; left time: 558.8145s
	iters: 300, epoch: 3 | loss: 0.4911637
	speed: 0.0154s/iter; left time: 550.8957s
Epoch: 3 cost time: 6.040549993515015
Epoch: 3, Steps: 369 | Train Loss: 0.872 Vali Loss: 2.241 Vali Acc: 0.615 Test Loss: 2.241 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4529058
	speed: 0.0917s/iter; left time: 3271.7815s
	iters: 200, epoch: 4 | loss: 0.3983137
	speed: 0.0150s/iter; left time: 535.4105s
	iters: 300, epoch: 4 | loss: 0.5079670
	speed: 0.0149s/iter; left time: 527.7569s
Epoch: 4 cost time: 6.117347002029419
Epoch: 4, Steps: 369 | Train Loss: 0.792 Vali Loss: 2.102 Vali Acc: 0.643 Test Loss: 2.102 Test Acc: 0.643
Validation loss decreased (-0.633070 --> -0.643282).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7248485
	speed: 0.0994s/iter; left time: 3512.1204s
	iters: 200, epoch: 5 | loss: 0.4056351
	speed: 0.0250s/iter; left time: 879.4428s
	iters: 300, epoch: 5 | loss: 0.4546827
	speed: 0.0250s/iter; left time: 877.0231s
Epoch: 5 cost time: 9.768178462982178
Epoch: 5, Steps: 369 | Train Loss: 0.703 Vali Loss: 2.172 Vali Acc: 0.638 Test Loss: 2.172 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9974928
	speed: 0.1076s/iter; left time: 3761.8537s
	iters: 200, epoch: 6 | loss: 0.3247905
	speed: 0.0248s/iter; left time: 864.8290s
	iters: 300, epoch: 6 | loss: 0.3544514
	speed: 0.0244s/iter; left time: 846.8804s
Epoch: 6 cost time: 9.769460439682007
Epoch: 6, Steps: 369 | Train Loss: 0.565 Vali Loss: 2.221 Vali Acc: 0.650 Test Loss: 2.221 Test Acc: 0.650
Validation loss decreased (-0.643282 --> -0.650375).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4032866
	speed: 0.1073s/iter; left time: 3712.0604s
	iters: 200, epoch: 7 | loss: 0.8623881
	speed: 0.0248s/iter; left time: 856.2326s
	iters: 300, epoch: 7 | loss: 0.6695182
	speed: 0.0243s/iter; left time: 834.2493s
Epoch: 7 cost time: 9.787214517593384
Epoch: 7, Steps: 369 | Train Loss: 0.510 Vali Loss: 2.165 Vali Acc: 0.646 Test Loss: 2.165 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4009779
	speed: 0.1074s/iter; left time: 3675.0349s
	iters: 200, epoch: 8 | loss: 0.0959086
	speed: 0.0259s/iter; left time: 883.0503s
	iters: 300, epoch: 8 | loss: 0.8546643
	speed: 0.0265s/iter; left time: 901.3858s
Epoch: 8 cost time: 10.240243673324585
Epoch: 8, Steps: 369 | Train Loss: 0.403 Vali Loss: 2.095 Vali Acc: 0.641 Test Loss: 2.095 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1839435
	speed: 0.1163s/iter; left time: 3937.5586s
	iters: 200, epoch: 9 | loss: 0.1285353
	speed: 0.0261s/iter; left time: 879.9288s
	iters: 300, epoch: 9 | loss: 0.0718024
	speed: 0.0257s/iter; left time: 866.2022s
Epoch: 9 cost time: 10.296740770339966
Epoch: 9, Steps: 369 | Train Loss: 0.329 Vali Loss: 1.850 Vali Acc: 0.653 Test Loss: 1.850 Test Acc: 0.653
Validation loss decreased (-0.650375 --> -0.653216).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2365023
	speed: 0.0944s/iter; left time: 3159.6914s
	iters: 200, epoch: 10 | loss: 0.6268902
	speed: 0.0164s/iter; left time: 546.1279s
	iters: 300, epoch: 10 | loss: 0.4059465
	speed: 0.0167s/iter; left time: 556.2408s
Epoch: 10 cost time: 6.674662351608276
Epoch: 10, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.925 Vali Acc: 0.640 Test Loss: 1.925 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5475353
	speed: 0.0919s/iter; left time: 3042.4307s
	iters: 200, epoch: 11 | loss: 0.2865272
	speed: 0.0133s/iter; left time: 439.6909s
	iters: 300, epoch: 11 | loss: 0.0062297
	speed: 0.0170s/iter; left time: 559.5940s
Epoch: 11 cost time: 6.560253143310547
Epoch: 11, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.896 Vali Acc: 0.644 Test Loss: 1.896 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1352463
	speed: 0.0872s/iter; left time: 2853.9659s
	iters: 200, epoch: 12 | loss: 0.0963761
	speed: 0.0153s/iter; left time: 499.3064s
	iters: 300, epoch: 12 | loss: 0.2684107
	speed: 0.0150s/iter; left time: 487.9405s
Epoch: 12 cost time: 6.191986799240112
Epoch: 12, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.813 Vali Acc: 0.644 Test Loss: 1.813 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0533672
	speed: 0.0991s/iter; left time: 3208.1393s
	iters: 200, epoch: 13 | loss: 0.0158446
	speed: 0.0250s/iter; left time: 807.3091s
	iters: 300, epoch: 13 | loss: 0.2213793
	speed: 0.0249s/iter; left time: 800.2389s
Epoch: 13 cost time: 9.793063879013062
Epoch: 13, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.880 Vali Acc: 0.639 Test Loss: 1.880 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1166475
	speed: 0.1081s/iter; left time: 3458.6821s
	iters: 200, epoch: 14 | loss: 0.0547117
	speed: 0.0247s/iter; left time: 788.8330s
	iters: 300, epoch: 14 | loss: 0.0494491
	speed: 0.0253s/iter; left time: 804.8945s
Epoch: 14 cost time: 9.711087465286255
Epoch: 14, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.912 Vali Acc: 0.642 Test Loss: 1.912 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0527125
	speed: 0.1068s/iter; left time: 3380.0361s
	iters: 200, epoch: 15 | loss: 0.1525122
	speed: 0.0254s/iter; left time: 802.1937s
	iters: 300, epoch: 15 | loss: 0.2771269
	speed: 0.0258s/iter; left time: 811.9549s
Epoch: 15 cost time: 10.248937368392944
Epoch: 15, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.954 Vali Acc: 0.637 Test Loss: 1.954 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0083371
	speed: 0.1109s/iter; left time: 3467.0999s
	iters: 200, epoch: 16 | loss: 0.3834455
	speed: 0.0254s/iter; left time: 792.8663s
	iters: 300, epoch: 16 | loss: 0.0060607
	speed: 0.0255s/iter; left time: 792.8329s
Epoch: 16 cost time: 10.196297883987427
Epoch: 16, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.929 Vali Acc: 0.640 Test Loss: 1.929 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0492596
	speed: 0.1152s/iter; left time: 3560.4928s
	iters: 200, epoch: 17 | loss: 0.0110606
	speed: 0.0256s/iter; left time: 789.3648s
	iters: 300, epoch: 17 | loss: 0.5124661
	speed: 0.0261s/iter; left time: 801.9497s
Epoch: 17 cost time: 10.154803037643433
Epoch: 17, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.998 Vali Acc: 0.652 Test Loss: 1.998 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.4121706
	speed: 0.0948s/iter; left time: 2893.8809s
	iters: 200, epoch: 18 | loss: 0.0367022
	speed: 0.0175s/iter; left time: 533.5665s
	iters: 300, epoch: 18 | loss: 0.2234728
	speed: 0.0167s/iter; left time: 507.9579s
Epoch: 18 cost time: 7.131540298461914
Epoch: 18, Steps: 369 | Train Loss: 0.100 Vali Loss: 2.049 Vali Acc: 0.643 Test Loss: 2.049 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.2491414
	speed: 0.0920s/iter; left time: 2775.4771s
	iters: 200, epoch: 19 | loss: 0.2603946
	speed: 0.0145s/iter; left time: 437.0075s
	iters: 300, epoch: 19 | loss: 0.0166868
	speed: 0.0167s/iter; left time: 499.8765s
Epoch: 19 cost time: 6.544576406478882
Epoch: 19, Steps: 369 | Train Loss: 0.093 Vali Loss: 2.035 Vali Acc: 0.656 Test Loss: 2.035 Test Acc: 0.656
Validation loss decreased (-0.653216 --> -0.655769).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0013433
	speed: 0.0919s/iter; left time: 2736.9441s
	iters: 200, epoch: 20 | loss: 0.1747690
	speed: 0.0158s/iter; left time: 470.3809s
	iters: 300, epoch: 20 | loss: 0.0127427
	speed: 0.0158s/iter; left time: 466.2597s
Epoch: 20 cost time: 6.582570314407349
Epoch: 20, Steps: 369 | Train Loss: 0.093 Vali Loss: 2.160 Vali Acc: 0.633 Test Loss: 2.160 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1396336
	speed: 0.1062s/iter; left time: 3124.3930s
	iters: 200, epoch: 21 | loss: 0.0031158
	speed: 0.0254s/iter; left time: 743.7435s
	iters: 300, epoch: 21 | loss: 0.0942610
	speed: 0.0254s/iter; left time: 743.0668s
Epoch: 21 cost time: 9.945801496505737
Epoch: 21, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.214 Vali Acc: 0.640 Test Loss: 2.214 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4547278
	speed: 0.1157s/iter; left time: 3360.7973s
	iters: 200, epoch: 22 | loss: 0.0022015
	speed: 0.0241s/iter; left time: 699.1026s
	iters: 300, epoch: 22 | loss: 0.0057352
	speed: 0.0251s/iter; left time: 724.0028s
Epoch: 22 cost time: 9.845375061035156
Epoch: 22, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.223 Vali Acc: 0.649 Test Loss: 2.223 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0090139
	speed: 0.1105s/iter; left time: 3169.9927s
	iters: 200, epoch: 23 | loss: 0.1110267
	speed: 0.0251s/iter; left time: 717.0393s
	iters: 300, epoch: 23 | loss: 0.0181249
	speed: 0.0249s/iter; left time: 710.0198s
Epoch: 23 cost time: 9.861372470855713
Epoch: 23, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.186 Vali Acc: 0.644 Test Loss: 2.186 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0254306
	speed: 0.1118s/iter; left time: 3165.3209s
	iters: 200, epoch: 24 | loss: 0.0133553
	speed: 0.0249s/iter; left time: 702.2673s
	iters: 300, epoch: 24 | loss: 0.1455441
	speed: 0.0268s/iter; left time: 752.0664s
Epoch: 24 cost time: 10.11965274810791
Epoch: 24, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.232 Vali Acc: 0.646 Test Loss: 2.232 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0498050
	speed: 0.1153s/iter; left time: 3223.0816s
	iters: 200, epoch: 25 | loss: 0.1696025
	speed: 0.0250s/iter; left time: 696.8584s
	iters: 300, epoch: 25 | loss: 0.0248243
	speed: 0.0260s/iter; left time: 720.7373s
Epoch: 25 cost time: 10.036811351776123
Epoch: 25, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.261 Vali Acc: 0.643 Test Loss: 2.261 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0071880
	speed: 0.1005s/iter; left time: 2770.7497s
	iters: 200, epoch: 26 | loss: 0.0177997
	speed: 0.0169s/iter; left time: 463.9777s
	iters: 300, epoch: 26 | loss: 0.0077233
	speed: 0.0170s/iter; left time: 465.9534s
Epoch: 26 cost time: 6.906928300857544
Epoch: 26, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.248 Vali Acc: 0.645 Test Loss: 2.248 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0005994
	speed: 0.0806s/iter; left time: 2193.9632s
	iters: 200, epoch: 27 | loss: 0.1675160
	speed: 0.0158s/iter; left time: 427.1628s
	iters: 300, epoch: 27 | loss: 0.0133751
	speed: 0.0161s/iter; left time: 434.6805s
Epoch: 27 cost time: 6.357999563217163
Epoch: 27, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.368 Vali Acc: 0.638 Test Loss: 2.368 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0913928
	speed: 0.0926s/iter; left time: 2484.9377s
	iters: 200, epoch: 28 | loss: 0.0092151
	speed: 0.0154s/iter; left time: 412.3878s
	iters: 300, epoch: 28 | loss: 0.1473372
	speed: 0.0163s/iter; left time: 435.4752s
Epoch: 28 cost time: 6.605057239532471
Epoch: 28, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.327 Vali Acc: 0.642 Test Loss: 2.327 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0007066
	speed: 0.1017s/iter; left time: 2691.9662s
	iters: 200, epoch: 29 | loss: 0.0009256
	speed: 0.0254s/iter; left time: 669.0459s
	iters: 300, epoch: 29 | loss: 0.0044168
	speed: 0.0259s/iter; left time: 679.5439s
Epoch: 29 cost time: 10.144850730895996
Epoch: 29, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.488 Vali Acc: 0.646 Test Loss: 2.488 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.655788876276958
model parameter : 73634
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1815389
	speed: 0.1034s/iter; left time: 3804.8352s
	iters: 200, epoch: 1 | loss: 1.7699995
	speed: 0.0875s/iter; left time: 3209.8767s
	iters: 300, epoch: 1 | loss: 1.0836571
	speed: 0.0880s/iter; left time: 3219.8845s
Epoch: 1 cost time: 34.042144775390625
Epoch: 1, Steps: 369 | Train Loss: 1.770 Vali Loss: 1.836 Vali Acc: 0.624 Test Loss: 1.836 Test Acc: 0.624
Validation loss decreased (inf --> -0.623705).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6458347
	speed: 0.2780s/iter; left time: 10127.4024s
	iters: 200, epoch: 2 | loss: 1.7511181
	speed: 0.0732s/iter; left time: 2658.8741s
	iters: 300, epoch: 2 | loss: 1.6252090
	speed: 0.0729s/iter; left time: 2641.9408s
Epoch: 2 cost time: 27.40464162826538
Epoch: 2, Steps: 369 | Train Loss: 1.862 Vali Loss: 2.653 Vali Acc: 0.629 Test Loss: 2.653 Test Acc: 0.629
Validation loss decreased (-0.623705 --> -0.629088).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1134828
	speed: 0.2514s/iter; left time: 9067.7478s
	iters: 200, epoch: 3 | loss: 2.7897205
	speed: 0.0698s/iter; left time: 2511.3471s
	iters: 300, epoch: 3 | loss: 2.6584003
	speed: 0.0876s/iter; left time: 3141.2095s
Epoch: 3 cost time: 29.419673442840576
Epoch: 3, Steps: 369 | Train Loss: 1.599 Vali Loss: 3.634 Vali Acc: 0.638 Test Loss: 3.634 Test Acc: 0.638
Validation loss decreased (-0.629088 --> -0.638159).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4275018
	speed: 0.2941s/iter; left time: 10496.8842s
	iters: 200, epoch: 4 | loss: 1.9453001
	speed: 0.0856s/iter; left time: 3048.4681s
	iters: 300, epoch: 4 | loss: 1.7453367
	speed: 0.0845s/iter; left time: 2998.2279s
Epoch: 4 cost time: 32.004862785339355
Epoch: 4, Steps: 369 | Train Loss: 1.254 Vali Loss: 3.497 Vali Acc: 0.631 Test Loss: 3.497 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9681839
	speed: 0.2964s/iter; left time: 10470.3989s
	iters: 200, epoch: 5 | loss: 2.3166583
	speed: 0.0868s/iter; left time: 3055.7923s
	iters: 300, epoch: 5 | loss: 1.8182759
	speed: 0.0865s/iter; left time: 3039.4999s
Epoch: 5 cost time: 32.46702456474304
Epoch: 5, Steps: 369 | Train Loss: 0.897 Vali Loss: 3.759 Vali Acc: 0.633 Test Loss: 3.759 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9866782
	speed: 0.2847s/iter; left time: 9953.5454s
	iters: 200, epoch: 6 | loss: 0.2227656
	speed: 0.0718s/iter; left time: 2502.7970s
	iters: 300, epoch: 6 | loss: 0.4729823
	speed: 0.0719s/iter; left time: 2500.2738s
Epoch: 6 cost time: 26.84564208984375
Epoch: 6, Steps: 369 | Train Loss: 0.534 Vali Loss: 2.766 Vali Acc: 0.619 Test Loss: 2.766 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2354918
	speed: 0.2489s/iter; left time: 8607.3893s
	iters: 200, epoch: 7 | loss: 0.0336998
	speed: 0.0720s/iter; left time: 2484.1054s
	iters: 300, epoch: 7 | loss: 0.3944939
	speed: 0.0678s/iter; left time: 2332.2403s
Epoch: 7 cost time: 27.183871269226074
Epoch: 7, Steps: 369 | Train Loss: 0.250 Vali Loss: 2.562 Vali Acc: 0.635 Test Loss: 2.562 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0219233
	speed: 0.2932s/iter; left time: 10031.9027s
	iters: 200, epoch: 8 | loss: 0.2181675
	speed: 0.0861s/iter; left time: 2939.1381s
	iters: 300, epoch: 8 | loss: 0.5142649
	speed: 0.0862s/iter; left time: 2932.3440s
Epoch: 8 cost time: 32.44574522972107
Epoch: 8, Steps: 369 | Train Loss: 0.169 Vali Loss: 2.478 Vali Acc: 0.623 Test Loss: 2.478 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2107063
	speed: 0.2971s/iter; left time: 10055.7739s
	iters: 200, epoch: 9 | loss: 0.0693175
	speed: 0.0866s/iter; left time: 2923.9640s
	iters: 300, epoch: 9 | loss: 0.0333332
	speed: 0.0874s/iter; left time: 2941.4580s
Epoch: 9 cost time: 32.61208772659302
Epoch: 9, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.486 Vali Acc: 0.634 Test Loss: 2.486 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0035829
	speed: 0.3023s/iter; left time: 10120.3817s
	iters: 200, epoch: 10 | loss: 0.0164972
	speed: 0.0772s/iter; left time: 2576.8439s
	iters: 300, epoch: 10 | loss: 0.1259446
	speed: 0.0731s/iter; left time: 2432.5882s
Epoch: 10 cost time: 29.375819206237793
Epoch: 10, Steps: 369 | Train Loss: 0.115 Vali Loss: 2.160 Vali Acc: 0.631 Test Loss: 2.160 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0018545
	speed: 0.2529s/iter; left time: 8372.2018s
	iters: 200, epoch: 11 | loss: 0.0264387
	speed: 0.0686s/iter; left time: 2264.9968s
	iters: 300, epoch: 11 | loss: 0.1188947
	speed: 0.0695s/iter; left time: 2288.3729s
Epoch: 11 cost time: 26.326817989349365
Epoch: 11, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.270 Vali Acc: 0.635 Test Loss: 2.270 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0123574
	speed: 0.2828s/iter; left time: 9259.8245s
	iters: 200, epoch: 12 | loss: 0.0069223
	speed: 0.0854s/iter; left time: 2788.9883s
	iters: 300, epoch: 12 | loss: 0.0099989
	speed: 0.0853s/iter; left time: 2774.7132s
Epoch: 12 cost time: 32.14574313163757
Epoch: 12, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.257 Vali Acc: 0.624 Test Loss: 2.257 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0009799
	speed: 0.2980s/iter; left time: 9648.0732s
	iters: 200, epoch: 13 | loss: 0.0403686
	speed: 0.0862s/iter; left time: 2781.3628s
	iters: 300, epoch: 13 | loss: 0.0051565
	speed: 0.0858s/iter; left time: 2759.3248s
Epoch: 13 cost time: 32.409955739974976
Epoch: 13, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.613 Vali Acc: 0.624 Test Loss: 2.613 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6381952326901249
model parameter : 295378
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.3213077
	speed: 0.0501s/iter; left time: 1841.9321s
	iters: 200, epoch: 1 | loss: 0.5020096
	speed: 0.0338s/iter; left time: 1239.0716s
	iters: 300, epoch: 1 | loss: 1.5776390
	speed: 0.0340s/iter; left time: 1244.7546s
Epoch: 1 cost time: 14.229437112808228
Epoch: 1, Steps: 369 | Train Loss: 1.164 Vali Loss: 1.765 Vali Acc: 0.612 Test Loss: 1.765 Test Acc: 0.612
Validation loss decreased (inf --> -0.611503).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5749696
	speed: 0.1431s/iter; left time: 5212.3343s
	iters: 200, epoch: 2 | loss: 0.5148832
	speed: 0.0352s/iter; left time: 1277.2046s
	iters: 300, epoch: 2 | loss: 1.8454435
	speed: 0.0451s/iter; left time: 1632.2684s
Epoch: 2 cost time: 15.199656248092651
Epoch: 2, Steps: 369 | Train Loss: 1.243 Vali Loss: 1.540 Vali Acc: 0.661 Test Loss: 1.540 Test Acc: 0.661
Validation loss decreased (-0.611503 --> -0.661165).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5487588
	speed: 0.1749s/iter; left time: 6308.1928s
	iters: 200, epoch: 3 | loss: 1.8159173
	speed: 0.0452s/iter; left time: 1625.9945s
	iters: 300, epoch: 3 | loss: 0.2268931
	speed: 0.0451s/iter; left time: 1618.6659s
Epoch: 3 cost time: 17.223015308380127
Epoch: 3, Steps: 369 | Train Loss: 1.237 Vali Loss: 2.482 Vali Acc: 0.629 Test Loss: 2.482 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6885675
	speed: 0.1823s/iter; left time: 6507.8299s
	iters: 200, epoch: 4 | loss: 1.7105998
	speed: 0.0445s/iter; left time: 1584.6931s
	iters: 300, epoch: 4 | loss: 2.7162528
	speed: 0.0443s/iter; left time: 1573.0109s
Epoch: 4 cost time: 17.11036777496338
Epoch: 4, Steps: 369 | Train Loss: 1.001 Vali Loss: 2.415 Vali Acc: 0.622 Test Loss: 2.415 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0133001
	speed: 0.1734s/iter; left time: 6123.6857s
	iters: 200, epoch: 5 | loss: 0.3842169
	speed: 0.0458s/iter; left time: 1613.4965s
	iters: 300, epoch: 5 | loss: 0.9578810
	speed: 0.0456s/iter; left time: 1603.3822s
Epoch: 5 cost time: 17.42629075050354
Epoch: 5, Steps: 369 | Train Loss: 0.697 Vali Loss: 1.879 Vali Acc: 0.640 Test Loss: 1.879 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2378229
	speed: 0.1762s/iter; left time: 6158.5690s
	iters: 200, epoch: 6 | loss: 0.5379539
	speed: 0.0454s/iter; left time: 1581.4955s
	iters: 300, epoch: 6 | loss: 0.5287975
	speed: 0.0368s/iter; left time: 1277.5398s
Epoch: 6 cost time: 15.717575550079346
Epoch: 6, Steps: 369 | Train Loss: 0.395 Vali Loss: 1.715 Vali Acc: 0.641 Test Loss: 1.715 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1387995
	speed: 0.1410s/iter; left time: 4876.1405s
	iters: 200, epoch: 7 | loss: 0.0322599
	speed: 0.0335s/iter; left time: 1154.2945s
	iters: 300, epoch: 7 | loss: 0.1697878
	speed: 0.0334s/iter; left time: 1149.5315s
Epoch: 7 cost time: 13.032222270965576
Epoch: 7, Steps: 369 | Train Loss: 0.271 Vali Loss: 1.654 Vali Acc: 0.644 Test Loss: 1.654 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2026388
	speed: 0.1393s/iter; left time: 4768.1797s
	iters: 200, epoch: 8 | loss: 0.0457218
	speed: 0.0337s/iter; left time: 1149.5647s
	iters: 300, epoch: 8 | loss: 0.1110536
	speed: 0.0334s/iter; left time: 1136.7597s
Epoch: 8 cost time: 13.082102060317993
Epoch: 8, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.774 Vali Acc: 0.630 Test Loss: 1.774 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1536313
	speed: 0.1618s/iter; left time: 5475.5927s
	iters: 200, epoch: 9 | loss: 0.1352046
	speed: 0.0437s/iter; left time: 1474.1947s
	iters: 300, epoch: 9 | loss: 0.0573924
	speed: 0.0438s/iter; left time: 1472.8913s
Epoch: 9 cost time: 16.80395245552063
Epoch: 9, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.772 Vali Acc: 0.615 Test Loss: 1.772 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2617212
	speed: 0.1783s/iter; left time: 5968.9045s
	iters: 200, epoch: 10 | loss: 0.0528409
	speed: 0.0446s/iter; left time: 1488.2788s
	iters: 300, epoch: 10 | loss: 0.1882089
	speed: 0.0439s/iter; left time: 1462.2308s
Epoch: 10 cost time: 16.92298197746277
Epoch: 10, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.745 Vali Acc: 0.632 Test Loss: 1.745 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1902894
	speed: 0.1780s/iter; left time: 5892.6719s
	iters: 200, epoch: 11 | loss: 0.0073363
	speed: 0.0447s/iter; left time: 1476.9365s
	iters: 300, epoch: 11 | loss: 0.0148826
	speed: 0.0453s/iter; left time: 1491.2547s
Epoch: 11 cost time: 17.1567165851593
Epoch: 11, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.828 Vali Acc: 0.623 Test Loss: 1.828 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0320365
	speed: 0.1803s/iter; left time: 5904.8020s
	iters: 200, epoch: 12 | loss: 0.0369311
	speed: 0.0457s/iter; left time: 1491.7848s
	iters: 300, epoch: 12 | loss: 0.2977736
	speed: 0.0458s/iter; left time: 1489.8702s
Epoch: 12 cost time: 17.45114278793335
Epoch: 12, Steps: 369 | Train Loss: 0.090 Vali Loss: 2.020 Vali Acc: 0.626 Test Loss: 2.020 Test Acc: 0.626
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6611804767309876
model parameter : 152562
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4656606
	speed: 0.0447s/iter; left time: 1646.0246s
	iters: 200, epoch: 1 | loss: 0.8692039
	speed: 0.0270s/iter; left time: 991.5888s
	iters: 300, epoch: 1 | loss: 0.4646372
	speed: 0.0252s/iter; left time: 921.0300s
Epoch: 1 cost time: 12.042358636856079
Epoch: 1, Steps: 369 | Train Loss: 0.902 Vali Loss: 1.738 Vali Acc: 0.582 Test Loss: 1.738 Test Acc: 0.582
Validation loss decreased (inf --> -0.581992).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3562929
	speed: 0.1515s/iter; left time: 5518.4477s
	iters: 200, epoch: 2 | loss: 0.3675069
	speed: 0.0366s/iter; left time: 1328.3817s
	iters: 300, epoch: 2 | loss: 0.5366802
	speed: 0.0368s/iter; left time: 1334.7027s
Epoch: 2 cost time: 14.09467101097107
Epoch: 2, Steps: 369 | Train Loss: 0.993 Vali Loss: 1.450 Vali Acc: 0.655 Test Loss: 1.450 Test Acc: 0.655
Validation loss decreased (-0.581992 --> -0.654923).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0106124
	speed: 0.1524s/iter; left time: 5496.2980s
	iters: 200, epoch: 3 | loss: 0.8695723
	speed: 0.0366s/iter; left time: 1316.7484s
	iters: 300, epoch: 3 | loss: 1.2349988
	speed: 0.0366s/iter; left time: 1313.4432s
Epoch: 3 cost time: 14.05841851234436
Epoch: 3, Steps: 369 | Train Loss: 0.966 Vali Loss: 1.971 Vali Acc: 0.631 Test Loss: 1.971 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6325725
	speed: 0.1620s/iter; left time: 5780.8353s
	iters: 200, epoch: 4 | loss: 0.5230657
	speed: 0.0369s/iter; left time: 1313.0414s
	iters: 300, epoch: 4 | loss: 0.2620614
	speed: 0.0377s/iter; left time: 1338.5748s
Epoch: 4 cost time: 14.380953550338745
Epoch: 4, Steps: 369 | Train Loss: 0.836 Vali Loss: 2.178 Vali Acc: 0.639 Test Loss: 2.178 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3949903
	speed: 0.1524s/iter; left time: 5382.4632s
	iters: 200, epoch: 5 | loss: 0.4997877
	speed: 0.0374s/iter; left time: 1316.1617s
	iters: 300, epoch: 5 | loss: 1.5263681
	speed: 0.0375s/iter; left time: 1317.3974s
Epoch: 5 cost time: 14.459575176239014
Epoch: 5, Steps: 369 | Train Loss: 0.614 Vali Loss: 1.758 Vali Acc: 0.648 Test Loss: 1.758 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7867973
	speed: 0.1388s/iter; left time: 4851.3425s
	iters: 200, epoch: 6 | loss: 0.6378866
	speed: 0.0285s/iter; left time: 993.9045s
	iters: 300, epoch: 6 | loss: 0.8230994
	speed: 0.0274s/iter; left time: 951.5285s
Epoch: 6 cost time: 11.113657236099243
Epoch: 6, Steps: 369 | Train Loss: 0.461 Vali Loss: 1.615 Vali Acc: 0.640 Test Loss: 1.615 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9572919
	speed: 0.1246s/iter; left time: 4309.9575s
	iters: 200, epoch: 7 | loss: 0.0423767
	speed: 0.0265s/iter; left time: 913.2929s
	iters: 300, epoch: 7 | loss: 0.7124529
	speed: 0.0265s/iter; left time: 910.0745s
Epoch: 7 cost time: 10.264416456222534
Epoch: 7, Steps: 369 | Train Loss: 0.323 Vali Loss: 1.482 Vali Acc: 0.644 Test Loss: 1.482 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0569369
	speed: 0.1230s/iter; left time: 4207.3951s
	iters: 200, epoch: 8 | loss: 0.5095436
	speed: 0.0271s/iter; left time: 924.6077s
	iters: 300, epoch: 8 | loss: 0.2411098
	speed: 0.0265s/iter; left time: 901.3128s
Epoch: 8 cost time: 10.684397220611572
Epoch: 8, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.407 Vali Acc: 0.641 Test Loss: 1.407 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3721403
	speed: 0.1526s/iter; left time: 5166.8353s
	iters: 200, epoch: 9 | loss: 0.1393578
	speed: 0.0362s/iter; left time: 1220.4843s
	iters: 300, epoch: 9 | loss: 0.2792916
	speed: 0.0367s/iter; left time: 1233.5433s
Epoch: 9 cost time: 14.021549940109253
Epoch: 9, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.373 Vali Acc: 0.642 Test Loss: 1.373 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1732710
	speed: 0.1618s/iter; left time: 5416.4954s
	iters: 200, epoch: 10 | loss: 0.3847598
	speed: 0.0359s/iter; left time: 1198.0415s
	iters: 300, epoch: 10 | loss: 0.2505625
	speed: 0.0362s/iter; left time: 1205.2439s
Epoch: 10 cost time: 13.977797031402588
Epoch: 10, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.537 Vali Acc: 0.650 Test Loss: 1.537 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0087100
	speed: 0.1553s/iter; left time: 5140.9951s
	iters: 200, epoch: 11 | loss: 0.0201263
	speed: 0.0369s/iter; left time: 1218.4740s
	iters: 300, epoch: 11 | loss: 0.1618497
	speed: 0.0364s/iter; left time: 1197.0491s
Epoch: 11 cost time: 14.054598331451416
Epoch: 11, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.695 Vali Acc: 0.645 Test Loss: 1.695 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0579419
	speed: 0.1527s/iter; left time: 5000.9757s
	iters: 200, epoch: 12 | loss: 0.0734265
	speed: 0.0365s/iter; left time: 1190.2134s
	iters: 300, epoch: 12 | loss: 0.4049470
	speed: 0.0368s/iter; left time: 1197.2926s
Epoch: 12 cost time: 14.121627807617188
Epoch: 12, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.755 Vali Acc: 0.648 Test Loss: 1.755 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6549375709421112
model parameter : 106498
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8468518
	speed: 0.0404s/iter; left time: 1488.4908s
	iters: 200, epoch: 1 | loss: 1.2343220
	speed: 0.0214s/iter; left time: 783.8227s
	iters: 300, epoch: 1 | loss: 0.7558261
	speed: 0.0312s/iter; left time: 1140.9249s
Epoch: 1 cost time: 11.595296144485474
Epoch: 1, Steps: 369 | Train Loss: 0.883 Vali Loss: 1.112 Vali Acc: 0.638 Test Loss: 1.112 Test Acc: 0.638
Validation loss decreased (inf --> -0.637617).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4759232
	speed: 0.1317s/iter; left time: 4797.5416s
	iters: 200, epoch: 2 | loss: 1.7255886
	speed: 0.0316s/iter; left time: 1146.3549s
	iters: 300, epoch: 2 | loss: 1.4987612
	speed: 0.0315s/iter; left time: 1140.7782s
Epoch: 2 cost time: 12.17885947227478
Epoch: 2, Steps: 369 | Train Loss: 0.869 Vali Loss: 1.507 Vali Acc: 0.633 Test Loss: 1.507 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7137430
	speed: 0.1331s/iter; left time: 4799.7665s
	iters: 200, epoch: 3 | loss: 0.2085751
	speed: 0.0313s/iter; left time: 1125.7219s
	iters: 300, epoch: 3 | loss: 1.6733863
	speed: 0.0314s/iter; left time: 1126.3224s
Epoch: 3 cost time: 12.105640411376953
Epoch: 3, Steps: 369 | Train Loss: 0.807 Vali Loss: 1.834 Vali Acc: 0.631 Test Loss: 1.834 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6203312
	speed: 0.1309s/iter; left time: 4672.6932s
	iters: 200, epoch: 4 | loss: 0.4033621
	speed: 0.0316s/iter; left time: 1123.6074s
	iters: 300, epoch: 4 | loss: 0.7604045
	speed: 0.0318s/iter; left time: 1129.8526s
Epoch: 4 cost time: 12.073341131210327
Epoch: 4, Steps: 369 | Train Loss: 0.710 Vali Loss: 1.749 Vali Acc: 0.640 Test Loss: 1.749 Test Acc: 0.640
Validation loss decreased (-0.637617 --> -0.640448).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2871619
	speed: 0.1291s/iter; left time: 4560.4689s
	iters: 200, epoch: 5 | loss: 0.2446220
	speed: 0.0318s/iter; left time: 1121.5467s
	iters: 300, epoch: 5 | loss: 0.4955962
	speed: 0.0317s/iter; left time: 1113.2794s
Epoch: 5 cost time: 12.289597749710083
Epoch: 5, Steps: 369 | Train Loss: 0.575 Vali Loss: 1.726 Vali Acc: 0.642 Test Loss: 1.726 Test Acc: 0.642
Validation loss decreased (-0.640448 --> -0.642151).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1448720
	speed: 0.1244s/iter; left time: 4349.4849s
	iters: 200, epoch: 6 | loss: 0.0774504
	speed: 0.0221s/iter; left time: 771.2880s
	iters: 300, epoch: 6 | loss: 1.2014635
	speed: 0.0223s/iter; left time: 775.0391s
Epoch: 6 cost time: 8.82181453704834
Epoch: 6, Steps: 369 | Train Loss: 0.425 Vali Loss: 1.303 Vali Acc: 0.649 Test Loss: 1.303 Test Acc: 0.649
Validation loss decreased (-0.642151 --> -0.648965).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4377525
	speed: 0.1023s/iter; left time: 3537.3942s
	iters: 200, epoch: 7 | loss: 0.3472339
	speed: 0.0232s/iter; left time: 800.1091s
	iters: 300, epoch: 7 | loss: 0.7996615
	speed: 0.0235s/iter; left time: 808.2393s
Epoch: 7 cost time: 9.034196615219116
Epoch: 7, Steps: 369 | Train Loss: 0.323 Vali Loss: 1.480 Vali Acc: 0.647 Test Loss: 1.480 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0576556
	speed: 0.1013s/iter; left time: 3465.7452s
	iters: 200, epoch: 8 | loss: 0.6855171
	speed: 0.0223s/iter; left time: 759.5878s
	iters: 300, epoch: 8 | loss: 0.1624091
	speed: 0.0221s/iter; left time: 750.5411s
Epoch: 8 cost time: 8.681508302688599
Epoch: 8, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.482 Vali Acc: 0.633 Test Loss: 1.482 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4633776
	speed: 0.1075s/iter; left time: 3640.1188s
	iters: 200, epoch: 9 | loss: 0.1137664
	speed: 0.0308s/iter; left time: 1039.8337s
	iters: 300, epoch: 9 | loss: 0.3677155
	speed: 0.0309s/iter; left time: 1038.1489s
Epoch: 9 cost time: 11.894588708877563
Epoch: 9, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.453 Vali Acc: 0.642 Test Loss: 1.453 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0845694
	speed: 0.1355s/iter; left time: 4536.0258s
	iters: 200, epoch: 10 | loss: 0.0760293
	speed: 0.0313s/iter; left time: 1046.4218s
	iters: 300, epoch: 10 | loss: 0.2707387
	speed: 0.0314s/iter; left time: 1045.7971s
Epoch: 10 cost time: 12.001368522644043
Epoch: 10, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.487 Vali Acc: 0.625 Test Loss: 1.487 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0289563
	speed: 0.1306s/iter; left time: 4323.2740s
	iters: 200, epoch: 11 | loss: 0.0331808
	speed: 0.0317s/iter; left time: 1046.5635s
	iters: 300, epoch: 11 | loss: 0.1857052
	speed: 0.0320s/iter; left time: 1054.7166s
Epoch: 11 cost time: 12.104236841201782
Epoch: 11, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.598 Vali Acc: 0.640 Test Loss: 1.598 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0150495
	speed: 0.1333s/iter; left time: 4363.7483s
	iters: 200, epoch: 12 | loss: 0.2001408
	speed: 0.0314s/iter; left time: 1024.3888s
	iters: 300, epoch: 12 | loss: 0.1322709
	speed: 0.0316s/iter; left time: 1029.9453s
Epoch: 12 cost time: 12.111822366714478
Epoch: 12, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.829 Vali Acc: 0.636 Test Loss: 1.829 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0300450
	speed: 0.1311s/iter; left time: 4244.2899s
	iters: 200, epoch: 13 | loss: 0.1335504
	speed: 0.0324s/iter; left time: 1045.3136s
	iters: 300, epoch: 13 | loss: 0.1260669
	speed: 0.0319s/iter; left time: 1024.9526s
Epoch: 13 cost time: 12.235508680343628
Epoch: 13, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.786 Vali Acc: 0.648 Test Loss: 1.786 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0358665
	speed: 0.1076s/iter; left time: 3443.0383s
	iters: 200, epoch: 14 | loss: 0.0124285
	speed: 0.0217s/iter; left time: 693.3105s
	iters: 300, epoch: 14 | loss: 0.1458811
	speed: 0.0217s/iter; left time: 691.5521s
Epoch: 14 cost time: 8.577125787734985
Epoch: 14, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.903 Vali Acc: 0.648 Test Loss: 1.903 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0308838
	speed: 0.1046s/iter; left time: 3308.7140s
	iters: 200, epoch: 15 | loss: 0.0112887
	speed: 0.0185s/iter; left time: 584.5882s
	iters: 300, epoch: 15 | loss: 0.3604046
	speed: 0.0215s/iter; left time: 676.2328s
Epoch: 15 cost time: 8.170267343521118
Epoch: 15, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.916 Vali Acc: 0.634 Test Loss: 1.916 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0242765
	speed: 0.1046s/iter; left time: 3270.8273s
	iters: 200, epoch: 16 | loss: 0.0073187
	speed: 0.0209s/iter; left time: 651.5463s
	iters: 300, epoch: 16 | loss: 0.1870900
	speed: 0.0216s/iter; left time: 669.8425s
Epoch: 16 cost time: 8.516223669052124
Epoch: 16, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.041 Vali Acc: 0.645 Test Loss: 2.041 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6489784335981839
model parameter : 78882
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4754356
	speed: 0.0310s/iter; left time: 1139.8969s
	iters: 200, epoch: 1 | loss: 1.1317484
	speed: 0.0141s/iter; left time: 516.5658s
	iters: 300, epoch: 1 | loss: 0.3776383
	speed: 0.0125s/iter; left time: 455.8876s
Epoch: 1 cost time: 6.751618385314941
Epoch: 1, Steps: 369 | Train Loss: 0.798 Vali Loss: 1.084 Vali Acc: 0.642 Test Loss: 1.084 Test Acc: 0.642
Validation loss decreased (inf --> -0.641590).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6189012
	speed: 0.0683s/iter; left time: 2488.5470s
	iters: 200, epoch: 2 | loss: 0.5662842
	speed: 0.0123s/iter; left time: 447.8878s
	iters: 300, epoch: 2 | loss: 0.9951460
	speed: 0.0122s/iter; left time: 441.7039s
Epoch: 2 cost time: 5.109072208404541
Epoch: 2, Steps: 369 | Train Loss: 0.781 Vali Loss: 1.358 Vali Acc: 0.645 Test Loss: 1.358 Test Acc: 0.645
Validation loss decreased (-0.641590 --> -0.644992).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1191800
	speed: 0.1072s/iter; left time: 3866.8206s
	iters: 200, epoch: 3 | loss: 0.8265383
	speed: 0.0289s/iter; left time: 1038.0875s
	iters: 300, epoch: 3 | loss: 0.2494820
	speed: 0.0282s/iter; left time: 1009.8090s
Epoch: 3 cost time: 10.980449199676514
Epoch: 3, Steps: 369 | Train Loss: 0.733 Vali Loss: 1.638 Vali Acc: 0.637 Test Loss: 1.638 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4338701
	speed: 0.1220s/iter; left time: 4356.1329s
	iters: 200, epoch: 4 | loss: 0.4009028
	speed: 0.0282s/iter; left time: 1005.3477s
	iters: 300, epoch: 4 | loss: 0.8904490
	speed: 0.0285s/iter; left time: 1011.7660s
Epoch: 4 cost time: 10.93558382987976
Epoch: 4, Steps: 369 | Train Loss: 0.657 Vali Loss: 1.618 Vali Acc: 0.636 Test Loss: 1.618 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0918883
	speed: 0.1220s/iter; left time: 4308.5876s
	iters: 200, epoch: 5 | loss: 1.0459414
	speed: 0.0279s/iter; left time: 984.3701s
	iters: 300, epoch: 5 | loss: 0.0660337
	speed: 0.0278s/iter; left time: 977.3706s
Epoch: 5 cost time: 10.815605878829956
Epoch: 5, Steps: 369 | Train Loss: 0.537 Vali Loss: 1.543 Vali Acc: 0.654 Test Loss: 1.543 Test Acc: 0.654
Validation loss decreased (-0.644992 --> -0.653503).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5926969
	speed: 0.1273s/iter; left time: 4449.7203s
	iters: 200, epoch: 6 | loss: 0.7061095
	speed: 0.0277s/iter; left time: 965.0125s
	iters: 300, epoch: 6 | loss: 0.0454433
	speed: 0.0278s/iter; left time: 964.5757s
Epoch: 6 cost time: 10.829028129577637
Epoch: 6, Steps: 369 | Train Loss: 0.434 Vali Loss: 1.424 Vali Acc: 0.659 Test Loss: 1.424 Test Acc: 0.659
Validation loss decreased (-0.653503 --> -0.658896).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0974442
	speed: 0.1257s/iter; left time: 4347.6049s
	iters: 200, epoch: 7 | loss: 0.0678512
	speed: 0.0275s/iter; left time: 948.2708s
	iters: 300, epoch: 7 | loss: 0.5712273
	speed: 0.0277s/iter; left time: 953.3357s
Epoch: 7 cost time: 10.727220296859741
Epoch: 7, Steps: 369 | Train Loss: 0.362 Vali Loss: 1.474 Vali Acc: 0.641 Test Loss: 1.474 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1677293
	speed: 0.1003s/iter; left time: 3430.5589s
	iters: 200, epoch: 8 | loss: 0.0988372
	speed: 0.0195s/iter; left time: 665.0187s
	iters: 300, epoch: 8 | loss: 0.1637171
	speed: 0.0199s/iter; left time: 675.4680s
Epoch: 8 cost time: 7.868077039718628
Epoch: 8, Steps: 369 | Train Loss: 0.268 Vali Loss: 1.470 Vali Acc: 0.639 Test Loss: 1.470 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0740740
	speed: 0.0959s/iter; left time: 3245.5778s
	iters: 200, epoch: 9 | loss: 0.2431537
	speed: 0.0201s/iter; left time: 678.3390s
	iters: 300, epoch: 9 | loss: 0.1797026
	speed: 0.0197s/iter; left time: 661.7553s
Epoch: 9 cost time: 7.699987888336182
Epoch: 9, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.358 Vali Acc: 0.650 Test Loss: 1.358 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1507975
	speed: 0.0997s/iter; left time: 3338.6814s
	iters: 200, epoch: 10 | loss: 0.1023800
	speed: 0.0192s/iter; left time: 639.8392s
	iters: 300, epoch: 10 | loss: 0.2503709
	speed: 0.0193s/iter; left time: 641.8277s
Epoch: 10 cost time: 7.670901536941528
Epoch: 10, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.429 Vali Acc: 0.636 Test Loss: 1.429 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0274600
	speed: 0.1188s/iter; left time: 3933.9352s
	iters: 200, epoch: 11 | loss: 0.1764346
	speed: 0.0277s/iter; left time: 913.8965s
	iters: 300, epoch: 11 | loss: 0.2605660
	speed: 0.0277s/iter; left time: 911.0744s
Epoch: 11 cost time: 10.811727523803711
Epoch: 11, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.528 Vali Acc: 0.639 Test Loss: 1.528 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0099659
	speed: 0.1241s/iter; left time: 4062.9003s
	iters: 200, epoch: 12 | loss: 0.1208150
	speed: 0.0279s/iter; left time: 909.4562s
	iters: 300, epoch: 12 | loss: 0.0245314
	speed: 0.0282s/iter; left time: 916.8898s
Epoch: 12 cost time: 10.88381290435791
Epoch: 12, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.536 Vali Acc: 0.638 Test Loss: 1.536 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1564417
	speed: 0.1231s/iter; left time: 3984.3881s
	iters: 200, epoch: 13 | loss: 0.0618932
	speed: 0.0274s/iter; left time: 884.5865s
	iters: 300, epoch: 13 | loss: 0.0590633
	speed: 0.0272s/iter; left time: 875.9831s
Epoch: 13 cost time: 10.573362112045288
Epoch: 13, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.633 Vali Acc: 0.650 Test Loss: 1.633 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0570814
	speed: 0.1284s/iter; left time: 4108.5738s
	iters: 200, epoch: 14 | loss: 0.2334077
	speed: 0.0275s/iter; left time: 877.4383s
	iters: 300, epoch: 14 | loss: 0.0179862
	speed: 0.0274s/iter; left time: 871.4443s
Epoch: 14 cost time: 10.631015539169312
Epoch: 14, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.667 Vali Acc: 0.652 Test Loss: 1.667 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0474608
	speed: 0.1237s/iter; left time: 3912.6356s
	iters: 200, epoch: 15 | loss: 0.0297616
	speed: 0.0274s/iter; left time: 865.3087s
	iters: 300, epoch: 15 | loss: 0.0744782
	speed: 0.0276s/iter; left time: 868.1446s
Epoch: 15 cost time: 10.309348344802856
Epoch: 15, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.719 Vali Acc: 0.648 Test Loss: 1.719 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0145328
	speed: 0.0996s/iter; left time: 3115.5319s
	iters: 200, epoch: 16 | loss: 0.0245761
	speed: 0.0195s/iter; left time: 608.7017s
	iters: 300, epoch: 16 | loss: 0.2028909
	speed: 0.0189s/iter; left time: 586.8441s
Epoch: 16 cost time: 7.720862865447998
Epoch: 16, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.792 Vali Acc: 0.646 Test Loss: 1.792 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6589103291713961
model parameter : 65106
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5849319
	speed: 0.0428s/iter; left time: 1576.3350s
	iters: 200, epoch: 1 | loss: 0.6948761
	speed: 0.0259s/iter; left time: 951.7847s
	iters: 300, epoch: 1 | loss: 1.4112238
	speed: 0.0259s/iter; left time: 949.1175s
Epoch: 1 cost time: 11.403480768203735
Epoch: 1, Steps: 369 | Train Loss: 0.748 Vali Loss: 0.931 Vali Acc: 0.638 Test Loss: 0.931 Test Acc: 0.638
Validation loss decreased (inf --> -0.638470).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8913059
	speed: 0.1079s/iter; left time: 3931.3426s
	iters: 200, epoch: 2 | loss: 0.8989717
	speed: 0.0259s/iter; left time: 941.5351s
	iters: 300, epoch: 2 | loss: 0.8618665
	speed: 0.0260s/iter; left time: 943.6994s
Epoch: 2 cost time: 10.050693035125732
Epoch: 2, Steps: 369 | Train Loss: 0.696 Vali Loss: 1.230 Vali Acc: 0.635 Test Loss: 1.230 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4292981
	speed: 0.1089s/iter; left time: 3929.0293s
	iters: 200, epoch: 3 | loss: 0.4108395
	speed: 0.0261s/iter; left time: 936.9236s
	iters: 300, epoch: 3 | loss: 1.5320835
	speed: 0.0257s/iter; left time: 921.5309s
Epoch: 3 cost time: 10.145090341567993
Epoch: 3, Steps: 369 | Train Loss: 0.700 Vali Loss: 1.306 Vali Acc: 0.650 Test Loss: 1.306 Test Acc: 0.650
Validation loss decreased (-0.638470 --> -0.649533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8920355
	speed: 0.1114s/iter; left time: 3975.6667s
	iters: 200, epoch: 4 | loss: 0.3801582
	speed: 0.0257s/iter; left time: 914.9341s
	iters: 300, epoch: 4 | loss: 0.2988488
	speed: 0.0258s/iter; left time: 914.7201s
Epoch: 4 cost time: 9.908803939819336
Epoch: 4, Steps: 369 | Train Loss: 0.626 Vali Loss: 1.476 Vali Acc: 0.657 Test Loss: 1.476 Test Acc: 0.657
Validation loss decreased (-0.649533 --> -0.656909).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3695419
	speed: 0.1087s/iter; left time: 3841.0578s
	iters: 200, epoch: 5 | loss: 0.8094566
	speed: 0.0256s/iter; left time: 900.5694s
	iters: 300, epoch: 5 | loss: 0.3568689
	speed: 0.0258s/iter; left time: 904.8918s
Epoch: 5 cost time: 9.908340454101562
Epoch: 5, Steps: 369 | Train Loss: 0.525 Vali Loss: 1.466 Vali Acc: 0.642 Test Loss: 1.466 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3298896
	speed: 0.0899s/iter; left time: 3141.1983s
	iters: 200, epoch: 6 | loss: 0.1943569
	speed: 0.0178s/iter; left time: 621.0385s
	iters: 300, epoch: 6 | loss: 0.3244119
	speed: 0.0176s/iter; left time: 611.1503s
Epoch: 6 cost time: 7.081576347351074
Epoch: 6, Steps: 369 | Train Loss: 0.482 Vali Loss: 1.395 Vali Acc: 0.641 Test Loss: 1.395 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4312656
	speed: 0.0877s/iter; left time: 3031.9575s
	iters: 200, epoch: 7 | loss: 0.4006533
	speed: 0.0167s/iter; left time: 574.6391s
	iters: 300, epoch: 7 | loss: 0.4046813
	speed: 0.0177s/iter; left time: 610.2157s
Epoch: 7 cost time: 6.788131237030029
Epoch: 7, Steps: 369 | Train Loss: 0.402 Vali Loss: 1.261 Vali Acc: 0.641 Test Loss: 1.261 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0416169
	speed: 0.0973s/iter; left time: 3327.7878s
	iters: 200, epoch: 8 | loss: 0.3691164
	speed: 0.0175s/iter; left time: 597.1991s
	iters: 300, epoch: 8 | loss: 0.1369834
	speed: 0.0179s/iter; left time: 609.2223s
Epoch: 8 cost time: 7.1216278076171875
Epoch: 8, Steps: 369 | Train Loss: 0.341 Vali Loss: 1.148 Vali Acc: 0.654 Test Loss: 1.148 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0690193
	speed: 0.1017s/iter; left time: 3443.4766s
	iters: 200, epoch: 9 | loss: 0.2338088
	speed: 0.0251s/iter; left time: 847.9081s
	iters: 300, epoch: 9 | loss: 0.1172758
	speed: 0.0262s/iter; left time: 880.1468s
Epoch: 9 cost time: 10.108155727386475
Epoch: 9, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.167 Vali Acc: 0.655 Test Loss: 1.167 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1707879
	speed: 0.1063s/iter; left time: 3558.7614s
	iters: 200, epoch: 10 | loss: 0.2058850
	speed: 0.0262s/iter; left time: 873.0127s
	iters: 300, epoch: 10 | loss: 0.2414939
	speed: 0.0262s/iter; left time: 871.8830s
Epoch: 10 cost time: 10.093120813369751
Epoch: 10, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.207 Vali Acc: 0.652 Test Loss: 1.207 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1307374
	speed: 0.1075s/iter; left time: 3559.9741s
	iters: 200, epoch: 11 | loss: 0.4751208
	speed: 0.0263s/iter; left time: 867.1695s
	iters: 300, epoch: 11 | loss: 0.1845596
	speed: 0.0256s/iter; left time: 843.7510s
Epoch: 11 cost time: 10.077051162719727
Epoch: 11, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.258 Vali Acc: 0.645 Test Loss: 1.258 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0147520
	speed: 0.1134s/iter; left time: 3712.8136s
	iters: 200, epoch: 12 | loss: 0.3463529
	speed: 0.0259s/iter; left time: 846.0884s
	iters: 300, epoch: 12 | loss: 0.1235917
	speed: 0.0257s/iter; left time: 836.6019s
Epoch: 12 cost time: 10.079185247421265
Epoch: 12, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.308 Vali Acc: 0.649 Test Loss: 1.308 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0450227
	speed: 0.1142s/iter; left time: 3696.6783s
	iters: 200, epoch: 13 | loss: 0.2125439
	speed: 0.0251s/iter; left time: 810.4085s
	iters: 300, epoch: 13 | loss: 0.1704460
	speed: 0.0253s/iter; left time: 815.0140s
Epoch: 13 cost time: 9.900740385055542
Epoch: 13, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.367 Vali Acc: 0.641 Test Loss: 1.367 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1224343
	speed: 0.1077s/iter; left time: 3447.0751s
	iters: 200, epoch: 14 | loss: 0.0357716
	speed: 0.0165s/iter; left time: 525.6688s
	iters: 300, epoch: 14 | loss: 0.1523758
	speed: 0.0171s/iter; left time: 543.5285s
Epoch: 14 cost time: 7.574127435684204
Epoch: 14, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.455 Vali Acc: 0.642 Test Loss: 1.455 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6569239500567536
model parameter : 51330
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7534623
	speed: 0.0380s/iter; left time: 1399.6925s
	iters: 200, epoch: 1 | loss: 0.6988834
	speed: 0.0213s/iter; left time: 780.9149s
	iters: 300, epoch: 1 | loss: 0.7730602
	speed: 0.0218s/iter; left time: 796.4562s
Epoch: 1 cost time: 9.757745742797852
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 1.014 Vali Acc: 0.632 Test Loss: 1.014 Test Acc: 0.632
Validation loss decreased (inf --> -0.631658).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4743822
	speed: 0.1004s/iter; left time: 3658.6786s
	iters: 200, epoch: 2 | loss: 1.1172706
	speed: 0.0212s/iter; left time: 771.3353s
	iters: 300, epoch: 2 | loss: 0.9807037
	speed: 0.0215s/iter; left time: 779.5116s
Epoch: 2 cost time: 8.481988906860352
Epoch: 2, Steps: 369 | Train Loss: 0.642 Vali Loss: 1.192 Vali Acc: 0.636 Test Loss: 1.192 Test Acc: 0.636
Validation loss decreased (-0.631658 --> -0.635629).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2934704
	speed: 0.0975s/iter; left time: 3516.2514s
	iters: 200, epoch: 3 | loss: 0.5567181
	speed: 0.0216s/iter; left time: 777.2227s
	iters: 300, epoch: 3 | loss: 0.4736177
	speed: 0.0218s/iter; left time: 781.5312s
Epoch: 3 cost time: 8.479570150375366
Epoch: 3, Steps: 369 | Train Loss: 0.663 Vali Loss: 1.288 Vali Acc: 0.644 Test Loss: 1.288 Test Acc: 0.644
Validation loss decreased (-0.635629 --> -0.644141).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4758674
	speed: 0.0986s/iter; left time: 3520.4257s
	iters: 200, epoch: 4 | loss: 0.4555015
	speed: 0.0223s/iter; left time: 795.3675s
	iters: 300, epoch: 4 | loss: 0.8854953
	speed: 0.0221s/iter; left time: 784.3543s
Epoch: 4 cost time: 8.802369356155396
Epoch: 4, Steps: 369 | Train Loss: 0.583 Vali Loss: 1.386 Vali Acc: 0.633 Test Loss: 1.386 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3863316
	speed: 0.1027s/iter; left time: 3629.4049s
	iters: 200, epoch: 5 | loss: 0.2551098
	speed: 0.0215s/iter; left time: 756.3482s
	iters: 300, epoch: 5 | loss: 0.5402789
	speed: 0.0219s/iter; left time: 770.7249s
Epoch: 5 cost time: 8.543174505233765
Epoch: 5, Steps: 369 | Train Loss: 0.504 Vali Loss: 1.348 Vali Acc: 0.661 Test Loss: 1.348 Test Acc: 0.661
Validation loss decreased (-0.644141 --> -0.661451).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7870194
	speed: 0.1025s/iter; left time: 3582.5969s
	iters: 200, epoch: 6 | loss: 0.5980021
	speed: 0.0210s/iter; left time: 732.8902s
	iters: 300, epoch: 6 | loss: 0.5246726
	speed: 0.0213s/iter; left time: 738.6257s
Epoch: 6 cost time: 8.462496995925903
Epoch: 6, Steps: 369 | Train Loss: 0.469 Vali Loss: 1.281 Vali Acc: 0.653 Test Loss: 1.281 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2166323
	speed: 0.0898s/iter; left time: 3105.5826s
	iters: 200, epoch: 7 | loss: 0.1896946
	speed: 0.0157s/iter; left time: 541.8492s
	iters: 300, epoch: 7 | loss: 0.0624666
	speed: 0.0157s/iter; left time: 540.1879s
Epoch: 7 cost time: 6.320482969284058
Epoch: 7, Steps: 369 | Train Loss: 0.394 Vali Loss: 1.192 Vali Acc: 0.644 Test Loss: 1.192 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6162142
	speed: 0.0849s/iter; left time: 2905.8468s
	iters: 200, epoch: 8 | loss: 0.6204515
	speed: 0.0164s/iter; left time: 558.7791s
	iters: 300, epoch: 8 | loss: 1.6677864
	speed: 0.0128s/iter; left time: 433.7983s
Epoch: 8 cost time: 6.059455871582031
Epoch: 8, Steps: 369 | Train Loss: 0.341 Vali Loss: 1.193 Vali Acc: 0.657 Test Loss: 1.193 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3593526
	speed: 0.0857s/iter; left time: 2902.0022s
	iters: 200, epoch: 9 | loss: 0.1541639
	speed: 0.0152s/iter; left time: 511.7623s
	iters: 300, epoch: 9 | loss: 0.5400621
	speed: 0.0150s/iter; left time: 505.4306s
Epoch: 9 cost time: 6.206235647201538
Epoch: 9, Steps: 369 | Train Loss: 0.307 Vali Loss: 1.166 Vali Acc: 0.652 Test Loss: 1.166 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0737869
	speed: 0.0968s/iter; left time: 3239.5157s
	iters: 200, epoch: 10 | loss: 0.3062265
	speed: 0.0219s/iter; left time: 731.9244s
	iters: 300, epoch: 10 | loss: 0.3889586
	speed: 0.0217s/iter; left time: 720.7978s
Epoch: 10 cost time: 8.660138845443726
Epoch: 10, Steps: 369 | Train Loss: 0.260 Vali Loss: 1.132 Vali Acc: 0.660 Test Loss: 1.132 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1911384
	speed: 0.1048s/iter; left time: 3468.4261s
	iters: 200, epoch: 11 | loss: 0.0214679
	speed: 0.0212s/iter; left time: 699.5816s
	iters: 300, epoch: 11 | loss: 0.1705743
	speed: 0.0224s/iter; left time: 737.4974s
Epoch: 11 cost time: 8.670515775680542
Epoch: 11, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.192 Vali Acc: 0.650 Test Loss: 1.192 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0774887
	speed: 0.0975s/iter; left time: 3193.2993s
	iters: 200, epoch: 12 | loss: 0.5476004
	speed: 0.0225s/iter; left time: 733.2762s
	iters: 300, epoch: 12 | loss: 0.2988887
	speed: 0.0228s/iter; left time: 742.2725s
Epoch: 12 cost time: 8.777888298034668
Epoch: 12, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.277 Vali Acc: 0.654 Test Loss: 1.277 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1139183
	speed: 0.0987s/iter; left time: 3196.1458s
	iters: 200, epoch: 13 | loss: 0.3928361
	speed: 0.0223s/iter; left time: 720.2107s
	iters: 300, epoch: 13 | loss: 0.0890135
	speed: 0.0223s/iter; left time: 718.6215s
Epoch: 13 cost time: 8.781150102615356
Epoch: 13, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.298 Vali Acc: 0.657 Test Loss: 1.298 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1460967
	speed: 0.1037s/iter; left time: 3320.0751s
	iters: 200, epoch: 14 | loss: 0.0511700
	speed: 0.0220s/iter; left time: 703.2068s
	iters: 300, epoch: 14 | loss: 0.1570953
	speed: 0.0221s/iter; left time: 701.3932s
Epoch: 14 cost time: 8.763959169387817
Epoch: 14, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.318 Vali Acc: 0.657 Test Loss: 1.318 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1454123
	speed: 0.1041s/iter; left time: 3293.9209s
	iters: 200, epoch: 15 | loss: 0.2503749
	speed: 0.0222s/iter; left time: 698.9319s
	iters: 300, epoch: 15 | loss: 0.0293475
	speed: 0.0219s/iter; left time: 688.3466s
Epoch: 15 cost time: 8.66494607925415
Epoch: 15, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.438 Vali Acc: 0.642 Test Loss: 1.438 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6614642451759364
model parameter : 42162
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7494277
	speed: 0.0716s/iter; left time: 2635.8110s
	iters: 200, epoch: 1 | loss: 5.4554443
	speed: 0.0566s/iter; left time: 2078.1154s
	iters: 300, epoch: 1 | loss: 1.4000998
	speed: 0.0542s/iter; left time: 1982.2463s
Epoch: 1 cost time: 23.27129054069519
Epoch: 1, Steps: 369 | Train Loss: 1.924 Vali Loss: 2.598 Vali Acc: 0.606 Test Loss: 2.598 Test Acc: 0.606
Validation loss decreased (inf --> -0.605536).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6398480
	speed: 0.2617s/iter; left time: 9535.0442s
	iters: 200, epoch: 2 | loss: 1.2241335
	speed: 0.0722s/iter; left time: 2624.6640s
	iters: 300, epoch: 2 | loss: 1.4588239
	speed: 0.0735s/iter; left time: 2662.8319s
Epoch: 2 cost time: 27.434972286224365
Epoch: 2, Steps: 369 | Train Loss: 1.944 Vali Loss: 3.455 Vali Acc: 0.600 Test Loss: 3.455 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3191998
	speed: 0.2588s/iter; left time: 9333.9458s
	iters: 200, epoch: 3 | loss: 0.7349683
	speed: 0.0736s/iter; left time: 2648.1060s
	iters: 300, epoch: 3 | loss: 1.1402853
	speed: 0.0735s/iter; left time: 2635.8192s
Epoch: 3 cost time: 27.57686138153076
Epoch: 3, Steps: 369 | Train Loss: 1.550 Vali Loss: 3.051 Vali Acc: 0.641 Test Loss: 3.051 Test Acc: 0.641
Validation loss decreased (-0.605536 --> -0.641286).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8884059
	speed: 0.2607s/iter; left time: 9305.1278s
	iters: 200, epoch: 4 | loss: 1.8423797
	speed: 0.0734s/iter; left time: 2613.2354s
	iters: 300, epoch: 4 | loss: 2.1220090
	speed: 0.0733s/iter; left time: 2603.4560s
Epoch: 4 cost time: 26.987909078598022
Epoch: 4, Steps: 369 | Train Loss: 1.175 Vali Loss: 3.065 Vali Acc: 0.639 Test Loss: 3.065 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0004122
	speed: 0.2197s/iter; left time: 7761.7772s
	iters: 200, epoch: 5 | loss: 0.6390597
	speed: 0.0584s/iter; left time: 2056.0747s
	iters: 300, epoch: 5 | loss: 0.9199760
	speed: 0.0563s/iter; left time: 1978.8935s
Epoch: 5 cost time: 22.011338710784912
Epoch: 5, Steps: 369 | Train Loss: 0.780 Vali Loss: 2.603 Vali Acc: 0.628 Test Loss: 2.603 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4504934
	speed: 0.2206s/iter; left time: 7712.8154s
	iters: 200, epoch: 6 | loss: 0.4988011
	speed: 0.0573s/iter; left time: 1996.6098s
	iters: 300, epoch: 6 | loss: 0.3694844
	speed: 0.0718s/iter; left time: 2493.8053s
Epoch: 6 cost time: 24.666777849197388
Epoch: 6, Steps: 369 | Train Loss: 0.425 Vali Loss: 2.715 Vali Acc: 0.644 Test Loss: 2.715 Test Acc: 0.644
Validation loss decreased (-0.641286 --> -0.643843).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0011160
	speed: 0.2618s/iter; left time: 9055.4685s
	iters: 200, epoch: 7 | loss: 0.4121026
	speed: 0.0748s/iter; left time: 2580.7509s
	iters: 300, epoch: 7 | loss: 0.0549625
	speed: 0.0749s/iter; left time: 2575.7828s
Epoch: 7 cost time: 27.969977378845215
Epoch: 7, Steps: 369 | Train Loss: 0.225 Vali Loss: 2.385 Vali Acc: 0.642 Test Loss: 2.385 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2125344
	speed: 0.2638s/iter; left time: 9027.0610s
	iters: 200, epoch: 8 | loss: 0.0403410
	speed: 0.0751s/iter; left time: 2562.6873s
	iters: 300, epoch: 8 | loss: 0.0047978
	speed: 0.0739s/iter; left time: 2513.8235s
Epoch: 8 cost time: 27.82375979423523
Epoch: 8, Steps: 369 | Train Loss: 0.165 Vali Loss: 2.234 Vali Acc: 0.643 Test Loss: 2.234 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0157306
	speed: 0.2621s/iter; left time: 8871.3996s
	iters: 200, epoch: 9 | loss: 0.0042368
	speed: 0.0726s/iter; left time: 2449.2112s
	iters: 300, epoch: 9 | loss: 0.1328937
	speed: 0.0614s/iter; left time: 2064.6655s
Epoch: 9 cost time: 25.2055401802063
Epoch: 9, Steps: 369 | Train Loss: 0.111 Vali Loss: 2.125 Vali Acc: 0.637 Test Loss: 2.125 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0067908
	speed: 0.2164s/iter; left time: 7245.6926s
	iters: 200, epoch: 10 | loss: 0.1109477
	speed: 0.0544s/iter; left time: 1817.4561s
	iters: 300, epoch: 10 | loss: 0.0099151
	speed: 0.0573s/iter; left time: 1905.7985s
Epoch: 10 cost time: 21.39112687110901
Epoch: 10, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.375 Vali Acc: 0.636 Test Loss: 2.375 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0417129
	speed: 0.2161s/iter; left time: 7153.9039s
	iters: 200, epoch: 11 | loss: 0.0015440
	speed: 0.0628s/iter; left time: 2072.4619s
	iters: 300, epoch: 11 | loss: 0.0055401
	speed: 0.0740s/iter; left time: 2435.7478s
Epoch: 11 cost time: 25.094703197479248
Epoch: 11, Steps: 369 | Train Loss: 0.095 Vali Loss: 2.175 Vali Acc: 0.631 Test Loss: 2.175 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0014536
	speed: 0.2621s/iter; left time: 8581.0858s
	iters: 200, epoch: 12 | loss: 0.0005314
	speed: 0.0746s/iter; left time: 2436.3470s
	iters: 300, epoch: 12 | loss: 0.0012328
	speed: 0.0751s/iter; left time: 2443.4291s
Epoch: 12 cost time: 28.075641870498657
Epoch: 12, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.260 Vali Acc: 0.635 Test Loss: 2.260 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000676
	speed: 0.2624s/iter; left time: 8493.1222s
	iters: 200, epoch: 13 | loss: 0.0039513
	speed: 0.0738s/iter; left time: 2382.4464s
	iters: 300, epoch: 13 | loss: 0.0021711
	speed: 0.0736s/iter; left time: 2369.3762s
Epoch: 13 cost time: 27.68975806236267
Epoch: 13, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.294 Vali Acc: 0.625 Test Loss: 2.294 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0007107
	speed: 0.2596s/iter; left time: 8307.2998s
	iters: 200, epoch: 14 | loss: 0.0930020
	speed: 0.0733s/iter; left time: 2340.0397s
	iters: 300, epoch: 14 | loss: 0.0350782
	speed: 0.0560s/iter; left time: 1780.1457s
Epoch: 14 cost time: 24.84695839881897
Epoch: 14, Steps: 369 | Train Loss: 0.040 Vali Loss: 2.530 Vali Acc: 0.628 Test Loss: 2.530 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0104524
	speed: 0.2190s/iter; left time: 6929.1722s
	iters: 200, epoch: 15 | loss: 0.0021338
	speed: 0.0563s/iter; left time: 1774.7858s
	iters: 300, epoch: 15 | loss: 0.0000999
	speed: 0.0584s/iter; left time: 1835.9698s
Epoch: 15 cost time: 21.987009286880493
Epoch: 15, Steps: 369 | Train Loss: 0.034 Vali Loss: 2.585 Vali Acc: 0.627 Test Loss: 2.585 Test Acc: 0.627
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0040927
	speed: 0.2176s/iter; left time: 6802.8988s
	iters: 200, epoch: 16 | loss: 0.0008196
	speed: 0.0750s/iter; left time: 2338.1059s
	iters: 300, epoch: 16 | loss: 0.1906786
	speed: 0.0749s/iter; left time: 2326.3233s
Epoch: 16 cost time: 26.932725429534912
Epoch: 16, Steps: 369 | Train Loss: 0.032 Vali Loss: 2.746 Vali Acc: 0.638 Test Loss: 2.746 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6438706015891033
model parameter : 291154
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9122564
	speed: 0.0551s/iter; left time: 2025.9497s
	iters: 200, epoch: 1 | loss: 1.0939758
	speed: 0.0393s/iter; left time: 1443.3854s
	iters: 300, epoch: 1 | loss: 0.7647888
	speed: 0.0400s/iter; left time: 1465.0111s
Epoch: 1 cost time: 16.272408723831177
Epoch: 1, Steps: 369 | Train Loss: 1.167 Vali Loss: 1.701 Vali Acc: 0.597 Test Loss: 1.701 Test Acc: 0.597
Validation loss decreased (inf --> -0.597316).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0876154
	speed: 0.1700s/iter; left time: 6194.4672s
	iters: 200, epoch: 2 | loss: 2.1428907
	speed: 0.0397s/iter; left time: 1444.1468s
	iters: 300, epoch: 2 | loss: 0.3781216
	speed: 0.0348s/iter; left time: 1259.7429s
Epoch: 2 cost time: 13.897472381591797
Epoch: 2, Steps: 369 | Train Loss: 1.296 Vali Loss: 2.522 Vali Acc: 0.610 Test Loss: 2.522 Test Acc: 0.610
Validation loss decreased (-0.597316 --> -0.610361).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9959683
	speed: 0.1250s/iter; left time: 4509.5281s
	iters: 200, epoch: 3 | loss: 2.0479565
	speed: 0.0298s/iter; left time: 1072.2765s
	iters: 300, epoch: 3 | loss: 0.9757673
	speed: 0.0286s/iter; left time: 1026.4573s
Epoch: 3 cost time: 11.230772495269775
Epoch: 3, Steps: 369 | Train Loss: 1.192 Vali Loss: 2.217 Vali Acc: 0.661 Test Loss: 2.217 Test Acc: 0.661
Validation loss decreased (-0.610361 --> -0.661158).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9670307
	speed: 0.1275s/iter; left time: 4550.5624s
	iters: 200, epoch: 4 | loss: 0.1559751
	speed: 0.0296s/iter; left time: 1053.7863s
	iters: 300, epoch: 4 | loss: 0.1205853
	speed: 0.0290s/iter; left time: 1028.2906s
Epoch: 4 cost time: 11.319291591644287
Epoch: 4, Steps: 369 | Train Loss: 0.943 Vali Loss: 2.587 Vali Acc: 0.636 Test Loss: 2.587 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0343592
	speed: 0.1243s/iter; left time: 4390.2288s
	iters: 200, epoch: 5 | loss: 1.6383265
	speed: 0.0401s/iter; left time: 1411.5453s
	iters: 300, epoch: 5 | loss: 0.8459451
	speed: 0.0405s/iter; left time: 1423.5929s
Epoch: 5 cost time: 14.284566164016724
Epoch: 5, Steps: 369 | Train Loss: 0.737 Vali Loss: 2.150 Vali Acc: 0.631 Test Loss: 2.150 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1651029
	speed: 0.1636s/iter; left time: 5717.8539s
	iters: 200, epoch: 6 | loss: 0.5532601
	speed: 0.0405s/iter; left time: 1410.5633s
	iters: 300, epoch: 6 | loss: 0.5234612
	speed: 0.0403s/iter; left time: 1402.0006s
Epoch: 6 cost time: 15.355592727661133
Epoch: 6, Steps: 369 | Train Loss: 0.498 Vali Loss: 1.750 Vali Acc: 0.636 Test Loss: 1.750 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1568208
	speed: 0.1615s/iter; left time: 5585.5211s
	iters: 200, epoch: 7 | loss: 0.1047367
	speed: 0.0413s/iter; left time: 1423.3400s
	iters: 300, epoch: 7 | loss: 0.1206282
	speed: 0.0396s/iter; left time: 1360.0878s
Epoch: 7 cost time: 15.415720462799072
Epoch: 7, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.518 Vali Acc: 0.635 Test Loss: 1.518 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4826249
	speed: 0.1675s/iter; left time: 5730.7883s
	iters: 200, epoch: 8 | loss: 0.1122981
	speed: 0.0402s/iter; left time: 1370.3196s
	iters: 300, epoch: 8 | loss: 0.3956864
	speed: 0.0403s/iter; left time: 1369.9452s
Epoch: 8 cost time: 15.359115600585938
Epoch: 8, Steps: 369 | Train Loss: 0.214 Vali Loss: 1.565 Vali Acc: 0.656 Test Loss: 1.565 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1025542
	speed: 0.1640s/iter; left time: 5550.2428s
	iters: 200, epoch: 9 | loss: 0.0451595
	speed: 0.0404s/iter; left time: 1362.5548s
	iters: 300, epoch: 9 | loss: 0.3969248
	speed: 0.0406s/iter; left time: 1367.5690s
Epoch: 9 cost time: 14.861708641052246
Epoch: 9, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.529 Vali Acc: 0.646 Test Loss: 1.529 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0773390
	speed: 0.1284s/iter; left time: 4299.0881s
	iters: 200, epoch: 10 | loss: 0.0845964
	speed: 0.0314s/iter; left time: 1048.5847s
	iters: 300, epoch: 10 | loss: 0.2312206
	speed: 0.0312s/iter; left time: 1039.9095s
Epoch: 10 cost time: 11.999336242675781
Epoch: 10, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.573 Vali Acc: 0.634 Test Loss: 1.573 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1756546
	speed: 0.1265s/iter; left time: 4187.7734s
	iters: 200, epoch: 11 | loss: 0.3664027
	speed: 0.0310s/iter; left time: 1022.3432s
	iters: 300, epoch: 11 | loss: 0.0801362
	speed: 0.0311s/iter; left time: 1023.8779s
Epoch: 11 cost time: 11.963152885437012
Epoch: 11, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.764 Vali Acc: 0.641 Test Loss: 1.764 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1490044
	speed: 0.1330s/iter; left time: 4354.4853s
	iters: 200, epoch: 12 | loss: 0.0981687
	speed: 0.0404s/iter; left time: 1317.4465s
	iters: 300, epoch: 12 | loss: 0.0072474
	speed: 0.0407s/iter; left time: 1325.9324s
Epoch: 12 cost time: 14.951939344406128
Epoch: 12, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.035 Vali Acc: 0.644 Test Loss: 2.035 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0468090
	speed: 0.1617s/iter; left time: 5233.4471s
	iters: 200, epoch: 13 | loss: 0.0539353
	speed: 0.0399s/iter; left time: 1288.3123s
	iters: 300, epoch: 13 | loss: 0.0151484
	speed: 0.0396s/iter; left time: 1274.9438s
Epoch: 13 cost time: 15.22534441947937
Epoch: 13, Steps: 369 | Train Loss: 0.091 Vali Loss: 1.955 Vali Acc: 0.639 Test Loss: 1.955 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6611804767309876
model parameter : 148338
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0169284
	speed: 0.0457s/iter; left time: 1681.2518s
	iters: 200, epoch: 1 | loss: 0.9248618
	speed: 0.0215s/iter; left time: 788.7804s
	iters: 300, epoch: 1 | loss: 1.0570947
	speed: 0.0224s/iter; left time: 819.8626s
Epoch: 1 cost time: 10.626455545425415
Epoch: 1, Steps: 369 | Train Loss: 0.953 Vali Loss: 1.489 Vali Acc: 0.619 Test Loss: 1.489 Test Acc: 0.619
Validation loss decreased (inf --> -0.618600).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2444011
	speed: 0.1151s/iter; left time: 4194.6249s
	iters: 200, epoch: 2 | loss: 1.1432173
	speed: 0.0231s/iter; left time: 838.6457s
	iters: 300, epoch: 2 | loss: 0.4979989
	speed: 0.0229s/iter; left time: 830.6298s
Epoch: 2 cost time: 9.180075883865356
Epoch: 2, Steps: 369 | Train Loss: 1.027 Vali Loss: 1.718 Vali Acc: 0.638 Test Loss: 1.718 Test Acc: 0.638
Validation loss decreased (-0.618600 --> -0.637611).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5223002
	speed: 0.1109s/iter; left time: 3998.2644s
	iters: 200, epoch: 3 | loss: 0.9272339
	speed: 0.0240s/iter; left time: 862.8731s
	iters: 300, epoch: 3 | loss: 1.3662944
	speed: 0.0232s/iter; left time: 832.7990s
Epoch: 3 cost time: 9.370018720626831
Epoch: 3, Steps: 369 | Train Loss: 0.942 Vali Loss: 2.129 Vali Acc: 0.632 Test Loss: 2.129 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2020097
	speed: 0.1101s/iter; left time: 3930.9009s
	iters: 200, epoch: 4 | loss: 0.4785787
	speed: 0.0341s/iter; left time: 1215.1008s
	iters: 300, epoch: 4 | loss: 0.8732930
	speed: 0.0341s/iter; left time: 1210.1026s
Epoch: 4 cost time: 12.094241619110107
Epoch: 4, Steps: 369 | Train Loss: 0.777 Vali Loss: 2.150 Vali Acc: 0.644 Test Loss: 2.150 Test Acc: 0.644
Validation loss decreased (-0.637611 --> -0.644133).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5230678
	speed: 0.1472s/iter; left time: 5199.4735s
	iters: 200, epoch: 5 | loss: 0.1071769
	speed: 0.0347s/iter; left time: 1221.6002s
	iters: 300, epoch: 5 | loss: 0.3635109
	speed: 0.0344s/iter; left time: 1209.2175s
Epoch: 5 cost time: 13.226433515548706
Epoch: 5, Steps: 369 | Train Loss: 0.574 Vali Loss: 1.977 Vali Acc: 0.639 Test Loss: 1.977 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3460389
	speed: 0.1398s/iter; left time: 4887.0331s
	iters: 200, epoch: 6 | loss: 0.0102402
	speed: 0.0349s/iter; left time: 1215.7593s
	iters: 300, epoch: 6 | loss: 0.4368830
	speed: 0.0347s/iter; left time: 1206.6014s
Epoch: 6 cost time: 13.363070249557495
Epoch: 6, Steps: 369 | Train Loss: 0.431 Vali Loss: 1.885 Vali Acc: 0.647 Test Loss: 1.885 Test Acc: 0.647
Validation loss decreased (-0.644133 --> -0.646973).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6302514
	speed: 0.1478s/iter; left time: 5111.4142s
	iters: 200, epoch: 7 | loss: 0.1022737
	speed: 0.0340s/iter; left time: 1173.1998s
	iters: 300, epoch: 7 | loss: 0.7334657
	speed: 0.0340s/iter; left time: 1167.7126s
Epoch: 7 cost time: 13.248064041137695
Epoch: 7, Steps: 369 | Train Loss: 0.316 Vali Loss: 1.582 Vali Acc: 0.650 Test Loss: 1.582 Test Acc: 0.650
Validation loss decreased (-0.646973 --> -0.650098).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0314049
	speed: 0.1418s/iter; left time: 4853.6872s
	iters: 200, epoch: 8 | loss: 0.2963530
	speed: 0.0345s/iter; left time: 1178.5964s
	iters: 300, epoch: 8 | loss: 0.0903268
	speed: 0.0343s/iter; left time: 1165.4191s
Epoch: 8 cost time: 13.156938552856445
Epoch: 8, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.481 Vali Acc: 0.649 Test Loss: 1.481 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3628243
	speed: 0.1237s/iter; left time: 4186.6124s
	iters: 200, epoch: 9 | loss: 0.1916360
	speed: 0.0238s/iter; left time: 802.7089s
	iters: 300, epoch: 9 | loss: 0.0715484
	speed: 0.0234s/iter; left time: 786.4203s
Epoch: 9 cost time: 9.133482217788696
Epoch: 9, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.525 Vali Acc: 0.654 Test Loss: 1.525 Test Acc: 0.654
Validation loss decreased (-0.650098 --> -0.654355).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0270116
	speed: 0.1095s/iter; left time: 3666.4159s
	iters: 200, epoch: 10 | loss: 0.0159620
	speed: 0.0226s/iter; left time: 755.2253s
	iters: 300, epoch: 10 | loss: 0.5255266
	speed: 0.0240s/iter; left time: 798.4017s
Epoch: 10 cost time: 9.185773134231567
Epoch: 10, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.563 Vali Acc: 0.644 Test Loss: 1.563 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1437957
	speed: 0.1128s/iter; left time: 3734.0516s
	iters: 200, epoch: 11 | loss: 0.0599690
	speed: 0.0237s/iter; left time: 783.8272s
	iters: 300, epoch: 11 | loss: 0.0307539
	speed: 0.0230s/iter; left time: 757.0521s
Epoch: 11 cost time: 9.351571321487427
Epoch: 11, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.656 Vali Acc: 0.647 Test Loss: 1.656 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0838550
	speed: 0.1306s/iter; left time: 4274.6951s
	iters: 200, epoch: 12 | loss: 0.3507273
	speed: 0.0346s/iter; left time: 1129.0442s
	iters: 300, epoch: 12 | loss: 0.0297651
	speed: 0.0344s/iter; left time: 1119.9333s
Epoch: 12 cost time: 13.326650142669678
Epoch: 12, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.806 Vali Acc: 0.638 Test Loss: 1.806 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0100602
	speed: 0.1413s/iter; left time: 4574.9879s
	iters: 200, epoch: 13 | loss: 0.0558384
	speed: 0.0348s/iter; left time: 1122.3120s
	iters: 300, epoch: 13 | loss: 0.0344344
	speed: 0.0344s/iter; left time: 1106.4921s
Epoch: 13 cost time: 13.275623559951782
Epoch: 13, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.870 Vali Acc: 0.634 Test Loss: 1.870 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0036663
	speed: 0.1491s/iter; left time: 4773.2521s
	iters: 200, epoch: 14 | loss: 0.2039020
	speed: 0.0339s/iter; left time: 1081.0194s
	iters: 300, epoch: 14 | loss: 0.5068073
	speed: 0.0338s/iter; left time: 1074.9592s
Epoch: 14 cost time: 13.113907098770142
Epoch: 14, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.082 Vali Acc: 0.641 Test Loss: 2.082 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0314040
	speed: 0.1414s/iter; left time: 4473.8316s
	iters: 200, epoch: 15 | loss: 0.0099000
	speed: 0.0342s/iter; left time: 1076.9810s
	iters: 300, epoch: 15 | loss: 0.0347437
	speed: 0.0339s/iter; left time: 1065.8731s
Epoch: 15 cost time: 13.059263706207275
Epoch: 15, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.112 Vali Acc: 0.640 Test Loss: 2.112 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0330235
	speed: 0.1460s/iter; left time: 4564.6727s
	iters: 200, epoch: 16 | loss: 0.0013379
	speed: 0.0267s/iter; left time: 830.6683s
	iters: 300, epoch: 16 | loss: 0.0112686
	speed: 0.0223s/iter; left time: 693.1894s
Epoch: 16 cost time: 10.345823049545288
Epoch: 16, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.161 Vali Acc: 0.638 Test Loss: 2.161 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0116505
	speed: 0.1126s/iter; left time: 3478.8212s
	iters: 200, epoch: 17 | loss: 0.2255451
	speed: 0.0232s/iter; left time: 715.7264s
	iters: 300, epoch: 17 | loss: 0.1000497
	speed: 0.0225s/iter; left time: 692.0553s
Epoch: 17 cost time: 9.067430973052979
Epoch: 17, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.145 Vali Acc: 0.633 Test Loss: 2.145 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0252430
	speed: 0.1081s/iter; left time: 3301.5387s
	iters: 200, epoch: 18 | loss: 0.0052512
	speed: 0.0231s/iter; left time: 701.5828s
	iters: 300, epoch: 18 | loss: 0.0029238
	speed: 0.0229s/iter; left time: 693.1232s
Epoch: 18 cost time: 8.931318998336792
Epoch: 18, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.264 Vali Acc: 0.642 Test Loss: 2.264 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.2752151
	speed: 0.1136s/iter; left time: 3426.9166s
	iters: 200, epoch: 19 | loss: 0.0005668
	speed: 0.0225s/iter; left time: 675.7175s
	iters: 300, epoch: 19 | loss: 0.0165282
	speed: 0.0269s/iter; left time: 806.0271s
Epoch: 19 cost time: 10.12043833732605
Epoch: 19, Steps: 369 | Train Loss: 0.051 Vali Loss: 2.289 Vali Acc: 0.634 Test Loss: 2.289 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6543700340522134
model parameter : 102274
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0683997
	speed: 0.0449s/iter; left time: 1653.0273s
	iters: 200, epoch: 1 | loss: 0.8051780
	speed: 0.0293s/iter; left time: 1075.4182s
	iters: 300, epoch: 1 | loss: 0.4624686
	speed: 0.0297s/iter; left time: 1088.5675s
Epoch: 1 cost time: 12.545214414596558
Epoch: 1, Steps: 369 | Train Loss: 0.840 Vali Loss: 1.100 Vali Acc: 0.644 Test Loss: 1.100 Test Acc: 0.644
Validation loss decreased (inf --> -0.644427).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0388117
	speed: 0.1293s/iter; left time: 4709.3492s
	iters: 200, epoch: 2 | loss: 0.5810094
	speed: 0.0288s/iter; left time: 1045.0225s
	iters: 300, epoch: 2 | loss: 1.4636048
	speed: 0.0290s/iter; left time: 1052.1649s
Epoch: 2 cost time: 11.158984422683716
Epoch: 2, Steps: 369 | Train Loss: 0.900 Vali Loss: 1.821 Vali Acc: 0.625 Test Loss: 1.821 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5065054
	speed: 0.1238s/iter; left time: 4463.0709s
	iters: 200, epoch: 3 | loss: 0.4519871
	speed: 0.0297s/iter; left time: 1069.7534s
	iters: 300, epoch: 3 | loss: 0.4412239
	speed: 0.0297s/iter; left time: 1063.5910s
Epoch: 3 cost time: 11.308443069458008
Epoch: 3, Steps: 369 | Train Loss: 0.810 Vali Loss: 1.653 Vali Acc: 0.635 Test Loss: 1.653 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6227998
	speed: 0.1160s/iter; left time: 4140.1629s
	iters: 200, epoch: 4 | loss: 0.8119807
	speed: 0.0190s/iter; left time: 676.9189s
	iters: 300, epoch: 4 | loss: 1.7952354
	speed: 0.0187s/iter; left time: 662.4221s
Epoch: 4 cost time: 7.719311237335205
Epoch: 4, Steps: 369 | Train Loss: 0.674 Vali Loss: 1.754 Vali Acc: 0.650 Test Loss: 1.754 Test Acc: 0.650
Validation loss decreased (-0.644427 --> -0.649812).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0526725
	speed: 0.0989s/iter; left time: 3493.9880s
	iters: 200, epoch: 5 | loss: 0.2785368
	speed: 0.0195s/iter; left time: 687.3147s
	iters: 300, epoch: 5 | loss: 0.5157061
	speed: 0.0167s/iter; left time: 585.2640s
Epoch: 5 cost time: 7.564854145050049
Epoch: 5, Steps: 369 | Train Loss: 0.575 Vali Loss: 1.599 Vali Acc: 0.650 Test Loss: 1.599 Test Acc: 0.650
Validation loss decreased (-0.649812 --> -0.650098).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5646379
	speed: 0.1001s/iter; left time: 3500.6441s
	iters: 200, epoch: 6 | loss: 0.1484694
	speed: 0.0200s/iter; left time: 695.6546s
	iters: 300, epoch: 6 | loss: 0.5481859
	speed: 0.0202s/iter; left time: 703.7326s
Epoch: 6 cost time: 7.991595268249512
Epoch: 6, Steps: 369 | Train Loss: 0.417 Vali Loss: 1.518 Vali Acc: 0.642 Test Loss: 1.518 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4560364
	speed: 0.1155s/iter; left time: 3993.6901s
	iters: 200, epoch: 7 | loss: 0.0694360
	speed: 0.0298s/iter; left time: 1026.0006s
	iters: 300, epoch: 7 | loss: 0.5169252
	speed: 0.0293s/iter; left time: 1008.3972s
Epoch: 7 cost time: 11.433954238891602
Epoch: 7, Steps: 369 | Train Loss: 0.317 Vali Loss: 1.472 Vali Acc: 0.629 Test Loss: 1.472 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2708219
	speed: 0.1262s/iter; left time: 4319.9983s
	iters: 200, epoch: 8 | loss: 0.0223128
	speed: 0.0289s/iter; left time: 985.1504s
	iters: 300, epoch: 8 | loss: 0.6859198
	speed: 0.0298s/iter; left time: 1013.8034s
Epoch: 8 cost time: 11.278030395507812
Epoch: 8, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.325 Vali Acc: 0.649 Test Loss: 1.325 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0379726
	speed: 0.1253s/iter; left time: 4240.9857s
	iters: 200, epoch: 9 | loss: 0.0321603
	speed: 0.0300s/iter; left time: 1013.6242s
	iters: 300, epoch: 9 | loss: 0.2283908
	speed: 0.0300s/iter; left time: 1010.6177s
Epoch: 9 cost time: 11.545463562011719
Epoch: 9, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.371 Vali Acc: 0.631 Test Loss: 1.371 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1699410
	speed: 0.1306s/iter; left time: 4372.7172s
	iters: 200, epoch: 10 | loss: 0.2144047
	speed: 0.0290s/iter; left time: 969.0191s
	iters: 300, epoch: 10 | loss: 0.0285557
	speed: 0.0290s/iter; left time: 965.9845s
Epoch: 10 cost time: 11.356651782989502
Epoch: 10, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.412 Vali Acc: 0.652 Test Loss: 1.412 Test Acc: 0.652
Validation loss decreased (-0.650098 --> -0.652370).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1598574
	speed: 0.1256s/iter; left time: 4157.9369s
	iters: 200, epoch: 11 | loss: 0.1146485
	speed: 0.0292s/iter; left time: 962.6816s
	iters: 300, epoch: 11 | loss: 0.1268397
	speed: 0.0294s/iter; left time: 967.7243s
Epoch: 11 cost time: 11.292178869247437
Epoch: 11, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.546 Vali Acc: 0.653 Test Loss: 1.546 Test Acc: 0.653
Validation loss decreased (-0.652370 --> -0.652652).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0170049
	speed: 0.1103s/iter; left time: 3610.1000s
	iters: 200, epoch: 12 | loss: 0.1675672
	speed: 0.0186s/iter; left time: 605.9358s
	iters: 300, epoch: 12 | loss: 0.2054628
	speed: 0.0185s/iter; left time: 602.9330s
Epoch: 12 cost time: 7.442495107650757
Epoch: 12, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.608 Vali Acc: 0.643 Test Loss: 1.608 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0255159
	speed: 0.1048s/iter; left time: 3392.5740s
	iters: 200, epoch: 13 | loss: 0.2119931
	speed: 0.0193s/iter; left time: 623.4796s
	iters: 300, epoch: 13 | loss: 0.0688784
	speed: 0.0162s/iter; left time: 522.1622s
Epoch: 13 cost time: 7.443281412124634
Epoch: 13, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.667 Vali Acc: 0.644 Test Loss: 1.667 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1131304
	speed: 0.0982s/iter; left time: 3143.8178s
	iters: 200, epoch: 14 | loss: 0.0152915
	speed: 0.0194s/iter; left time: 619.3290s
	iters: 300, epoch: 14 | loss: 0.1531199
	speed: 0.0189s/iter; left time: 601.9234s
Epoch: 14 cost time: 7.499756336212158
Epoch: 14, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.740 Vali Acc: 0.651 Test Loss: 1.740 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0335408
	speed: 0.1055s/iter; left time: 3338.8459s
	iters: 200, epoch: 15 | loss: 0.1009166
	speed: 0.0298s/iter; left time: 938.2145s
	iters: 300, epoch: 15 | loss: 0.0154746
	speed: 0.0282s/iter; left time: 886.8898s
Epoch: 15 cost time: 11.19298267364502
Epoch: 15, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.813 Vali Acc: 0.648 Test Loss: 1.813 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1230601
	speed: 0.1262s/iter; left time: 3945.6846s
	iters: 200, epoch: 16 | loss: 0.0369887
	speed: 0.0291s/iter; left time: 905.8878s
	iters: 300, epoch: 16 | loss: 0.0115375
	speed: 0.0290s/iter; left time: 902.3941s
Epoch: 16 cost time: 11.275970220565796
Epoch: 16, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.831 Vali Acc: 0.651 Test Loss: 1.831 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0112923
	speed: 0.1290s/iter; left time: 3984.8464s
	iters: 200, epoch: 17 | loss: 0.0125971
	speed: 0.0292s/iter; left time: 900.1309s
	iters: 300, epoch: 17 | loss: 0.0027834
	speed: 0.0290s/iter; left time: 889.9926s
Epoch: 17 cost time: 11.227751731872559
Epoch: 17, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.891 Vali Acc: 0.658 Test Loss: 1.891 Test Acc: 0.658
Validation loss decreased (-0.652652 --> -0.657756).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0184529
	speed: 0.1266s/iter; left time: 3866.3245s
	iters: 200, epoch: 18 | loss: 0.0214037
	speed: 0.0281s/iter; left time: 855.0882s
	iters: 300, epoch: 18 | loss: 0.0458113
	speed: 0.0279s/iter; left time: 846.2118s
Epoch: 18 cost time: 10.889951229095459
Epoch: 18, Steps: 369 | Train Loss: 0.064 Vali Loss: 1.999 Vali Acc: 0.649 Test Loss: 1.999 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1311723
	speed: 0.1251s/iter; left time: 3773.8093s
	iters: 200, epoch: 19 | loss: 0.0085745
	speed: 0.0302s/iter; left time: 906.8198s
	iters: 300, epoch: 19 | loss: 0.0545193
	speed: 0.0302s/iter; left time: 903.6387s
Epoch: 19 cost time: 11.548170804977417
Epoch: 19, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.016 Vali Acc: 0.648 Test Loss: 2.016 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0013541
	speed: 0.1083s/iter; left time: 3227.2623s
	iters: 200, epoch: 20 | loss: 0.0776659
	speed: 0.0201s/iter; left time: 596.2032s
	iters: 300, epoch: 20 | loss: 0.1269565
	speed: 0.0204s/iter; left time: 604.9919s
Epoch: 20 cost time: 8.039273262023926
Epoch: 20, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.126 Vali Acc: 0.650 Test Loss: 2.126 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0056588
	speed: 0.0983s/iter; left time: 2891.5399s
	iters: 200, epoch: 21 | loss: 0.0344200
	speed: 0.0176s/iter; left time: 517.1290s
	iters: 300, epoch: 21 | loss: 0.0410523
	speed: 0.0209s/iter; left time: 611.5624s
Epoch: 21 cost time: 7.87682032585144
Epoch: 21, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.210 Vali Acc: 0.640 Test Loss: 2.210 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0783432
	speed: 0.0994s/iter; left time: 2889.0581s
	iters: 200, epoch: 22 | loss: 0.0269691
	speed: 0.0191s/iter; left time: 553.0062s
	iters: 300, epoch: 22 | loss: 0.0080020
	speed: 0.0191s/iter; left time: 549.7684s
Epoch: 22 cost time: 7.69835352897644
Epoch: 22, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.180 Vali Acc: 0.646 Test Loss: 2.180 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2634217
	speed: 0.0961s/iter; left time: 2756.8789s
	iters: 200, epoch: 23 | loss: 0.0614597
	speed: 0.0236s/iter; left time: 673.3945s
	iters: 300, epoch: 23 | loss: 0.0352154
	speed: 0.0240s/iter; left time: 682.7412s
Epoch: 23 cost time: 9.312552452087402
Epoch: 23, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.274 Vali Acc: 0.655 Test Loss: 2.274 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0456139
	speed: 0.0908s/iter; left time: 2571.7218s
	iters: 200, epoch: 24 | loss: 0.0078881
	speed: 0.0126s/iter; left time: 354.3909s
	iters: 300, epoch: 24 | loss: 0.0078253
	speed: 0.0126s/iter; left time: 354.6734s
Epoch: 24 cost time: 5.16937255859375
Epoch: 24, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.400 Vali Acc: 0.642 Test Loss: 2.400 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0015512
	speed: 0.0635s/iter; left time: 1773.3499s
	iters: 200, epoch: 25 | loss: 0.0102521
	speed: 0.0123s/iter; left time: 341.6572s
	iters: 300, epoch: 25 | loss: 0.0613707
	speed: 0.0124s/iter; left time: 344.4620s
Epoch: 25 cost time: 5.075369358062744
Epoch: 25, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.287 Vali Acc: 0.642 Test Loss: 2.287 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0019657
	speed: 0.0646s/iter; left time: 1780.0492s
	iters: 200, epoch: 26 | loss: 0.0016212
	speed: 0.0131s/iter; left time: 359.0081s
	iters: 300, epoch: 26 | loss: 0.0844506
	speed: 0.0311s/iter; left time: 852.0842s
Epoch: 26 cost time: 8.578468799591064
Epoch: 26, Steps: 369 | Train Loss: 0.044 Vali Loss: 2.349 Vali Acc: 0.649 Test Loss: 2.349 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1156340
	speed: 0.1478s/iter; left time: 4021.4772s
	iters: 200, epoch: 27 | loss: 0.0162283
	speed: 0.0361s/iter; left time: 978.4344s
	iters: 300, epoch: 27 | loss: 0.0095460
	speed: 0.0363s/iter; left time: 980.5335s
Epoch: 27 cost time: 13.745757102966309
Epoch: 27, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.378 Vali Acc: 0.642 Test Loss: 2.378 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 74658
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4681998
	speed: 0.0484s/iter; left time: 1781.0396s
	iters: 200, epoch: 1 | loss: 1.0333949
	speed: 0.0324s/iter; left time: 1187.6044s
	iters: 300, epoch: 1 | loss: 1.0067184
	speed: 0.0328s/iter; left time: 1201.0736s
Epoch: 1 cost time: 13.78686785697937
Epoch: 1, Steps: 369 | Train Loss: 0.771 Vali Loss: 1.741 Vali Acc: 0.567 Test Loss: 1.741 Test Acc: 0.567
Validation loss decreased (inf --> -0.566952).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5720501
	speed: 0.1367s/iter; left time: 4981.6038s
	iters: 200, epoch: 2 | loss: 0.5245828
	speed: 0.0328s/iter; left time: 1190.9075s
	iters: 300, epoch: 2 | loss: 1.0560493
	speed: 0.0305s/iter; left time: 1105.2551s
Epoch: 2 cost time: 12.202649593353271
Epoch: 2, Steps: 369 | Train Loss: 0.803 Vali Loss: 1.603 Vali Acc: 0.626 Test Loss: 1.603 Test Acc: 0.626
Validation loss decreased (-0.566952 --> -0.625693).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7983156
	speed: 0.1424s/iter; left time: 5136.0506s
	iters: 200, epoch: 3 | loss: 1.5246043
	speed: 0.0331s/iter; left time: 1190.5753s
	iters: 300, epoch: 3 | loss: 0.8178858
	speed: 0.0320s/iter; left time: 1146.0912s
Epoch: 3 cost time: 12.503398180007935
Epoch: 3, Steps: 369 | Train Loss: 0.741 Vali Loss: 1.892 Vali Acc: 0.616 Test Loss: 1.892 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4334403
	speed: 0.1397s/iter; left time: 4985.8318s
	iters: 200, epoch: 4 | loss: 1.0814414
	speed: 0.0337s/iter; left time: 1198.7347s
	iters: 300, epoch: 4 | loss: 0.7688732
	speed: 0.0330s/iter; left time: 1170.7982s
Epoch: 4 cost time: 12.416387557983398
Epoch: 4, Steps: 369 | Train Loss: 0.656 Vali Loss: 1.572 Vali Acc: 0.636 Test Loss: 1.572 Test Acc: 0.636
Validation loss decreased (-0.625693 --> -0.635909).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5832540
	speed: 0.1389s/iter; left time: 4904.9862s
	iters: 200, epoch: 5 | loss: 0.0532725
	speed: 0.0320s/iter; left time: 1127.4302s
	iters: 300, epoch: 5 | loss: 0.1120930
	speed: 0.0313s/iter; left time: 1098.2492s
Epoch: 5 cost time: 12.180258750915527
Epoch: 5, Steps: 369 | Train Loss: 0.526 Vali Loss: 1.516 Vali Acc: 0.654 Test Loss: 1.516 Test Acc: 0.654
Validation loss decreased (-0.635909 --> -0.653787).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3511132
	speed: 0.1450s/iter; left time: 5069.1822s
	iters: 200, epoch: 6 | loss: 0.3570048
	speed: 0.0324s/iter; left time: 1130.6326s
	iters: 300, epoch: 6 | loss: 0.5707063
	speed: 0.0325s/iter; left time: 1130.3321s
Epoch: 6 cost time: 12.546483278274536
Epoch: 6, Steps: 369 | Train Loss: 0.457 Vali Loss: 1.502 Vali Acc: 0.654 Test Loss: 1.502 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3845879
	speed: 0.1396s/iter; left time: 4829.3920s
	iters: 200, epoch: 7 | loss: 0.2509844
	speed: 0.0316s/iter; left time: 1089.1235s
	iters: 300, epoch: 7 | loss: 0.4732459
	speed: 0.0322s/iter; left time: 1108.5615s
Epoch: 7 cost time: 12.512135982513428
Epoch: 7, Steps: 369 | Train Loss: 0.348 Vali Loss: 1.431 Vali Acc: 0.651 Test Loss: 1.431 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5417567
	speed: 0.1431s/iter; left time: 4895.5245s
	iters: 200, epoch: 8 | loss: 0.6841246
	speed: 0.0322s/iter; left time: 1098.6664s
	iters: 300, epoch: 8 | loss: 0.0384835
	speed: 0.0324s/iter; left time: 1101.5013s
Epoch: 8 cost time: 12.41483998298645
Epoch: 8, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.269 Vali Acc: 0.650 Test Loss: 1.269 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3258240
	speed: 0.1369s/iter; left time: 4635.5970s
	iters: 200, epoch: 9 | loss: 0.1635017
	speed: 0.0342s/iter; left time: 1154.3257s
	iters: 300, epoch: 9 | loss: 0.6507320
	speed: 0.0324s/iter; left time: 1089.0798s
Epoch: 9 cost time: 12.809365510940552
Epoch: 9, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.293 Vali Acc: 0.643 Test Loss: 1.293 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1836416
	speed: 0.1426s/iter; left time: 4773.4963s
	iters: 200, epoch: 10 | loss: 0.0492996
	speed: 0.0330s/iter; left time: 1102.1623s
	iters: 300, epoch: 10 | loss: 0.5621373
	speed: 0.0320s/iter; left time: 1066.1589s
Epoch: 10 cost time: 12.56162691116333
Epoch: 10, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.347 Vali Acc: 0.652 Test Loss: 1.347 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4937157
	speed: 0.1376s/iter; left time: 4555.6794s
	iters: 200, epoch: 11 | loss: 0.0875669
	speed: 0.0323s/iter; left time: 1066.4757s
	iters: 300, epoch: 11 | loss: 0.0682583
	speed: 0.0326s/iter; left time: 1072.9562s
Epoch: 11 cost time: 12.572783470153809
Epoch: 11, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.463 Vali Acc: 0.648 Test Loss: 1.463 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1808480
	speed: 0.1384s/iter; left time: 4532.8775s
	iters: 200, epoch: 12 | loss: 0.1082730
	speed: 0.0235s/iter; left time: 768.4941s
	iters: 300, epoch: 12 | loss: 0.0495850
	speed: 0.0285s/iter; left time: 927.6218s
Epoch: 12 cost time: 11.063211917877197
Epoch: 12, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.447 Vali Acc: 0.645 Test Loss: 1.447 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1919124
	speed: 0.1367s/iter; left time: 4423.7833s
	iters: 200, epoch: 13 | loss: 0.0089000
	speed: 0.0314s/iter; left time: 1013.6889s
	iters: 300, epoch: 13 | loss: 0.0689808
	speed: 0.0303s/iter; left time: 976.0069s
Epoch: 13 cost time: 12.030308961868286
Epoch: 13, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.571 Vali Acc: 0.658 Test Loss: 1.571 Test Acc: 0.658
Validation loss decreased (-0.653787 --> -0.657760).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4158386
	speed: 0.1323s/iter; left time: 4235.5296s
	iters: 200, epoch: 14 | loss: 0.4449966
	speed: 0.0298s/iter; left time: 949.3766s
	iters: 300, epoch: 14 | loss: 0.3348106
	speed: 0.0282s/iter; left time: 896.3707s
Epoch: 14 cost time: 11.433619499206543
Epoch: 14, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.638 Vali Acc: 0.657 Test Loss: 1.638 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3559916
	speed: 0.1327s/iter; left time: 4199.5154s
	iters: 200, epoch: 15 | loss: 0.0585745
	speed: 0.0270s/iter; left time: 852.4310s
	iters: 300, epoch: 15 | loss: 0.0914212
	speed: 0.0281s/iter; left time: 884.2249s
Epoch: 15 cost time: 11.073088645935059
Epoch: 15, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.641 Vali Acc: 0.645 Test Loss: 1.641 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0558453
	speed: 0.1320s/iter; left time: 4125.5939s
	iters: 200, epoch: 16 | loss: 0.1175068
	speed: 0.0318s/iter; left time: 989.9389s
	iters: 300, epoch: 16 | loss: 0.1228519
	speed: 0.0297s/iter; left time: 922.5773s
Epoch: 16 cost time: 11.632317066192627
Epoch: 16, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.719 Vali Acc: 0.646 Test Loss: 1.719 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3075590
	speed: 0.1338s/iter; left time: 4135.5517s
	iters: 200, epoch: 17 | loss: 0.0218551
	speed: 0.0280s/iter; left time: 861.6279s
	iters: 300, epoch: 17 | loss: 0.1140876
	speed: 0.0298s/iter; left time: 913.9545s
Epoch: 17 cost time: 11.264885902404785
Epoch: 17, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.808 Vali Acc: 0.643 Test Loss: 1.808 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2099914
	speed: 0.1292s/iter; left time: 3944.4660s
	iters: 200, epoch: 18 | loss: 0.1880567
	speed: 0.0289s/iter; left time: 880.8072s
	iters: 300, epoch: 18 | loss: 0.0480859
	speed: 0.0292s/iter; left time: 885.5748s
Epoch: 18 cost time: 11.32958459854126
Epoch: 18, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.836 Vali Acc: 0.650 Test Loss: 1.836 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0970523
	speed: 0.1358s/iter; left time: 4096.8750s
	iters: 200, epoch: 19 | loss: 0.3465191
	speed: 0.0275s/iter; left time: 826.7397s
	iters: 300, epoch: 19 | loss: 0.1554011
	speed: 0.0278s/iter; left time: 833.6941s
Epoch: 19 cost time: 10.948057651519775
Epoch: 19, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.877 Vali Acc: 0.650 Test Loss: 1.877 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0275848
	speed: 0.1398s/iter; left time: 4163.9570s
	iters: 200, epoch: 20 | loss: 0.0054311
	speed: 0.0286s/iter; left time: 849.1668s
	iters: 300, epoch: 20 | loss: 0.0569681
	speed: 0.0296s/iter; left time: 877.0482s
Epoch: 20 cost time: 11.23033332824707
Epoch: 20, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.075 Vali Acc: 0.636 Test Loss: 2.075 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0578198
	speed: 0.1282s/iter; left time: 3772.3290s
	iters: 200, epoch: 21 | loss: 0.0142304
	speed: 0.0285s/iter; left time: 834.7672s
	iters: 300, epoch: 21 | loss: 0.0043116
	speed: 0.0301s/iter; left time: 878.6366s
Epoch: 21 cost time: 11.18623661994934
Epoch: 21, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.101 Vali Acc: 0.647 Test Loss: 2.101 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0121587
	speed: 0.1330s/iter; left time: 3863.4793s
	iters: 200, epoch: 22 | loss: 0.0160070
	speed: 0.0263s/iter; left time: 761.3791s
	iters: 300, epoch: 22 | loss: 0.0177175
	speed: 0.0272s/iter; left time: 783.8759s
Epoch: 22 cost time: 10.602037906646729
Epoch: 22, Steps: 369 | Train Loss: 0.076 Vali Loss: 2.106 Vali Acc: 0.642 Test Loss: 2.106 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0161832
	speed: 0.1327s/iter; left time: 3807.3247s
	iters: 200, epoch: 23 | loss: 0.0310088
	speed: 0.0215s/iter; left time: 613.9083s
	iters: 300, epoch: 23 | loss: 0.0145921
	speed: 0.0276s/iter; left time: 786.7354s
Epoch: 23 cost time: 10.375778436660767
Epoch: 23, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.110 Vali Acc: 0.642 Test Loss: 2.110 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 60882
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5407080
	speed: 0.0428s/iter; left time: 1574.7566s
	iters: 200, epoch: 1 | loss: 0.9557984
	speed: 0.0272s/iter; left time: 997.5666s
	iters: 300, epoch: 1 | loss: 0.9142132
	speed: 0.0283s/iter; left time: 1037.0373s
Epoch: 1 cost time: 11.906079769134521
Epoch: 1, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.972 Vali Acc: 0.645 Test Loss: 0.972 Test Acc: 0.645
Validation loss decreased (inf --> -0.644996).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3928754
	speed: 0.1194s/iter; left time: 4350.5239s
	iters: 200, epoch: 2 | loss: 0.6043586
	speed: 0.0274s/iter; left time: 997.1673s
	iters: 300, epoch: 2 | loss: 0.3055866
	speed: 0.0281s/iter; left time: 1018.0729s
Epoch: 2 cost time: 10.977179765701294
Epoch: 2, Steps: 369 | Train Loss: 0.695 Vali Loss: 1.266 Vali Acc: 0.636 Test Loss: 1.266 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5994089
	speed: 0.1224s/iter; left time: 4415.0648s
	iters: 200, epoch: 3 | loss: 0.5904217
	speed: 0.0281s/iter; left time: 1011.2335s
	iters: 300, epoch: 3 | loss: 0.4596336
	speed: 0.0278s/iter; left time: 997.6384s
Epoch: 3 cost time: 10.83080244064331
Epoch: 3, Steps: 369 | Train Loss: 0.660 Vali Loss: 1.619 Vali Acc: 0.627 Test Loss: 1.619 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2041324
	speed: 0.1207s/iter; left time: 4307.3227s
	iters: 200, epoch: 4 | loss: 0.6609657
	speed: 0.0285s/iter; left time: 1014.0736s
	iters: 300, epoch: 4 | loss: 0.4338537
	speed: 0.0255s/iter; left time: 906.2061s
Epoch: 4 cost time: 10.749788999557495
Epoch: 4, Steps: 369 | Train Loss: 0.636 Vali Loss: 1.326 Vali Acc: 0.643 Test Loss: 1.326 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3386352
	speed: 0.1185s/iter; left time: 4186.3515s
	iters: 200, epoch: 5 | loss: 0.4892280
	speed: 0.0274s/iter; left time: 966.5895s
	iters: 300, epoch: 5 | loss: 0.7223660
	speed: 0.0280s/iter; left time: 981.8593s
Epoch: 5 cost time: 10.850819826126099
Epoch: 5, Steps: 369 | Train Loss: 0.545 Vali Loss: 1.405 Vali Acc: 0.651 Test Loss: 1.405 Test Acc: 0.651
Validation loss decreased (-0.644996 --> -0.651235).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5425820
	speed: 0.1167s/iter; left time: 4079.6778s
	iters: 200, epoch: 6 | loss: 0.1358042
	speed: 0.0281s/iter; left time: 979.5394s
	iters: 300, epoch: 6 | loss: 0.2631324
	speed: 0.0276s/iter; left time: 958.5847s
Epoch: 6 cost time: 10.805597066879272
Epoch: 6, Steps: 369 | Train Loss: 0.468 Vali Loss: 1.458 Vali Acc: 0.640 Test Loss: 1.458 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2427806
	speed: 0.1208s/iter; left time: 4177.9470s
	iters: 200, epoch: 7 | loss: 0.0730754
	speed: 0.0280s/iter; left time: 964.9831s
	iters: 300, epoch: 7 | loss: 0.4541164
	speed: 0.0276s/iter; left time: 948.2897s
Epoch: 7 cost time: 10.820732116699219
Epoch: 7, Steps: 369 | Train Loss: 0.397 Vali Loss: 1.293 Vali Acc: 0.653 Test Loss: 1.293 Test Acc: 0.653
Validation loss decreased (-0.651235 --> -0.653222).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4159313
	speed: 0.1159s/iter; left time: 3965.4270s
	iters: 200, epoch: 8 | loss: 0.4649484
	speed: 0.0280s/iter; left time: 954.5751s
	iters: 300, epoch: 8 | loss: 0.1447910
	speed: 0.0278s/iter; left time: 946.0401s
Epoch: 8 cost time: 10.816185235977173
Epoch: 8, Steps: 369 | Train Loss: 0.319 Vali Loss: 1.262 Vali Acc: 0.645 Test Loss: 1.262 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2261351
	speed: 0.1170s/iter; left time: 3961.3993s
	iters: 200, epoch: 9 | loss: 0.6225922
	speed: 0.0281s/iter; left time: 948.2246s
	iters: 300, epoch: 9 | loss: 0.2762719
	speed: 0.0269s/iter; left time: 905.9486s
Epoch: 9 cost time: 10.75352931022644
Epoch: 9, Steps: 369 | Train Loss: 0.268 Vali Loss: 1.170 Vali Acc: 0.661 Test Loss: 1.170 Test Acc: 0.661
Validation loss decreased (-0.653222 --> -0.660601).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2479011
	speed: 0.1216s/iter; left time: 4070.9817s
	iters: 200, epoch: 10 | loss: 0.4710371
	speed: 0.0279s/iter; left time: 932.9154s
	iters: 300, epoch: 10 | loss: 0.0883939
	speed: 0.0283s/iter; left time: 943.4308s
Epoch: 10 cost time: 10.901942253112793
Epoch: 10, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.266 Vali Acc: 0.646 Test Loss: 1.266 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1578028
	speed: 0.1187s/iter; left time: 3930.1381s
	iters: 200, epoch: 11 | loss: 0.1845459
	speed: 0.0275s/iter; left time: 906.2253s
	iters: 300, epoch: 11 | loss: 0.0942578
	speed: 0.0280s/iter; left time: 920.5378s
Epoch: 11 cost time: 10.858318090438843
Epoch: 11, Steps: 369 | Train Loss: 0.214 Vali Loss: 1.267 Vali Acc: 0.651 Test Loss: 1.267 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3381081
	speed: 0.1266s/iter; left time: 4145.8471s
	iters: 200, epoch: 12 | loss: 0.2468531
	speed: 0.0274s/iter; left time: 893.0198s
	iters: 300, epoch: 12 | loss: 0.0246005
	speed: 0.0286s/iter; left time: 930.4880s
Epoch: 12 cost time: 10.968544483184814
Epoch: 12, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.335 Vali Acc: 0.652 Test Loss: 1.335 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3191354
	speed: 0.1176s/iter; left time: 3807.0453s
	iters: 200, epoch: 13 | loss: 0.3910225
	speed: 0.0273s/iter; left time: 880.1504s
	iters: 300, epoch: 13 | loss: 0.0823824
	speed: 0.0275s/iter; left time: 885.5413s
Epoch: 13 cost time: 10.607805967330933
Epoch: 13, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.359 Vali Acc: 0.647 Test Loss: 1.359 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1556094
	speed: 0.1175s/iter; left time: 3761.8764s
	iters: 200, epoch: 14 | loss: 0.0673738
	speed: 0.0277s/iter; left time: 883.5700s
	iters: 300, epoch: 14 | loss: 0.4551603
	speed: 0.0172s/iter; left time: 546.6830s
Epoch: 14 cost time: 9.391497373580933
Epoch: 14, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.404 Vali Acc: 0.643 Test Loss: 1.404 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0731516
	speed: 0.1190s/iter; left time: 3764.7301s
	iters: 200, epoch: 15 | loss: 0.3661482
	speed: 0.0239s/iter; left time: 752.9196s
	iters: 300, epoch: 15 | loss: 0.2382829
	speed: 0.0242s/iter; left time: 760.8397s
Epoch: 15 cost time: 9.639727115631104
Epoch: 15, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.484 Vali Acc: 0.650 Test Loss: 1.484 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1475932
	speed: 0.1127s/iter; left time: 3524.1990s
	iters: 200, epoch: 16 | loss: 0.3145989
	speed: 0.0238s/iter; left time: 742.4134s
	iters: 300, epoch: 16 | loss: 0.1083057
	speed: 0.0285s/iter; left time: 885.1803s
Epoch: 16 cost time: 9.96259093284607
Epoch: 16, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.529 Vali Acc: 0.651 Test Loss: 1.529 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0230651
	speed: 0.1154s/iter; left time: 3565.2957s
	iters: 200, epoch: 17 | loss: 0.3287334
	speed: 0.0247s/iter; left time: 759.9076s
	iters: 300, epoch: 17 | loss: 0.1341837
	speed: 0.0240s/iter; left time: 737.2221s
Epoch: 17 cost time: 9.52086067199707
Epoch: 17, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.605 Vali Acc: 0.642 Test Loss: 1.605 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1334908
	speed: 0.1186s/iter; left time: 3619.5217s
	iters: 200, epoch: 18 | loss: 0.2903041
	speed: 0.0244s/iter; left time: 741.2351s
	iters: 300, epoch: 18 | loss: 0.0062115
	speed: 0.0250s/iter; left time: 758.4965s
Epoch: 18 cost time: 9.80632495880127
Epoch: 18, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.686 Vali Acc: 0.641 Test Loss: 1.686 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0637566
	speed: 0.1175s/iter; left time: 3542.4378s
	iters: 200, epoch: 19 | loss: 0.1267534
	speed: 0.0263s/iter; left time: 790.8231s
	iters: 300, epoch: 19 | loss: 0.1470005
	speed: 0.0265s/iter; left time: 795.3346s
Epoch: 19 cost time: 10.46052360534668
Epoch: 19, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.689 Vali Acc: 0.636 Test Loss: 1.689 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6606129398410897
model parameter : 47106
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5593547
	speed: 0.0395s/iter; left time: 1455.2805s
	iters: 200, epoch: 1 | loss: 0.5698169
	speed: 0.0217s/iter; left time: 795.3067s
	iters: 300, epoch: 1 | loss: 0.8442082
	speed: 0.0218s/iter; left time: 798.7623s
Epoch: 1 cost time: 9.98871111869812
Epoch: 1, Steps: 369 | Train Loss: 0.680 Vali Loss: 0.859 Vali Acc: 0.652 Test Loss: 0.859 Test Acc: 0.652
Validation loss decreased (inf --> -0.652375).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5228709
	speed: 0.1099s/iter; left time: 4003.3056s
	iters: 200, epoch: 2 | loss: 0.2298594
	speed: 0.0231s/iter; left time: 837.5457s
	iters: 300, epoch: 2 | loss: 0.9188881
	speed: 0.0231s/iter; left time: 837.6774s
Epoch: 2 cost time: 9.187068462371826
Epoch: 2, Steps: 369 | Train Loss: 0.663 Vali Loss: 1.066 Vali Acc: 0.648 Test Loss: 1.066 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5894639
	speed: 0.1152s/iter; left time: 4153.0699s
	iters: 200, epoch: 3 | loss: 0.9608474
	speed: 0.0233s/iter; left time: 837.6572s
	iters: 300, epoch: 3 | loss: 0.5572862
	speed: 0.0234s/iter; left time: 838.4500s
Epoch: 3 cost time: 9.2382173538208
Epoch: 3, Steps: 369 | Train Loss: 0.619 Vali Loss: 1.210 Vali Acc: 0.653 Test Loss: 1.210 Test Acc: 0.653
Validation loss decreased (-0.652375 --> -0.652939).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5382934
	speed: 0.1084s/iter; left time: 3870.0264s
	iters: 200, epoch: 4 | loss: 0.4475166
	speed: 0.0226s/iter; left time: 805.5231s
	iters: 300, epoch: 4 | loss: 0.3250110
	speed: 0.0223s/iter; left time: 791.0036s
Epoch: 4 cost time: 9.028552293777466
Epoch: 4, Steps: 369 | Train Loss: 0.582 Vali Loss: 1.262 Vali Acc: 0.665 Test Loss: 1.262 Test Acc: 0.665
Validation loss decreased (-0.652939 --> -0.665424).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3465760
	speed: 0.1125s/iter; left time: 3974.0200s
	iters: 200, epoch: 5 | loss: 0.1757257
	speed: 0.0230s/iter; left time: 808.7529s
	iters: 300, epoch: 5 | loss: 0.9621353
	speed: 0.0231s/iter; left time: 811.2861s
Epoch: 5 cost time: 9.197675228118896
Epoch: 5, Steps: 369 | Train Loss: 0.519 Vali Loss: 1.374 Vali Acc: 0.643 Test Loss: 1.374 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2672914
	speed: 0.1114s/iter; left time: 3893.5626s
	iters: 200, epoch: 6 | loss: 0.4285538
	speed: 0.0244s/iter; left time: 850.9939s
	iters: 300, epoch: 6 | loss: 0.2472625
	speed: 0.0244s/iter; left time: 848.8376s
Epoch: 6 cost time: 8.9825918674469
Epoch: 6, Steps: 369 | Train Loss: 0.453 Vali Loss: 1.278 Vali Acc: 0.661 Test Loss: 1.278 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0241831
	speed: 0.1119s/iter; left time: 3870.2851s
	iters: 200, epoch: 7 | loss: 0.2338346
	speed: 0.0246s/iter; left time: 847.1487s
	iters: 300, epoch: 7 | loss: 0.3148680
	speed: 0.0244s/iter; left time: 838.5102s
Epoch: 7 cost time: 9.71742844581604
Epoch: 7, Steps: 369 | Train Loss: 0.399 Vali Loss: 1.363 Vali Acc: 0.652 Test Loss: 1.363 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3872784
	speed: 0.1206s/iter; left time: 4125.1381s
	iters: 200, epoch: 8 | loss: 0.4442661
	speed: 0.0249s/iter; left time: 850.9586s
	iters: 300, epoch: 8 | loss: 0.4801733
	speed: 0.0245s/iter; left time: 831.8711s
Epoch: 8 cost time: 9.87393832206726
Epoch: 8, Steps: 369 | Train Loss: 0.353 Vali Loss: 1.303 Vali Acc: 0.651 Test Loss: 1.303 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3053825
	speed: 0.1183s/iter; left time: 4002.6492s
	iters: 200, epoch: 9 | loss: 0.4124489
	speed: 0.0247s/iter; left time: 834.2365s
	iters: 300, epoch: 9 | loss: 0.6311258
	speed: 0.0247s/iter; left time: 830.3779s
Epoch: 9 cost time: 9.853901863098145
Epoch: 9, Steps: 369 | Train Loss: 0.305 Vali Loss: 1.162 Vali Acc: 0.664 Test Loss: 1.162 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1201738
	speed: 0.1151s/iter; left time: 3852.4313s
	iters: 200, epoch: 10 | loss: 0.6668106
	speed: 0.0247s/iter; left time: 823.4591s
	iters: 300, epoch: 10 | loss: 0.3084984
	speed: 0.0248s/iter; left time: 825.5156s
Epoch: 10 cost time: 9.871076583862305
Epoch: 10, Steps: 369 | Train Loss: 0.276 Vali Loss: 1.229 Vali Acc: 0.656 Test Loss: 1.229 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0706883
	speed: 0.1201s/iter; left time: 3976.8247s
	iters: 200, epoch: 11 | loss: 0.2100424
	speed: 0.0245s/iter; left time: 809.2751s
	iters: 300, epoch: 11 | loss: 0.1256867
	speed: 0.0252s/iter; left time: 830.6290s
Epoch: 11 cost time: 9.822239875793457
Epoch: 11, Steps: 369 | Train Loss: 0.240 Vali Loss: 1.182 Vali Acc: 0.659 Test Loss: 1.182 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2439635
	speed: 0.1144s/iter; left time: 3745.2629s
	iters: 200, epoch: 12 | loss: 0.1940791
	speed: 0.0240s/iter; left time: 784.1700s
	iters: 300, epoch: 12 | loss: 0.0501186
	speed: 0.0242s/iter; left time: 787.2643s
Epoch: 12 cost time: 9.553839445114136
Epoch: 12, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.240 Vali Acc: 0.656 Test Loss: 1.240 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.2385990
	speed: 0.1126s/iter; left time: 3644.8961s
	iters: 200, epoch: 13 | loss: 0.4276546
	speed: 0.0245s/iter; left time: 791.5605s
	iters: 300, epoch: 13 | loss: 0.7105129
	speed: 0.0242s/iter; left time: 778.5418s
Epoch: 13 cost time: 9.630495309829712
Epoch: 13, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.287 Vali Acc: 0.661 Test Loss: 1.287 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1733335
	speed: 0.1204s/iter; left time: 3853.4163s
	iters: 200, epoch: 14 | loss: 0.0929161
	speed: 0.0240s/iter; left time: 765.9028s
	iters: 300, epoch: 14 | loss: 0.1605542
	speed: 0.0242s/iter; left time: 768.7815s
Epoch: 14 cost time: 9.563907861709595
Epoch: 14, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.320 Vali Acc: 0.659 Test Loss: 1.320 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 37938
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.9076328
	speed: 0.1011s/iter; left time: 3720.7300s
	iters: 200, epoch: 1 | loss: 1.0921063
	speed: 0.0836s/iter; left time: 3068.2304s
	iters: 300, epoch: 1 | loss: 2.5081074
	speed: 0.0825s/iter; left time: 3018.5023s
Epoch: 1 cost time: 32.5264675617218
Epoch: 1, Steps: 369 | Train Loss: 1.744 Vali Loss: 4.526 Vali Acc: 0.557 Test Loss: 4.526 Test Acc: 0.557
Validation loss decreased (inf --> -0.556708).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9584919
	speed: 0.3006s/iter; left time: 10951.4421s
	iters: 200, epoch: 2 | loss: 6.8701439
	speed: 0.0855s/iter; left time: 3107.0523s
	iters: 300, epoch: 2 | loss: 1.9312072
	speed: 0.0861s/iter; left time: 3119.6666s
Epoch: 2 cost time: 32.139830350875854
Epoch: 2, Steps: 369 | Train Loss: 1.905 Vali Loss: 2.124 Vali Acc: 0.641 Test Loss: 2.124 Test Acc: 0.641
Validation loss decreased (-0.556708 --> -0.641012).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8433213
	speed: 0.3040s/iter; left time: 10963.0324s
	iters: 200, epoch: 3 | loss: 2.0965919
	speed: 0.0848s/iter; left time: 3050.8210s
	iters: 300, epoch: 3 | loss: 2.7393038
	speed: 0.0735s/iter; left time: 2634.1640s
Epoch: 3 cost time: 30.316986799240112
Epoch: 3, Steps: 369 | Train Loss: 1.650 Vali Loss: 2.924 Vali Acc: 0.638 Test Loss: 2.924 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4882946
	speed: 0.2890s/iter; left time: 10314.4850s
	iters: 200, epoch: 4 | loss: 0.7398855
	speed: 0.0823s/iter; left time: 2928.9560s
	iters: 300, epoch: 4 | loss: 0.6381472
	speed: 0.0805s/iter; left time: 2857.5258s
Epoch: 4 cost time: 30.46943235397339
Epoch: 4, Steps: 369 | Train Loss: 1.257 Vali Loss: 3.274 Vali Acc: 0.624 Test Loss: 3.274 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4241691
	speed: 0.2889s/iter; left time: 10205.0264s
	iters: 200, epoch: 5 | loss: 0.8740975
	speed: 0.0800s/iter; left time: 2816.6192s
	iters: 300, epoch: 5 | loss: 0.1241871
	speed: 0.0792s/iter; left time: 2781.3386s
Epoch: 5 cost time: 30.047203540802002
Epoch: 5, Steps: 369 | Train Loss: 0.842 Vali Loss: 2.879 Vali Acc: 0.627 Test Loss: 2.879 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0007225
	speed: 0.2885s/iter; left time: 10084.4445s
	iters: 200, epoch: 6 | loss: 0.6944720
	speed: 0.0720s/iter; left time: 2508.8874s
	iters: 300, epoch: 6 | loss: 1.2053707
	speed: 0.0800s/iter; left time: 2779.7181s
Epoch: 6 cost time: 29.455730199813843
Epoch: 6, Steps: 369 | Train Loss: 0.460 Vali Loss: 2.161 Vali Acc: 0.638 Test Loss: 2.161 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0098239
	speed: 0.2890s/iter; left time: 9994.7246s
	iters: 200, epoch: 7 | loss: 0.1415901
	speed: 0.0795s/iter; left time: 2742.6317s
	iters: 300, epoch: 7 | loss: 0.3101470
	speed: 0.0799s/iter; left time: 2748.4549s
Epoch: 7 cost time: 29.832216501235962
Epoch: 7, Steps: 369 | Train Loss: 0.248 Vali Loss: 2.542 Vali Acc: 0.625 Test Loss: 2.542 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1698826
	speed: 0.2910s/iter; left time: 9957.1416s
	iters: 200, epoch: 8 | loss: 0.0106554
	speed: 0.0806s/iter; left time: 2748.7638s
	iters: 300, epoch: 8 | loss: 0.0050783
	speed: 0.0810s/iter; left time: 2753.7582s
Epoch: 8 cost time: 30.064005613327026
Epoch: 8, Steps: 369 | Train Loss: 0.156 Vali Loss: 2.351 Vali Acc: 0.649 Test Loss: 2.351 Test Acc: 0.649
Validation loss decreased (-0.641012 --> -0.648671).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0348886
	speed: 0.2804s/iter; left time: 9492.4599s
	iters: 200, epoch: 9 | loss: 0.1190052
	speed: 0.0807s/iter; left time: 2724.4237s
	iters: 300, epoch: 9 | loss: 0.0774456
	speed: 0.0847s/iter; left time: 2850.2204s
Epoch: 9 cost time: 30.268797874450684
Epoch: 9, Steps: 369 | Train Loss: 0.138 Vali Loss: 2.456 Vali Acc: 0.635 Test Loss: 2.456 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0475609
	speed: 0.2969s/iter; left time: 9941.0462s
	iters: 200, epoch: 10 | loss: 0.0055605
	speed: 0.0849s/iter; left time: 2832.8473s
	iters: 300, epoch: 10 | loss: 0.1610811
	speed: 0.0851s/iter; left time: 2832.5659s
Epoch: 10 cost time: 31.848803281784058
Epoch: 10, Steps: 369 | Train Loss: 0.115 Vali Loss: 2.204 Vali Acc: 0.632 Test Loss: 2.204 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0648116
	speed: 0.2993s/iter; left time: 9909.0920s
	iters: 200, epoch: 11 | loss: 0.1168458
	speed: 0.0861s/iter; left time: 2841.0802s
	iters: 300, epoch: 11 | loss: 0.0004782
	speed: 0.0854s/iter; left time: 2811.6693s
Epoch: 11 cost time: 32.24889922142029
Epoch: 11, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.228 Vali Acc: 0.645 Test Loss: 2.228 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0024094
	speed: 0.2985s/iter; left time: 9772.0093s
	iters: 200, epoch: 12 | loss: 0.1730344
	speed: 0.0830s/iter; left time: 2710.7351s
	iters: 300, epoch: 12 | loss: 0.1921374
	speed: 0.0832s/iter; left time: 2708.4967s
Epoch: 12 cost time: 31.35514521598816
Epoch: 12, Steps: 369 | Train Loss: 0.085 Vali Loss: 2.342 Vali Acc: 0.628 Test Loss: 2.342 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0140662
	speed: 0.2968s/iter; left time: 9609.9116s
	iters: 200, epoch: 13 | loss: 0.3164724
	speed: 0.0833s/iter; left time: 2688.7009s
	iters: 300, epoch: 13 | loss: 0.1213327
	speed: 0.0827s/iter; left time: 2661.7602s
Epoch: 13 cost time: 31.427666425704956
Epoch: 13, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.281 Vali Acc: 0.629 Test Loss: 2.281 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0229245
	speed: 0.2939s/iter; left time: 9405.1594s
	iters: 200, epoch: 14 | loss: 0.0024188
	speed: 0.0826s/iter; left time: 2635.4169s
	iters: 300, epoch: 14 | loss: 0.0742809
	speed: 0.0824s/iter; left time: 2620.8992s
Epoch: 14 cost time: 31.172914266586304
Epoch: 14, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.270 Vali Acc: 0.634 Test Loss: 2.270 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0005742
	speed: 0.2991s/iter; left time: 9462.2925s
	iters: 200, epoch: 15 | loss: 0.0040699
	speed: 0.0853s/iter; left time: 2688.6589s
	iters: 300, epoch: 15 | loss: 0.0217925
	speed: 0.0856s/iter; left time: 2690.7720s
Epoch: 15 cost time: 32.1048629283905
Epoch: 15, Steps: 369 | Train Loss: 0.038 Vali Loss: 2.407 Vali Acc: 0.632 Test Loss: 2.407 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0007778
	speed: 0.2963s/iter; left time: 9263.1837s
	iters: 200, epoch: 16 | loss: 0.0503650
	speed: 0.0851s/iter; left time: 2652.0736s
	iters: 300, epoch: 16 | loss: 0.0023647
	speed: 0.0845s/iter; left time: 2626.3128s
Epoch: 16 cost time: 31.93447732925415
Epoch: 16, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.533 Vali Acc: 0.629 Test Loss: 2.533 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0016810
	speed: 0.2836s/iter; left time: 8761.7968s
	iters: 200, epoch: 17 | loss: 0.0020423
	speed: 0.0787s/iter; left time: 2423.9384s
	iters: 300, epoch: 17 | loss: 0.0056887
	speed: 0.0795s/iter; left time: 2440.4985s
Epoch: 17 cost time: 29.724536657333374
Epoch: 17, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.578 Vali Acc: 0.644 Test Loss: 2.578 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0001004
	speed: 0.2827s/iter; left time: 8629.5480s
	iters: 200, epoch: 18 | loss: 0.2250121
	speed: 0.0790s/iter; left time: 2404.1258s
	iters: 300, epoch: 18 | loss: 0.0661867
	speed: 0.0779s/iter; left time: 2362.9307s
Epoch: 18 cost time: 29.170334339141846
Epoch: 18, Steps: 369 | Train Loss: 0.037 Vali Loss: 2.466 Vali Acc: 0.631 Test Loss: 2.466 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6486946651532349
model parameter : 289042
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5066147
	speed: 0.0627s/iter; left time: 2309.1587s
	iters: 200, epoch: 1 | loss: 1.1090956
	speed: 0.0472s/iter; left time: 1732.5493s
	iters: 300, epoch: 1 | loss: 1.4471387
	speed: 0.0465s/iter; left time: 1700.6908s
Epoch: 1 cost time: 18.744538068771362
Epoch: 1, Steps: 369 | Train Loss: 1.102 Vali Loss: 1.756 Vali Acc: 0.599 Test Loss: 1.756 Test Acc: 0.599
Validation loss decreased (inf --> -0.598734).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6911887
	speed: 0.1804s/iter; left time: 6571.5756s
	iters: 200, epoch: 2 | loss: 1.1546338
	speed: 0.0436s/iter; left time: 1585.5402s
	iters: 300, epoch: 2 | loss: 1.7171701
	speed: 0.0438s/iter; left time: 1586.9684s
Epoch: 2 cost time: 16.550777912139893
Epoch: 2, Steps: 369 | Train Loss: 1.299 Vali Loss: 2.304 Vali Acc: 0.630 Test Loss: 2.304 Test Acc: 0.630
Validation loss decreased (-0.598734 --> -0.629659).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6886387
	speed: 0.1834s/iter; left time: 6615.3519s
	iters: 200, epoch: 3 | loss: 1.4135849
	speed: 0.0455s/iter; left time: 1636.4022s
	iters: 300, epoch: 3 | loss: 0.9018617
	speed: 0.0447s/iter; left time: 1604.0875s
Epoch: 3 cost time: 17.416942358016968
Epoch: 3, Steps: 369 | Train Loss: 1.248 Vali Loss: 2.238 Vali Acc: 0.640 Test Loss: 2.238 Test Acc: 0.640
Validation loss decreased (-0.629659 --> -0.640443).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9145411
	speed: 0.1874s/iter; left time: 6689.1086s
	iters: 200, epoch: 4 | loss: 1.2229702
	speed: 0.0430s/iter; left time: 1532.0788s
	iters: 300, epoch: 4 | loss: 1.1753868
	speed: 0.0445s/iter; left time: 1579.5818s
Epoch: 4 cost time: 16.76165461540222
Epoch: 4, Steps: 369 | Train Loss: 0.927 Vali Loss: 2.294 Vali Acc: 0.634 Test Loss: 2.294 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0192099
	speed: 0.1871s/iter; left time: 6610.2853s
	iters: 200, epoch: 5 | loss: 1.3402550
	speed: 0.0479s/iter; left time: 1687.9830s
	iters: 300, epoch: 5 | loss: 0.7836326
	speed: 0.0498s/iter; left time: 1747.7133s
Epoch: 5 cost time: 18.92562508583069
Epoch: 5, Steps: 369 | Train Loss: 0.741 Vali Loss: 1.920 Vali Acc: 0.631 Test Loss: 1.920 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6446576
	speed: 0.2005s/iter; left time: 7008.4908s
	iters: 200, epoch: 6 | loss: 0.1106068
	speed: 0.0512s/iter; left time: 1783.1448s
	iters: 300, epoch: 6 | loss: 0.4250032
	speed: 0.0498s/iter; left time: 1731.0198s
Epoch: 6 cost time: 19.247511625289917
Epoch: 6, Steps: 369 | Train Loss: 0.427 Vali Loss: 1.499 Vali Acc: 0.638 Test Loss: 1.499 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1099809
	speed: 0.1966s/iter; left time: 6799.5159s
	iters: 200, epoch: 7 | loss: 0.1020392
	speed: 0.0496s/iter; left time: 1709.3047s
	iters: 300, epoch: 7 | loss: 0.5021573
	speed: 0.0477s/iter; left time: 1641.9713s
Epoch: 7 cost time: 18.780376195907593
Epoch: 7, Steps: 369 | Train Loss: 0.286 Vali Loss: 1.324 Vali Acc: 0.641 Test Loss: 1.324 Test Acc: 0.641
Validation loss decreased (-0.640443 --> -0.641020).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2225471
	speed: 0.1944s/iter; left time: 6652.3210s
	iters: 200, epoch: 8 | loss: 0.3883961
	speed: 0.0501s/iter; left time: 1708.1723s
	iters: 300, epoch: 8 | loss: 0.3183670
	speed: 0.0500s/iter; left time: 1701.3134s
Epoch: 8 cost time: 18.983352184295654
Epoch: 8, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.309 Vali Acc: 0.651 Test Loss: 1.309 Test Acc: 0.651
Validation loss decreased (-0.641020 --> -0.651235).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2661451
	speed: 0.2011s/iter; left time: 6807.0243s
	iters: 200, epoch: 9 | loss: 0.2856542
	speed: 0.0477s/iter; left time: 1610.5386s
	iters: 300, epoch: 9 | loss: 0.3097269
	speed: 0.0489s/iter; left time: 1643.9624s
Epoch: 9 cost time: 18.677770614624023
Epoch: 9, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.417 Vali Acc: 0.648 Test Loss: 1.417 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2403252
	speed: 0.1959s/iter; left time: 6558.6753s
	iters: 200, epoch: 10 | loss: 0.0056090
	speed: 0.0493s/iter; left time: 1645.4612s
	iters: 300, epoch: 10 | loss: 0.0887650
	speed: 0.0479s/iter; left time: 1592.6535s
Epoch: 10 cost time: 18.653630256652832
Epoch: 10, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.625 Vali Acc: 0.633 Test Loss: 1.625 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0087466
	speed: 0.1935s/iter; left time: 6408.2590s
	iters: 200, epoch: 11 | loss: 0.1420893
	speed: 0.0485s/iter; left time: 1601.8058s
	iters: 300, epoch: 11 | loss: 0.2726480
	speed: 0.0495s/iter; left time: 1630.1059s
Epoch: 11 cost time: 18.667697191238403
Epoch: 11, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.715 Vali Acc: 0.638 Test Loss: 1.715 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0701219
	speed: 0.1996s/iter; left time: 6535.4256s
	iters: 200, epoch: 12 | loss: 0.0747344
	speed: 0.0498s/iter; left time: 1625.0198s
	iters: 300, epoch: 12 | loss: 0.0744875
	speed: 0.0477s/iter; left time: 1552.1185s
Epoch: 12 cost time: 18.858879566192627
Epoch: 12, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.816 Vali Acc: 0.644 Test Loss: 1.816 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0691337
	speed: 0.2003s/iter; left time: 6482.8714s
	iters: 200, epoch: 13 | loss: 0.0010858
	speed: 0.0508s/iter; left time: 1639.4028s
	iters: 300, epoch: 13 | loss: 0.2577341
	speed: 0.0479s/iter; left time: 1541.6386s
Epoch: 13 cost time: 18.85568332672119
Epoch: 13, Steps: 369 | Train Loss: 0.076 Vali Loss: 1.942 Vali Acc: 0.636 Test Loss: 1.942 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0668824
	speed: 0.1950s/iter; left time: 6239.1825s
	iters: 200, epoch: 14 | loss: 0.0023873
	speed: 0.0502s/iter; left time: 1600.2729s
	iters: 300, epoch: 14 | loss: 0.0130920
	speed: 0.0507s/iter; left time: 1613.3710s
Epoch: 14 cost time: 19.185409784317017
Epoch: 14, Steps: 369 | Train Loss: 0.061 Vali Loss: 2.174 Vali Acc: 0.645 Test Loss: 2.174 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1218877
	speed: 0.1957s/iter; left time: 6190.1986s
	iters: 200, epoch: 15 | loss: 0.0020258
	speed: 0.0502s/iter; left time: 1583.1380s
	iters: 300, epoch: 15 | loss: 0.0733838
	speed: 0.0474s/iter; left time: 1489.6194s
Epoch: 15 cost time: 17.90328311920166
Epoch: 15, Steps: 369 | Train Loss: 0.068 Vali Loss: 2.150 Vali Acc: 0.634 Test Loss: 2.150 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0920866
	speed: 0.1809s/iter; left time: 5656.9686s
	iters: 200, epoch: 16 | loss: 0.0527397
	speed: 0.0446s/iter; left time: 1389.4373s
	iters: 300, epoch: 16 | loss: 0.0850827
	speed: 0.0454s/iter; left time: 1410.1814s
Epoch: 16 cost time: 17.184316396713257
Epoch: 16, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.142 Vali Acc: 0.636 Test Loss: 2.142 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0002961
	speed: 0.1866s/iter; left time: 5765.7310s
	iters: 200, epoch: 17 | loss: 0.0487581
	speed: 0.0441s/iter; left time: 1359.4945s
	iters: 300, epoch: 17 | loss: 0.0275129
	speed: 0.0428s/iter; left time: 1314.2262s
Epoch: 17 cost time: 17.128647327423096
Epoch: 17, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.326 Vali Acc: 0.640 Test Loss: 2.326 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0420220
	speed: 0.1875s/iter; left time: 5722.7405s
	iters: 200, epoch: 18 | loss: 0.0069563
	speed: 0.0479s/iter; left time: 1458.2211s
	iters: 300, epoch: 18 | loss: 0.0015747
	speed: 0.0455s/iter; left time: 1378.4985s
Epoch: 18 cost time: 17.595545768737793
Epoch: 18, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.214 Vali Acc: 0.635 Test Loss: 2.214 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6512485811577753
model parameter : 146226
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6969308
	speed: 0.0539s/iter; left time: 1982.3848s
	iters: 200, epoch: 1 | loss: 1.7719339
	speed: 0.0373s/iter; left time: 1369.3020s
	iters: 300, epoch: 1 | loss: 1.2627660
	speed: 0.0401s/iter; left time: 1467.8023s
Epoch: 1 cost time: 15.970440149307251
Epoch: 1, Steps: 369 | Train Loss: 1.040 Vali Loss: 1.515 Vali Acc: 0.630 Test Loss: 1.515 Test Acc: 0.630
Validation loss decreased (inf --> -0.630235).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3656454
	speed: 0.1592s/iter; left time: 5798.4022s
	iters: 200, epoch: 2 | loss: 0.1588695
	speed: 0.0366s/iter; left time: 1328.4660s
	iters: 300, epoch: 2 | loss: 3.0520933
	speed: 0.0361s/iter; left time: 1307.0794s
Epoch: 2 cost time: 14.139649868011475
Epoch: 2, Steps: 369 | Train Loss: 1.089 Vali Loss: 1.750 Vali Acc: 0.645 Test Loss: 1.750 Test Acc: 0.645
Validation loss decreased (-0.630235 --> -0.644704).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6602235
	speed: 0.1542s/iter; left time: 5559.6427s
	iters: 200, epoch: 3 | loss: 0.6281657
	speed: 0.0381s/iter; left time: 1371.5766s
	iters: 300, epoch: 3 | loss: 0.4847500
	speed: 0.0375s/iter; left time: 1343.8719s
Epoch: 3 cost time: 14.320941925048828
Epoch: 3, Steps: 369 | Train Loss: 0.969 Vali Loss: 2.143 Vali Acc: 0.639 Test Loss: 2.143 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5119710
	speed: 0.1550s/iter; left time: 5531.8842s
	iters: 200, epoch: 4 | loss: 2.3015766
	speed: 0.0362s/iter; left time: 1289.4721s
	iters: 300, epoch: 4 | loss: 1.4080428
	speed: 0.0360s/iter; left time: 1276.3096s
Epoch: 4 cost time: 13.933995723724365
Epoch: 4, Steps: 369 | Train Loss: 0.776 Vali Loss: 2.024 Vali Acc: 0.655 Test Loss: 2.024 Test Acc: 0.655
Validation loss decreased (-0.644704 --> -0.655201).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4870650
	speed: 0.1473s/iter; left time: 5204.5342s
	iters: 200, epoch: 5 | loss: 0.9232275
	speed: 0.0417s/iter; left time: 1469.7205s
	iters: 300, epoch: 5 | loss: 0.0889129
	speed: 0.0426s/iter; left time: 1496.3917s
Epoch: 5 cost time: 15.115935802459717
Epoch: 5, Steps: 369 | Train Loss: 0.585 Vali Loss: 1.782 Vali Acc: 0.630 Test Loss: 1.782 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0688072
	speed: 0.1659s/iter; left time: 5799.9615s
	iters: 200, epoch: 6 | loss: 0.8572727
	speed: 0.0422s/iter; left time: 1471.7462s
	iters: 300, epoch: 6 | loss: 0.1820999
	speed: 0.0417s/iter; left time: 1449.9598s
Epoch: 6 cost time: 15.921950578689575
Epoch: 6, Steps: 369 | Train Loss: 0.398 Vali Loss: 1.539 Vali Acc: 0.653 Test Loss: 1.539 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3257542
	speed: 0.1629s/iter; left time: 5633.7795s
	iters: 200, epoch: 7 | loss: 0.3272216
	speed: 0.0428s/iter; left time: 1475.6999s
	iters: 300, epoch: 7 | loss: 0.1993564
	speed: 0.0433s/iter; left time: 1489.4386s
Epoch: 7 cost time: 16.38006854057312
Epoch: 7, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.549 Vali Acc: 0.629 Test Loss: 1.549 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1097068
	speed: 0.1689s/iter; left time: 5780.5561s
	iters: 200, epoch: 8 | loss: 0.5155017
	speed: 0.0426s/iter; left time: 1452.0506s
	iters: 300, epoch: 8 | loss: 0.2584774
	speed: 0.0422s/iter; left time: 1436.0908s
Epoch: 8 cost time: 16.35649847984314
Epoch: 8, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.466 Vali Acc: 0.638 Test Loss: 1.466 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3112674
	speed: 0.1624s/iter; left time: 5495.4759s
	iters: 200, epoch: 9 | loss: 0.1736713
	speed: 0.0426s/iter; left time: 1436.0910s
	iters: 300, epoch: 9 | loss: 0.0487542
	speed: 0.0428s/iter; left time: 1439.0597s
Epoch: 9 cost time: 16.255000114440918
Epoch: 9, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.419 Vali Acc: 0.650 Test Loss: 1.419 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0870168
	speed: 0.1675s/iter; left time: 5609.0188s
	iters: 200, epoch: 10 | loss: 0.0717353
	speed: 0.0413s/iter; left time: 1378.3190s
	iters: 300, epoch: 10 | loss: 0.2613423
	speed: 0.0411s/iter; left time: 1366.8515s
Epoch: 10 cost time: 15.917275428771973
Epoch: 10, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.502 Vali Acc: 0.639 Test Loss: 1.502 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0916339
	speed: 0.1637s/iter; left time: 5421.5695s
	iters: 200, epoch: 11 | loss: 0.2452064
	speed: 0.0415s/iter; left time: 1369.8516s
	iters: 300, epoch: 11 | loss: 0.0326878
	speed: 0.0428s/iter; left time: 1407.5389s
Epoch: 11 cost time: 16.05241107940674
Epoch: 11, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.657 Vali Acc: 0.652 Test Loss: 1.657 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0654416
	speed: 0.1671s/iter; left time: 5470.7501s
	iters: 200, epoch: 12 | loss: 0.1524379
	speed: 0.0406s/iter; left time: 1326.8148s
	iters: 300, epoch: 12 | loss: 0.1744097
	speed: 0.0410s/iter; left time: 1333.2889s
Epoch: 12 cost time: 15.884397506713867
Epoch: 12, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.785 Vali Acc: 0.642 Test Loss: 1.785 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0559475
	speed: 0.1630s/iter; left time: 5275.6590s
	iters: 200, epoch: 13 | loss: 0.0232157
	speed: 0.0413s/iter; left time: 1332.6817s
	iters: 300, epoch: 13 | loss: 0.3392531
	speed: 0.0413s/iter; left time: 1328.2720s
Epoch: 13 cost time: 15.76649260520935
Epoch: 13, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.811 Vali Acc: 0.648 Test Loss: 1.811 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0407195
	speed: 0.1695s/iter; left time: 5423.4978s
	iters: 200, epoch: 14 | loss: 0.2802146
	speed: 0.0419s/iter; left time: 1336.0617s
	iters: 300, epoch: 14 | loss: 0.1050916
	speed: 0.0417s/iter; left time: 1327.0668s
Epoch: 14 cost time: 16.106770038604736
Epoch: 14, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.928 Vali Acc: 0.637 Test Loss: 1.928 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6552213393870602
model parameter : 100162
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7487733
	speed: 0.0545s/iter; left time: 2005.5408s
	iters: 200, epoch: 1 | loss: 0.7897003
	speed: 0.0384s/iter; left time: 1410.4410s
	iters: 300, epoch: 1 | loss: 0.7950109
	speed: 0.0389s/iter; left time: 1423.0301s
Epoch: 1 cost time: 15.933780193328857
Epoch: 1, Steps: 369 | Train Loss: 0.831 Vali Loss: 1.443 Vali Acc: 0.596 Test Loss: 1.443 Test Acc: 0.596
Validation loss decreased (inf --> -0.596467).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5901915
	speed: 0.1465s/iter; left time: 5337.6200s
	iters: 200, epoch: 2 | loss: 1.8283379
	speed: 0.0337s/iter; left time: 1225.4561s
	iters: 300, epoch: 2 | loss: 1.7563394
	speed: 0.0335s/iter; left time: 1214.3922s
Epoch: 2 cost time: 12.413686513900757
Epoch: 2, Steps: 369 | Train Loss: 0.826 Vali Loss: 1.471 Vali Acc: 0.646 Test Loss: 1.471 Test Acc: 0.646
Validation loss decreased (-0.596467 --> -0.645842).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4266531
	speed: 0.1441s/iter; left time: 5197.4633s
	iters: 200, epoch: 3 | loss: 1.3377088
	speed: 0.0367s/iter; left time: 1321.6142s
	iters: 300, epoch: 3 | loss: 0.6914699
	speed: 0.0353s/iter; left time: 1267.0736s
Epoch: 3 cost time: 13.519883871078491
Epoch: 3, Steps: 369 | Train Loss: 0.847 Vali Loss: 2.181 Vali Acc: 0.617 Test Loss: 2.181 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4152048
	speed: 0.1474s/iter; left time: 5262.4720s
	iters: 200, epoch: 4 | loss: 1.5015172
	speed: 0.0338s/iter; left time: 1204.2699s
	iters: 300, epoch: 4 | loss: 0.9254582
	speed: 0.0332s/iter; left time: 1179.4844s
Epoch: 4 cost time: 13.181903839111328
Epoch: 4, Steps: 369 | Train Loss: 0.682 Vali Loss: 2.047 Vali Acc: 0.624 Test Loss: 2.047 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2945633
	speed: 0.1430s/iter; left time: 5051.4126s
	iters: 200, epoch: 5 | loss: 0.9672962
	speed: 0.0345s/iter; left time: 1215.6551s
	iters: 300, epoch: 5 | loss: 1.3297330
	speed: 0.0345s/iter; left time: 1211.2265s
Epoch: 5 cost time: 13.272757768630981
Epoch: 5, Steps: 369 | Train Loss: 0.595 Vali Loss: 1.782 Vali Acc: 0.643 Test Loss: 1.782 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3672290
	speed: 0.1447s/iter; left time: 5058.1236s
	iters: 200, epoch: 6 | loss: 0.3709235
	speed: 0.0344s/iter; left time: 1198.5298s
	iters: 300, epoch: 6 | loss: 0.4680187
	speed: 0.0338s/iter; left time: 1175.0504s
Epoch: 6 cost time: 13.092617511749268
Epoch: 6, Steps: 369 | Train Loss: 0.426 Vali Loss: 1.635 Vali Acc: 0.633 Test Loss: 1.635 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0317750
	speed: 0.1414s/iter; left time: 4891.8029s
	iters: 200, epoch: 7 | loss: 0.3422678
	speed: 0.0350s/iter; left time: 1207.6991s
	iters: 300, epoch: 7 | loss: 0.2148935
	speed: 0.0350s/iter; left time: 1202.2396s
Epoch: 7 cost time: 13.41954779624939
Epoch: 7, Steps: 369 | Train Loss: 0.342 Vali Loss: 1.503 Vali Acc: 0.629 Test Loss: 1.503 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7028510
	speed: 0.1415s/iter; left time: 4841.3628s
	iters: 200, epoch: 8 | loss: 0.2469632
	speed: 0.0356s/iter; left time: 1214.8865s
	iters: 300, epoch: 8 | loss: 0.1411341
	speed: 0.0347s/iter; left time: 1180.0224s
Epoch: 8 cost time: 13.353384971618652
Epoch: 8, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.402 Vali Acc: 0.639 Test Loss: 1.402 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1029615
	speed: 0.1456s/iter; left time: 4927.5865s
	iters: 200, epoch: 9 | loss: 0.0359813
	speed: 0.0354s/iter; left time: 1194.4566s
	iters: 300, epoch: 9 | loss: 0.2196053
	speed: 0.0356s/iter; left time: 1199.0328s
Epoch: 9 cost time: 13.49872899055481
Epoch: 9, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.387 Vali Acc: 0.648 Test Loss: 1.387 Test Acc: 0.648
Validation loss decreased (-0.645842 --> -0.647546).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1785046
	speed: 0.1425s/iter; left time: 4769.3214s
	iters: 200, epoch: 10 | loss: 0.0813841
	speed: 0.0339s/iter; left time: 1132.7446s
	iters: 300, epoch: 10 | loss: 0.1161163
	speed: 0.0339s/iter; left time: 1127.6372s
Epoch: 10 cost time: 12.986063957214355
Epoch: 10, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.453 Vali Acc: 0.647 Test Loss: 1.453 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0522660
	speed: 0.1470s/iter; left time: 4868.7873s
	iters: 200, epoch: 11 | loss: 0.0432753
	speed: 0.0335s/iter; left time: 1105.0418s
	iters: 300, epoch: 11 | loss: 0.1120959
	speed: 0.0357s/iter; left time: 1175.8152s
Epoch: 11 cost time: 13.160451412200928
Epoch: 11, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.572 Vali Acc: 0.647 Test Loss: 1.572 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0258999
	speed: 0.1386s/iter; left time: 4539.0148s
	iters: 200, epoch: 12 | loss: 0.1425581
	speed: 0.0378s/iter; left time: 1232.8339s
	iters: 300, epoch: 12 | loss: 0.1785477
	speed: 0.0378s/iter; left time: 1231.3678s
Epoch: 12 cost time: 14.414241075515747
Epoch: 12, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.617 Vali Acc: 0.630 Test Loss: 1.617 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2178302
	speed: 0.1566s/iter; left time: 5068.1962s
	iters: 200, epoch: 13 | loss: 0.0567720
	speed: 0.0377s/iter; left time: 1216.5968s
	iters: 300, epoch: 13 | loss: 0.1739381
	speed: 0.0378s/iter; left time: 1215.1815s
Epoch: 13 cost time: 14.548968076705933
Epoch: 13, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.675 Vali Acc: 0.634 Test Loss: 1.675 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1502372
	speed: 0.1512s/iter; left time: 4840.0932s
	iters: 200, epoch: 14 | loss: 0.0780978
	speed: 0.0381s/iter; left time: 1216.0976s
	iters: 300, epoch: 14 | loss: 0.1390022
	speed: 0.0381s/iter; left time: 1212.2920s
Epoch: 14 cost time: 14.580476522445679
Epoch: 14, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.848 Vali Acc: 0.637 Test Loss: 1.848 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0386238
	speed: 0.1588s/iter; left time: 5022.7185s
	iters: 200, epoch: 15 | loss: 0.0254050
	speed: 0.0383s/iter; left time: 1207.5115s
	iters: 300, epoch: 15 | loss: 0.0083551
	speed: 0.0384s/iter; left time: 1206.9344s
Epoch: 15 cost time: 14.816218614578247
Epoch: 15, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.842 Vali Acc: 0.642 Test Loss: 1.842 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0287105
	speed: 0.1525s/iter; left time: 4766.7193s
	iters: 200, epoch: 16 | loss: 0.0246189
	speed: 0.0389s/iter; left time: 1213.5746s
	iters: 300, epoch: 16 | loss: 0.0564656
	speed: 0.0388s/iter; left time: 1206.6154s
Epoch: 16 cost time: 14.891305923461914
Epoch: 16, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.883 Vali Acc: 0.637 Test Loss: 1.883 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0072151
	speed: 0.1557s/iter; left time: 4809.9123s
	iters: 200, epoch: 17 | loss: 0.0450029
	speed: 0.0381s/iter; left time: 1174.3076s
	iters: 300, epoch: 17 | loss: 0.5387706
	speed: 0.0391s/iter; left time: 1199.8360s
Epoch: 17 cost time: 14.816307544708252
Epoch: 17, Steps: 369 | Train Loss: 0.085 Vali Loss: 1.975 Vali Acc: 0.643 Test Loss: 1.975 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0133342
	speed: 0.1527s/iter; left time: 4662.4216s
	iters: 200, epoch: 18 | loss: 0.2424652
	speed: 0.0383s/iter; left time: 1164.6482s
	iters: 300, epoch: 18 | loss: 0.0468621
	speed: 0.0382s/iter; left time: 1157.6102s
Epoch: 18 cost time: 14.588357210159302
Epoch: 18, Steps: 369 | Train Loss: 0.072 Vali Loss: 2.060 Vali Acc: 0.638 Test Loss: 2.060 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0231388
	speed: 0.1560s/iter; left time: 4704.1053s
	iters: 200, epoch: 19 | loss: 0.1259497
	speed: 0.0380s/iter; left time: 1141.5530s
	iters: 300, epoch: 19 | loss: 0.1964661
	speed: 0.0379s/iter; left time: 1135.5404s
Epoch: 19 cost time: 14.56961178779602
Epoch: 19, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.058 Vali Acc: 0.642 Test Loss: 2.058 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6475595913734393
model parameter : 72546
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8914837
	speed: 0.0521s/iter; left time: 1918.4906s
	iters: 200, epoch: 1 | loss: 0.7735203
	speed: 0.0353s/iter; left time: 1295.7757s
	iters: 300, epoch: 1 | loss: 0.8986667
	speed: 0.0350s/iter; left time: 1279.5609s
Epoch: 1 cost time: 14.728289127349854
Epoch: 1, Steps: 369 | Train Loss: 0.755 Vali Loss: 1.133 Vali Acc: 0.618 Test Loss: 1.133 Test Acc: 0.618
Validation loss decreased (inf --> -0.618320).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6725975
	speed: 0.1310s/iter; left time: 4772.3876s
	iters: 200, epoch: 2 | loss: 1.1202817
	speed: 0.0348s/iter; left time: 1264.1802s
	iters: 300, epoch: 2 | loss: 0.6470705
	speed: 0.0349s/iter; left time: 1266.0844s
Epoch: 2 cost time: 13.527311563491821
Epoch: 2, Steps: 369 | Train Loss: 0.775 Vali Loss: 1.791 Vali Acc: 0.598 Test Loss: 1.791 Test Acc: 0.598
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4067824
	speed: 0.1379s/iter; left time: 4972.6374s
	iters: 200, epoch: 3 | loss: 0.3955179
	speed: 0.0363s/iter; left time: 1306.2151s
	iters: 300, epoch: 3 | loss: 1.2643275
	speed: 0.0349s/iter; left time: 1250.5208s
Epoch: 3 cost time: 13.70099663734436
Epoch: 3, Steps: 369 | Train Loss: 0.745 Vali Loss: 1.584 Vali Acc: 0.638 Test Loss: 1.584 Test Acc: 0.638
Validation loss decreased (-0.618320 --> -0.638463).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0607577
	speed: 0.1339s/iter; left time: 4780.4117s
	iters: 200, epoch: 4 | loss: 0.4388959
	speed: 0.0221s/iter; left time: 787.5640s
	iters: 300, epoch: 4 | loss: 0.3565731
	speed: 0.0307s/iter; left time: 1088.8007s
Epoch: 4 cost time: 11.412265062332153
Epoch: 4, Steps: 369 | Train Loss: 0.668 Vali Loss: 1.638 Vali Acc: 0.649 Test Loss: 1.638 Test Acc: 0.649
Validation loss decreased (-0.638463 --> -0.648962).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4029273
	speed: 0.1286s/iter; left time: 4542.7331s
	iters: 200, epoch: 5 | loss: 1.0814182
	speed: 0.0287s/iter; left time: 1011.6597s
	iters: 300, epoch: 5 | loss: 0.1306747
	speed: 0.0302s/iter; left time: 1061.4512s
Epoch: 5 cost time: 11.534260272979736
Epoch: 5, Steps: 369 | Train Loss: 0.585 Vali Loss: 1.564 Vali Acc: 0.652 Test Loss: 1.564 Test Acc: 0.652
Validation loss decreased (-0.648962 --> -0.651800).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0421761
	speed: 0.1291s/iter; left time: 4513.0368s
	iters: 200, epoch: 6 | loss: 0.5175164
	speed: 0.0319s/iter; left time: 1110.7650s
	iters: 300, epoch: 6 | loss: 0.1808637
	speed: 0.0315s/iter; left time: 1094.2144s
Epoch: 6 cost time: 12.445018768310547
Epoch: 6, Steps: 369 | Train Loss: 0.441 Vali Loss: 1.589 Vali Acc: 0.648 Test Loss: 1.589 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2310928
	speed: 0.1292s/iter; left time: 4468.9394s
	iters: 200, epoch: 7 | loss: 0.0840118
	speed: 0.0292s/iter; left time: 1005.9138s
	iters: 300, epoch: 7 | loss: 0.1110534
	speed: 0.0306s/iter; left time: 1053.4278s
Epoch: 7 cost time: 11.583861827850342
Epoch: 7, Steps: 369 | Train Loss: 0.365 Vali Loss: 1.376 Vali Acc: 0.653 Test Loss: 1.376 Test Acc: 0.653
Validation loss decreased (-0.651800 --> -0.652937).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2467521
	speed: 0.1318s/iter; left time: 4509.0878s
	iters: 200, epoch: 8 | loss: 0.1009164
	speed: 0.0301s/iter; left time: 1027.0747s
	iters: 300, epoch: 8 | loss: 0.3439873
	speed: 0.0316s/iter; left time: 1075.8678s
Epoch: 8 cost time: 11.944478511810303
Epoch: 8, Steps: 369 | Train Loss: 0.286 Vali Loss: 1.362 Vali Acc: 0.644 Test Loss: 1.362 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7383626
	speed: 0.1229s/iter; left time: 4158.3849s
	iters: 200, epoch: 9 | loss: 0.1918660
	speed: 0.0301s/iter; left time: 1014.5740s
	iters: 300, epoch: 9 | loss: 0.2477945
	speed: 0.0307s/iter; left time: 1034.4987s
Epoch: 9 cost time: 11.532448291778564
Epoch: 9, Steps: 369 | Train Loss: 0.252 Vali Loss: 1.390 Vali Acc: 0.638 Test Loss: 1.390 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2561334
	speed: 0.1309s/iter; left time: 4381.6547s
	iters: 200, epoch: 10 | loss: 0.3039227
	speed: 0.0305s/iter; left time: 1017.5366s
	iters: 300, epoch: 10 | loss: 0.5213805
	speed: 0.0306s/iter; left time: 1019.3293s
Epoch: 10 cost time: 11.92055892944336
Epoch: 10, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.323 Vali Acc: 0.652 Test Loss: 1.323 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1526428
	speed: 0.1260s/iter; left time: 4172.1084s
	iters: 200, epoch: 11 | loss: 0.4631282
	speed: 0.0327s/iter; left time: 1079.7826s
	iters: 300, epoch: 11 | loss: 0.0618045
	speed: 0.0331s/iter; left time: 1089.2270s
Epoch: 11 cost time: 12.646282434463501
Epoch: 11, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.368 Vali Acc: 0.660 Test Loss: 1.368 Test Acc: 0.660
Validation loss decreased (-0.652937 --> -0.659748).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0222328
	speed: 0.1316s/iter; left time: 4309.9852s
	iters: 200, epoch: 12 | loss: 0.1153780
	speed: 0.0308s/iter; left time: 1005.1317s
	iters: 300, epoch: 12 | loss: 0.1324527
	speed: 0.0294s/iter; left time: 957.5755s
Epoch: 12 cost time: 12.055999755859375
Epoch: 12, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.499 Vali Acc: 0.643 Test Loss: 1.499 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0367278
	speed: 0.1263s/iter; left time: 4088.4756s
	iters: 200, epoch: 13 | loss: 0.1872703
	speed: 0.0295s/iter; left time: 953.1874s
	iters: 300, epoch: 13 | loss: 0.0494930
	speed: 0.0324s/iter; left time: 1042.0162s
Epoch: 13 cost time: 12.095747232437134
Epoch: 13, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.585 Vali Acc: 0.652 Test Loss: 1.585 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0429624
	speed: 0.1278s/iter; left time: 4088.9891s
	iters: 200, epoch: 14 | loss: 0.0478981
	speed: 0.0332s/iter; left time: 1058.8301s
	iters: 300, epoch: 14 | loss: 0.0147435
	speed: 0.0322s/iter; left time: 1024.2564s
Epoch: 14 cost time: 12.558643102645874
Epoch: 14, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.604 Vali Acc: 0.648 Test Loss: 1.604 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2600051
	speed: 0.1268s/iter; left time: 4012.7051s
	iters: 200, epoch: 15 | loss: 0.1721945
	speed: 0.0354s/iter; left time: 1117.0735s
	iters: 300, epoch: 15 | loss: 0.0544969
	speed: 0.0338s/iter; left time: 1062.5841s
Epoch: 15 cost time: 13.482579708099365
Epoch: 15, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.726 Vali Acc: 0.632 Test Loss: 1.726 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0180081
	speed: 0.1323s/iter; left time: 4137.2214s
	iters: 200, epoch: 16 | loss: 0.1398494
	speed: 0.0336s/iter; left time: 1047.1153s
	iters: 300, epoch: 16 | loss: 0.3053359
	speed: 0.0357s/iter; left time: 1108.6433s
Epoch: 16 cost time: 13.148609638214111
Epoch: 16, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.726 Vali Acc: 0.651 Test Loss: 1.726 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2256842
	speed: 0.1265s/iter; left time: 3909.0906s
	iters: 200, epoch: 17 | loss: 0.0054892
	speed: 0.0333s/iter; left time: 1025.5862s
	iters: 300, epoch: 17 | loss: 0.2698913
	speed: 0.0325s/iter; left time: 996.2951s
Epoch: 17 cost time: 12.742029190063477
Epoch: 17, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.800 Vali Acc: 0.650 Test Loss: 1.800 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0865526
	speed: 0.1352s/iter; left time: 4127.6717s
	iters: 200, epoch: 18 | loss: 0.0612042
	speed: 0.0333s/iter; left time: 1013.6756s
	iters: 300, epoch: 18 | loss: 0.0917043
	speed: 0.0348s/iter; left time: 1054.4827s
Epoch: 18 cost time: 13.107922554016113
Epoch: 18, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.939 Vali Acc: 0.641 Test Loss: 1.939 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0378872
	speed: 0.1316s/iter; left time: 3969.7869s
	iters: 200, epoch: 19 | loss: 0.0973126
	speed: 0.0338s/iter; left time: 1016.6040s
	iters: 300, epoch: 19 | loss: 0.1414691
	speed: 0.0343s/iter; left time: 1028.4331s
Epoch: 19 cost time: 13.218214988708496
Epoch: 19, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.948 Vali Acc: 0.650 Test Loss: 1.948 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.3415780
	speed: 0.1292s/iter; left time: 3847.4235s
	iters: 200, epoch: 20 | loss: 0.2647946
	speed: 0.0345s/iter; left time: 1025.0854s
	iters: 300, epoch: 20 | loss: 0.1588878
	speed: 0.0336s/iter; left time: 993.7150s
Epoch: 20 cost time: 13.09851861000061
Epoch: 20, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.018 Vali Acc: 0.643 Test Loss: 2.018 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2579883
	speed: 0.1324s/iter; left time: 3896.6633s
	iters: 200, epoch: 21 | loss: 0.0265984
	speed: 0.0333s/iter; left time: 976.3050s
	iters: 300, epoch: 21 | loss: 0.1063662
	speed: 0.0357s/iter; left time: 1043.1332s
Epoch: 21 cost time: 13.24641466140747
Epoch: 21, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.006 Vali Acc: 0.641 Test Loss: 2.006 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6597616345062429
model parameter : 58770
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8947547
	speed: 0.0488s/iter; left time: 1795.2958s
	iters: 200, epoch: 1 | loss: 0.8336964
	speed: 0.0310s/iter; left time: 1138.6060s
	iters: 300, epoch: 1 | loss: 0.4099167
	speed: 0.0312s/iter; left time: 1140.9971s
Epoch: 1 cost time: 13.400702238082886
Epoch: 1, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.945 Vali Acc: 0.629 Test Loss: 0.945 Test Acc: 0.629
Validation loss decreased (inf --> -0.628821).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8965913
	speed: 0.1250s/iter; left time: 4552.9102s
	iters: 200, epoch: 2 | loss: 0.8619006
	speed: 0.0311s/iter; left time: 1129.2278s
	iters: 300, epoch: 2 | loss: 0.6591031
	speed: 0.0318s/iter; left time: 1151.3044s
Epoch: 2 cost time: 12.006377696990967
Epoch: 2, Steps: 369 | Train Loss: 0.720 Vali Loss: 1.405 Vali Acc: 0.628 Test Loss: 1.405 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5354406
	speed: 0.1260s/iter; left time: 4544.6929s
	iters: 200, epoch: 3 | loss: 0.3451208
	speed: 0.0319s/iter; left time: 1148.9213s
	iters: 300, epoch: 3 | loss: 0.7048353
	speed: 0.0312s/iter; left time: 1119.3360s
Epoch: 3 cost time: 12.138184309005737
Epoch: 3, Steps: 369 | Train Loss: 0.686 Vali Loss: 1.344 Vali Acc: 0.647 Test Loss: 1.344 Test Acc: 0.647
Validation loss decreased (-0.628821 --> -0.646695).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2232876
	speed: 0.1262s/iter; left time: 4503.7727s
	iters: 200, epoch: 4 | loss: 0.8811505
	speed: 0.0316s/iter; left time: 1126.5428s
	iters: 300, epoch: 4 | loss: 0.8782181
	speed: 0.0314s/iter; left time: 1114.4011s
Epoch: 4 cost time: 12.143034219741821
Epoch: 4, Steps: 369 | Train Loss: 0.606 Vali Loss: 1.414 Vali Acc: 0.645 Test Loss: 1.414 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4867642
	speed: 0.1213s/iter; left time: 4285.5455s
	iters: 200, epoch: 5 | loss: 0.7519805
	speed: 0.0319s/iter; left time: 1125.3694s
	iters: 300, epoch: 5 | loss: 0.4411662
	speed: 0.0321s/iter; left time: 1128.5773s
Epoch: 5 cost time: 12.259513139724731
Epoch: 5, Steps: 369 | Train Loss: 0.537 Vali Loss: 1.565 Vali Acc: 0.635 Test Loss: 1.565 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2938579
	speed: 0.1275s/iter; left time: 4458.1528s
	iters: 200, epoch: 6 | loss: 0.2573344
	speed: 0.0320s/iter; left time: 1115.4334s
	iters: 300, epoch: 6 | loss: 0.0353484
	speed: 0.0322s/iter; left time: 1118.6090s
Epoch: 6 cost time: 11.276430368423462
Epoch: 6, Steps: 369 | Train Loss: 0.453 Vali Loss: 1.366 Vali Acc: 0.645 Test Loss: 1.366 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1483386
	speed: 0.1086s/iter; left time: 3754.7456s
	iters: 200, epoch: 7 | loss: 0.2657630
	speed: 0.0310s/iter; left time: 1070.4155s
	iters: 300, epoch: 7 | loss: 0.0287116
	speed: 0.0311s/iter; left time: 1067.8279s
Epoch: 7 cost time: 11.87014126777649
Epoch: 7, Steps: 369 | Train Loss: 0.369 Vali Loss: 1.387 Vali Acc: 0.649 Test Loss: 1.387 Test Acc: 0.649
Validation loss decreased (-0.646695 --> -0.648681).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1032452
	speed: 0.1240s/iter; left time: 4241.9891s
	iters: 200, epoch: 8 | loss: 0.1586436
	speed: 0.0279s/iter; left time: 952.6047s
	iters: 300, epoch: 8 | loss: 0.3385723
	speed: 0.0290s/iter; left time: 987.2736s
Epoch: 8 cost time: 11.365996837615967
Epoch: 8, Steps: 369 | Train Loss: 0.326 Vali Loss: 1.263 Vali Acc: 0.647 Test Loss: 1.263 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0245918
	speed: 0.1221s/iter; left time: 4133.3559s
	iters: 200, epoch: 9 | loss: 0.1622377
	speed: 0.0306s/iter; left time: 1031.6577s
	iters: 300, epoch: 9 | loss: 0.1352179
	speed: 0.0303s/iter; left time: 1018.3039s
Epoch: 9 cost time: 11.45068097114563
Epoch: 9, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.252 Vali Acc: 0.645 Test Loss: 1.252 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0572858
	speed: 0.1172s/iter; left time: 3923.7148s
	iters: 200, epoch: 10 | loss: 0.0389421
	speed: 0.0297s/iter; left time: 991.3810s
	iters: 300, epoch: 10 | loss: 0.0100796
	speed: 0.0303s/iter; left time: 1009.9100s
Epoch: 10 cost time: 11.571552038192749
Epoch: 10, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.294 Vali Acc: 0.646 Test Loss: 1.294 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1277541
	speed: 0.1222s/iter; left time: 4047.2453s
	iters: 200, epoch: 11 | loss: 0.2632100
	speed: 0.0300s/iter; left time: 991.4984s
	iters: 300, epoch: 11 | loss: 0.1797022
	speed: 0.0309s/iter; left time: 1016.3328s
Epoch: 11 cost time: 11.601007461547852
Epoch: 11, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.291 Vali Acc: 0.652 Test Loss: 1.291 Test Acc: 0.652
Validation loss decreased (-0.648681 --> -0.652371).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1914536
	speed: 0.1158s/iter; left time: 3791.0501s
	iters: 200, epoch: 12 | loss: 0.2040736
	speed: 0.0210s/iter; left time: 686.0364s
	iters: 300, epoch: 12 | loss: 0.4401655
	speed: 0.0309s/iter; left time: 1005.2483s
Epoch: 12 cost time: 10.610661745071411
Epoch: 12, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.357 Vali Acc: 0.650 Test Loss: 1.357 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1208473
	speed: 0.1217s/iter; left time: 3939.6591s
	iters: 200, epoch: 13 | loss: 0.0641593
	speed: 0.0292s/iter; left time: 941.6370s
	iters: 300, epoch: 13 | loss: 0.0768991
	speed: 0.0301s/iter; left time: 967.5078s
Epoch: 13 cost time: 11.56451678276062
Epoch: 13, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.417 Vali Acc: 0.648 Test Loss: 1.417 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0696613
	speed: 0.1202s/iter; left time: 3846.2517s
	iters: 200, epoch: 14 | loss: 0.0929648
	speed: 0.0306s/iter; left time: 976.8132s
	iters: 300, epoch: 14 | loss: 0.0750302
	speed: 0.0306s/iter; left time: 972.1263s
Epoch: 14 cost time: 11.729237079620361
Epoch: 14, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.495 Vali Acc: 0.640 Test Loss: 1.495 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3098056
	speed: 0.1193s/iter; left time: 3773.4998s
	iters: 200, epoch: 15 | loss: 0.5187200
	speed: 0.0300s/iter; left time: 945.5745s
	iters: 300, epoch: 15 | loss: 0.0233952
	speed: 0.0287s/iter; left time: 903.3959s
Epoch: 15 cost time: 11.356551170349121
Epoch: 15, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.536 Vali Acc: 0.653 Test Loss: 1.536 Test Acc: 0.653
Validation loss decreased (-0.652371 --> -0.653220).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1110284
	speed: 0.1208s/iter; left time: 3777.8029s
	iters: 200, epoch: 16 | loss: 0.2037734
	speed: 0.0284s/iter; left time: 886.1297s
	iters: 300, epoch: 16 | loss: 0.0133839
	speed: 0.0276s/iter; left time: 858.0394s
Epoch: 16 cost time: 11.047211408615112
Epoch: 16, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.593 Vali Acc: 0.645 Test Loss: 1.593 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2354773
	speed: 0.1201s/iter; left time: 3711.2353s
	iters: 200, epoch: 17 | loss: 0.1112015
	speed: 0.0274s/iter; left time: 844.4548s
	iters: 300, epoch: 17 | loss: 0.1260174
	speed: 0.0279s/iter; left time: 856.3055s
Epoch: 17 cost time: 10.819670915603638
Epoch: 17, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.609 Vali Acc: 0.645 Test Loss: 1.609 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2171298
	speed: 0.1166s/iter; left time: 3558.3009s
	iters: 200, epoch: 18 | loss: 0.0412612
	speed: 0.0313s/iter; left time: 951.4397s
	iters: 300, epoch: 18 | loss: 0.6126252
	speed: 0.0316s/iter; left time: 959.7484s
Epoch: 18 cost time: 12.103216409683228
Epoch: 18, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.624 Vali Acc: 0.651 Test Loss: 1.624 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0138090
	speed: 0.1292s/iter; left time: 3895.4501s
	iters: 200, epoch: 19 | loss: 0.2714100
	speed: 0.0313s/iter; left time: 940.8662s
	iters: 300, epoch: 19 | loss: 0.0313759
	speed: 0.0316s/iter; left time: 946.7002s
Epoch: 19 cost time: 12.224335193634033
Epoch: 19, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.654 Vali Acc: 0.644 Test Loss: 1.654 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1141199
	speed: 0.1268s/iter; left time: 3778.2860s
	iters: 200, epoch: 20 | loss: 0.1069062
	speed: 0.0310s/iter; left time: 919.2522s
	iters: 300, epoch: 20 | loss: 0.2435140
	speed: 0.0314s/iter; left time: 927.8525s
Epoch: 20 cost time: 12.123554706573486
Epoch: 20, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.717 Vali Acc: 0.650 Test Loss: 1.717 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0747740
	speed: 0.1298s/iter; left time: 3817.4112s
	iters: 200, epoch: 21 | loss: 0.2903703
	speed: 0.0317s/iter; left time: 929.1114s
	iters: 300, epoch: 21 | loss: 0.1565743
	speed: 0.0317s/iter; left time: 925.4395s
Epoch: 21 cost time: 12.336549043655396
Epoch: 21, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.760 Vali Acc: 0.645 Test Loss: 1.760 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0649026
	speed: 0.1229s/iter; left time: 3570.6655s
	iters: 200, epoch: 22 | loss: 0.0254932
	speed: 0.0320s/iter; left time: 927.0348s
	iters: 300, epoch: 22 | loss: 0.0502694
	speed: 0.0326s/iter; left time: 939.7559s
Epoch: 22 cost time: 12.433981657028198
Epoch: 22, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.801 Vali Acc: 0.649 Test Loss: 1.801 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0516100
	speed: 0.1300s/iter; left time: 3728.4052s
	iters: 200, epoch: 23 | loss: 0.0671503
	speed: 0.0322s/iter; left time: 920.9421s
	iters: 300, epoch: 23 | loss: 0.1892243
	speed: 0.0322s/iter; left time: 917.8626s
Epoch: 23 cost time: 12.359986782073975
Epoch: 23, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.886 Vali Acc: 0.634 Test Loss: 1.886 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0270489
	speed: 0.1227s/iter; left time: 3474.9859s
	iters: 200, epoch: 24 | loss: 0.0356898
	speed: 0.0324s/iter; left time: 913.1224s
	iters: 300, epoch: 24 | loss: 0.0479904
	speed: 0.0321s/iter; left time: 903.6612s
Epoch: 24 cost time: 12.44347357749939
Epoch: 24, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.857 Vali Acc: 0.644 Test Loss: 1.857 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0945221
	speed: 0.1250s/iter; left time: 3492.3964s
	iters: 200, epoch: 25 | loss: 0.0212941
	speed: 0.0319s/iter; left time: 886.9015s
	iters: 300, epoch: 25 | loss: 0.2090588
	speed: 0.0312s/iter; left time: 865.3042s
Epoch: 25 cost time: 12.193436622619629
Epoch: 25, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.844 Vali Acc: 0.641 Test Loss: 1.844 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6532349602724177
model parameter : 44994
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7858874
	speed: 0.0463s/iter; left time: 1705.6894s
	iters: 200, epoch: 1 | loss: 0.7445382
	speed: 0.0311s/iter; left time: 1139.5713s
	iters: 300, epoch: 1 | loss: 0.6546219
	speed: 0.0304s/iter; left time: 1112.5436s
Epoch: 1 cost time: 12.980371713638306
Epoch: 1, Steps: 369 | Train Loss: 0.694 Vali Loss: 1.032 Vali Acc: 0.634 Test Loss: 1.032 Test Acc: 0.634
Validation loss decreased (inf --> -0.634212).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6154757
	speed: 0.1235s/iter; left time: 4498.9791s
	iters: 200, epoch: 2 | loss: 0.6292832
	speed: 0.0306s/iter; left time: 1110.5323s
	iters: 300, epoch: 2 | loss: 0.6482611
	speed: 0.0308s/iter; left time: 1116.8904s
Epoch: 2 cost time: 11.840370655059814
Epoch: 2, Steps: 369 | Train Loss: 0.657 Vali Loss: 1.246 Vali Acc: 0.631 Test Loss: 1.246 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7938604
	speed: 0.1215s/iter; left time: 4382.3997s
	iters: 200, epoch: 3 | loss: 1.0650659
	speed: 0.0308s/iter; left time: 1108.6952s
	iters: 300, epoch: 3 | loss: 0.8913020
	speed: 0.0303s/iter; left time: 1085.1700s
Epoch: 3 cost time: 11.760493993759155
Epoch: 3, Steps: 369 | Train Loss: 0.633 Vali Loss: 1.182 Vali Acc: 0.646 Test Loss: 1.182 Test Acc: 0.646
Validation loss decreased (-0.634212 --> -0.645845).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5435548
	speed: 0.1247s/iter; left time: 4452.5791s
	iters: 200, epoch: 4 | loss: 0.3251710
	speed: 0.0306s/iter; left time: 1089.0931s
	iters: 300, epoch: 4 | loss: 0.8855789
	speed: 0.0300s/iter; left time: 1065.1122s
Epoch: 4 cost time: 11.71148943901062
Epoch: 4, Steps: 369 | Train Loss: 0.585 Vali Loss: 1.248 Vali Acc: 0.659 Test Loss: 1.248 Test Acc: 0.659
Validation loss decreased (-0.645845 --> -0.659465).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2723804
	speed: 0.1205s/iter; left time: 4257.6915s
	iters: 200, epoch: 5 | loss: 0.3229787
	speed: 0.0304s/iter; left time: 1072.3799s
	iters: 300, epoch: 5 | loss: 0.3644038
	speed: 0.0303s/iter; left time: 1064.6503s
Epoch: 5 cost time: 11.724482297897339
Epoch: 5, Steps: 369 | Train Loss: 0.512 Vali Loss: 1.311 Vali Acc: 0.649 Test Loss: 1.311 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9665506
	speed: 0.1140s/iter; left time: 3986.4522s
	iters: 200, epoch: 6 | loss: 0.0373031
	speed: 0.0287s/iter; left time: 999.6122s
	iters: 300, epoch: 6 | loss: 0.6892437
	speed: 0.0288s/iter; left time: 999.7921s
Epoch: 6 cost time: 11.088757514953613
Epoch: 6, Steps: 369 | Train Loss: 0.468 Vali Loss: 1.270 Vali Acc: 0.653 Test Loss: 1.270 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4782566
	speed: 0.1169s/iter; left time: 4041.9943s
	iters: 200, epoch: 7 | loss: 0.1820745
	speed: 0.0306s/iter; left time: 1053.8943s
	iters: 300, epoch: 7 | loss: 0.3663364
	speed: 0.0308s/iter; left time: 1058.6067s
Epoch: 7 cost time: 11.704105138778687
Epoch: 7, Steps: 369 | Train Loss: 0.391 Vali Loss: 1.257 Vali Acc: 0.655 Test Loss: 1.257 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0878043
	speed: 0.1211s/iter; left time: 4143.3285s
	iters: 200, epoch: 8 | loss: 0.2277470
	speed: 0.0270s/iter; left time: 922.4730s
	iters: 300, epoch: 8 | loss: 0.6568739
	speed: 0.0281s/iter; left time: 956.4434s
Epoch: 8 cost time: 10.796949863433838
Epoch: 8, Steps: 369 | Train Loss: 0.350 Vali Loss: 1.175 Vali Acc: 0.668 Test Loss: 1.175 Test Acc: 0.668
Validation loss decreased (-0.659465 --> -0.667695).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4049443
	speed: 0.1154s/iter; left time: 3907.3507s
	iters: 200, epoch: 9 | loss: 0.2978524
	speed: 0.0280s/iter; left time: 945.3628s
	iters: 300, epoch: 9 | loss: 0.6139622
	speed: 0.0273s/iter; left time: 919.4821s
Epoch: 9 cost time: 10.703740119934082
Epoch: 9, Steps: 369 | Train Loss: 0.298 Vali Loss: 1.218 Vali Acc: 0.666 Test Loss: 1.218 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0249624
	speed: 0.1157s/iter; left time: 3873.9011s
	iters: 200, epoch: 10 | loss: 0.5933815
	speed: 0.0282s/iter; left time: 940.7692s
	iters: 300, epoch: 10 | loss: 0.1697945
	speed: 0.0278s/iter; left time: 923.8351s
Epoch: 10 cost time: 10.826328992843628
Epoch: 10, Steps: 369 | Train Loss: 0.269 Vali Loss: 1.200 Vali Acc: 0.662 Test Loss: 1.200 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0617111
	speed: 0.1195s/iter; left time: 3956.6258s
	iters: 200, epoch: 11 | loss: 0.3191051
	speed: 0.0221s/iter; left time: 730.1891s
	iters: 300, epoch: 11 | loss: 0.3087541
	speed: 0.0252s/iter; left time: 830.0544s
Epoch: 11 cost time: 10.292337656021118
Epoch: 11, Steps: 369 | Train Loss: 0.240 Vali Loss: 1.255 Vali Acc: 0.649 Test Loss: 1.255 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1186636
	speed: 0.1175s/iter; left time: 3845.9074s
	iters: 200, epoch: 12 | loss: 0.3012169
	speed: 0.0293s/iter; left time: 957.2305s
	iters: 300, epoch: 12 | loss: 0.3312206
	speed: 0.0308s/iter; left time: 1001.4134s
Epoch: 12 cost time: 11.589519500732422
Epoch: 12, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.212 Vali Acc: 0.660 Test Loss: 1.212 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3782459
	speed: 0.1165s/iter; left time: 3769.9207s
	iters: 200, epoch: 13 | loss: 0.2297976
	speed: 0.0285s/iter; left time: 920.5985s
	iters: 300, epoch: 13 | loss: 0.1400877
	speed: 0.0286s/iter; left time: 919.2541s
Epoch: 13 cost time: 11.052717685699463
Epoch: 13, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.271 Vali Acc: 0.650 Test Loss: 1.271 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3261085
	speed: 0.1189s/iter; left time: 3806.2199s
	iters: 200, epoch: 14 | loss: 0.5472633
	speed: 0.0300s/iter; left time: 956.9908s
	iters: 300, epoch: 14 | loss: 0.0258591
	speed: 0.0292s/iter; left time: 927.8548s
Epoch: 14 cost time: 11.340606451034546
Epoch: 14, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.319 Vali Acc: 0.656 Test Loss: 1.319 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1263157
	speed: 0.1158s/iter; left time: 3664.3393s
	iters: 200, epoch: 15 | loss: 0.0362653
	speed: 0.0305s/iter; left time: 963.2316s
	iters: 300, epoch: 15 | loss: 0.0950100
	speed: 0.0311s/iter; left time: 977.4888s
Epoch: 15 cost time: 11.810736656188965
Epoch: 15, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.350 Vali Acc: 0.654 Test Loss: 1.350 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1397620
	speed: 0.1190s/iter; left time: 3721.5342s
	iters: 200, epoch: 16 | loss: 0.5108663
	speed: 0.0293s/iter; left time: 914.1049s
	iters: 300, epoch: 16 | loss: 0.2996267
	speed: 0.0285s/iter; left time: 885.8971s
Epoch: 16 cost time: 11.276408433914185
Epoch: 16, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.389 Vali Acc: 0.653 Test Loss: 1.389 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2204472
	speed: 0.1180s/iter; left time: 3645.2581s
	iters: 200, epoch: 17 | loss: 0.0461781
	speed: 0.0303s/iter; left time: 933.2314s
	iters: 300, epoch: 17 | loss: 0.3104539
	speed: 0.0310s/iter; left time: 952.9852s
Epoch: 17 cost time: 11.815347671508789
Epoch: 17, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.444 Vali Acc: 0.655 Test Loss: 1.444 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1022257
	speed: 0.1200s/iter; left time: 3662.7069s
	iters: 200, epoch: 18 | loss: 0.0728906
	speed: 0.0302s/iter; left time: 918.7694s
	iters: 300, epoch: 18 | loss: 0.1909328
	speed: 0.0300s/iter; left time: 910.5876s
Epoch: 18 cost time: 11.684881210327148
Epoch: 18, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.471 Vali Acc: 0.656 Test Loss: 1.471 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_PatchTST_UEA_ftM_sl62_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6677071509648127
model parameter : 35826
model size : 0.45MB
